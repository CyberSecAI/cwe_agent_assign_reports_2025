{
  "cve_id": "CVE-2024-31490",
  "description": "An exposure of sensitive information to an unauthorized actor in Fortinet FortiSandbox version 4.4.0 through 4.4.4 and 4.2.0 through 4.2.6 and 4.0.0 through 4.0.5 and 3.2.2 through 3.2.4 and 3.1.5 allows attacker to information disclosure via HTTP get requests.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": [
      "exposure of sensitive information to an unauthorized actor",
      "information disclosure"
    ],
    "vector": "HTTP get requests",
    "attacker": "attacker",
    "product": "Fortinet FortiSandbox",
    "version": "4.4.0 through 4.4.4 and 4.2.0 through 4.2.6 and 4.0.0 through 4.0.5 and 3.2.2 through 3.2.4 and 3.1.5",
    "component": ""
  },
  "reference_content": "- **Root cause of vulnerability:** An exposure of sensitive information vulnerability in FortiSandbox.\n- **Weaknesses/vulnerabilities present:**  Improper access control leading to sensitive information disclosure. Specifically, authenticated users with read-only permissions can download diagnostic logs containing sensitive files via HTTP GET requests.\n- **Impact of exploitation:** An attacker can gain unauthorized access to sensitive files by exploiting the diagnostic logs download functionality.\n- **Attack vectors:** The vulnerability is exploitable via HTTP GET requests by an authenticated attacker.\n- **Required attacker capabilities/position:** The attacker must have at least read-only access to the FortiSandbox appliance to be able to exploit the vulnerability.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 1.0 | Class | Primary | Allowed-with-Review |\n| CWE-497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship considered was that of parent and child. CWE-200 is a class-level CWE, and several more specific CWEs could potentially apply. However, the information available doesn't give enough context to confidently select a more specific variant. CWE-497 is a base CWE and a potential child of CWE-668.\n\n```mermaid\ngraph TD\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    cwe497[\"CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\"]\n    \n    cwe497 -->|CHILDOF| cwe200\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe200 primary\n    class cwe497 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **improper access control**, leading to **sensitive information disclosure** via HTTP GET requests. The root cause is the **exposure of sensitive information** due to **improper access control**.\n\n## Summary of Analysis\nThe initial analysis focused on the **exposure of sensitive information** due to the **lack of proper access control**, leading to information disclosure. The vulnerability description and CVE reference summary clearly indicate that an attacker can gain unauthorized access to sensitive information via HTTP GET requests.\n\nCWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) is a strong candidate because the vulnerability description explicitly mentions \"exposure of sensitive information to an unauthorized actor\". However, CWE-200 is a Class-level CWE, and the Retriever suggests it is often misused. The summary suggests this is the root cause of the vulnerability: \"Root cause of vulnerability: An exposure of sensitive information vulnerability in FortiSandbox\".\n\nCWE-497 (Exposure of Sensitive System Information to an Unauthorized Control Sphere) is also a possibility, as the logs contain sensitive *system* information. The description provided indicates authenticated users with read-only permissions can download logs that include sensitive files, which aligns with the description of CWE-497.\n\nI am choosing CWE-200 as the primary CWE due to the explicit mention in the vulnerability description, and I will include CWE-497 as a secondary CWE.\n\nRelevant CWE Information:\n\n*   **CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor)**: This CWE is chosen as the primary weakness because the vulnerability description clearly states \"An **exposure of sensitive information to an unauthorized actor**\". The **impact** is also listed as \"information disclosure\". The CVE reference summary also states: \"Root cause of vulnerability: An **exposure of sensitive information** vulnerability in FortiSandbox.\" This clearly matches the description of CWE-200. However, it's a Class-level CWE, so I've looked for more specific options. The mapping guidance discourages using it, but the explicit match in the description makes it the most appropriate initial choice.\n*   **CWE-497 (Exposure of Sensitive System Information to an Unauthorized Control Sphere)**: This CWE is included because the sensitive information being exposed appears to be system-related (diagnostic logs). The description says, \"Specifically, authenticated users with read-only permissions can download diagnostic logs containing sensitive files via HTTP GET requests.\" This suggests the information relates to the system's operation. The relationship to CWE-668 was considered, but CWE-497 is more specific.\n*   **CWE-532 (Insertion of Sensitive Information into Log File)**: This was considered, as the logs are the vector of information disclosure. However, the root cause is not that the information is being logged, but that it is being exposed.\n*   **CWE-306 (Missing Authentication for Critical Function)**: This was considered because access to the logs should require proper authentication/authorization. However, the description indicates that the attacker needs to be authenticated with at least read-only access. This implies the problem isn't a *missing* authentication, but **improper access control** for authenticated users with read-only access.\n*   **CWE-639 (Authorization Bypass Through User-Controlled Key)**: This was considered as there is an authorization issue. The description says, \"Weaknesses/vulnerabilities present: Improper access control leading to sensitive information disclosure. Specifically, authenticated users with read-only permissions can download diagnostic logs containing sensitive files via HTTP GET requests.\"\n*   **CWE-22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'))** and **CWE-23 (Relative Path Traversal)** These were considered because the vulnerability involves HTTP GET requests, which might involve file paths. However, the root cause is not related to path traversal, but **exposure of information**.\n\nI am confident that CWE-200 is the most appropriate primary CWE and CWE-497 is a valid secondary CWE.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 1.0 | Class | Primary | Allowed-with-Review |\n| CWE-497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship considered was that of parent and child. CWE-200 is a class-level CWE, and several more specific CWEs could potentially apply. However, the information available doesn't give enough context to confidently select a more specific variant. CWE-497 is a base CWE and a potential child of CWE-668.\n\n```mermaid\ngraph TD\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    cwe497[\"CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\"]\n    \n    cwe497 -->|CHILDOF| cwe200\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe200 primary\n    class cwe497 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **improper access control**, leading to **sensitive information disclosure** via HTTP GET requests. The root cause is the **exposure of sensitive information** due to **improper access control**.\n\n## Summary of Analysis\nThe initial analysis focused on the **exposure of sensitive information** due to the **lack of proper access control**, leading to information disclosure. The vulnerability description and CVE reference summary clearly indicate that an attacker can gain unauthorized access to sensitive information via HTTP GET requests.\n\nCWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) is a strong candidate because the vulnerability description explicitly mentions \"exposure of sensitive information to an unauthorized actor\". However, CWE-200 is a Class-level CWE, and the Retriever suggests it is often misused. The summary suggests this is the root cause of the vulnerability: \"Root cause of vulnerability: An exposure of sensitive information vulnerability in FortiSandbox\".\n\nCWE-497 (Exposure of Sensitive System Information to an Unauthorized Control Sphere) is also a possibility, as the logs contain sensitive *system* information. The description provided indicates authenticated users with read-only permissions can download logs that include sensitive files, which aligns with the description of CWE-497.\n\nI am choosing CWE-200 as the primary CWE due to the explicit mention in the vulnerability description, and I will include CWE-497 as a secondary CWE.\n\nRelevant CWE Information:\n\n*   **CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor)**: This CWE is chosen as the primary weakness because the vulnerability description clearly states \"An **exposure of sensitive information to an unauthorized actor**\". The **impact** is also listed as \"information disclosure\". The CVE reference summary also states: \"Root cause of vulnerability: An **exposure of sensitive information** vulnerability in FortiSandbox.\" This clearly matches the description of CWE-200. However, it's a Class-level CWE, so I've looked for more specific options. The mapping guidance discourages using it, but the explicit match in the description makes it the most appropriate initial choice.\n*   **CWE-497 (Exposure of Sensitive System Information to an Unauthorized Control Sphere)**: This CWE is included because the sensitive information being exposed appears to be system-related (diagnostic logs). The description says, \"Specifically, authenticated users with read-only permissions can download diagnostic logs containing sensitive files via HTTP GET requests.\" This suggests the information relates to the system's operation. The relationship to CWE-668 was considered, but CWE-497 is more specific.\n*   **CWE-532 (Insertion of Sensitive Information into Log File)**: This was considered, as the logs are the vector of information disclosure. However, the root cause is not that the information is being logged, but that it is being exposed.\n*   **CWE-306 (Missing Authentication for Critical Function)**: This was considered because access to the logs should require proper authentication/authorization. However, the description indicates that the attacker needs to be authenticated with at least read-only access. This implies the problem isn't a *missing* authentication, but **improper access control** for authenticated users with read-only access.\n*   **CWE-639 (Authorization Bypass Through User-Controlled Key)**: This was considered as there is an authorization issue. The description says, \"Weaknesses/vulnerabilities present: Improper access control leading to sensitive information disclosure. Specifically, authenticated users with read-only permissions can download diagnostic logs containing sensitive files via HTTP GET requests.\"\n*   **CWE-22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'))** and **CWE-23 (Relative Path Traversal)** These were considered because the vulnerability involves HTTP GET requests, which might involve file paths. However, the root cause is not related to path traversal, but **exposure of information**.\n\nI am confident that CWE-200 is the most appropriate primary CWE and CWE-497 is a valid secondary CWE.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-639:**\n- 639 (Authorization Bypass Through User-Controlled Key) - ROOT\n\n\n**Chain starting from CWE-22:**\n- 22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 107.04790180297358
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 97.68343361470119
    },
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "sparse"
      },
      "similarity": 97.6738355507532
    },
    {
      "metadata": {
        "doc_id": "522",
        "name": "Insufficiently Protected Credentials",
        "source": "sparse"
      },
      "similarity": 97.23154537622892
    },
    {
      "metadata": {
        "doc_id": "532",
        "name": "Insertion of Sensitive Information into Log File",
        "source": "sparse"
      },
      "similarity": 95.75303158744084
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 95.61202822632418
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 94.99400177775924
    },
    {
      "metadata": {
        "doc_id": "497",
        "name": "Exposure of Sensitive System Information to an Unauthorized Control Sphere",
        "source": "sparse"
      },
      "similarity": 94.95245379167739
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5393534106289515,
            "graph": 2.031746680253339
          }
        }
      },
      "similarity": 0.5393534106289515
    },
    {
      "doc_id": "79",
      "text": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "type": "base",
        "original_content": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "relationships": [
          {
            "source_id": "79",
            "target_id": "87",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "86",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "85",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "84",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "83",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "81",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "80",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "113",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "352",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "494",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "74",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "79",
            "target_id": "74",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "87",
            "target_id": "79",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "86",
            "target_id": "79",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "85",
            "target_id": "79",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "84",
            "target_id": "79",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "83",
            "target_id": "79",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "81",
            "target_id": "79",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "80",
            "target_id": "79",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "74",
            "target_id": "79",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "494",
            "target_id": "79",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "79",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "113",
            "target_id": "79",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "113",
                  "79",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "113"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "113",
                  "79",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "113"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-639",
      "CWE-22",
      "CWE-306",
      "CWE-668",
      "CWE-200",
      "CWE-497",
      "CWE-23",
      "CWE-532"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}