# Vulnerability Information: CVE-2025-1227

## Vulnerability Description
A vulnerability was found in ywoa up to 2024.07.03. It has been rated as critical. This issue affects the function selectList of the file com/cloudweb/oa/mapper/xml/AddressDao.xml. The manipulation leads to **sql injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 2024.07.04 is able to address this issue. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** ywoa
- **version:** up to 2024.07.03
- **component:** selectList of the file com/cloudweb/oa/mapper/xml/AddressDao.xml

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1227 Content (gitee.com_618defc7_20250624_125305.html)

This content **IS RELATED** to a potential vulnerability. It details a SQL injection vulnerability in the ywoa project (OA协同办公系统，流程专家（带有低代码开发平台的OA）) hosted on Gitee.

Here's a breakdown of the extracted information:

**Root cause of vulnerability:**

The vulnerability stems from unsanitized user input being directly concatenated into a SQL query string. Specifically, the `orderBy` parameter is not filtered before being used in the SQL query within the `getSql()` method in `com/cloudweb/oa/service/AddressService.java:226`.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection:**  The primary vulnerability is a SQL injection flaw.
*   **Lack of Input Validation:** The `orderBy` parameter is not validated or sanitized, allowing malicious SQL code to be injected.
*   **Dynamic SQL Construction:**  The use of string concatenation to build SQL queries is inherently risky if not handled carefully.

**Impact of exploitation:**

Successful exploitation of this vulnerability could allow an attacker to:

*   **Read sensitive data:** Access unauthorized information from the database.
*   **Modify data:** Alter data within the database.
*   **Potentially gain control of the database server:** Depending on database permissions, an attacker might be able to execute arbitrary commands on the server.

**Attack vectors:**

*   The vulnerability is triggered by sending a crafted `orderBy` parameter in a request to the `/address/list` endpoint.
*   The provided Proof of Concept (POC) demonstrates the attack:
    `http://localhost:8096/oa/address/list?orderBy=1/\*\*/desc)/\*\*/tmp\_count/\*\*/where/\*\*/1=1/\*\*/and/\*\*/updatexml/\*\*/(1,concat(0x7e,user(),0x7e),1)--+-`

**Required attacker capabilities/position:**

*   **Authenticated User:** The POC requires the attacker to be logged in to the backend system.
*   **Understanding of SQL Injection:** The attacker needs knowledge of SQL injection techniques to craft a malicious payload.
*   **Network Access:** The attacker needs network access to the vulnerable application.

**Mitigation or fix:**

The content does not explicitly state a fix, but the root cause indicates that proper input validation and sanitization of the `orderBy` parameter are necessary.  Using parameterized queries or prepared statements would be the recommended solution to prevent SQL injection.

**Additional Details (More than official CVE description):**

*   **Affected Versions:** The vulnerability affects versions of ywoa before 2024.07.04.
*   **Code Locations:** The content provides specific file and line numbers where the vulnerability exists:
    *   `com/cloudweb/oa/mapper/xml/AddressDao.xml:123`
    *   `com/cloudweb/oa/dao/AddressDao.java:30`
    *   `com/cloudweb/oa/service/AddressService.java:132, 226`
    *   `com/cloudweb/oa/controller/AddressController.java:351, 362`
*   **CVE ID:** The issue is associated with CVE-2025-25590 (as noted in the content).
*   **Discovery:** The vulnerability was found by Chaitin Security Research Lab.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.476 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.421 |
| 4 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.411 |
| 5 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.403 |
| 6 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.399 |
| 7 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.398 |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.395 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.566 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

