## Vulnerability Description
An **arbitrary file creation** vulnerability exists in PaperCut NG/MF that only affects Windows servers with Web Print enabled. This specific flaw exists within the web-print.exe process, which can incorrectly create files that dont exist when a maliciously formed payload is provided. This can be used to flood disk space and result in a Denial of Service (DoS) attack. Note This CVE has been split from CVE-2024-4712.

### Vulnerability Description Key Phrases
- **weakness:** **arbitrary file creation**
- **impact:** denial of service
- **vector:** maliciously formed payload
- **product:** PaperCut NG/MF
- **component:** Web Print

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The vulnerability is due to the `web-print.exe` process incorrectly creating files that don't exist when a maliciously formed payload is provided.",
  "Weaknesses/vulnerabilities present": "Arbitrary file creation.",
  "Impact of exploitation": "If enough files are created using this process, it may flood disk space and result in a Denial of Service (DoS).",
  "Attack vectors": "Local login access to the Windows Server hosting PaperCut NG/MF is required, along with the ability to execute low-privilege code directly on the server.",
  "Required attacker capabilities/position": "An attacker must have local login access to the Windows server and the ability to execute low-privilege code on the server."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.370 |
| 2 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.347 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.343 |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.343 |
| 5 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.342 |
| 6 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.340 |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.340 |
| 8 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.339 |
| 9 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | Allowed | dense | 0.579 |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-400: Uncontrolled Resource Consumption

CWE-121: Stack-based Buffer Overflow

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-20: Improper Input Validation

CWE-787: Out-of-bounds Write

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-379: Creation of Temporary File in Directory with Insecure Permissions

CWE-770: Allocation of Resources Without Limits or Throttling