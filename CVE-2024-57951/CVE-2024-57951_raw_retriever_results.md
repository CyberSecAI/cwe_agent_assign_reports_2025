# Raw Retriever Results for CVE-2024-57951

# Raw Retriever Results for CVE-2024-57951
## Query
In the Linux kernel, the following vulnerability has been resolved hrtimers Handle CPU state correctly on hotplug Consider a scenario where a CPU transitions from CPUHP_ONLINE to halfway through a CPU hotunplug down to CPUHP_HRTIMERS_PREPARE, and then back to CPUHP_ONLINE Since hrtimers_prepare_cpu() does not run, cpu_base.hres_active remains set to 1 throughout. However, during a CPU unplug operation, the tick and the clockevents are shut down at CPUHP_AP_TICK_DYING. On return to the online state, for instance CFS incorrectly assumes that the hrtick is already active, and the chance of the clockevent device to transition to oneshot mode is also lost forever for the CPU, unless it goes back to a lower state than CPUHP_HRTIMERS_PREPARE once. This round-trip reveals another issue cpu_base.online is not set to 1 after the transition, which appears as a WARN_ON_ONCE in enqueue_hrtimer(). Aside of that, the bulk of the per CPU state is not reset either, which means there are dangling pointers in the worst case. Address this by adding a corresponding startup() callback, which resets the stale per CPU state and sets the online flag. [ tglx Make the new callback unconditionally available, remove the online modification in the prepare() callback and clear the remaining state in the starting callback instead of the prepare callback ]

## Keyphrases
- **weakness**: 'dangling pointers', 'hres_active remains set to 1'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4339 | 0.4997 | 0.4581 | 0.4588 | 20 |
| Sparse | 800.0000 | 984.7762 | 926.1265 | 940.9460 | 12 |
| Graph | 1.0062 | 2.4700 | 1.5344 | 1.4996 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.4700 | Allowed |
| 2 | 410 | Insufficient Resource Pool | base | 2.2100 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.2100 | Allowed |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | base | 2.1190 | Allowed |
| 5 | 1269 | Product Released in Non-Release Configuration | base | 2.1190 | Allowed |
| 6 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 1.6836 | Allowed |
| 7 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 1.6405 | Allowed |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 1.6094 | Allowed |
| 9 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 1.6075 | Allowed |
| 10 | 908 | Use of Uninitialized Resource | Base | 1.5250 | Allowed |
| 11 | 413 | Improper Resource Locking | Base | 1.4742 | Allowed |
| 12 | 407 | Inefficient Algorithmic Complexity | class | 1.3648 | Allowed-with-Review |
| 13 | 244 | Improper Clearing of Heap Memory Before Release ('Heap Inspection') | variant | 1.2864 | Allowed |
| 14 | 400 | Uncontrolled Resource Consumption | class | 1.1920 | Discouraged |
| 15 | 1271 | Uninitialized Value on Reset for Registers Holding Security Settings | base | 1.1466 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4997 | 0.4997 | Allowed |
| 2 | 909 | Missing Initialization of Resource | Class | 0.4825 | 0.4825 | Allowed-with-Review |
| 3 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4800 | 0.4800 | Allowed |
| 4 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4716 | 0.4716 | Allowed |
| 5 | 413 | Improper Resource Locking | Base | 0.4706 | 0.4706 | Allowed |
| 6 | 1247 | Improper Protection Against Voltage and Clock Glitches | Base | 0.4704 | 0.4704 | Allowed |
| 7 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | 0.4680 | 0.4680 | Allowed |
| 8 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4679 | 0.4679 | Allowed |
| 9 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4672 | 0.4672 | Allowed |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4671 | 0.4671 | Allowed-with-Review |
| 11 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | 0.4505 | 0.4505 | Allowed |
| 12 | 1423 | Exposure of Sensitive Information caused by Shared Microarchitectural Predictor State that Influences Transient Execution | Base | 0.4434 | 0.4434 | Allowed |
| 13 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4432 | 0.4432 | Allowed |
| 14 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.4427 | 0.4427 | Allowed |
| 15 | 667 | Improper Locking | Class | 0.4415 | 0.4415 | Allowed-with-Review |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 984.7762 | 984.7762 | Allowed |
| 2 | 407 | Inefficient Algorithmic Complexity | 974.1680 | 974.1680 | Allowed-with-Review |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | 963.3897 | 963.3897 | Allowed |
| 4 | 1269 | Product Released in Non-Release Configuration | 959.8589 | 959.8589 | Allowed |
| 5 | 400 | Uncontrolled Resource Consumption | 959.7393 | 959.7393 | Discouraged |
| 6 | 863 | Incorrect Authorization | 945.4116 | 945.4116 | Allowed-with-Review |
| 7 | 345 | Insufficient Verification of Data Authenticity | 936.4804 | 936.4804 | Discouraged |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | 930.5659 | 930.5659 | Allowed |
| 9 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 930.5600 | 930.5600 | Allowed |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 928.5681 | 928.5681 | Allowed |
| 11 | 416 | Use After Free | 800.0000 | 800.0000 | Allowed |
| 12 | 825 | Expired Pointer Dereference | 800.0000 | 800.0000 | Allowed |
