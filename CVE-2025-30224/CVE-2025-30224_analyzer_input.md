# Vulnerability Information: CVE-2025-30224

## Vulnerability Description
MyDumper is a MySQL Logical Backup Tool. The MySQL C client library (libmysqlclient) allows authenticated remote actors to read arbitrary files from client systems via a crafted server response to **LOAD LOCAL INFILE query**, leading to sensitive information disclosure when clients connect to untrusted MySQL servers without explicitly disabling the local infile capability. Mydumper has the local infile option enabled by default and does not have an option to disable it. This can lead to an unexpected arbitrary file read if the Mydumper tool connects to an untrusted server. This vulnerability is fixed in 0.18.2-8.

### Vulnerability Description Key Phrases
- **weakness:** **LOAD LOCAL INFILE query**
- **impact:** information disclosure and read arbitrary files
- **vector:** crafted server response
- **attacker:** authenticated remote actors
- **product:** Mydumper
- **version:** prior to 0.18.2-8
- **component:** local infile option

## CVE Reference Links Content Summary
## Analysis of CVE-2025-30224 based on provided content:

**1. Verification:**

Both provided content snippets relate to CVE-2025-30224. The GitHub advisory explicitly mentions the CVE ID and details a vulnerability in mydumper related to the MySQL client library. The Debian security announcement also references the CVE ID and confirms a security update for mydumper.

**2. Extracted Information:**

**Root cause of vulnerability:**

The root cause is a vulnerability in the MySQL C client library (libmysqlclient) that allows authenticated remote actors to read arbitrary files from client systems via a crafted server response to a `LOAD LOCAL INFILE` query.

**Weaknesses/vulnerabilities present:**

*   The MySQL C client library is vulnerable to arbitrary file read.
*   Mydumper has the `local_infile` option enabled by default and lacks a mechanism to disable it.

**Impact of exploitation:**

*   Sensitive information disclosure.
*   Arbitrary file read from the client system.

**Attack vectors:**

*   A crafted server response to a `LOAD LOCAL INFILE` query.
*   Connecting Mydumper to an untrusted MySQL server.

**Required attacker capabilities/position:**

*   Authenticated remote actor (access to the MySQL server).
*   Ability to craft a malicious server response.

**Mitigation or fix:**

*   Upgrade mydumper to version 0.10.1-1+deb11u1 (Debian 11 bullseye).
*   The GitHub advisory suggests introducing a `--local-infile` option to mydumper, similar to the MySQL client, to allow disabling the feature.

**Additional Details (more than official CVE description):**

*   **Proof-of-Concept:** The GitHub advisory provides a detailed proof-of-concept demonstrating the vulnerability using Docker and a MySQL server with the `local_infile` option enabled and a query rewriter plugin.
*   **CVSS Score:** The GitHub advisory includes a CVSS v3 score of 6.8 (Moderate).
*   **CVSS Metrics:** Detailed breakdown of CVSS v3 base metrics (Attack Vector, Attack Complexity, Privileges Required, User Interaction, Scope, Confidentiality, Integrity, Availability).
*   **References:** A link to a Medium article detailing the attack chain is provided.
*   **Debian Specifics:** The Debian announcement specifies the affected version (0.10.1-1+deb11u1) and the Debian bug number (#1102002).
*   **PGP Signature:** The Debian announcement includes a PGP signature for verification.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.458 |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.455 |
| 3 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.451 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.450 |
| 5 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.449 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.447 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.447 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.442 |
| 9 | 619 | Dangling Database Cursor ('Cursor Injection') | Base | Allowed | dense | 0.435 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |

