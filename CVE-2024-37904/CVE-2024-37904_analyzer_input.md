# Vulnerability Information: CVE-2024-37904

## Vulnerability Description
Minder is an open source Software Supply Chain Security Platform. Minders Git provider is vulnerable to a denial of service from a maliciously configured GitHub repository. The Git provider clones users repositories using the `github.com/go-git/go-git/v5` library on lines `L55-L89`. The Git provider does the following on the lines `L56-L62`. First, it sets the `CloneOptions`, specifying the url, the depth etc. It then validates the options. It then sets up an in-memory filesystem, to which it clones and Finally, it clones the repository. The `(g *Git) Clone()` method is vulnerable to a DoS attack A Minder user can instruct Minder to clone a large repository which will exhaust memory and crash the Minder server. The root cause of this vulnerability is a combination of the following conditions 1. Users can control the Git URL which Minder clones, 2. Minder **does not enforce a size limit** to the repository, 3. Minder clones the entire repository into memory. This issue has been addressed in commit `7979b43` which has been included in release version v0.0.52. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **does not enforce a size limit**
- **impact:** DoS attack and denial of service and exhaust memory and crash
- **vector:** maliciously configured GitHub repository
- **product:** Minder
- **version:** before v0.0.52
- **component:** Git provider

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Vulnerability:** Denial of Service (DoS)

**Root Cause:**
The vulnerability stems from the `Clone` function in Minder's Git provider, which clones Git repositories into memory without enforcing size limits. This allows a malicious user to trigger excessive memory consumption by instructing Minder to clone an extremely large repository. The combination of user-controlled Git URLs, lack of size limits, and cloning the entire repository into memory are the underlying causes.

**Weaknesses/Vulnerabilities:**
- Unrestricted Git URL input allows users to specify any repository.
- Lack of repository size limits.
- The entire repository is cloned into memory.

**Impact of Exploitation:**
- Memory exhaustion on the Minder server.
- Potential crashing or termination of the Minder server (SigKill).
- Denial of service for other users.

**Attack Vectors:**
- Maliciously configured Git repository.
- A user providing a URL to an extremely large Git repository for cloning.

**Required Attacker Capabilities/Position:**
- A legitimate user of the Minder system with the ability to specify the Git repository URL to clone.
- No special privileges are required, just the capability to interact with the system's cloning functionality.

**Additional Details:**
- The vulnerability is in the `internal/providers/git/git.go` file of the Minder project.
- The vulnerable code uses the `github.com/go-git/go-git/v5` library for Git operations.
- The fix introduces size limits for both the number of files and the total size of the repository cloned into the system.
- The fix introduces a custom `memboxfs` filesystem that allows specifying file count and size limits to avoid memory exhaustion.
- A proof-of-concept (PoC) is provided, demonstrating the memory exhaustion with a large git repo and multiple concurrent clone requests.
- The vulnerability has a CVSS v3 base score of 5.7 (Moderate), with a high impact on availability.

**Patched Version**:
The vulnerability is fixed in version `0.20240612.2316+ref.7979b43`.

This information is more detailed than a typical CVE description, providing a clear understanding of the vulnerability, its cause, impact, and how it can be exploited.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 1.118 |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 1.089 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 1.065 |
| 4 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 1.042 |
| 5 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 1.032 |
| 6 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 1.022 |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 1.014 |
| 8 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | Allowed | sparse | 1.013 |
| 9 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | dense | 0.468 |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | Base | Allowed | graph | 0.002 |

