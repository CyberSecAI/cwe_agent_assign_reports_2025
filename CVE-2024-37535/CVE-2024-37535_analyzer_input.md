# Vulnerability Information: CVE-2024-37535

## Vulnerability Description
GNOME VTE before 0.76.3 allows an attacker to cause a denial of service (memory consumption) via a window resize escape sequence, a related issue to CVE-2000-0476.

### Vulnerability Description Key Phrases
- **impact:** denial of service (memory consumption)
- **vector:** window resize escape sequence
- **attacker:** attacker
- **product:** GNOME VTE
- **version:** before 0.76.3

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-37535:

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient validation of terminal resize requests within the GNOME VTE library. Specifically, it arises from the processing of ANSI escape sequences used for resizing the terminal window.

**Weaknesses/Vulnerabilities Present:**
- **Unbounded Resource Consumption:** The vulnerability allows an attacker to specify arbitrarily large values for the terminal window's height and width via a specific escape sequence (`e[4;;t`). This leads to excessive memory allocation.
- **Lack of Input Sanitization:** The application fails to properly sanitize or validate the input provided through the escape sequence, leading to the resource exhaustion.
- **Reoccurrence of a known issue:** The vulnerability is a recurrence of a vulnerability previously found in XTerm (CVE-2000-0476).

**Impact of Exploitation:**
- **Denial of Service (DoS):**  By providing extremely large values in the resize escape sequence, an attacker can cause the application to allocate excessive memory. This can lead to the terminal window freezing or, more severely, the entire machine becoming unresponsive. In some cases, it can cause the user to be logged out.

**Attack Vectors:**
- **Direct Input:** An attacker can directly input the malicious escape sequence into a terminal.
- **Indirect Input:** An attacker can embed the malicious escape sequence within a file and trick a user into processing the file. For example, the attacker could host an HTML file with the malicious sequence and have the victim download it using `curl`.

**Required Attacker Capabilities/Position:**
- **Ability to Send/Provide Input:** An attacker needs the ability to send the specially crafted escape sequence to a vulnerable terminal application, either directly or indirectly.
- **No special privileges:** Exploiting this vulnerability does not require any special system privileges.

**Additional Information**
- The vulnerability is present in GNOME VTE versions prior to 0.76.3.
- The fix in version 0.76.3 restricts resize requests to sane values.
- The escape sequence `e[8;height;widtht` is another vulnerable escape sequence for resizing, which accepts sizes in different units. The fix is expected to cover both sequences.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 150 | Improper Neutralization of Escape, Meta, or Control Sequences | Variant | Allowed | sparse | 0.063 |
| 2 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.055 |
| 3 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.052 |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.052 |
| 5 | 179 | Incorrect Behavior Order: Early Validation | Base | Allowed | sparse | 0.052 |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.052 |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.051 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.051 |
| 9 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | dense | 0.542 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |

