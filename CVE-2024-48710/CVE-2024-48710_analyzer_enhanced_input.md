## Vulnerability Description
In TP-Link TL-WDR7660 1.0, the wlanTimerRuleJsonToBin function handles the parameter string name without checking it, which can lead to **stack overflow** vulnerabilities.

### Vulnerability Description Key Phrases
- **rootcause:** **off-by-one error**
- **weakness:** **stack overflow**
- **product:** TP-Link TL-WDR7660
- **version:** 1.0
- **component:** wlanTimerRuleJsonToBin function

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
- The `wlanTimerRuleJsonToBin` function in TP-Link TL-WDR7660 router firmware fails to check the length of the `name` parameter string before processing it.

**Weaknesses/Vulnerabilities Present:**
- **Stack Overflow:** The lack of input validation on the `name` parameter allows an attacker to send an overly long string, causing a buffer overflow on the stack during processing by the `wlanTimerRuleJsonToBin` function.

**Impact of Exploitation:**
- **Denial of Service (DoS):** The provided exploit demonstrates that triggering the stack overflow leads to a crash of the wireless timing switch functionality, effectively disabling it and causing a DoS. The router's web interface also becomes unresponsive in some cases.

**Attack Vectors:**
- **HTTP Request:** The vulnerability is exploited by sending a crafted HTTP POST request to the router's web interface. This request includes a JSON payload containing the oversized `name` parameter.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be on the same network as the vulnerable TP-Link TL-WDR7660 router or have a way to send HTTP requests to it.
- **Authentication:** While the provided exploit code includes a `stok` cookie, the specific method of obtaining this cookie is not provided, but it is implied that the attacker must have some form of authentication to access the router's web interface.

**Additional Notes:**
- The provided exploit script is written in Python using the `requests` library.
- The exploit targets the `add` method of the router's time_switch function.
- The vulnerability exists in version TL-WDR7660 ver1.0.
- The content provides details of before and after exploitation, showing the device's behavior with screenshots.

This information is more detailed than a basic CVE description, which would primarily focus on the vulnerability's existence and general impact.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.187 |
| 4 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.163 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.146 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.146 |
| 7 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.143 |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.142 |
| 9 | 676 | Use of Potentially Dangerous Function | Base | Allowed | dense | 0.482 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-121: Stack-based Buffer Overflow

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-193: Off-by-one Error

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-125: Out-of-bounds Read

CWE-674: Uncontrolled Recursion

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-676: Use of Potentially Dangerous Function

CWE-128: Wrap-around Error