## Vulnerability Description
A vulnerability, which was classified as critical, has been found in exelban stats up to 2.11.21. This issue affects the function shouldAcceptNewConnection of the component XPC Service. The manipulation leads to **command injection**. It is possible to launch the attack on the local host. Upgrading to version 2.11.22 is able to address this issue. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** exelban stats
- **version:** up to 2.11.21
- **component:** shouldAcceptNewConnection of the XPC Service

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on the relevant security information:

*   **Root cause of vulnerability:** The vulnerability stems from the insecure implementation of the XPC service in the Stats application. The `shouldAcceptNewConnection` method unconditionally returns YES (or true), allowing any XPC client to connect without verification. This allows unauthorized clients to connect and invoke methods exposed by the HelperTool interface.
*   **Weaknesses/vulnerabilities present:**
    *   Lack of client verification in the XPC service.
    *   Command injection vulnerability within the `powermetrics` method.
    *   The `setSMCPath` method, along with `setFanSpeed` and `setFanMode`, can also be used to inject commands.
*   **Impact of exploitation:** An attacker can modify hardware settings and execute arbitrary code with root privileges. This includes the ability to destabilize the user's device, potentially leading to overheating or system instability.
*   **Attack vectors:**
    *   An attacker can create a malicious XPC client to connect to the vulnerable service.
    *   The `powermetrics` method is directly exploitable through command injection.
    *   The `setSMCPath` can be used to store an arbitrary command, which is then interpolated into shell commands in `setFanSpeed` and `setFanMode`, leading to further exploitation.
*   **Required attacker capabilities/position:** The attacker needs to be able to execute a custom XPC client on the target system.
*   **Mitigation or fix:** Implement robust client verification mechanisms, including code signing checks and audit token (PID is not secure) verification.

**Note:** This content provides more detail than the official CVE description, including a proof-of-concept and specific methods that are vulnerable.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.446 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.428 |
| 5 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.398 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.397 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.387 |
| 8 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.385 |
| 9 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | dense | 0.580 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-611: Improper Restriction of XML External Entity Reference

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')