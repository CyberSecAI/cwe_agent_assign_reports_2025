# Raw Retriever Results for CVE-2024-11137

# Raw Retriever Results for CVE-2024-11137
## Query
An Insecure Direct Object Reference (IDOR) vulnerability exists in the `PATCH /v1/runs/id/score` endpoint of lunary-ai/lunary version 1.6.0. This vulnerability allows an attacker to update the score data of any run by manipulating the id parameter in the request URL, which corresponds to the `runId_score` in the database. The endpoint does not sufficiently validate whether the authenticated user has permission to modify the specified runId, enabling an attacker with a valid account to modify other users runId scores by specifying different id values. This issue was fixed in version 1.6.1.

## Keyphrases
- **rootcause**: 'insecure direct object reference'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4291 | 0.4831 | 0.4499 | 0.4483 | 20 |
| Sparse | 169.4493 | 1000.0000 | 582.4377 | 526.5430 | 11 |
| Graph | 1.0062 | 2.3296 | 1.2790 | 1.1096 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 306 | Missing Authentication for Critical Function | base | 2.3296 | Allowed |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6904 | Allowed |
| 3 | 918 | Server-Side Request Forgery (SSRF) | Base | 1.6030 | Allowed |
| 4 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 1.6026 | Allowed |
| 5 | 73 | External Control of File Name or Path | base | 1.5210 | Allowed |
| 6 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 1.4791 | Allowed |
| 7 | 862 | Missing Authorization | class | 1.3648 | Allowed-with-Review |
| 8 | 322 | Key Exchange without Entity Authentication | base | 1.3572 | Allowed |
| 9 | 425 | Direct Request ('Forced Browsing') | base | 1.3572 | Allowed |
| 10 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | base | 1.1794 | Allowed |
| 11 | 863 | Incorrect Authorization | Class | 1.0399 | Allowed-with-Review |
| 12 | 804 | Guessable CAPTCHA | base | 1.0062 | Allowed |
| 13 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | base | 1.0062 | Allowed |
| 14 | 1244 | Internal Asset Exposed to Unsafe Debug Access Level or State | base | 1.0062 | Allowed |
| 15 | 288 | Authentication Bypass Using an Alternate Path or Channel | base | 1.0062 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4831 | 0.4831 | Allowed |
| 2 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4773 | 0.4773 | Allowed |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4771 | 0.4771 | Allowed |
| 4 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.4724 | 0.4724 | Allowed |
| 5 | 863 | Incorrect Authorization | Class | 0.4618 | 0.4618 | Allowed-with-Review |
| 6 | 277 | Insecure Inherited Permissions | Variant | 0.4593 | 0.4593 | Allowed |
| 7 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.4588 | 0.4588 | Allowed |
| 8 | 267 | Privilege Defined With Unsafe Actions | Base | 0.4548 | 0.4548 | Allowed |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4543 | 0.4543 | Allowed |
| 10 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | 0.4542 | 0.4542 | Allowed-with-Review |
| 11 | 204 | Observable Response Discrepancy | Base | 0.4424 | 0.4424 | Allowed |
| 12 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.4421 | 0.4421 | Allowed |
| 13 | 922 | Insecure Storage of Sensitive Information | Class | 0.4373 | 0.4373 | Allowed-with-Review |
| 14 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.4370 | 0.4370 | Allowed |
| 15 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.4334 | 0.4334 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | 1000.0000 | 1000.0000 | Allowed |
| 2 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 3 | 306 | Missing Authentication for Critical Function | 545.9863 | 545.9863 | Allowed |
| 4 | 863 | Incorrect Authorization | 541.9715 | 541.9715 | Allowed-with-Review |
| 5 | 862 | Missing Authorization | 538.3620 | 538.3620 | Allowed-with-Review |
| 6 | 285 | Improper Authorization | 526.5430 | 526.5430 | Discouraged |
| 7 | 668 | Exposure of Resource to Wrong Sphere | 523.6742 | 523.6742 | Discouraged |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | 521.8770 | 521.8770 | Allowed-with-Review |
| 9 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 520.7512 | 520.7512 | Allowed-with-Review |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 518.2001 | 518.2001 | Allowed |
| 11 | 269 | Improper Privilege Management | 169.4493 | 169.4493 | Discouraged |
