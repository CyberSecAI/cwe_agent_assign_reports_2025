# Raw Retriever Results for CVE-2024-47824

# Raw Retriever Results for CVE-2024-47824
## Query
matrix-react-sdk is react-based software development kit for inserting a Matrix chat/VOIP client into a web page. Starting in version 3.18.0 and before 3.102.0, matrix-react-sdk allows a malicious homeserver to potentially steal message keys for a room when a user invites another user to that room, via injection of a malicious device controlled by the homeserver. This is possible because matrix-react-sdk before 3.102.0 shared historical message keys on invite. Version 3.102.0 fixes this issue by disabling sharing message keys on invite by removing calls to the vulnerable functionality. No known workarounds are available.

## Keyphrases
- **rootcause**: 'sharing message keys on invite'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3536 | 0.4026 | 0.3724 | 0.3702 | 20 |
| Sparse | 155.6368 | 702.6669 | 500.1284 | 513.6185 | 11 |
| Graph | 1.5802 | 2.6784 | 1.9498 | 1.8624 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.6784 | Allowed |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 2.3531 | Allowed |
| 3 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 4 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 5 | 117 | Improper Output Neutralization for Logs | base | 2.2100 | Allowed |
| 6 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.1936 | Allowed |
| 7 | 613 | Insufficient Session Expiration | base | 2.0930 | Allowed |
| 8 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 2.0400 | Allowed |
| 9 | 322 | Key Exchange without Entity Authentication | Base | 1.8692 | Allowed |
| 10 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 1.8648 | Allowed |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | Base | 1.8600 | Allowed |
| 12 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.8394 | Allowed |
| 13 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 14 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 15 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 290 | Authentication Bypass by Spoofing | Base | 0.4026 | 0.4026 | Allowed |
| 2 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.3892 | 0.3892 | Allowed |
| 3 | 322 | Key Exchange without Entity Authentication | Base | 0.3882 | 0.3882 | Allowed |
| 4 | 863 | Incorrect Authorization | Class | 0.3834 | 0.3834 | Allowed-with-Review |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 0.3831 | 0.3831 | Allowed |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.3827 | 0.3827 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.3811 | 0.3811 | Allowed |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.3797 | 0.3797 | Allowed |
| 9 | 346 | Origin Validation Error | Class | 0.3766 | 0.3766 | Allowed-with-Review |
| 10 | 1333 | Inefficient Regular Expression Complexity | Base | 0.3760 | 0.3760 | Allowed |
| 11 | 790 | Improper Filtering of Special Elements | Class | 0.3644 | 0.3644 | Allowed-with-Review |
| 12 | 1287 | Improper Validation of Specified Type of Input | Base | 0.3643 | 0.3643 | Allowed |
| 13 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.3641 | 0.3641 | Allowed-with-Review |
| 14 | 1385 | Missing Origin Validation in WebSockets | Variant | 0.3625 | 0.3625 | Allowed |
| 15 | 294 | Authentication Bypass by Capture-replay | Base | 0.3625 | 0.3625 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 290 | Authentication Bypass by Spoofing | 702.6669 | 702.6669 | Allowed |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 565.6510 | 565.6510 | Allowed |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | 541.3983 | 541.3983 | Allowed |
| 4 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 521.3007 | 521.3007 | Allowed |
| 5 | 863 | Incorrect Authorization | 514.1874 | 514.1874 | Allowed-with-Review |
| 6 | 1333 | Inefficient Regular Expression Complexity | 513.6185 | 513.6185 | Allowed |
| 7 | 116 | Improper Encoding or Escaping of Output | 505.4009 | 505.4009 | Allowed-with-Review |
| 8 | 322 | Key Exchange without Entity Authentication | 503.7198 | 503.7198 | Allowed |
| 9 | 400 | Uncontrolled Resource Consumption | 495.7732 | 495.7732 | Discouraged |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | 482.0588 | 482.0588 | Allowed |
| 11 | 138 | Improper Neutralization of Special Elements | 155.6368 | 155.6368 | Discouraged |
