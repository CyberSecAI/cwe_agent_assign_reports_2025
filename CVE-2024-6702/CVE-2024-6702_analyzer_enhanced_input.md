## Vulnerability Description
Pega Platform versions 8.1 to Infinity 24.1.2 are affected by an **HTML Injection** issue with Stage.

### Vulnerability Description Key Phrases
- **weakness:** **HTML Injection**
- **product:** Pega Platform
- **version:** 8.1 to Infinity 24.1.2
- **component:** Stage

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-6702.

**Root cause of vulnerability:**
The vulnerability is caused by an HTML Injection issue with the Stage functionality of Pega Platform.

**Weaknesses/vulnerabilities present:**
HTML Injection vulnerability, which allows an attacker to inject arbitrary HTML tags into the application.

**Impact of exploitation:**
An attacker could inject malicious HTML into the application, potentially leading to phishing attacks, defacement of the application, or other malicious activities.

**Attack vectors:**
The attack is initiated by sending a malicious link to a user and enticing the user to click it.

**Required attacker capabilities/position:**
The attacker must be an authorized Pega user with developer access.

**Additional Details:**

*   The vulnerability affects Pega Platform versions from 8.1 up to 24.1.2.
*   The vulnerability is rated as Medium severity with a CVSS score of 5.2.
*   Remediation is available via hotfixes or patch releases, depending on the Pega Platform version.
*   For versions 23.1.2 and 24.1.1, specific hotfixes (HFIX-B1770 and HFIX-B1769, respectively) are available.
*   Pega Cloud clients will have the remediation applied proactively by Pega.
*   On-premises and client-managed cloud clients must apply the hotfixes themselves.
*   The advisory also mentions two related XSS vulnerabilities (CVE-2024-6700 and CVE-2024-6701) but the main focus is on the HTML injection vulnerability (CVE-2024-6702)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.114 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.112 |
| 4 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.111 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.108 |
| 6 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | sparse | 0.103 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.103 |
| 8 | 838 | Inappropriate Encoding for Output Context | Base | Allowed | sparse | 0.102 |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | dense | 0.542 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-138: Improper Neutralization of Special Elements

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-838: Inappropriate Encoding for Output Context

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-494: Download of Code Without Integrity Check