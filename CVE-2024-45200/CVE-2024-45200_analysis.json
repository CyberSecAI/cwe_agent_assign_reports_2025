{
  "cve_id": "CVE-2024-45200",
  "description": "In Nintendo Mario Kart 8 Deluxe before 3.0.3, the LAN/LDN local multiplayer implementation allows a remote attacker to exploit a **stack-based buffer overflow** upon **deserialization** of session information via a malformed browse-reply packet, aka KartLANPwn. The victim is not required to join a game session with an attacker. The victim must open the Wireless Play (or LAN Play) menu from the games title screen, and an attacker nearby (LDN) or on the same LAN network as the victim can send a crafted reply packet to the victims console. This enables a remote attacker to obtain complete denial-of-service on the games process, or potentially, remote code execution on the victims console. The issue is caused by **incorrect use of the Nintendo Pia library**,",
  "key_phrases": {
    "rootcause": "incorrect use of the Nintendo Pia library",
    "weakness": [
      "deserialization",
      "stack-based buffer overflow"
    ],
    "impact": [
      "['obtain complete denial-of-service on the games process'",
      "'remote code execution']"
    ],
    "vector": "malformed browse-reply packet",
    "attacker": "remote attacker",
    "product": "Nintendo Mario Kart 8 Deluxe",
    "version": "before 3.0.3",
    "component": "LAN/LDN local multiplayer implementation"
  },
  "reference_content": "Based on the provided content, here's a breakdown of the vulnerability:\n\n**Root cause of vulnerability:**\n\n*   The vulnerability stems from an incorrect usage of the `Pia` P2P networking library in Mario Kart 8 Deluxe. Specifically, the `LAN_CopyAppData` function is sometimes called with an `outBufSize` argument that is larger than the actual `out` buffer.\n\n**Weaknesses/vulnerabilities present:**\n\n*   **Stack-based buffer overflow:** The `LAN_CopyAppData` function copies data from a network packet into a stack buffer. Due to the incorrect size check, an attacker can provide a size of application data larger than the destination buffer, causing a buffer overflow on the stack.\n\n**Impact of exploitation:**\n\n*   **Denial of Service (DoS):** The provided proof-of-concept crashes the game's process.\n*   **Potential remote code execution (RCE):** While the proof-of-concept is a crash, the overflow *could* lead to user-mode remote code execution if chained with an info leak, however, this was determined to be not very feasible given the Switch kernel's usermode restrictions.\n\n**Attack vectors:**\n\n*   **Network:** The vulnerability is triggered through specially crafted \"browse-reply\" packets sent over the network, specifically in the LAN/LDN multiplayer mode.\n\n**Required attacker capabilities/position:**\n\n*   The attacker needs to be on the same local network as the target Nintendo Switch console.\n*   The attacker needs to be able to send UDP packets to the target console (acting as a fake room host).\n*   The attacker would need to have a way to discover the target console (e.g. by sending broadcast requests).\n\n**Additional notes:**\n\n*   The vulnerability affects all versions of Mario Kart 8 Deluxe up to and including v3.0.1 (v3.0.2 for China/Tencent).\n*   Nintendo released a fix in v3.0.3 of the game.\n*   The `Pia` library is used by first-party Nintendo Switch games for peer-to-peer networking in both local (LAN/LDN) and online (NEX) multiplayer.\n*   The vulnerability was triggered by manipulating the length of application data in a browse-reply packet sent by the room host.\n*   The stack overflow overwrite was able to corrupt the return address on the stack and trigger a process crash.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-121 | Stack-based Buffer Overflow | 1.0 | Base | Primary | Allowed |\n| CWE-502 | Deserialization of Untrusted Data | 0.7 | Class | Secondary | Allowed |\n| CWE-20 | Improper Input Validation | 0.6 | Class | Secondary | Discouraged |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is a **stack-based buffer overflow** (CWE-121). This is triggered by **deserializing** untrusted data (CWE-502) without proper input validation (CWE-20). CWE-121 is a base-level CWE and a specific type of buffer overflow that occurs on the stack. CWE-502 is a class-level CWE that describes the general problem of deserializing untrusted data, and in this case, that data leads to a buffer overflow. CWE-20 is a class-level CWE and is generally not preferred as it is too broad, but it is included as a contributing factor, the **improper input validation** is the cause of the **deserialization** leading to the **stack-based buffer overflow.**\n\n```mermaid\ngraph TD\n    cwe121[\"CWE-121: Stack-based Buffer Overflow\"]\n    cwe502[\"CWE-502: Deserialization of Untrusted Data\"]\n    cwe20[\"CWE-20: Improper Input Validation\"]\n    \n    cwe121 <--|CAUSED_BY| cwe502\n    cwe502 <--|LACK_OF| cwe20\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe121 primary\n    class cwe502,cwe20 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **improper input validation** (CWE-20), which leads to the **deserialization of untrusted data** (CWE-502). This, in turn, causes a **stack-based buffer overflow** (CWE-121), resulting in a denial of service or remote code execution.\n\nCWE-20 (Improper Input Validation) -> CWE-502 (Deserialization of Untrusted Data) -> CWE-121 (Stack-based Buffer Overflow) -> Denial of Service / Remote Code Execution\n\n## Summary of Analysis\nThe initial assessment identified **CWE-121 (Stack-based Buffer Overflow)** as the primary weakness due to the explicit mention in the vulnerability description. The analysis also considered the **deserialization** process and the **incorrect use of the Nintendo Pia library.**\n\nThe relationship graph highlights how **improper input validation** leads to **deserialization of untrusted data**, which then causes the **stack-based buffer overflow**. The selected CWEs are at the optimal level of specificity, with CWE-121 being a base-level CWE that directly describes the buffer overflow, and CWE-502 being a class-level CWE that describes the higher-level issue of deserializing untrusted data. CWE-20 is included as the root cause of the **improper validation** of the data.\n\nThe vulnerability description clearly states that the **stack-based buffer overflow** occurs upon **deserialization** of session information. This directly supports the selection of CWE-121 as the primary CWE. The mention of **incorrect use of the Nintendo Pia library** suggests a potential **improper input validation** issue, further supporting the inclusion of CWE-20. The combination of these factors provides a comprehensive understanding of the vulnerability and justifies the selected CWEs.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-345: Insufficient Verification of Data Authenticity\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n*Rejected:* Not directly related to the buffer overflow, focuses more on authenticity rather than data integrity.\n\n## CWE-138: Improper Neutralization of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n*Rejected:* Not directly related to the buffer overflow, focuses more on neutralization of special elements.\n\n## CWE-703: Improper Check or Handling of Exceptional Conditions\n**Abstraction Level**: Pillar\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is extremely high-level, a Pillar.\n\n*Rejected:* Too abstract and not specific to the buffer overflow.\n\n## CWE-824: Access of Uninitialized Pointer\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product accesses or uses a pointer that has not been initialized.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n*Rejected:* Not related to the buffer overflow.\n\n## CWE-134: Use of Externally-Controlled Format String\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product uses a function that accepts a format string as an argument, but the format string originates from an external source.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n*Rejected:* Not related to the buffer overflow.\n\n## CWE-696: Incorrect Behavior Order\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n*Rejected:* Not related to the buffer overflow.\n\n## CWE-131: Incorrect Calculation of Buffer Size\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not correctly calculate the size to be used when allocating a buffer, which could lead to a buffer overflow.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n*Rejected:* While it could be a contributing factor, the primary issue is the **lack of validation** of the input during **deserialization**, leading to the overflow.\n\n## CWE-755: Improper Handling of Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not handle or incorrectly handles an exceptional condition.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n*Rejected:* Too abstract and not specific to the buffer overflow.\n\n## CWE-129: Improper Validation of Array Index\n**Abstraction Level**: Variant\n**Similarity Score**: 0.72\n**Source**: dense\n\n**Description**:\nThe product uses untrusted input when calculating or using an array index, but the product does not validate or incorrectly validates the index to ensure the index references a valid position within the array.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n*Rejected:* Not directly related to the buffer overflow in this case.\n\n## CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-121 | Stack-based Buffer Overflow | 1.0 | Base | Primary | Allowed |\n| CWE-502 | Deserialization of Untrusted Data | 0.7 | Class | Secondary | Allowed |\n| CWE-20 | Improper Input Validation | 0.6 | Class | Secondary | Discouraged |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is a **stack-based buffer overflow** (CWE-121). This is triggered by **deserializing** untrusted data (CWE-502) without proper input validation (CWE-20). CWE-121 is a base-level CWE and a specific type of buffer overflow that occurs on the stack. CWE-502 is a class-level CWE that describes the general problem of deserializing untrusted data, and in this case, that data leads to a buffer overflow. CWE-20 is a class-level CWE and is generally not preferred as it is too broad, but it is included as a contributing factor, the **improper input validation** is the cause of the **deserialization** leading to the **stack-based buffer overflow.**\n\n```mermaid\ngraph TD\n    cwe121[\"CWE-121: Stack-based Buffer Overflow\"]\n    cwe502[\"CWE-502: Deserialization of Untrusted Data\"]\n    cwe20[\"CWE-20: Improper Input Validation\"]\n    \n    cwe121 <--|CAUSED_BY| cwe502\n    cwe502 <--|LACK_OF| cwe20\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe121 primary\n    class cwe502,cwe20 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **improper input validation** (CWE-20), which leads to the **deserialization of untrusted data** (CWE-502). This, in turn, causes a **stack-based buffer overflow** (CWE-121), resulting in a denial of service or remote code execution.\n\nCWE-20 (Improper Input Validation) -> CWE-502 (Deserialization of Untrusted Data) -> CWE-121 (Stack-based Buffer Overflow) -> Denial of Service / Remote Code Execution\n\n## Summary of Analysis\nThe initial assessment identified **CWE-121 (Stack-based Buffer Overflow)** as the primary weakness due to the explicit mention in the vulnerability description. The analysis also considered the **deserialization** process and the **incorrect use of the Nintendo Pia library.**\n\nThe relationship graph highlights how **improper input validation** leads to **deserialization of untrusted data**, which then causes the **stack-based buffer overflow**. The selected CWEs are at the optimal level of specificity, with CWE-121 being a base-level CWE that directly describes the buffer overflow, and CWE-502 being a class-level CWE that describes the higher-level issue of deserializing untrusted data. CWE-20 is included as the root cause of the **improper validation** of the data.\n\nThe vulnerability description clearly states that the **stack-based buffer overflow** occurs upon **deserialization** of session information. This directly supports the selection of CWE-121 as the primary CWE. The mention of **incorrect use of the Nintendo Pia library** suggests a potential **improper input validation** issue, further supporting the inclusion of CWE-20. The combination of these factors provides a comprehensive understanding of the vulnerability and justifies the selected CWEs.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-345: Insufficient Verification of Data Authenticity\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n*Rejected:* Not directly related to the buffer overflow, focuses more on authenticity rather than data integrity.\n\n## CWE-138: Improper Neutralization of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n*Rejected:* Not directly related to the buffer overflow, focuses more on neutralization of special elements.\n\n## CWE-703: Improper Check or Handling of Exceptional Conditions\n**Abstraction Level**: Pillar\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is extremely high-level, a Pillar.\n\n*Rejected:* Too abstract and not specific to the buffer overflow.\n\n## CWE-824: Access of Uninitialized Pointer\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product accesses or uses a pointer that has not been initialized.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n*Rejected:* Not related to the buffer overflow.\n\n## CWE-134: Use of Externally-Controlled Format String\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product uses a function that accepts a format string as an argument, but the format string originates from an external source.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n*Rejected:* Not related to the buffer overflow.\n\n## CWE-696: Incorrect Behavior Order\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n*Rejected:* Not related to the buffer overflow.\n\n## CWE-131: Incorrect Calculation of Buffer Size\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not correctly calculate the size to be used when allocating a buffer, which could lead to a buffer overflow.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n*Rejected:* While it could be a contributing factor, the primary issue is the **lack of validation** of the input during **deserialization**, leading to the overflow.\n\n## CWE-755: Improper Handling of Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not handle or incorrectly handles an exceptional condition.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n*Rejected:* Too abstract and not specific to the buffer overflow.\n\n## CWE-129: Improper Validation of Array Index\n**Abstraction Level**: Variant\n**Similarity Score**: 0.72\n**Source**: dense\n\n**Description**:\nThe product uses untrusted input when calculating or using an array index, but the product does not validate or incorrectly validates the index to ensure the index references a valid position within the array.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n*Rejected:* Not directly related to the buffer overflow in this case.\n\n## CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-502:**\n- 502 (Deserialization of Untrusted Data) - ROOT\n\n\n**Chain starting from CWE-121:**\n- 121 (Stack-based Buffer Overflow) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "121",
        "name": "Stack-based Buffer Overflow",
        "source": "sparse",
        "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).",
        "keyphrase_sources": [
          {
            "id": "rootcause:incorrect use of the Nintendo Pia library",
            "keyphrase": "incorrect use of the Nintendo Pia library",
            "type": "rootcause"
          },
          {
            "id": "weakness:deserialization",
            "keyphrase": "deserialization",
            "type": "weakness"
          },
          {
            "id": "weakness:stack-based buffer overflow",
            "keyphrase": "stack-based buffer overflow",
            "type": "weakness"
          },
          {
            "id": "impact:['obtain complete denial-of-service on the games process'",
            "keyphrase": "['obtain complete denial-of-service on the games process'",
            "type": "impact"
          },
          {
            "id": "impact:'remote code execution']",
            "keyphrase": "'remote code execution']",
            "type": "impact"
          },
          {
            "id": "vector:malformed browse-reply packet",
            "keyphrase": "malformed browse-reply packet",
            "type": "vector"
          },
          {
            "id": "attacker:remote attacker",
            "keyphrase": "remote attacker",
            "type": "attacker"
          },
          {
            "id": "product:Nintendo Mario Kart 8 Deluxe",
            "keyphrase": "Nintendo Mario Kart 8 Deluxe",
            "type": "product"
          },
          {
            "id": "version:before 3.0.3",
            "keyphrase": "before 3.0.3",
            "type": "version"
          },
          {
            "id": "component:LAN/LDN local multiplayer implementation",
            "keyphrase": "LAN/LDN local multiplayer implementation",
            "type": "component"
          }
        ]
      },
      "similarity": 761.092288636683
    },
    {
      "metadata": {
        "doc_id": "20",
        "name": "Improper Input Validation",
        "source": "sparse",
        "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
        "keyphrase_sources": [
          {
            "id": "rootcause:incorrect use of the Nintendo Pia library",
            "keyphrase": "incorrect use of the Nintendo Pia library",
            "type": "rootcause"
          },
          {
            "id": "weakness:deserialization",
            "keyphrase": "deserialization",
            "type": "weakness"
          },
          {
            "id": "weakness:stack-based buffer overflow",
            "keyphrase": "stack-based buffer overflow",
            "type": "weakness"
          },
          {
            "id": "impact:['obtain complete denial-of-service on the games process'",
            "keyphrase": "['obtain complete denial-of-service on the games process'",
            "type": "impact"
          },
          {
            "id": "impact:'remote code execution']",
            "keyphrase": "'remote code execution']",
            "type": "impact"
          },
          {
            "id": "vector:malformed browse-reply packet",
            "keyphrase": "malformed browse-reply packet",
            "type": "vector"
          },
          {
            "id": "attacker:remote attacker",
            "keyphrase": "remote attacker",
            "type": "attacker"
          },
          {
            "id": "product:Nintendo Mario Kart 8 Deluxe",
            "keyphrase": "Nintendo Mario Kart 8 Deluxe",
            "type": "product"
          },
          {
            "id": "version:before 3.0.3",
            "keyphrase": "before 3.0.3",
            "type": "version"
          },
          {
            "id": "component:LAN/LDN local multiplayer implementation",
            "keyphrase": "LAN/LDN local multiplayer implementation",
            "type": "component"
          }
        ]
      },
      "similarity": 754.2824206040526
    },
    {
      "metadata": {
        "doc_id": "119",
        "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
        "source": "sparse",
        "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
        "keyphrase_sources": [
          {
            "id": "rootcause:incorrect use of the Nintendo Pia library",
            "keyphrase": "incorrect use of the Nintendo Pia library",
            "type": "rootcause"
          },
          {
            "id": "weakness:deserialization",
            "keyphrase": "deserialization",
            "type": "weakness"
          },
          {
            "id": "impact:'remote code execution']",
            "keyphrase": "'remote code execution']",
            "type": "impact"
          },
          {
            "id": "vector:malformed browse-reply packet",
            "keyphrase": "malformed browse-reply packet",
            "type": "vector"
          },
          {
            "id": "attacker:remote attacker",
            "keyphrase": "remote attacker",
            "type": "attacker"
          },
          {
            "id": "product:Nintendo Mario Kart 8 Deluxe",
            "keyphrase": "Nintendo Mario Kart 8 Deluxe",
            "type": "product"
          },
          {
            "id": "version:before 3.0.3",
            "keyphrase": "before 3.0.3",
            "type": "version"
          },
          {
            "id": "component:LAN/LDN local multiplayer implementation",
            "keyphrase": "LAN/LDN local multiplayer implementation",
            "type": "component"
          }
        ]
      },
      "similarity": 744.862368484095
    },
    {
      "metadata": {
        "doc_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "source": "sparse",
        "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
        "keyphrase_sources": [
          {
            "id": "rootcause:incorrect use of the Nintendo Pia library",
            "keyphrase": "incorrect use of the Nintendo Pia library",
            "type": "rootcause"
          },
          {
            "id": "weakness:deserialization",
            "keyphrase": "deserialization",
            "type": "weakness"
          },
          {
            "id": "weakness:stack-based buffer overflow",
            "keyphrase": "stack-based buffer overflow",
            "type": "weakness"
          },
          {
            "id": "impact:['obtain complete denial-of-service on the games process'",
            "keyphrase": "['obtain complete denial-of-service on the games process'",
            "type": "impact"
          },
          {
            "id": "impact:'remote code execution']",
            "keyphrase": "'remote code execution']",
            "type": "impact"
          },
          {
            "id": "vector:malformed browse-reply packet",
            "keyphrase": "malformed browse-reply packet",
            "type": "vector"
          },
          {
            "id": "attacker:remote attacker",
            "keyphrase": "remote attacker",
            "type": "attacker"
          },
          {
            "id": "product:Nintendo Mario Kart 8 Deluxe",
            "keyphrase": "Nintendo Mario Kart 8 Deluxe",
            "type": "product"
          },
          {
            "id": "version:before 3.0.3",
            "keyphrase": "before 3.0.3",
            "type": "version"
          },
          {
            "id": "component:LAN/LDN local multiplayer implementation",
            "keyphrase": "LAN/LDN local multiplayer implementation",
            "type": "component"
          }
        ]
      },
      "similarity": 737.9183240445844
    },
    {
      "metadata": {
        "doc_id": "122",
        "name": "Heap-based Buffer Overflow",
        "source": "sparse",
        "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().",
        "keyphrase_sources": [
          {
            "id": "rootcause:incorrect use of the Nintendo Pia library",
            "keyphrase": "incorrect use of the Nintendo Pia library",
            "type": "rootcause"
          },
          {
            "id": "weakness:stack-based buffer overflow",
            "keyphrase": "stack-based buffer overflow",
            "type": "weakness"
          },
          {
            "id": "impact:'remote code execution']",
            "keyphrase": "'remote code execution']",
            "type": "impact"
          },
          {
            "id": "vector:malformed browse-reply packet",
            "keyphrase": "malformed browse-reply packet",
            "type": "vector"
          },
          {
            "id": "attacker:remote attacker",
            "keyphrase": "remote attacker",
            "type": "attacker"
          },
          {
            "id": "product:Nintendo Mario Kart 8 Deluxe",
            "keyphrase": "Nintendo Mario Kart 8 Deluxe",
            "type": "product"
          },
          {
            "id": "version:before 3.0.3",
            "keyphrase": "before 3.0.3",
            "type": "version"
          }
        ]
      },
      "similarity": 734.0618008758673
    },
    {
      "metadata": {
        "doc_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "source": "sparse",
        "original_content": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
        "keyphrase_sources": [
          {
            "id": "weakness:stack-based buffer overflow",
            "keyphrase": "stack-based buffer overflow",
            "type": "weakness"
          }
        ]
      },
      "similarity": 701.176993226718
    },
    {
      "metadata": {
        "doc_id": "502",
        "name": "Deserialization of Untrusted Data",
        "source": "sparse",
        "original_content": "The product deserializes untrusted data without sufficiently ensuring that the resulting data will be valid.",
        "keyphrase_sources": [
          {
            "id": "weakness:deserialization",
            "keyphrase": "deserialization",
            "type": "weakness"
          }
        ]
      },
      "similarity": 655.6304416313677
    },
    {
      "metadata": {
        "doc_id": "290",
        "name": "Authentication Bypass by Spoofing",
        "source": "sparse",
        "original_content": "This attack-focused weakness is caused by incorrectly implemented authentication schemes that are subject to spoofing attacks.",
        "keyphrase_sources": [
          {
            "id": "impact:['obtain complete denial-of-service on the games process'",
            "keyphrase": "['obtain complete denial-of-service on the games process'",
            "type": "impact"
          }
        ]
      },
      "similarity": 261.5185832500627
    },
    {
      "metadata": {
        "doc_id": "787",
        "name": "Out-of-bounds Write",
        "source": "sparse",
        "original_content": "The product writes data past the end, or before the beginning, of the intended buffer.",
        "keyphrase_sources": [
          {
            "id": "impact:['obtain complete denial-of-service on the games process'",
            "keyphrase": "['obtain complete denial-of-service on the games process'",
            "type": "impact"
          }
        ]
      },
      "similarity": 258.60002869042836
    },
    {
      "metadata": {
        "doc_id": "303",
        "name": "Incorrect Implementation of Authentication Algorithm",
        "source": "sparse",
        "original_content": "The requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.",
        "keyphrase_sources": [
          {
            "id": "component:LAN/LDN local multiplayer implementation",
            "keyphrase": "LAN/LDN local multiplayer implementation",
            "type": "component"
          }
        ]
      },
      "similarity": 233.4511869085366
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-502",
      "CWE-121",
      "CWE-345",
      "CWE-131",
      "CWE-1285",
      "CWE-696",
      "CWE-138",
      "CWE-20",
      "CWE-824",
      "CWE-755",
      "CWE-129",
      "CWE-134",
      "CWE-703"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {
    "121": [
      {
        "id": "rootcause:incorrect use of the Nintendo Pia library",
        "keyphrase": "incorrect use of the Nintendo Pia library",
        "type": "rootcause"
      },
      {
        "id": "weakness:deserialization",
        "keyphrase": "deserialization",
        "type": "weakness"
      },
      {
        "id": "weakness:stack-based buffer overflow",
        "keyphrase": "stack-based buffer overflow",
        "type": "weakness"
      },
      {
        "id": "impact:['obtain complete denial-of-service on the games process'",
        "keyphrase": "['obtain complete denial-of-service on the games process'",
        "type": "impact"
      },
      {
        "id": "impact:'remote code execution']",
        "keyphrase": "'remote code execution']",
        "type": "impact"
      },
      {
        "id": "vector:malformed browse-reply packet",
        "keyphrase": "malformed browse-reply packet",
        "type": "vector"
      },
      {
        "id": "attacker:remote attacker",
        "keyphrase": "remote attacker",
        "type": "attacker"
      },
      {
        "id": "product:Nintendo Mario Kart 8 Deluxe",
        "keyphrase": "Nintendo Mario Kart 8 Deluxe",
        "type": "product"
      },
      {
        "id": "version:before 3.0.3",
        "keyphrase": "before 3.0.3",
        "type": "version"
      },
      {
        "id": "component:LAN/LDN local multiplayer implementation",
        "keyphrase": "LAN/LDN local multiplayer implementation",
        "type": "component"
      }
    ],
    "20": [
      {
        "id": "rootcause:incorrect use of the Nintendo Pia library",
        "keyphrase": "incorrect use of the Nintendo Pia library",
        "type": "rootcause"
      },
      {
        "id": "weakness:deserialization",
        "keyphrase": "deserialization",
        "type": "weakness"
      },
      {
        "id": "weakness:stack-based buffer overflow",
        "keyphrase": "stack-based buffer overflow",
        "type": "weakness"
      },
      {
        "id": "impact:['obtain complete denial-of-service on the games process'",
        "keyphrase": "['obtain complete denial-of-service on the games process'",
        "type": "impact"
      },
      {
        "id": "impact:'remote code execution']",
        "keyphrase": "'remote code execution']",
        "type": "impact"
      },
      {
        "id": "vector:malformed browse-reply packet",
        "keyphrase": "malformed browse-reply packet",
        "type": "vector"
      },
      {
        "id": "attacker:remote attacker",
        "keyphrase": "remote attacker",
        "type": "attacker"
      },
      {
        "id": "product:Nintendo Mario Kart 8 Deluxe",
        "keyphrase": "Nintendo Mario Kart 8 Deluxe",
        "type": "product"
      },
      {
        "id": "version:before 3.0.3",
        "keyphrase": "before 3.0.3",
        "type": "version"
      },
      {
        "id": "component:LAN/LDN local multiplayer implementation",
        "keyphrase": "LAN/LDN local multiplayer implementation",
        "type": "component"
      }
    ],
    "119": [
      {
        "id": "rootcause:incorrect use of the Nintendo Pia library",
        "keyphrase": "incorrect use of the Nintendo Pia library",
        "type": "rootcause"
      },
      {
        "id": "weakness:deserialization",
        "keyphrase": "deserialization",
        "type": "weakness"
      },
      {
        "id": "impact:'remote code execution']",
        "keyphrase": "'remote code execution']",
        "type": "impact"
      },
      {
        "id": "vector:malformed browse-reply packet",
        "keyphrase": "malformed browse-reply packet",
        "type": "vector"
      },
      {
        "id": "attacker:remote attacker",
        "keyphrase": "remote attacker",
        "type": "attacker"
      },
      {
        "id": "product:Nintendo Mario Kart 8 Deluxe",
        "keyphrase": "Nintendo Mario Kart 8 Deluxe",
        "type": "product"
      },
      {
        "id": "version:before 3.0.3",
        "keyphrase": "before 3.0.3",
        "type": "version"
      },
      {
        "id": "component:LAN/LDN local multiplayer implementation",
        "keyphrase": "LAN/LDN local multiplayer implementation",
        "type": "component"
      }
    ],
    "1284": [
      {
        "id": "rootcause:incorrect use of the Nintendo Pia library",
        "keyphrase": "incorrect use of the Nintendo Pia library",
        "type": "rootcause"
      },
      {
        "id": "weakness:deserialization",
        "keyphrase": "deserialization",
        "type": "weakness"
      },
      {
        "id": "weakness:stack-based buffer overflow",
        "keyphrase": "stack-based buffer overflow",
        "type": "weakness"
      },
      {
        "id": "impact:['obtain complete denial-of-service on the games process'",
        "keyphrase": "['obtain complete denial-of-service on the games process'",
        "type": "impact"
      },
      {
        "id": "impact:'remote code execution']",
        "keyphrase": "'remote code execution']",
        "type": "impact"
      },
      {
        "id": "vector:malformed browse-reply packet",
        "keyphrase": "malformed browse-reply packet",
        "type": "vector"
      },
      {
        "id": "attacker:remote attacker",
        "keyphrase": "remote attacker",
        "type": "attacker"
      },
      {
        "id": "product:Nintendo Mario Kart 8 Deluxe",
        "keyphrase": "Nintendo Mario Kart 8 Deluxe",
        "type": "product"
      },
      {
        "id": "version:before 3.0.3",
        "keyphrase": "before 3.0.3",
        "type": "version"
      },
      {
        "id": "component:LAN/LDN local multiplayer implementation",
        "keyphrase": "LAN/LDN local multiplayer implementation",
        "type": "component"
      }
    ],
    "122": [
      {
        "id": "rootcause:incorrect use of the Nintendo Pia library",
        "keyphrase": "incorrect use of the Nintendo Pia library",
        "type": "rootcause"
      },
      {
        "id": "weakness:stack-based buffer overflow",
        "keyphrase": "stack-based buffer overflow",
        "type": "weakness"
      },
      {
        "id": "impact:'remote code execution']",
        "keyphrase": "'remote code execution']",
        "type": "impact"
      },
      {
        "id": "vector:malformed browse-reply packet",
        "keyphrase": "malformed browse-reply packet",
        "type": "vector"
      },
      {
        "id": "attacker:remote attacker",
        "keyphrase": "remote attacker",
        "type": "attacker"
      },
      {
        "id": "product:Nintendo Mario Kart 8 Deluxe",
        "keyphrase": "Nintendo Mario Kart 8 Deluxe",
        "type": "product"
      },
      {
        "id": "version:before 3.0.3",
        "keyphrase": "before 3.0.3",
        "type": "version"
      }
    ],
    "502": [
      {
        "id": "weakness:deserialization",
        "keyphrase": "deserialization",
        "type": "weakness"
      }
    ],
    "120": [
      {
        "id": "weakness:stack-based buffer overflow",
        "keyphrase": "stack-based buffer overflow",
        "type": "weakness"
      }
    ],
    "290": [
      {
        "id": "impact:['obtain complete denial-of-service on the games process'",
        "keyphrase": "['obtain complete denial-of-service on the games process'",
        "type": "impact"
      }
    ],
    "787": [
      {
        "id": "impact:['obtain complete denial-of-service on the games process'",
        "keyphrase": "['obtain complete denial-of-service on the games process'",
        "type": "impact"
      }
    ],
    "303": [
      {
        "id": "component:LAN/LDN local multiplayer implementation",
        "keyphrase": "LAN/LDN local multiplayer implementation",
        "type": "component"
      }
    ]
  }
}