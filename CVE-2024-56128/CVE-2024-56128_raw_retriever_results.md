# Raw Retriever Results for CVE-2024-56128

# Raw Retriever Results for CVE-2024-56128
## Query
Incorrect Implementation of Authentication Algorithm in Apache Kafkas SCRAM implementation. Issue Summary Apache Kafkas implementation of the Salted Challenge Response Authentication Mechanism (SCRAM) did not fully adhere to the requirements of RFC 5802 [1]. Specifically, as per RFC 5802, the server must verify that the nonce sent by the client in the second message matches the nonce sent by the server in its first message. However, Kafkas SCRAM implementation did not perform this validation. Impact This vulnerability is exploitable only when an attacker has plaintext access to the SCRAM authentication exchange. However, the usage of SCRAM over plaintext is strongly discouraged as it is considered an insecure practice [2]. Apache Kafka recommends deploying SCRAM exclusively with TLS encryption to protect SCRAM exchanges from interception [3]. Deployments using SCRAM with TLS are not affected by this issue. How to Detect If You Are Impacted If your deployment uses SCRAM authentication over plaintext communication channels (without TLS encryption), you are likely impacted. To check if TLS is enabled, review your server.properties configuration file for listeners property. If you have SASL_PLAINTEXT in the listeners, then you are likely impacted. Fix Details The issue has been addressed by introducing nonce verification in the final message of the SCRAM authentication exchange to ensure compliance with RFC 5802. Affected Versions Apache Kafka versions 0.10.2.0 through 3.9.0, excluding the fixed versions below. Fixed Versions 3.9.0 3.8.1 3.7.2 Users are advised to upgrade to 3.7.2 or later to mitigate this issue. Recommendations for Mitigation Users unable to upgrade to the fixed versions can mitigate the issue by - Using TLS with SCRAM Authentication Always deploy SCRAM over TLS to encrypt authentication exchanges and protect against interception. - Considering Alternative Authentication Mechanisms Evaluate alternative authentication mechanisms, such as PLAIN, Kerberos or OAuth with TLS, which provide additional layers of security.

## Keyphrases
- **rootcause**: 'Incorrect Implementation of Authentication Algorithm'
- **weakness**: 'did not fully adhere to the requirements of RFC 5802'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4430 | 0.5015 | 0.4668 | 0.4600 | 20 |
| Sparse | 1383.3488 | 1613.8310 | 1451.8308 | 1446.3028 | 10 |
| Graph | 1.0342 | 2.3296 | 1.5721 | 1.5042 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1204 | Generation of Weak Initialization Vector (IV) | base | 2.3296 | Allowed |
| 2 | 347 | Improper Verification of Cryptographic Signature | base | 2.3296 | Allowed |
| 3 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 4 | 301 | Reflection Attack in an Authentication Protocol | base | 2.0452 | Allowed |
| 5 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 6 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | 1.6882 | Allowed |
| 7 | 294 | Authentication Bypass by Capture-replay | Base | 1.6866 | Allowed |
| 8 | 319 | Cleartext Transmission of Sensitive Information | Base | 1.6234 | Allowed |
| 9 | 304 | Missing Critical Step in Authentication | Base | 1.6032 | Allowed |
| 10 | 208 | Observable Timing Discrepancy | Base | 1.5075 | Allowed |
| 11 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | 1.5008 | Allowed |
| 12 | 759 | Use of a One-Way Hash without a Salt | Variant | 1.5007 | Allowed |
| 13 | 804 | Guessable CAPTCHA | base | 1.4602 | Allowed |
| 14 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.2880 | Allowed |
| 15 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.2624 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 304 | Missing Critical Step in Authentication | Base | 0.5015 | 0.5015 | Allowed |
| 2 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | 0.5008 | 0.5008 | Allowed |
| 3 | 759 | Use of a One-Way Hash without a Salt | Variant | 0.4958 | 0.4958 | Allowed |
| 4 | 294 | Authentication Bypass by Capture-replay | Base | 0.4958 | 0.4958 | Allowed |
| 5 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | 0.4951 | 0.4951 | Allowed |
| 6 | 307 | Improper Restriction of Excessive Authentication Attempts | Base | 0.4882 | 0.4882 | Allowed |
| 7 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.4746 | 0.4746 | Allowed |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.4694 | 0.4694 | Allowed-with-Review |
| 9 | 649 | Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking | Base | 0.4634 | 0.4634 | Allowed |
| 10 | 328 | Use of Weak Hash | Base | 0.4600 | 0.4600 | Allowed |
| 11 | 287 | Improper Authentication | Class | 0.4599 | 0.4599 | Discouraged |
| 12 | 836 | Use of Password Hash Instead of Password for Authentication | Base | 0.4544 | 0.4544 | Allowed |
| 13 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 0.4494 | 0.4494 | Allowed |
| 14 | 326 | Inadequate Encryption Strength | Class | 0.4494 | 0.4494 | Allowed-with-Review |
| 15 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4493 | 0.4493 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 1613.8310 | 1613.8310 | Allowed-with-Review |
| 2 | 347 | Improper Verification of Cryptographic Signature | 1487.1646 | 1487.1646 | Allowed |
| 3 | 1204 | Generation of Weak Initialization Vector (IV) | 1467.7148 | 1467.7148 | Allowed |
| 4 | 287 | Improper Authentication | 1463.0353 | 1463.0353 | Discouraged |
| 5 | 319 | Cleartext Transmission of Sensitive Information | 1462.3415 | 1462.3415 | Allowed |
| 6 | 863 | Incorrect Authorization | 1430.2641 | 1430.2641 | Allowed-with-Review |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | 1422.7824 | 1422.7824 | Allowed |
| 8 | 306 | Missing Authentication for Critical Function | 1398.0479 | 1398.0479 | Allowed |
| 9 | 304 | Missing Critical Step in Authentication | 1389.7778 | 1389.7778 | Allowed |
| 10 | 346 | Origin Validation Error | 1383.3488 | 1383.3488 | Allowed-with-Review |
