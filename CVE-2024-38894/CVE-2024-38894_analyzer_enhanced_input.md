## Vulnerability Description
WAVLINK WN551K1 found a **command injection** vulnerability through the IP parameter of /cgi-bin/touchlist_sync.cgi.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** WAVLINK WN551K1
- **component:** /cgi-bin/touchlist_sync.cgi

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The `touchlist_sync.cgi` script copies the `v7` parameter to the `v36` buffer without any filtering. The `IP` parameter passed via a GET request to `touchlist_sync.cgi` is used to populate the `v7` parameter, which is then copied into the `v36` buffer. This allows for command injection by passing shell metacharacters and commands within the IP parameter.
- **Weaknesses/vulnerabilities present**: Command Injection vulnerability exists due to lack of proper sanitization of the `IP` parameter before using it in a system command.
- **Impact of exploitation**: An attacker can execute arbitrary shell commands on the target system by injecting commands through the vulnerable parameter. This can potentially lead to complete compromise of the device and its network. As demonstrated in the PoC, the attacker is able to execute `ls` and redirect the output to a file in the device's filesystem.
- **Attack vectors**: The attack vector is via a crafted HTTP POST request to the `/cgi-bin/touchlist_sync.cgi` endpoint, by providing the malicious commands in the `IP` parameter within the query string.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable device on the network. The attacker does not need prior authentication to exploit this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.155 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.108 |
| 5 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.104 |
| 6 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.102 |
| 7 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.102 |
| 8 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.100 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.581 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-790: Improper Filtering of Special Elements

CWE-138: Improper Neutralization of Special Elements

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-1287: Improper Validation of Specified Type of Input

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-425: Direct Request ('Forced Browsing')

CWE-94: Improper Control of Generation of Code ('Code Injection')