# Vulnerability Information: CVE-2024-6353

## Vulnerability Description
The Wallet for WooCommerce plugin for WordPress is vulnerable to SQL Injection via the search[value] parameter in all versions up to, and including, 1.5.4 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Subscriber-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers
- **product:** Wallet for WooCommerce
- **version:** up to and including 1.5.4
- **component:** search[value] parameter

## CVE Reference Links Content Summary
```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": {
    "CVE-2024-6353": {
      "status": "relevant",
      "details": {
        "root_cause": "Insufficient escaping on the user-supplied `search[value]` parameter and lack of sufficient preparation on the existing SQL query.",
        "weaknesses": [
          "SQL Injection"
        ],
        "impact": "Authenticated attackers can append additional SQL queries to extract sensitive information from the database.",
        "attack_vector": "By injecting malicious SQL code via the `search[value]` parameter.",
        "attacker_capabilities": "Requires an authenticated attacker with Subscriber-level access or higher."
      }
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.576 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.533 |
| 4 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.521 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.509 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.501 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.500 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.500 |
| 9 | 91 | XML Injection (aka Blind XPath Injection) | Base | Allowed | dense | 0.488 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

