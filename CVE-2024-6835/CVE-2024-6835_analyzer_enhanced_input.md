## Vulnerability Description
The Ivory Search - WordPress Search Plugin plugin for WordPress is vulnerable to Information Exposure in all versions up to, and including, 5.5.6 via the ajax_load_posts function. This makes it possible for unauthenticated attackers to extract text data from password-protected posts using the boolean-based attack on the AJAX search form

### Vulnerability Description Key Phrases
- **impact:** Information Exposure
- **attacker:** unauthenticated attackers
- **product:** Ivory Search - WordPress Search Plugin
- **version:** all versions up to and including 5.5.6
- **component:** ajax_load_posts function

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-6835:

**1. Verification of CVE Relevance:**

The Wordfence description directly links the vulnerability to `CVE-2024-6835` and identifies the vulnerable component as the `ajax_load_posts` function in the Ivory Search WordPress plugin. This aligns with the CVE description placeholder, confirming its relevance.

**2. Root Cause of Vulnerability:**

The vulnerability stems from a flaw in the `ajax_load_posts` function within the Ivory Search plugin. This function is used to handle AJAX requests for loading search results on the front end of WordPress sites. Due to improper access control, it allows unauthenticated users to retrieve text content from password-protected posts, which should be restricted to authorized users only.

**3. Weaknesses/Vulnerabilities Present:**

*   **Information Exposure:** The core vulnerability is the exposure of sensitive information (content of password-protected posts) to unauthorized actors.
*   **Inadequate Access Control:**  The `ajax_load_posts` function does not properly check for user authentication and authorization before providing access to the content of password-protected posts.
*   **Boolean Based Attack:** The vulnerability allows for exploitation through a boolean-based attack. This type of attack involves crafting requests that reveal information based on whether a condition is true or false, which can be used to extract text content incrementally.

**4. Impact of Exploitation:**

*   **Data Breach:** Successful exploitation allows unauthenticated attackers to retrieve the content of password-protected posts, which may include sensitive or confidential information. This can lead to a data breach and compromise of privacy.
*   **Content Exfiltration:** Attackers could systematically extract all the textual data contained in password-protected posts.

**5. Attack Vectors:**

*   **Network Access:** The attack vector is over the network, as it involves sending HTTP requests to the WordPress site.
*   **AJAX endpoint:** The specific attack vector is through the `ajax_load_posts` AJAX endpoint of the plugin.

**6. Required Attacker Capabilities/Position:**

*   **Unauthenticated Access:** Attackers do not need to be authenticated to exploit this vulnerability.
*   **Basic Network Skills:** Requires the ability to craft HTTP requests to a WordPress website, which is a common skill set for most attackers.
*   **Knowledge of Plugin Endpoint:** Attackers need knowledge of the plugin's AJAX endpoint and parameters, however, these details are available publicly.

**Additional Notes from the Provided Content:**

*   **Affected Versions:** All versions of the Ivory Search plugin up to and including 5.5.6 are vulnerable.
*   **Patched Version:** The vulnerability is fixed in version 5.5.7.
*   **Remediation:** Users should update the plugin to version 5.5.7 or later.

The provided code snippets from `plugins.trac.wordpress.org` show the changes made between versions 5.5.6 and 5.5.7, with the most significant changes occurring in:
* `add-search-to-menu.php`: updated version number, some refactoring and singleton implementation.
* `admin/class-is-admin.php`: changes in admin notice, ajax display posts functionality, plugin action links and other minor changes.
* `admin/class-is-editor.php`: several minor code changes and additions.
* `admin/class-is-settings-fields.php`: changes to  `register_settings_fields` function to accommodate changes in `admin/class-is-admin.php`
* `admin/class-is-settings-index-fields.php`: some code refactoring and removal.
* `includes/class-is-base-options.php`: Added and modified some function for singleton implementation.
* `includes/freemius.php`: minor changes.
* `includes/freemius/includes/class-freemius.php`: changes in license synchronization and version checks.
* `includes/freemius/includes/class-fs-plugin-updater.php`: updated cache expiration.
* `includes/freemius/includes/fs-plugin-info-dialog.php`: Updated cache expiration.
* `includes/freemius/languages/freemius.pot`: Updated dates and other minor changes.
* `includes/freemius/start.php`: Updated freemius sdk version.
*  `includes/freemius/templates/account.php`: added `esc_html()` on `prop[title]` output
*   `includes/freemius/templates/forms/subscription-cancellation.php`: added `fs_esc_attr_echo_inline` method to improve security.
*   `languages/add-search-to-menu.pot`: updated dates and some missing strings.
*   `public/class-is-public.php`: refactoring and various code changes.
*   `public/css/ivory-search.css` and `public/css/ivory-search.min.css`: changed z-index of menu popup.
*   `readme.txt`: updated plugin version.

The most crucial changes related to security appear to be in `admin/class-is-admin.php` where ajax handling was modified and `includes/freemius/includes/class-freemius.php`, `includes/freemius/includes/class-fs-plugin-updater.php`, and  `includes/freemius/includes/fs-plugin-info-dialog.php` with respect to license checks and caching expiration.

Overall, the information indicates that `CVE-2024-6835` is a medium-severity vulnerability due to the potential for information disclosure to unauthenticated attackers. The update to version 5.5.7 includes important fixes.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.115 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.109 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.109 |
| 4 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.106 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.104 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.104 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.103 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.102 |
| 9 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | dense | 0.497 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-862: Missing Authorization

CWE-863: Incorrect Authorization

CWE-522: Insufficiently Protected Credentials

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-306: Missing Authentication for Critical Function

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-285: Improper Authorization

CWE-202: Exposure of Sensitive Information Through Data Queries

CWE-425: Direct Request ('Forced Browsing')