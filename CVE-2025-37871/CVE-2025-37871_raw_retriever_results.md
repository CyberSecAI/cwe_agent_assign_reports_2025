# Raw Retriever Results for CVE-2025-37871

# Raw Retriever Results for CVE-2025-37871
## Query
In the Linux kernel, the following vulnerability has been resolved nfsd decrease sc_count directly if fail to queue dl_recall A deadlock warning occurred when invoking nfs4_put_stid following a failed dl_recall queue operation T1 T2 nfs4_laundromat nfs4_get_client_reaplist nfs4_anylock_blockers __break_lease spin_lock // ctx->flc_lock spin_lock // clp->cl_lock nfs4_lockowner_has_blockers locks_owner_has_blockers spin_lock // flctx->flc_lock nfsd_break_deleg_cb nfsd_break_one_deleg nfs4_put_stid refcount_dec_and_lock spin_lock // clp->cl_lock When a file is opened, an nfs4_delegation is allocated with sc_count initialized to 1, and the file_lease holds a reference to the delegation. The file_lease is then associated with the file through kernel_setlease. The disassociation is performed in nfsd4_delegreturn via the following call chain nfsd4_delegreturn --> destroy_delegation --> destroy_unhashed_deleg --> nfs4_unlock_deleg_lease --> kernel_setlease --> generic_delete_lease The corresponding sc_count reference will be released after this disassociation. Since nfsd_break_one_deleg executes while holding the flc_lock, the disassociation process becomes blocked when attempting to acquire flc_lock in generic_delete_lease. This means 1) sc_count in nfsd_break_one_deleg will not be decremented to 0 2) The nfs4_put_stid called by nfsd_break_one_deleg will not attempt to acquire cl_lock 3) Consequently, no deadlock condition is created. Given that sc_count in nfsd_break_one_deleg remains non-zero, we can safely perform refcount_dec on sc_count directly. This approach effectively avoids triggering deadlock warnings.

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3991 | 0.4959 | 0.4258 | 0.4176 | 20 |
| Sparse | 220.7456 | 243.6311 | 229.4259 | 227.5657 | 10 |
| Graph | 1.3010 | 2.3400 | 1.7263 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 2 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 3 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 4 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 5 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 7 | 833 | Deadlock | Base | 1.6974 | Allowed |
| 8 | 826 | Premature Release of Resource During Expected Lifetime | base | 1.6848 | Allowed |
| 9 | 562 | Return of Stack Variable Address | base | 1.6848 | Allowed |
| 10 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 11 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 12 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 13 | 413 | Improper Resource Locking | Base | 1.6712 | Allowed |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 15 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 1.5912 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.4959 | 0.4959 | Allowed |
| 2 | 911 | Improper Update of Reference Count | Base | 0.4760 | 0.4760 | Allowed |
| 3 | 667 | Improper Locking | Class | 0.4538 | 0.4538 | Allowed-with-Review |
| 4 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4409 | 0.4409 | Allowed |
| 5 | 413 | Improper Resource Locking | Base | 0.4314 | 0.4314 | Allowed |
| 6 | 774 | Allocation of File Descriptors or Handles Without Limits or Throttling | Variant | 0.4281 | 0.4281 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4275 | 0.4275 | Allowed |
| 8 | 909 | Missing Initialization of Resource | Class | 0.4261 | 0.4261 | Allowed-with-Review |
| 9 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.4257 | 0.4257 | Allowed |
| 10 | 764 | Multiple Locks of a Critical Resource | Base | 0.4191 | 0.4191 | Allowed |
| 11 | 476 | NULL Pointer Dereference | Base | 0.4161 | 0.4161 | Allowed |
| 12 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4159 | 0.4159 | Allowed |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4151 | 0.4151 | Allowed-with-Review |
| 14 | 765 | Multiple Unlocks of a Critical Resource | Base | 0.4140 | 0.4140 | Allowed |
| 15 | 1341 | Multiple Releases of Same Resource or Handle | Base | 0.4102 | 0.4102 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 243.6311 | 243.6311 | Allowed-with-Review |
| 2 | 667 | Improper Locking | 241.5725 | 241.5725 | Allowed-with-Review |
| 3 | 833 | Deadlock | 230.6171 | 230.6171 | Allowed |
| 4 | 911 | Improper Update of Reference Count | 230.1392 | 230.1392 | Allowed |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | 228.7204 | 228.7204 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | 226.4109 | 226.4109 | Allowed |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 225.3807 | 225.3807 | Allowed |
| 8 | 476 | NULL Pointer Dereference | 224.6695 | 224.6695 | Allowed |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 222.3722 | 222.3722 | Allowed |
| 10 | 125 | Out-of-bounds Read | 220.7456 | 220.7456 | Allowed |
