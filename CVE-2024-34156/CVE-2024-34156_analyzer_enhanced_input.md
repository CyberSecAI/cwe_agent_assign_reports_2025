## Vulnerability Description
Calling Decoder.Decode on a message which contains deeply nested structures can cause a panic due to **stack exhaustion**. This is a follow-up to CVE-2022-30635.

### Vulnerability Description Key Phrases
- **rootcause:** **stack exhaustion**
- **impact:** panic
- **vector:** Calling Decoder.Decode on a message which contains deeply nested structures

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-34156:

**Root Cause of Vulnerability:**
The vulnerability stems from a stack exhaustion issue within the `encoding/gob` package. Specifically, calling `Decoder.Decode` on a message containing deeply nested structures can lead to a stack overflow, causing a panic. This is a follow-up to a previously identified vulnerability, CVE-2022-30635. The core issue lies in how the decoder handles deeply nested structures, particularly when fields are ignored.

**Weaknesses/Vulnerabilities Present:**
- Stack exhaustion vulnerability. The decoder does not properly check the recursion depth of ignored fields, which allows an attacker to craft a message with deeply nested ignored fields to trigger a stack overflow.

**Impact of Exploitation:**
- Denial of Service (DoS): Exploiting the vulnerability results in a panic due to stack exhaustion, effectively causing a denial of service for any application using the vulnerable `encoding/gob` package.

**Attack Vectors:**
- The attack vector involves sending a specially crafted message with deeply nested structures to the `Decoder.Decode` or `Decoder.DecodeValue` function.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send a message to a Go application using the `encoding/gob` package. No special privileges are needed.

**Additional Details**

*   The vulnerability affects `encoding/gob` package in Go versions prior to 1.22.7 and versions between 1.23.0-0 and 1.23.1.
*   The vulnerability was reported by Md Sakib Anwar of The Ohio State University.
*   Patches have been released in Go versions 1.22.7 and 1.23.1.
*   NetApp products, specifically "Astra Control Center - NetApp Kubernetes Monitoring Operator", "Data Infrastructure Insights Telegraf Agent", and "NetApp Kubernetes Monitoring Operator" are affected. NetApp has released patches to address this vulnerability in these products.
*   The fix ensures that the recursion depth of ignored fields is properly checked in the `decIgnoreOpFor` function to prevent stack exhaustion.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | alternate_terms | 1.000 |
| 2 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 3 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | alternate_terms | 1.000 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.195 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.188 |
| 6 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.177 |
| 7 | 908 | Use of Uninitialized Resource | Base | Allowed | sparse | 0.172 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.170 |
| 9 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | dense | 0.487 |
| 10 | 476 | NULL Pointer Dereference | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1325: Improperly Controlled Sequential Memory Allocation

CWE-674: Uncontrolled Recursion

CWE-789: Memory Allocation with Excessive Size Value

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-400: Uncontrolled Resource Consumption

CWE-908: Use of Uninitialized Resource

CWE-121: Stack-based Buffer Overflow

CWE-409: Improper Handling of Highly Compressed Data (Data Amplification)

CWE-476: NULL Pointer Dereference