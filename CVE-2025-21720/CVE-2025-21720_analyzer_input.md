# Vulnerability Information: CVE-2025-21720

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved xfrm delete intermediate secpath entry in packet offload mode Packets handled by hardware have added secpath as a way to inform XFRM core code that this path was already handled. That secpath is not needed at all after policy is checked and it is removed later in the stack. However, in the case of IP forwarding is enabled (/proc/sys/net/ipv4/ip_forward), that secpath is not removed and packets which already were handled are reentered to the driver TX path with xfrm_offload set. The following kernel panic is observed in mlx5 in such case mlx5_core 00000400.0 enp4s0f0np0 Link up mlx5_core 00000400.1 enp4s0f1np1 Link up Initializing XFRM netlink socket IPsec XFRM device driver

### Vulnerability Description Key Phrases
- **impact:** kernel panic
- **product:** Linux kernel
- **component:** xfrm delete intermediate secpath entry in packet offload mode

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.202 |
| 2 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.194 |
| 3 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.182 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.182 |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.182 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.181 |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.181 |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.178 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.432 |
| 10 | 609 | Double-Checked Locking | Base | Allowed | graph | 0.003 |

