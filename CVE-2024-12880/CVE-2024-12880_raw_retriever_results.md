# Raw Retriever Results for CVE-2024-12880

# Raw Retriever Results for CVE-2024-12880
## Query
A vulnerability in infiniflow/ragflow version RAGFlow-0.13.0 allows for partial account takeover via insecure data querying. The issue arises from the way tenant IDs are handled in the application. If a user has access to multiple tenants, they can manipulate their tenant access to query and access API tokens of other tenants. This vulnerability affects the following endpoints /v1/system/token_list, /v1/system/new_token, /v1/api/token_list, /v1/api/new_token, and /v1/api/rm. An attacker can exploit this to access other tenants API tokens, perform actions on behalf of other tenants, and access their data.

## Keyphrases
- **rootcause**: 'insecure data querying'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4442 | 0.4940 | 0.4630 | 0.4598 | 20 |
| Sparse | 465.7400 | 538.4225 | 496.4070 | 502.8160 | 10 |
| Graph | 1.0479 | 2.6784 | 1.4117 | 1.3254 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 2.6784 | Allowed |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6938 | Allowed |
| 3 | 306 | Missing Authentication for Critical Function | Base | 1.6895 | Allowed |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | 1.6436 | Allowed |
| 5 | 322 | Key Exchange without Entity Authentication | base | 1.5912 | Allowed |
| 6 | 613 | Insufficient Session Expiration | Base | 1.5226 | Allowed |
| 7 | 73 | External Control of File Name or Path | base | 1.4602 | Allowed |
| 8 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.3843 | Allowed |
| 9 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.3747 | Allowed |
| 10 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | class | 1.3600 | Allowed-with-Review |
| 11 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 1.2907 | Allowed |
| 12 | 384 | Session Fixation | compound | 1.2880 | Allowed |
| 13 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.2880 | Allowed |
| 14 | 425 | Direct Request ('Forced Browsing') | base | 1.2262 | Allowed |
| 15 | 266 | Incorrect Privilege Assignment | base | 1.1794 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 285 | Improper Authorization | Class | 0.4940 | 0.4940 | Discouraged |
| 2 | 306 | Missing Authentication for Critical Function | Base | 0.4906 | 0.4906 | Allowed |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4899 | 0.4899 | Allowed |
| 4 | 287 | Improper Authentication | Class | 0.4801 | 0.4801 | Discouraged |
| 5 | 532 | Insertion of Sensitive Information into Log File | Base | 0.4782 | 0.4782 | Allowed |
| 6 | 863 | Incorrect Authorization | Class | 0.4729 | 0.4729 | Allowed-with-Review |
| 7 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4710 | 0.4710 | Allowed |
| 8 | 522 | Insufficiently Protected Credentials | Class | 0.4693 | 0.4693 | Allowed-with-Review |
| 9 | 862 | Missing Authorization | Class | 0.4673 | 0.4673 | Allowed-with-Review |
| 10 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | 0.4670 | 0.4670 | Discouraged |
| 11 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.4526 | 0.4526 | Allowed-with-Review |
| 12 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4499 | 0.4499 | Allowed |
| 13 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4495 | 0.4495 | Allowed |
| 14 | 269 | Improper Privilege Management | Class | 0.4491 | 0.4491 | Discouraged |
| 15 | 284 | Improper Access Control | Pillar | 0.4478 | 0.4478 | Discouraged |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | 538.4225 | 538.4225 | Allowed |
| 2 | 863 | Incorrect Authorization | 510.3980 | 510.3980 | Allowed-with-Review |
| 3 | 284 | Improper Access Control | 510.3576 | 510.3576 | Discouraged |
| 4 | 668 | Exposure of Resource to Wrong Sphere | 506.7073 | 506.7073 | Discouraged |
| 5 | 285 | Improper Authorization | 504.4180 | 504.4180 | Discouraged |
| 6 | 287 | Improper Authentication | 501.2139 | 501.2139 | Discouraged |
| 7 | 306 | Missing Authentication for Critical Function | 479.7252 | 479.7252 | Allowed |
| 8 | 522 | Insufficiently Protected Credentials | 475.7292 | 475.7292 | Allowed-with-Review |
| 9 | 862 | Missing Authorization | 471.3587 | 471.3587 | Allowed-with-Review |
| 10 | 1220 | Insufficient Granularity of Access Control | 465.7400 | 465.7400 | Allowed |
