## Vulnerability Description
A vulnerability in infiniflow/ragflow version RAGFlow-0.13.0 allows for partial account takeover via **insecure data querying**. The issue arises from the way tenant IDs are handled in the application. If a user has access to multiple tenants, they can manipulate their tenant access to query and access API tokens of other tenants. This vulnerability affects the following endpoints /v1/system/token_list, /v1/system/new_token, /v1/api/token_list, /v1/api/new_token, and /v1/api/rm. An attacker can exploit this to access other tenants API tokens, perform actions on behalf of other tenants, and access their data.

### Vulnerability Description Key Phrases
- **rootcause:** **insecure data querying**
- **impact:** partial account takeover
- **vector:** manipulate tenant access
- **attacker:** user with access to multiple tenants
- **product:** infiniflow/ragflow
- **version:** RAGFlow-0.13.0

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.538 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.510 |
| 3 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.510 |
| 4 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.507 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.504 |
| 6 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.501 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.480 |
| 8 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.476 |
| 9 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | dense | 0.478 |
| 10 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-863: Incorrect Authorization

CWE-284: Improper Access Control

CWE-668: Exposure of Resource to Wrong Sphere

CWE-285: Improper Authorization

CWE-287: Improper Authentication

CWE-306: Missing Authentication for Critical Function

CWE-522: Insufficiently Protected Credentials

CWE-532: Insertion of Sensitive Information into Log File

CWE-942: Permissive Cross-domain Policy with Untrusted Domains