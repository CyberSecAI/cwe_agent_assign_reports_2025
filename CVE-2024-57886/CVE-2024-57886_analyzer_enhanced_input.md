## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved mm/damon/core fix new damon_target objects leaks on damon_commit_targets() Patch series mm/damon/core fix **memory leaks** and ignored inputs from damon_commit_ctx(). Due to two **bugs in damon_commit_targets() and damon_commit_schemes()**, which are called from damon_commit_ctx(), some user inputs can be ignored, and some mmeory objects can be leaked. Fix those. Note that only DAMON sysfs interface users are affected. Other DAMON core API user modules that more focused more on simple and dedicated production usages, including DAMON_RECLAIM and DAMON_LRU_SORT are not using the buggy function in the way, so not affected. This patch (of 2) When new DAMON targets are added via damon_commit_targets(), the newly created targets are not deallocated when updating the internal data (damon_commit_target()) is failed. Worse yet, even if the setup is successfully done, the new target is not linked to the context. Hence, the new targets are always leaked regardless of the internal data setup failure. Fix the leaks.

### Vulnerability Description Key Phrases
- **rootcause:** **bugs in damon_commit_targets() and damon_commit_schemes()**
- **weakness:** **memory leaks**
- **impact:** leak memory objects
- **attacker:** DAMON sysfs interface users
- **product:** Linux kernel
- **component:** mm/damon/core

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | alternate_terms | 0.800 |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.794 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.754 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.745 |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.737 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.736 |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.722 |
| 8 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.718 |
| 9 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | dense | 0.537 |
| 10 | 908 | Use of Uninitialized Resource | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-863: Incorrect Authorization

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-1390: Weak Authentication

CWE-909: Missing Initialization of Resource

CWE-908: Use of Uninitialized Resource