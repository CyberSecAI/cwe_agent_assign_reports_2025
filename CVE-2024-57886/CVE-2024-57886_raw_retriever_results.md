# Raw Retriever Results for CVE-2024-57886

# Raw Retriever Results for CVE-2024-57886
## Query
In the Linux kernel, the following vulnerability has been resolved mm/damon/core fix new damon_target objects leaks on damon_commit_targets() Patch series mm/damon/core fix memory leaks and ignored inputs from damon_commit_ctx(). Due to two bugs in damon_commit_targets() and damon_commit_schemes(), which are called from damon_commit_ctx(), some user inputs can be ignored, and some mmeory objects can be leaked. Fix those. Note that only DAMON sysfs interface users are affected. Other DAMON core API user modules that more focused more on simple and dedicated production usages, including DAMON_RECLAIM and DAMON_LRU_SORT are not using the buggy function in the way, so not affected. This patch (of 2) When new DAMON targets are added via damon_commit_targets(), the newly created targets are not deallocated when updating the internal data (damon_commit_target()) is failed. Worse yet, even if the setup is successfully done, the new target is not linked to the context. Hence, the new targets are always leaked regardless of the internal data setup failure. Fix the leaks.

## Keyphrases
- **rootcause**: 'bugs in damon_commit_targets()', 'damon_commit_schemes()'
- **weakness**: 'memory leaks'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4641 | 0.5375 | 0.4875 | 0.4818 | 20 |
| Sparse | 656.0451 | 800.0000 | 728.0321 | 728.7870 | 12 |
| Graph | 1.4524 | 4.3290 | 1.9402 | 1.7199 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | base | 4.3290 | Allowed |
| 2 | 908 | Use of Uninitialized Resource | Base | 2.8126 | Allowed |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 2.8036 | Allowed |
| 4 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 5 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 6 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | 1.9255 | Allowed |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 8 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 9 | 909 | Missing Initialization of Resource | Class | 1.7597 | Allowed-with-Review |
| 10 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 11 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 12 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 13 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 14 | 609 | Double-Checked Locking | base | 1.5912 | Allowed |
| 15 | 476 | NULL Pointer Dereference | Base | 1.5342 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.5375 | 0.5375 | Allowed-with-Review |
| 2 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5353 | 0.5353 | Allowed |
| 3 | 667 | Improper Locking | Class | 0.5022 | 0.5022 | Allowed-with-Review |
| 4 | 908 | Use of Uninitialized Resource | Base | 0.4986 | 0.4986 | Allowed |
| 5 | 665 | Improper Initialization | Class | 0.4945 | 0.4945 | Discouraged |
| 6 | 911 | Improper Update of Reference Count | Base | 0.4938 | 0.4938 | Allowed |
| 7 | 126 | Buffer Over-read | Variant | 0.4932 | 0.4932 | Allowed |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4892 | 0.4892 | Allowed |
| 9 | 277 | Insecure Inherited Permissions | Variant | 0.4844 | 0.4844 | Allowed |
| 10 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4842 | 0.4842 | Discouraged |
| 11 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4794 | 0.4794 | Allowed |
| 12 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4787 | 0.4787 | Allowed |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4760 | 0.4760 | Allowed-with-Review |
| 14 | 129 | Improper Validation of Array Index | Variant | 0.4759 | 0.4759 | Allowed |
| 15 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4743 | 0.4743 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | 800.0000 | 800.0000 | Allowed |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 793.6568 | 793.6568 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 753.6576 | 753.6576 | Allowed |
| 4 | 863 | Incorrect Authorization | 744.8135 | 744.8135 | Allowed-with-Review |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 737.1473 | 737.1473 | Allowed-with-Review |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | 735.5032 | 735.5032 | Allowed |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 722.0709 | 722.0709 | Allowed |
| 8 | 1390 | Weak Authentication | 718.0897 | 718.0897 | Allowed-with-Review |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 710.5807 | 710.5807 | Allowed |
| 10 | 184 | Incomplete List of Disallowed Inputs | 707.9918 | 707.9918 | Allowed |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | 656.8288 | 656.8288 | Allowed |
| 12 | 667 | Improper Locking | 656.0451 | 656.0451 | Allowed-with-Review |
