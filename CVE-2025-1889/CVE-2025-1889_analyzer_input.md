# Vulnerability Information: CVE-2025-1889

## Vulnerability Description
picklescan before 0.0.22 only considers standard pickle file extensions in the scope for its vulnerability scan. An attacker could craft a malicious model that uses Pickle and include a malicious pickle file with a non-standard file extension. Because the malicious pickle file inclusion is not considered as part of the scope of picklescan, the file would pass security checks and appear to be safe, when it could instead prove to be problematic.

### Vulnerability Description Key Phrases
- **vector:** malicious pickle file with a non-standard file extension
- **product:** picklescan
- **version:** before 0.0.22

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1889 based on provided content:

**1. Verification:**

The content relates to CVE-2025-1889 as it directly discusses a security vulnerability in `picklescan` allowing bypass of security scans due to non-standard file extensions in PyTorch models. The CVE ID is explicitly mentioned.

**2. Extracted Information:**

*   **Root cause of vulnerability:** `picklescan` only considers standard pickle file extensions for vulnerability scanning. PyTorch allows specifying alternative pickle files within model archives using the `pickle_file` parameter in `torch.load()`.
*   **Weaknesses/vulnerabilities present:**
    *   Reliance on file name or extension of externally-supplied file (CWE-646).
    *   Insufficient scanning of files within archive structures.
*   **Impact of exploitation:**
    *   Remote Code Execution (RCE) - Attackers can embed malicious code in PyTorch models that executes when loaded.
    *   Supply chain attacks - Potential for backdooring pre-trained models distributed via repositories.
*   **Attack vectors:**
    *   Crafting a PyTorch model with a malicious pickle file (e.g., `config.p`) using a non-standard extension.
    *   Embedding the malicious pickle file within the model archive.
    *   Exploiting the `torch.load()` function with the `pickle_file` parameter to load the malicious file.
*   **Required attacker capabilities/position:**
    *   Ability to create and modify PyTorch models.
    *   Ability to host or distribute the malicious model.
    *   Passive - requires a user to load the crafted model.
*   **Mitigation or fix:**
    *   Scan all files within the ZIP archive.
    *   Detect hidden pickle references (e.g., `torch.load(pickle_file=...)`).
    *   Use magic byte detection to identify pickle files regardless of extension.
    *   Block the following globals: `torch.load`, `functools.partial`.
    *   Upgrade to `picklescan` version 0.0.22 or later.

**3. Additional Details (compared to a placeholder CVE description):**

The provided content offers significantly more detail than a typical CVE description. It includes:

*   A detailed explanation of the attack scenario.
*   A Proof-of-Concept (PoC) code example.
*   CVSS v4 scoring and metrics.
*   Specific CWE enumeration.
*   Attribution of the vulnerability discovery to Trevor Madge (@madgetr) of Sonatype.
*   Links to relevant resources (GitHub advisory, PyPI release).

**4. Translation:**

No translation was required as all content was in English.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.142 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.123 |
| 3 | 178 | Improper Handling of Case Sensitivity | Base | Allowed | sparse | 0.122 |
| 4 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.122 |
| 5 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.120 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.119 |
| 7 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.119 |
| 8 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.119 |
| 9 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | Allowed | dense | 0.435 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |

