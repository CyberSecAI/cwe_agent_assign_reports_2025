# Vulnerability Information: CVE-2025-27097

## Vulnerability Description
GraphQL Mesh is a GraphQL Federation framework and gateway for both GraphQL Federation and non-GraphQL Federation subgraphs, non-GraphQL services, such as REST and gRPC, and also databases such as MongoDB, MySQL, and PostgreSQL. When a user transforms on the root level or single source with transforms, and the client sends the same query with different variables, the initial variables are used in all following requests until the cache evicts DocumentNode. If a token is sent via variables, the following requests will act like the same token is sent even if the following requests have different tokens. This can cause a short **memory leak** but it wont grow per each request but per different operation until the cache evicts DocumentNode by LRU mechanism.

### Vulnerability Description Key Phrases
- **weakness:** **memory leak**
- **product:** GraphQL Mesh

## CVE Reference Links Content Summary
## Analysis of CVE-2025-27097 based on provided content:

This content **is relevant** to CVE-2025-27097. It provides details beyond the placeholder description.

**Root cause of vulnerability:**

When transforms are applied at the root level or to a single source with transforms, and a client sends the same query with different variables, the initial variables are used in all subsequent requests until the cache evicts the DocumentNode.

**Weaknesses/vulnerabilities present:**

*   The vulnerability lies in how `@graphql-mesh/runtime` handles caching of GraphQL queries with variables when transforms are involved.
*   No CWEs are listed.

**Impact of exploitation:**

*   Can cause a short memory leak. The leak grows per different operation until the cache evicts the DocumentNode using a Least Recently Used (LRU) mechanism.
*   Specifically, if a token is sent via variables, subsequent requests will act as if the same token is being sent, even if different tokens are provided in the requests.

**Attack vectors:**

*   An attacker could potentially exploit this by sending a query with sensitive information (like a token) as a variable. Subsequent requests, even with different variables, might reuse the initial sensitive information from the cache.

**Required attacker capabilities/position:**

*   The attacker needs to be able to send GraphQL queries to the affected application.

**Mitigation or fix:**

*   Upgrade to version 0.96.9 or later of `@graphql-mesh/runtime`.

**Additional Details (more than official CVE description):**

*   The advisory explicitly mentions the affected versions (0.96.5, 0.96.6, 0.96.7, 0.96.8) and the patched version (0.96.9).
*   Credits are given to the reporter (@khell) and the remediation developer (@ardatan).
*   The vulnerability is categorized as "High" severity.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 697 | Incorrect Comparison | Pillar | Discouraged | sparse | 0.598 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.597 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.561 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.557 |
| 6 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.537 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.529 |
| 8 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.525 |
| 9 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | dense | 0.355 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.003 |

