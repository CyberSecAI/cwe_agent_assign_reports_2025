# Raw Retriever Results for CVE-2024-3404

# Raw Retriever Results for CVE-2024-3404
## Query
In gaizhenbiao/chuanhuchatgpt, specifically the version tagged as 20240121, there exists a vulnerability due to improper access control mechanisms. This flaw allows an authenticated attacker to bypass intended access restrictions and read the `history` files of other users, potentially leading to unauthorized access to sensitive information. The vulnerability is present in the applications handling of access control for the `history` path, where no adequate mechanism is in place to prevent an authenticated user from accessing another users chat history files. This issue poses a significant risk as it could allow attackers to obtain sensitive information from the chat history of other users.

## Keyphrases
- **rootcause**: 'improper access control mechanisms'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5372 | 0.5650 | 0.5489 | 0.5488 | 20 |
| Sparse | 182.7262 | 596.0623 | 539.8796 | 569.3137 | 11 |
| Graph | 1.0785 | 2.6784 | 1.4587 | 1.3240 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 2.6784 | Allowed |
| 2 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 3 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.7731 | Allowed |
| 4 | 668 | Exposure of Resource to Wrong Sphere | class | 1.7680 | Discouraged |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.7254 | Allowed |
| 6 | 532 | Insertion of Sensitive Information into Log File | Base | 1.6857 | Allowed |
| 7 | 267 | Privilege Defined With Unsafe Actions | Base | 1.6413 | Allowed |
| 8 | 322 | Key Exchange without Entity Authentication | base | 1.4602 | Allowed |
| 9 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.3747 | Allowed |
| 10 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | class | 1.3600 | Allowed-with-Review |
| 11 | 384 | Session Fixation | compound | 1.2880 | Allowed |
| 12 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.2880 | Allowed |
| 13 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | base | 1.1794 | Allowed |
| 14 | 798 | Use of Hard-coded Credentials | base | 1.1466 | Allowed |
| 15 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 1.1250 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | 0.5650 | 0.5650 | Allowed |
| 2 | 287 | Improper Authentication | Class | 0.5639 | 0.5639 | Discouraged |
| 3 | 284 | Improper Access Control | Pillar | 0.5631 | 0.5631 | Discouraged |
| 4 | 267 | Privilege Defined With Unsafe Actions | Base | 0.5588 | 0.5588 | Allowed |
| 5 | 790 | Improper Filtering of Special Elements | Class | 0.5535 | 0.5535 | Allowed-with-Review |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5531 | 0.5531 | Allowed |
| 7 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.5527 | 0.5527 | Allowed |
| 8 | 250 | Execution with Unnecessary Privileges | Base | 0.5523 | 0.5523 | Allowed |
| 9 | 285 | Improper Authorization | Class | 0.5513 | 0.5513 | Discouraged |
| 10 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.5511 | 0.5511 | Allowed |
| 11 | 922 | Insecure Storage of Sensitive Information | Class | 0.5465 | 0.5465 | Allowed-with-Review |
| 12 | 863 | Incorrect Authorization | Class | 0.5464 | 0.5464 | Allowed-with-Review |
| 13 | 425 | Direct Request ('Forced Browsing') | Base | 0.5440 | 0.5440 | Allowed |
| 14 | 862 | Missing Authorization | Class | 0.5416 | 0.5416 | Allowed-with-Review |
| 15 | 290 | Authentication Bypass by Spoofing | Base | 0.5408 | 0.5408 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 668 | Exposure of Resource to Wrong Sphere | 596.0623 | 596.0623 | Discouraged |
| 2 | 285 | Improper Authorization | 589.3184 | 589.3184 | Discouraged |
| 3 | 863 | Incorrect Authorization | 584.7376 | 584.7376 | Allowed-with-Review |
| 4 | 284 | Improper Access Control | 583.1906 | 583.1906 | Discouraged |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | 572.7484 | 572.7484 | Allowed |
| 6 | 287 | Improper Authentication | 569.3137 | 569.3137 | Discouraged |
| 7 | 306 | Missing Authentication for Critical Function | 566.9796 | 566.9796 | Allowed |
| 8 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | 566.6307 | 566.6307 | Discouraged |
| 9 | 732 | Incorrect Permission Assignment for Critical Resource | 564.0097 | 564.0097 | Allowed-with-Review |
| 10 | 1390 | Weak Authentication | 562.9586 | 562.9586 | Allowed-with-Review |
| 11 | 532 | Insertion of Sensitive Information into Log File | 182.7262 | 182.7262 | Allowed |
