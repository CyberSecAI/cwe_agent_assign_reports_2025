# Raw Retriever Results for CVE-2024-11616

# Raw Retriever Results for CVE-2024-11616
## Query
Netskope was made aware of a security vulnerability in Netskope Endpoint DLPs Content Control Driver where a double-fetch issue leads to heap overflow. The vulnerability arises from the fact that the NumberOfBytes argument to ExAllocatePoolWithTag, and the Length argument for RtlCopyMemory, both independently dereference their value from the user supplied input buffer inside the EpdlpSetUsbAction function, known as a double-fetch. If this length value grows to a higher value in between these two calls, it will result in the RtlCopyMemory call copying user-supplied memory contents outside the range of the allocated buffer, resulting in a heap overflow. A malicious attacker will need admin privileges to exploit the issue. This issue affects Endpoint DLP version below R119.

## Keyphrases
- **rootcause**: 'double-fetch issue'
- **weakness**: 'double-fetch', 'heap overflow'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5286 | 0.5811 | 0.5500 | 0.5529 | 20 |
| Sparse | 194.8556 | 800.0000 | 600.8423 | 617.7250 | 12 |
| Graph | 1.6848 | 2.8265 | 2.1284 | 2.2100 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.8265 | Allowed |
| 2 | 193 | Off-by-one Error | Base | 2.5568 | Allowed |
| 3 | 125 | Out-of-bounds Read | Base | 2.4525 | Allowed |
| 4 | 190 | Integer Overflow or Wraparound | Base | 2.3739 | Allowed |
| 5 | 123 | Write-what-where Condition | base | 2.3530 | Allowed |
| 6 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 7 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 8 | 364 | Signal Handler Race Condition | base | 2.2100 | Allowed |
| 9 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 11 | 617 | Reachable Assertion | base | 2.2100 | Allowed |
| 12 | 789 | Memory Allocation with Excessive Size Value | Variant | 2.1831 | Allowed |
| 13 | 416 | Use After Free | variant | 2.1720 | Allowed |
| 14 | 126 | Buffer Over-read | Variant | 1.9950 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | 0.5811 | 0.5811 | Allowed |
| 2 | 122 | Heap-based Buffer Overflow | Variant | 0.5796 | 0.5796 | Allowed |
| 3 | 805 | Buffer Access with Incorrect Length Value | Base | 0.5725 | 0.5725 | Allowed |
| 4 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.5692 | 0.5692 | Allowed |
| 5 | 126 | Buffer Over-read | Variant | 0.5679 | 0.5679 | Allowed |
| 6 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5562 | 0.5562 | Allowed |
| 7 | 190 | Integer Overflow or Wraparound | Base | 0.5561 | 0.5561 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5554 | 0.5554 | Allowed |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5545 | 0.5545 | Allowed |
| 10 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5543 | 0.5543 | Discouraged |
| 11 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5515 | 0.5515 | Allowed |
| 12 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5404 | 0.5404 | Allowed |
| 13 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5396 | 0.5396 | Allowed |
| 14 | 410 | Insufficient Resource Pool | Base | 0.5347 | 0.5347 | Allowed |
| 15 | 822 | Untrusted Pointer Dereference | Base | 0.5338 | 0.5338 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 190 | Integer Overflow or Wraparound | 800.0000 | 800.0000 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | 667.4902 | 667.4902 | Allowed |
| 3 | 415 | Double Free | 656.2447 | 656.2447 | Allowed |
| 4 | 193 | Off-by-one Error | 624.3762 | 624.3762 | Allowed |
| 5 | 125 | Out-of-bounds Read | 624.2113 | 624.2113 | Allowed |
| 6 | 681 | Incorrect Conversion between Numeric Types | 619.1934 | 619.1934 | Allowed |
| 7 | 295 | Improper Certificate Validation | 616.2567 | 616.2567 | Allowed |
| 8 | 787 | Out-of-bounds Write | 614.0326 | 614.0326 | Allowed |
| 9 | 122 | Heap-based Buffer Overflow | 613.7519 | 613.7519 | Allowed |
| 10 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 613.1153 | 613.1153 | Allowed |
| 11 | 130 | Improper Handling of Length Parameter Inconsistency | 566.5799 | 566.5799 | Allowed |
| 12 | 20 | Improper Input Validation | 194.8556 | 194.8556 | Discouraged |
