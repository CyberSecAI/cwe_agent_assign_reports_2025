# Raw Retriever Results for CVE-2025-21812

# Raw Retriever Results for CVE-2025-21812
## Query
In the Linux kernel, the following vulnerability has been resolved ax25 rcu protect dev->ax25_ptr syzbot found a lockdep issue [1]. We should remove ax25 RTNL dependency in ax25_setsockopt() This should also fix a variety of possible UAF in ax25. [1] WARNING possible circular locking dependency detected 6.13.0-rc3-syzkaller-00762-g9268abe611b0 #0 Not tainted ------------------------------------------------------ syz.5.1818/12806 is trying to acquire lock ffffffff8fcb3988 (rtnl_mutex){+.+.}-{44}, at ax25_setsockopt+0xa55/0xe90 net/ax25/af_ax25.c680 but task is already holding lock ffff8880617ac258 (sk_lock-AF_AX25){+.+.}-{00}, at lock_sock include/net/sock.h1618 [inline] ffff8880617ac258 (sk_lock-AF_AX25){+.+.}-{00}, at ax25_setsockopt+0x209/0xe90 net/ax25/af_ax25.c574 which lock already depends on the new lock. the existing dependency chain (in reverse order) is -> #1 (sk_lock-AF_AX25){+.+.}-{00} lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c5849 lock_sock_nested+0x48/0x100 net/core/sock.c3642 lock_sock include/net/sock.h1618 [inline] ax25_kill_by_device net/ax25/af_ax25.c101 [inline] ax25_device_event+0x24d/0x580 net/ax25/af_ax25.c146 notifier_call_chain+0x1a5/0x3f0 kernel/notifier.c85 __dev_notify_flags+0x207/0x400 dev_change_flags+0xf0/0x1a0 net/core/dev.c9026 dev_ifsioc+0x7c8/0xe70 net/core/dev_ioctl.c563 dev_ioctl+0x719/0x1340 net/core/dev_ioctl.c820 sock_do_ioctl+0x240/0x460 net/socket.c1234 sock_ioctl+0x626/0x8e0 net/socket.c1339 vfs_ioctl fs/ioctl.c51 [inline] __do_sys_ioctl fs/ioctl.c906 [inline] __se_sys_ioctl+0xf5/0x170 fs/ioctl.c892 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xf3/0x230 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f -> #0 (rtnl_mutex){+.+.}-{44} check_prev_add kernel/locking/lockdep.c3161 [inline] check_prevs_add kernel/locking/lockdep.c3280 [inline] validate_chain+0x18ef/0x5920 kernel/locking/lockdep.c3904 __lock_acquire+0x1397/0x2100 kernel/locking/lockdep.c5226 lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c5849 __mutex_lock_common kernel/locking/mutex.c585 [inline] __mutex_lock+0x1ac/0xee0 kernel/locking/mutex.c735 ax25_setsockopt+0xa55/0xe90 net/ax25/af_ax25.c680 do_sock_setsockopt+0x3af/0x720 net/socket.c2324 __sys_setsockopt net/socket.c2349 [inline] __do_sys_setsockopt net/socket.c2355 [inline] __se_sys_setsockopt net/socket.c2352 [inline] __x64_sys_setsockopt+0x1ee/0x280 net/socket.c2352 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xf3/0x230 arch/x86/entry/common.c83 entry_SYSCALL_64_after_hwframe+0x77/0x7f other info that might help us debug this Possible unsafe locking scenario CPU0 CPU1 ---- ---- lock(sk_lock-AF_AX25) lock(rtnl_mutex) lock(sk_lock-AF_AX25) lock(rtnl_mutex) *** DEADLOCK *** 1 lock held by syz.5.1818/12806 #0 ffff8880617ac258 (sk_lock-AF_AX25){+.+.}-{00}, at lock_sock include/net/sock.h1618 [inline] #0 ffff8880617ac258 (sk_lock-AF_AX25){+.+.}-{00}, at ax25_setsockopt+0x209/0xe90 net/ax25/af_ax25.c574 stack backtrace CPU 1 UID 0 PID 12806 Comm syz.5.1818 Not tainted 6.13.0-rc3-syzkaller-00762-g9268abe611b0 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024 Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c120 print_circular_bug+0x13a/0x1b0 kernel/locking/lockdep.c2074 check_noncircular+0x36a/0x4a0 kernel/locking/lockdep.c2206 check_prev_add kernel/locking/lockdep.c3161 [inline] check_prevs_add kernel/lockin ---truncated---

## Keyphrases
- **rootcause**: 'locking order violation'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5398 | 0.5969 | 0.5581 | 0.5564 | 20 |
| Sparse | 802.7825 | 1352.2693 | 913.7326 | 838.4732 | 10 |
| Graph | 1.3676 | 2.8303 | 1.7255 | 1.6796 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | Base | 2.8303 | Allowed |
| 2 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 3 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7801 | Allowed-with-Review |
| 5 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 7 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 8 | 833 | Deadlock | Base | 1.7286 | Allowed |
| 9 | 413 | Improper Resource Locking | Base | 1.7164 | Allowed |
| 10 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 11 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 12 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 13 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6377 | Allowed |
| 14 | 129 | Improper Validation of Array Index | Variant | 1.5817 | Allowed |
| 15 | 252 | Unchecked Return Value | Base | 1.5569 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 667 | Improper Locking | Class | 0.5969 | 0.5969 | Allowed-with-Review |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5936 | 0.5936 | Allowed-with-Review |
| 3 | 833 | Deadlock | Base | 0.5787 | 0.5787 | Allowed |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5726 | 0.5726 | Allowed |
| 5 | 909 | Missing Initialization of Resource | Class | 0.5685 | 0.5685 | Allowed-with-Review |
| 6 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.5640 | 0.5640 | Allowed |
| 7 | 413 | Improper Resource Locking | Base | 0.5615 | 0.5615 | Allowed |
| 8 | 121 | Stack-based Buffer Overflow | Variant | 0.5609 | 0.5609 | Allowed |
| 9 | 416 | Use After Free | Variant | 0.5589 | 0.5589 | Allowed |
| 10 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5582 | 0.5582 | Allowed |
| 11 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5546 | 0.5546 | Discouraged |
| 12 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5538 | 0.5538 | Allowed |
| 13 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5456 | 0.5456 | Allowed |
| 14 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.5436 | 0.5436 | Allowed |
| 15 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5434 | 0.5434 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 1352.2693 | 1352.2693 | Allowed-with-Review |
| 2 | 833 | Deadlock | 1021.2377 | 1021.2377 | Allowed |
| 3 | 413 | Improper Resource Locking | 957.8890 | 957.8890 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 878.1771 | 878.1771 | Allowed-with-Review |
| 5 | 476 | NULL Pointer Dereference | 839.0916 | 839.0916 | Allowed |
| 6 | 911 | Improper Update of Reference Count | 837.8548 | 837.8548 | Allowed |
| 7 | 909 | Missing Initialization of Resource | 819.4181 | 819.4181 | Allowed-with-Review |
| 8 | 674 | Uncontrolled Recursion | 818.5799 | 818.5799 | Allowed-with-Review |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | 810.0265 | 810.0265 | Allowed |
| 10 | 415 | Double Free | 802.7825 | 802.7825 | Allowed |
