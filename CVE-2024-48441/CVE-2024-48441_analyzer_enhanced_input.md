## Vulnerability Description
Wuhan Tianyu Information Industry Co., Ltd Tianyu CPE Router CommonCPExCPETS_v3.2.468.11.04_P4 was discovered to contain a **command injection** vulnerability via the component at_command.asp.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Wuhan Tianyu Information Industry Co., Ltd Tianyu CPE Router
- **version:** CommonCPExCPETS_v3.2.468.11.04_P4
- **component:** at_command.asp

## CVE Reference Links Content Summary
The provided content discusses multiple vulnerabilities found in routers using JBoneOS or JBoneCloud firmware, and mentions CVE-2024-48441 as it relates to Tianyu CPE Routers.

**Root Cause of Vulnerability:**

*   **Unauthenticated Factory Mode Reset:** The web interface of the affected routers has unprotected ASP pages (`fac.asp` and `at_command.asp`) that allow an attacker to perform a factory reset or inject AT commands without authentication.
*  **Lack of Authentication:** The vulnerable ASP pages lack any authentication mechanisms, making them accessible to anyone on the network.

**Weaknesses/Vulnerabilities:**

*   **Unauthenticated Access:** The `fac.asp` page allows triggering a factory reset without authentication.
*   **AT Command Injection:** The `at_command.asp` page allows injecting arbitrary AT commands, which can be used to extract sensitive information.
*  **Default Credentials After Reset:** Factory reset reverts the device to default credentials (`root/root`), providing easy access for attackers.

**Impact of Exploitation:**

*   **Full Device Control:** Successful factory reset allows SSH access with default credentials, granting an attacker root access.
*   **Information Disclosure:** AT command injection can lead to the disclosure of sensitive information, such as IMEI, IMSI, and other modem details.
* **Denial of Service:** Factory reset will disrupt the normal operation of the device.

**Attack Vectors:**

*   **Network Access:** The attacker needs network access to the router's web interface.
*   **Direct HTTP requests:**  The vulnerabilities are exposed through HTTP requests to the unprotected ASP pages.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be on the same network or have access to the router's web interface to send HTTP requests to `/fac.asp` or `/at_command.asp`.
* No authentication or special user privileges are needed.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.115 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.115 |
| 5 | 426 | Untrusted Search Path | Base | Allowed | sparse | 0.104 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.101 |
| 7 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.100 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.099 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.570 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-790: Improper Filtering of Special Elements

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-426: Untrusted Search Path

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-259: Use of Hard-coded Password

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')