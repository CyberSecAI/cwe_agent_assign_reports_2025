{
  "cve_id": "CVE-2024-34750",
  "description": "Improper Handling of Exceptional Conditions, Uncontrolled Resource Consumption vulnerability in Apache Tomcat. When processing an HTTP/2 stream, Tomcat did not handle some cases of excessive HTTP headers correctly. This led to a miscounting of active HTTP/2 streams which in turn led to the use of an incorrect infinite timeout which allowed connections to remain open which should have been closed. This issue affects Apache Tomcat from 11.0.0-M1 through 11.0.0-M20, from 10.1.0-M1 through 10.1.24, from 9.0.0-M1 through 9.0.89. Users are recommended to upgrade to version 11.0.0-M21, 10.1.25 or 9.0.90, which fixes the issue.",
  "key_phrases": {
    "rootcause": "Improper Handling of Exceptional Conditions Uncontrolled Resource Consumption",
    "weakness": "",
    "impact": "Resource Consumption",
    "vector": "processing an HTTP/2 stream",
    "attacker": "",
    "product": "Apache Tomcat",
    "version": [
      "from 11.0.0-M1 through 11.0.0-M20",
      "from 10.1.0-M1 through 10.1.24",
      "from 9.0.0-M1 through 9.0.89"
    ],
    "component": ""
  },
  "reference_content": "Based on the provided information, here's an analysis of CVE-2024-34750:\n\n**Root Cause of Vulnerability:**\n\n*   The vulnerability lies within Apache Tomcat versions 11.0.0-M1 through 11.0.0-M20, 10.1.0-M1 through 10.1.24, and 9.0.0-M1 through 9.0.89. The specific nature of the flaw is not detailed in this advisory, but it is related to how these versions handle certain requests or data, leading to a denial of service.\n\n**Weaknesses/Vulnerabilities Present:**\n\n*   The primary vulnerability is a flaw in Apache Tomcat that can be exploited to cause a Denial of Service (DoS).\n\n**Impact of Exploitation:**\n\n*   Successful exploitation of the vulnerability can lead to a Denial of Service (DoS) condition. This would likely result in the affected application or system being unavailable to legitimate users.\n\n**Attack Vectors:**\n\n*   The attack vector is network-based (AV:N) which means a remote attacker can initiate the attack.\n*   The attack does not require special privileges (PR:N), meaning no authentication is required to exploit it.\n*   No user interaction is required (UI:N).\n\n**Required Attacker Capabilities/Position:**\n\n*   The attacker needs to be able to send network traffic to the vulnerable Apache Tomcat instance. No special privileges or user interactions are necessary, thus this is exploitable over the network by any unauthenticated user.\n\n**Additional Notes**\n\n*   The vulnerability has a CVSS score of 5.3, which is considered Medium severity.\n*   NetApp has identified products that utilize these vulnerable versions of Apache Tomcat and has classified their products based on their vulnerability status.\n*   The advisory indicates that a patch will be provided to address the issue in vulnerable products once they are made available.\n*   The information in this advisory is an interim update, and NetApp will continue to update the advisory as more information is available.\n*  The advisory provides links to subscribe to updates and is considered the single source of current, authorized, and accurate information regarding full support products.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-755 | Improper Handling of Exceptional Conditions | 0.8 | Class | Primary | Allowed-with-Review |\n| CWE-400 | Uncontrolled Resource Consumption | 0.7 | Class | Secondary | Discouraged |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.75\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship influencing the decision is that CWE-755 is a class-level CWE, and it can lead to resource consumption issues. While other more specific CWEs could be considered if more details were available. The final decision also considered that while CWE-400 is also a class and discouraged, it accurately reflects the impact of the **Improper Handling of Exceptional Conditions**.\n\n```mermaid\ngraph TD\n    cwe755[\"CWE-755: Improper Handling of Exceptional Conditions\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n\n    cwe400 -->|CANRESULTIN| cwe755\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe755 primary\n    class cwe400 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **Improper Handling of Exceptional Conditions** (CWE-755), which leads to a miscounting of active HTTP/2 streams. This, in turn, results in an incorrect infinite timeout, allowing connections to remain open when they should be closed, eventually leading to **Uncontrolled Resource Consumption** (CWE-400) and a denial of service.\n\n## Summary of Analysis\nThe initial analysis identified CWE-755 as the primary root cause due to the explicit mention of \"**Improper Handling of Exceptional Conditions**\" in the vulnerability description and key phrases. The subsequent resource consumption and denial of service are consequences of this improper handling. While CWE-400 is listed as a root cause in the key phrases, it is more accurately reflecting the impact of the vulnerability.\n\nThe evidence provided explicitly states: \"When processing an HTTP/2 stream, Tomcat did not handle some cases of excessive HTTP headers correctly. This led to a miscounting of active HTTP/2 streams which in turn led to the use of an incorrect infinite timeout which allowed connections to remain open which should have been closed.\"\n\nThe graph relationships influenced the final selection by highlighting the potential chain of events, with CWE-755 as the starting point and CWE-400 as the result.\n\nThe selected CWEs are at the optimal level of specificity given the available information. While more specific CWEs related to resource management might exist, the description doesn't provide enough detail to warrant their selection.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-400: Uncontrolled Resource Consumption\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-400 is intended for incorrect behaviors in which the product is expected to track and restrict how many resources it consumes, but CWE-400 is often misused because it is conflated with the \"technical impact\" of vulnerabilities in which resource consumption occurs. It is sometimes used for low-information vulnerability reports. It is a level-1 Class (i.e., a child of a Pillar).\n\n**Technical Explanation for CWE-755:**\n\n*   **How the vulnerability's details match the CWE's characteristics:** The vulnerability description explicitly mentions \"**Improper Handling of Exceptional Conditions**\". This aligns directly with CWE-755, which describes scenarios where a product fails to handle exceptional conditions correctly.\n*   **The security implications and potential impact:** The improper handling leads to a miscounting of HTTP/2 streams and an incorrect timeout, ultimately causing connections to remain open unnecessarily.\n*   **Any parent-child relationships or chain patterns that influenced your mapping:** CWE-755 is a class-level CWE, and it can lead to resource management issues, as seen in this case where it leads to uncontrolled resource consumption.\n*   **Whether the weakness is primary or secondary in the vulnerability:** This is the primary weakness as it is the root cause of the subsequent resource consumption.\n*   **How the official MITRE mapping guidance influenced your decision:** While CWE-755 is a Class, the description aligns directly with the vulnerability, making it the most appropriate choice despite the discouraged usage.\n\n**Technical Explanation for CWE-400:**\n\n*   **How the vulnerability's details match the CWE's characteristics:** The vulnerability ultimately leads to connections remaining open and consuming resources unnecessarily, aligning with CWE-400's description of uncontrolled resource consumption.\n*   **The security implications and potential impact:** The uncontrolled resource consumption can lead to a denial of service, making the system unavailable to legitimate users.\n*   **Any parent-child relationships or chain patterns that influenced your mapping:** CWE-400 is the resulting impact of the initial **Improper Handling of Exceptional Conditions** (CWE-755).\n*   **Whether the weakness is primary or secondary in the vulnerability:** This is a secondary weakness, representing the impact of the primary weakness.\n*   **How the official MITRE mapping guidance influenced your decision:** Although CWE-400 is discouraged, it is included because it accurately captures the resulting impact of the vulnerability, specifically the uncontrolled consumption of resources leading to a denial of service.\n\n**CWEs Considered but Not Used:**\n\n*   **CWE-770: Allocation of Resources Without Limits or Throttling:** While resource allocation is involved, the core issue is not the lack of limits on allocation but the improper handling of exceptional conditions that leads to resource consumption.\n*   **CWE-789: Memory Allocation with Excessive Size Value:** This CWE is related to memory allocation, but the vulnerability doesn't explicitly mention memory allocation issues.\n*   **CWE-1333: Inefficient Regular Expression Complexity:** This CWE is not relevant as the vulnerability description does not mention regular expressions.\n*   **CWE-404: Improper Resource Shutdown or Release:** This could be considered but the connections were never closed due to miscounting of active streams.\n*   **CWE-410: Insufficient Resource Pool:** The issue isn't about the size of the resource pool but the incorrect handling of HTTP/2 streams leading to resource exhaustion.\n*   **CWE-20: Improper Input Validation:** While input validation might be indirectly related, the primary issue is with the handling of exceptional conditions.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-755 | Improper Handling of Exceptional Conditions | 0.8 | Class | Primary | Allowed-with-Review |\n| CWE-400 | Uncontrolled Resource Consumption | 0.7 | Class | Secondary | Discouraged |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.75\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship influencing the decision is that CWE-755 is a class-level CWE, and it can lead to resource consumption issues. While other more specific CWEs could be considered if more details were available. The final decision also considered that while CWE-400 is also a class and discouraged, it accurately reflects the impact of the **Improper Handling of Exceptional Conditions**.\n\n```mermaid\ngraph TD\n    cwe755[\"CWE-755: Improper Handling of Exceptional Conditions\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n\n    cwe400 -->|CANRESULTIN| cwe755\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe755 primary\n    class cwe400 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **Improper Handling of Exceptional Conditions** (CWE-755), which leads to a miscounting of active HTTP/2 streams. This, in turn, results in an incorrect infinite timeout, allowing connections to remain open when they should be closed, eventually leading to **Uncontrolled Resource Consumption** (CWE-400) and a denial of service.\n\n## Summary of Analysis\nThe initial analysis identified CWE-755 as the primary root cause due to the explicit mention of \"**Improper Handling of Exceptional Conditions**\" in the vulnerability description and key phrases. The subsequent resource consumption and denial of service are consequences of this improper handling. While CWE-400 is listed as a root cause in the key phrases, it is more accurately reflecting the impact of the vulnerability.\n\nThe evidence provided explicitly states: \"When processing an HTTP/2 stream, Tomcat did not handle some cases of excessive HTTP headers correctly. This led to a miscounting of active HTTP/2 streams which in turn led to the use of an incorrect infinite timeout which allowed connections to remain open which should have been closed.\"\n\nThe graph relationships influenced the final selection by highlighting the potential chain of events, with CWE-755 as the starting point and CWE-400 as the result.\n\nThe selected CWEs are at the optimal level of specificity given the available information. While more specific CWEs related to resource management might exist, the description doesn't provide enough detail to warrant their selection.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-400: Uncontrolled Resource Consumption\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-400 is intended for incorrect behaviors in which the product is expected to track and restrict how many resources it consumes, but CWE-400 is often misused because it is conflated with the \"technical impact\" of vulnerabilities in which resource consumption occurs. It is sometimes used for low-information vulnerability reports. It is a level-1 Class (i.e., a child of a Pillar).\n\n**Technical Explanation for CWE-755:**\n\n*   **How the vulnerability's details match the CWE's characteristics:** The vulnerability description explicitly mentions \"**Improper Handling of Exceptional Conditions**\". This aligns directly with CWE-755, which describes scenarios where a product fails to handle exceptional conditions correctly.\n*   **The security implications and potential impact:** The improper handling leads to a miscounting of HTTP/2 streams and an incorrect timeout, ultimately causing connections to remain open unnecessarily.\n*   **Any parent-child relationships or chain patterns that influenced your mapping:** CWE-755 is a class-level CWE, and it can lead to resource management issues, as seen in this case where it leads to uncontrolled resource consumption.\n*   **Whether the weakness is primary or secondary in the vulnerability:** This is the primary weakness as it is the root cause of the subsequent resource consumption.\n*   **How the official MITRE mapping guidance influenced your decision:** While CWE-755 is a Class, the description aligns directly with the vulnerability, making it the most appropriate choice despite the discouraged usage.\n\n**Technical Explanation for CWE-400:**\n\n*   **How the vulnerability's details match the CWE's characteristics:** The vulnerability ultimately leads to connections remaining open and consuming resources unnecessarily, aligning with CWE-400's description of uncontrolled resource consumption.\n*   **The security implications and potential impact:** The uncontrolled resource consumption can lead to a denial of service, making the system unavailable to legitimate users.\n*   **Any parent-child relationships or chain patterns that influenced your mapping:** CWE-400 is the resulting impact of the initial **Improper Handling of Exceptional Conditions** (CWE-755).\n*   **Whether the weakness is primary or secondary in the vulnerability:** This is a secondary weakness, representing the impact of the primary weakness.\n*   **How the official MITRE mapping guidance influenced your decision:** Although CWE-400 is discouraged, it is included because it accurately captures the resulting impact of the vulnerability, specifically the uncontrolled consumption of resources leading to a denial of service.\n\n**CWEs Considered but Not Used:**\n\n*   **CWE-770: Allocation of Resources Without Limits or Throttling:** While resource allocation is involved, the core issue is not the lack of limits on allocation but the improper handling of exceptional conditions that leads to resource consumption.\n*   **CWE-789: Memory Allocation with Excessive Size Value:** This CWE is related to memory allocation, but the vulnerability doesn't explicitly mention memory allocation issues.\n*   **CWE-1333: Inefficient Regular Expression Complexity:** This CWE is not relevant as the vulnerability description does not mention regular expressions.\n*   **CWE-404: Improper Resource Shutdown or Release:** This could be considered but the connections were never closed due to miscounting of active streams.\n*   **CWE-410: Insufficient Resource Pool:** The issue isn't about the size of the resource pool but the incorrect handling of HTTP/2 streams leading to resource exhaustion.\n*   **CWE-20: Improper Input Validation:** While input validation might be indirectly related, the primary issue is with the handling of exceptional conditions.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n**Chain starting from CWE-770:**\n- 770 (Allocation of Resources Without Limits or Throttling) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "source": "sparse"
      },
      "similarity": 619.7749699228934
    },
    {
      "metadata": {
        "doc_id": "116",
        "name": "Improper Encoding or Escaping of Output",
        "source": "sparse"
      },
      "similarity": 605.3155624017559
    },
    {
      "metadata": {
        "doc_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "source": "sparse"
      },
      "similarity": 602.4899807676333
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 601.0199927948103
    },
    {
      "metadata": {
        "doc_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "source": "sparse"
      },
      "similarity": 598.3339855510844
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse"
      },
      "similarity": 597.7768349627703
    },
    {
      "metadata": {
        "doc_id": "755",
        "name": "Improper Handling of Exceptional Conditions",
        "source": "sparse"
      },
      "similarity": 588.6222961570886
    },
    {
      "metadata": {
        "doc_id": "401",
        "name": "Missing Release of Memory after Effective Lifetime",
        "source": "sparse"
      },
      "similarity": 583.9599919755782
    },
    {
      "metadata": {
        "doc_id": "410",
        "name": "Insufficient Resource Pool",
        "type": "Base",
        "original_content": "The product's resource pool is not large enough to handle peak demand, which allows an attacker to prevent others from accessing the resource by using a (relatively) large number of requests for resources.",
        "keyphrase_source": "rootcause:Improper Handling of Exceptional Conditions Uncontrolled Resource Consumption",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5234585672311565,
            "graph": 2.827499884515663
          }
        }
      },
      "similarity": 0.5234585672311565
    },
    {
      "doc_id": "911",
      "text": "CWE-911: Improper Update of Reference Count",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "911",
        "name": "Improper Update of Reference Count",
        "type": "base",
        "original_content": "CWE-911: Improper Update of Reference Count",
        "relationships": [
          {
            "source_id": "911",
            "target_id": "772",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "911",
            "target_id": "672",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "911",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "911",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "672",
            "target_id": "911",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "911",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "772",
                  "911",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "772"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "772",
                  "911",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "772"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "911",
                  "772",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "772"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-400",
      "CWE-770",
      "CWE-404",
      "CWE-410",
      "CWE-755",
      "CWE-20",
      "CWE-789",
      "CWE-1333"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}