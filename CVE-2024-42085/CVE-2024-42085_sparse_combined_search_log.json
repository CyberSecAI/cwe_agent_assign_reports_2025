{
  "method": "sparse_combined",
  "query": "In the Linux kernel, the following vulnerability has been resolved usb dwc3 core remove lock of otg mode during gadget suspend/resume to avoid deadlock When config CONFIG_USB_DWC3_DUAL_ROLE is selected, and trigger system to enter suspend status with below command echo mem > /sys/power/state There will be a deadlock issue occurring. Detailed invoking path as below dwc3_suspend_common() spin_lock_irqsave(&dwc->lock, flags) lock, flags) gadget_driver is NULL or not. It causes the following code is executed and deadlock occurs when trying to get the spinlock. In fact, the root cause is the commit 5265397f9442(usb dwc3 Remove DWC3 locking during gadget suspend/resume) that forgot to remove the lock of otg mode. So, remove the redundant lock of otg mode during gadget suspend/resume.",
  "keyphrases": {
    "rootcause": [
      "Remove DWC3 locking during gadget suspend",
      "resume"
    ],
    "weakness": [
      "deadlock"
    ]
  },
  "timestamp": "2025-07-12T03:38:41.239388",
  "results_count": 11,
  "results_summary": [
    {
      "doc_id": "667",
      "name": "Improper Locking",
      "score": 665.3417029942195
    },
    {
      "doc_id": "833",
      "name": "Deadlock",
      "score": 649.9515966130442
    },
    {
      "doc_id": "476",
      "name": "NULL Pointer Dereference",
      "score": 531.1604042503056
    },
    {
      "doc_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 522.3685662100652
    },
    {
      "doc_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "score": 518.5332091272098
    }
  ]
}