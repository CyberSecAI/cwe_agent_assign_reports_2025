# Raw Retriever Results for CVE-2024-42085

# Raw Retriever Results for CVE-2024-42085
## Query
In the Linux kernel, the following vulnerability has been resolved usb dwc3 core remove lock of otg mode during gadget suspend/resume to avoid deadlock When config CONFIG_USB_DWC3_DUAL_ROLE is selected, and trigger system to enter suspend status with below command echo mem > /sys/power/state There will be a deadlock issue occurring. Detailed invoking path as below dwc3_suspend_common() spin_lock_irqsave(&dwc->lock, flags) lock, flags) gadget_driver is NULL or not. It causes the following code is executed and deadlock occurs when trying to get the spinlock. In fact, the root cause is the commit 5265397f9442(usb dwc3 Remove DWC3 locking during gadget suspend/resume) that forgot to remove the lock of otg mode. So, remove the redundant lock of otg mode during gadget suspend/resume.

## Keyphrases
- **rootcause**: 'Remove DWC3 locking during gadget suspend', 'resume'
- **weakness**: 'deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4143 | 0.5145 | 0.4439 | 0.4408 | 20 |
| Sparse | 479.4895 | 665.3417 | 533.4006 | 517.1231 | 11 |
| Graph | 1.3676 | 2.8652 | 1.8355 | 1.6861 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.8210 | Allowed |
| 3 | 252 | Unchecked Return Value | base | 2.2100 | Allowed |
| 4 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.1866 | Allowed |
| 6 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | base | 2.1190 | Allowed |
| 7 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | base | 1.7680 | Allowed |
| 9 | 833 | Deadlock | Base | 1.6979 | Allowed |
| 10 | 1234 | Hardware Internal or Debug Modes Allow Override of Locks | Base | 1.6862 | Allowed |
| 11 | 413 | Improper Resource Locking | Base | 1.6860 | Allowed |
| 12 | 1232 | Improper Lock Behavior After Power State Transition | Base | 1.6824 | Allowed |
| 13 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |
| 14 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 15 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.5210 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5145 | 0.5145 | Allowed |
| 2 | 1234 | Hardware Internal or Debug Modes Allow Override of Locks | Base | 0.4823 | 0.4823 | Allowed |
| 3 | 413 | Improper Resource Locking | Base | 0.4772 | 0.4772 | Allowed |
| 4 | 1232 | Improper Lock Behavior After Power State Transition | Base | 0.4752 | 0.4752 | Allowed |
| 5 | 667 | Improper Locking | Class | 0.4750 | 0.4750 | Allowed-with-Review |
| 6 | 832 | Unlock of a Resource that is not Locked | Base | 0.4626 | 0.4626 | Allowed |
| 7 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4571 | 0.4571 | Allowed |
| 8 | 1273 | Device Unlock Credential Sharing | Base | 0.4483 | 0.4483 | Allowed |
| 9 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | 0.4482 | 0.4482 | Allowed |
| 10 | 820 | Missing Synchronization | Base | 0.4459 | 0.4459 | Allowed |
| 11 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.4358 | 0.4358 | Allowed |
| 12 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4226 | 0.4226 | Allowed |
| 13 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | Variant | 0.4213 | 0.4213 | Allowed |
| 14 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 0.4194 | 0.4194 | Allowed |
| 15 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4166 | 0.4166 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 665.3417 | 665.3417 | Allowed-with-Review |
| 2 | 833 | Deadlock | 649.9516 | 649.9516 | Allowed |
| 3 | 476 | NULL Pointer Dereference | 531.1604 | 531.1604 | Allowed |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 522.3686 | 522.3686 | Allowed |
| 5 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 518.5332 | 518.5332 | Allowed |
| 6 | 191 | Integer Underflow (Wrap or Wraparound) | 517.1231 | 517.1231 | Allowed |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | 510.6193 | 510.6193 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | 496.8365 | 496.8365 | Allowed |
| 9 | 732 | Incorrect Permission Assignment for Critical Resource | 489.3091 | 489.3091 | Allowed-with-Review |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 486.6733 | 486.6733 | Allowed-with-Review |
| 11 | 451 | User Interface (UI) Misrepresentation of Critical Information | 479.4895 | 479.4895 | Allowed-with-Review |
