{
  "query": "In the Linux kernel, the following vulnerability has been resolved usb dwc3 core remove lock of otg mode during gadget suspend/resume to avoid deadlock When config CONFIG_USB_DWC3_DUAL_ROLE is selected, and trigger system to enter suspend status with below command echo mem > /sys/power/state There will be a deadlock issue occurring. Detailed invoking path as below dwc3_suspend_common() spin_lock_irqsave(&dwc->lock, flags) lock, flags) gadget_driver is NULL or not. It causes the following code is executed and deadlock occurs when trying to get the spinlock. In fact, the root cause is the commit 5265397f9442(usb dwc3 Remove DWC3 locking during gadget suspend/resume) that forgot to remove the lock of otg mode. So, remove the redundant lock of otg mode during gadget suspend/resume.",
  "count": 20,
  "results": [
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "abstraction": "Base",
      "score": 0.5145342426803625,
      "original_score": 0.5145342426803625,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1234",
      "name": "Hardware Internal or Debug Modes Allow Override of Locks",
      "abstraction": "Base",
      "score": 0.48231460450161895,
      "original_score": 0.48231460450161895,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "abstraction": "Base",
      "score": 0.47715621140214326,
      "original_score": 0.47715621140214326,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1232",
      "name": "Improper Lock Behavior After Power State Transition",
      "abstraction": "Base",
      "score": 0.4752165961269229,
      "original_score": 0.4752165961269229,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 0.4750448499000892,
      "original_score": 0.4750448499000892,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "832",
      "name": "Unlock of a Resource that is not Locked",
      "abstraction": "Base",
      "score": 0.4625558881391671,
      "original_score": 0.4625558881391671,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1233",
      "name": "Security-Sensitive Hardware Controls with Missing Lock Bit Protection",
      "abstraction": "Base",
      "score": 0.45706679254475113,
      "original_score": 0.45706679254475113,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1273",
      "name": "Device Unlock Credential Sharing",
      "abstraction": "Base",
      "score": 0.44828121479885485,
      "original_score": 0.44828121479885485,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1272",
      "name": "Sensitive Information Uncleared Before Debug/Power State Transition",
      "abstraction": "Base",
      "score": 0.4481839920150855,
      "original_score": 0.4481839920150855,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "820",
      "name": "Missing Synchronization",
      "abstraction": "Base",
      "score": 0.44593657512210305,
      "original_score": 0.44593657512210305,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1231",
      "name": "Improper Prevention of Lock Bit Modification",
      "abstraction": "Base",
      "score": 0.4357614229238124,
      "original_score": 0.4357614229238124,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1256",
      "name": "Improper Restriction of Software Interfaces to Hardware Features",
      "abstraction": "Base",
      "score": 0.4225654542702458,
      "original_score": 0.4225654542702458,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1222",
      "name": "Insufficient Granularity of Address Regions Protected by Register Locks",
      "abstraction": "Variant",
      "score": 0.4213117506075896,
      "original_score": 0.4213117506075896,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1190",
      "name": "DMA Device Enabled Too Early in Boot Phase",
      "abstraction": "Base",
      "score": 0.41942588331118913,
      "original_score": 0.41942588331118913,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "782",
      "name": "Exposed IOCTL with Insufficient Access Control",
      "abstraction": "Variant",
      "score": 0.4165823799996531,
      "original_score": 0.4165823799996531,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "765",
      "name": "Multiple Unlocks of a Critical Resource",
      "abstraction": "Base",
      "score": 0.4164031641121758,
      "original_score": 0.4164031641121758,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "abstraction": "Base",
      "score": 0.4154520289831263,
      "original_score": 0.4154520289831263,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1304",
      "name": "Improperly Preserved Integrity of Hardware Configuration State During a Power Save/Restore Operation",
      "abstraction": "Base",
      "score": 0.4152848203304908,
      "original_score": 0.4152848203304908,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "score": 0.41496862440453197,
      "original_score": 0.41496862440453197,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "591",
      "name": "Sensitive Data Storage in Improperly Locked Memory",
      "abstraction": "Variant",
      "score": 0.41434224848774137,
      "original_score": 0.41434224848774137,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.41434224848774137,
    "max": 0.5145342426803625,
    "mean": 0.4439194372330827,
    "median": 0.4408489990229577,
    "count": 20
  }
}