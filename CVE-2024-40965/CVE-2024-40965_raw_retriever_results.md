# Raw Retriever Results for CVE-2024-40965

# Raw Retriever Results for CVE-2024-40965
## Query
In the Linux kernel, the following vulnerability has been resolved i2c lpi2c Avoid calling clk_get_rate during transfer Instead of repeatedly calling clk_get_rate for each transfer, lock the clock rate and cache the value. A deadlock has been observed while adding tlv320aic32x4 audio codec to the system. When this clock provider adds its clock, the clk mutex is locked already, it needs to access i2c, which in return needs the mutex for clk_get_rate as well.

## Keyphrases
- **rootcause**: 'deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4220 | 0.4841 | 0.4462 | 0.4453 | 20 |
| Sparse | 304.4698 | 406.5111 | 336.6253 | 326.7138 | 10 |
| Graph | 1.3010 | 2.2100 | 1.6478 | 1.6796 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 2 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 3 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 5 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 6 | 413 | Improper Resource Locking | Base | 1.6985 | Allowed |
| 7 | 833 | Deadlock | Base | 1.6948 | Allowed |
| 8 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 9 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 11 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 12 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 13 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 1.5912 | Allowed |
| 14 | 789 | Memory Allocation with Excessive Size Value | variant | 1.5552 | Allowed |
| 15 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 1.4875 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.4841 | 0.4841 | Allowed |
| 2 | 413 | Improper Resource Locking | Base | 0.4773 | 0.4773 | Allowed |
| 3 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4748 | 0.4748 | Allowed |
| 4 | 1247 | Improper Protection Against Voltage and Clock Glitches | Base | 0.4608 | 0.4608 | Allowed |
| 5 | 1331 | Improper Isolation of Shared Resources in Network On Chip (NoC) | Base | 0.4550 | 0.4550 | Allowed |
| 6 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4511 | 0.4511 | Allowed |
| 7 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.4499 | 0.4499 | Allowed |
| 8 | 820 | Missing Synchronization | Base | 0.4488 | 0.4488 | Allowed |
| 9 | 667 | Improper Locking | Class | 0.4465 | 0.4465 | Allowed-with-Review |
| 10 | 1189 | Improper Isolation of Shared Resources on System-on-a-Chip (SoC) | Base | 0.4465 | 0.4465 | Allowed |
| 11 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4442 | 0.4442 | Allowed |
| 12 | 1298 | Hardware Logic Contains Race Conditions | Base | 0.4431 | 0.4431 | Allowed |
| 13 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4391 | 0.4391 | Allowed |
| 14 | 1262 | Improper Access Control for Register Interface | Base | 0.4391 | 0.4391 | Allowed |
| 15 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4364 | 0.4364 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 406.5111 | 406.5111 | Allowed-with-Review |
| 2 | 833 | Deadlock | 370.5102 | 370.5102 | Allowed |
| 3 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | 349.2758 | 349.2758 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 331.0576 | 331.0576 | Allowed-with-Review |
| 5 | 1247 | Improper Protection Against Voltage and Clock Glitches | 328.0231 | 328.0231 | Allowed |
| 6 | 1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | 325.4045 | 325.4045 | Allowed |
| 7 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | 318.2620 | 318.2620 | Allowed |
| 8 | 59 | Improper Link Resolution Before File Access ('Link Following') | 316.6564 | 316.6564 | Allowed |
| 9 | 287 | Improper Authentication | 316.0827 | 316.0827 | Discouraged |
| 10 | 1251 | Mirrored Regions with Different Values | 304.4698 | 304.4698 | Allowed |
