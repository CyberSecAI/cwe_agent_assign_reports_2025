# Raw Retriever Results for CVE-2024-38610

# Raw Retriever Results for CVE-2024-38610
## Query
In the Linux kernel, the following vulnerability has been resolved drivers/virt/acrn fix PFNMAP PTE checks in acrn_vm_ram_map() Patch series mm follow_pte() improvements and acrn follow_pte() fixes. Patch #1 fixes a bunch of issues I spotted in the acrn driver. It compiles, thats all I know. Ill appreciate some review and testing from acrn folks. Patch #2+#3 improve follow_pte(), passing a VMA instead of the MM, adding more sanity checks, and improving the documentation. Gave it a quick test on x86-64 using VM_PAT that ends up using follow_pte(). This patch (of 3) We currently miss handling various cases, resulting in a dangerous follow_pte() (previously follow_pfn()) usage. (1) Were not checking PTE write permissions. Maybe we should simply always require pte_write() like we do for pin_user_pages_fast(FOLL_WRITE)? Hard to tell, so lets check for ACRN_MEM_ACCESS_WRITE for now. (2) Were not rejecting refcounted pages. As we are not using MMU notifiers, messing with refcounted pages is dangerous and can result in use-after-free. Lets make sure to reject them. (3) We are only looking at the first PTE of a bigger range. We only lookup a single PTE, but memmap->len may span a larger area. Lets loop over all involved PTEs and make sure the PFN range is actually contiguous. Reject everything else it couldnt have worked either way, and rather made use access PFNs we shouldnt be accessing.

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4447 | 0.4903 | 0.4605 | 0.4542 | 20 |
| Sparse | 263.3670 | 289.8721 | 274.0525 | 273.8625 | 10 |
| Graph | 1.6768 | 2.8652 | 1.8900 | 1.7550 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 2 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.2100 | Allowed |
| 4 | 619 | Dangling Database Cursor ('Cursor Injection') | base | 2.2100 | Allowed |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.1190 | Allowed |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.9512 | Allowed |
| 7 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 8 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 9 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 10 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 11 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 1.7550 | Allowed |
| 12 | 590 | Free of Memory not on the Heap | variant | 1.7117 | Allowed |
| 13 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 14 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 15 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.4903 | 0.4903 | Allowed-with-Review |
| 2 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4865 | 0.4865 | Allowed |
| 3 | 667 | Improper Locking | Class | 0.4799 | 0.4799 | Allowed-with-Review |
| 4 | 404 | Improper Resource Shutdown or Release | Class | 0.4743 | 0.4743 | Allowed-with-Review |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4726 | 0.4726 | Allowed-with-Review |
| 6 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4696 | 0.4696 | Allowed |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4672 | 0.4672 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4653 | 0.4653 | Allowed |
| 9 | 787 | Out-of-bounds Write | Base | 0.4589 | 0.4589 | Allowed |
| 10 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4550 | 0.4550 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4534 | 0.4534 | Allowed |
| 12 | 252 | Unchecked Return Value | Base | 0.4534 | 0.4534 | Allowed |
| 13 | 1262 | Improper Access Control for Register Interface | Base | 0.4506 | 0.4506 | Allowed |
| 14 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4502 | 0.4502 | Discouraged |
| 15 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4499 | 0.4499 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | 289.8721 | 289.8721 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 284.6261 | 284.6261 | Allowed-with-Review |
| 3 | 863 | Incorrect Authorization | 282.6196 | 282.6196 | Allowed-with-Review |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 278.1897 | 278.1897 | Allowed |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 276.6833 | 276.6833 | Allowed |
| 6 | 125 | Out-of-bounds Read | 271.0418 | 271.0418 | Allowed |
| 7 | 61 | UNIX Symbolic Link (Symlink) Following | 267.1288 | 267.1288 | Allowed |
| 8 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 263.5873 | 263.5873 | Allowed |
| 9 | 190 | Integer Overflow or Wraparound | 263.4098 | 263.4098 | Allowed |
| 10 | 862 | Missing Authorization | 263.3670 | 263.3670 | Allowed-with-Review |
