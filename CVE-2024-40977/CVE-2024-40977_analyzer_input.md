# Vulnerability Information: CVE-2024-40977

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved wifi mt76 mt7921s fix potential hung tasks during chip recovery During chip recovery (e.g. chip reset), there is a possible situation that kernel worker reset_work is holding the lock and waiting for kernel thread stat_worker to be parked, while stat_worker is waiting for the release of the same lock. It causes a **deadlock** resulting in the dumping of hung tasks messages and possible rebooting of the device. This patch prevents the execution of stat_worker during the chip recovery.

### Vulnerability Description Key Phrases
- **weakness:** **deadlock**
- **impact:** hung tasks
- **product:** Linux kernel

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": [
    {
      "cve": "CVE-2024-40977",
      "root_cause": "A deadlock occurs during chip recovery (e.g., chip reset) in the MediaTek mt7921s Wi-Fi driver. The `reset_work` kernel worker holds a lock and waits for the `stat_worker` kernel thread to be parked, while `stat_worker` is waiting for the same lock to be released.",
      "weaknesses": [
        "Concurrency issue leading to a deadlock due to improper locking during chip recovery.",
        "Lack of synchronization between `reset_work` and `stat_worker`."
      ],
      "impact": "The deadlock results in hung tasks messages being dumped and can potentially lead to a device reboot. The Wi-Fi functionality will be interrupted.",
      "attack_vectors": "The vulnerability is triggered by events causing chip recovery, such as chip reset.",
       "required_capabilities": "The attacker needs to cause a chip recovery. This could be triggered by various factors including issues with the device."
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 833 | Deadlock | Base | Allowed | sparse | 0.547 |
| 2 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.504 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.439 |
| 4 | 665 | Improper Initialization | Class | Discouraged | sparse | 0.428 |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.417 |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.410 |
| 7 | 413 | Improper Resource Locking | Base | Allowed | sparse | 0.404 |
| 8 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.394 |
| 9 | 1191 | On-Chip Debug and Test Interface With Improper Access Control | Base | Allowed | dense | 0.475 |
| 10 | 609 | Double-Checked Locking | Base | Allowed | graph | 0.003 |

