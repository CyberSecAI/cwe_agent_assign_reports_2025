## Vulnerability Description
An issue was discovered in GFI Kerio Control 9.2.5 through 9.4.5. The dest GET parameter passed to the /nonauth/addCertException.cs and /nonauth/guestConfirm.cs and /nonauth/expiration.cs pages is not properly sanitized before being used to generate a Location HTTP header in a 302 HTTP response. This can be exploited to perform Open Redirect or HTTP Response Splitting attacks, which in turn lead to Reflected Cross-Site Scripting (XSS). Remote command execution can be achieved by leveraging the upgrade feature in the admin interface.

### Vulnerability Description Key Phrases
- **component:** /nonauth/addCertException.cs, /nonauth/guestConfirm.cs, /nonauth/expiration.cs pages
- **rootcause:** **improper dest parameter sanitization**
- **weakness:** **Open Redirect, HTTP Response Splitting**
- **product:** GFI Kerio Control
- **impact:** Cross-Site Scripting, Reflected Cross-Site Scripting, command execution
- **version:** 9.2.5 through 9.4.5

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on CVE-2024-52875.

**1. Content from seclists.org_b1493b20_20250624_104745.html**

*   **Relevance:** This content is directly related to CVE-2024-52875.
*   **Details:**
    *   **Root cause of vulnerability:** Multiple HTTP Response Splitting vulnerabilities in GFI Kerio Control. The vulnerabilities exist because user input passed to specific pages via the "dest" GET parameter is not properly sanitized before being used to generate a "Location" HTTP header in a 302 HTTP response. Specifically, the application does not correctly filter/remove linefeed (LF) characters.
    *   **Weaknesses/vulnerabilities present:** HTTP Response Splitting. Reflected Cross-Site Scripting (XSS).
    *   **Impact of exploitation:** HTTP Response Splitting attacks, which in turn might allow to carry out Reflected Cross-Site Scripting (XSS) and possibly other attacks. The Reflected XSS vector might be abused to perform 1-click Remote Code Execution (RCE) attacks.
    *   **Attack vectors:** Exploitation is achieved by crafting a malicious URL.
    *   **Required attacker capabilities/position:** The attacker needs to craft a malicious URL.
    *   **Mitigation or fix:** No official solution is currently available at the time of the advisory. However, the vendor responded, stating they would take steps to resolve these vulnerabilities in coming releases of Kerio Control. The vendor was contacted inquiring about the ETA for the next Kerio Control release; no response. The vendor was informed that public disclosure is scheduled to occur within two weeks. The vendor responded stating "these vulnerabilities were already fixed and will be part of Kerio Control 9.4.5p1 which is now with our internal QA team".
    *   **More detail than CVE description:** Yes, the content provides detailed information on the affected versions (9.2.5 to 9.4.5), the specific pages affected, the root cause (improper sanitization of the "dest" parameter), and the potential impact (XSS and RCE). It also includes a disclosure timeline and CVE reference.

**2. Content from www.bleepingcomputer.com_2e75c5b1_20250624_202923.html**

*   **Relevance:** This content is directly related to CVE-2024-52875.
*   **Details:**
    *   **Vulnerability:** Critical CRLF injection vulnerability.
    *   **Impact:** Leads to 1-click remote code execution (RCE) attacks. Attackers can steal admin CSRF tokens.
    *   **Affected Software:** GFI KerioControl firewall product.
    *   **Affected Versions:** KerioControl versions 9.2.5 through 9.4.5.
    *   **Root cause of vulnerability:** Improper sanitization of line feed (LF) characters in the 'dest' parameter.
    *   **Attack Vector:** Exploitation through injected payloads, potentially leading to the extraction of cookies or CSRF tokens.
    *   **Exploitation Scenario:** An attacker could use the CSRF token of an authenticated admin user to upload a malicious .IMG file containing a root-level shell script, leveraging the Kerio upgrade functionality, which opens a reverse shell for the attacker.
    *   **Mitigation:** Applying the fix (version 9.4.5 Patch 1). Limiting access to KerioControl's web management interface to trusted IP addresses and disabling public access to the '/admin' and '/noauth' pages via firewall rules. Configuring shorter session expiration times.
    *   **More detail than CVE description:** Yes, the content describes the impact, the attack scenario, and mitigation steps. It also includes the detection of active exploitation attempts.

**3. Content from karmainsecurity.com_0538d3b9_20250624_104746.html**

*   **Relevance:** This content is directly related to CVE-2024-52875.
*   **Details:**
    *   **Root cause of vulnerability:** A CRLF Injection bug within specific pages of Kerio Control. The application does not correctly filter/remove linefeed (LF) characters in the "dest" GET parameter when generating the "Location" HTTP header in a 302 HTTP response.
    *   **Weaknesses/vulnerabilities present:** Open Redirect, HTTP Response Splitting, Reflected Cross-Site Scripting (XSS).
    *   **Impact of exploitation:** Open Redirect, Reflected Cross-Site Scripting (XSS) and possibly other attacks. 1-click RCE attacks.
    *   **Attack vectors:** Malicious links crafted to exploit the vulnerability.
    *   **Required attacker capabilities/position:** An attacker must trick a Kerio Control admin user into clicking a malicious link.
    *   **Mitigation or fix:** The vulnerability was fixed in Kerio Control 9.4.5p1.
    *   **More detail than CVE description:** Yes, the content provides a detailed technical analysis, including a proof of concept and steps for exploitation. It also explains the evolution of the vulnerability from a low-severity issue to a critical one due to the potential for 1-click RCE.

**4. Content from www.exploit-db.com_5d5c3435_20250624_202924.html**

*   **Relevance:** The content is related to Kerio Control but references multiple vulnerabilities, including a Remote Code Execution vulnerability. The specific vulnerability mentioned in the content, is related to Kerio Control versions <= 8.6.1.
*   **Details:**
    *   **Vulnerabilities:** SQL Injection, Remote Code Execution (RCE) through CSRF, and XSS.
    *   **Impact:** Full control over the firewall and the underlying network.
    *   **Attack scenario:** The attacker can exploit a SQL Injection flaw to gain access to user information. The information can be used to embed a CSRF exploit into one of the top-visited webpages. If the attacker succeeds and the exploit gets triggered by a visiting admin, arbitrary remote code execution will be gained.
    *   **RCE through File Upload:** The upgrade feature in the admin interface can be used to upload arbitrary files by simply changing a tar file to the extension .img. If a tar file is created which contains a upgrade.sh shell script, this script will be executed with root privileges.
    *   **More detail than CVE description:** The content describes multiple vulnerabilities and how they can be chained to gain full control over the firewall. Proof of concept included.

**5. Content from karmainsecurity.com_b59b9ca9_20250624_202918.html**

*   **Relevance:** This content contains a Proof of Concept (PoC) code for the CVE-2024-52875 vulnerability.
*   **Details:**
    *   **Vulnerability:** GFI Kerio Control <= 9.4.5 Multiple HTTP Response Splitting Vulnerabilities
    *   **Root Cause:** User input passed to these pages via the "dest" GET parameter is not properly sanitized before being used to generate a "Location" HTTP header in a 302 HTTP response. The application does not correctly filter/remove linefeed (LF) characters.
    *   **Exploitation:** Perform HTTP Response Splitting attacks, which in turn might allow to carry out Reflected Cross-Site Scripting (XSS) and possibly other attacks.
    *   **PoC:** A PHP script is provided to demonstrate the vulnerability and the potential for 1-click RCE.
    *   **More detail than CVE description:** Yes, the content provides a working PoC.

**6. Content from karmainsecurity.com_aa96fb37_20250624_202925.html**
*   **Relevance:** This content provides information about the author.
*   **Details:**
    *   **Content is not related to the CVE.**

**7. Content from karmainsecurity.com_48b4e7f8_20250624_202921.html**
*   **Relevance:** This content is a list of security vulnerabilities discovered by the author.
*   **Details:**
    *   **Content is not directly related to the CVE.**

**8. Content from en.wikipedia.org_62d4a2ec_20250624_202922.html**
*   **Relevance:** This content is about Kerio Technologies.
*   **Details:**
    *   **Content is not directly related to the CVE.**

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 601 | URL Redirection to Untrusted Site ('Open Redirect') | Base | Allowed | alternate_terms | 1.000 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.533 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.530 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.500 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.494 |
| 7 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.489 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.479 |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | dense | 0.608 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')

CWE-601: URL Redirection to Untrusted Site ('Open Redirect')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-138: Improper Neutralization of Special Elements

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-918: Server-Side Request Forgery (SSRF)

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')