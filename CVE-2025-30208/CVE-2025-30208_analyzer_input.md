# Vulnerability Information: CVE-2025-30208

## Vulnerability Description
Vite, a provider of frontend development tooling, has a vulnerability in versions prior to 6.2.3, 6.1.2, 6.0.12, 5.4.15, and 4.5.10. `@fs` denies access to files outside of Vite serving allow list. Adding `?raw??` or `?import&raw??` to the URL bypasses this limitation and returns the file content if it exists. This bypass exists because trailing separators such as `?` are removed in several places, but are not accounted for in query string regexes. The contents of arbitrary files can be returned to the browser. Only apps explicitly exposing the Vite dev server to the network (using `--host` or `server.host` config option) are affected. Versions 6.2.3, 6.1.2, 6.0.12, 5.4.15, and 4.5.10 fix the issue.

### Vulnerability Description Key Phrases
- **rootcause:** **trailing separators are removed in several places, but are not accounted for in query string regexes**
- **impact:** bypass this limitation and returns the file content if it exists
- **vector:** ?raw?? or ?import&raw??
- **product:** Vite
- **version:** prior to 6.2.3, 6.1.2, 6.0.12, 5.4.15, and 4.5.10
- **component:** @fs

## CVE Reference Links Content Summary
CVE-2025-30208

**Root cause of vulnerability:**
Trailing separators such as `?` are removed in several places, but are not accounted for in query string regexes, allowing bypass of the `@fs` access denial.

**Weaknesses/vulnerabilities present:**
- Improper input validation
- Insecure direct object reference (potentially, as arbitrary files can be accessed)

**Impact of exploitation:**
The contents of arbitrary files can be returned to the browser. This is only exploitable if the Vite dev server is exposed to the network (using `--host` or `server.host` config option).

**Attack vectors:**
- Network: An attacker can send a crafted request to the Vite dev server with a URL containing `?raw??` or `?import&raw??` appended to a file path.

**Required attacker capabilities/position:**
- Network access to a Vite dev server that is exposed to the network.
- No authentication is required.

**Mitigation or fix:**
The vulnerability is patched in versions >=6.2.3, >=6.1.2, >=6.0.12, >=5.4.15, and >=4.5.10. The fix involves correctly handling trailing query separators in the URL validation logic.

**Additional details:**
The provided content includes commit messages and diffs showing the fix for this vulnerability. The PoC demonstrates how to bypass the security check and retrieve the contents of an arbitrary file.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.732 |
| 2 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.700 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.698 |
| 4 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.697 |
| 5 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.695 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.688 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.684 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.680 |
| 9 | 24 | Path Traversal: '../filedir' | Variant | Allowed | dense | 0.553 |
| 10 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | graph | 0.003 |

