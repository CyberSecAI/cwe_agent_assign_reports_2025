# Vulnerability Information: CVE-2024-5501

## Vulnerability Description
The Supreme Modules Lite - Divi Theme, Extra Theme and Divi Builder plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the button_one_id parameter in all versions up to, and including, 2.5.51 due to **insufficient input sanitization and output escaping**. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping**
- **weakness:** **cross-site scripting**
- **impact:** inject arbitrary web scripts
- **vector:** button_one_id parameter
- **attacker:** authenticated attackers with Contributor-level access and above
- **product:** Supreme Modules Lite - Divi Theme, Extra Theme and Divi Builder plugin for WordPress
- **version:** all versions up to and including 2.5.51

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-79

#### Top CWEs
- CWE-79 (Count: 121)

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-5501:

**1. Verification of CVE Relevance:**

*   The provided content directly relates to **CVE-2024-5501**. The Wordfence article explicitly mentions the CVE ID and describes a stored XSS vulnerability in the "Supreme Modules Lite â€“ Divi Theme, Extra Theme and Divi Builder" plugin, aligning with the referenced Trac changeset which addresses an XSS issue in the `button_one_id` and `button_two_id` fields of the Buttons module.

**2. Vulnerability Details:**

*   **Root Cause:** Insufficient input sanitization and output escaping of user-controlled data, specifically in the `button_one_id` and `button_two_id` parameters of the "Supreme Button" module.
*   **Weaknesses/Vulnerabilities:**
    *   Stored Cross-Site Scripting (XSS): The plugin fails to properly sanitize and escape user-supplied input when rendering HTML attributes, allowing malicious scripts to be stored in the database and executed in the context of other users.
*   **Impact of Exploitation:**
    *   Authenticated attackers with Contributor-level access or higher can inject arbitrary web scripts.
    *   The injected scripts will execute when other users access the affected pages.
    *   This can lead to various attacks, including:
        *   Stealing user sessions/cookies.
        *   Redirecting users to malicious websites.
        *   Defacing websites.
        *   Performing actions on behalf of a user (if the user is logged in).
*   **Attack Vectors:**
    *   The vulnerability can be exploited via the WordPress admin interface.
    *   Attackers must have at least Contributor-level privileges, meaning they need to be logged into the WordPress website.
    *   The injected scripts are stored in the database and triggered when a user views a page with the vulnerable buttons.
*   **Required Attacker Capabilities/Position:**
    *   An attacker must have a WordPress user account with at least Contributor-level access.
    *   The attacker needs to have the ability to edit a page or post that uses the vulnerable "Supreme Button" module.

**3. Additional Information:**

*   The provided changeset (`3095671`) confirms the fix by including sanitization and escaping of the `button_one_id` and `button_two_id` attributes.
*   The Wordfence article highlights that the vulnerability affects all versions of the plugin up to and including 2.5.51 and is fixed in 2.5.52.

**Summary**
CVE-2024-5501 is a medium-severity stored XSS vulnerability in the "Supreme Modules Lite" plugin that arises from a lack of sanitization in the `button_one_id` and `button_two_id` fields. An attacker needs at least Contributor level permissions to inject malicious scripts via the admin panel, which then execute for other users viewing affected pages. The vulnerability is patched in version 2.5.52.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.523 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.516 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.488 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.459 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.410 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.400 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.399 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.398 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.548 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

