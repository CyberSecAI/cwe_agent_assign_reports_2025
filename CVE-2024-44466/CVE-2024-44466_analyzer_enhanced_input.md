## Vulnerability Description
COMFAST CF-XR11 V2.7.2 has a **command injection** vulnerability in function sub_424CB4. Attackers can send POST request messages to /usr/bin/webmgnt and inject commands into parameter iface.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **attacker:** attackers
- **product:** COMFAST CF-XR11
- **version:** V2.7.2
- **component:** function sub_424CB4

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-44466.

**Root cause of vulnerability:**
The root cause is a command injection vulnerability in the `sub_424CB4` function of the `/usr/bin/webmgnt` binary. The program takes the user-controlled `iface` parameter from a POST request and uses it to construct a `sed` command without proper sanitization.

**Weaknesses/vulnerabilities present:**
- Command Injection: The program directly uses user-supplied input within a shell command without sanitization, allowing the injection of arbitrary shell commands. The `iface` parameter is injected into the first `%s` of the `sed -i '/%s/d' %s 2>/dev/null` command.

**Impact of exploitation:**
- Arbitrary Command Execution: An attacker can execute arbitrary commands on the system with the privileges of the web server, which can lead to a compromise of the device. In the given demo, the attacker is able to execute the `ls` command.

**Attack vectors:**
- HTTP POST request: An attacker sends a POST request to `/cgi-bin/mbox-config?method=SET&section=timing_redial` including a malicious `iface` parameter. The content of this parameter is then used to construct a command within the affected binary.

**Required attacker capabilities/position:**
- Network access: The attacker must be able to send HTTP POST requests to the vulnerable device. This typically requires being on the same network as the device or having access to the device's web interface over the internet.

**Additional Information:**
The provided content gives the vulnerable firmware version `V2.7.2` and a link to download it. It also describes the specific function, `sub_424CB4` where the vulnerability exists and includes a Proof of Concept (POC) and a demonstration of the command injection, which is more detailed than the typical CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.173 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.155 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.155 |
| 6 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.154 |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.151 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.150 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.592 |
| 10 | 456 | Missing Initialization of a Variable | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-790: Improper Filtering of Special Elements

CWE-456: Missing Initialization of a Variable