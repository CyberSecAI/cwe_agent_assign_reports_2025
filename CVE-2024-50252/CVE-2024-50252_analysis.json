{
  "cve_id": "CVE-2024-50252",
  "description": "In the Linux kernel, the following vulnerability has been resolved mlxsw spectrum_ipip Fix **memory leak** when changing remote IPv6 address The device stores IPv6 addresses that are used for encapsulation in linear memory that is managed by the driver. Changing the remote address of an ip6gre net device never worked properly, but since cited commit the following reproducer [1] would result in a warning [2] and a **memory leak** [3]. The problem is that the new remote address is never added by the driver to its hash table (and therefore the device) and the old address is never removed from it. Fix by programming the new address when the configuration of the ip6gre net device changes and removing the old one. If the address did not change, then the above would result in increasing the reference count of the address and then decreasing it. [1] # ip link add name bla up type ip6gre local 2001db811 remote 2001db821 tos inherit ttl inherit # ip link set dev bla type ip6gre remote 2001db831 # ip link del dev bla # devlink dev reload pci/00000100.0 [2] WARNING CPU 0 PID 1682 at drivers/net/ethernet/mellanox/mlxsw/spectrum.c3002 mlxsw_sp_ipv6_addr_put+0x140/0x1d0 Modules linked in CPU 0 UID 0 PID 1682 Comm ip Not tainted 6.12.0-rc3-custom-g86b5b55bc835 #151 Hardware name Nvidia SN5600/VMOD0013, BIOS 5.13 05/31/2023 RIP 0010mlxsw_sp_ipv6_addr_put+0x140/0x1d0 [...] Call Trace mlxsw_sp_router_netdevice_event+0x55f/0x1240 notifier_call_chain+0x5a/0xd0 call_netdevice_notifiers_info+0x39/0x90 unregister_netdevice_many_notify+0x63e/0x9d0 rtnl_dellink+0x16b/0x3a0 rtnetlink_rcv_msg+0x142/0x3f0 netlink_rcv_skb+0x50/0x100 netlink_unicast+0x242/0x390 netlink_sendmsg+0x1de/0x420 ____sys_sendmsg+0x2bd/0x320 ___sys_sendmsg+0x9a/0xe0 __sys_sendmsg+0x7a/0xd0 do_syscall_64+0x9e/0x1a0 entry_SYSCALL_64_after_hwframe+0x77/0x7f [3] unreferenced object 0xffff898081f597a0 (size 32) comm ip, pid 1626, jiffies 4294719324 hex dump (first 32 bytes) 20 01 0d b8 00 02 00 00 00 00 00 00 00 00 00 01 ............... 21 49 61 83 80 89 ff ff 00 00 00 00 01 00 00 00 !Ia............. backtrace (crc fd9be911) [] __kmalloc_cache_noprof+0x1da/0x260 [] mlxsw_sp_ipv6_addr_kvdl_index_get+0x281/0x340 [] mlxsw_sp_router_netdevice_event+0x47b/0x1240 [] notifier_call_chain+0x5a/0xd0 [] call_netdevice_notifiers_info+0x39/0x90 [] register_netdevice+0x5f7/0x7a0 [] ip6gre_newlink_common.isra.0+0x65/0x130 [] ip6gre_newlink+0x72/0x120 [] rtnl_newlink+0x471/0xa20 [] rtnetlink_rcv_msg+0x142/0x3f0 [] netlink_rcv_skb+0x50/0x100 [] netlink_unicast+0x242/0x390 [] netlink_sendmsg+0x1de/0x420 [] ____sys_sendmsg+0x2bd/0x320 [] ___sys_sendmsg+0x9a/0xe0 [] __sys_sendmsg+0x7a/0xd0",
  "key_phrases": {
    "rootcause": [
      "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
      "and the new address is not added",
      "leading to a memory leak."
    ],
    "weakness": [
      "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
      "memory leak"
    ],
    "impact": [
      "Memory leak",
      "which can eventually lead to system instability or denial of service."
    ],
    "vector": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
    "attacker": "A local user with the capability to configure network devices can trigger the vulnerability.",
    "product": "Linux Kernel",
    "version": "6.12.0-rc3 and potentially earlier versions",
    "component": "mlxsw spectrum driver"
  },
  "reference_content": "The content relates to CVE-2024-50252.\n\n**Root cause of vulnerability:** The Mellanox mlxsw driver fails to properly manage IPv6 addresses used for IP-in-IP encapsulation. When changing the remote IPv6 address of an ip6gre network device, the driver does not remove the old address from its hash table or add the new address.\n\n**Weaknesses/vulnerabilities present:** A memory leak occurs because the old IPv6 address is not released when a new one is configured. Additionally, the new address isn't correctly added to the hash table, which could lead to incorrect routing or encapsulation.\n\n**Impact of exploitation:** The memory leak can lead to resource exhaustion over time. Also, incorrect address mapping due to the failure to update the hash table could lead to unpredictable network behavior.\n\n**Attack vectors:** The vulnerability can be triggered by modifying the remote IPv6 address of an ip6gre network device via the `ip link` command.\n\n**Required attacker capabilities/position:** An attacker needs the ability to configure network devices to exploit the vulnerability. This typically requires root or administrator privileges on the system.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-401 | Missing Release of Memory after Effective Lifetime | 0.9 | Base | Primary | Allowed |\n| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-401: Missing Release of Memory after Effective Lifetime**, which directly relates to the reported **memory leak**. **CWE-770: Allocation of Resources Without Limits or Throttling** is also relevant because the **driver allocates memory for IPv6 addresses without properly managing their release**, which can lead to excessive resource consumption.\n**CWE-401** is a child of **CWE-664: Improper Control of a Resource Through its Lifetime**, indicating a more specific case of resource management failure. **CWE-770** is a child of **CWE-400: Uncontrolled Resource Consumption**. This parent-child structure guides the selection towards the more descriptive base-level CWEs.\n\n```mermaid\ngraph TD\n    cwe401[\"CWE-401: Missing Release of Memory after Effective Lifetime\"]\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe664[\"CWE-664: Improper Control of a Resource Through its Lifetime\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe401 -->|CHILDOF| cwe664\n    cwe770 -->|CHILDOF| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe401 primary\n    class cwe770 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper management of IPv6 addresses** when the remote address of an ip6gre net device is changed. The old address is not removed from the hash table, and the new address is not added, which leads to a **memory leak**. This **memory leak** is a direct result of failing to release the **allocated memory**, and eventually, this can cause system instability or a denial of service.\n\n## Summary of Analysis\nThe primary weakness is the **failure to release memory**, which directly corresponds to **CWE-401**. The analysis considered the **allocation of resources without limits or throttling (CWE-770)**. The retriever identified several potential CWEs, but the memory leak and resource management context made **CWE-401** and **CWE-770** the most fitting.\nThe relationships between CWEs guided the selection toward base-level weaknesses that are more descriptive. The evidence clearly points to a **memory leak** due to the failure to release **allocated memory**, justifying the selection of **CWE-401** as the primary CWE. The allocation of resources without proper limits contributed to the **memory leak**, so **CWE-770** is a secondary CWE.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-696: Incorrect Behavior Order\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-755: Improper Handling of Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product does not handle or incorrectly handles an exceptional condition.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-824: Access of Uninitialized Pointer\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product accesses or uses a pointer that has not been initialized.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the specified index/position/offset has the required properties.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-667: Improper Locking\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n## CWE-754: Improper Check for Unusual or Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-770: Allocation of Resources Without Limits or Throttling\n**Abstraction Level**: Base\n**Similarity Score**: 5040.60\n**Source**: sparse\n\n**Description**:\nThe product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-294: Authentication Bypass by Capture-replay\n**Abstraction Level**: Base\n**Similarity Score**: 492",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-401 | Missing Release of Memory after Effective Lifetime | 0.9 | Base | Primary | Allowed |\n| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-401: Missing Release of Memory after Effective Lifetime**, which directly relates to the reported **memory leak**. **CWE-770: Allocation of Resources Without Limits or Throttling** is also relevant because the **driver allocates memory for IPv6 addresses without properly managing their release**, which can lead to excessive resource consumption.\n**CWE-401** is a child of **CWE-664: Improper Control of a Resource Through its Lifetime**, indicating a more specific case of resource management failure. **CWE-770** is a child of **CWE-400: Uncontrolled Resource Consumption**. This parent-child structure guides the selection towards the more descriptive base-level CWEs.\n\n```mermaid\ngraph TD\n    cwe401[\"CWE-401: Missing Release of Memory after Effective Lifetime\"]\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe664[\"CWE-664: Improper Control of a Resource Through its Lifetime\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe401 -->|CHILDOF| cwe664\n    cwe770 -->|CHILDOF| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe401 primary\n    class cwe770 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper management of IPv6 addresses** when the remote address of an ip6gre net device is changed. The old address is not removed from the hash table, and the new address is not added, which leads to a **memory leak**. This **memory leak** is a direct result of failing to release the **allocated memory**, and eventually, this can cause system instability or a denial of service.\n\n## Summary of Analysis\nThe primary weakness is the **failure to release memory**, which directly corresponds to **CWE-401**. The analysis considered the **allocation of resources without limits or throttling (CWE-770)**. The retriever identified several potential CWEs, but the memory leak and resource management context made **CWE-401** and **CWE-770** the most fitting.\nThe relationships between CWEs guided the selection toward base-level weaknesses that are more descriptive. The evidence clearly points to a **memory leak** due to the failure to release **allocated memory**, justifying the selection of **CWE-401** as the primary CWE. The allocation of resources without proper limits contributed to the **memory leak**, so **CWE-770** is a secondary CWE.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-696: Incorrect Behavior Order\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-755: Improper Handling of Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product does not handle or incorrectly handles an exceptional condition.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-824: Access of Uninitialized Pointer\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product accesses or uses a pointer that has not been initialized.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the specified index/position/offset has the required properties.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-667: Improper Locking\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n## CWE-754: Improper Check for Unusual or Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-770: Allocation of Resources Without Limits or Throttling\n**Abstraction Level**: Base\n**Similarity Score**: 5040.60\n**Source**: sparse\n\n**Description**:\nThe product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-294: Authentication Bypass by Capture-replay\n**Abstraction Level**: Base\n**Similarity Score**: 492\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n**Chain starting from CWE-770:**\n- 770 (Allocation of Resources Without Limits or Throttling) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse",
        "original_content": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.",
        "keyphrase_sources": [
          {
            "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "type": "rootcause"
          },
          {
            "id": "rootcause:and the new address is not added",
            "keyphrase": "and the new address is not added",
            "type": "rootcause"
          },
          {
            "id": "rootcause:leading to a memory leak.",
            "keyphrase": "leading to a memory leak.",
            "type": "rootcause"
          },
          {
            "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "type": "weakness"
          },
          {
            "id": "weakness:memory leak",
            "keyphrase": "memory leak",
            "type": "weakness"
          },
          {
            "id": "impact:Memory leak",
            "keyphrase": "Memory leak",
            "type": "impact"
          },
          {
            "id": "impact:which can eventually lead to system instability or denial of service.",
            "keyphrase": "which can eventually lead to system instability or denial of service.",
            "type": "impact"
          },
          {
            "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "type": "vector"
          },
          {
            "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
            "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
            "type": "attacker"
          },
          {
            "id": "product:Linux Kernel",
            "keyphrase": "Linux Kernel",
            "type": "product"
          },
          {
            "id": "version:6.12.0-rc3 and potentially earlier versions",
            "keyphrase": "6.12.0-rc3 and potentially earlier versions",
            "type": "version"
          },
          {
            "id": "component:mlxsw spectrum driver",
            "keyphrase": "mlxsw spectrum driver",
            "type": "component"
          }
        ]
      },
      "similarity": 1465.149189080097
    },
    {
      "metadata": {
        "doc_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "source": "sparse",
        "original_content": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.",
        "keyphrase_sources": [
          {
            "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "type": "rootcause"
          },
          {
            "id": "rootcause:and the new address is not added",
            "keyphrase": "and the new address is not added",
            "type": "rootcause"
          },
          {
            "id": "rootcause:leading to a memory leak.",
            "keyphrase": "leading to a memory leak.",
            "type": "rootcause"
          },
          {
            "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "type": "weakness"
          },
          {
            "id": "weakness:memory leak",
            "keyphrase": "memory leak",
            "type": "weakness"
          },
          {
            "id": "impact:Memory leak",
            "keyphrase": "Memory leak",
            "type": "impact"
          },
          {
            "id": "impact:which can eventually lead to system instability or denial of service.",
            "keyphrase": "which can eventually lead to system instability or denial of service.",
            "type": "impact"
          },
          {
            "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "type": "vector"
          },
          {
            "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
            "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
            "type": "attacker"
          },
          {
            "id": "product:Linux Kernel",
            "keyphrase": "Linux Kernel",
            "type": "product"
          },
          {
            "id": "version:6.12.0-rc3 and potentially earlier versions",
            "keyphrase": "6.12.0-rc3 and potentially earlier versions",
            "type": "version"
          },
          {
            "id": "component:mlxsw spectrum driver",
            "keyphrase": "mlxsw spectrum driver",
            "type": "component"
          }
        ]
      },
      "similarity": 1447.166203786203
    },
    {
      "metadata": {
        "doc_id": "294",
        "name": "Authentication Bypass by Capture-replay",
        "source": "sparse",
        "original_content": "A capture-replay flaw exists when the design of the product makes it possible for a malicious user to sniff network traffic and bypass authentication by replaying it to the server in question to the same effect as the original message (or with minor changes).",
        "keyphrase_sources": [
          {
            "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "type": "rootcause"
          },
          {
            "id": "rootcause:and the new address is not added",
            "keyphrase": "and the new address is not added",
            "type": "rootcause"
          },
          {
            "id": "rootcause:leading to a memory leak.",
            "keyphrase": "leading to a memory leak.",
            "type": "rootcause"
          },
          {
            "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "type": "weakness"
          },
          {
            "id": "weakness:memory leak",
            "keyphrase": "memory leak",
            "type": "weakness"
          },
          {
            "id": "impact:Memory leak",
            "keyphrase": "Memory leak",
            "type": "impact"
          },
          {
            "id": "impact:which can eventually lead to system instability or denial of service.",
            "keyphrase": "which can eventually lead to system instability or denial of service.",
            "type": "impact"
          },
          {
            "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "type": "vector"
          },
          {
            "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
            "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
            "type": "attacker"
          },
          {
            "id": "product:Linux Kernel",
            "keyphrase": "Linux Kernel",
            "type": "product"
          },
          {
            "id": "version:6.12.0-rc3 and potentially earlier versions",
            "keyphrase": "6.12.0-rc3 and potentially earlier versions",
            "type": "version"
          },
          {
            "id": "component:mlxsw spectrum driver",
            "keyphrase": "mlxsw spectrum driver",
            "type": "component"
          }
        ]
      },
      "similarity": 1401.807880104773
    },
    {
      "metadata": {
        "doc_id": "657",
        "name": "Violation of Secure Design Principles",
        "source": "sparse",
        "original_content": "The product violates well-established principles for secure design.",
        "keyphrase_sources": [
          {
            "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "type": "rootcause"
          },
          {
            "id": "rootcause:and the new address is not added",
            "keyphrase": "and the new address is not added",
            "type": "rootcause"
          },
          {
            "id": "rootcause:leading to a memory leak.",
            "keyphrase": "leading to a memory leak.",
            "type": "rootcause"
          },
          {
            "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "type": "weakness"
          },
          {
            "id": "weakness:memory leak",
            "keyphrase": "memory leak",
            "type": "weakness"
          },
          {
            "id": "impact:Memory leak",
            "keyphrase": "Memory leak",
            "type": "impact"
          },
          {
            "id": "impact:which can eventually lead to system instability or denial of service.",
            "keyphrase": "which can eventually lead to system instability or denial of service.",
            "type": "impact"
          },
          {
            "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "type": "vector"
          },
          {
            "id": "product:Linux Kernel",
            "keyphrase": "Linux Kernel",
            "type": "product"
          },
          {
            "id": "version:6.12.0-rc3 and potentially earlier versions",
            "keyphrase": "6.12.0-rc3 and potentially earlier versions",
            "type": "version"
          },
          {
            "id": "component:mlxsw spectrum driver",
            "keyphrase": "mlxsw spectrum driver",
            "type": "component"
          }
        ]
      },
      "similarity": 1384.2685133267362
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse",
        "original_content": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
        "keyphrase_sources": [
          {
            "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
            "type": "rootcause"
          },
          {
            "id": "rootcause:and the new address is not added",
            "keyphrase": "and the new address is not added",
            "type": "rootcause"
          },
          {
            "id": "impact:which can eventually lead to system instability or denial of service.",
            "keyphrase": "which can eventually lead to system instability or denial of service.",
            "type": "impact"
          }
        ]
      },
      "similarity": 1383.5249220977894
    },
    {
      "metadata": {
        "doc_id": "125",
        "name": "Out-of-bounds Read",
        "source": "sparse",
        "original_content": "The product reads data past the end, or before the beginning, of the intended buffer.",
        "keyphrase_sources": [
          {
            "id": "rootcause:leading to a memory leak.",
            "keyphrase": "leading to a memory leak.",
            "type": "rootcause"
          },
          {
            "id": "weakness:memory leak",
            "keyphrase": "memory leak",
            "type": "weakness"
          },
          {
            "id": "impact:Memory leak",
            "keyphrase": "Memory leak",
            "type": "impact"
          }
        ]
      },
      "similarity": 1145.4213461181407
    },
    {
      "metadata": {
        "doc_id": "20",
        "name": "Improper Input Validation",
        "source": "sparse",
        "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
        "keyphrase_sources": [
          {
            "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
            "type": "weakness"
          },
          {
            "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
            "type": "vector"
          },
          {
            "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
            "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
            "type": "attacker"
          }
        ]
      },
      "similarity": 1101.042995748169
    },
    {
      "metadata": {
        "doc_id": "288",
        "name": "Authentication Bypass Using an Alternate Path or Channel",
        "source": "sparse",
        "original_content": "The product requires authentication, but the product has an alternate path or channel that does not require authentication.",
        "keyphrase_sources": [
          {
            "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
            "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
            "type": "attacker"
          },
          {
            "id": "version:6.12.0-rc3 and potentially earlier versions",
            "keyphrase": "6.12.0-rc3 and potentially earlier versions",
            "type": "version"
          }
        ]
      },
      "similarity": 411.2408090114659
    },
    {
      "metadata": {
        "doc_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "source": "sparse",
        "original_content": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.",
        "keyphrase_sources": [
          {
            "id": "product:Linux Kernel",
            "keyphrase": "Linux Kernel",
            "type": "product"
          },
          {
            "id": "component:mlxsw spectrum driver",
            "keyphrase": "mlxsw spectrum driver",
            "type": "component"
          }
        ]
      },
      "similarity": 364.2846449006006
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-400",
      "CWE-770",
      "CWE-667",
      "CWE-401",
      "CWE-1285",
      "CWE-696",
      "CWE-824",
      "CWE-668",
      "CWE-755",
      "CWE-1391",
      "CWE-664",
      "CWE-303",
      "CWE-294",
      "CWE-497",
      "CWE-754"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {
    "306": [
      {
        "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "type": "rootcause"
      },
      {
        "id": "rootcause:and the new address is not added",
        "keyphrase": "and the new address is not added",
        "type": "rootcause"
      },
      {
        "id": "rootcause:leading to a memory leak.",
        "keyphrase": "leading to a memory leak.",
        "type": "rootcause"
      },
      {
        "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "type": "weakness"
      },
      {
        "id": "weakness:memory leak",
        "keyphrase": "memory leak",
        "type": "weakness"
      },
      {
        "id": "impact:Memory leak",
        "keyphrase": "Memory leak",
        "type": "impact"
      },
      {
        "id": "impact:which can eventually lead to system instability or denial of service.",
        "keyphrase": "which can eventually lead to system instability or denial of service.",
        "type": "impact"
      },
      {
        "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "type": "vector"
      },
      {
        "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
        "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
        "type": "attacker"
      },
      {
        "id": "product:Linux Kernel",
        "keyphrase": "Linux Kernel",
        "type": "product"
      },
      {
        "id": "version:6.12.0-rc3 and potentially earlier versions",
        "keyphrase": "6.12.0-rc3 and potentially earlier versions",
        "type": "version"
      },
      {
        "id": "component:mlxsw spectrum driver",
        "keyphrase": "mlxsw spectrum driver",
        "type": "component"
      }
    ],
    "400": [
      {
        "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "type": "rootcause"
      },
      {
        "id": "rootcause:and the new address is not added",
        "keyphrase": "and the new address is not added",
        "type": "rootcause"
      },
      {
        "id": "rootcause:leading to a memory leak.",
        "keyphrase": "leading to a memory leak.",
        "type": "rootcause"
      },
      {
        "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "type": "weakness"
      },
      {
        "id": "weakness:memory leak",
        "keyphrase": "memory leak",
        "type": "weakness"
      },
      {
        "id": "impact:Memory leak",
        "keyphrase": "Memory leak",
        "type": "impact"
      },
      {
        "id": "impact:which can eventually lead to system instability or denial of service.",
        "keyphrase": "which can eventually lead to system instability or denial of service.",
        "type": "impact"
      },
      {
        "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "type": "vector"
      },
      {
        "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
        "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
        "type": "attacker"
      },
      {
        "id": "product:Linux Kernel",
        "keyphrase": "Linux Kernel",
        "type": "product"
      },
      {
        "id": "version:6.12.0-rc3 and potentially earlier versions",
        "keyphrase": "6.12.0-rc3 and potentially earlier versions",
        "type": "version"
      },
      {
        "id": "component:mlxsw spectrum driver",
        "keyphrase": "mlxsw spectrum driver",
        "type": "component"
      }
    ],
    "294": [
      {
        "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "type": "rootcause"
      },
      {
        "id": "rootcause:and the new address is not added",
        "keyphrase": "and the new address is not added",
        "type": "rootcause"
      },
      {
        "id": "rootcause:leading to a memory leak.",
        "keyphrase": "leading to a memory leak.",
        "type": "rootcause"
      },
      {
        "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "type": "weakness"
      },
      {
        "id": "weakness:memory leak",
        "keyphrase": "memory leak",
        "type": "weakness"
      },
      {
        "id": "impact:Memory leak",
        "keyphrase": "Memory leak",
        "type": "impact"
      },
      {
        "id": "impact:which can eventually lead to system instability or denial of service.",
        "keyphrase": "which can eventually lead to system instability or denial of service.",
        "type": "impact"
      },
      {
        "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "type": "vector"
      },
      {
        "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
        "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
        "type": "attacker"
      },
      {
        "id": "product:Linux Kernel",
        "keyphrase": "Linux Kernel",
        "type": "product"
      },
      {
        "id": "version:6.12.0-rc3 and potentially earlier versions",
        "keyphrase": "6.12.0-rc3 and potentially earlier versions",
        "type": "version"
      },
      {
        "id": "component:mlxsw spectrum driver",
        "keyphrase": "mlxsw spectrum driver",
        "type": "component"
      }
    ],
    "657": [
      {
        "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "type": "rootcause"
      },
      {
        "id": "rootcause:and the new address is not added",
        "keyphrase": "and the new address is not added",
        "type": "rootcause"
      },
      {
        "id": "rootcause:leading to a memory leak.",
        "keyphrase": "leading to a memory leak.",
        "type": "rootcause"
      },
      {
        "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "type": "weakness"
      },
      {
        "id": "weakness:memory leak",
        "keyphrase": "memory leak",
        "type": "weakness"
      },
      {
        "id": "impact:Memory leak",
        "keyphrase": "Memory leak",
        "type": "impact"
      },
      {
        "id": "impact:which can eventually lead to system instability or denial of service.",
        "keyphrase": "which can eventually lead to system instability or denial of service.",
        "type": "impact"
      },
      {
        "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "type": "vector"
      },
      {
        "id": "product:Linux Kernel",
        "keyphrase": "Linux Kernel",
        "type": "product"
      },
      {
        "id": "version:6.12.0-rc3 and potentially earlier versions",
        "keyphrase": "6.12.0-rc3 and potentially earlier versions",
        "type": "version"
      },
      {
        "id": "component:mlxsw spectrum driver",
        "keyphrase": "mlxsw spectrum driver",
        "type": "component"
      }
    ],
    "770": [
      {
        "id": "rootcause:The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "keyphrase": "The driver does not correctly manage IPv6 addresses used for encapsulation when changing the remote address of an ip6gre net device. The old address is not removed from the hash table",
        "type": "rootcause"
      },
      {
        "id": "rootcause:and the new address is not added",
        "keyphrase": "and the new address is not added",
        "type": "rootcause"
      },
      {
        "id": "impact:which can eventually lead to system instability or denial of service.",
        "keyphrase": "which can eventually lead to system instability or denial of service.",
        "type": "impact"
      }
    ],
    "125": [
      {
        "id": "rootcause:leading to a memory leak.",
        "keyphrase": "leading to a memory leak.",
        "type": "rootcause"
      },
      {
        "id": "weakness:memory leak",
        "keyphrase": "memory leak",
        "type": "weakness"
      },
      {
        "id": "impact:Memory leak",
        "keyphrase": "Memory leak",
        "type": "impact"
      }
    ],
    "20": [
      {
        "id": "weakness:Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "keyphrase": "Improper management of dynamically allocated memory for IPv6 addresses during network device configuration changes.",
        "type": "weakness"
      },
      {
        "id": "vector:Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "keyphrase": "Changing the remote IPv6 address of an ip6gre network device through the ip link command.",
        "type": "vector"
      },
      {
        "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
        "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
        "type": "attacker"
      }
    ],
    "288": [
      {
        "id": "attacker:A local user with the capability to configure network devices can trigger the vulnerability.",
        "keyphrase": "A local user with the capability to configure network devices can trigger the vulnerability.",
        "type": "attacker"
      },
      {
        "id": "version:6.12.0-rc3 and potentially earlier versions",
        "keyphrase": "6.12.0-rc3 and potentially earlier versions",
        "type": "version"
      }
    ],
    "732": [
      {
        "id": "product:Linux Kernel",
        "keyphrase": "Linux Kernel",
        "type": "product"
      },
      {
        "id": "component:mlxsw spectrum driver",
        "keyphrase": "mlxsw spectrum driver",
        "type": "component"
      }
    ]
  }
}