## Vulnerability Description
TopQuadrant TopBraid EDG stores external credentials insecurely. An authenticated attacker with file system access can read edg-setup.properites and obtain the secret to decrypt external passwords stored in edg-vault.properties. An authenticated attacker could gain file system access using a separate vulnerability such as CVE-2024-45745. At least version 7.1.3 is affected. Version 7.3 adds HashiCorp Vault integration that does not store external passwords locally.

### Vulnerability Description Key Phrases
- **rootcause:** **insecure storage of external credentials**
- **impact:** obtain the secret to decrypt external passwords
- **vector:** read edg-setup.properties
- **attacker:** authenticated attacker with file system access
- **product:** TopQuadrant TopBraid EDG
- **version:** at least 7.1.3

## CVE Reference Links Content Summary
Based on the provided documents, here's a breakdown of the vulnerability information related to CVE-2024-45744:

**Root Cause of Vulnerability:**
- TopQuadrant TopBraid EDG stores credentials for external services (like databases or other EDG instances) insecurely. Specifically, it stores the secret used to encrypt these external passwords in a file called `edg-setup.properties`. This file can be accessed by an authenticated attacker with file system access.

**Weaknesses/Vulnerabilities Present:**
- **CWE-257: Storing Passwords in a Recoverable Format:** The primary vulnerability is that the password encryption key is stored in plaintext.
- **Insecure Credential Storage:** External service credentials are encrypted but the key to decrypt them is stored in a way that is easily retrievable if an attacker gains filesystem access.

**Impact of Exploitation:**
- **Exposure of External Service Credentials:** An attacker who gains access to the `edg-setup.properties` file can decrypt the stored passwords. This allows them to gain access to other systems that EDG connects to like databases or external SPARQL endpoints.
- **Privilege Escalation:** While the vulnerability itself doesn't provide privilege escalation, it provides the means to potentially access other services that might have higher privileges.

**Attack Vectors:**
- **File System Access:** An attacker needs access to the filesystem of the server running TopBraid EDG.
- **Authentication:** The attacker must be an authenticated user of EDG, and possibly leverage a different vulnerability to obtain filesystem access (like CVE-2024-45745).

**Required Attacker Capabilities/Position:**
- **Authenticated Access:** The attacker must have valid credentials to log in to TopBraid EDG.
- **File System Access:** The attacker needs the ability to read files on the server where TopBraid EDG is deployed, specifically `edg-setup.properties` and `edg-vault.properties`.

**Additional Notes:**
- The vulnerable versions include at least version 7.1.3 and all versions before 8.0.1 that do not have Hashicorp vault integration
- TopBraid EDG 7.3 introduces Hashicorp Vault integration, which provides secure storage and management of credentials. Using Hashicorp Vault is the recommended mitigation.
-  The `edg-setup.properties` file contains the secret that allows decryption of the stored passwords located in `edg-vault.properties`.

**Mitigation:**
- Upgrade to TopQuadrant TopBraid EDG 8.0.1 and use the Hashicorp Vault integration.
- For versions 7.3 and later, enable the Hashicorp Vault integration, which stores credentials securely.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.392 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.389 |
| 3 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.381 |
| 4 | 549 | Missing Password Field Masking | Base | Allowed | sparse | 0.380 |
| 5 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | sparse | 0.365 |
| 6 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.361 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.354 |
| 8 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.351 |
| 9 | 922 | Insecure Storage of Sensitive Information | Class | Allowed-with-Review | dense | 0.552 |
| 10 | 257 | Storing Passwords in a Recoverable Format | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-522: Insufficiently Protected Credentials

CWE-532: Insertion of Sensitive Information into Log File

CWE-256: Plaintext Storage of a Password

CWE-549: Missing Password Field Masking

CWE-312: Cleartext Storage of Sensitive Information

CWE-321: Use of Hard-coded Cryptographic Key

CWE-306: Missing Authentication for Critical Function

CWE-259: Use of Hard-coded Password

CWE-922: Insecure Storage of Sensitive Information

CWE-257: Storing Passwords in a Recoverable Format