{
  "query": "In the Linux kernel, the following vulnerability has been resolved ext4 fix access to uninitialised lock in fc replay path The following kernel trace can be triggered with fstest generic/629 when executed against a filesystem with fast-commit feature enabled INFO trying to register non-static key. The code is fine but needs lockdep annotation, or maybe you didnt initialize this object before use? turning off the locking correctness validator. CPU 0 PID 866 Comm mount Not tainted 6.10.0+ #11 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.2-3-gd478f380-prebuilt.qemu.org 04/01/2014 Call Trace dump_stack_lvl+0x66/0x90 register_lock_class+0x759/0x7d0 __lock_acquire+0x85/0x2630 ? __find_get_block+0xb4/0x380 lock_acquire+0xd1/0x2d0 ? __ext4_journal_get_write_access+0xd5/0x160 _raw_spin_lock+0x33/0x40 ? __ext4_journal_get_write_access+0xd5/0x160 __ext4_journal_get_write_access+0xd5/0x160 ext4_reserve_inode_write+0x61/0xb0 __ext4_mark_inode_dirty+0x79/0x270 ? ext4_ext_replay_set_iblocks+0x2f8/0x450 ext4_ext_replay_set_iblocks+0x330/0x450 ext4_fc_replay+0x14c8/0x1540 ? jread+0x88/0x2e0 ? rcu_is_watching+0x11/0x40 do_one_pass+0x447/0xd00 jbd2_journal_recover+0x139/0x1b0 jbd2_journal_load+0x96/0x390 ext4_load_and_init_journal+0x253/0xd40 ext4_fill_super+0x2cc6/0x3180 ... In the replay path theres an attempt to lock sbi->s_bdev_wb_lock in function ext4_check_bdev_write_error(). Unfortunately, at this point this spinlock has not been initialized yet. Moving its initialization to an earlier point in __ext4_fill_super() fixes this splat.",
  "count": 20,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 0.5936553031956652,
      "original_score": 0.5936553031956652,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "abstraction": "Class",
      "score": 0.5751068444196434,
      "original_score": 0.5751068444196434,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "abstraction": "Base",
      "score": 0.5711138173568416,
      "original_score": 0.5711138173568416,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 0.565374617679686,
      "original_score": 0.565374617679686,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "score": 0.5510514631225365,
      "original_score": 0.5510514631225365,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "908",
      "name": "Use of Uninitialized Resource",
      "abstraction": "Base",
      "score": 0.544577727682365,
      "original_score": 0.544577727682365,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "abstraction": "Base",
      "score": 0.5441817017267598,
      "original_score": 0.5441817017267598,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1233",
      "name": "Security-Sensitive Hardware Controls with Missing Lock Bit Protection",
      "abstraction": "Base",
      "score": 0.533981712159687,
      "original_score": 0.533981712159687,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "665",
      "name": "Improper Initialization",
      "abstraction": "Class",
      "score": 0.5261548638268341,
      "original_score": 0.5261548638268341,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "1342",
      "name": "Information Exposure through Microarchitectural State after Transient Execution",
      "abstraction": "Base",
      "score": 0.5230989661975729,
      "original_score": 0.5230989661975729,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "832",
      "name": "Unlock of a Resource that is not Locked",
      "abstraction": "Base",
      "score": 0.5066932013351299,
      "original_score": 0.5066932013351299,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "190",
      "name": "Integer Overflow or Wraparound",
      "abstraction": "Base",
      "score": 0.503887377344196,
      "original_score": 0.503887377344196,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1264",
      "name": "Hardware Logic with Insecure De-Synchronization between Control and Data Channels",
      "abstraction": "Base",
      "score": 0.499906018180184,
      "original_score": 0.499906018180184,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1332",
      "name": "Improper Handling of Faults that Lead to Instruction Skips",
      "abstraction": "Base",
      "score": 0.4978466806656733,
      "original_score": 0.4978466806656733,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "abstraction": "Base",
      "score": 0.49690488083916307,
      "original_score": 0.49690488083916307,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 0.49506501206875947,
      "original_score": 0.49506501206875947,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "366",
      "name": "Race Condition within a Thread",
      "abstraction": "Base",
      "score": 0.49493817982915667,
      "original_score": 0.49493817982915667,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "126",
      "name": "Buffer Over-read",
      "abstraction": "Variant",
      "score": 0.49465836531719176,
      "original_score": 0.49465836531719176,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "416",
      "name": "Use After Free",
      "abstraction": "Variant",
      "score": 0.4938128030753365,
      "original_score": 0.4938128030753365,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1274",
      "name": "Improper Access Control for Volatile Memory Containing Boot Code",
      "abstraction": "Base",
      "score": 0.4937558185603324,
      "original_score": 0.4937558185603324,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.4937558185603324,
    "max": 0.5936553031956652,
    "mean": 0.5252882677291357,
    "median": 0.5148960837663514,
    "count": 20
  }
}