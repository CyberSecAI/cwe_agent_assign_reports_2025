# Raw Retriever Results for CVE-2024-50014

# Raw Retriever Results for CVE-2024-50014
## Query
In the Linux kernel, the following vulnerability has been resolved ext4 fix access to uninitialised lock in fc replay path The following kernel trace can be triggered with fstest generic/629 when executed against a filesystem with fast-commit feature enabled INFO trying to register non-static key. The code is fine but needs lockdep annotation, or maybe you didnt initialize this object before use? turning off the locking correctness validator. CPU 0 PID 866 Comm mount Not tainted 6.10.0+ #11 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.2-3-gd478f380-prebuilt.qemu.org 04/01/2014 Call Trace dump_stack_lvl+0x66/0x90 register_lock_class+0x759/0x7d0 __lock_acquire+0x85/0x2630 ? __find_get_block+0xb4/0x380 lock_acquire+0xd1/0x2d0 ? __ext4_journal_get_write_access+0xd5/0x160 _raw_spin_lock+0x33/0x40 ? __ext4_journal_get_write_access+0xd5/0x160 __ext4_journal_get_write_access+0xd5/0x160 ext4_reserve_inode_write+0x61/0xb0 __ext4_mark_inode_dirty+0x79/0x270 ? ext4_ext_replay_set_iblocks+0x2f8/0x450 ext4_ext_replay_set_iblocks+0x330/0x450 ext4_fc_replay+0x14c8/0x1540 ? jread+0x88/0x2e0 ? rcu_is_watching+0x11/0x40 do_one_pass+0x447/0xd00 jbd2_journal_recover+0x139/0x1b0 jbd2_journal_load+0x96/0x390 ext4_load_and_init_journal+0x253/0xd40 ext4_fill_super+0x2cc6/0x3180 ... In the replay path theres an attempt to lock sbi->s_bdev_wb_lock in function ext4_check_bdev_write_error(). Unfortunately, at this point this spinlock has not been initialized yet. Moving its initialization to an earlier point in __ext4_fill_super() fixes this splat.

## Keyphrases
- **rootcause**: 'The spinlock sbi->s_bdev_wb_lock was not initialized before being used in the ext4_check_bdev_write_error() function.'
- **weakness**: 'Use of uninitialized lock.'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4938 | 0.5937 | 0.5253 | 0.5149 | 20 |
| Sparse | 165.2643 | 601.2480 | 522.0523 | 552.1822 | 13 |
| Graph | 1.3010 | 2.8234 | 1.6905 | 1.6796 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 908 | Use of Uninitialized Resource | Base | 2.8234 | Allowed |
| 2 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 1.7692 | Allowed-with-Review |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 5 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 6 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 7 | 413 | Improper Resource Locking | Base | 1.7233 | Allowed |
| 8 | 833 | Deadlock | Base | 1.7116 | Allowed |
| 9 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 10 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 11 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 12 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 13 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 14 | 789 | Memory Allocation with Excessive Size Value | variant | 1.5552 | Allowed |
| 15 | 476 | NULL Pointer Dereference | Base | 1.5391 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 667 | Improper Locking | Class | 0.5937 | 0.5937 | Allowed-with-Review |
| 2 | 909 | Missing Initialization of Resource | Class | 0.5751 | 0.5751 | Allowed-with-Review |
| 3 | 413 | Improper Resource Locking | Base | 0.5711 | 0.5711 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5654 | 0.5654 | Allowed-with-Review |
| 5 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5511 | 0.5511 | Allowed |
| 6 | 908 | Use of Uninitialized Resource | Base | 0.5446 | 0.5446 | Allowed |
| 7 | 833 | Deadlock | Base | 0.5442 | 0.5442 | Allowed |
| 8 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.5340 | 0.5340 | Allowed |
| 9 | 665 | Improper Initialization | Class | 0.5262 | 0.5262 | Discouraged |
| 10 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5231 | 0.5231 | Allowed |
| 11 | 832 | Unlock of a Resource that is not Locked | Base | 0.5067 | 0.5067 | Allowed |
| 12 | 190 | Integer Overflow or Wraparound | Base | 0.5039 | 0.5039 | Allowed |
| 13 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4999 | 0.4999 | Allowed |
| 14 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4978 | 0.4978 | Allowed |
| 15 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4969 | 0.4969 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 601.2480 | 601.2480 | Allowed-with-Review |
| 2 | 909 | Missing Initialization of Resource | 591.5350 | 591.5350 | Allowed-with-Review |
| 3 | 667 | Improper Locking | 587.0935 | 587.0935 | Allowed-with-Review |
| 4 | 833 | Deadlock | 566.6260 | 566.6260 | Allowed |
| 5 | 908 | Use of Uninitialized Resource | 561.2117 | 561.2117 | Allowed |
| 6 | 674 | Uncontrolled Recursion | 555.7529 | 555.7529 | Allowed-with-Review |
| 7 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 552.1822 | 552.1822 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | 551.1668 | 551.1668 | Allowed |
| 9 | 863 | Incorrect Authorization | 550.7543 | 550.7543 | Allowed-with-Review |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 549.2794 | 549.2794 | Allowed |
| 11 | 457 | Use of Uninitialized Variable | 479.0237 | 479.0237 | Allowed |
| 12 | 319 | Cleartext Transmission of Sensitive Information | 475.5417 | 475.5417 | Allowed |
| 13 | 400 | Uncontrolled Resource Consumption | 165.2643 | 165.2643 | Discouraged |
