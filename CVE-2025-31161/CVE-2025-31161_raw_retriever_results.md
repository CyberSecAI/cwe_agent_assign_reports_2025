# Raw Retriever Results for CVE-2025-31161

# Raw Retriever Results for CVE-2025-31161
## Query
CrushFTP 10 before 10.8.4 and 11 before 11.3.1 allows authentication bypass and takeover of the crushadmin account (unless a DMZ proxy instance is used), as exploited in the wild in March and April 2025, aka Unauthenticated HTTP(S) port access. A race condition exists in the AWS4-HMAC (compatible with S3) authorization method of the HTTP component of the FTP server. The server first verifies the existence of the user by performing a call to login_user_pass() with no password requirement. This will authenticate the session through the HMAC verification process and up until the server checks for user verification once more. The vulnerability can be further stabilized, eliminating the need for successfully triggering a race condition, by sending a mangled AWS4-HMAC header. By providing only the username and a following slash (/), the server will successfully find a username, which triggers the successful anypass authentication process, but the server will fail to find the expected SignedHeaders entry, resulting in an index-out-of-bounds error that stops the code from reaching the session cleanup. Together, these issues make it trivial to authenticate as any known or guessable user (e.g., crushadmin), and can lead to a full compromise of the system by obtaining an administrative account.

## Keyphrases
- **rootcause**: 'race condition'
- **weakness**: 'race condition'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5021 | 0.5448 | 0.5239 | 0.5285 | 20 |
| Sparse | 1025.4968 | 1091.4637 | 1055.8081 | 1053.8322 | 10 |
| Graph | 1.6320 | 2.2100 | 1.8445 | 1.7339 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 2 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 3 | 203 | Observable Discrepancy | base | 2.1190 | Allowed |
| 4 | 52 | Path Equivalence: '/multiple/trailing/slash//' | variant | 2.0400 | Allowed |
| 5 | 46 | Path Equivalence: 'filename ' (Trailing Space) | variant | 2.0400 | Allowed |
| 6 | 173 | Improper Handling of Alternate Encoding | variant | 2.0400 | Allowed |
| 7 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 8 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 9 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 10 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 11 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 1.7128 | Allowed |
| 12 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | 1.7101 | Allowed |
| 13 | 294 | Authentication Bypass by Capture-replay | Base | 1.7086 | Allowed |
| 14 | 289 | Authentication Bypass by Alternate Name | Base | 1.7077 | Allowed |
| 15 | 306 | Missing Authentication for Critical Function | Base | 1.7006 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 0.5448 | 0.5448 | Allowed |
| 2 | 291 | Reliance on IP Address for Authentication | Variant | 0.5381 | 0.5381 | Allowed |
| 3 | 294 | Authentication Bypass by Capture-replay | Base | 0.5372 | 0.5372 | Allowed |
| 4 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | 0.5360 | 0.5360 | Allowed |
| 5 | 289 | Authentication Bypass by Alternate Name | Base | 0.5335 | 0.5335 | Allowed |
| 6 | 620 | Unverified Password Change | Base | 0.5332 | 0.5332 | Allowed |
| 7 | 836 | Use of Password Hash Instead of Password for Authentication | Base | 0.5322 | 0.5322 | Allowed |
| 8 | 305 | Authentication Bypass by Primary Weakness | Base | 0.5314 | 0.5314 | Allowed |
| 9 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | 0.5310 | 0.5310 | Allowed |
| 10 | 307 | Improper Restriction of Excessive Authentication Attempts | Base | 0.5309 | 0.5309 | Allowed |
| 11 | 384 | Session Fixation | Compound | 0.5261 | 0.5261 | Allowed |
| 12 | 287 | Improper Authentication | Class | 0.5261 | 0.5261 | Discouraged |
| 13 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.5190 | 0.5190 | Allowed |
| 14 | 306 | Missing Authentication for Critical Function | Base | 0.5157 | 0.5157 | Allowed |
| 15 | 798 | Use of Hard-coded Credentials | Base | 0.5117 | 0.5117 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 306 | Missing Authentication for Critical Function | 1091.4637 | 1091.4637 | Allowed |
| 2 | 287 | Improper Authentication | 1090.7958 | 1090.7958 | Discouraged |
| 3 | 1390 | Weak Authentication | 1061.0344 | 1061.0344 | Allowed-with-Review |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1059.1016 | 1059.1016 | Allowed-with-Review |
| 5 | 203 | Observable Discrepancy | 1055.1845 | 1055.1845 | Allowed |
| 6 | 863 | Incorrect Authorization | 1052.4799 | 1052.4799 | Allowed-with-Review |
| 7 | 347 | Improper Verification of Cryptographic Signature | 1044.7103 | 1044.7103 | Allowed |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | 1044.5547 | 1044.5547 | Allowed |
| 9 | 798 | Use of Hard-coded Credentials | 1033.2597 | 1033.2597 | Allowed |
| 10 | 20 | Improper Input Validation | 1025.4968 | 1025.4968 | Discouraged |
