# Vulnerability Information: CVE-2024-50341

## Vulnerability Description
symfony/security-bundle is a module for the Symphony PHP framework which provides a tight integration of the Security component into the Symfony full-stack framework. The custom `user_checker` defined on a firewall is not called when Login Programmaticaly with the `Securitylogin` method, leading to **unwanted login**. As of versions 6.4.10, 7.0.10 and 7.1.3 the `Securitylogin` method now ensure to call the configured `user_checker`. All users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **custom user_checker not called**
- **weakness:** **unwanted login**
- **product:** Symfony Security Bundle
- **version:** before 6.4.10, 7.0.10 and 7.1.3
- **component:** Securitylogin method

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The `Security::login` method in Symfony did not call the custom `user_checker` defined on a firewall when logging in programmatically, which could lead to unwanted logins.",
  "Weaknesses/vulnerabilities present": "The vulnerability lies in the `Security::login` method not invoking the configured `user_checker`, bypassing important user validation checks.",
  "Impact of exploitation": "An attacker could potentially bypass user authentication checks, leading to unauthorized access if a custom user checker was intended to prevent this. Although the severity is rated as 'Low', it could have security implications depending on the configuration of the custom user checker.",
  "Attack vectors": "The attack vector is network-based.",
  "Required attacker capabilities/position": "The attacker requires low privileges and no user interaction is needed. The attack complexity is considered high, likely requiring knowledge of the system's authentication configuration and the ability to programmatically log in users."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.487 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.484 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.471 |
| 4 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | sparse | 0.469 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.466 |
| 6 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.460 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.457 |
| 8 | 303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | sparse | 0.456 |
| 9 | 286 | Incorrect User Management | Class | Allowed-with-Review | dense | 0.384 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |

