# Raw Retriever Results for CVE-2025-21710

# Raw Retriever Results for CVE-2025-21710
## Query
In the Linux kernel, the following vulnerability has been resolved tcp correct handling of extreme memory squeeze Testing with iperf3 using the pasta protocol splicer has revealed a problem in the way tcp handles window advertising in extreme memory squeeze situations. Under memory pressure, a socket endpoint may temporarily advertise a zero-sized window, but this is not stored as part of the socket data. The reasoning behind this is that it is considered a temporary setting which shouldnt influence any further calculations. However, if we happen to stall at an unfortunate value of the current window size, the algorithm selecting a new value will consistently fail to advertise a non-zero window once we have freed up enough memory. This means that this sides notion of the current window size is different from the one last advertised to the peer, causing the latter to not send any data to resolve the sitution. The problem occurs on the iperf3 server side, and the socket in question is a completely regular socket with the default settings for the fedora40 kernel. We do not use SO_PEEK or SO_RCVBUF on the socket. The following excerpt of a logging session, with own comments added, shows more in detail what is happening // tcp_v4_rcv(->) // tcp_rcv_established(->) [520139222] ==== Activating log @ net/ipv4/tcp_input.c/tcp_data_queue()/5257 ==== [520139222] tcp_data_queue(->) [520139222] DROPPING skb [265600160..265665640], reason SKB_DROP_REASON_PROTO_MEM [rcv_nxt 265600160, rcv_wnd 262144, snt_ack 265469200, win_now 131184] [copied_seq 259909392->260034360 (124968), unread 5565800, qlen 85, ofoq 0] [OFO queue gap 65480, len 0] [520139222] tcp_data_queue(39222] __tcp_transmit_skb(->) [tp->rcv_wup 265469200, tp->rcv_wnd 262144, tp->rcv_nxt 265600160] [520139222] tcp_select_window(->) [520139222] (inet_csk(sk)->icsk_ack.pending & ICSK_ACK_NOMEM) ? --> TRUE [tp->rcv_wup 265469200, tp->rcv_wnd 262144, tp->rcv_nxt 265600160] returning 0 [520139222] tcp_select_window(39222] ADVERTISING WIN 0, ACK_SEQ 265600160 [520139222] [__tcp_transmit_skb(39222] tcp_rcv_established(39222] tcp_v4_rcv(rcv_wnd and tp->rcv_wup accordingly, which means // we unconditionally shrink the window. [520139222] tcp_recvmsg_locked(->) [520139222] __tcp_cleanup_rbuf(->) tp->rcv_wup 265469200, tp->rcv_wnd 262144, tp->rcv_nxt 265600160 [520139222] [new_win = 0, win_now = 131184, 2 * win_now = 262368] [520139222] [new_win >= (2 * win_now) ? --> time_to_ack = 0] [520139222] NOT calling tcp_send_ack() [tp->rcv_wup 265469200, tp->rcv_wnd 262144, tp->rcv_nxt 265600160] [520139222] __tcp_cleanup_rbuf(260040464 (0), unread 5559696, qlen 85, ofoq 0] returning 6104 bytes [520139222] tcp_recvmsg_locked(rcv_wnd. // Meanwhile, the peer thinks the window is zero, and will not send // any more data to trigger an update from the interrupt mode side. [520139222] tcp_recvmsg_locked(->) [520139222] __tcp_cleanup_rbuf(->) tp->rcv_wup 265469200, tp->rcv_wnd 262144, tp->rcv_nxt 265600160 [520139222] [new_win = 262144, win_now = 131184, 2 * win_n ---truncated---

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4522 | 0.5113 | 0.4671 | 0.4662 | 20 |
| Sparse | 403.7059 | 425.9213 | 416.6658 | 417.5392 | 10 |
| Graph | 1.6240 | 2.6784 | 1.8820 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 129 | Improper Validation of Array Index | variant | 2.6784 | Allowed |
| 2 | 290 | Authentication Bypass by Spoofing | base | 2.3296 | Allowed |
| 3 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 4 | 804 | Guessable CAPTCHA | base | 2.2100 | Allowed |
| 5 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 6 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 1.9587 | Allowed |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.9307 | Allowed |
| 8 | 823 | Use of Out-of-range Pointer Offset | base | 1.7680 | Allowed |
| 9 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 10 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 11 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 12 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 13 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 14 | 770 | Allocation of Resources Without Limits or Throttling | Base | 1.6935 | Allowed |
| 15 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5113 | 0.5113 | Allowed |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4864 | 0.4864 | Allowed |
| 3 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4843 | 0.4843 | Allowed |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4782 | 0.4782 | Allowed |
| 5 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4739 | 0.4739 | Allowed |
| 6 | 394 | Unexpected Status Code or Return Value | Base | 0.4722 | 0.4722 | Allowed |
| 7 | 909 | Missing Initialization of Resource | Class | 0.4705 | 0.4705 | Allowed-with-Review |
| 8 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4695 | 0.4695 | Allowed-with-Review |
| 9 | 126 | Buffer Over-read | Variant | 0.4680 | 0.4680 | Allowed |
| 10 | 121 | Stack-based Buffer Overflow | Variant | 0.4675 | 0.4675 | Allowed |
| 11 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4648 | 0.4648 | Allowed |
| 12 | 400 | Uncontrolled Resource Consumption | Class | 0.4596 | 0.4596 | Discouraged |
| 13 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4577 | 0.4577 | Allowed |
| 14 | 122 | Heap-based Buffer Overflow | Variant | 0.4574 | 0.4574 | Allowed |
| 15 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.4559 | 0.4559 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 290 | Authentication Bypass by Spoofing | 425.9213 | 425.9213 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 424.9126 | 424.9126 | Allowed-with-Review |
| 3 | 330 | Use of Insufficiently Random Values | 422.5920 | 422.5920 | Discouraged |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | 421.6161 | 421.6161 | Allowed |
| 5 | 1263 | Improper Physical Access Control | 417.8223 | 417.8223 | Allowed-with-Review |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | 417.2561 | 417.2561 | Allowed |
| 7 | 757 | Selection of Less-Secure Algorithm During Negotiation ('Algorithm Downgrade') | 417.1434 | 417.1434 | Allowed |
| 8 | 125 | Out-of-bounds Read | 410.8830 | 410.8830 | Allowed |
| 9 | 789 | Memory Allocation with Excessive Size Value | 404.8054 | 404.8054 | Allowed |
| 10 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 403.7059 | 403.7059 | Allowed |
