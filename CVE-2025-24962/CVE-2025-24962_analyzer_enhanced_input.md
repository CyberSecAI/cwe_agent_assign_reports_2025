## Vulnerability Description
reNgine is an automated reconnaissance framework for web applications. In affected versions a user can inject commands via the nmap_cmd parameters. This issue has been addressed in commit `c28e5c8d` and is expected in the next versioned release. Users are advised to filter user input and monitor the project for a new release.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **vector:** nmap_cmd parameters
- **product:** reNgine
- **version:** affected versions

## CVE Reference Links Content Summary
```text
- Root cause of vulnerability: The vulnerability is due to command injection through the Scan Engine configuration. Specifically, it allows modification of the 'nmap_cmd' parameter with a malicious payload.
- Weaknesses/vulnerabilities present: Command Injection (CWE-78, CWE-88)
- Impact of exploitation: An attacker can execute commands on the server and gain a shell.
- Attack vectors:
  1.  Login to the REngine.
  2.  Click the Scan Engine.
  3.  Edit any Scan Engine except Osint.
  4.  Modify the Scan Engine by changing the 'nmap_cmd' parameter with a payload. An example payload is provided in the "PoC" section of the original content.
  5.  Add a target and scan using this engine.
- Required attacker capabilities/position:
    -   Access to the REngine.
    -   Ability to edit Scan Engine configurations.
- Mitigation or fix:
    - The commit c28e5c8 provides a fix by implementing input validation. It adds a function `is_valid_nmap_command` to validate the `nmap` command. The validation checks:
        -   If the command starts with `nmap`.
        -   If the command contains dangerous characters such as `;`, `&`, `|`, `>`, `<`, '`', `$`, `(`, `)`, `#`, `\`.
        -   That flags and options starts with `-` or `--`.
        -   If the part of the command contains only alphanumeric chars, `.`, `-`, `/` and `_`.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.286 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.284 |
| 5 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.283 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.283 |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.280 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.278 |
| 9 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | dense | 0.511 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-20: Improper Input Validation

CWE-116: Improper Encoding or Escaping of Output

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-502: Deserialization of Untrusted Data

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-117: Improper Output Neutralization for Logs