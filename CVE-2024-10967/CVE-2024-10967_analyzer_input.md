# Vulnerability Information: CVE-2024-10967

## Vulnerability Description
A vulnerability was found in code-projects E-Health Care System 1.0. It has been classified as critical. Affected is an unknown function of the file /Doctor/delete_user_appointment_request.php. The manipulation of the argument id leads to **sql injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** code-projects E-Health Care System
- **version:** 1
- **component:** /Doctor/delete_user_appointment_request.php

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-89

#### Top CWEs
- CWE-89 (Count: 196)
- CWE-74 (Count: 21)
- CWE-79 (Count: 15)

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause of Vulnerability:**
- Unfiltered user-supplied input (`$_GET['id']`) is directly incorporated into an SQL query in the `delete_user_appointment_request.php` file.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The primary vulnerability is a SQL injection, which arises from the lack of sanitization or parameterized queries. This allows an attacker to manipulate the SQL query by injecting malicious code.

**Impact of Exploitation:**
- **Sensitive Information Disclosure:** An attacker can potentially extract sensitive data from the database. The provided content shows that the attacker was able to retrieve database names (`information_schema`, `bloodbank`, `crud`, etc.). It's likely that any data within these databases could also be accessed.

**Attack Vectors:**
- **HTTP GET Request:** The attack vector is through manipulating the `id` parameter in an HTTP GET request to the vulnerable `delete_user_appointment_request.php` file.

**Required Attacker Capabilities/Position:**
- The attacker doesn't need any authentication or specific privileges, since the file is accessible without authentication, which makes it easy to exploit.
- The attacker needs to be able to send an HTTP GET request to the vulnerable file on the server.

**Additional Notes**
- The `sql.md` file provides more context than the official CVE description placeholder.
- The vulnerability is located in the E-Health Care System.
- The provided content includes a Proof of Concept (POC) using `sqlmap` to show how an attacker can exploit this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.415 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.348 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.344 |
| 5 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.339 |
| 6 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.335 |
| 7 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.330 |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.330 |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | dense | 0.578 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

