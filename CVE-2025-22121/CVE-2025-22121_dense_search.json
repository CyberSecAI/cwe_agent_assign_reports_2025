{
  "retriever": "dense",
  "query": "In the Linux kernel, the following vulnerability has been resolved ext4 fix out-of-bound read in ext4_xattr_inode_dec_ref_all() Theres issue as follows BUG KASAN use-after-free in ext4_xattr_inode_dec_ref_all+0x6ff/0x790 Read of size 4 at addr ffff88807b003000 by task syz-executor.0/15172 CPU 3 PID 15172 Comm syz-executor.0 Call Trace __dump_stack lib/dump_stack.c82 [inline] dump_stack+0xbe/0xfd lib/dump_stack.c123 print_address_description.constprop.0+0x1e/0x280 mm/kasan/report.c400 __kasan_report.cold+0x6c/0x84 mm/kasan/report.c560 kasan_report+0x3a/0x50 mm/kasan/report.c585 ext4_xattr_inode_dec_ref_all+0x6ff/0x790 fs/ext4/xattr.c1137 ext4_xattr_delete_inode+0x4c7/0xda0 fs/ext4/xattr.c2896 ext4_evict_inode+0xb3b/0x1670 fs/ext4/inode.c323 evict+0x39f/0x880 fs/inode.c622 iput_final fs/inode.c1746 [inline] iput fs/inode.c1772 [inline] iput+0x525/0x6c0 fs/inode.c1758 ext4_orphan_cleanup fs/ext4/super.c3298 [inline] ext4_fill_super+0x8c57/0xba40 fs/ext4/super.c5300 mount_bdev+0x355/0x410 fs/super.c1446 legacy_get_tree+0xfe/0x220 fs/fs_context.c611 vfs_get_tree+0x8d/0x2f0 fs/super.c1576 do_new_mount fs/namespace.c2983 [inline] path_mount+0x119a/0x1ad0 fs/namespace.c3316 do_mount+0xfc/0x110 fs/namespace.c3329 __do_sys_mount fs/namespace.c3540 [inline] __se_sys_mount+0x219/0x2e0 fs/namespace.c3514 do_syscall_64+0x33/0x40 arch/x86/entry/common.c46 entry_SYSCALL_64_after_hwframe+0x67/0xd1 Memory state around the buggy address ffff88807b002f00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ffff88807b002f80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >ffff88807b003000 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ^ ffff88807b003080 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ffff88807b003100 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff Above issue happens as ext4_xattr_delete_inode() isnt check xattr is valid if xattr is in inode. To solve above issue call xattr_check_inode() check if xattr if valid in inode. In fact, we can directly verify in ext4_iget_extra_inode(), so that there is no divergent verification.",
  "keyphrases": {
    "weakness": [
      "use-after-free"
    ]
  },
  "timestamp": "2025-07-12 10:03:22",
  "cve_id": "CVE-2025-22121",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "type": "Class",
      "score": 0.5434281042772141
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "type": "Class",
      "score": 0.5410568860047053
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "type": "Class",
      "score": 0.5303846891110277
    },
    {
      "cwe_id": "190",
      "name": "Integer Overflow or Wraparound",
      "type": "Base",
      "score": 0.5260669678198573
    },
    {
      "cwe_id": "416",
      "name": "Use After Free",
      "type": "Variant",
      "score": 0.5253110431462222
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "type": "Base",
      "score": 0.5246753079037552
    },
    {
      "cwe_id": "908",
      "name": "Use of Uninitialized Resource",
      "type": "Base",
      "score": 0.51988371583077
    },
    {
      "cwe_id": "911",
      "name": "Improper Update of Reference Count",
      "type": "Base",
      "score": 0.5158959057750003
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "type": "Base",
      "score": 0.5132732356237761
    },
    {
      "cwe_id": "252",
      "name": "Unchecked Return Value",
      "type": "Base",
      "score": 0.512027920669962
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "type": "Base",
      "score": 0.48732960572364437
    },
    {
      "cwe_id": "191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "type": "Base",
      "score": 0.48355423240875844
    },
    {
      "cwe_id": "131",
      "name": "Incorrect Calculation of Buffer Size",
      "type": "Base",
      "score": 0.48103855653271016
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "type": "Base",
      "score": 0.47985020074299145
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "type": "Base",
      "score": 0.4753349368064526
    },
    {
      "cwe_id": "126",
      "name": "Buffer Over-read",
      "type": "Variant",
      "score": 0.47516826664288137
    },
    {
      "cwe_id": "122",
      "name": "Heap-based Buffer Overflow",
      "type": "Variant",
      "score": 0.47234181627751964
    },
    {
      "cwe_id": "415",
      "name": "Double Free",
      "type": "Variant",
      "score": 0.4707621791264692
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "type": "Class",
      "score": 0.46875678244483365
    },
    {
      "cwe_id": "823",
      "name": "Use of Out-of-range Pointer Offset",
      "type": "Base",
      "score": 0.4655347831183613
    }
  ]
}