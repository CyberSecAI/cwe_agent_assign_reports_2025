## Vulnerability Description
Bitcoin Core before 0.20.0 allows remote attackers to cause a denial of service (infinite loop) via a malformed GETDATA message.

### Vulnerability Description Key Phrases
- **impact:** denial of service and infinite loop
- **vector:** malformed GETDATA message
- **attacker:** remote attackers
- **product:** Bitcoin Core
- **version:** before 0.20.0

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the identified CVEs:

**CVE-2010-5137**
*   **Root Cause:** Processing of a transaction containing an `OP_LSHIFT` opcode would cause a crash on some machines.
*   **Weaknesses/Vulnerabilities:** Improper handling of the `OP_LSHIFT` opcode.
*   **Impact of Exploitation:** Denial of Service (DoS) due to client crash.
*   **Attack Vectors:** Sending a specially crafted transaction containing the vulnerable opcode.
*   **Required Attacker Capabilities/Position:** The attacker needs to create and broadcast a transaction with the specific opcode.

**CVE-2010-5141**
*   **Root Cause:** A bug in transaction handling allowed an attacker to spend coins they did not own.
*   **Weaknesses/Vulnerabilities:** A vulnerability in transaction handling logic.
*  **Impact of Exploitation:** Theft of funds
*   **Attack Vectors:** Crafting a malicious transaction exploiting the vulnerability.
*   **Required Attacker Capabilities/Position:**  The attacker needs to craft and broadcast a transaction using the vulnerable method.

**CVE-2010-5138**
*   **Root Cause:** A block containing transactions with an excessive amount of `OP_CHECKSIG` commands caused nodes to perform unnecessary work.
*   **Weaknesses/Vulnerabilities:** Lack of proper limits on `OP_CHECKSIG` command usage.
*   **Impact of Exploitation:** Denial of Service (DoS) due to excessive resource consumption.
*   **Attack Vectors:** Creating and broadcasting a block containing transactions with an excessive amount of `OP_CHECKSIG` commands.
*  **Required Attacker Capabilities/Position:** The attacker needs to be able to mine blocks and include the malicious transactions.

**CVE-2010-5139**
*   **Root Cause:** Integer overflow when summing transaction outputs.
*   **Weaknesses/Vulnerabilities:** Insufficient checks on the size of transaction outputs, leading to an integer overflow when they were summed up.
*   **Impact of Exploitation:** Inflation of the money supply by creating coins out of thin air.
*   **Attack Vectors:** Crafting a transaction with outputs large enough to cause an overflow when summed.
*   **Required Attacker Capabilities/Position:** The attacker needed to create and broadcast a block containing the malicious transaction.

**CVE-2010-5140**
*   **Root Cause:** Transactions with sub-0.01 fees were not confirmed, causing related transactions to also be stuck.
*   **Weaknesses/Vulnerabilities:**  The network required a 0.01 fee for such transactions at the time, and the client did not properly handle the unconfirmed status of the transactions.
*   **Impact of Exploitation:**  Transactions would not confirm and wallets would become contaminated with unspendable funds
*   **Attack Vectors:** Sending transactions with less than the required fee.
*   **Required Attacker Capabilities/Position:** The attacker needs to craft and broadcast transactions with a fee below the network's requirement.

**CVE-2011-4447**
*   **Root Cause:** Wallet non-encryption.
*   **Weaknesses/Vulnerabilities:**  Wallet files were not encrypted by default.
*   **Impact of Exploitation:** Exposure of user funds to anyone with access to the wallet file
*  **Attack Vectors:** Direct access to unencrypted wallet files.
*   **Required Attacker Capabilities/Position:** Local access to the system storing the unencrypted wallet.

**CVE-2012-1909**
*   **Root Cause:** Transaction overwriting vulnerability in the Bitcoin protocol.
*   **Weaknesses/Vulnerabilities:**  Duplicate transactions with the same hash could be created, leading to chain splits.
*  **Impact of Exploitation:**  Netsplit, double spending.
*   **Attack Vectors:** Creating duplicate transactions.
*   **Required Attacker Capabilities/Position:** The attacker needs to create and broadcast a transaction that overwrites a previously broadcast transaction.

**CVE-2012-1910**
*   **Root Cause:** Non-thread safe MingW exceptions.
*   **Weaknesses/Vulnerabilities:**  MingW exceptions were not handled in a thread-safe manner.
*  **Impact of Exploitation:** Unknown
*   **Attack Vectors:** Triggering exceptions in a non-thread safe context.
*   **Required Attacker Capabilities/Position:** The attacker needs to have a way to trigger exceptions in the affected software.

**CVE-2012-2459**
*   **Root Cause:** Block hash collisions could be created by duplicating transactions in the Merkle tree.
*  **Weaknesses/Vulnerabilities:**  The client didn't properly validate the Merkle root.
*   **Impact of Exploitation:** Netsplit, preventing the acceptance of legitimate blocks.
*   **Attack Vectors:** Creating blocks with duplicate transactions causing block hash collisions
*   **Required Attacker Capabilities/Position:** The attacker needs to be able to mine blocks.

**CVE-2012-3789**
*   **Root Cause:** Lack of resource limits for orphan transactions.
*   **Weaknesses/Vulnerabilities:**  The Bitcoin client did not limit the number of orphan transactions.
*   **Impact of Exploitation:** Denial of service by exhausting resources with orphan transactions.
*   **Attack Vectors:** Flooding the network with many orphan transactions.
*  **Required Attacker Capabilities/Position:** The attacker needs to have the ability to broadcast many transactions.

**CVE-2012-4683**
*   **Root Cause:** Targeted DoS by CPU exhaustion using alerts.
*  **Weaknesses/Vulnerabilities:** Inefficient processing of alerts causing CPU exhaustion.
*   **Impact of Exploitation:** Denial of Service (DoS) by exhausting the CPU resources.
*   **Attack Vectors:** Sending crafted alerts that are costly to process.
*   **Required Attacker Capabilities/Position:** The attacker needs to send a specially crafted alert message.

**CVE-2012-4684**
*   **Root Cause:** Network-wide DoS using malleable signatures in alerts.
*  **Weaknesses/Vulnerabilities:**  The Bitcoin client was not properly verifying the signatures of the alert messages
*   **Impact of Exploitation:** Denial of Service (DoS) across the network.
*   **Attack Vectors:** Sending alerts with malleable signatures.
*   **Required Attacker Capabilities/Position:** The attacker needs to send a specially crafted alert message with a malleable signature.

**CVE-2013-2272**
*   **Root Cause:** Remote discovery of node's wallet addresses.
*   **Weaknesses/Vulnerabilities:**  The Bitcoin client was leaking wallet addresses.
*   **Impact of Exploitation:** Exposure of user addresses
*   **Attack Vectors:** Remote access to the Bitcoin client.
*   **Required Attacker Capabilities/Position:**  The attacker can remotely query a vulnerable node.

**CVE-2013-2273**
*   **Root Cause:** Predictable change output addresses.
*  **Weaknesses/Vulnerabilities:** The change output was not generated in a random or unpredictable way.
*   **Impact of Exploitation:** Exposure of user's change addresses
*   **Attack Vectors:** Monitoring the change output.
*   **Required Attacker Capabilities/Position:** The attacker can monitor transactions in the Bitcoin network.

**CVE-2013-2292**
*  **Root Cause:** A transaction that takes a long time to verify.
*   **Weaknesses/Vulnerabilities:** The client spent an excessive amount of time verifying a transaction.
*   **Impact of Exploitation:**  Denial of Service (DoS).
*   **Attack Vectors:** Broadcasting a transaction that takes a very long time to verify.
*   **Required Attacker Capabilities/Position:** The attacker needs to be able to broadcast a specially crafted transaction.

**CVE-2013-2293**
*   **Root Cause:** Continuous hard disk seek.
*  **Weaknesses/Vulnerabilities:**  Inefficient handling of disk seeks, leading to high disk usage.
*   **Impact of Exploitation:**  Denial of Service due to excessive disk activity.
*   **Attack Vectors:** Triggering excessive disk seeking activity.
*   **Required Attacker Capabilities/Position:** The attacker needs to send a transaction that can trigger the disk activity.

**CVE-2013-4627**
*   **Root Cause:** Memory exhaustion with excess transaction message data.
*   **Weaknesses/Vulnerabilities:**  The client did not properly handle large transaction messages.
*   **Impact of Exploitation:** Denial of Service via memory exhaustion.
*   **Attack Vectors:** Sending a transaction with excessive message data.
*   **Required Attacker Capabilities/Position:** The attacker needs to send a specially crafted transaction with excessive data.

**CVE-2013-4165**
*   **Root Cause:** Timing leak in RPC authentication
*   **Weaknesses/Vulnerabilities:**  Timing side channel in RPC authentication.
*   **Impact of Exploitation:** Local attacker could potentially determine the RPC passphrase.
*   **Attack Vectors:** Analyzing the timing of RPC authentication.
*  **Required Attacker Capabilities/Position:** Local access to the system running Bitcoin.

**CVE-2013-5700**
*   **Root Cause:** Remote p2p crash via bloom filters.
*  **Weaknesses/Vulnerabilities:**  Improper handling of bloom filters caused a crash.
*   **Impact of Exploitation:** Denial of Service via remote client crash.
*  **Attack Vectors:** Sending malicious bloom filter messages via p2p.
*   **Required Attacker Capabilities/Position:** The attacker needs to be able to send peer-to-peer messages to a vulnerable node.

**CVE-2016-8889**
*   **Root Cause:** Debug console history storing sensitive info.
*   **Weaknesses/Vulnerabilities:** Sensitive info could be stored in debug console history.
*   **Impact of Exploitation:**  Exposure of user's sensitive data.
*   **Attack Vectors:** Accessing the debug console history file.
*   **Required Attacker Capabilities/Position:** Local access to the machine running Bitcoin Knots.

**CVE-2017-12842**
*   **Root Cause:** No commitment to block Merkle tree depth.
*   **Weaknesses/Vulnerabilities:**  Lack of commitment to Merkle tree depth could be exploited by miners.
*  **Impact of Exploitation:**  Unknown, potential for blockchain manipulation.
*   **Attack Vectors:**  Manipulation of the Merkle tree by miners.
*   **Required Attacker Capabilities/Position:**  Attacker needs to be a miner.

**CVE-2017-18350**
*   **Root Cause:** Buffer overflow from SOCKS proxy
*   **Weaknesses/Vulnerabilities:** The SOCKS proxy had a buffer overflow.
*   **Impact of Exploitation:** Potential for remote code execution
*  **Attack Vectors:** Sending malicious data via the SOCKS proxy.
*  **Required Attacker Capabilities/Position:** The attacker must be able to send data to a vulnerable node using a SOCKS proxy.

**CVE-2018-17144**
*   **Root Cause:** Missing check for duplicate inputs.
*  **Weaknesses/Vulnerabilities:**  A missing check allowed transactions to have duplicate inputs.
*   **Impact of Exploitation:**  Inflation of the money supply.
*   **Attack Vectors:** Creating blocks with transactions that contain duplicate inputs.
*   **Required Attacker Capabilities/Position:** The attacker needed to be a miner.

**CVE-2018-20586**
*   **Root Cause:** Debug log injection via unauthenticated RPC.
*  **Weaknesses/Vulnerabilities:**  The debug log could be injected via an unauthenticated RPC call.
*   **Impact of Exploitation:** Deception. Attacker can inject arbitrary log messages.
*   **Attack Vectors:** Unauthenticated RPC access.
*   **Required Attacker Capabilities/Position:** The attacker needs to have network access to the RPC port of a vulnerable node.

**CVE-2020-14199**
*   **Root Cause:** Double-signing can enable unintended fees.
*   **Weaknesses/Vulnerabilities:**  Double signing on Trezor devices could result in unintended fees
*   **Impact of Exploitation:** Loss of funds due to unintended fees.
*   **Attack Vectors:** Tricking a user into double signing a transaction.
*   **Required Attacker Capabilities/Position:** The attacker needs to socially engineer a user into double-signing.

**CVE-2020-26895**
*   **Root Cause:** Missing low-S normalization for HTLC signatures.
*  **Weaknesses/Vulnerabilities:**  Lack of signature normalization allowed for a theft of funds.
*   **Impact of Exploitation:** Theft of funds.
*   **Attack Vectors:** Exploiting the lack of low-S signature normalization.
*  **Required Attacker Capabilities/Position:** The attacker needs to exploit the signature vulnerability during a channel update.

**CVE-2020-26896**
*   **Root Cause:** Invoice preimage extraction via forwarded HTLC.
*  **Weaknesses/Vulnerabilities:**  Information leakage via HTLC forwarding.
*   **Impact of Exploitation:** Theft of funds.
*  **Attack Vectors:** Exploiting information leakage via HTLC forwarding to extract the invoice preimage
*   **Required Attacker Capabilities/Position:** The attacker needs to be able to intercept HTLCs being forwarded in the network.

**CVE-2021-3401**
*  **Root Cause:** Qt5 remote execution.
*   **Weaknesses/Vulnerabilities:** The Qt5 library allowed for remote code execution.
*   **Impact of Exploitation:**  Theft of user funds via remote code execution.
*   **Attack Vectors:** Exploiting a vulnerability in the Qt5 framework.
*   **Required Attacker Capabilities/Position:** The attacker needs to be able to exploit a vulnerability in the Qt5 framework, this vulnerability can only be exploited if a user opens a malicious file, or accesses a malicious site.

**CVE-2023-50428**
*   **Root Cause:** Bypass of `datacarriersize` limit using `OP_FALSE,OP_IF`.
*   **Weaknesses/Vulnerabilities:**  The `datacarriersize` limit was not correctly enforced.
*   **Impact of Exploitation:**  Denial of Service (DoS).
*  **Attack Vectors:**  Bypassing the `datacarriersize` limit.
*  **Required Attacker Capabilities/Position:** The attacker needs to be able to broadcast transactions that contain OP_FALSE and OP_IF.

**CVE-2024-34149**
*   **Root Cause:** Script size limit not enforced for Tapscript.
*  **Weaknesses/Vulnerabilities:**  The script size limit was not enforced for Tapscript.
*   **Impact of Exploitation:**  Denial of Service (DoS).
*  **Attack Vectors:**  Creating transactions with oversized Tapscripts.
*   **Required Attacker Capabilities/Position:** The attacker needs to be able to broadcast transactions that contain Tapscripts.

**Disclosure of DoS using huge GETDATA messages**
*   **Root Cause:** Malformed GETDATA messages causing an infinite loop.
*   **Weaknesses/Vulnerabilities:**  Improper handling of malformed GETDATA messages.
*   **Impact of Exploitation:** Denial of Service (DoS) by exhausting CPU resources.
*   **Attack Vectors:** Sending malformed GETDATA messages.
*   **Required Attacker Capabilities/Position:**  The attacker needs to send malformed peer-to-peer messages to a vulnerable node.

The provided content does not contain any information related to a CVE with the ID `CVE-2024-52920`. Thus, the response is:

**UNRELATED**

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 703 | Improper Check or Handling of Exceptional Conditions | Pillar | Discouraged | sparse | 0.047 |
| 2 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.044 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.043 |
| 4 | 834 | Excessive Iteration | Class | Discouraged | sparse | 0.036 |
| 5 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.036 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.482 |
| 7 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | Base | Allowed | graph | 0.003 |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.036 |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.035 |
| 10 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.035 |



# Complete CWE Specifications


## CWE-703: Improper Check or Handling of Exceptional Conditions
**Abstraction:** Pillar
**Status:** Incomplete

### Description
The product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
None

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** This CWE entry is extremely high-level, a Pillar.
**Comments:** Consider children or descendants of this entry instead.
**Reasons:**
- Abstraction


### Additional Notes
**[Relationship]** This is a high-level class that might have some overlap with other classes. It could be argued that even "normal" weaknesses such as buffer overflows involve unusual or exceptional conditions. In that sense, this might be an inherent aspect of most other weaknesses within CWE, similar to API Abuse (CWE-227) and Indicator of Poor Code Quality (CWE-398). However, this entry is currently intended to unify disparate concepts that do not have other places within the Research Concepts view (CWE-1000).



### Observed Examples
- **[REF-1374]:** Chain: JavaScript-based cryptocurrency library can fall back to the insecure Math.random() function instead of reporting a failure (CWE-392), thus reducing the entropy (CWE-332) and leading to generation of non-unique cryptographic keys for Bitcoin wallets (CWE-1391)
- **CVE-2022-22224:** Chain: an operating system does not properly process malformed Open Shortest Path First (OSPF) Type/Length/Value Identifiers (TLV) (CWE-703), which can cause the process to enter an infinite loop (CWE-835)




## CWE-835: Loop with Unreachable Exit Condition ('Infinite Loop')
**Abstraction:** Base
**Status:** Incomplete

### Description
The product contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-834
ChildOf -> CWE-834

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2022-22224:** Chain: an operating system does not properly process malformed Open Shortest Path First (OSPF) Type/Length/Value Identifiers (TLV) (CWE-703), which can cause the process to enter an infinite loop (CWE-835)
- **CVE-2022-25304:** A Python machine communication platform did not account for receiving a malformed packet with a null size, causing the receiving function to never update the message buffer and be caught in an infinite loop.
- **CVE-2011-1027:** Chain: off-by-one error (CWE-193) leads to infinite loop (CWE-835) using invalid hex-encoded characters.




## CWE-674: Uncontrolled Recursion
**Abstraction:** Class
**Status:** Draft

### Description
The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack.

### Extended Description
Not provided

### Alternative Terms
Stack Exhaustion

### Relationships
ChildOf -> CWE-834

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction



### Observed Examples
- **CVE-2007-1285:** Deeply nested arrays trigger stack exhaustion.
- **CVE-2007-3409:** Self-referencing pointers create infinite loop and resultant stack exhaustion.
- **CVE-2016-10707:** Javascript application accidentally changes input in a way that prevents a recursive call from detecting an exit condition.




## CWE-834: Excessive Iteration
**Abstraction:** Class
**Status:** Incomplete

### Description
The product performs an iteration or loop without sufficiently limiting the number of times that the loop is executed.

### Extended Description
If the iteration can be influenced by an attacker, this weakness could allow attackers to consume excessive resources such as CPU or memory. In many cases, a loop does not need to be infinite in order to cause enough resource consumption to adversely affect the product or its host system; it depends on the amount of resources consumed per iteration.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-691

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction



### Observed Examples
- **CVE-2011-1027:** Chain: off-by-one error (CWE-193) leads to infinite loop (CWE-835) using invalid hex-encoded characters.
- **CVE-2006-6499:** Chain: web browser crashes due to infinite loop - "bad looping logic [that relies on] floating point math [CWE-1339] to exit the loop [CWE-835]"




## CWE-755: Improper Handling of Exceptional Conditions
**Abstraction:** Class
**Status:** Incomplete

### Description
The product does not handle or incorrectly handles an exceptional condition.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-703

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction



### Observed Examples
- **CVE-2023-41151:** SDK for OPC Unified Architecture (OPC UA) server has uncaught exception when a socket is blocked for writing but the server tries to send an error
- **[REF-1374]:** Chain: JavaScript-based cryptocurrency library can fall back to the insecure Math.random() function instead of reporting a failure (CWE-392), thus reducing the entropy (CWE-332) and leading to generation of non-unique cryptographic keys for Bitcoin wallets (CWE-1391)
- **CVE-2021-3011:** virtual interrupt controller in a virtualization product allows crash of host by writing a certain invalid value to a register, which triggers a fatal error instead of returning an error code




## CWE-770: Allocation of Resources Without Limits or Throttling
**Abstraction:** Base
**Status:** Incomplete

### Description
The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.

### Extended Description


Code frequently has to work with limited resources, so programmers must be careful to ensure that resources are not consumed too quickly, or too easily. Without use of quotas, resource limits, or other protection mechanisms, it can be easy for an attacker to consume many resources by rapidly making many requests, or causing larger resources to be used than is needed. When too many resources are allocated, or if a single resource is too large, then it can prevent the code from working correctly, possibly leading to a denial of service.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-400
ChildOf -> CWE-665
ChildOf -> CWE-400

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** This entry is different from uncontrolled resource consumption (CWE-400) in that there are other weaknesses that are related to inability to control resource consumption, such as holding on to a resource too long after use, or not correctly keeping track of active resources so that they can be managed and released when they are finished (CWE-771).

**[Theoretical]** Vulnerability theory is largely about how behaviors and resources interact. "Resource exhaustion" can be regarded as either a consequence or an attack, depending on the perspective. This entry is an attempt to reflect one of the underlying weaknesses that enable these attacks (or consequences) to take place.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2009-4017:** Language interpreter does not restrict the number of temporary files being created when handling a MIME request with a large number of parts..
- **CVE-2009-2726:** Driver does not use a maximum width when invoking sscanf style functions, causing stack consumption.




## CWE-1322: Use of Blocking Code in Single-threaded, Non-blocking Context
**Abstraction:** Base
**Status:** Incomplete

### Description
The product uses a non-blocking model that relies on a single threaded process
			for features such as scalability, but it contains code that can block when it is invoked.

### Extended Description


When an attacker can directly invoke the blocking code, or the blocking code can be affected by environmental conditions that can be influenced by an attacker, then this can lead to a denial of service by causing unexpected hang or freeze of the code. Examples of blocking code might be an expensive computation or calling blocking library calls, such as those that perform exclusive file operations or require a successful network operation.


Due to limitations in multi-thread models, single-threaded models are used to overcome the resource constraints that are caused by using many threads. In such a model, all code should generally be non-blocking. If blocking code is called, then the event loop will effectively be stopped, which can be undesirable or dangerous. Such models are used in Python asyncio, Vert.x, and Node.js, or other custom event loop code.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-834
CanPrecede -> CWE-835

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use






## CWE-789: Memory Allocation with Excessive Size Value
**Abstraction:** Variant
**Status:** Draft

### Description
The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated.

### Extended Description
Not provided

### Alternative Terms
Stack Exhaustion: When a weakness allocates excessive memory on the stack, it is often described as "stack exhaustion," which is a technical impact of the weakness. This technical impact is often encountered as a consequence of CWE-789 and/or CWE-1325.

### Relationships
ChildOf -> CWE-770
CanPrecede -> CWE-476

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** This weakness can be closely associated with integer overflows (CWE-190). Integer overflow attacks would concentrate on providing an extremely large number that triggers an overflow that causes less memory to be allocated than expected. By providing a large value that does not trigger an integer overflow, the attacker could still cause excessive amounts of memory to be allocated.

**[Applicable Platform]** 

Uncontrolled memory allocation is possible in many languages, such as dynamic array allocation in perl or initial size parameters in Collections in Java. However, languages like C and C++ where programmers have the power to more directly control memory management will be more susceptible.




### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2010-3701:** program uses ::alloca() for encoding messages, but large messages trigger segfault
- **CVE-2008-1708:** memory consumption and daemon exit by specifying a large value in a length field




## CWE-1284: Improper Validation of Specified Quantity in Input
**Abstraction:** Base
**Status:** Incomplete

### Description
The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.

### Extended Description


Specified quantities include size, length, frequency, price, rate, number of operations, time, and others. Code may rely on specified quantities to allocate resources, perform calculations, control iteration, etc. When the quantity is not properly validated, then attackers can specify malicious quantities to cause excessive resource allocation, trigger unexpected failures, enable buffer overflows, etc.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-20
ChildOf -> CWE-20
CanPrecede -> CWE-789

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Maintenance]** This entry is still under development and will continue to see updates and content improvements.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2008-1440:** lack of validation of length field leads to infinite loop
- **CVE-2008-2374:** lack of validation of string length fields allows memory consumption or buffer over-read




## CWE-400: Uncontrolled Resource Consumption
**Abstraction:** Class
**Status:** Draft

### Description
The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.

### Extended Description


Limited resources include memory, file system storage, database connection pool entries, and CPU. If an attacker can trigger the allocation of these limited resources, but the number or size of the resources is not controlled, then the attacker could cause a denial of service that consumes all available resources. This would prevent valid users from accessing the product, and it could potentially have an impact on the surrounding environment. For example, a memory exhaustion attack against an application could slow down the application as well as its host operating system.


There are at least three distinct scenarios which can commonly lead to resource exhaustion:


  - Lack of throttling for the number of allocated resources

  - Losing all references to a resource before reaching the shutdown stage

  - Not closing/returning a resource after processing

Resource exhaustion problems are often result due to an incorrect implementation of the following situations:

  - Error conditions and other exceptional circumstances.

  - Confusion over which part of the program is responsible for releasing the resource.



### Alternative Terms
Resource Exhaustion

### Relationships
ChildOf -> CWE-664

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-400 is intended for incorrect behaviors in which the product is expected to track and restrict how many resources it consumes, but CWE-400 is often misused because it is conflated with the "technical impact" of vulnerabilities in which resource consumption occurs. It is sometimes used for low-information vulnerability reports. It is a level-1 Class (i.e., a child of a Pillar).
**Comments:** Closely analyze the specific mistake that is causing resource consumption, and perform a CWE mapping for that mistake. Consider children/descendants such as CWE-770: Allocation of Resources Without Limits or Throttling, CWE-771: Missing Reference to Active Allocated Resource, CWE-410: Insufficient Resource Pool, CWE-772: Missing Release of Resource after Effective Lifetime, CWE-834: Excessive Iteration, CWE-405: Asymmetric Resource Consumption (Amplification), and others.
**Reasons:**
- Frequent Misuse


### Additional Notes
**[Maintenance]** "Resource consumption" could be interpreted as a consequence instead of an insecure behavior, so this entry is being considered for modification. It appears to be referenced too frequently when more precise mappings are available. Some of its children, such as CWE-771, might be better considered as a chain.

**[Theoretical]** Vulnerability theory is largely about how behaviors and resources interact. "Resource exhaustion" can be regarded as either a consequence or an attack, depending on the perspective. This entry is an attempt to reflect the underlying weaknesses that enable these attacks (or consequences) to take place.

**[Other]** 

Database queries that take a long time to process are good DoS targets. An attacker would have to write a few lines of Perl code to generate enough traffic to exceed the site's ability to keep up. This would effectively prevent authorized users from using the site at all. Resources can be exploited simply by ensuring that the target machine must do much more work and consume more resources in order to service a request than the attacker must do to initiate a request.


A prime example of this can be found in old switches that were vulnerable to "macof" attacks (so named for a tool developed by Dugsong). These attacks flooded a switch with random IP and MAC address combinations, therefore exhausting the switch's cache, which held the information of which port corresponded to which MAC addresses. Once this cache was exhausted, the switch would fail in an insecure way and would begin to act simply as a hub, broadcasting all traffic on all ports and allowing for basic sniffing attacks.


**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the "Mapping CWE to 62443" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2020-7218:** Go-based workload orchestrator does not limit resource usage with unauthenticated connections, allowing a DoS by flooding the service
- **CVE-2020-3566:** Resource exhaustion in distributed OS because of "insufficient" IGMP queue management, as exploited in the wild per CISA KEV.

