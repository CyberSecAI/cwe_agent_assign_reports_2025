{
  "query": "Nix is a package manager for Linux and other Unix systems. Starting in version 1.11 and prior to versions 2.18.8 and 2.24.8, `` did not verify TLS certificates on HTTPS connections. This could lead to connection details such as full URLs or credentials leaking in case of a man-in-the-middle (MITM) attack. `` is also known as the builtin derivation builder `builtinfetchurl`. Its not to be confused with the evaluation-time function `builtins.fetchurl`, which was not affected by this issue. A user may be affected by the risk of leaking credentials if they have a `netrc` file for authentication, or rely on derivations with `impureEnvVars` set to use credentials from the environment. In addition, the commonplace trust-on-first-use (TOFU) technique of updating dependencies by specifying an invalid hash and obtaining it from a remote store was also vulnerable to a MITM injecting arbitrary store objects. This also applied to the impure derivations experimental feature. Note that this may also happen when using Nixpkgs fetchers to obtain new hashes when not using the fake hash method, although that mechanism is not implemented in Nix itself but rather in Nixpkgs using a fixed-output derivation. The behavior was introduced in version 1.11 to make it consistent with the Nixpkgs `pkgs.fetchurl` and to make `` work in the derivation builder sandbox, which back then did not have access to the CA bundles by default. Nowadays, CA bundl",
  "keyphrases": {
    "rootcause": [
      "did not verify TLS certificates on HTTPS connections"
    ]
  },
  "timestamp": "2025-07-13T18:02:46.824811",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "322",
        "name": "Key Exchange without Entity Authentication",
        "abstraction": "base",
        "score": 2.9120000000000004,
        "description": "CWE-322: Key Exchange without Entity Authentication...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "226",
        "name": "Sensitive Information in Resource Not Removed Before Reuse",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "abstraction": "base",
        "score": 2.1189999999999998,
        "description": "CWE-201: Insertion of Sensitive Information Into Sent Data...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "386",
        "name": "Symbolic Name not Mapping to Correct Object",
        "abstraction": "base",
        "score": 2.0930000000000004,
        "description": "CWE-386: Symbolic Name not Mapping to Correct Object...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "350",
        "name": "Reliance on Reverse DNS Resolution for a Security-Critical Action",
        "abstraction": "variant",
        "score": 2.04,
        "description": "CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "296",
        "name": "Improper Following of a Certificate's Chain of Trust",
        "abstraction": "Base",
        "score": 1.984778616946114,
        "description": "The product does not follow, or incorrectly follows, the chain of trust for a certificate back to a trusted root certificate, resulting in incorrect trust of any resource that is associated with that ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "370",
        "name": "Missing Check for Certificate Revocation after Initial Check",
        "abstraction": "variant",
        "score": 1.91472,
        "description": "CWE-370: Missing Check for Certificate Revocation after Initial Check...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "295",
        "name": "Improper Certificate Validation",
        "abstraction": "Base",
        "score": 1.880697060347621,
        "description": "The product does not validate, or incorrectly validates, a certificate....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "297",
        "name": "Improper Validation of Certificate with Host Mismatch",
        "abstraction": "Variant",
        "score": 1.7879679301099172,
        "description": "The product communicates with a host that provides a certificate, but the product does not properly ensure that the certificate is actually associated with that host....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-476: NULL Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "variant",
        "score": 1.6320000000000003,
        "description": "CWE-416: Use After Free...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "212",
        "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
        "abstraction": "Base",
        "score": 1.5334743080105915,
        "description": "The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorize...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "202",
        "name": "Exposure of Sensitive Information Through Data Queries",
        "abstraction": "base",
        "score": 1.521,
        "description": "CWE-202: Exposure of Sensitive Information Through Data Queries...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "209",
        "name": "Generation of Error Message Containing Sensitive Information",
        "abstraction": "base",
        "score": 1.521,
        "description": "CWE-209: Generation of Error Message Containing Sensitive Information...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "319",
        "name": "Cleartext Transmission of Sensitive Information",
        "abstraction": "Base",
        "score": 1.470888225476694,
        "description": "The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "298",
        "name": "Improper Validation of Certificate Expiration",
        "abstraction": "variant",
        "score": 1.416,
        "description": "CWE-298: Improper Validation of Certificate Expiration...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "123",
        "name": "Write-what-where Condition",
        "abstraction": "base",
        "score": 1.3676000000000001,
        "description": "CWE-123: Write-what-where Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "base",
        "score": 1.3676000000000001,
        "description": "CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "384",
        "name": "Session Fixation",
        "abstraction": "compound",
        "score": 1.3600000000000003,
        "description": "CWE-384: Session Fixation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1325",
        "name": "Improperly Controlled Sequential Memory Allocation",
        "abstraction": "base",
        "score": 1.3010400000000002,
        "description": "CWE-1325: Improperly Controlled Sequential Memory Allocation...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "297",
        "name": "Improper Validation of Certificate with Host Mismatch",
        "abstraction": "Variant",
        "score": 0.49493895959457257,
        "description": "The product communicates with a host that provides a certificate, but the product does not properly ensure that the certificate is actually associated with that host....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "158",
        "name": "Improper Neutralization of Null Byte or NUL Character",
        "abstraction": "Variant",
        "score": 0.48858407387263647,
        "description": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes NUL characters or null bytes when they are sent to a downstream component....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "295",
        "name": "Improper Certificate Validation",
        "abstraction": "Base",
        "score": 0.4878909343477068,
        "description": "The product does not validate, or incorrectly validates, a certificate....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "296",
        "name": "Improper Following of a Certificate's Chain of Trust",
        "abstraction": "Base",
        "score": 0.48402673237899013,
        "description": "The product does not follow, or incorrectly follows, the chain of trust for a certificate back to a trusted root certificate, resulting in incorrect trust of any resource that is associated with that ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "abstraction": "Compound",
        "score": 0.48361628772580956,
        "description": "The product, when opening a file or directory, does not sufficiently account for when the file is a symbolic link that resolves to a target outside of the intended control sphere. This could allow an ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "277",
        "name": "Insecure Inherited Permissions",
        "abstraction": "Variant",
        "score": 0.4730164472239896,
        "description": "A product defines a set of insecure permissions that are inherited by objects that are created by the program....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "346",
        "name": "Origin Validation Error",
        "abstraction": "Class",
        "score": 0.4704398974410239,
        "description": "The product does not properly verify that the source of data or communication is valid....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "88",
        "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
        "abstraction": "Base",
        "score": 0.4686472385180271,
        "description": "The product constructs a string for a command to be executed by a separate component\nin another control sphere, but it does not properly delimit the\nintended arguments, options, or switches within tha...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "abstraction": "Base",
        "score": 0.4650238475975678,
        "description": "The product does not verify, or incorrectly verifies, the cryptographic signature for data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1286",
        "name": "Improper Validation of Syntactic Correctness of Input",
        "abstraction": "Base",
        "score": 0.4609122298339264,
        "description": "The product receives input that is expected to be well-formed - i.e., to comply with a certain syntax - but it does not validate or incorrectly validates that the input complies with the syntax....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "212",
        "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
        "abstraction": "Base",
        "score": 0.4603091457896391,
        "description": "The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorize...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "214",
        "name": "Invocation of Process Using Visible Sensitive Information",
        "abstraction": "Base",
        "score": 0.45961544650502695,
        "description": "A process is invoked with sensitive command-line arguments, environment variables, or other elements that can be seen by other processes on the operating system....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1394",
        "name": "Use of Default Cryptographic Key",
        "abstraction": "Base",
        "score": 0.45931953956514626,
        "description": "The product uses a default cryptographic key for potentially critical functionality....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "835",
        "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
        "abstraction": "Base",
        "score": 0.4577917930675658,
        "description": "The product contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1289",
        "name": "Improper Validation of Unsafe Equivalence in Input",
        "abstraction": "Base",
        "score": 0.45756126148133197,
        "description": "The product receives an input value that is used as a resource identifier or other type of reference, but it does not validate or incorrectly validates that the input is equivalent to a potentially-un...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "617",
        "name": "Reachable Assertion",
        "abstraction": "Base",
        "score": 0.4567268899403638,
        "description": "The product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "abstraction": "Base",
        "score": 0.45658248547324387,
        "description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the in...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "204",
        "name": "Observable Response Discrepancy",
        "abstraction": "Base",
        "score": 0.45562092262139287,
        "description": "The product provides different responses to incoming requests in a way that reveals internal state information to an unauthorized actor outside of the intended control sphere....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 0.45533926237833017,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "abstraction": "Base",
        "score": 0.45358085311878815,
        "description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modi...",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "295",
        "name": "Improper Certificate Validation",
        "abstraction": "Base",
        "score": 1327.2188062366217,
        "description": "The product does not validate, or incorrectly validates, a certificate....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "abstraction": "Class",
        "score": 1275.3995467465606,
        "description": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "abstraction": "Base",
        "score": 1256.0022396097847,
        "description": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 1249.8052614453125,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "319",
        "name": "Cleartext Transmission of Sensitive Information",
        "abstraction": "Base",
        "score": 1244.7933936735506,
        "description": "The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "abstraction": "Class",
        "score": 1242.9741133281368,
        "description": "The product uses a broken or risky cryptographic algorithm or protocol....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "522",
        "name": "Insufficiently Protected Credentials",
        "abstraction": "Class",
        "score": 1238.1417831962056,
        "description": "The product transmits or stores authentication credentials, but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 1232.3699569547189,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "abstraction": "Base",
        "score": 1217.1439846371295,
        "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neu...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1390",
        "name": "Weak Authentication",
        "abstraction": "Class",
        "score": 1203.9203167992648,
        "description": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....",
        "mapping_usage": "Allowed-with-Review"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.45358085311878815,
      "max": 0.49493895959457257,
      "mean": 0.467477212423754,
      "median": 0.4606106878117827,
      "count": 20
    },
    "sparse": {
      "min": 1203.9203167992648,
      "max": 1327.2188062366217,
      "mean": 1248.7769402627287,
      "median": 1243.8837535008438,
      "count": 10
    },
    "graph": {
      "min": 1.3010400000000002,
      "max": 2.9120000000000004,
      "mean": 1.7600383070445471,
      "median": 1.7000000000000004,
      "count": 20
    }
  }
}