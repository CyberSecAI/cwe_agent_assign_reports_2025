## Vulnerability Description
A **prompt injection** vulnerability in the chatbox of Butterfly Effect Limited Monica ChatGPT AI Assistant v2.4.0 allows attackers to access and exfiltrate all previous and subsequent chat data between the user and the AI assistant via a crafted message.

### Vulnerability Description Key Phrases
- **rootcause:** **prompt injection**
- **impact:** access and exfiltrate all previous and subsequent chat data
- **vector:** crafted message
- **attacker:** attackers
- **product:** Butterfly Effect Limited Monica ChatGPT AI Assistant
- **version:** v2.4.0
- **component:** chatbox

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Prompt injection in the chatbox of Monica ChatGPT AI Assistant.
- **Weaknesses/vulnerabilities present:** The application is vulnerable to prompt injection, allowing an attacker to manipulate the AI assistant's behavior through a crafted message.
- **Impact of exploitation:** An attacker can access and exfiltrate all previous and subsequent chat data between the user and the AI assistant, leading to persistent data leakage.
- **Attack vectors:** The attack vector is through a crafted message entered into the chat window of the application.
- **Required attacker capabilities/position:** The attacker needs to be able to send messages to the AI assistant through the chat interface.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.241 |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.209 |
| 4 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.195 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.194 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.190 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.188 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.187 |
| 9 | 1426 | Improper Validation of Generative AI Output | Base | Discouraged | dense | 0.494 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-1427: Improper Neutralization of Input Used for LLM Prompting

CWE-116: Improper Encoding or Escaping of Output

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-20: Improper Input Validation

CWE-1426: Improper Validation of Generative AI Output

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')