{
  "query": "In the Linux kernel, the following vulnerability has been resolved block fix queue freeze vs limits lock order in sysfs store methods queue_attr_store() always freezes a device queue before calling the attribute store operation. For attributes that control queue limits, the store operation will also lock the queue limits with a call to queue_limits_start_update(). However, some drivers (e.g. SCSI sd) may need to issue commands to a device to obtain limit values from the hardware with the queue limits locked. This creates a potential ABBA deadlock situation if a user attempts to modify a limit (thus freezing the device queue) while the device driver starts a revalidation of the device queue limits. Avoid such deadlock by not freezing the queue before calling the ->store_limit() method in struct queue_sysfs_entry and instead use the queue_limits_commit_update_frozen helper to freeze the queue after taking the limits lock. This also removes taking the sysfs lock for the store_limit method as it doesnt protect anything here, but creates even more nesting. Hopefully it will go away from the actual sysfs methods entirely soon. (commit log adapted from a similar patch from Damien Le Moal)",
  "count": 20,
  "results": [
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "abstraction": "Base",
      "score": 0.48725892085349176,
      "original_score": 0.48725892085349176,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 0.46816816712034354,
      "original_score": 0.46816816712034354,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "abstraction": "Base",
      "score": 0.4631076750680818,
      "original_score": 0.4631076750680818,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "score": 0.45222419165261996,
      "original_score": 0.45222419165261996,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 0.4471032295667153,
      "original_score": 0.4471032295667153,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1256",
      "name": "Improper Restriction of Software Interfaces to Hardware Features",
      "abstraction": "Base",
      "score": 0.44165642642310654,
      "original_score": 0.44165642642310654,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1233",
      "name": "Security-Sensitive Hardware Controls with Missing Lock Bit Protection",
      "abstraction": "Base",
      "score": 0.4347867244472122,
      "original_score": 0.4347867244472122,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "abstraction": "Class",
      "score": 0.4333585443934611,
      "original_score": 0.4333585443934611,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "591",
      "name": "Sensitive Data Storage in Improperly Locked Memory",
      "abstraction": "Variant",
      "score": 0.4330223092911913,
      "original_score": 0.4330223092911913,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "606",
      "name": "Unchecked Input for Loop Condition",
      "abstraction": "Base",
      "score": 0.42802134535050196,
      "original_score": 0.42802134535050196,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "764",
      "name": "Multiple Locks of a Critical Resource",
      "abstraction": "Base",
      "score": 0.41518102624746034,
      "original_score": 0.41518102624746034,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "832",
      "name": "Unlock of a Resource that is not Locked",
      "abstraction": "Base",
      "score": 0.4145741167460522,
      "original_score": 0.4145741167460522,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "abstraction": "Base",
      "score": 0.4079912782926104,
      "original_score": 0.4079912782926104,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 0.4070701183290229,
      "original_score": 0.4070701183290229,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "774",
      "name": "Allocation of File Descriptors or Handles Without Limits or Throttling",
      "abstraction": "Variant",
      "score": 0.40558623726484244,
      "original_score": 0.40558623726484244,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "score": 0.40199399211994535,
      "original_score": 0.40199399211994535,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1231",
      "name": "Improper Prevention of Lock Bit Modification",
      "abstraction": "Base",
      "score": 0.4008817287158315,
      "original_score": 0.4008817287158315,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "abstraction": "Class",
      "score": 0.3989975931687269,
      "original_score": 0.3989975931687269,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 0.397601157364864,
      "original_score": 0.397601157364864,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "765",
      "name": "Multiple Unlocks of a Critical Resource",
      "abstraction": "Base",
      "score": 0.395317253984966,
      "original_score": 0.395317253984966,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.395317253984966,
    "max": 0.48725892085349176,
    "mean": 0.42669510182005244,
    "median": 0.42160118579898115,
    "count": 20
  }
}