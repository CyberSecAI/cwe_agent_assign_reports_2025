# Vulnerability Information: CVE-2024-49757

## Vulnerability Description
The open-source identity infrastructure software Zitadel allows administrators to disable the user self-registration. Due to a **missing security check** in versions prior to 2.64.0, 2.63.5, 2.62.7, 2.61.4, 2.60.4, 2.59.5, and 2.58.7, disabling the User Registration allowed option only hid the registration button on the login page. Users could bypass this restriction by directly accessing the registration URL (/ui/login/loginname) and register a user that way. Versions 2.64.0, 2.63.5, 2.62.7, 2.61.4, 2.60.4, 2.59.5, and 2.58.7 contain a patch. No known workarounds are available.

### Vulnerability Description Key Phrases
- **rootcause:** **missing security check**
- **vector:** directly accessing the registration URL
- **product:** Zitadel
- **version:** prior to 2.64.0, 2.63.5, 2.62.7, 2.61.4, 2.60.4, 2.59.5, and 2.58.7

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability described:

**CVE ID:** CVE-2024-49757

**Root Cause of Vulnerability:**
The vulnerability stems from a missing security check in ZITADEL's user self-registration process. Specifically, disabling the "User Registration allowed" option only hid the registration button on the login page, but it did not prevent direct access to the registration URL (/ui/login/loginname).

**Weaknesses/Vulnerabilities Present:**
- **Insufficient Access Control:** The primary vulnerability is the lack of proper access control. The application failed to enforce the "User Registration allowed" setting at the URL level, allowing users to bypass the intended restriction.
- **UI-Based Security:** Relying solely on hiding the registration button on the UI was insufficient for security, as the underlying functionality was still accessible via direct URL manipulation.

**Impact of Exploitation:**
- **Bypass of Intended Security Controls:** Attackers could bypass the administrator's attempt to disable self-registration and create new user accounts, despite the configuration.
- **Potential for Unauthorized Access:** The exploitation could lead to unauthorized user accounts being created within the system, which can be further used for malicious activities.
- **Compromised System Integrity:** The ability to bypass registration controls compromises the integrity of the user management system, potentially leading to further security breaches.

**Attack Vectors:**
- **Direct URL Access:** Attackers could bypass the registration setting by directly accessing the registration URL: `/ui/login/loginname`

**Required Attacker Capabilities/Position:**
- **No Special Privileges Required:** The attacker does not require any special privileges to exploit the vulnerability.
- **Network Access:** The attacker only needs network access to the application to reach the vulnerable URL.

**Additional Information:**
- The vulnerability is addressed in versions 2.58.7, 2.59.5, 2.60.4, 2.61.4, 2.62.7, 2.63.5, and 2.64.0 and later.
- The CVSS score is 7.5, categorized as "High" severity. The vector is CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, indicating a network-based attack with low complexity, no required privileges or user interaction, and high confidentiality impact.

This content provides much more detail than the official CVE description, including the specific vulnerable URL, the nature of the bypass, and the affected/patched versions.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | sparse | 0.527 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.523 |
| 3 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | sparse | 0.520 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.518 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.515 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.498 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.498 |
| 8 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.493 |
| 9 | 842 | Placement of User into Incorrect Group | Base | Allowed | dense | 0.451 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

