## Vulnerability Description
The 140+ Widgets | Xpro Addons For Elementor FREE plugin for WordPress is vulnerable to **Sensitive Information Exposure** in all versions up to, and including, 1.4.6 via the render function in widgets/content-toggle/layout/frontend.php. This makes it possible for authenticated attackers, with Contributor-level access and above, to extract sensitive private, pending, and draft template data.

### Vulnerability Description Key Phrases
- **weakness:** **Sensitive Information Exposure**
- **impact:** extract sensitive private, pending, and draft template data
- **attacker:** authenticated attackers with Contributor-level access and above
- **product:** 140+ Widgets | Xpro Addons For Elementor FREE
- **version:** all versions up to and including 1.4.6
- **component:** render function in widgets/content-toggle/layout/frontend.php

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-10319

**Root Cause of Vulnerability:**
The vulnerability stems from the `render` function in the `widgets/content-toggle/layout/frontend.php` file of the "140+ Widgets | Xpro Addons For Elementor" WordPress plugin. The plugin did not properly check access permissions for Elementor templates when rendering the content toggle widget.

**Weaknesses/Vulnerabilities Present:**
- **Sensitive Information Exposure:** The primary vulnerability is the exposure of sensitive information. The plugin retrieves and renders content from Elementor templates without validating if the current user has permissions to view them. This includes unpublished drafts, pending, and private templates.
- **Inadequate Access Control:** The code fails to properly check the user's capabilities before displaying content of Elementor templates.

**Impact of Exploitation:**
- An attacker with Contributor-level access or higher can view the content of private, pending, and draft Elementor templates by using the vulnerable content toggle widget.
- This could expose sensitive information that was intended to remain confidential, such as unreleased content, project plans, or other private data.

**Attack Vectors:**
- The attack vector is through the frontend rendering of the content toggle widget, where the vulnerability is located.
- An attacker needs to be an authenticated user with Contributor-level access or higher on the WordPress site.

**Required Attacker Capabilities/Position:**
-   **Authentication:** The attacker must have a valid user account on the WordPress site.
-   **Access Level:** The attacker needs to have at least the Contributor role, granting them the ability to create and edit posts.

**Additional Information:**
-   The vulnerability was fixed in version 1.4.6.1 of the plugin.
-   The vulnerable code is located within the `widgets/content-toggle/layout/frontend.php` file, specifically where the plugin handles the rendering of content from Elementor templates within the content toggle widget.
-   The fix involved adding checks to ensure only published content is displayed to users. The patched code retrieves the template's post status and only renders the template if its status is 'publish'. Additionally, it adds checks to display a message to users if the template is not published or if they do not have permission to view it.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.320 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.316 |
| 3 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.314 |
| 4 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.305 |
| 5 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.303 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.302 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.298 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.298 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.532 |
| 10 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-863: Incorrect Authorization

CWE-862: Missing Authorization

CWE-284: Improper Access Control

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-285: Improper Authorization

CWE-306: Missing Authentication for Critical Function

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-1275: Sensitive Cookie with Improper SameSite Attribute