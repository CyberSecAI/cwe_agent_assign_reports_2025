# Vulnerability Information: CVE-2025-47884

## Vulnerability Description
In Jenkins OpenID Connect Provider Plugin 96.vee8ed882ec4d and earlier the generation of build ID Tokens uses potentially overridden values of environment variables, in conjunction with certain other plugins allowing attackers able to configure jobs to craft a build ID Token that impersonates a trusted job, potentially gaining unauthorized access to external services.

### Vulnerability Description Key Phrases
- **rootcause:** **overridden environment variables**
- **impact:** unauthorized access to external services
- **attacker:** attackers
- **product:** Jenkins OpenID Connect Provider Plugin
- **version:** 96.vee8ed882ec4d and earlier

## CVE Reference Links Content Summary
## Analysis of CVE-2025-47884 based on provided content:

**CVE Description:** Insufficient validation of claims in OpenID Connect Provider Plugin

**1. Verification:** The content directly relates to CVE-2025-47884 as identified by both the Jenkins security advisory and the plugin documentation.

**2. Extracted Information:**

*   **Root cause of vulnerability:** Claim templates in the OpenID Connect Provider Plugin can use environment variables for dynamic content. The default claim template for build ID tokens uses the `JOB_URL` environment variable for the `sub` (Subject) claim. Prior to version 111.v29fd614b\_3617, the generation of build ID Tokens used potentially overridden values of environment variables.
*   **Weaknesses/vulnerabilities present:** Insufficient input validation, specifically regarding environment variables used in claim templates. This allows for potential impersonation of trusted jobs.
*   **Impact of exploitation:** Attackers able to configure jobs can craft a build ID Token that impersonates a trusted job, potentially gaining unauthorized access to external services.
*   **Attack vectors:** Exploitation occurs when an attacker can configure Jenkins jobs and leverage plugins (like Environment Injector Plugin) that allow overriding environment variables.
*   **Required attacker capabilities/position:** An attacker needs to be able to configure Jenkins jobs.
*   **Mitigation or fix:** Update the OpenID Connect Provider Plugin to version 111.v29fd614b\_3617 or later. This version ignores environment variables if they have been overridden during build ID Token generation.

**3. Additional Details:**

*   The content provides more detail than the CVE description alone, explaining the specific environment variable (`JOB_URL`) and the role of plugins like Environment Injector in enabling the vulnerability.
*   The advisory also mentions the CVSS score (Critical) and affected versions (up to and including 96.vee8ed882ec4d).
*   The advisory credits Jesse Glick (CloudBees, Inc.) for reporting the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.309 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.292 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.280 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.273 |
| 5 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | Allowed | sparse | 0.270 |
| 6 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.269 |
| 7 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.264 |
| 8 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.263 |
| 9 | 526 | Cleartext Storage of Sensitive Information in an Environment Variable | Variant | Allowed | dense | 0.492 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |

