# Vulnerability Information: CVE-2024-47092

## Vulnerability Description
Insecure deserialization and improper certificate validation in Checkmk Exchange plugin check-mk-api prior to 5.8.1

### Vulnerability Description Key Phrases
- **rootcause:** **improper certificate validation, insecure deserialization**
- **product:** Checkmk Exchange plugin check-mk-api
- **version:** prior to 5.8.1

## CVE Reference Links Content Summary
## Analysis of CVE-2024-47092 related content

The provided content discusses Check\_MK Python API packages and related tools (data2label, data2tag). The key finding is a commit message indicating a security improvement:

**Root cause of vulnerability:**

The commit message "replaces eval() with ast.literal\_eval()" indicates that the code previously used `eval()`, which can execute arbitrary code if the input is not carefully controlled. This is a known security risk.

**Weaknesses/vulnerabilities present:**

*   **Use of `eval()`:** The original code used `eval()`, which is inherently dangerous when processing untrusted input. `eval()` allows execution of arbitrary Python code, potentially leading to remote code execution (RCE) if an attacker can control the input to `eval()`.

**Impact of exploitation:**

*   **Remote Code Execution (RCE):** If an attacker could control the input to the `eval()` function, they could execute arbitrary code on the server running the Check\_MK API.

**Attack vectors:**

*   The attack vector depends on where the input to `eval()` comes from. Based on the code snippets, the input appears to come from configuration files (e.g., `args.config` in `data2label.py`). An attacker could potentially modify these configuration files to inject malicious code.

**Required attacker capabilities/position:**

*   The attacker needs to be able to modify configuration files accessible to the Check\_MK API. This could require file system access or the ability to upload/modify configuration files through a vulnerable interface.

**Mitigation or fix:**

*   **Replacing `eval()` with `ast.literal_eval()`:** The commit replaces `eval()` with `ast.literal_eval()`. `ast.literal_eval()` safely evaluates a string containing a Python literal (e.g., a string, number, list, dictionary) without executing arbitrary code. This significantly reduces the risk of RCE.

**Additional Details:**

The content provides more detail than the official CVE description would likely contain, specifically pinpointing the code change and the reason for it. The commit affects multiple files within the `check_mk_api`, `data2label`, and `data2tag` projects.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.135 |
| 2 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.122 |
| 3 | 296 | Improper Following of a Certificate's Chain of Trust | Base | Allowed | sparse | 0.110 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.110 |
| 5 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.108 |
| 6 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | Allowed | sparse | 0.105 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.097 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.096 |
| 9 | 299 | Improper Check for Certificate Revocation | Base | Allowed | dense | 0.530 |
| 10 | 298 | Improper Validation of Certificate Expiration | Variant | Allowed | graph | 0.002 |

