# Vulnerability Information: CVE-2024-12894

## Vulnerability Description
A vulnerability, which was classified as critical, was found in TreasureHuntGame TreasureHunt up to 963e0e0. Affected is an unknown function of the file TreasureHunt/acesso.php. The manipulation of the argument usuario leads to **sql injection**. It is possible to launch the attack remotely. This product is using a rolling release to provide continious delivery. Therefore, no version details for affected nor updated releases are available. The name of the patch is 8bcc649abc35b7734951be084bb522a532faac4e. It is recommended to apply a patch to fix this issue.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **vector:** manipulation of the argument usuario
- **product:** TreasureHuntGame TreasureHunt
- **version:** up to 963e0e0
- **component:** TreasureHunt/acesso.php

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-12894. It shows a commit that fixes a SQL injection vulnerability in `acesso.php` and `checkflag.php` files.

- **Root cause of vulnerability**: The vulnerability was caused by directly embedding unsanitized user-controlled input into SQL queries, specifically in the `$usuario` and `$problema` variables.
- **Weaknesses/vulnerabilities present**: SQL injection vulnerability.
- **Impact of exploitation**: An attacker could manipulate the SQL queries by injecting malicious code, potentially allowing them to access or modify sensitive data, bypass authentication, or perform other unauthorized actions.
- **Attack vectors**: By injecting malicious SQL code through the `usuario` and `problema` POST parameters.
- **Required attacker capabilities/position**: The attacker needs to be able to make HTTP POST requests to `acesso.php` and `checkflag.php` with malicious SQL code injected in the `usuario` or `problema` parameters.

The commit replaces the vulnerable code:
```php
$usuario = filter_input(INPUT_POST, 'usuario');
$sql = "SELECT * FROM Usuario where id='$usuario'";
```
with:
```php
$usuario = filter_input(INPUT_POST, 'usuario', FILTER_SANITIZE_NUMBER_INT);
$sql = "SELECT * FROM Usuario where id=:usuario";
```
and
```php
$problema = filter_input(INPUT_POST, 'problema');
```
with:
```php
$problema = filter_input(INPUT_POST, 'problema', FILTER_SANITIZE_NUMBER_INT);
```
This sanitizes the input to prevent the injection.
Additionally, it changes to use prepared statements which helps prevent injection attacks.

The provided content offers more detail than the basic CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.559 |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.483 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.471 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.460 |
| 6 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.459 |
| 7 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.457 |
| 8 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.454 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.570 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |

