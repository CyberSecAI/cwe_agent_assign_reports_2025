# Vulnerability Information: CVE-2024-49753

## Vulnerability Description
Zitadel is open-source identity infrastructure software. Versions prior to 2.64.1, 2.63.6, 2.62.8, 2.61.4, 2.60.4, 2.59.5, and 2.58.7 have a flaw in the URL validation mechanism of Zitadel actions allows bypassing restrictions intended to block requests to localhost (127.0.0.1). The isHostBlocked check, designed to prevent such requests, can be circumvented by creating a DNS record that resolves to 127.0.0.1. This enables actions to send requests to localhost despite the intended security measures. This vulnerability potentially allows unauthorized access to unsecured internal endpoints, which may contain sensitive information or functionalities. Versions 2.64.1, 2.63.6, 2.62.8, 2.61.4, 2.60.4, 2.59.5, and 2.58.7 contain a patch. No known workarounds are available.

### Vulnerability Description Key Phrases
- **rootcause:** **flaw in URL validation mechanism**
- **impact:** bypass restrictions to localhost
- **product:** Zitadel
- **version:** prior to 2.64.1, 2.63.6, 2.62.8, 2.61.4, 2.60.4, 2.59.5, and 2.58.7

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The URL validation mechanism in Zitadel actions can be bypassed by creating a DNS record that resolves to 127.0.0.1. The isHostBlocked check, intended to block requests to localhost (127.0.0.1), is circumvented.",
    "weaknesses": [
      "Insufficient validation of hostnames in URL requests within Zitadel actions.",
      "The application relies on a simple check for IP addresses to block localhost, which is bypassed by using a custom DNS entry that resolves to a local IP."
    ],
    "impact": "Unauthorized access to internal endpoints, potentially exposing sensitive information or functionalities by allowing actions to send requests to localhost or other restricted IPs via a DNS bypass.",
     "attack_vectors": [
        "Network",
        "The vulnerability can be exploited remotely by an attacker by controlling a DNS record."
    ],
    "required_capabilities": "An attacker needs the ability to create a DNS record that resolves to 127.0.0.1 and also needs high privileges within Zitadel to define and use actions.",
       "additional_info": "The vulnerability allows bypassing restrictions designed to prevent actions from making requests to localhost. By creating a DNS record resolving to 127.0.0.1, an attacker can trick Zitadel's actions into sending requests to this address, potentially accessing sensitive debug endpoints and exfiltrating data. The fix involves improving the host validation to account for DNS-based bypasses. The provided content includes proof of concept code demonstrating the exploitation and its fix."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.640 |
| 2 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.638 |
| 3 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | sparse | 0.637 |
| 4 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.634 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.624 |
| 6 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.622 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.617 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.612 |
| 9 | 306 | Missing Authentication for Critical Function | Base | Allowed | dense | 0.521 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |

