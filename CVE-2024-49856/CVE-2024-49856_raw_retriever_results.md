# Raw Retriever Results for CVE-2024-49856

# Raw Retriever Results for CVE-2024-49856
## Query
In the Linux kernel, the following vulnerability has been resolved x86/sgx Fix deadlock in SGX NUMA node search When the current node doesnt have an EPC section configured by firmware and all other EPC sections are used up, CPU can get stuck inside the while loop that looks for an available EPC page from remote nodes indefinitely, leading to a soft lockup. Note how nid_of_current will never be equal to nid in that while loop because nid_of_current is not set in sgx_numa_mask. Also worth mentioning is that its perfectly fine for the firmware not to setup an EPC section on a node. While setting up an EPC section on each node can enhance performance, it is not a requirement for functionality. Rework the loop to start and end on *a* node that has SGX memory. This avoids the deadlock looking for the current SGX-lacking node to show up in the loop when it never will.

## Keyphrases
- **rootcause**: 'deadlock in SGX NUMA node search'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4679 | 0.5298 | 0.4955 | 0.4896 | 20 |
| Sparse | 248.0464 | 837.3182 | 748.2760 | 797.7430 | 11 |
| Graph | 1.0062 | 2.5507 | 1.6586 | 1.5265 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 789 | Memory Allocation with Excessive Size Value | variant | 2.5507 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.3296 | Allowed |
| 3 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | base | 2.3296 | Allowed |
| 4 | 410 | Insufficient Resource Pool | base | 2.2100 | Allowed |
| 5 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | base | 2.2100 | Allowed |
| 6 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | base | 2.1190 | Allowed |
| 7 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.7784 | Allowed |
| 8 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 9 | 833 | Deadlock | Base | 1.6701 | Allowed |
| 10 | 129 | Improper Validation of Array Index | variant | 1.5552 | Allowed |
| 11 | 413 | Improper Resource Locking | Base | 1.4979 | Allowed |
| 12 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 1.4971 | Allowed |
| 13 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | 1.4954 | Allowed |
| 14 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 1.4944 | Allowed |
| 15 | 400 | Uncontrolled Resource Consumption | class | 1.3216 | Discouraged |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5298 | 0.5298 | Allowed |
| 2 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5220 | 0.5220 | Allowed |
| 3 | 413 | Improper Resource Locking | Base | 0.5193 | 0.5193 | Allowed |
| 4 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | 0.5143 | 0.5143 | Allowed |
| 5 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.5138 | 0.5138 | Allowed |
| 6 | 667 | Improper Locking | Class | 0.5116 | 0.5116 | Allowed-with-Review |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5079 | 0.5079 | Allowed |
| 8 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | Variant | 0.5072 | 0.5072 | Allowed |
| 9 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.4928 | 0.4928 | Allowed |
| 10 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4903 | 0.4903 | Allowed |
| 11 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.4890 | 0.4890 | Allowed |
| 12 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4874 | 0.4874 | Allowed |
| 13 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4863 | 0.4863 | Allowed |
| 14 | 909 | Missing Initialization of Resource | Class | 0.4853 | 0.4853 | Allowed-with-Review |
| 15 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4846 | 0.4846 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 837.3182 | 837.3182 | Allowed |
| 2 | 833 | Deadlock | 819.2201 | 819.2201 | Allowed |
| 3 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 810.6357 | 810.6357 | Allowed |
| 4 | 400 | Uncontrolled Resource Consumption | 808.5355 | 808.5355 | Discouraged |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 807.6618 | 807.6618 | Allowed |
| 6 | 295 | Improper Certificate Validation | 797.7430 | 797.7430 | Allowed |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | 794.5197 | 794.5197 | Allowed |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 777.5294 | 777.5294 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | 770.9985 | 770.9985 | Allowed |
| 10 | 863 | Incorrect Authorization | 758.8277 | 758.8277 | Allowed-with-Review |
| 11 | 197 | Numeric Truncation Error | 248.0464 | 248.0464 | Allowed |
