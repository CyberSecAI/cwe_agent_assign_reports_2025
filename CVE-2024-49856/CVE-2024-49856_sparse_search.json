{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved x86/sgx Fix deadlock in SGX NUMA node search When the current node doesnt have an EPC section configured by firmware and all other EPC sections are used up, CPU can get stuck inside the while loop that looks for an available EPC page from remote nodes indefinitely, leading to a soft lockup. Note how nid_of_current will never be equal to nid in that while loop because nid_of_current is not set in sgx_numa_mask. Also worth mentioning is that its perfectly fine for the firmware not to setup an EPC section on a node. While setting up an EPC section on each node can enhance performance, it is not a requirement for functionality. Rework the loop to start and end on *a* node that has SGX memory. This avoids the deadlock looking for the current SGX-lacking node to show up in the loop when it never will.",
  "keyphrases": {
    "rootcause": [
      "deadlock in SGX NUMA node search"
    ]
  },
  "timestamp": "2025-07-12 05:23:50",
  "cve_id": "CVE-2024-49856",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "score": 837.3181794989214,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 819.2201271842919,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "335",
      "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
      "score": 810.6357267139722,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "400",
      "name": "Uncontrolled Resource Consumption",
      "score": 808.5355371344863,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 807.661757018771,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "295",
      "name": "Improper Certificate Validation",
      "score": 797.7430187669961,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "score": 794.5196781406132,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "212",
      "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
      "score": 777.529387085506,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 770.9985257318865,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 758.8276855037665,
      "search_source": "rootcause:deadlock in SGX NUMA node search"
    },
    {
      "cwe_id": "197",
      "name": "Numeric Truncation Error",
      "score": 248.04640583948276,
      "search_source": "base_query"
    }
  ]
}