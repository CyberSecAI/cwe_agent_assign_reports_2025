{
  "cve_id": "CVE-2024-10203",
  "description": "Zohocorp ManageEngine EndPoint Central versions 11.3.2416.21 and below, 11.3.2428.9 and below are vulnerable to Arbitrary File Deletion in the agent installed machines.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "Arbitrary File Deletion",
    "vector": "",
    "attacker": "",
    "product": "Zohocorp ManageEngine EndPoint Central",
    "version": "11.3.2416.21 and below, 11.3.2428.9 and below",
    "component": "agent installed machines"
  },
  "reference_content": "Based on the provided content, here's a breakdown of the vulnerability:\n\n**Root Cause:**\n- The vulnerability lies within the \"archive logs feature\" of the agent tray icon in ManageEngine Endpoint Central. This feature could be exploited to delete files from directories that the user should not have access to.\n\n**Weaknesses/Vulnerabilities:**\n- **Arbitrary File Deletion:** The vulnerability allows for the deletion of files from arbitrary locations, even those the user does not have explicit permissions for.\n- **Privilege Escalation:** The ability to delete arbitrary files could be leveraged to achieve privilege escalation.\n\n**Impact of Exploitation:**\n- Arbitrary file deletion, which could lead to system instability or data loss.\n- Privilege escalation, potentially allowing an attacker to gain unauthorized control of the system.\n\n**Attack Vectors:**\n- Physical access to the device is required for exploitation. The exploit is triggered via the agent tray icon, which implies a user with console access to a system that has the vulnerable agent installed.\n\n**Required Attacker Capabilities/Position:**\n- The attacker needs physical access to the device with the affected ManageEngine Endpoint Central agent installed.\n- The attacker would need to interact with the agent tray icon.\n\n**Additional Notes:**\n- The vulnerability affects both On-Premises and Cloud versions of ManageEngine Endpoint Central.\n- The fix is delivered via a Patch Program Module (PPM) update, and specific build numbers are provided for applying the update.\n- The vulnerability was reported through the Zoho Corp bug bounty program.\n- The severity is rated as \"High\".",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-73 | External Control of File Name or Path | 0.8 | Base | Allowed | Primary CWE: The product allows user input to control or influence paths or file names that are used in filesystem operations. |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.7 | Base | Allowed | Secondary Candidate: The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.75\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary weakness is CWE-73, which indicates that user input influences file paths. A related weakness, CWE-22, describes path traversal, a specific case where the input allows accessing files outside the intended directory. CWE-22 is a parent of CWE-23 (Relative Path Traversal) which was also in the results. The base level of abstraction is appropriate for both selected CWEs, as they directly describe the **root cause** of the vulnerability.\n\n```mermaid\ngraph TD\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n    cwe23[\"CWE-23: Relative Path Traversal\"]\n\n    cwe22 -->|CHILDOF| cwe73\n    cwe23 -->|CHILDOF| cwe22\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe73 primary\n    class cwe22 secondary\n    class cwe23 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with CWE-73 where external input is used to control file names or paths, leading to CWE-22, path traversal, which then results in arbitrary file deletion.\n\n## Summary of Analysis\nThe analysis is primarily based on the vulnerability description and the CVE Reference Links Content Summary. The key evidence is the **ability to delete files from directories that the user should not have access to** via the \"archive logs feature\". This points towards CWE-73 (External Control of File Name or Path) as the primary **root cause**, because user input influences the file path being manipulated. CWE-22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) is included as a secondary CWE because it describes a specific type of uncontrolled path that allows the user to move outside the intended directory and therefore delete arbitrary files.\n\nThe relationship graph influenced the selection by illustrating how CWE-22 is more specific than CWE-73 and how CWE-23 is more specific than CWE-22. Given the information about the vulnerability, CWE-22 is the best fit here.\n\nThe selected CWEs are at an appropriate level of specificity, as they describe the technical weakness that leads to the arbitrary file deletion. Other CWEs, such as CWE-269 (Improper Privilege Management) and CWE-285 (Improper Authorization), are more general and don't capture the specific flaw related to path handling.\n\nCWE-285, CWE-269, CWE-732, CWE-425, CWE-276, CWE-59, CWE-668, CWE-497, CWE-267, CWE-471, CWE-78, CWE-602, CWE-1282, CWE-1272, CWE-434, CWE-41, and CWE-184 were considered but not selected. Most of these describe privilege management or access control issues but not the specific weakness of path manipulation.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-73 | External Control of File Name or Path | 0.8 | Base | Allowed | Primary CWE: The product allows user input to control or influence paths or file names that are used in filesystem operations. |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.7 | Base | Allowed | Secondary Candidate: The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.75\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary weakness is CWE-73, which indicates that user input influences file paths. A related weakness, CWE-22, describes path traversal, a specific case where the input allows accessing files outside the intended directory. CWE-22 is a parent of CWE-23 (Relative Path Traversal) which was also in the results. The base level of abstraction is appropriate for both selected CWEs, as they directly describe the **root cause** of the vulnerability.\n\n```mermaid\ngraph TD\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n    cwe23[\"CWE-23: Relative Path Traversal\"]\n\n    cwe22 -->|CHILDOF| cwe73\n    cwe23 -->|CHILDOF| cwe22\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe73 primary\n    class cwe22 secondary\n    class cwe23 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with CWE-73 where external input is used to control file names or paths, leading to CWE-22, path traversal, which then results in arbitrary file deletion.\n\n## Summary of Analysis\nThe analysis is primarily based on the vulnerability description and the CVE Reference Links Content Summary. The key evidence is the **ability to delete files from directories that the user should not have access to** via the \"archive logs feature\". This points towards CWE-73 (External Control of File Name or Path) as the primary **root cause**, because user input influences the file path being manipulated. CWE-22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) is included as a secondary CWE because it describes a specific type of uncontrolled path that allows the user to move outside the intended directory and therefore delete arbitrary files.\n\nThe relationship graph influenced the selection by illustrating how CWE-22 is more specific than CWE-73 and how CWE-23 is more specific than CWE-22. Given the information about the vulnerability, CWE-22 is the best fit here.\n\nThe selected CWEs are at an appropriate level of specificity, as they describe the technical weakness that leads to the arbitrary file deletion. Other CWEs, such as CWE-269 (Improper Privilege Management) and CWE-285 (Improper Authorization), are more general and don't capture the specific flaw related to path handling.\n\nCWE-285, CWE-269, CWE-732, CWE-425, CWE-276, CWE-59, CWE-668, CWE-497, CWE-267, CWE-471, CWE-78, CWE-602, CWE-1282, CWE-1272, CWE-434, CWE-41, and CWE-184 were considered but not selected. Most of these describe privilege management or access control issues but not the specific weakness of path manipulation.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-471:**\n- 471 (Modification of Assumed-Immutable Data (MAID)) - ROOT\n\n\n**Chain starting from CWE-269:**\n- 269 (Improper Privilege Management) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "source": "sparse"
      },
      "similarity": 53.26781783753126
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 51.0378684050012
    },
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "sparse"
      },
      "similarity": 50.59548666427134
    },
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "sparse"
      },
      "similarity": 49.667656469812904
    },
    {
      "metadata": {
        "doc_id": "602",
        "name": "Client-Side Enforcement of Server-Side Security",
        "source": "sparse"
      },
      "similarity": 47.52660383560669
    },
    {
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "source": "sparse"
      },
      "similarity": 47.27964027364847
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "source": "sparse"
      },
      "similarity": 47.252144971429715
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 46.58151200123331
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "type": "Base",
        "original_content": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.50788094075759,
            "graph": 1.7055473919790343
          }
        }
      },
      "similarity": 0.50788094075759
    },
    {
      "doc_id": "471",
      "text": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "471",
        "name": "Modification of Assumed-Immutable Data (MAID)",
        "type": "base",
        "original_content": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
        "relationships": [
          {
            "source_id": "471",
            "target_id": "621",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "607",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "602",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "473",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "425",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "291",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1321",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1282",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "471",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "621",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "607",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "602",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "473",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "425",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "291",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1321",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1282",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "602",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "602"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "602",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "602"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-471",
      "CWE-269",
      "CWE-285",
      "CWE-184",
      "CWE-73",
      "CWE-267",
      "CWE-1272",
      "CWE-276",
      "CWE-23",
      "CWE-425",
      "CWE-1282",
      "CWE-41",
      "CWE-434",
      "CWE-59",
      "CWE-668",
      "CWE-78",
      "CWE-602",
      "CWE-732",
      "CWE-22",
      "CWE-497"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}