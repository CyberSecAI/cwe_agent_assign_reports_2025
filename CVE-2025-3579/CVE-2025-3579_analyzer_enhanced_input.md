## Vulnerability Description
In versions prior to Aidex 1.7, an authenticated malicious user, taking advantage of an **open registry**, could execute unauthorised commands within the system. This includes executing operating system (Unix) commands, interacting with internal services such as PHP or MySQL, and even invoking native functions of the framework used, such as Laravel or Symfony. This execution is achieved by **Prompt Injection** attacks through the /api//message endpoint, manipulating the content of the content parameter.

### Vulnerability Description Key Phrases
- **component:** /api//message endpoint
- **rootcause:** **open registry**
- **weakness:** **Prompt Injection**
- **product:** Aidex
- **impact:** execute unauthorised commands within the system, execute operating system (Unix) commands, interacting with internal services such as PHP or MySQL, invoking native functions of the framework used, such as Laravel or Symfony
- **attacker:** authenticated malicious user
- **version:** prior to 1.7

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3579 Content

This content is **RELEVANT** to CVE-2025-3579. It provides detailed information about the vulnerability.

**Root cause of vulnerability:**

The vulnerability stems from Prompt Injection attacks through the `/api/<string-chat>/message` endpoint, specifically manipulating the ‘content’ parameter.

**Weaknesses/vulnerabilities present:**

*   **CVE-2025-3579:** An authenticated malicious user can execute unauthorized commands within the system due to an open registry. This includes executing operating system (Unix) commands, interacting with internal services (PHP, MySQL), and invoking native framework functions (Laravel, Symfony).
*   The underlying weakness is improper input validation and sanitization within the LLM chatbot, allowing for code injection via crafted prompts.

**Impact of exploitation:**

*   Execution of arbitrary operating system commands.
*   Interaction with internal services like PHP and MySQL.
*   Invocation of native framework functions.
*   Potential for full system compromise.

**Attack vectors:**

*   Prompt Injection attacks via the `/api/<string-chat>/message` endpoint.
*   Manipulation of the ‘content’ parameter in the API request.
*   Requires an authenticated user account.

**Required attacker capabilities/position:**

*   Authenticated user account.
*   Understanding of Prompt Injection techniques.
*   Ability to craft malicious prompts.
*   Knowledge of the underlying system (Unix, PHP, MySQL, Laravel/Symfony) is beneficial for maximizing impact.

**Mitigation or fix:**

*   Upgrade to AiDex version 1.7 or later, which includes the fix for this vulnerability.

**Additional Details (more than official CVE description):**

*   The content provides the CVSS v4.0 score (9.3) and vector string.
*   It also links the vulnerability to CWE-94 (Improper Control of Generation of Code ('Code Injection')).
*   The advisory also details CVE-2025-3578, a related vulnerability affecting the same product.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | Allowed | alternate_terms | 1.000 |
| 2 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.400 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.393 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.391 |
| 5 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.382 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.377 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.376 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.374 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.603 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1427: Improper Neutralization of Input Used for LLM Prompting

CWE-502: Deserialization of Untrusted Data

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')