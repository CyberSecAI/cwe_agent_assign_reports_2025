# Raw Retriever Results for CVE-2025-46333

# Raw Retriever Results for CVE-2025-46333
## Query
z2d is a pure Zig 2D graphics library. Versions of z2d after `0.5.1` and up to and including `0.6.0`, when writing from one surface to another using `z2d.compositor.StrideCompositor.run`, and higher-level operations when the anti-aliasing mode is set to `.default` (such as `Context.fill`, `Context.stroke`, `painter.fill`, and `painter.stroke`), the source surface can be completely out-of-bounds on the x-axis, but not on the y-axis, by way of a negative offset. This results in an overflow of the value controlling the length of the stride. In non-safe optimization modes (consumers compiling with `ReleaseFast` or `ReleaseSmall`), this could potentially lead to invalid memory accesses or corruption. This issue is patched in version `0.6.1`. Users on an untagged version after `v0.5.1` and before `v0.6.1` are advised to update to address the vulnerability. Those still on Zig `0.13.0` are recommended to downgrade to `v0.5.1`.

## Keyphrases
- **weakness**: 'overflow of the value controlling the length of the stride'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3799 | 0.4264 | 0.3972 | 0.3934 | 20 |
| Sparse | 260.4740 | 871.1125 | 731.6050 | 810.0384 | 12 |
| Graph | 1.6016 | 2.7920 | 2.0325 | 1.9603 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 823 | Use of Out-of-range Pointer Offset | Base | 2.7920 | Allowed |
| 2 | 125 | Out-of-bounds Read | Base | 2.7833 | Allowed |
| 3 | 787 | Out-of-bounds Write | Base | 2.7743 | Allowed |
| 4 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 5 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 6 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 7 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 8 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 9 | 123 | Write-what-where Condition | base | 2.0228 | Allowed |
| 10 | 190 | Integer Overflow or Wraparound | Base | 1.9804 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.9402 | Allowed |
| 12 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 13 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 14 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 15 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4264 | 0.4264 | Allowed |
| 2 | 194 | Unexpected Sign Extension | Variant | 0.4257 | 0.4257 | Allowed |
| 3 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4137 | 0.4137 | Allowed |
| 4 | 126 | Buffer Over-read | Variant | 0.4127 | 0.4127 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4114 | 0.4114 | Allowed |
| 6 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.4110 | 0.4110 | Allowed |
| 7 | 125 | Out-of-bounds Read | Base | 0.4051 | 0.4051 | Allowed |
| 8 | 190 | Integer Overflow or Wraparound | Base | 0.4038 | 0.4038 | Allowed |
| 9 | 122 | Heap-based Buffer Overflow | Variant | 0.4011 | 0.4011 | Allowed |
| 10 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4001 | 0.4001 | Allowed |
| 11 | 1335 | Incorrect Bitwise Shift of Integer | Base | 0.3867 | 0.3867 | Allowed |
| 12 | 457 | Use of Uninitialized Variable | Variant | 0.3855 | 0.3855 | Allowed |
| 13 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.3851 | 0.3851 | Allowed |
| 14 | 197 | Numeric Truncation Error | Base | 0.3849 | 0.3849 | Allowed |
| 15 | 476 | NULL Pointer Dereference | Base | 0.3846 | 0.3846 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | 871.1125 | 871.1125 | Allowed |
| 2 | 125 | Out-of-bounds Read | 861.2354 | 861.2354 | Allowed |
| 3 | 122 | Heap-based Buffer Overflow | 848.8184 | 848.8184 | Allowed |
| 4 | 190 | Integer Overflow or Wraparound | 844.9231 | 844.9231 | Allowed |
| 5 | 787 | Out-of-bounds Write | 817.3259 | 817.3259 | Allowed |
| 6 | 681 | Incorrect Conversion between Numeric Types | 815.5481 | 815.5481 | Allowed |
| 7 | 20 | Improper Input Validation | 804.5286 | 804.5286 | Discouraged |
| 8 | 789 | Memory Allocation with Excessive Size Value | 801.1052 | 801.1052 | Allowed |
| 9 | 863 | Incorrect Authorization | 797.5992 | 797.5992 | Allowed-with-Review |
| 10 | 126 | Buffer Over-read | 794.2518 | 794.2518 | Allowed |
| 11 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 262.3382 | 262.3382 | Allowed |
| 12 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 260.4740 | 260.4740 | Allowed-with-Review |
