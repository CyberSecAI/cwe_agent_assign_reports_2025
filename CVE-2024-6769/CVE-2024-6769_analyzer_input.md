# Vulnerability Information: CVE-2024-6769

## Vulnerability Description
A **DLL Hijacking** caused by drive remapping combined with a poisoning of the activation cache in Microsoft Windows 10, Windows 11, Windows Server 2016, Windows Server 2019, and Windows Server 2022 allows a malicious authenticated attacker to elevate from a medium integrity process to a high integrity process without the intervention of a UAC prompt.

### Vulnerability Description Key Phrases
- **rootcause:** **DLL Hijacking caused by drive remapping combined with poisoning of activation cache**
- **weakness:** **DLL Hijacking**
- **impact:** elevate from medium integrity process to high integrity process
- **attacker:** malicious authenticated attacker
- **product:** Microsoft Windows
- **version:** 10 and 11 and Server 2016 and Server 2019 and Server 2022

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "A combination of DLL hijacking and activation cache poisoning.",
  "Weaknesses/vulnerabilities present": [
    "DLL Hijacking: The remapping of the ROOT drive allows for the redirection of library loading to user-controlled locations.",
    "Activation Cache Poisoning: The ability to manipulate the Activation Context Cache allows for the loading of attacker-controlled DLLs in high-integrity processes."
  ],
  "Impact of exploitation": "Elevation of privileges from a medium integrity process to a high integrity process with full administrator privileges. This allows the attacker to perform privileged actions, such as installing programs, writing to protected folders and dropping crafted DLLs into system folders.",
  "Attack vectors": "The attacker remaps the root drive, causing a high-integrity process (CTFMON) to load a malicious DLL from a user-controlled directory. The attacker then exploits the Activation Cache by sending a specially crafted ALPC message to the CSRSS server. This message includes an embedded XML manifest with a specific language, triggering a search for an external manifest in a user-controlled 'tasks' subdirectory of system32. By controlling the content of both the embedded manifest and the external manifest, the attacker can manipulate a high-privilege process (TCMSETUP) to load a malicious DLL.",
    "Required attacker capabilities/position": "The attacker requires an initial foothold with medium integrity access and must belong to the administrator's group. The attacker must also be able to create files in the file system."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.442 |
| 2 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.382 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.369 |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.367 |
| 5 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.367 |
| 6 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.353 |
| 7 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.346 |
| 8 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | Allowed | sparse | 0.341 |
| 9 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | Allowed | dense | 0.550 |
| 10 | 363 | Race Condition Enabling Link Following | Base | Allowed | graph | 0.002 |

