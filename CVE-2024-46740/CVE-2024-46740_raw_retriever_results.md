# Raw Retriever Results for CVE-2024-46740

# Raw Retriever Results for CVE-2024-46740
## Query
In the Linux kernel, the following vulnerability has been resolved binder fix UAF caused by offsets overwrite Binder objects are processed and copied individually into the target buffer during transactions. Any raw data in-between these objects is copied as well. However, this raw data copy lacks an out-of-bounds check. If the raw data exceeds the data section size then the copy overwrites the offsets section. This eventually triggers an error that attempts to unwind the processed objects. However, at this point the offsets used to index these objects are now corrupted. Unwinding with corrupted offsets can result in decrements of arbitrary nodes and lead to their premature release. Other users of such nodes are left with a dangling pointer triggering a use-after-free. This issue is made evident by the following KASAN report (trimmed) ================================================================== BUG KASAN slab-use-after-free in _raw_spin_lock+0xe4/0x19c Write of size 4 at addr ffff47fc91598f04 by task binder-util/743 CPU 9 UID 0 PID 743 Comm binder-util Not tainted 6.11.0-rc4 #1 Hardware name linux,dummy-virt (DT) Call trace _raw_spin_lock+0xe4/0x19c binder_free_buf+0x128/0x434 binder_thread_write+0x8a4/0x3260 binder_ioctl+0x18f0/0x258c [...] Allocated by task 743 __kmalloc_cache_noprof+0x110/0x270 binder_new_node+0x50/0x700 binder_transaction+0x413c/0x6da8 binder_thread_write+0x978/0x3260 binder_ioctl+0x18f0/0x

## Keyphrases
- **rootcause**: 'offsets overwrite'
- **weakness**: 'use-after-free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5091 | 0.5556 | 0.5307 | 0.5277 | 20 |
| Sparse | 694.1117 | 1000.0000 | 769.3281 | 751.2117 | 13 |
| Graph | 1.6848 | 2.8652 | 2.1804 | 2.2018 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 2 | 787 | Out-of-bounds Write | base | 2.7196 | Allowed |
| 3 | 123 | Write-what-where Condition | base | 2.7014 | Allowed |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.7014 | Allowed-with-Review |
| 5 | 129 | Improper Validation of Array Index | variant | 2.6784 | Allowed |
| 6 | 193 | Off-by-one Error | Base | 2.4121 | Allowed |
| 7 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 8 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 9 | 839 | Numeric Range Comparison Without Minimum Check | base | 2.2100 | Allowed |
| 10 | 617 | Reachable Assertion | base | 2.2100 | Allowed |
| 11 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |
| 12 | 416 | Use After Free | Variant | 2.1699 | Allowed |
| 13 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 2.0745 | Allowed |
| 14 | 823 | Use of Out-of-range Pointer Offset | Base | 2.0701 | Allowed |
| 15 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7575 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.5556 | 0.5556 | Allowed-with-Review |
| 2 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.5548 | 0.5548 | Allowed |
| 3 | 823 | Use of Out-of-range Pointer Offset | Base | 0.5542 | 0.5542 | Allowed |
| 4 | 667 | Improper Locking | Class | 0.5478 | 0.5478 | Allowed-with-Review |
| 5 | 416 | Use After Free | Variant | 0.5461 | 0.5461 | Allowed |
| 6 | 126 | Buffer Over-read | Variant | 0.5454 | 0.5454 | Allowed |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5395 | 0.5395 | Allowed-with-Review |
| 8 | 908 | Use of Uninitialized Resource | Base | 0.5380 | 0.5380 | Allowed |
| 9 | 366 | Race Condition within a Thread | Base | 0.5367 | 0.5367 | Allowed |
| 10 | 822 | Untrusted Pointer Dereference | Base | 0.5327 | 0.5327 | Allowed |
| 11 | 413 | Improper Resource Locking | Base | 0.5227 | 0.5227 | Allowed |
| 12 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5210 | 0.5210 | Allowed |
| 13 | 911 | Improper Update of Reference Count | Base | 0.5208 | 0.5208 | Allowed |
| 14 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5191 | 0.5191 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5173 | 0.5173 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 416 | Use After Free | 1000.0000 | 1000.0000 | Allowed |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | 810.8942 | 810.8942 | Allowed |
| 3 | 823 | Use of Out-of-range Pointer Offset | 784.5546 | 784.5546 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 773.9598 | 773.9598 | Allowed-with-Review |
| 5 | 193 | Off-by-one Error | 761.1251 | 761.1251 | Allowed |
| 6 | 909 | Missing Initialization of Resource | 753.1867 | 753.1867 | Allowed-with-Review |
| 7 | 476 | NULL Pointer Dereference | 751.2117 | 751.2117 | Allowed |
| 8 | 190 | Integer Overflow or Wraparound | 750.0901 | 750.0901 | Allowed |
| 9 | 59 | Improper Link Resolution Before File Access ('Link Following') | 745.7027 | 745.7027 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | 743.0771 | 743.0771 | Allowed |
| 11 | 61 | UNIX Symbolic Link (Symlink) Following | 737.4958 | 737.4958 | Allowed |
| 12 | 401 | Missing Release of Memory after Effective Lifetime | 695.8563 | 695.8563 | Allowed |
| 13 | 770 | Allocation of Resources Without Limits or Throttling | 694.1117 | 694.1117 | Allowed |
