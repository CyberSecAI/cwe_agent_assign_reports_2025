# Raw Retriever Results for CVE-2024-50591

# Raw Retriever Results for CVE-2024-50591
## Query
An attacker with local access the to medical office computer can escalate his Windows user privileges to NT AUTHORITY\SYSTEM by exploiting a command injection vulnerability in the Elefant Update Service. The command injection can be exploited by communicating with the Elefant Update Service which is running as SYSTEM via Windows Named Pipes.The Elefant Software Updater (ESU) consists of two components. An ESU service which runs as NT AUTHORITY\SYSTEM and an ESU tray client which communicates with the service to update or repair the installation and is running with user permissions. The communication is implemented using named pipes. A crafted message of type MessageType.SupportServiceInfos can be sent to the local ESU service to inject commands, which are then executed as NT AUTHORITY\SYSTEM.

## Keyphrases
- **weakness**: 'command injection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4564 | 0.5544 | 0.4910 | 0.4855 | 20 |
| Sparse | 217.5798 | 1000.0000 | 655.7648 | 668.1786 | 13 |
| Graph | 1.2010 | 2.2100 | 1.5854 | 1.6100 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 2 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | base | 2.1762 | Allowed |
| 3 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0856 | Allowed |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 5 | 250 | Execution with Unnecessary Privileges | Base | 1.7060 | Allowed |
| 6 | 276 | Incorrect Default Permissions | Base | 1.6822 | Allowed |
| 7 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 1.6772 | Allowed |
| 8 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 9 | 427 | Uncontrolled Search Path Element | Base | 1.6642 | Allowed |
| 10 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 11 | 689 | Permission Race Condition During Resource Copy | compound | 1.6100 | Allowed |
| 12 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | 1.5027 | Allowed |
| 13 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | class | 1.4080 | Allowed-with-Review |
| 14 | 476 | NULL Pointer Dereference | base | 1.3676 | Allowed |
| 15 | 183 | Permissive List of Allowed Inputs | base | 1.3010 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | 0.5544 | 0.5544 | Allowed |
| 2 | 427 | Uncontrolled Search Path Element | Base | 0.5453 | 0.5453 | Allowed |
| 3 | 250 | Execution with Unnecessary Privileges | Base | 0.5434 | 0.5434 | Allowed |
| 4 | 520 | .NET Misconfiguration: Use of Impersonation | Variant | 0.5273 | 0.5273 | Allowed |
| 5 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 0.5094 | 0.5094 | Allowed-with-Review |
| 6 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.5089 | 0.5089 | Allowed |
| 7 | 269 | Improper Privilege Management | Class | 0.5031 | 0.5031 | Discouraged |
| 8 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 0.4971 | 0.4971 | Allowed |
| 9 | 67 | Improper Handling of Windows Device Names | Variant | 0.4969 | 0.4969 | Allowed |
| 10 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | 0.4962 | 0.4962 | Allowed |
| 11 | 40 | Path Traversal: '\\UNC\share\name\' (Windows UNC Share) | Variant | 0.4748 | 0.4748 | Allowed |
| 12 | 278 | Insecure Preserved Inherited Permissions | Variant | 0.4699 | 0.4699 | Allowed |
| 13 | 428 | Unquoted Search Path or Element | Base | 0.4684 | 0.4684 | Allowed |
| 14 | 29 | Path Traversal: '\..\filename' | Variant | 0.4668 | 0.4668 | Allowed |
| 15 | 28 | Path Traversal: '..\filedir' | Variant | 0.4639 | 0.4639 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 250 | Execution with Unnecessary Privileges | 711.8090 | 711.8090 | Allowed |
| 3 | 276 | Incorrect Default Permissions | 710.8718 | 710.8718 | Allowed |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 700.0000 | 700.0000 | Allowed |
| 5 | 269 | Improper Privilege Management | 684.7762 | 684.7762 | Discouraged |
| 6 | 732 | Incorrect Permission Assignment for Critical Resource | 669.4940 | 669.4940 | Allowed-with-Review |
| 7 | 427 | Uncontrolled Search Path Element | 668.1786 | 668.1786 | Allowed |
| 8 | 59 | Improper Link Resolution Before File Access ('Link Following') | 649.2114 | 649.2114 | Allowed |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | 635.2628 | 635.2628 | Allowed-with-Review |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | 633.5830 | 633.5830 | Allowed |
| 11 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 623.9008 | 623.9008 | Allowed |
| 12 | 20 | Improper Input Validation | 620.2748 | 620.2748 | Discouraged |
| 13 | 306 | Missing Authentication for Critical Function | 217.5798 | 217.5798 | Allowed |
