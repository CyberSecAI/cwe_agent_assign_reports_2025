# Vulnerability Information: CVE-2024-45792

## Vulnerability Description
Mantis Bug Tracker (MantisBT) is an open source issue tracker. Using a crafted POST request, an unprivileged, registered user is able to retrieve information about other users personal system profiles. This vulnerability is fixed in 2.26.4.

### Vulnerability Description Key Phrases
- **impact:** retrieve information about other users personal system profiles
- **vector:** crafted POST request
- **attacker:** unprivileged registered user
- **product:** Mantis Bug Tracker
- **version:** prior to 2.26.4

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Root Cause:**

The vulnerability is caused by an Insecure Direct Object Reference (IDOR) in the user profile functionality of MantisBT. Specifically, the `profile_id` parameter used when updating or viewing a user profile could be manipulated to access other user's profiles. There was a lack of proper authorization checks before accessing profile data.

**Weaknesses/Vulnerabilities:**

*   **Insecure Direct Object Reference (IDOR):** The application directly uses the `profile_id` parameter without verifying if the currently logged-in user is authorized to access the profile.
*   **Missing Authorization Checks:** The application failed to verify if the user requesting profile information was the owner of the profile or had sufficient privileges to access it.

**Impact of Exploitation:**

*   **Information Disclosure:** An unprivileged, registered user could view the private system profiles of other users, including their Platform, OS, OS version, and Description. This information could potentially be used for further attacks or social engineering.

**Attack Vectors:**

*   **Network:** The vulnerability can be exploited remotely over the network via crafted POST requests.
*   **Manipulated POST Request:** An attacker crafts a POST request to the profile update or edit page, manipulating the `profile_id` parameter to reference a profile belonging to another user.

**Required Attacker Capabilities/Position:**

*   **Registered User:** The attacker must have a valid user account on the MantisBT system.
*   **Knowledge of `profile_id`:** While not explicitly stated, the attacker needs some way to obtain valid `profile_id` values to exploit this, likely through enumeration.

**Additional details:**
*   The vulnerability existed since version 1.2.0, possibly before.
*   The issue was resolved by implementing new API functions `profile_can_update()` and `profile_ensure_can_update()` in `core/profile_api.php`. These functions are used in `account_prof_update.php` and `account_prof_edit_page.php` to enforce that a user can only view or update their own profiles or global profiles when authorized.
*   The vulnerability is rated as "Moderate" with a CVSS score of 4.3
*   The vulnerability is classified as CWE-200: Information Exposure.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.062 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.062 |
| 3 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.061 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.058 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.058 |
| 6 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.057 |
| 7 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.057 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.057 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.489 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |

