## Vulnerability Description
Toshiba printers will display the password of the admin user in clear-text and additional passwords when sending 2 specific HTTP requests to the internal API. An attacker stealing the cookie of an admin or abusing a **XSS vulnerability** can recover this password in clear-text and compromise the printer. This vulnerability can be executed in combination with other vulnerabilities and difficult to execute alone. So, the CVSS score for this vulnerability alone is lower than the score listed in the Base Score of this vulnerability. For detail on related other vulnerabilities, please ask to the below contact point. https//www.toshibatec.com/contacts/products/ As for the affected products/models/versions, see the reference URL.

### Vulnerability Description Key Phrases
- **weakness:** **XSS vulnerability**
- **impact:** display the password of the admin user in clear-text and additional passwords
- **vector:** 2 specific HTTP requests
- **attacker:** attacker stealing the cookie of an admin or abusing a XSS vulnerability
- **product:** Toshiba printers
- **component:** internal API

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-27163:

**1. Verification of CVE Relevance:**

The provided content explicitly lists CVE-2024-27163 and its description matches the official CVE description:
`Cleartext Transmission of Sensitive Information (CWE-319): Because some of the communication between the internal programs of the multifunction device is not encrypted, information can be stolen by a third party who has access to the multifunction device.`

**2. Extracted Vulnerability Information:**

*   **Root Cause:** The vulnerability stems from a lack of encryption in some internal communications within Toshiba Multi-Function Printers. Specifically, the admin password and other passwords are included in clear-text in the HTTP response from `/contentwebserver`. This endpoint is accessible through the network.
*   **Weaknesses:**
    *   Cleartext transmission of sensitive information during internal communications.
    *   Exposed API endpoint (`/contentwebserver`) returning passwords without any authentication, if an attacker knows the required parameters.
*   **Impact of Exploitation:** An attacker with network access to a vulnerable printer can retrieve the admin password and other passwords, leading to full compromise of the device and the ability to perform a wide range of malicious activities.
*   **Attack Vectors:**
    *   **Network-based:** An attacker must be able to send HTTP requests to a vulnerable printer.
    *   The attacker must be able to craft the requests to the `/contentwebserver` API, including a valid session cookie, and the specific XML payloads to trigger the leak.
    *   An attacker can also exploit an existing XSS vulnerability to steal session cookies.
*   **Attacker Capabilities/Position:**
    *   The attacker needs to be on the same network as the vulnerable printer or have network access to the printer, and must have knowledge of the vulnerable API endpoint and required XML structure and HTTP parameters.
    *   An attacker that has obtained a valid session cookie can also perform the attack from a different location, since the session cookie can be replayed.

**3. Additional Technical Details and Descriptions:**

The provided content gives substantial details beyond a simple CVE description. It specifies:

*   The specific XML payloads needed in the POST requests to trigger the password leak through the `/contentwebserver` API.
*   The fact that the passwords are sent in clear text.
*   The presence of a session cookie used to access the endpoint.
*   The method for retrieving the passwords in cleartext (using two HTTP requests to the `/contentwebserver` API).
*   The use of a XSS vulnerability to steal the admin cookie.

**4. Summary**

CVE-2024-27163 involves the leakage of admin passwords in cleartext within the HTTP response returned by the `/contentwebserver` API, due to lack of encryption in internal communications. An attacker can obtain this password by making a specific sequence of API calls to `/contentwebserver` with a valid session cookie, allowing for full compromise of the printer.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.616 |
| 3 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.609 |
| 4 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.595 |
| 5 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.588 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.586 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.584 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.584 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.553 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-522: Insufficiently Protected Credentials

CWE-256: Plaintext Storage of a Password

CWE-532: Insertion of Sensitive Information into Log File

CWE-306: Missing Authentication for Critical Function

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-259: Use of Hard-coded Password

CWE-73: External Control of File Name or Path