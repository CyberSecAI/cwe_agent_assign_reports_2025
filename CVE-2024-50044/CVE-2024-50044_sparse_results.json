{
  "query": "In the Linux kernel, the following vulnerability has been resolved Bluetooth RFCOMM FIX possible deadlock in rfcomm_sk_state_change rfcomm_sk_state_change attempts to use sock_lock so it must never be called with it locked but rfcomm_sock_ioctl always attempt to lock it causing the following trace ====================================================== WARNING possible circular locking dependency detected 6.8.0-syzkaller-08951-gfe46a7dd189e #0 Not tainted ------------------------------------------------------ syz-executor386/5093 is trying to acquire lock ffff88807c396258 (sk_lock-AF_BLUETOOTH-BTPROTO_RFCOMM){+.+.}-{00}, at lock_sock include/net/sock.h1671 [inline] ffff88807c396258 (sk_lock-AF_BLUETOOTH-BTPROTO_RFCOMM){+.+.}-{00}, at rfcomm_sk_state_change+0x5b/0x310 net/bluetooth/rfcomm/sock.c73 but task is already holding lock ffff88807badfd28 (&d->lock){+.+.}-{33}, at __rfcomm_dlc_close+0x226/0x6a0 net/bluetooth/rfcomm/core.c491",
  "count": 13,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 428.29452521235385,
      "original_score": 428.29452521235385,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "abstraction": "Base",
      "score": 403.7341956044806,
      "original_score": 403.7341956044806,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 336.9580665998309,
      "original_score": 336.9580665998309,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "764",
      "name": "Multiple Locks of a Critical Resource",
      "abstraction": "Base",
      "score": 324.40668180140995,
      "original_score": 324.40668180140995,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "score": 320.3048238316643,
      "original_score": 320.3048238316643,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 307.05177454692216,
      "original_score": 307.05177454692216,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "287",
      "name": "Improper Authentication",
      "abstraction": "Class",
      "score": 304.39905983668064,
      "original_score": 304.39905983668064,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "abstraction": "Base",
      "score": 303.65274521944264,
      "original_score": 303.65274521944264,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "61",
      "name": "UNIX Symbolic Link (Symlink) Following",
      "abstraction": "Compound",
      "score": 298.92836836695403,
      "original_score": 298.92836836695403,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "abstraction": "Base",
      "score": 292.606183847659,
      "original_score": 292.606183847659,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1390",
      "name": "Weak Authentication",
      "abstraction": "Class",
      "score": 97.31964138306512,
      "original_score": 97.31964138306512,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "674",
      "name": "Uncontrolled Recursion",
      "abstraction": "Class",
      "score": 96.97461657127407,
      "original_score": 96.97461657127407,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "306",
      "name": "Missing Authentication for Critical Function",
      "abstraction": "Base",
      "score": 96.65027810301977,
      "original_score": 96.65027810301977,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 96.65027810301977,
    "max": 428.29452521235385,
    "mean": 277.7908431480583,
    "median": 304.39905983668064,
    "count": 13
  }
}