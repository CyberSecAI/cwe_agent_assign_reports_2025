## Vulnerability Description
A vulnerability classified as problematic was found in b1gMail up to 7.4.1-pl1. Affected by this vulnerability is an unknown functionality of the file src/admin/users.php of the component Admin Page. The manipulation of the argument query/q leads to **deserialization**. The attack can be launched remotely. Upgrading to version 7.4.1-pl2 is able to address this issue. The identifier of the patch is 4816c8b748f6a5b965c8994e2cf10861bf6e68aa. It is recommended to upgrade the affected component. The vendor acted highly professional and even fixed this issue in the discontinued commercial edition as b1gMail 7.4.0-pl3.

### Vulnerability Description Key Phrases
- **weakness:** **deserialization**
- **vector:** manipulation of query/q argument
- **product:** b1gMail
- **version:** up to 7.4.1-pl1
- **component:** Admin Page in src/admin/users.php

## CVE Reference Links Content Summary
## CVE-2025-1741 Analysis - b1gMail Object Injection Vulnerability

The provided content details a PHP Object Injection vulnerability in b1gMail OSS, specifically affecting versions up to and including 7.4.1-pl1. The vulnerability has been addressed in version 7.4.1-pl2.

**Root cause of vulnerability:**

Deserialization of untrusted data via `unserialize($_REQUEST['query'])` in `src/admin/users.php` (line 228).

**Weaknesses/vulnerabilities present:**

*   CWE-502: Deserialization of Untrusted Data
*   CAPEC-586: Object Injection

**Impact of exploitation:**

Successful exploitation could lead to arbitrary file deletion (demonstrated by a PoC deleting `/var/www/b1gMail/src/now_you_see_me.txt`). Other attacks are possible depending on installed plugins and available gadget chains. While the vulnerable functionality is in an admin page, access is restricted to administrators, the vulnerability *may* be exploitable via XSS/CSRF due to the use of a GET request.

**Attack vectors:**

*   A GET request to `/admin/users.php` with a malicious `query` parameter containing a serialized PHP object.
*   Potentially via Cross-Site Scripting (XSS) or Cross-Site Request Forgery (CSRF).

**Required attacker capabilities/position:**

*   Administrator access to the b1gMail admin interface.
*   Knowledge of PHP object injection and available gadget chains (e.g., Smarty).

**Mitigation or fix:**

*   The vulnerability was fixed by replacing `unserialize()` with `json_decode()` in `src/admin/users.php`.
*   Alternatively, using the `allowed_classes` option with `unserialize()` to disable object injection (if object deserialization is necessary).

**Additional Details (more than official CVE description):**

*   The vulnerability was reported by mcdruid.
*   A Proof-of-Concept (PoC) exploit using a Smarty gadget chain is provided.
*   The vulnerable code is specifically located in `src/admin/users.php` at line 228.
*   The fix is available in version 7.4.1-pl2: [https://github.com/b1gMail-OSS/b1gMail/releases/tag/7.4.1-pl2](https://github.com/b1gMail-OSS/b1gMail/releases/tag/7.4.1-pl2)
*   The commit fixing the issue is: [https://github.com/b1gMail-OSS/b1gMail/commit/4816c8b748f6a5b965c8994e2cf10861bf6e68aa](https://github.com/b1gMail-OSS/b1gMail/commit/4816c8b748f6a5b965c8994e2cf10861bf6e68aa)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.677 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.623 |
| 3 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.576 |
| 4 | 334 | Small Space of Random Values | Base | Allowed | sparse | 0.560 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.545 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.536 |
| 7 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.532 |
| 8 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.530 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.530 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-502: Deserialization of Untrusted Data

CWE-334: Small Space of Random Values

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-306: Missing Authentication for Critical Function

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-184: Incomplete List of Disallowed Inputs