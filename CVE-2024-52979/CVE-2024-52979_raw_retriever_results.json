{
  "query": "Uncontrolled Resource Consumption in Elasticsearch while evaluating specifically crafted search templates with Mustache functions can lead to Denial of Service by causing the Elasticsearch node to crash.",
  "keyphrases": {
    "weakness": [
      "Uncontrolled Resource Consumption"
    ]
  },
  "timestamp": "2025-07-13T21:33:29.643694",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "911",
        "name": "Improper Update of Reference Count",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-911: Improper Update of Reference Count...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-1284: Improper Validation of Specified Quantity in Input...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-476: NULL Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "129",
        "name": "Improper Validation of Array Index",
        "abstraction": "variant",
        "score": 2.04,
        "description": "CWE-129: Improper Validation of Array Index...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1325",
        "name": "Improperly Controlled Sequential Memory Allocation",
        "abstraction": "Base",
        "score": 1.9693632834414438,
        "description": "The product manages a group of objects or resources and performs a separate memory allocation for each object, but it does not properly limit the total amount of memory that is consumed by all of the ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "41",
        "name": "Improper Resolution of Path Equivalence",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-41: Improper Resolution of Path Equivalence...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "823",
        "name": "Use of Out-of-range Pointer Offset",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-823: Use of Out-of-range Pointer Offset...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "abstraction": "Base",
        "score": 1.690033854907909,
        "description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the in...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "252",
        "name": "Unchecked Return Value",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-252: Unchecked Return Value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "772",
        "name": "Missing Release of Resource after Effective Lifetime",
        "abstraction": "Base",
        "score": 1.649456175036841,
        "description": "The product does not release a resource after its effective lifetime has ended, i.e., after the resource is no longer needed....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "abstraction": "Base",
        "score": 1.637955725380254,
        "description": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1067",
        "name": "Excessive Execution of Sequential Searches of Data Resource",
        "abstraction": "Base",
        "score": 1.6182968543001417,
        "description": "The product contains a data query against an SQL table or view\n\t\t\t\t\tthat is configured in a way that does not utilize an index and may cause\n\t\t\t\t\tsequential searches to be performed....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "410",
        "name": "Insufficient Resource Pool",
        "abstraction": "Base",
        "score": 1.546117022604983,
        "description": "The product's resource pool is not large enough to handle peak demand, which allows an attacker to prevent others from accessing the resource by using a (relatively) large number of requests for resou...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1339",
        "name": "Insufficient Precision or Accuracy of a Real Number",
        "abstraction": "base",
        "score": 1.5350400000000004,
        "description": "CWE-1339: Insufficient Precision or Accuracy of a Real Number...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "abstraction": "Variant",
        "score": 1.514874496145719,
        "description": "The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 1.4967005297979852,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "abstraction": "Base",
        "score": 1.4814888543076776,
        "description": "The product uses a template engine to insert or process externally-influenced input, but it does not neutralize or incorrectly neutralizes special elements or syntax that can be interpreted as templat...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "base",
        "score": 1.3676000000000001,
        "description": "CWE-125: Out-of-bounds Read...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "787",
        "name": "Out-of-bounds Write",
        "abstraction": "base",
        "score": 1.3676000000000001,
        "description": "CWE-787: Out-of-bounds Write...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "405",
        "name": "Asymmetric Resource Consumption (Amplification)",
        "abstraction": "Class",
        "score": 0.48400308469933545,
        "description": "The product does not properly control situations in which an adversary can cause the product to consume or produce excessive resources without requiring the adversary to invest equivalent work or othe...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 0.48172608698058955,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1067",
        "name": "Excessive Execution of Sequential Searches of Data Resource",
        "abstraction": "Base",
        "score": 0.47649660324031295,
        "description": "The product contains a data query against an SQL table or view\n\t\t\t\t\tthat is configured in a way that does not utilize an index and may cause\n\t\t\t\t\tsequential searches to be performed....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "abstraction": "Base",
        "score": 0.46354266355606644,
        "description": "The product uses a template engine to insert or process externally-influenced input, but it does not neutralize or incorrectly neutralizes special elements or syntax that can be interpreted as templat...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "abstraction": "Variant",
        "score": 0.463105741257893,
        "description": "The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1325",
        "name": "Improperly Controlled Sequential Memory Allocation",
        "abstraction": "Base",
        "score": 0.46103950597950566,
        "description": "The product manages a group of objects or resources and performs a separate memory allocation for each object, but it does not properly limit the total amount of memory that is consumed by all of the ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "abstraction": "Base",
        "score": 0.4592446961543478,
        "description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the in...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "410",
        "name": "Insufficient Resource Pool",
        "abstraction": "Base",
        "score": 0.4578030787152063,
        "description": "The product's resource pool is not large enough to handle peak demand, which allows an attacker to prevent others from accessing the resource by using a (relatively) large number of requests for resou...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "abstraction": "Class",
        "score": 0.45687703052968565,
        "description": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustio...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "abstraction": "Base",
        "score": 0.45007327592624147,
        "description": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "674",
        "name": "Uncontrolled Recursion",
        "abstraction": "Class",
        "score": 0.41012526069877764,
        "description": "The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1176",
        "name": "Inefficient CPU Computation",
        "abstraction": "Class",
        "score": 0.40030188160441277,
        "description": "The product performs CPU computations using\n         algorithms that are not as efficient as they could be for the\n         needs of the developer, i.e., the computations can be\n         optimized fur...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "202",
        "name": "Exposure of Sensitive Information Through Data Queries",
        "abstraction": "Base",
        "score": 0.39956846690753134,
        "description": "When trying to keep information confidential, an attacker can often infer some of the information by using statistics....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "774",
        "name": "Allocation of File Descriptors or Handles Without Limits or Throttling",
        "abstraction": "Variant",
        "score": 0.39921987731797465,
        "description": "The product allocates file descriptors or handles on behalf of an actor without imposing any restrictions on how many descriptors can be allocated, in violation of the intended security policy for tha...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "772",
        "name": "Missing Release of Resource after Effective Lifetime",
        "abstraction": "Base",
        "score": 0.3968047783922246,
        "description": "The product does not release a resource after its effective lifetime has ended, i.e., after the resource is no longer needed....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "675",
        "name": "Multiple Operations on Resource in Single-Operation Context",
        "abstraction": "Class",
        "score": 0.38721644469246475,
        "description": "The product performs the same operation on a resource two or more times, when the operation should only be applied once....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "524",
        "name": "Use of Cache Containing Sensitive Information",
        "abstraction": "Base",
        "score": 0.3863008775910193,
        "description": "The code uses a cache that contains sensitive information, but the cache can be read by an actor outside of the intended control sphere....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "834",
        "name": "Excessive Iteration",
        "abstraction": "Class",
        "score": 0.3826286869699256,
        "description": "The product performs an iteration or loop without sufficiently limiting the number of times that the loop is executed....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "776",
        "name": "Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')",
        "abstraction": "Base",
        "score": 0.3809930967223894,
        "description": "The product uses XML documents and allows their structure to be defined with a Document Type Definition (DTD), but it does not properly control the number of recursive definitions of entities....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "943",
        "name": "Improper Neutralization of Special Elements in Data Query Logic",
        "abstraction": "Class",
        "score": 0.3803545269360351,
        "description": "The product generates a query intended to access or manipulate data in a data store such as a database, but it does not neutralize or incorrectly neutralizes special elements that can modify the inten...",
        "mapping_usage": "Allowed-with-Review"
      }
    ],
    "sparse": [
      {
        "cwe_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "abstraction": "Class",
        "score": 213.5058011709372,
        "description": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustio...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "abstraction": "Base",
        "score": 183.86599633730475,
        "description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the in...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "abstraction": "Base",
        "score": 182.26277392825847,
        "description": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "772",
        "name": "Missing Release of Resource after Effective Lifetime",
        "abstraction": "Base",
        "score": 180.6301143151119,
        "description": "The product does not release a resource after its effective lifetime has ended, i.e., after the resource is no longer needed....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "674",
        "name": "Uncontrolled Recursion",
        "abstraction": "Class",
        "score": 177.42238529085196,
        "description": "The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "abstraction": "Variant",
        "score": 176.72723675902566,
        "description": "The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1176",
        "name": "Inefficient CPU Computation",
        "abstraction": "Class",
        "score": 169.26114516714387,
        "description": "The product performs CPU computations using\n         algorithms that are not as efficient as they could be for the\n         needs of the developer, i.e., the computations can be\n         optimized fur...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "401",
        "name": "Missing Release of Memory after Effective Lifetime",
        "abstraction": "Variant",
        "score": 166.5450481509014,
        "description": "The product does not sufficiently track and release allocated memory after it has been used, which slowly consumes remaining memory....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "834",
        "name": "Excessive Iteration",
        "abstraction": "Class",
        "score": 165.81897186533254,
        "description": "The product performs an iteration or loop without sufficiently limiting the number of times that the loop is executed....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "835",
        "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
        "abstraction": "Base",
        "score": 158.53067157471273,
        "description": "The product contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "252",
        "name": "Unchecked Return Value",
        "abstraction": "Base",
        "score": 50.70690145271042,
        "description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 49.902166085288584,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.3803545269360351,
      "max": 0.48400308469933545,
      "mean": 0.4288712832435969,
      "median": 0.43009926831250955,
      "count": 20
    },
    "sparse": {
      "min": 49.902166085288584,
      "max": 213.5058011709372,
      "mean": 156.26493434146494,
      "median": 172.99419096308475,
      "count": 12
    },
    "graph": {
      "min": 1.3676000000000001,
      "max": 2.2100000000000004,
      "mean": 1.726666339796148,
      "median": 1.6671280875184207,
      "count": 20
    }
  }
}