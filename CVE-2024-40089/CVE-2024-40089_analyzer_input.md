# Vulnerability Information: CVE-2024-40089

## Vulnerability Description
A Command Injection vulnerability in Vilo 5 Mesh WiFi System <= 5.16.1.33 allows remote, authenticated attackers to execute arbitrary code by injecting shell commands into the name of the Vilo device.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **impact:** execute arbitrary code
- **attacker:** remote authenticated attackers
- **product:** Vilo 5 Mesh WiFi System
- **version:** <= 5.16.1.33

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The Vilo router's hostname, configurable through the Vilo app, is directly inserted into a `udhcpc` command executed using C's `system()` function, without proper sanitization. This allows for command injection by setting the hostname to a malicious string.
- **Weaknesses/vulnerabilities present**:
  - Command injection vulnerability due to unsanitized user input being passed to `system()`
  - Lack of input validation or sanitization on the Vilo name field
- **Impact of exploitation**:
  - Arbitrary code execution as root on the underlying operating system of the Vilo router.
  - An attacker can gain complete control of the device by injecting malicious commands
- **Attack vectors**:
  - Network-based attack by exploiting the Vilo app functionality to change the router's name
  - Physical access can be leveraged for debugging through UART, which provides visibility into executed commands.
- **Required attacker capabilities/position**:
  - An attacker needs to have access to the Vilo app and be able to modify the Vilo router name setting.
  - The attacker must know how to exploit a command injection vulnerability.
- **Additional details**:
   - The command injection has a 32-character limit. This limitation can be bypassed by performing multiple injections to construct and execute more complex commands.
   - The vulnerability exists because the Vilo name is used within a `udhcpc` command string that is passed to the `system()` function.
   - The `sysconf` binary executes the vulnerable `udhcpc` command at boot.
   - The provided steps to reproduce details how to create and execute a shell script after multiple injections.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.197 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.191 |
| 5 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.182 |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.175 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.175 |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.173 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.571 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

