# Vulnerability Information: CVE-2024-43390

## Vulnerability Description
A low privileged remote attacker can perform configuration changes of the firewall services, including packet forwarding or NAT through the **FW_NAT.IN_IP environment variable** which can lead to a DoS.

### Vulnerability Description Key Phrases
- **rootcause:** **FW_NAT.IN_IP environment variable**
- **impact:** DoS
- **vector:** configuration changes of the firewall services
- **attacker:** low privileged remote attacker

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-43390.

**Root cause of vulnerability:**
Improper neutralization of special elements in output used by a downstream component. Specifically, the vulnerability arises from the lack of proper input validation within the `FW_NAT.IN_IP` environment variable.

**Weaknesses/vulnerabilities present:**
Improper injection (CWE-74). The application fails to properly sanitize input in the `FW_NAT.IN_IP` environment variable.

**Impact of exploitation:**
A low-privileged remote attacker can exploit this to perform configuration changes of firewall services, specifically packet forwarding or NAT, which can lead to a Denial-of-Service (DoS) condition.

**Attack vectors:**
Remote exploitation is possible by injecting malicious input through the `FW_NAT.IN_IP` environment variable within the web interface.

**Required attacker capabilities/position:**
A low-privileged remote attacker with access to the administrative interface of the affected Phoenix Contact mGuard devices is required to exploit this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 642 | External Control of Critical State Data | Class | Allowed-with-Review | sparse | 0.200 |
| 2 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.180 |
| 3 | 799 | Improper Control of Interaction Frequency | Class | Allowed-with-Review | sparse | 0.178 |
| 4 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.178 |
| 5 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.175 |
| 6 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.174 |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.172 |
| 8 | 606 | Unchecked Input for Loop Condition | Base | Allowed | sparse | 0.172 |
| 9 | 406 | Insufficient Control of Network Message Volume (Network Amplification) | Class | Allowed-with-Review | dense | 0.524 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.003 |

