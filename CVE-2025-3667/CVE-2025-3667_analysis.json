{
  "cve_id": "CVE-2025-3667",
  "description": "A vulnerability was found in TOTOLINK A3700R 9.1.2u.5822_B20200513. It has been classified as critical. This affects the function setUPnPCfg of the file /cgi-bin/cstecgi.cgi. The manipulation leads to **improper access controls**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.",
  "key_phrases": {
    "rootcause": "improper access controls",
    "weakness": "",
    "impact": "",
    "vector": "",
    "attacker": "",
    "product": "TOTOLINK A3700R",
    "version": "9.1.2u.5822_B20200513",
    "component": "/cgi-bin/cstecgi.cgi"
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name                                                                    | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :-------------------------------------------------------------------------- | :--------- | :---------------------- | :------------------------------ | :------------------------------ |\n| CWE-285   | Improper Authorization                                                      | 0.85       | Class                   | Primary                         | Allowed                        |\n| CWE-425   | Direct Request ('Forced Browsing')                                       | 0.75       | Base                   | Secondary                      | Allowed                        |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary weakness identified is **improper access controls**, which is best represented by CWE-285, Improper Authorization. CWE-285 is a class-level CWE. A more specific base-level CWE related to authorization is CWE-425, Direct Request ('Forced Browsing'), which describes a failure to enforce authorization on specific URLs, scripts, or files. The vulnerability description indicates that the attack can be initiated remotely, supporting the idea that specific functions are accessible without proper authorization checks.\n\n```mermaid\ngraph TD\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe425[\"CWE-425: Direct Request ('Forced Browsing')\"]\n    \n    cwe425 -->|CHILDOF| cwe285\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe285 primary\n    class cwe425 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper access controls** (CWE-285). The TOTOLINK A3700R 9.1.2u.5822_B20200513 allows unauthorized remote manipulation of the setUPnPCfg function, due to a failure in authorization checks. This aligns with CWE-425, Direct Request, as the specific function can be accessed directly without proper authorization, leading to unauthorized configuration changes.\n\n## Summary of Analysis\nThe primary classification is CWE-285, Improper Authorization, based on the explicit mention of **improper access controls** in the vulnerability description. However, considering that the vulnerability allows remote access to a specific function without authorization, CWE-425, Direct Request ('Forced Browsing'), is included as a secondary, more specific CWE. The evidence supports these classifications, although details of the exact mechanism are not provided.\n\nThe final selection represents the optimal level of specificity given the available evidence. CWE-285 captures the general authorization failure, while CWE-425 provides a more granular view of the specific attack vector (direct request without authorization).\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-790: Improper Filtering of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 0.79\n\n## CWE-425: Direct Request ('Forced Browsing')\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n\n## CWE-259: Use of Hard-coded Password\n**Abstraction Level**: Variant\n**Similarity Score**: 0.76\n\n## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n\n## CWE-294: Authentication Bypass by Capture-replay\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n\n## CWE-923: Improper Restriction of Communication Channel to Intended Endpoints\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n\n## CWE-798: Use of Hard-coded Credentials\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n\n## CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\n**Abstraction Level**: Base\n**Similarity Score**: 547.45\n\n## CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\n**Abstraction Level**: Base\n**Similarity Score**: 512.17\n\n## CWE-138: Improper Neutralization of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 493.57\n\n## CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n**Abstraction Level**: Base\n**Similarity Score**: 486.01\n\n## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\n**Abstraction Level**: Base\n**Similarity Score**: 481.61\n\n## CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\n**Abstraction Level**: base\n**Similarity Score**: 4.33\n\n## CWE-73: External Control of File Name or Path\n**Abstraction Level**: Base\n**Similarity Score**: 3.31\n\n## CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n**Abstraction Level**: base\n**Similarity Score**: 3.23\n\n## CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\n**Abstraction Level**: base\n**Similarity Score**: 3.00\n\n## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\n**Abstraction Level**: Base\n**Similarity Score**: 2.64\n\n## CWE-425: Direct Request ('Forced Browsing')\n**Abstraction Level**: Base\n**Similarity Score**: 2.59\n\n## CWE-184: Incomplete List of Disallowed Inputs\n**Abstraction Level**: base\n**Similarity Score**: 2.21\n\n## CWE-494: Download of Code Without Integrity Check\n**Abstraction Level**: base\n**Similarity Score**: 2.21\n\n## CWE-434: Unrestricted Upload of File with Dangerous Type\n**Abstraction Level**: base\n**Similarity Score**: 2.21\n\n## CWE-59: Improper Link Resolution Before File Access ('Link Following')\n**Abstraction Level**: base\n**Similarity Score**: 2.21\n\nCWEs Considered but Not Used:\n\n*   CWE-306 (Missing Authentication for Critical Function): While related, the description explicitly mentions **improper access controls**, making CWE-285 a more direct fit. CWE-306 also implies the function should have authentication, but it is missing. CWE-285 is more general and applies even if the function *has* authentication but it is flawed.\n*   CWE-266 (Incorrect Privilege Assignment): This is a more specific case of **improper access controls**, but the provided details do not confirm that the issue lies in incorrect privilege assignments. The issue is more general than just privilege assignment.\n*   CWE-78, CWE-79, CWE-89, CWE-22: These CWEs relate to input validation and injection vulnerabilities, but there is no evidence to suggest these are present.",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name                                                                    | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :-------------------------------------------------------------------------- | :--------- | :---------------------- | :------------------------------ | :------------------------------ |\n| CWE-285   | Improper Authorization                                                      | 0.85       | Class                   | Primary                         | Allowed                        |\n| CWE-425   | Direct Request ('Forced Browsing')                                       | 0.75       | Base                   | Secondary                      | Allowed                        |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary weakness identified is **improper access controls**, which is best represented by CWE-285, Improper Authorization. CWE-285 is a class-level CWE. A more specific base-level CWE related to authorization is CWE-425, Direct Request ('Forced Browsing'), which describes a failure to enforce authorization on specific URLs, scripts, or files. The vulnerability description indicates that the attack can be initiated remotely, supporting the idea that specific functions are accessible without proper authorization checks.\n\n```mermaid\ngraph TD\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe425[\"CWE-425: Direct Request ('Forced Browsing')\"]\n    \n    cwe425 -->|CHILDOF| cwe285\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe285 primary\n    class cwe425 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper access controls** (CWE-285). The TOTOLINK A3700R 9.1.2u.5822_B20200513 allows unauthorized remote manipulation of the setUPnPCfg function, due to a failure in authorization checks. This aligns with CWE-425, Direct Request, as the specific function can be accessed directly without proper authorization, leading to unauthorized configuration changes.\n\n## Summary of Analysis\nThe primary classification is CWE-285, Improper Authorization, based on the explicit mention of **improper access controls** in the vulnerability description. However, considering that the vulnerability allows remote access to a specific function without authorization, CWE-425, Direct Request ('Forced Browsing'), is included as a secondary, more specific CWE. The evidence supports these classifications, although details of the exact mechanism are not provided.\n\nThe final selection represents the optimal level of specificity given the available evidence. CWE-285 captures the general authorization failure, while CWE-425 provides a more granular view of the specific attack vector (direct request without authorization).\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-790: Improper Filtering of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 0.79\n\n## CWE-425: Direct Request ('Forced Browsing')\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n\n## CWE-259: Use of Hard-coded Password\n**Abstraction Level**: Variant\n**Similarity Score**: 0.76\n\n## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n\n## CWE-294: Authentication Bypass by Capture-replay\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n\n## CWE-923: Improper Restriction of Communication Channel to Intended Endpoints\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n\n## CWE-798: Use of Hard-coded Credentials\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n\n## CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\n**Abstraction Level**: Base\n**Similarity Score**: 547.45\n\n## CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\n**Abstraction Level**: Base\n**Similarity Score**: 512.17\n\n## CWE-138: Improper Neutralization of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 493.57\n\n## CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n**Abstraction Level**: Base\n**Similarity Score**: 486.01\n\n## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\n**Abstraction Level**: Base\n**Similarity Score**: 481.61\n\n## CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\n**Abstraction Level**: base\n**Similarity Score**: 4.33\n\n## CWE-73: External Control of File Name or Path\n**Abstraction Level**: Base\n**Similarity Score**: 3.31\n\n## CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n**Abstraction Level**: base\n**Similarity Score**: 3.23\n\n## CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\n**Abstraction Level**: base\n**Similarity Score**: 3.00\n\n## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\n**Abstraction Level**: Base\n**Similarity Score**: 2.64\n\n## CWE-425: Direct Request ('Forced Browsing')\n**Abstraction Level**: Base\n**Similarity Score**: 2.59\n\n## CWE-184: Incomplete List of Disallowed Inputs\n**Abstraction Level**: base\n**Similarity Score**: 2.21\n\n## CWE-494: Download of Code Without Integrity Check\n**Abstraction Level**: base\n**Similarity Score**: 2.21\n\n## CWE-434: Unrestricted Upload of File with Dangerous Type\n**Abstraction Level**: base\n**Similarity Score**: 2.21\n\n## CWE-59: Improper Link Resolution Before File Access ('Link Following')\n**Abstraction Level**: base\n**Similarity Score**: 2.21\n\nCWEs Considered but Not Used:\n\n*   CWE-306 (Missing Authentication for Critical Function): While related, the description explicitly mentions **improper access controls**, making CWE-285 a more direct fit. CWE-306 also implies the function should have authentication, but it is missing. CWE-285 is more general and applies even if the function *has* authentication but it is flawed.\n*   CWE-266 (Incorrect Privilege Assignment): This is a more specific case of **improper access controls**, but the provided details do not confirm that the issue lies in incorrect privilege assignments. The issue is more general than just privilege assignment.\n*   CWE-78, CWE-79, CWE-89, CWE-22: These CWEs relate to input validation and injection vulnerabilities, but there is no evidence to suggest these are present.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-494:**\n- 494 (Download of Code Without Integrity Check) - ROOT\n\n\n**Chain starting from CWE-79:**\n- 79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "source": "sparse"
      },
      "similarity": 466.3207899511881
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 436.9979657640673
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 420.3433046506835
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "source": "sparse"
      },
      "similarity": 408.8492633435287
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 389.61237336919146
    },
    {
      "metadata": {
        "doc_id": "266",
        "name": "Incorrect Privilege Assignment",
        "source": "sparse"
      },
      "similarity": 385.74579409923047
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 379.05300479582627
    },
    {
      "metadata": {
        "doc_id": "99",
        "name": "Improper Control of Resource Identifiers ('Resource Injection')",
        "source": "sparse"
      },
      "similarity": 377.7180238639145
    },
    {
      "metadata": {
        "doc_id": "259",
        "name": "Use of Hard-coded Password",
        "type": "Variant",
        "original_content": "The product contains a hard-coded password, which it uses for its own inbound authentication or for outbound communication to external components.",
        "keyphrase_source": "rootcause:improper access controls",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.6634304751143902
          }
        }
      },
      "similarity": 0.6634304751143902
    },
    {
      "doc_id": "73",
      "text": "CWE-73: External Control of File Name or Path",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "type": "base",
        "original_content": "CWE-73: External Control of File Name or Path",
        "relationships": [
          {
            "source_id": "73",
            "target_id": "114",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "59",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "41",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "20",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "73",
            "target_id": "610",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "642",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "99",
            "target_id": "73",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "642",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "610",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "59",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "41",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "114",
            "target_id": "73",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "22"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "22"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "73",
                  "22",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "22"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-494",
      "CWE-79",
      "CWE-790",
      "CWE-285",
      "CWE-184",
      "CWE-89",
      "CWE-73",
      "CWE-306",
      "CWE-266",
      "CWE-425",
      "CWE-434",
      "CWE-59",
      "CWE-923",
      "CWE-294",
      "CWE-798",
      "CWE-78",
      "CWE-1391",
      "CWE-138",
      "CWE-22",
      "CWE-303",
      "CWE-259",
      "CWE-497"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}