# Raw Retriever Results for CVE-2025-23158

# Raw Retriever Results for CVE-2025-23158
## Query
In the Linux kernel, the following vulnerability has been resolved media venus hfi add check to handle incorrect queue size qsize represents size of shared queued between driver and video firmware. Firmware can modify this value to an invalid large value. In such situation, empty_space will be bigger than the space actually available. Since new_wr_idx is not checked, so the following code will result in an OOB write. ... qsize = qhdr->q_size if (wr_idx >= rd_idx) empty_space = qsize - (wr_idx - rd_idx) .... if (new_wr_idx OOB write Add check to ensure qsize is within the allocated size while reading and writing packets into the queue.

## Keyphrases
- **rootcause**: 'incorrect queue size'
- **weakness**: 'OOB write'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4157 | 0.4915 | 0.4444 | 0.4421 | 20 |
| Sparse | 396.3865 | 478.3739 | 447.1486 | 447.6014 | 11 |
| Graph | 1.6848 | 3.4866 | 2.2431 | 2.2972 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | base | 3.4866 | Allowed |
| 2 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.9250 | Allowed |
| 3 | 908 | Use of Uninitialized Resource | Base | 2.7999 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.7838 | Allowed |
| 5 | 129 | Improper Validation of Array Index | variant | 2.6784 | Allowed |
| 6 | 789 | Memory Allocation with Excessive Size Value | Variant | 2.5214 | Allowed |
| 7 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 8 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 9 | 190 | Integer Overflow or Wraparound | Base | 2.3864 | Allowed |
| 10 | 823 | Use of Out-of-range Pointer Offset | Base | 2.3844 | Allowed |
| 11 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 12 | 787 | Out-of-bounds Write | base | 2.2100 | Allowed |
| 13 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 14 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 15 | 909 | Missing Initialization of Resource | Class | 1.7343 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4915 | 0.4915 | Allowed |
| 2 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4827 | 0.4827 | Allowed |
| 3 | 806 | Buffer Access Using Size of Source Buffer | Variant | 0.4724 | 0.4724 | Allowed |
| 4 | 909 | Missing Initialization of Resource | Class | 0.4687 | 0.4687 | Allowed-with-Review |
| 5 | 908 | Use of Uninitialized Resource | Base | 0.4653 | 0.4653 | Allowed |
| 6 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4603 | 0.4603 | Allowed |
| 7 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4583 | 0.4583 | Allowed |
| 8 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4567 | 0.4567 | Allowed |
| 9 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.4559 | 0.4559 | Allowed |
| 10 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4551 | 0.4551 | Allowed |
| 11 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.4290 | 0.4290 | Allowed |
| 12 | 1335 | Incorrect Bitwise Shift of Integer | Base | 0.4280 | 0.4280 | Allowed |
| 13 | 606 | Unchecked Input for Loop Condition | Base | 0.4276 | 0.4276 | Allowed |
| 14 | 190 | Integer Overflow or Wraparound | Base | 0.4240 | 0.4240 | Allowed |
| 15 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4208 | 0.4208 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | 478.3739 | 478.3739 | Allowed |
| 2 | 789 | Memory Allocation with Excessive Size Value | 471.4769 | 471.4769 | Allowed |
| 3 | 190 | Integer Overflow or Wraparound | 467.5186 | 467.5186 | Allowed |
| 4 | 823 | Use of Out-of-range Pointer Offset | 451.3901 | 451.3901 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | 451.0867 | 451.0867 | Allowed |
| 6 | 606 | Unchecked Input for Loop Condition | 447.6014 | 447.6014 | Allowed |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 444.9997 | 444.9997 | Allowed |
| 8 | 295 | Improper Certificate Validation | 441.0803 | 441.0803 | Allowed |
| 9 | 125 | Out-of-bounds Read | 437.7645 | 437.7645 | Allowed |
| 10 | 197 | Numeric Truncation Error | 430.9559 | 430.9559 | Allowed |
| 11 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 396.3865 | 396.3865 | Allowed-with-Review |
