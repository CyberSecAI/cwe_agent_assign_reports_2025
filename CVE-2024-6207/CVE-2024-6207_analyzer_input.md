# Vulnerability Information: CVE-2024-6207

## Vulnerability Description
CVE 2021-22681 https//www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1550.html and send a specially crafted CIP message to the device. If exploited, a threat actor could help prevent access to the legitimate user and end connections to connected devices including the workstation. To recover the controllers, a download is required which ends any process that the controller is running.

### Vulnerability Description Key Phrases
- **impact:** help prevent access to the legitimate user and end connections to connected devices
- **vector:** specially crafted CIP message
- **attacker:** threat actor

## CVE Reference Links Content Summary
```
{
  "cve_id": "CVE-2024-6207",
  "description": "A denial-of-service vulnerability exists in the affected products that will cause the device to result in a major nonrecoverable fault (MNRF) when it receives an invalid CIP request. To exploit this vulnerability a malicious user must chain this exploits with [CVE 2021-22681](https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1550.html) and send a specially crafted CIP message to the device.  If exploited, a threat actor could help prevent access to the legitimate user and end connections to connected devices including the workstation.  To recover the controllers, a download is required which ends any process that the controller is running.",
  "vulnerability_details": {
    "root_cause": "Improper Input Validation",
    "weaknesses": [
      "The vulnerability is triggered by sending an invalid CIP request to the affected device.",
	    "The vulnerability is not directly exploitable. It needs to be chained with CVE-2021-22681"
    ],
    "impact": "A successful exploit results in a major nonrecoverable fault (MNRF) of the affected device, leading to denial of service. This can prevent access to the device, terminate connections to other connected devices including the workstation, and requires a controller download to recover, thus ending any running processes.",
    "attack_vectors": [
      "The attack vector is network-based, leveraging the Common Industrial Protocol (CIP) messages."
    ],
    "attacker_capabilities": "The attacker needs to be able to send network messages to the affected device and must also chain this exploit with [CVE 2021-22681]"
  },
  "affected_products": [
    "ControlLogix® 5580",
    "ControlLogix® 5580 Process",
    "GuardLogix 5580",
    "CompactLogix 5380",
    "Compact GuardLogix 5380 SIL 2",
    "Compact GuardLogix 5380 SIL 3",
    "CompactLogix 5480",
    "FactoryTalk® Logix Echo"
  ],
  "cvss_v3.1_score": "7.5",
  "cvss_v3.1_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_v4.0_score": "8.7",
  "cvss_v4.0_vector": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N"
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.112 |
| 2 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.110 |
| 3 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.110 |
| 4 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.109 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.109 |
| 6 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.108 |
| 7 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.108 |
| 8 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.107 |
| 9 | 294 | Authentication Bypass by Capture-replay | Base | Allowed | dense | 0.618 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

