## Vulnerability Description
A vulnerability was found in erzhongxmu Jeewms up to 20241108. It has been rated as critical. This issue affects some unknown processing of the file cgReportController.do of the component AuthInterceptor. The manipulation of the argument begin_date leads to **sql injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. This product does not use versioning. This is why information about affected and unaffected releases are unavailable. Other parameters might be affected as well.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** erzhongxmu Jeewms
- **version:** up to 20241108
- **component:** AuthInterceptor

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the identified vulnerabilities:

**Vulnerability 1: Authentication Bypass**

*   **Root Cause:** The `AuthInterceptor` class uses `request.getRequestURI()` to obtain the request path for authentication checks. This method does not normalize or parse special characters like `..`.
*   **Weaknesses:** The use of `request.getRequestURI()` without proper sanitization or normalization allows attackers to manipulate the URI, bypassing the intended access control mechanism.
*   **Impact:** By using `/rest/../` in the request path, an attacker can bypass the authentication interceptor, gaining unauthorized access to protected parts of the application.
*   **Attack Vector:** Sending a crafted HTTP request with a manipulated URI (e.g., `/rest/../`).
*   **Attacker Capabilities/Position:** The attacker needs to be able to send HTTP requests to the server. No prior authentication is needed due to the bypass.

**Vulnerability 2: SQL Injection**

*   **Root Cause:** The `CgReportController#datagrid` method does not properly validate user-supplied parameters before including them in an SQL query when the `configId` is set to `jckcs`.
*   **Weaknesses:** Lack of input validation allows for the injection of malicious SQL code. Specifically, the `begin_date` parameter is vulnerable.
*   **Impact:** An attacker can inject arbitrary SQL queries, potentially gaining access to sensitive data (e.g., user credentials, database structure). As shown in the provided example, they can extract database information such as the current user, database name, version, and data directory.
*   **Attack Vector:** Sending a crafted HTTP POST request to the `cgReportController.do` endpoint with the `datagrid=1`, `configId=jckcs` and a malicious SQL payload in the `begin_date` parameter.
*    **Attacker Capabilities/Position:** The attacker needs to be able to send HTTP requests to the server and exploit the authentication bypass vulnerability to reach the vulnerable endpoint.

**Summary**

The provided content describes two vulnerabilities: an authentication bypass and a SQL injection vulnerability. The authentication bypass allows an attacker to circumvent the login requirement, and the SQL injection allows the attacker to execute arbitrary SQL queries. These vulnerabilities, when exploited in tandem, pose a significant risk.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.517 |
| 3 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.455 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.448 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.439 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.438 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.435 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.424 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.607 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-117: Improper Output Neutralization for Logs

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-116: Improper Encoding or Escaping of Output

CWE-306: Missing Authentication for Critical Function

CWE-790: Improper Filtering of Special Elements

CWE-184: Incomplete List of Disallowed Inputs