# Vulnerability Information: CVE-2024-8365

## Vulnerability Description
Vault Community Edition and Vault Enterprise experienced a regression where functionality that HMACd sensitive headers in the configured audit device, specifically client tokens and token accessors, was removed. This resulted in the plaintext values of client tokens and token accessors being stored in the audit log. This vulnerability, CVE-2024-8365, was fixed in Vault Community Edition and Vault Enterprise 1.17.5 and Vault Enterprise 1.16.9.

### Vulnerability Description Key Phrases
- **rootcause:** **regression where functionality that HMACd sensitive headers in the configured audit device was removed**
- **impact:** plaintext values of client tokens and token accessors being stored in the audit log
- **product:** Vault Community Edition and Vault Enterprise
- **version:** prior to 1.17.5 and 1.16.9

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A regression in Vault removed the functionality that HMAC'd sensitive headers in the configured audit device, specifically client tokens and token accessors.
- **Weaknesses/vulnerabilities present:** Plaintext values of client tokens and token accessors were stored in the audit log instead of their HMAC.
- **Impact of exploitation:** Exposure of client tokens and token accessors, which could allow unauthorized access to Vault.
- **Attack vectors:** An attacker with access to the audit logs could obtain plaintext client tokens and token accessors.
- **Required attacker capabilities/position:** Access to the audit logs.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.493 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.464 |
| 3 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.459 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.429 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.421 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.419 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.406 |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.404 |
| 9 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | dense | 0.531 |
| 10 | 208 | Observable Timing Discrepancy | Base | Allowed | graph | 0.002 |

