# Vulnerability Information: CVE-2024-56680

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved media intel/ipu6 **do not handle interrupts when device is disabled** Some IPU6 devices have shared interrupts. We need to handle properly case when interrupt is triggered from other device on shared irq line and IPU6 itself disabled. In such case we get 0xffffffff from ISR_STATUS register and handle all irqs cases, for what we are not not prepared and usually hang the whole system. To avoid the issue use pm_runtime_get_if_active() to check if the device is enabled and prevent suspending it when we handle irq until the end of irq. Additionally use synchronize_irq() in suspend

### Vulnerability Description Key Phrases
- **weakness:** **do not handle interrupts when device is disabled**
- **impact:** hang the whole system
- **product:** Linux kernel
- **component:** media intel/ipu6

## CVE Reference Links Content Summary
The provided content relates to a vulnerability in the Intel IPU6 driver in the Linux kernel.

**Root Cause:**
The vulnerability occurs due to improper handling of shared interrupts when the IPU6 device is disabled. When an interrupt is triggered by another device sharing the same IRQ line while the IPU6 device is disabled, the driver reads an invalid value (0xffffffff) from the ISR_STATUS register. This leads the driver to attempt to handle all possible interrupt cases, for which it is not prepared, causing the system to hang.

**Vulnerabilities:**
- Improper interrupt handling: The driver does not check if the device is enabled before handling interrupts.
- Race condition: The driver attempts to suspend the device while handling an interrupt.

**Impact:**
- System hang: The primary impact is a system hang due to the driver attempting to handle unexpected interrupt conditions.
- Denial of service: The system becomes unusable, leading to a denial-of-service condition.

**Attack Vectors:**
- Triggering a shared interrupt while the IPU6 device is disabled. This can be achieved through actions that cause other devices on the shared IRQ line to generate interrupts.

**Required Attacker Capabilities/Position:**
- The attacker must be able to trigger interrupts on the shared IRQ line of the IPU6 device, while the device is disabled.
- The attacker must have the ability to interact with devices on the same shared IRQ line.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 833 | Deadlock | Base | Allowed | sparse | 0.508 |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.500 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.496 |
| 4 | 459 | Incomplete Cleanup | Base | Allowed | sparse | 0.487 |
| 5 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.474 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.473 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.473 |
| 8 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.469 |
| 9 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | Allowed | dense | 0.434 |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | Base | Allowed | graph | 0.002 |

