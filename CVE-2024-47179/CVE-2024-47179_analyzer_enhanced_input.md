## Vulnerability Description
RSSHub is an RSS network. Prior to commit 64e00e7, RSSHubs `docker-test-cont.yml` workflow is vulnerable to Artifact Poisoning, which could have lead to a full repository takeover. Downstream users of RSSHub are not vulnerable to this issue, and commit 64e00e7 fixed the underlying issue and made the repository no longer vulnerable. The `docker-test-cont.yml` workflow gets triggered when the `PR - Docker build test` workflow completes successfully. It then collects some information about the Pull Request that triggered the triggering workflow and set some labels depending on the PR body and sender. If the PR also contains a `routes` markdown block, it will set the `TEST_CONTINUE` environment variable to `true`. The workflow then downloads and extracts an artifact uploaded by the triggering workflow which is expected to contain a single `rsshub.tar.zst` file. However, prior to commit 64e00e7, it did not validate and the contents were extracted in the root of the workspace overriding any existing files. Since the contents of the artifact were not validated, it is possible for a malicious actor to send a Pull Request which uploads, not just the `rsshub.tar.zst` compressed docker image, but also a malicious `package.json` file with a script to run arbitrary code in the context of the privileged workflow. As of commit 64e00e7, this scenario has been addressed and the RSSHub repository is no longer vulnerable.

### Vulnerability Description Key Phrases
- **rootcause:** **improper input validation**
- **weakness:** **artifact poisoning**
- **impact:** full repository takeover
- **vector:** malicious Pull Request
- **attacker:** attacker
- **product:** RSSHub
- **version:** prior to commit 64e00e7
- **component:** docker-test-cont.yml workflow

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from the `docker-test-cont.yml` GitHub Actions workflow in the RSSHub repository. This workflow downloads an artifact uploaded by a previous workflow (`PR - Docker build test`) and extracts its contents into the root of the workspace without proper validation.

**Weaknesses/Vulnerabilities Present:**

1.  **Unvalidated Artifact Extraction:** The core weakness is that the workflow blindly extracts the contents of a downloaded artifact into the workspace's root directory. It expects a single `rsshub.tar.zst` file (a compressed Docker image). However, it doesn't verify the artifact's contents before extraction.
2.  **Artifact Poisoning:** This lack of validation allows an attacker to "poison" the artifact by including malicious files, such as a `package.json` with a preinstall script. This script can then be executed when `pnpm i` is run in the workflow.
3. **Expression Injection:** While not the primary vulnerability in this case, the content mentions that untrusted input used in GitHub Actions expressions can lead to code injection. The provided code snippets shows that `github.event.comment.body` can be used in `run` instructions leading to command injection. This is mitigated by using environment variables and the shell's native variable expansion syntax.
    
**Impact of Exploitation:**

*   **Arbitrary Code Execution:** By including a malicious `package.json`, an attacker can execute arbitrary code within the GitHub Actions runner environment.
*   **Full Repository Takeover:** The workflow runs with full write privileges (`GITHUB_TOKEN` has broad permissions), enabling an attacker to modify the repository's code, settings, and potentially inject backdoors.
*   **Secret Exfiltration:** An attacker could exfiltrate secrets, tokens, or any other sensitive data accessible within the workflow's environment.

**Attack Vectors:**

*   **Malicious Pull Request:** The attack vector involves submitting a pull request (PR) to the RSSHub repository. The PR's body must contain a `routes` markdown block to set the `TEST_CONTINUE` environment variable to `true`.
*   **Modified Artifact:** The attacker modifies the `PR - Docker build test` workflow to upload a crafted artifact containing a malicious `package.json` in addition to a `rsshub.tar.zst` file

**Required Attacker Capabilities/Position:**

*   **Contributor to the Repository:** The attacker must be able to create pull requests to the repository.
*   **Ability to modify the `PR - Docker build test` workflow:** The attacker needs the ability to modify the code and workflow of the PR build to upload an artifact containing the malicious payload.

**Additional Notes:**

*   The vulnerability is identified as `GHSL-2024-178` and assigned `CVE-2024-47179`.
*   The provided documents contain a Proof of Concept (PoC) on how the attack can be executed.
* The fix for the vulnerability was introduced in commit `64e00e743aba2a239508fea97825994e3d687ecc`.
*   The suggested remediation involves extracting the artifact to a temporary directory and validating its contents before using them.
*   The content references additional resources related to GitHub Actions security, such as untrusted input, and preventing pwn requests.
*   The vulnerability is classified as Critical.
*   The vulnerability does not have a direct CWE assigned.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 1.191 |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 1.191 |
| 3 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 1.155 |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 1.142 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 1.128 |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 1.116 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 1.115 |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 1.113 |
| 9 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | dense | 0.515 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-918: Server-Side Request Forgery (SSRF)

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-863: Incorrect Authorization

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-285: Improper Authorization

CWE-347: Improper Verification of Cryptographic Signature

CWE-1333: Inefficient Regular Expression Complexity

CWE-73: External Control of File Name or Path