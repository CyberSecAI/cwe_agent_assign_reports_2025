# Vulnerability Information: CVE-2024-43845

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved udf Fix bogus checksum computation in udf_rename() Syzbot reports **uninitialized memory access in udf_rename()** when updating checksum of .. directory entry of a moved directory. This is indeed true as we pass on-stack diriter.fi to the udf_update_tag() and because that has only struct fileIdentDesc included in it and not the impUse or name fields, the checksumming function is going to checksum random stack contents beyond the end of the structure. This is actually harmless because the following udf_fiiter_write_fi() will recompute the checksum from on-disk buffers where everything is properly included. So all that is needed is just removing the bogus calculation.

### Vulnerability Description Key Phrases
- **rootcause:** **uninitialized memory access in udf_rename()**
- **impact:** bogus checksum computation
- **product:** Linux kernel
- **component:** udf

## CVE Reference Links Content Summary
Based on the provided information, this content relates to CVE-2024-43845.

**Root cause of vulnerability:**
The vulnerability stems from an incorrect checksum calculation within the `udf_rename()` function when updating the '..' directory entry of a moved directory. This occurs because the on-stack `diriter.fi` structure, passed to `udf_update_tag()`, only includes the `fileIdentDesc` and not the `impUse` or `name` fields. Consequently, `udf_update_tag()` checksums random stack memory contents beyond the structure's boundary.

**Weaknesses/vulnerabilities present:**
- Uninitialized memory access due to incorrect data being used in the checksum calculation.
- Out-of-bounds read, as the checksum function accesses memory beyond the intended structure.

**Impact of exploitation:**
While the incorrect checksum calculation is technically harmless as it's later recalculated correctly from on-disk buffers, it represents a potential vulnerability. The uninitialized memory access could lead to unexpected behavior or crashes under different circumstances or if the re-calculation didn't occur.

**Attack vectors:**
- Triggering the `udf_rename()` function by renaming a directory in a UDF filesystem.

**Required attacker capabilities/position:**
- Ability to perform file system operations on a UDF file system.

**Additional Notes:**
- The provided patch removes the call to `udf_update_tag()` which is the source of the issue. The correct checksum will be calculated later using on disk data.
- This vulnerability was reported by syzbot.
- The fix is present in multiple stable kernel branches.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.616 |
| 2 | 457 | Use of Uninitialized Variable | Variant | Allowed | sparse | 0.606 |
| 3 | 824 | Access of Uninitialized Pointer | Base | Allowed | sparse | 0.602 |
| 4 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.600 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.596 |
| 6 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.589 |
| 7 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.588 |
| 8 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.579 |
| 9 | 911 | Improper Update of Reference Count | Base | Allowed | dense | 0.498 |
| 10 | 908 | Use of Uninitialized Resource | Base | Allowed | graph | 0.003 |

