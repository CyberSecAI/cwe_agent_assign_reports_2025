## Vulnerability Description
quickjs-ng through 0.9.0 has a **missing length check** in JS_ReadString for a string, leading to a **heap-based buffer overflow**. QuickJS before 2025-04-26 is also affected.

### Vulnerability Description Key Phrases
- **rootcause:** **missing length check**
- **weakness:** **heap-based buffer overflow**
- **product:** QuickJS
- **version:** before 2025-04-26

## CVE Reference Links Content Summary
CVE-2025-46687: PLACEHOLDER - Implement CVE description retrieval

Based on the provided content, here's a breakdown of the vulnerabilities:

**Vulnerability 1: Heap Buffer Overflow in String Deserialization (CVE-2025-46687 likely relates to this)**

*   **Root cause:** Missing length check and bad size calculation in `JS_ReadString` when reading string data from bytecode. Specifically, an integer overflow occurs in the `get_leb128` function, leading to an incorrect length being used for memory allocation.
*   **Weaknesses/vulnerabilities present:** Integer overflow, heap buffer overflow.
*   **Impact of exploitation:**  Potential for arbitrary code execution due to memory corruption.
*   **Attack vectors:** Crafted bytecode input.
*   **Required attacker capabilities/position:** Ability to create malicious bytecode input.
*   **Mitigation or fix:**  Add a check for potential overflow in `js_alloc_string_rt` before allocating memory.

**Vulnerability 2: Heap Buffer Overflow in BigInt Deserialization (CVE-2025-46687 likely relates to this)**

*   **Root cause:** Integer overflow in the LEB128 parsing within `JS_ReadBigInt`, leading to an undersized buffer allocation.
*   **Weaknesses/vulnerabilities present:** Integer overflow, heap buffer overflow.
*   **Impact of exploitation:** Potential for arbitrary code execution due to memory corruption.
*   **Attack vectors:** Crafted input that triggers the integer overflow during BigInt deserialization.
*   **Required attacker capabilities/position:** Ability to create malicious input.
*   **Mitigation or fix:** The fix involves checking for potential overflows in the size calculation before allocating memory.

**Additional Information:**

*   The fixes for these vulnerabilities were cherry-picked from bellard/quickjs@1eb05e44fa and applied in quickjs-ng.
*   The ASAN reports provide detailed information about the memory corruption occurring in both cases.
*   The provided content indicates that the same vulnerability exists in both quickjs and quickjs-ng.
*   The fuzzing example demonstrates how to reproduce the heap buffer overflow.

The content provides more detail than a typical CVE description, including ASAN reports, code snippets, and reproduction steps.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.222 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.221 |
| 5 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.213 |
| 6 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.208 |
| 7 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.206 |
| 8 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.204 |
| 9 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | dense | 0.547 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-122: Heap-based Buffer Overflow

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-193: Off-by-one Error

CWE-126: Buffer Over-read

CWE-197: Numeric Truncation Error

CWE-130: Improper Handling of Length Parameter Inconsistency

CWE-674: Uncontrolled Recursion

CWE-128: Wrap-around Error