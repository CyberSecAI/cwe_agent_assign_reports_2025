# Vulnerability Information: CVE-2024-8538

## Vulnerability Description
The Big File Uploads - Increase Maximum File Upload Size plugin for WordPress is vulnerable to Full Path Disclosure in all versions up to, and including, 2.1.2. This is due the plugin **not sanitizing a file path in an error message**. This makes it possible for authenticated attackers, with author-level access and above, to retrieve the full path of the web application, which can be used to aid other attacks. The information displayed is not useful on its own, and requires another vulnerability to be present for damage to an affected website.

### Vulnerability Description Key Phrases
- **rootcause:** **not sanitizing a file path in an error message**
- **weakness:** **full path disclosure**
- **impact:** Full Path Disclosure
- **attacker:** authenticated attackers with author-level access and above
- **product:** Big File Uploads - Increase Maximum File Upload Size plugin for WordPress
- **version:** all versions up to and including 2.1.2

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from the plugin's failure to sanitize a file path within an error message. This allows the full server path of the application to be revealed.

**Weaknesses/Vulnerabilities:**
* **Full Path Disclosure:** The plugin displays the server's file path in an error message when an upload fails, specifically in the `ajax_chunk_receiver` function.
* **Lack of Input Sanitization:** The plugin does not sanitize the file path before including it in the error message.

**Impact of Exploitation:**
* **Information Disclosure:** Attackers can gain knowledge of the web application's full path, potentially aiding further malicious activities.
* **Limited Direct Impact:** The vulnerability itself is not directly exploitable for immediate harm, but provides information useful in combination with other vulnerabilities.

**Attack Vectors:**
* **Network:** The vulnerability is exploitable over the network through HTTP requests to the vulnerable plugin endpoint.
* **File Upload Process:** The vulnerability is triggered during the file upload process, when an error occurs due to issues with writing the file.
* **Error Message:** The vulnerable file path is exposed in an error message generated by the plugin.

**Required Attacker Capabilities/Position:**
* **Authenticated User:** The attacker needs to have author-level or higher privileges in WordPress to access the vulnerable functionality.
* **Upload Files Capability:** The user must be able to upload files.
* **Ability to Cause Upload Errors**: The attacker needs to be able to cause the upload process to fail in a way that triggers the vulnerable code path.

**Additional Notes:**

*   The vulnerable code is located in the `ajax_chunk_receiver` function, specifically when handling chunked uploads.
*   The vulnerable file path is displayed in the `message` key in the json response or in an HTML error message if short is defined in the request.
*   The vulnerability is present in versions <= 2.1.2 of the Big File Uploads plugin.
*   Version 2.1.3 of the plugin addresses this vulnerability by removing the file path from the error message.

This information provides more specific details than the original CVE description placeholder and it is relevant to the identified CVE.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.627 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.614 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.608 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.606 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.604 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.601 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.600 |
| 8 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.599 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.602 |
| 10 | 183 | Permissive List of Allowed Inputs | Base | Allowed | graph | 0.002 |

