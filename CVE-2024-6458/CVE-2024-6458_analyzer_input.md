# Vulnerability Information: CVE-2024-6458

## Vulnerability Description
The WooCommerce Product Table Lite plugin for WordPress is vulnerable to unauthorized post title modification due to a missing capability check on the wcpt_presets__duplicate_preset_to_table function in all versions up to, and including, 3.5.1. This makes it possible for authenticated attackers with subscriber access and above to change titles of arbitrary posts. Missing sanitization can lead to Stored **Cross-Site Scripting** when viewed by an admin via the WooCommerce Product Table.

### Vulnerability Description Key Phrases
- **rootcause:** **Missing capability check**
- **weakness:** **Cross-Site Scripting**
- **impact:** unauthorized post title modification
- **attacker:** authenticated attackers with subscriber access and above
- **product:** WooCommerce Product Table Lite plugin for WordPress
- **version:** all versions up to and including 3.5.1
- **component:** wcpt_presets__duplicate_preset_to_table function

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-6458

**Root Cause of Vulnerability:**
- The vulnerability stems from a missing authorization check in the `wcpt_presets__duplicate_preset_to_table` function within the `presets/presets.php` file of the WooCommerce Product Table Lite plugin.
- Specifically, there isn't a capability check to verify if the user has the necessary permissions to perform this action.
- Additionally, missing sanitization of the post title leads to Stored Cross-Site Scripting (XSS)

**Weaknesses/Vulnerabilities Present:**
- **Missing Authorization:** The `wcpt_presets__duplicate_preset_to_table` function lacks a capability check, allowing unauthorized users to execute it.
- **Stored Cross-Site Scripting (XSS):** The plugin doesn't sanitize the post title, leading to a stored XSS vulnerability when an admin views the modified title.

**Impact of Exploitation:**
- **Unauthorized Post Title Modification:** Attackers with subscriber-level access or higher can modify the titles of arbitrary posts within WordPress.
- **Stored Cross-Site Scripting:** An attacker can inject malicious scripts into the post title. When an administrator views the affected post title, the malicious script will execute, potentially allowing the attacker to perform actions with admin privileges, such as cookie theft, data exfiltration, or further compromise of the site.

**Attack Vectors:**
- The attack vector is through the WordPress admin panel.
- The vulnerability is triggered when a user with minimal permissions (subscriber or higher) accesses the table editor and manipulates the `wcpt_preset` and `post_id` parameters to trigger the vulnerable function.

**Required Attacker Capabilities/Position:**
- The attacker needs to be an authenticated user with at least subscriber-level access to the WordPress site.
- The attacker needs to be able to send requests to the WordPress admin interface.

**Additional Details:**
- The vulnerable function is located in `/wc-product-table-lite/trunk/presets/presets.php`
- The vulnerability affects all versions of the plugin up to and including 3.5.1.
- The vulnerability was fixed in version 3.8.6.
- The fix included adding a capability check to the `wcpt_presets__duplicate_preset_to_table` function, ensuring that only users with the "create_wc_product_tables" capability can execute it and sanitizing the post title.

This information provides a comprehensive understanding of the vulnerability, its causes, impacts, and how to mitigate it.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.577 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.547 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.467 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.463 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.462 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.444 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.433 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.433 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.522 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

