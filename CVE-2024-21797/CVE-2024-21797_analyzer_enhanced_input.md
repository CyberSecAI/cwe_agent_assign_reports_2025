## Vulnerability Description
A **command execution vulnerability** exists in the adm.cgi set_TR069() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary command execution. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **command execution vulnerability**
- **impact:** arbitrary command execution
- **vector:** specially crafted HTTP request
- **attacker:** authenticated attacker
- **product:** Wavlink AC3000
- **version:** M33A8.V5030.210505
- **component:** adm.cgi set_TR069() functionality

## CVE Reference Links Content Summary
Here's an analysis of the provided content regarding CVE-2024-21797:

**Relevant Content:**

**Source:** Both provided contents (talosintelligence.com_8a698251_20250624_171224.html and talosintelligence.com_6dcf197d_20250624_171225.html) are identical and contain the same vulnerability information

*   **Vulnerability:** Command injection vulnerability in the `adm.cgi` set\_TR069() functionality of Wavlink AC3000 M33A8.V5030.210505.
*   **Root cause:** The vulnerability is caused by a lack of input filtering for the `TR069_local_port` parameter. This allows attackers to inject subshell commands. The code snippets show that the `TR069_local_port` parameter is copied to the heap, and later used in `iptables` commands without sanitization.
*   **Weaknesses/vulnerabilities present:** Command injection (CWE-74).
*   **Impact of exploitation:** Arbitrary command execution.
*   **Attack vector:** A specially crafted HTTP request to the `adm.cgi` file.
*   **Required attacker capabilities/position:** An attacker can make an authenticated HTTP request to trigger this vulnerability. The attacker needs to be authenticated.
*   **Affected version:** Wavlink AC3000 M33A8.V5030.210505
*   **CVSSv3 Score:** 9.1 - CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
*   **Mitigation or fix:** The vendor has discontinued the product but is working on patches.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.280 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.266 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.264 |
| 4 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.264 |
| 5 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.257 |
| 6 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.246 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.244 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.234 |
| 9 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | dense | 0.592 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1287: Improper Validation of Specified Type of Input

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-790: Improper Filtering of Special Elements

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-134: Use of Externally-Controlled Format String

CWE-138: Improper Neutralization of Special Elements

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-425: Direct Request ('Forced Browsing')