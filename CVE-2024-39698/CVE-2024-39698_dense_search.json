{
  "retriever": "dense",
  "query": "electron-updater allows for automatic updates for Electron apps. The file `packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts` implements the signature validation routine for Electron applications on Windows. Because of the surrounding shell, a first pass by `cmd.exe` expands any environment variable found in command-line above. This creates a situation where `verifySignature()` can be tricked into validating the certificate of a different file than the one that was just downloaded. If the step is successful, the malicious update will be executed even if its signature is invalid. This attack assumes a compromised update manifest (server compromise, Man-in-the-Middle attack if fetched over HTTP, Cross-Site Scripting to point the application to a malicious updater server, etc.). The patch is available starting from 6.3.0-alpha.6.",
  "keyphrases": {
    "rootcause": [
      "improper certificate validation"
    ],
    "weakness": [
      "Cross-Site Scripting"
    ]
  },
  "timestamp": "2025-07-12 03:00:24",
  "cve_id": "CVE-2024-39698",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "494",
      "name": "Download of Code Without Integrity Check",
      "type": "Base",
      "score": 0.4930062111831881
    },
    {
      "cwe_id": "347",
      "name": "Improper Verification of Cryptographic Signature",
      "type": "Base",
      "score": 0.46784599314472425
    },
    {
      "cwe_id": "427",
      "name": "Uncontrolled Search Path Element",
      "type": "Base",
      "score": 0.4452566503536378
    },
    {
      "cwe_id": "422",
      "name": "Unprotected Windows Messaging Channel ('Shatter')",
      "type": "Variant",
      "score": 0.42496533984694196
    },
    {
      "cwe_id": "295",
      "name": "Improper Certificate Validation",
      "type": "Base",
      "score": 0.4137737849275407
    },
    {
      "cwe_id": "1386",
      "name": "Insecure Operation on Windows Junction / Mount Point",
      "type": "Base",
      "score": 0.4071922962648077
    },
    {
      "cwe_id": "297",
      "name": "Improper Validation of Certificate with Host Mismatch",
      "type": "Variant",
      "score": 0.4064031086920216
    },
    {
      "cwe_id": "1385",
      "name": "Missing Origin Validation in WebSockets",
      "type": "Variant",
      "score": 0.40531190281650764
    },
    {
      "cwe_id": "283",
      "name": "Unverified Ownership",
      "type": "Base",
      "score": 0.4051173583938414
    },
    {
      "cwe_id": "1289",
      "name": "Improper Validation of Unsafe Equivalence in Input",
      "type": "Base",
      "score": 0.4039676517462463
    },
    {
      "cwe_id": "354",
      "name": "Improper Validation of Integrity Check Value",
      "type": "Base",
      "score": 0.3930993018255929
    },
    {
      "cwe_id": "353",
      "name": "Missing Support for Integrity Check",
      "type": "Base",
      "score": 0.3749319432838205
    },
    {
      "cwe_id": "506",
      "name": "Embedded Malicious Code",
      "type": "Class",
      "score": 0.37425355717393716
    },
    {
      "cwe_id": "520",
      "name": ".NET Misconfiguration: Use of Impersonation",
      "type": "Variant",
      "score": 0.3732852027037876
    },
    {
      "cwe_id": "356",
      "name": "Product UI does not Warn User of Unsafe Actions",
      "type": "Base",
      "score": 0.370904268926901
    },
    {
      "cwe_id": "345",
      "name": "Insufficient Verification of Data Authenticity",
      "type": "Class",
      "score": 0.3698110516112063
    },
    {
      "cwe_id": "599",
      "name": "Missing Validation of OpenSSL Certificate",
      "type": "Variant",
      "score": 0.36346731647729164
    },
    {
      "cwe_id": "602",
      "name": "Client-Side Enforcement of Server-Side Security",
      "type": "Class",
      "score": 0.36278903938285345
    },
    {
      "cwe_id": "360",
      "name": "Trust of System Event Data",
      "type": "Base",
      "score": 0.36196773246833036
    },
    {
      "cwe_id": "1022",
      "name": "Use of Web Link to Untrusted Target with window.opener Access",
      "type": "Variant",
      "score": 0.36181502772266505
    }
  ]
}