{
  "cve_id": "CVE-2024-6560",
  "description": "The Addonify - Quick View For WooCommerce plugin for WordPress is vulnerable to Full Path Disclosure in all versions up to, and including, 1.2.16. This is due the plugin utilizing mobiledetect without preventing direct access to the files. This makes it possible for unauthenticated attackers to retrieve the full path of the web application, which can be used to aid other attacks. The information displayed is not useful on its own, and requires another vulnerability to be present for damage to an affected website.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "Full Path Disclosure",
    "vector": "",
    "attacker": "unauthenticated attackers",
    "product": "Addonify - Quick View For WooCommerce",
    "version": "up to and including 1.2.16",
    "component": "mobiledetect"
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-548 | Information Exposure Through Directory Listing | 0.8 | Base | Allowed | Primary CWE |\n| CWE-425 | Direct Request ('Forced Browsing') | 0.5 | Base | Allowed | Secondary Candidate |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.4 | Class | Discouraged | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE, CWE-548, is related to information exposure. While other CWEs like CWE-425 and CWE-200 were considered, CWE-548 directly addresses the **full path disclosure** aspect. The hierarchical relationships did not significantly influence the selection, as the focus was on identifying the most specific and relevant CWE based on the vulnerability description.\n\n```mermaid\ngraph TD\n    cwe548[\"CWE-548: Information Exposure Through Directory Listing\"]\n    cwe425[\"CWE-425: Direct Request ('Forced Browsing')\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n\n    cwe548 -->|PEEROF| cwe200\n    cwe425 -->|CANPRECEDE| cwe548\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe548 primary\n    class cwe425,cwe200 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **lack of access control** on certain files, leading to the **exposure of the full path**.\n\n1.  **Root Cause:** Missing or **Improper Access Control** on files.\n2.  **Weakness:** The plugin utilizes mobiledetect without preventing direct access to the files, leading to **Full Path Disclosure**.\n3.  **Impact:** Unauthenticated attackers can retrieve the full path of the web application.\n\n## Summary of Analysis\nThe initial assessment considered various CWEs, but after analyzing the vulnerability description and the retriever results, CWE-548 was deemed the most appropriate due to its direct relevance to **information exposure through directory listing**. The vulnerability description clearly states that the plugin utilizing mobiledetect without preventing direct access to the files leads to **Full Path Disclosure**, which aligns with CWE-548.\n\nThe decision is based on the provided evidence and the direct match between the vulnerability and the CWE description. The selected CWE is at the optimal level of specificity, as it accurately represents the nature of the weakness.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-425: Direct Request ('Forced Browsing')\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-548: Information Exposure Through Directory Listing\n**Abstraction Level**: Base\n\n**Description**:\nThe web server contains a feature that lists the files and directories in a web-accessible directory, but the feature is enabled when it should not be, or access to this feature is not properly restricted.\n\n### Technical Explanation for Selected CWEs:\n\n*   **CWE-548: Information Exposure Through Directory Listing**\n    *   **Match:** The vulnerability allows unauthenticated attackers to retrieve the full path of the web application due to the plugin utilizing mobiledetect without preventing direct access to the files. This aligns with the CWE description, which involves listing files and directories in a web-accessible directory.\n    *   **Security Implications:** Full Path Disclosure can aid attackers in reconnaissance by providing information about the server's file structure, potentially facilitating other attacks.\n    *   **Relationship:** This is the primary weakness.\n    *   **Mapping Guidance:** The description directly fits the CWE.\n*   **CWE-425: Direct Request ('Forced Browsing')**\n    *   **Match:** This vulnerability could be seen as an instance of forced browsing because the mobiledetect files are directly accessible without proper authorization.\n    *   **Security Implications:** Attackers can access resources they shouldn't, potentially leading to further exploitation.\n    *   **Relationship:** This could be a contributing factor, but not the primary cause.\n    *   **Mapping Guidance:** The description fits, but not as directly as CWE-548.\n*   **CWE-200: Exposure of Sensitive Information to an Unauthorized Actor**\n    *   **Match:** While the full path can be considered sensitive information, CWE-548 is more specific to directory listing and information exposure.\n    *   **Security Implications:** Exposing the full path can aid attackers in reconnaissance.\n    *   **Relationship:** This is a more general CWE and not the primary cause.\n    *   **Mapping Guidance:** Discouraged because it is a class-level CWE when a more specific base-level CWE is available.\n\n### CWEs Considered but Not Used:\n\n*   CWE-862 (Missing Authorization), CWE-639 (Authorization Bypass Through User-Controlled Key), CWE-306 (Missing Authentication for Critical Function): These CWEs relate to authorization and authentication issues. While there's a **lack of access control**, the direct result is **information exposure**, making CWE-548 more relevant.\n*   CWE-352 (Cross-Site Request Forgery (CSRF)): This CWE is not applicable as the vulnerability is not related to CSRF.\n*   CWE-201 (Insertion of Sensitive Information Into Sent Data): This CWE is not applicable as the vulnerability is about information exposure rather than insertion of sensitive information.\n*   CWE-863 (Incorrect Authorization): Similar to CWE-862, this is related to authorization issues, but the direct result is information exposure, making CWE-548 more relevant.\n*   CWE-36 (Absolute Path Traversal): The vulnerability doesn't involve path traversal.\n*   CWE-471 (Modification of Assumed-Immutable Data (MAID)): This CWE is not applicable as the vulnerability is not related to modifying immutable data.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-548 | Information Exposure Through Directory Listing | 0.8 | Base | Allowed | Primary CWE |\n| CWE-425 | Direct Request ('Forced Browsing') | 0.5 | Base | Allowed | Secondary Candidate |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.4 | Class | Discouraged | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE, CWE-548, is related to information exposure. While other CWEs like CWE-425 and CWE-200 were considered, CWE-548 directly addresses the **full path disclosure** aspect. The hierarchical relationships did not significantly influence the selection, as the focus was on identifying the most specific and relevant CWE based on the vulnerability description.\n\n```mermaid\ngraph TD\n    cwe548[\"CWE-548: Information Exposure Through Directory Listing\"]\n    cwe425[\"CWE-425: Direct Request ('Forced Browsing')\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n\n    cwe548 -->|PEEROF| cwe200\n    cwe425 -->|CANPRECEDE| cwe548\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe548 primary\n    class cwe425,cwe200 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **lack of access control** on certain files, leading to the **exposure of the full path**.\n\n1.  **Root Cause:** Missing or **Improper Access Control** on files.\n2.  **Weakness:** The plugin utilizes mobiledetect without preventing direct access to the files, leading to **Full Path Disclosure**.\n3.  **Impact:** Unauthenticated attackers can retrieve the full path of the web application.\n\n## Summary of Analysis\nThe initial assessment considered various CWEs, but after analyzing the vulnerability description and the retriever results, CWE-548 was deemed the most appropriate due to its direct relevance to **information exposure through directory listing**. The vulnerability description clearly states that the plugin utilizing mobiledetect without preventing direct access to the files leads to **Full Path Disclosure**, which aligns with CWE-548.\n\nThe decision is based on the provided evidence and the direct match between the vulnerability and the CWE description. The selected CWE is at the optimal level of specificity, as it accurately represents the nature of the weakness.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-425: Direct Request ('Forced Browsing')\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-548: Information Exposure Through Directory Listing\n**Abstraction Level**: Base\n\n**Description**:\nThe web server contains a feature that lists the files and directories in a web-accessible directory, but the feature is enabled when it should not be, or access to this feature is not properly restricted.\n\n### Technical Explanation for Selected CWEs:\n\n*   **CWE-548: Information Exposure Through Directory Listing**\n    *   **Match:** The vulnerability allows unauthenticated attackers to retrieve the full path of the web application due to the plugin utilizing mobiledetect without preventing direct access to the files. This aligns with the CWE description, which involves listing files and directories in a web-accessible directory.\n    *   **Security Implications:** Full Path Disclosure can aid attackers in reconnaissance by providing information about the server's file structure, potentially facilitating other attacks.\n    *   **Relationship:** This is the primary weakness.\n    *   **Mapping Guidance:** The description directly fits the CWE.\n*   **CWE-425: Direct Request ('Forced Browsing')**\n    *   **Match:** This vulnerability could be seen as an instance of forced browsing because the mobiledetect files are directly accessible without proper authorization.\n    *   **Security Implications:** Attackers can access resources they shouldn't, potentially leading to further exploitation.\n    *   **Relationship:** This could be a contributing factor, but not the primary cause.\n    *   **Mapping Guidance:** The description fits, but not as directly as CWE-548.\n*   **CWE-200: Exposure of Sensitive Information to an Unauthorized Actor**\n    *   **Match:** While the full path can be considered sensitive information, CWE-548 is more specific to directory listing and information exposure.\n    *   **Security Implications:** Exposing the full path can aid attackers in reconnaissance.\n    *   **Relationship:** This is a more general CWE and not the primary cause.\n    *   **Mapping Guidance:** Discouraged because it is a class-level CWE when a more specific base-level CWE is available.\n\n### CWEs Considered but Not Used:\n\n*   CWE-862 (Missing Authorization), CWE-639 (Authorization Bypass Through User-Controlled Key), CWE-306 (Missing Authentication for Critical Function): These CWEs relate to authorization and authentication issues. While there's a **lack of access control**, the direct result is **information exposure**, making CWE-548 more relevant.\n*   CWE-352 (Cross-Site Request Forgery (CSRF)): This CWE is not applicable as the vulnerability is not related to CSRF.\n*   CWE-201 (Insertion of Sensitive Information Into Sent Data): This CWE is not applicable as the vulnerability is about information exposure rather than insertion of sensitive information.\n*   CWE-863 (Incorrect Authorization): Similar to CWE-862, this is related to authorization issues, but the direct result is information exposure, making CWE-548 more relevant.\n*   CWE-36 (Absolute Path Traversal): The vulnerability doesn't involve path traversal.\n*   CWE-471 (Modification of Assumed-Immutable Data (MAID)): This CWE is not applicable as the vulnerability is not related to modifying immutable data.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-471:**\n- 471 (Modification of Assumed-Immutable Data (MAID)) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "862",
        "name": "Missing Authorization",
        "source": "sparse"
      },
      "similarity": 176.77840308188703
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 175.99788490263722
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 173.04961962660656
    },
    {
      "metadata": {
        "doc_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "source": "sparse"
      },
      "similarity": 171.87911890509008
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 170.7790912359517
    },
    {
      "metadata": {
        "doc_id": "425",
        "name": "Direct Request ('Forced Browsing')",
        "source": "sparse"
      },
      "similarity": 169.70490476752906
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 169.18367693275633
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 168.35745558817916
    },
    {
      "metadata": {
        "doc_id": "36",
        "name": "Absolute Path Traversal",
        "type": "Base",
        "original_content": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize absolute path sequences such as \"/abs/path\" that can resolve to a location that is outside of that directory.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5094458664687066,
            "graph": 1.4929582817957046
          }
        }
      },
      "similarity": 0.5094458664687066
    },
    {
      "doc_id": "471",
      "text": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "471",
        "name": "Modification of Assumed-Immutable Data (MAID)",
        "type": "base",
        "original_content": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
        "relationships": [
          {
            "source_id": "471",
            "target_id": "621",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "607",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "602",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "473",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "425",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "291",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1321",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1282",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "471",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "621",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "607",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "602",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "473",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "425",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "291",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1321",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1282",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "425"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "425"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-471",
      "CWE-862",
      "CWE-639",
      "CWE-306",
      "CWE-201",
      "CWE-352",
      "CWE-548",
      "CWE-36",
      "CWE-200",
      "CWE-425"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}