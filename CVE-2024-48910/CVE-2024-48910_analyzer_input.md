# Vulnerability Information: CVE-2024-48910

## Vulnerability Description
DOMPurify is a DOM-only, super-fast, uber-tolerant **XSS** sanitizer for HTML, MathML and SVG. DOMPurify was vulnerable to **prototype pollution**. This vulnerability is fixed in 2.4.2.

### Vulnerability Description Key Phrases
- **rootcause:** **prototype pollution**
- **weakness:** **XSS**
- **product:** DOMPurify
- **version:** 2.4.2

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-48910.

**Root cause of vulnerability:**
The vulnerability is due to a prototype pollution issue in DOMPurify.

**Weaknesses/vulnerabilities present:**
- Prototype pollution: The vulnerability allows an attacker to modify the prototype of JavaScript objects, potentially leading to unexpected behavior or code execution.
- The vulnerability is located in the `clone` function within `src/utils.js` where it iterates through the properties of an object and copies them. The code was vulnerable to prototype pollution via the hasOwnProperty check.

**Impact of exploitation:**
- The vulnerability could lead to a bypass of DOMPurify's sanitization, potentially leading to cross-site scripting (XSS) attacks if an attacker can control the input that is processed by the library.
- In the specific test case added to address this vulnerability, arbitrary attributes could be injected into HTML tags even if they were not explicitly allowed.

**Attack vectors:**
- Network: The attack can be performed remotely.
- The attacker needs to supply crafted input to the DOMPurify library, which will then modify the prototype chain.
- The attacker can modify the prototype of the object that is being cloned, leading to unexpected behavior when DOMPurify uses this object to configure itself.

**Required attacker capabilities/position:**
- The attacker does not require any special privileges or user interaction.
- The attacker needs to be able to control the input that is processed by the DOMPurify library.

**Additional details:**
- The vulnerability was fixed in version 2.4.2 by modifying the `clone` function within `src/utils.js` to explicitly check `hasOwnProperty` with call to avoid prototype pollution.
- The commit `d1dd037` on Github includes the fix for this vulnerability, and adds a test case to ensure that the fix is effective. The test case demonstrates how an attacker can exploit the vulnerability via `__proto__` and `constructor.prototype` to inject arbitrary attributes in tags.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.303 |
| 3 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | sparse | 0.159 |
| 4 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.155 |
| 5 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.153 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.138 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.138 |
| 8 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.133 |
| 9 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | dense | 0.509 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

