# Raw Retriever Results for CVE-2024-57999

# Raw Retriever Results for CVE-2024-57999
## Query
In the Linux kernel, the following vulnerability has been resolved powerpc/pseries/iommu IOMMU incorrectly marks MMIO range in DDW Power Hypervisor can possibily allocate MMIO window intersecting with Dynamic DMA Window (DDW) range, which is over 32-bit addressing. These MMIO pages needs to be marked as reserved so that IOMMU doesnt map DMA buffers in this range. The current code is not marking these pages correctly which is resulting in LPAR to OOPS while booting. The stack is at below BUG Unable to handle kernel data access on read at 0xc00800005cd40000 Faulting instruction address 0xc00000000005cdac Oops Kernel access of bad area, sig 11

## Keyphrases
- **rootcause**: 'IOMMU incorrectly marks MMIO range in DDW'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5444 | 0.6416 | 0.5658 | 0.5573 | 20 |
| Sparse | 139.4129 | 522.2771 | 430.6106 | 446.2262 | 11 |
| Graph | 1.6736 | 3.4866 | 2.0229 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | base | 3.4866 | Allowed |
| 2 | 789 | Memory Allocation with Excessive Size Value | variant | 2.6784 | Allowed |
| 3 | 125 | Out-of-bounds Read | base | 2.3998 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.3998 | Allowed |
| 5 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 6 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 7 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 8 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 9 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 10 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 11 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 12 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 13 | 128 | Wrap-around Error | base | 1.6848 | Allowed |
| 14 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 1.6848 | Allowed |
| 15 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.6416 | 0.6416 | Allowed |
| 2 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 0.6015 | 0.6015 | Allowed |
| 3 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.5879 | 0.5879 | Allowed |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5832 | 0.5832 | Allowed |
| 5 | 1262 | Improper Access Control for Register Interface | Base | 0.5808 | 0.5808 | Allowed |
| 6 | 823 | Use of Out-of-range Pointer Offset | Base | 0.5671 | 0.5671 | Allowed |
| 7 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.5652 | 0.5652 | Allowed |
| 8 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5649 | 0.5649 | Allowed |
| 9 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.5634 | 0.5634 | Allowed |
| 10 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.5602 | 0.5602 | Allowed |
| 11 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.5543 | 0.5543 | Allowed |
| 12 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.5537 | 0.5537 | Allowed |
| 13 | 909 | Missing Initialization of Resource | Class | 0.5533 | 0.5533 | Allowed-with-Review |
| 14 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5514 | 0.5514 | Discouraged |
| 15 | 805 | Buffer Access with Incorrect Length Value | Base | 0.5508 | 0.5508 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | 522.2771 | 522.2771 | Allowed |
| 2 | 662 | Improper Synchronization | 482.9581 | 482.9581 | Discouraged |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | 467.6119 | 467.6119 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | 461.3680 | 461.3680 | Allowed |
| 5 | 125 | Out-of-bounds Read | 458.1447 | 458.1447 | Allowed |
| 6 | 194 | Unexpected Sign Extension | 446.2262 | 446.2262 | Allowed |
| 7 | 787 | Out-of-bounds Write | 445.6932 | 445.6932 | Allowed |
| 8 | 823 | Use of Out-of-range Pointer Offset | 442.5471 | 442.5471 | Allowed |
| 9 | 674 | Uncontrolled Recursion | 440.7582 | 440.7582 | Allowed-with-Review |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 429.7195 | 429.7195 | Allowed |
| 11 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 139.4129 | 139.4129 | Allowed-with-Review |
