# Raw Retriever Results for CVE-2025-25202

# Raw Retriever Results for CVE-2025-25202
## Query
Ash Authentication is an authentication framework for Elixir applications. Applications which have been bootstrapped by the igniter installer present since AshAuthentication v4.1.0 and who have used the magic link strategy _or_ are manually revoking tokens are affected by revoked tokens being allowed to verify as valid. Unless one hase implemented any kind of custom token revocation feature in your application, then one will not be affected. The impact here for users using builtin functionality is that magic link tokens are reusable until they expire. With that said, magic link tokens are only valid for 10 minutes, so the surface area for abuse is extremely low here. The flaw is patched in version 4.4.9. Additionally a compile time warning is shown to users with remediation instructions if they upgrade. 4.4.9 ships with an upgrader, so those who use `mix igniter.upgrade ash_authentication` will have the necessary patch applied. Otherwise, one may run the upgrader manually as described in the error message. As a workaround, delete the generated `revoked?` generic action in the token resource. This will cause it to use the one internal to Ash Authentication which has always been correct. Alternatively, manually make the changes that are included in the patch.

## Keyphrases
- **rootcause**: 'revoked tokens being allowed to verify as valid'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3778 | 0.4177 | 0.3927 | 0.3893 | 20 |
| Sparse | 307.8280 | 1072.6169 | 932.8132 | 963.8767 | 11 |
| Graph | 1.1587 | 2.2100 | 1.5309 | 1.4597 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 4 | 294 | Authentication Bypass by Capture-replay | Base | 1.6686 | Allowed |
| 5 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 1.6677 | Allowed |
| 6 | 304 | Missing Critical Step in Authentication | Base | 1.6274 | Allowed |
| 7 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 8 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 9 | 613 | Insufficient Session Expiration | Base | 1.5081 | Allowed |
| 10 | 322 | Key Exchange without Entity Authentication | base | 1.4602 | Allowed |
| 11 | 1270 | Generation of Incorrect Security Tokens | Base | 1.4592 | Allowed |
| 12 | 347 | Improper Verification of Cryptographic Signature | Base | 1.4427 | Allowed |
| 13 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.3747 | Allowed |
| 14 | 291 | Reliance on IP Address for Authentication | Variant | 1.3651 | Allowed |
| 15 | 863 | Incorrect Authorization | class | 1.3648 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1270 | Generation of Incorrect Security Tokens | Base | 0.4177 | 0.4177 | Allowed |
| 2 | 304 | Missing Critical Step in Authentication | Base | 0.4155 | 0.4155 | Allowed |
| 3 | 294 | Authentication Bypass by Capture-replay | Base | 0.4124 | 0.4124 | Allowed |
| 4 | 291 | Reliance on IP Address for Authentication | Variant | 0.4085 | 0.4085 | Allowed |
| 5 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 0.4057 | 0.4057 | Allowed |
| 6 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.3996 | 0.3996 | Allowed |
| 7 | 613 | Insufficient Session Expiration | Base | 0.3981 | 0.3981 | Allowed |
| 8 | 603 | Use of Client-Side Authentication | Base | 0.3977 | 0.3977 | Allowed |
| 9 | 308 | Use of Single-factor Authentication | Base | 0.3970 | 0.3970 | Allowed |
| 10 | 307 | Improper Restriction of Excessive Authentication Attempts | Base | 0.3951 | 0.3951 | Allowed |
| 11 | 1390 | Weak Authentication | Class | 0.3835 | 0.3835 | Allowed-with-Review |
| 12 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 0.3831 | 0.3831 | Allowed |
| 13 | 289 | Authentication Bypass by Alternate Name | Base | 0.3829 | 0.3829 | Allowed |
| 14 | 939 | Improper Authorization in Handler for Custom URL Scheme | Base | 0.3820 | 0.3820 | Allowed |
| 15 | 287 | Improper Authentication | Class | 0.3820 | 0.3820 | Discouraged |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1390 | Weak Authentication | 1072.6169 | 1072.6169 | Allowed-with-Review |
| 2 | 863 | Incorrect Authorization | 1063.0908 | 1063.0908 | Allowed-with-Review |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 1062.9911 | 1062.9911 | Allowed |
| 4 | 287 | Improper Authentication | 986.5661 | 986.5661 | Discouraged |
| 5 | 347 | Improper Verification of Cryptographic Signature | 970.8705 | 970.8705 | Allowed |
| 6 | 116 | Improper Encoding or Escaping of Output | 963.8767 | 963.8767 | Allowed-with-Review |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 960.9609 | 960.9609 | Allowed |
| 8 | 285 | Improper Authorization | 960.1864 | 960.1864 | Discouraged |
| 9 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 958.1456 | 958.1456 | Allowed-with-Review |
| 10 | 306 | Missing Authentication for Critical Function | 953.8125 | 953.8125 | Allowed |
| 11 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 307.8280 | 307.8280 | Allowed |
