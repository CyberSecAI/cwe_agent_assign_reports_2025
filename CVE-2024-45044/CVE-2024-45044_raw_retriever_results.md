# Raw Retriever Results for CVE-2024-45044

# Raw Retriever Results for CVE-2024-45044
## Query
Bareos is open source software for backup, archiving, and recovery of data for operating systems. When a command ACL is in place and a user executes a command in bconsole using an abbreviation (i.e. w for whoami) the ACL check did not apply to the full form (i.e. whoami) but to the abbreviated form (i.e. w). If the command ACL is configured with negative ACL that should forbid using the whoami command, you could still use w or who as a command successfully. Fixes for the problem are shipped in Bareos versions 23.0.4, 22.1.6 and 21.1.11. If only positive command ACLs are used without any negation, the problem does not occur.

## Keyphrases
- **weakness**: 'command injection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3247 | 0.4492 | 0.3646 | 0.3625 | 20 |
| Sparse | 187.7221 | 1000.0000 | 543.5855 | 548.2568 | 13 |
| Graph | 1.3676 | 3.6400 | 1.8104 | 1.6392 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | base | 3.6400 | Allowed |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 3.6400 | Allowed |
| 3 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 1.8437 | Allowed |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 7 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 9 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 10 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | 1.6464 | Allowed |
| 11 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 12 | 73 | External Control of File Name or Path | Base | 1.4796 | Allowed |
| 13 | 449 | The UI Performs the Wrong Action | Base | 1.4432 | Allowed |
| 14 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 1.4416 | Allowed |
| 15 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 1.4359 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 530 | Exposure of Backup File to an Unauthorized Control Sphere | Variant | 0.4492 | 0.4492 | Allowed |
| 2 | 449 | The UI Performs the Wrong Action | Base | 0.4151 | 0.4151 | Allowed |
| 3 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.4075 | 0.4075 | Allowed |
| 4 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 0.4066 | 0.4066 | Allowed |
| 5 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | 0.3909 | 0.3909 | Allowed |
| 6 | 277 | Insecure Inherited Permissions | Variant | 0.3888 | 0.3888 | Allowed |
| 7 | 289 | Authentication Bypass by Alternate Name | Base | 0.3881 | 0.3881 | Allowed |
| 8 | 708 | Incorrect Ownership Assignment | Base | 0.3847 | 0.3847 | Allowed |
| 9 | 641 | Improper Restriction of Names for Files and Other Resources | Base | 0.3826 | 0.3826 | Allowed |
| 10 | 224 | Obscured Security-relevant Information by Alternate Name | Base | 0.3797 | 0.3797 | Allowed |
| 11 | 281 | Improper Preservation of Permissions | Base | 0.3452 | 0.3452 | Allowed |
| 12 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.3357 | 0.3357 | Allowed |
| 13 | 553 | Command Shell in Externally Accessible Directory | Variant | 0.3300 | 0.3300 | Allowed |
| 14 | 286 | Incorrect User Management | Class | 0.3295 | 0.3295 | Allowed-with-Review |
| 15 | 150 | Improper Neutralization of Escape, Meta, or Control Sequences | Variant | 0.3289 | 0.3289 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 700.0000 | 700.0000 | Allowed |
| 3 | 863 | Incorrect Authorization | 592.7399 | 592.7399 | Allowed-with-Review |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 568.5172 | 568.5172 | Allowed |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 560.2307 | 560.2307 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | 552.1303 | 552.1303 | Allowed |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | 548.2568 | 548.2568 | Allowed-with-Review |
| 8 | 306 | Missing Authentication for Critical Function | 545.7799 | 545.7799 | Allowed |
| 9 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 542.3145 | 542.3145 | Allowed |
| 10 | 250 | Execution with Unnecessary Privileges | 541.3595 | 541.3595 | Allowed |
| 11 | 285 | Improper Authorization | 539.3970 | 539.3970 | Discouraged |
| 12 | 347 | Improper Verification of Cryptographic Signature | 188.1634 | 188.1634 | Allowed |
| 13 | 190 | Integer Overflow or Wraparound | 187.7221 | 187.7221 | Allowed |
