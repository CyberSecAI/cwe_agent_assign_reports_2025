# Raw Retriever Results for CVE-2024-41013

# Raw Retriever Results for CVE-2024-41013
## Query
In the Linux kernel, the following vulnerability has been resolved xfs dont walk off the end of a directory data block This adds sanity checks for xfs_dir2_data_unused and xfs_dir2_data_entry to make sure dont stray beyond valid memory region. Before patching, the loop simply checks that the start offset of the dup and dep is within the range. So in a crafted image, if last entry is xfs_dir2_data_unused, we can change dup->length to dup->length-1 and leave 1 byte of space. In the next traversal, this space will be considered as dup or dep. We may encounter an out of bound read when accessing the fixed members. In the patch, we make sure that the remaining bytes large enough to hold an unused entry before accessing xfs_dir2_data_unused and xfs_dir2_data_unused is XFS_DIR2_DATA_ALIGN byte aligned. We also make sure that the remaining bytes large enough to hold a dirent with a single-byte name before accessing xfs_dir2_data_entry.

## Keyphrases
- **rootcause**: 'improper off-by-one boundary check'
- **weakness**: 'out of bounds read'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4229 | 0.4907 | 0.4467 | 0.4481 | 20 |
| Sparse | 689.9805 | 833.0804 | 753.3124 | 738.4597 | 12 |
| Graph | 1.6848 | 4.3290 | 2.2683 | 2.0342 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 787 | Out-of-bounds Write | base | 4.3290 | Allowed |
| 2 | 190 | Integer Overflow or Wraparound | base | 3.8038 | Allowed |
| 3 | 823 | Use of Out-of-range Pointer Offset | Base | 2.8018 | Allowed |
| 4 | 125 | Out-of-bounds Read | Base | 2.7879 | Allowed |
| 5 | 193 | Off-by-one Error | Base | 2.4734 | Allowed |
| 6 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 7 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 8 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 9 | 617 | Reachable Assertion | base | 2.2100 | Allowed |
| 10 | 129 | Improper Validation of Array Index | variant | 2.0400 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.0284 | Allowed |
| 12 | 123 | Write-what-where Condition | base | 2.0228 | Allowed |
| 13 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 14 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4907 | 0.4907 | Allowed |
| 2 | 606 | Unchecked Input for Loop Condition | Base | 0.4768 | 0.4768 | Allowed |
| 3 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4633 | 0.4633 | Allowed |
| 4 | 62 | UNIX Hard Link | Variant | 0.4632 | 0.4632 | Allowed |
| 5 | 909 | Missing Initialization of Resource | Class | 0.4587 | 0.4587 | Allowed-with-Review |
| 6 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4563 | 0.4563 | Allowed |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4529 | 0.4529 | Allowed |
| 8 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4518 | 0.4518 | Allowed |
| 9 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.4516 | 0.4516 | Allowed |
| 10 | 72 | Improper Handling of Apple HFS+ Alternate Data Stream Path | Variant | 0.4515 | 0.4515 | Allowed |
| 11 | 786 | Access of Memory Location Before Start of Buffer | Base | 0.4447 | 0.4447 | Discouraged |
| 12 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.4444 | 0.4444 | Allowed |
| 13 | 911 | Improper Update of Reference Count | Base | 0.4435 | 0.4435 | Allowed |
| 14 | 667 | Improper Locking | Class | 0.4287 | 0.4287 | Allowed-with-Review |
| 15 | 908 | Use of Uninitialized Resource | Base | 0.4280 | 0.4280 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 125 | Out-of-bounds Read | 833.0804 | 833.0804 | Allowed |
| 2 | 193 | Off-by-one Error | 814.7931 | 814.7931 | Allowed |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | 801.6883 | 801.6883 | Allowed |
| 4 | 190 | Integer Overflow or Wraparound | 779.7134 | 779.7134 | Allowed |
| 5 | 787 | Out-of-bounds Write | 773.8213 | 773.8213 | Allowed |
| 6 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 745.1748 | 745.1748 | Allowed |
| 7 | 194 | Unexpected Sign Extension | 731.7446 | 731.7446 | Allowed |
| 8 | 789 | Memory Allocation with Excessive Size Value | 728.8620 | 728.8620 | Allowed |
| 9 | 617 | Reachable Assertion | 727.8751 | 727.8751 | Allowed |
| 10 | 126 | Buffer Over-read | 721.4422 | 721.4422 | Allowed |
| 11 | 131 | Incorrect Calculation of Buffer Size | 691.5726 | 691.5726 | Allowed |
| 12 | 122 | Heap-based Buffer Overflow | 689.9805 | 689.9805 | Allowed |
