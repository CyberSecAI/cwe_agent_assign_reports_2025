## Vulnerability Description
A vulnerability has been found in FreeFloat FTP Server 1.0 and classified as critical. This vulnerability affects unknown code of the component HASH Command Handler. The manipulation leads to **buffer overflow**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **vector:** manipulation
- **product:** FreeFloat FTP Server
- **version:** 1
- **component:** HASH Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-4791 Content

Based on the provided content, this relates to a vulnerability in Freefloat FTP Server version 1.0. The content details a remote buffer overflow exploit targeting the 'HASH' command.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the handling of the 'HASH' command in Freefloat FTP Server 1.0. The server does not properly validate the size of the input provided with the 'HASH' command, allowing an attacker to send a larger payload than the buffer can hold, overwriting adjacent memory regions.

**Weaknesses/vulnerabilities present:**

*   Buffer Overflow
*   Lack of input validation

**Impact of exploitation:**

Successful exploitation allows an attacker to overwrite the execution flow of the program, potentially leading to arbitrary code execution. The exploit author demonstrates achieving a reverse shell.

**Attack vectors:**

*   Remote attacker can send a crafted 'HASH' command to the FTP server.

**Required attacker capabilities/position:**

*   Network access to the vulnerable FTP server.
*   Ability to send arbitrary data to the FTP server's 'HASH' command.

**Mitigation or fix:**

The content does not provide information about a specific fix. However, mitigation would involve:

*   Implementing proper input validation to ensure the 'HASH' command input does not exceed the buffer size.
*   Using safe string handling functions to prevent buffer overflows.

**Additional Details (more than official CVE description):**

*   **Tested on:** Windows XP SP3 English
*   **Offset:** 2006 bytes
*   **Bad characters:** `\x00\x0a\x0d`
*   **EIP overwrite:** `0x7C86467B` (JMP ESP) - indicating the exploit aims to redirect execution to a shellcode.
*   The exploit uses `msfvenom` to generate a shellcode and Perl to construct and send the malicious payload.
*   The exploit script connects to the FTP server, authenticates as an anonymous user, and then sends the crafted 'HASH' command.
*   The exploit includes a payload designed to execute a reverse TCP shell, connecting back to `192.168.232.129` on port `4444`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.364 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.337 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.306 |
| 7 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.299 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.294 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.586 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-125: Out-of-bounds Read

CWE-674: Uncontrolled Recursion

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-121: Stack-based Buffer Overflow

CWE-128: Wrap-around Error