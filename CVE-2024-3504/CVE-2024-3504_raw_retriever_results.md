# Raw Retriever Results for CVE-2024-3504

# Raw Retriever Results for CVE-2024-3504
## Query
An improper access control vulnerability exists in lunary-ai/lunary versions up to and including 1.2.2, where an admin can update any organization user to the organization owner. This vulnerability allows the elevated user to delete projects within the organization. The issue is resolved in version 1.2.7.

## Keyphrases
- **rootcause**: 'improper access control'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4503 | 0.5211 | 0.4815 | 0.4817 | 20 |
| Sparse | 87.2121 | 317.2857 | 279.0585 | 298.4876 | 11 |
| Graph | 1.0062 | 1.7118 | 1.2341 | 1.1352 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 708 | Incorrect Ownership Assignment | Base | 1.7118 | Allowed |
| 2 | 842 | Placement of User into Incorrect Group | Base | 1.7076 | Allowed |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.7032 | Allowed |
| 4 | 267 | Privilege Defined With Unsafe Actions | Base | 1.6230 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.5210 | Allowed |
| 6 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.2864 | Allowed |
| 7 | 610 | Externally Controlled Reference to a Resource in Another Sphere | class | 1.1920 | Discouraged |
| 8 | 1304 | Improperly Preserved Integrity of Hardware Configuration State During a Power Save/Restore Operation | base | 1.1466 | Allowed |
| 9 | 358 | Improperly Implemented Security Check for Standard | base | 1.1466 | Allowed |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 1.1466 | Allowed |
| 11 | 266 | Incorrect Privilege Assignment | Base | 1.1239 | Allowed |
| 12 | 286 | Incorrect User Management | Class | 1.0720 | Allowed-with-Review |
| 13 | 282 | Improper Ownership Management | Class | 1.0702 | Allowed-with-Review |
| 14 | 486 | Comparison of Classes by Name | variant | 1.0584 | Allowed |
| 15 | 863 | Incorrect Authorization | Class | 1.0569 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 708 | Incorrect Ownership Assignment | Base | 0.5211 | 0.5211 | Allowed |
| 2 | 842 | Placement of User into Incorrect Group | Base | 0.5136 | 0.5136 | Allowed |
| 3 | 286 | Incorrect User Management | Class | 0.5124 | 0.5124 | Allowed-with-Review |
| 4 | 282 | Improper Ownership Management | Class | 0.5093 | 0.5093 | Allowed-with-Review |
| 5 | 267 | Privilege Defined With Unsafe Actions | Base | 0.5073 | 0.5073 | Allowed |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4936 | 0.4936 | Allowed |
| 7 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4921 | 0.4921 | Allowed |
| 8 | 863 | Incorrect Authorization | Class | 0.4906 | 0.4906 | Allowed-with-Review |
| 9 | 285 | Improper Authorization | Class | 0.4897 | 0.4897 | Discouraged |
| 10 | 277 | Insecure Inherited Permissions | Variant | 0.4897 | 0.4897 | Allowed |
| 11 | 269 | Improper Privilege Management | Class | 0.4737 | 0.4737 | Discouraged |
| 12 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4734 | 0.4734 | Allowed |
| 13 | 283 | Unverified Ownership | Base | 0.4700 | 0.4700 | Allowed |
| 14 | 266 | Incorrect Privilege Assignment | Base | 0.4634 | 0.4634 | Allowed |
| 15 | 284 | Improper Access Control | Pillar | 0.4625 | 0.4625 | Discouraged |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 285 | Improper Authorization | 317.2857 | 317.2857 | Discouraged |
| 2 | 610 | Externally Controlled Reference to a Resource in Another Sphere | 311.5543 | 311.5543 | Discouraged |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | 311.4834 | 311.4834 | Allowed |
| 4 | 863 | Incorrect Authorization | 307.6202 | 307.6202 | Allowed-with-Review |
| 5 | 267 | Privilege Defined With Unsafe Actions | 303.8987 | 303.8987 | Allowed |
| 6 | 269 | Improper Privilege Management | 298.4876 | 298.4876 | Discouraged |
| 7 | 347 | Improper Verification of Cryptographic Signature | 290.2144 | 290.2144 | Allowed |
| 8 | 284 | Improper Access Control | 284.2774 | 284.2774 | Discouraged |
| 9 | 287 | Improper Authentication | 282.7130 | 282.7130 | Discouraged |
| 10 | 306 | Missing Authentication for Critical Function | 274.8963 | 274.8963 | Allowed |
| 11 | 321 | Use of Hard-coded Cryptographic Key | 87.2121 | 87.2121 | Allowed |
