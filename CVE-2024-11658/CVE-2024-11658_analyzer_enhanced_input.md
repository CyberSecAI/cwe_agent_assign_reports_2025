## Vulnerability Description
A vulnerability has been found in EnGenius ENH1350EXT, ENS500-AC and ENS620EXT up to 20241118 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /admin/network/ajax_getChannelList. The manipulation of the argument countryCode leads to **command injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** EnGenius ENH1350EXT and ENS500-AC and ENS620EXT
- **version:** up to 20241118
- **component:** /admin/network/ajax_getChannelList

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from insufficient input sanitization in the `ajax_getChannelList` interface of ENGENIUS routers. Specifically, the `countryCode` parameter, which is received via an HTTP GET request, is directly passed to the `iwpriv_SetGreenMode` function without proper filtering or escaping.

**Weaknesses/Vulnerabilities:**

*   **Command Injection:** The lack of sanitization allows an attacker to inject arbitrary shell commands within the `countryCode` parameter. This is because the value is concatenated directly into a system command executed by the router's firmware.
*   The `iwpriv_SetGreenMode` function is used to set the country code and other parameters related to Wi-Fi, but it does not properly sanitize the input leading to the vulnerability.

**Impact of Exploitation:**

*   **Arbitrary Command Execution:** Successful exploitation allows an attacker to execute arbitrary commands on the underlying system with root privileges, potentially gaining full control of the router.
*   **System Compromise:** An attacker can manipulate the router's configuration, install malware, establish backdoors, exfiltrate sensitive information, and perform other malicious actions.

**Attack Vectors:**

*   **HTTP GET Request:** The attack vector is an HTTP GET request to the `/cgi-bin/luci/;stok=.../admin/network/ajax_getChannelList` endpoint.
*   **`countryCode` Parameter:** The malicious command is injected within the `countryCode` parameter of the GET request.

**Required Attacker Capabilities/Position:**

*   **Authentication:** The attacker needs to be logged into the device's administration interface. This suggests that the vulnerability is exploitable by an authenticated user, not necessarily a remote unauthenticated one.
*   **Network Access:** The attacker needs network access to the router's web interface to send the malicious HTTP request.
*   **Knowledge of the API endpoint:** The attacker needs knowledge of the vulnerable API endpoint `/admin/network/ajax_getChannelList`.

**Additional Notes:**

*   The provided content includes a sample HTTP request demonstrating the vulnerability. The injected command is a `curl` command that will make a DNS request to `ovnezs0so8rjlwqo2bx04jbolfr6fxfl4.oastify.com` that can be used to verify that the command execution is succesful.
*   The vulnerability is present in multiple Engenius router models and all firmware versions according to the report, including the latest one.
*   The report indicates that the vendor was contacted but did not respond.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.528 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.496 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.423 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.423 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.410 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.399 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.605 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-306: Missing Authentication for Critical Function

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs