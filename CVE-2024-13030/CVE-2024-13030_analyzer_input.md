# Vulnerability Information: CVE-2024-13030

## Vulnerability Description
A vulnerability was found in D-Link DIR-823G 1.0.2B05_20181207. It has been rated as critical. This issue affects the function SetAutoRebootSettings/SetClientInfo/SetDMZSettings/SetFirewallSettings/SetParentsControlInfo/SetQoSSettings/SetVirtualServerSettings of the file /HNAP1/ of the component Web Management Interface. The manipulation leads to **improper access controls**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access controls**
- **product:** D-Link DIR-823G
- **version:** 1.0.2B05_20181207
- **component:** Web Management Interface

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability described:

**Root Cause of Vulnerability:**

- The root cause is an improper access control vulnerability in the web management interface of the D-Link DIR-823G router. Specifically, the vulnerability is located in the `/HNAP1/` endpoint.

**Weaknesses/Vulnerabilities Present:**

- **Missing Authentication:** The web management interface allows unauthenticated HTTP POST requests to the `/HNAP1/` endpoint when the `SOAPAction` header is set to `SetAutoRebootSettings`. This lack of authentication allows anyone on the network to access and modify the auto-reboot settings.
- **Improper Access Control:** The vulnerability stems from the lack of proper access control mechanisms that should restrict unauthorized users from accessing and modifying sensitive device configurations like the auto-reboot settings.

**Impact of Exploitation:**

- **Denial of Service (DoS):** By exploiting this vulnerability, an attacker can arbitrarily set the auto-reboot settings for the router. This may allow an attacker to force the device to repeatedly reboot, causing a denial of service by disrupting network access.
- **Disruption of Network Operation**: Setting incorrect reboot settings will disrupt normal network operation.

**Attack Vectors:**

- **Network Access:** The attacker needs to be on the same network as the vulnerable D-Link router to send the crafted HTTP POST request.
- **HTTP POST Request:** The attack is performed by sending a specially crafted HTTP POST request to `/HNAP1/` endpoint.
- **SOAPAction Header Manipulation:** The attacker needs to set the `SOAPAction` header to `SetAutoRebootSettings` to trigger the vulnerable function.

**Required Attacker Capabilities/Position:**

- **Network Proximity:** The attacker must be on the same network as the target D-Link router.
- **Technical Skills:** The attacker needs to be able to send crafted HTTP POST requests, including manipulating headers.

**Additional Notes:**
- The vulnerability affects D-Link DIR-823G router with firmware version DIR823G\_V1.0.2B05\_20181207.
- The provided content includes proof of concept (POC) screenshots showing the HTTP request and response, and they confirm that the auto-reboot settings can be modified without authentication.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.428 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.400 |
| 3 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.362 |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.357 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.356 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.352 |
| 7 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.352 |
| 8 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.350 |
| 9 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | dense | 0.641 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

