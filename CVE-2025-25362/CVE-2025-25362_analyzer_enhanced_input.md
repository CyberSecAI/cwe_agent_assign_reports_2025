## Vulnerability Description
A **Server-Side Template Injection** (SSTI) vulnerability in Spacy-LLM v0.7.2 allows attackers to execute arbitrary code via injecting a crafted payload into the template field.

### Vulnerability Description Key Phrases
- **component:** template field
- **vector:** crafted payload
- **weakness:** **Server-Side Template Injection**
- **product:** Spacy-LLM
- **impact:** execute arbitrary code, arbitrary code execution
- **attacker:** attackers
- **version:** v0.7.2

## CVE Reference Links Content Summary
## CVE-2025-25362: Spacy-LLM Server-Side Template Injection (SSTI) vulnerability

**This content is relevant to the CVE.**

**Root cause of vulnerability:**

The vulnerability is caused by the usage of unsafe functions of the Jinja2 template engine in `spacy_llm/tasks/builtin_task.py`. Specifically, the `generate_prompts` and `render_template` functions utilize Jinja2 without proper sandboxing.

**Weaknesses/vulnerabilities present:**

*   Server-Side Template Injection (SSTI) - CWE-94
*   Improper Input Validation - CWE-1336

**Impact of exploitation:**

Attackers can run arbitrary system commands without restriction, potentially gaining complete control over the server host (Remote Code Execution).

**Attack vectors:**

*   Network: The vulnerability is exploitable over the network.
*   Crafted payload: Attackers can inject a malicious payload into the `template` field of the configuration.

**Required attacker capabilities/position:**

*   No privileges required.
*   No user interaction is required.

**Mitigation or fix:**

The vulnerability was fixed by sandboxing the Jinja2 environment (see [explosion/spacy-llm#491](https://github.com/explosion/spacy-llm/pull/491)). However, versions <= 0.7.2 are still vulnerable.  Upgrade to version 0.7.3 or later.

**Additional details (more than official CVE description):**

*   **PoC:** A proof-of-concept (PoC) is provided, demonstrating the execution of the `id` command and the creation of a file named "pwned" on the server.
*   **Affected versions:** <= 0.7.2
*   **Patched versions:** 0.7.3
*   **CVSS v4 Score:** 8.9 (High Severity)
    *   Attack Vector: Network
    *   Attack Complexity: Low
    *   Attack Requirements: None
    *   Privileges Required: None
    *   User Interaction: None
    *   Confidentiality: High
    *   Integrity: High
    *   Availability: High
*   **EPSS score:** 0.119% (32nd percentile)
*   **References:**
    *   [https://nvd.nist.gov/vuln/detail/CVE-2025-25362](https://nvd.nist.gov/vuln/detail/CVE-2025-25362)
    *   [explosion/spacy-llm#492](https://github.com/explosion/spacy-llm/issues/492)
    *   [explosion/spacy-llm#491](https://github.com/explosion/spacy-llm/pull/491)
    *   [explosion/spacy-llm@8bde049](https://github.com/explosion/spacy-llm/commit/8bde0490cc1e9de9dd2e84480b7b5cd18a94d739)
    *   [https://www.hacktivesecurity.com/blog/2025/04/01/cve-2025-25362-old-vulnerabilities-new-victims-breaking-llm-prompts-with-ssti](https://www.hacktivesecurity.com/blog/2025/04/01/cve-2025-25362-old-vulnerabilities-new-victims-breaking-llm-prompts-with-ssti)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | alternate_terms | 1.000 |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.180 |
| 3 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.174 |
| 4 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.172 |
| 5 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.150 |
| 6 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.148 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.147 |
| 8 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.146 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.512 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-918: Server-Side Request Forgery (SSRF)

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-494: Download of Code Without Integrity Check