# Vulnerability Information: CVE-2025-46337

## Vulnerability Description
ADOdb is a PHP database class library that provides abstractions for performing queries and managing databases. Prior to version 5.22.9, **improper escaping of a query parameter** may allow an attacker to execute arbitrary SQL statements when the code using ADOdb connects to a PostgreSQL database and calls pg_insert_id() with user-supplied data. This issue has been patched in version 5.22.9.

### Vulnerability Description Key Phrases
- **rootcause:** **improper escaping of a query parameter**
- **impact:** execute arbitrary SQL statements
- **product:** ADOdb PHP database class library
- **version:** prior to 5.22.9
- **component:** pg_insert_id() function

## CVE Reference Links Content Summary
Here's an analysis of the provided content:

**Content from github.com_02e71e10_20250624_190114.html (stripped)**

*   **Relates to CVE-2025-46337:** Yes
*   **Information:** This content is a GitHub issue related to the SQL injection vulnerability in the `pgsql_insert_id()` method. It includes the issue number, labels (pgsql, security), milestone (v5.22.9), and a description that references a security advisory.

**Content from github.com_32cd7dd3_20250624_190116.html (stripped)**

*   **Relates to CVE-2025-46337:** Yes
*   **Information:** This is a GitHub security advisory (GHSA-8x27-jwjr-8545) detailing the SQL injection vulnerability in the ADOdb PostgreSQL driver's `pg_insert_id()` method.
    *   **Root cause of vulnerability:** Improper escaping of a query parameter.
    *   **Weaknesses/vulnerabilities present:** SQL injection (CWE-89)
    *   **Impact of exploitation:** Allows an attacker to execute arbitrary SQL statements.
    *   **Affected versions:** `<=5.22.8`
    *   **Patched versions:** `5.22.9`
    *   **Mitigation or fix:** The vulnerability is fixed in ADOdb version 5.22.9. Workarounds include only passing controlled data to the `pg_insert_id()` method's `$fieldname` parameter or escaping it with `pg_escape_identifier()` first.
    *   **Credits:** Marco Nappi (@mrcnpp) for reporting the vulnerability.
    *   **Severity:** Critical (CVSS 10.0)
    *   **More detail than official CVE description:** Yes, it provides information on affected versions, patched versions, and a workaround.

**Content from github.com_6665d007_20250624_190112.html (stripped)**

*   **Relates to CVE-2025-46337:** Yes
*   **Information:** This content is a GitHub commit that fixes the SQL injection vulnerability.
    *   **Fix:** Properly escape the `$tablename` and `$fieldname` parameters used to build the sequence name.

**Content from lists.debian.org_2d0af847_20250624_190116.html (text)**

*   **Relates to CVE-2025-46337:** Yes
*   **Information:** This is a Debian LTS security advisory (DLA-4177-1) regarding the libphp-adodb package. It states that the SQL injection vulnerability in the PostgreSQL driver is fixed.
    *   **Affected package:** libphp-adodb
    *   **Fixed version:** 5.20.19-1+deb11u2
    *   **Provides a link to the Debian security tracker page:** `https://security-tracker.debian.org/tracker/libphp-adodb`

**Content from wiki.debian.org_8d48714b_20250624_210613.html (text)**

*   **Relates to CVE-2025-46337:** NOINFO

**Content from xaliom.blogspot.com_1c60416b_20250624_210615.html (text)**

*   **Relates to CVE-2025-46337:** Yes
*   **Information:** This blog post mentions CVE-2025-46337 and links to another blog post that discusses the vulnerability.

**Content from xaliom.blogspot.com_92544c44_20250624_210614.html (text)**

*   **Relates to CVE-2025-46337:** Yes
*   **Information:** This blog post details the discovery of the SQL injection vulnerability. It describes the process of using Static Analysis Security Testing (SAST) tools to identify the vulnerability.
    *   **Vulnerable Function:** `pg_insert_id`
    *   **Root cause of the vulnerability:** Improper escaping of a query parameter.
    *   **Provides links to the Github Advisory:** Yes

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.416 |
| 2 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.409 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.407 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.356 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.354 |
| 6 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.354 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.353 |
| 8 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.352 |
| 9 | 564 | SQL Injection: Hibernate | Variant | Allowed | dense | 0.413 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

