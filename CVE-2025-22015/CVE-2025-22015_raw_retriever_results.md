# Raw Retriever Results for CVE-2025-22015

# Raw Retriever Results for CVE-2025-22015
## Query
In the Linux kernel, the following vulnerability has been resolved mm/migrate fix shmem xarray update during migration A shmem folio can be either in page cache or in swap cache, but not at the same time. Namely, once it is in swap cache, folio->mapping should be NULL, and the folio is no longer in a shmem mapping. In __folio_migrate_mapping(), to determine the number of xarray entries to update, folio_test_swapbacked() is used, but that conflates shmem in page cache case and shmem in swap cache case. It leads to xarray multi-index entry corruption, since it turns a sibling entry to a normal entry during xas_store() (see [1] for a userspace reproduction). Fix it by only using folio_test_swapcache() to determine whether xarray is storing swap cache entries or not to choose the right number of xarray entries to update. [1] https//lore.kernel.org/linux-mm/Z8idPCkaJW1IChjT@casper.infradead.org/ Note In __split_huge_page(), folio_test_anon() && folio_test_swapcache() is used to get swap_cache address space, but that ignores the shmem folio in swap cache case. It could lead to NULL pointer dereferencing when a in-swap-cache shmem folio is split at __xa_store(), since !folio_test_anon() is true and folio->mapping is NULL. But fortunately, its caller split_huge_page_to_list_to_order() bails out early with EBUSY when folio->mapping is NULL. So no need to take care of it here.

## Keyphrases
- **rootcause**: 'conflates shmem in page cache case', 'shmem in swap cache case'
- **weakness**: 'xarray multi-index entry corruption'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3950 | 0.4333 | 0.4124 | 0.4176 | 20 |
| Sparse | 882.3507 | 1047.3768 | 971.4946 | 970.2186 | 13 |
| Graph | 1.6848 | 3.4866 | 2.0384 | 1.8037 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 617 | Reachable Assertion | base | 3.4866 | Allowed |
| 2 | 476 | NULL Pointer Dereference | Base | 2.7689 | Allowed |
| 3 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 2.4655 | Allowed |
| 4 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 5 | 193 | Off-by-one Error | base | 2.2100 | Allowed |
| 6 | 252 | Unchecked Return Value | base | 2.2100 | Allowed |
| 7 | 619 | Dangling Database Cursor ('Cursor Injection') | base | 2.2100 | Allowed |
| 8 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 1.9039 | Allowed |
| 10 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 13 | 170 | Improper Null Termination | base | 1.7680 | Allowed |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | base | 1.7680 | Allowed |
| 15 | 1251 | Mirrored Regions with Different Values | Base | 1.7434 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 667 | Improper Locking | Class | 0.4333 | 0.4333 | Allowed-with-Review |
| 2 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 0.4288 | 0.4288 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.4282 | 0.4282 | Allowed-with-Review |
| 4 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4254 | 0.4254 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4249 | 0.4249 | Allowed-with-Review |
| 6 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4221 | 0.4221 | Allowed |
| 7 | 591 | Sensitive Data Storage in Improperly Locked Memory | Variant | 0.4206 | 0.4206 | Allowed |
| 8 | 1251 | Mirrored Regions with Different Values | Base | 0.4203 | 0.4203 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4193 | 0.4193 | Allowed |
| 10 | 762 | Mismatched Memory Management Routines | Variant | 0.4176 | 0.4176 | Allowed |
| 11 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4176 | 0.4176 | Allowed |
| 12 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4028 | 0.4028 | Allowed |
| 13 | 190 | Integer Overflow or Wraparound | Base | 0.4026 | 0.4026 | Allowed |
| 14 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4023 | 0.4023 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.3988 | 0.3988 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 617 | Reachable Assertion | 1047.3768 | 1047.3768 | Allowed |
| 2 | 404 | Improper Resource Shutdown or Release | 1029.5784 | 1029.5784 | Allowed-with-Review |
| 3 | 476 | NULL Pointer Dereference | 1005.6293 | 1005.6293 | Allowed |
| 4 | 1251 | Mirrored Regions with Different Values | 999.2903 | 999.2903 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 990.7084 | 990.7084 | Allowed-with-Review |
| 6 | 276 | Incorrect Default Permissions | 981.7039 | 981.7039 | Allowed |
| 7 | 591 | Sensitive Data Storage in Improperly Locked Memory | 970.2186 | 970.2186 | Allowed |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 960.5976 | 960.5976 | Allowed |
| 9 | 204 | Observable Response Discrepancy | 958.5863 | 958.5863 | Allowed |
| 10 | 125 | Out-of-bounds Read | 954.3442 | 954.3442 | Allowed |
| 11 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 953.5568 | 953.5568 | Allowed |
| 12 | 667 | Improper Locking | 895.4890 | 895.4890 | Allowed-with-Review |
| 13 | 190 | Integer Overflow or Wraparound | 882.3507 | 882.3507 | Allowed |
