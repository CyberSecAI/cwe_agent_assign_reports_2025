# Vulnerability Information: CVE-2025-0392

## Vulnerability Description
A vulnerability, which was classified as critical, was found in Guangzhou Huayi Intelligent Technology Jeewms up to 20241229. Affected is the function datagridGraph of the file /graphReportController.do. The manipulation of the argument store_code leads to **sql injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 20250101 is able to address this issue. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **vector:** manipulation of the argument store_code
- **product:** Guangzhou Huayi Intelligent Technology Jeewms
- **version:** up to 20241229
- **component:** datagridGraph of the file /graphReportController.do

## CVE Reference Links Content Summary
## Analysis of CVE-2025-0392 Content

This content **IS RELATED** to CVE-2025-0392. It provides a detailed vulnerability report. Here's an extraction of the relevant information:

**Root cause of vulnerability:**

The vulnerability stems from insufficient input validation and sanitization when handling the `store_code` parameter in the `datagridGraph` method of the `GraphReportController`. Specifically, the code directly concatenates user-supplied input into a dynamic SQL query without proper filtering or escaping.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection:** The primary vulnerability is a SQL injection flaw. The `store_code` parameter is directly incorporated into the SQL query, allowing an attacker to inject malicious SQL code.

**Impact of exploitation:**

Successful exploitation of this vulnerability could allow an attacker to:

*   Access sensitive data from the database.
*   Modify or delete data within the database.
*   Potentially gain control of the database server.

**Attack vectors:**

*   The attacker can send a crafted HTTP request to the `/graphReportController.do` endpoint with a malicious `store_code` parameter.
*   The provided POC demonstrates using `sqlmap` to exploit the vulnerability.

**Required attacker capabilities/position:**

*   The attacker needs to be able to send HTTP requests to the vulnerable endpoint.
*   Authentication is required to access the backend, as demonstrated by the cookie used in the POC.
*   Basic knowledge of SQL injection techniques is necessary.

**Mitigation or fix:**

The report does not explicitly state a fix, but the root cause analysis implies that the following mitigations are necessary:

*   **Input Validation:** Implement strict validation of the `store_code` parameter to ensure it only contains expected characters and values.
*   **Parameterized Queries/Prepared Statements:** Use parameterized queries or prepared statements to separate SQL code from user-supplied data. This prevents the injection of malicious SQL code.
*   **Escaping:** If parameterized queries are not feasible, properly escape all user-supplied data before incorporating it into the SQL query.

**Additional Details (More detail than official CVE description):**

The report provides a detailed code walkthrough, pinpointing the exact locations in the Java code where the vulnerability exists:

*   `org/jeecgframework/web/graphreport/controller/GraphReportController.java` (lines 303, 325)
*   `org/jeecgframework/core/online/util/CgReportQueryParamUtil.java` (lines 39, 49, 60)
*   `org/jeecgframework/web/graphreport/service/impl/core/GraphReportServiceImpl.java` (lines 145)
*   `org/jeecgframework/core/common/dao/jdbc/JdbcDao.java` (line 149)

The report also includes a proof-of-concept (POC) using `sqlmap` and provides example HTTP requests with malicious payloads.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.527 |
| 3 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.448 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.444 |
| 5 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.438 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.436 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.433 |
| 8 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.422 |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | dense | 0.568 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

