## Vulnerability Description
The LearnDash LMS - Reports plugin for WordPress is vulnerable to unauthorized modification of data due to a **missing capability check** on several functions in all versions up to, and including, 1.8.2. This makes it possible for authenticated attackers, with Subscriber-level access and above, to update various plugin settings.

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **impact:** unauthorized modification of data
- **attacker:** authenticated attackers with Subscriber-level access and above
- **product:** LearnDash LMS - Reports plugin for WordPress
- **version:** up to and including 1.8.2

## CVE Reference Links Content Summary
### CVE-2024-5648
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The LearnDash LMS - Reports Free plugin lacks proper authorization checks in multiple AJAX functions, allowing unauthorized users to modify plugin settings.

**Weaknesses/Vulnerabilities:**

*   **Missing Capability Checks:** Several AJAX functions, including `wrld_set_configuration`, `wrld_exclude_settings_save`, `apply_time_tracking_settings`, and `wp_ajax_wrld_gutenberg_block_visit` lack checks to ensure that only users with appropriate administrative capabilities can access and execute them.
*   The vulnerability allows authenticated users with subscriber-level access and above to modify settings.
*   The vulnerability resides in the `class-admin-functions.php` file

**Impact of Exploitation:**

*   An attacker could modify plugin settings that could lead to a variety of outcomes, such as:
    *   Changing plugin configurations (e.g., menu settings, dashboard access roles).
    *   Manipulating time tracking settings.
    *   Excluding users/roles from reports.
    *   Modifying plugin behavior.

**Attack Vectors:**

*   The vulnerability is triggered by making AJAX calls to the vulnerable functions.
*   The attacker must be an authenticated user with subscriber-level or higher access to the WordPress site.

**Required Attacker Capabilities/Position:**

*   **Authenticated Access:** The attacker must have a valid user account on the target WordPress site. Subscriber-level access is sufficient.
*   **Network Access:** The attacker must be able to send HTTP requests to the WordPress site.
*   **Knowledge of Plugin:** The attacker must know which AJAX actions are vulnerable to target.

**Additional Information:**

*   The vulnerability is present in versions <= 1.8.2.1 of the LearnDash LMS - Reports Free plugin.
*   The vulnerability was patched in version 1.8.2.2 of the plugin.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.411 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.393 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.358 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.336 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.332 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.330 |
| 7 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.322 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.319 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.478 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-862: Missing Authorization

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-863: Incorrect Authorization

CWE-285: Improper Authorization

CWE-306: Missing Authentication for Critical Function

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-284: Improper Access Control

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-613: Insufficient Session Expiration