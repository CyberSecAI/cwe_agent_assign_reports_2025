# Vulnerability Information: CVE-2024-6786

## Vulnerability Description
The vulnerability allows an attacker to craft MQTT messages that include relative **path traversal** sequences, enabling them to read arbitrary files on the system. This could lead to the disclosure of sensitive information, such as configuration files and JWT signing secrets.

### Vulnerability Description Key Phrases
- **weakness:** **path traversal**
- **impact:** disclosure of sensitive information and read arbitrary files
- **vector:** craft MQTT messages that include relative path traversal sequences
- **attacker:** attacker

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of CVE-2024-6786:

**Root cause of vulnerability:**

- The vulnerability stems from insufficient validation of user-supplied input, specifically within MQTT messages. The software fails to properly sanitize path traversal sequences (e.g., `../`) within the MQTT messages.

**Weaknesses/vulnerabilities present:**

- **CWE-24: Path Traversal:** The software is vulnerable to path traversal attacks. By crafting malicious MQTT messages with relative path sequences, an attacker can access files outside of the intended directory.

**Impact of exploitation:**

- **Information Disclosure:** An attacker can read arbitrary files on the system, including sensitive data such as configuration files and JWT signing secrets. This can lead to a compromise of confidentiality and further exploitation.

**Attack vectors:**

- **MQTT Protocol:** The vulnerability is exploited through the Message Queuing Telemetry Transport (MQTT) protocol, which is a machine-to-machine connectivity protocol.
- An attacker can send crafted MQTT messages to the affected device to exploit the path traversal vulnerability.

**Required attacker capabilities/position:**

- **Network Access:** The attacker needs to have network access to the affected device. It is not explicitly stated if authentication is required, however, the CVSS score indicates that the attacker requires low privilege to exploit this vulnerability.

**Additional details from the provided documents:**

- The vulnerability is present in Moxa MXview One Series software versions 1.4.0 and earlier.
- The provided advisory includes CVSS v3.1 and v4.0 scores for the vulnerability:
    -   CVSS v3.1: 6.5 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)
    -   CVSS v4.0: 6.0 (AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N)
- Moxa has released software updates to address this vulnerability:
    - MXview One Series: Upgrade to v1.4.1
- CISA also recommends users to minimize network exposure and change default credentials.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.280 |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.232 |
| 4 | 28 | Path Traversal: '..\filedir' | Variant | Allowed | sparse | 0.228 |
| 5 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.224 |
| 6 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | sparse | 0.223 |
| 7 | 73 | External Control of File Name or Path | Base | Allowed | sparse | 0.212 |
| 8 | 24 | Path Traversal: '../filedir' | Variant | Allowed | sparse | 0.211 |
| 9 | 25 | Path Traversal: '/../filedir' | Variant | Allowed | dense | 0.628 |
| 10 | 363 | Race Condition Enabling Link Following | Base | Allowed | graph | 0.002 |

