# Raw Retriever Results for CVE-2024-20506

# Raw Retriever Results for CVE-2024-20506
## Query
A vulnerability in the ClamD service module of Clam AntiVirus (ClamAV) versions 1.4.0, 1.3.2 and prior versions, all 1.2.x versions, 1.0.6 and prior versions, all 0.105.x versions, all 0.104.x versions, and 0.103.11 and all prior versions could allow an authenticated, local attacker to corrupt critical system files. The vulnerability is due to allowing the ClamD process to write to its log file while privileged without checking if the logfile has been replaced with a symbolic link. An attacker could exploit this vulnerability if they replace the ClamD log file with a symlink to a critical system file and then find a way to restart the ClamD process. An exploit could allow the attacker to corrupt a critical system file by appending ClamD log messages after restart.

## Keyphrases
- **weakness**: 'improper file permissions'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5322 | 0.5812 | 0.5529 | 0.5519 | 20 |
| Sparse | 631.1744 | 705.7427 | 656.4386 | 644.6761 | 10 |
| Graph | 1.3600 | 2.5735 | 1.7390 | 1.6812 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.5735 | Allowed |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | 2.2161 | Allowed |
| 3 | 363 | Race Condition Enabling Link Following | base | 2.2100 | Allowed |
| 4 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 5 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 2.0412 | Allowed |
| 6 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 8 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 9 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 1.7259 | Allowed-with-Review |
| 10 | 250 | Execution with Unnecessary Privileges | Base | 1.7227 | Allowed |
| 11 | 532 | Insertion of Sensitive Information into Log File | Base | 1.6396 | Allowed |
| 12 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 13 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 14 | 689 | Permission Race Condition During Resource Copy | compound | 1.6100 | Allowed |
| 15 | 73 | External Control of File Name or Path | Base | 1.5491 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 250 | Execution with Unnecessary Privileges | Base | 0.5812 | 0.5812 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5799 | 0.5799 | Allowed |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 0.5749 | 0.5749 | Allowed-with-Review |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | 0.5737 | 0.5737 | Allowed |
| 5 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 0.5673 | 0.5673 | Allowed |
| 6 | 306 | Missing Authentication for Critical Function | Base | 0.5664 | 0.5664 | Allowed |
| 7 | 427 | Uncontrolled Search Path Element | Base | 0.5648 | 0.5648 | Allowed |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.5616 | 0.5616 | Allowed |
| 9 | 287 | Improper Authentication | Class | 0.5607 | 0.5607 | Discouraged |
| 10 | 269 | Improper Privilege Management | Class | 0.5581 | 0.5581 | Discouraged |
| 11 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | 0.5458 | 0.5458 | Allowed |
| 12 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.5395 | 0.5395 | Allowed |
| 13 | 20 | Improper Input Validation | Class | 0.5383 | 0.5383 | Discouraged |
| 14 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.5376 | 0.5376 | Allowed |
| 15 | 121 | Stack-based Buffer Overflow | Variant | 0.5375 | 0.5375 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 732 | Incorrect Permission Assignment for Critical Resource | 705.7427 | 705.7427 | Allowed-with-Review |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | 692.2617 | 692.2617 | Allowed |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 659.7626 | 659.7626 | Allowed |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | 655.6386 | 655.6386 | Allowed |
| 5 | 269 | Improper Privilege Management | 644.9446 | 644.9446 | Discouraged |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 644.4075 | 644.4075 | Allowed |
| 7 | 20 | Improper Input Validation | 643.6797 | 643.6797 | Discouraged |
| 8 | 306 | Missing Authentication for Critical Function | 643.5603 | 643.5603 | Allowed |
| 9 | 285 | Improper Authorization | 643.2137 | 643.2137 | Discouraged |
| 10 | 532 | Insertion of Sensitive Information into Log File | 631.1744 | 631.1744 | Allowed |
