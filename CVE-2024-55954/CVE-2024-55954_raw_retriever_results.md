# Raw Retriever Results for CVE-2024-55954

# Raw Retriever Results for CVE-2024-55954
## Query
OpenObserve is a cloud-native observability platform. A vulnerability in the user management endpoint `/api/{org_id}/users/{email_id}` allows an Admin role user to remove a Root user from the organization. This violates the intended privilege hierarchy, enabling a non-root user to remove the highest-privileged account. Due to insufficient role checks, the `remove_user_from_org` function does not prevent an Admin user from removing a Root user. As a result, an attacker with an Admin role can remove critical Root users, potentially gaining effective full control by eliminating the highest-privileged accounts. The `DELETE /api/{org_id}/users/{email_id}` endpoint is affected. This issue has been addressed in release version `0.14.1` and all users are advised to upgrade. There are no known workarounds for this vulnerability.

## Keyphrases
- **rootcause**: 'insufficient role checks'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4439 | 0.5182 | 0.4664 | 0.4637 | 20 |
| Sparse | 218.4063 | 777.8397 | 657.9430 | 681.8795 | 11 |
| Graph | 1.0062 | 1.6939 | 1.2221 | 1.0632 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 267 | Privilege Defined With Unsafe Actions | Base | 1.6939 | Allowed |
| 2 | 842 | Placement of User into Incorrect Group | Base | 1.6918 | Allowed |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6914 | Allowed |
| 4 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.5210 | Allowed |
| 5 | 266 | Incorrect Privilege Assignment | Base | 1.5041 | Allowed |
| 6 | 204 | Observable Response Discrepancy | Base | 1.4823 | Allowed |
| 7 | 425 | Direct Request ('Forced Browsing') | base | 1.2262 | Allowed |
| 8 | 610 | Externally Controlled Reference to a Resource in Another Sphere | class | 1.1920 | Discouraged |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 1.1466 | Allowed |
| 10 | 286 | Incorrect User Management | Class | 1.0680 | Allowed-with-Review |
| 11 | 486 | Comparison of Classes by Name | variant | 1.0584 | Allowed |
| 12 | 269 | Improper Privilege Management | Class | 1.0455 | Discouraged |
| 13 | 863 | Incorrect Authorization | Class | 1.0424 | Allowed-with-Review |
| 14 | 285 | Improper Authorization | Class | 1.0412 | Discouraged |
| 15 | 804 | Guessable CAPTCHA | base | 1.0062 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 286 | Incorrect User Management | Class | 0.5182 | 0.5182 | Allowed-with-Review |
| 2 | 267 | Privilege Defined With Unsafe Actions | Base | 0.4926 | 0.4926 | Allowed |
| 3 | 842 | Placement of User into Incorrect Group | Base | 0.4917 | 0.4917 | Allowed |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4859 | 0.4859 | Allowed |
| 5 | 204 | Observable Response Discrepancy | Base | 0.4828 | 0.4828 | Allowed |
| 6 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4787 | 0.4787 | Allowed |
| 7 | 269 | Improper Privilege Management | Class | 0.4700 | 0.4700 | Discouraged |
| 8 | 863 | Incorrect Authorization | Class | 0.4689 | 0.4689 | Allowed-with-Review |
| 9 | 532 | Insertion of Sensitive Information into Log File | Base | 0.4686 | 0.4686 | Allowed |
| 10 | 283 | Unverified Ownership | Base | 0.4644 | 0.4644 | Allowed |
| 11 | 285 | Improper Authorization | Class | 0.4631 | 0.4631 | Discouraged |
| 12 | 708 | Incorrect Ownership Assignment | Base | 0.4568 | 0.4568 | Allowed |
| 13 | 266 | Incorrect Privilege Assignment | Base | 0.4552 | 0.4552 | Allowed |
| 14 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.4501 | 0.4501 | Allowed |
| 15 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4499 | 0.4499 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 777.8397 | 777.8397 | Allowed-with-Review |
| 2 | 285 | Improper Authorization | 746.2854 | 746.2854 | Discouraged |
| 3 | 269 | Improper Privilege Management | 735.8154 | 735.8154 | Discouraged |
| 4 | 267 | Privilege Defined With Unsafe Actions | 722.1925 | 722.1925 | Allowed |
| 5 | 610 | Externally Controlled Reference to a Resource in Another Sphere | 683.2468 | 683.2468 | Discouraged |
| 6 | 306 | Missing Authentication for Critical Function | 681.8795 | 681.8795 | Allowed |
| 7 | 284 | Improper Access Control | 673.2278 | 673.2278 | Discouraged |
| 8 | 862 | Missing Authorization | 668.8134 | 668.8134 | Allowed-with-Review |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 665.2505 | 665.2505 | Allowed |
| 10 | 732 | Incorrect Permission Assignment for Critical Resource | 664.4161 | 664.4161 | Allowed-with-Review |
| 11 | 639 | Authorization Bypass Through User-Controlled Key | 218.4063 | 218.4063 | Allowed |
