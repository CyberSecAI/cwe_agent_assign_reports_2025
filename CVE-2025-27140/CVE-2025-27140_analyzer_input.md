# Vulnerability Information: CVE-2025-27140

## Vulnerability Description
WeGIA is a Web manager for charitable institutions. An OS Command Injection vulnerability was discovered in versions prior to 3.2.15 of the WeGIA application, `importar_dump.php` endpoint. This vulnerability could allow an attacker to execute arbitrary code remotely. The command is basically a command to move a temporary file, so a webshell upload is also possible. Version 3.2.15 contains a patch for the issue.

### Vulnerability Description Key Phrases
- **component:** importar_dump.php endpoint
- **rootcause:** **command injection**
- **product:** WeGIA application
- **impact:** execute arbitrary code, remote webshell upload
- **attacker:** attacker
- **version:** prior to 3.2.15

## CVE Reference Links Content Summary
## Analysis of CVE-2025-27140 based on provided content

The provided content is directly related to CVE-2025-27140. It details a critical OS Command Injection vulnerability in the WeGIA application, specifically in the `importar_dump.php` endpoint. The content provides significantly more detail than a placeholder CVE description would.

**Root cause of vulnerability:**

The vulnerability stems from unsanitized user input being used in a `shell_exec` call. Specifically, the `$_FILES["import"]["tmp_name"]` and `$_FILES["import"]["name"]` values are directly concatenated into a shell command without proper escaping or validation.

**Weaknesses/vulnerabilities present:**

*   **OS Command Injection (CWE-78):**  The primary vulnerability.
*   **Improper Input Validation (CWE-284):** Lack of validation on the uploaded file name and type.

**Impact of exploitation:**

*   **Information disclosure:** An attacker can potentially access sensitive information from the system.
*   **Web Server Takeover:**  An attacker could gain full control of the web server.
*   **Cryptomining/Malware Installation:** The attacker can install malicious software.
*   **Remote Code Execution (RCE):** The vulnerability allows for arbitrary code execution.

**Attack vectors:**

*   An attacker can upload a malicious file with a crafted filename (e.g., `a;sleep 5` or a filename containing a reverse shell command) through the `importar_dump.php` endpoint.
*   The vulnerability can be exploited even without being logged in due to a header issue (specifically related to PHP version 7.3.30).

**Required attacker capabilities/position:**

*   Network access to the vulnerable endpoint.
*   Ability to upload a file to the server.
*   No authentication is required due to the identified header issue.

**Mitigation or fix:**

The advisory states that the vulnerability was patched in version 3.2.15. The commit message associated with the advisory (7d0df8c) indicates that the fix involves adding file type verification and MIME type checking to the `importar_dump.php` file. Specifically:

*   Checking the file extension to ensure it's `dump.tar.gz`.
*   Verifying the MIME type against a list of allowed types (`application/x-gzip`, `application/gzip`, `application/x-tar`).
*   Properly escaping the file name and path when constructing the shell command.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.423 |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.415 |
| 5 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.409 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.406 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.404 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.402 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.543 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.003 |

