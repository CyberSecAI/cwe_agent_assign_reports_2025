## Vulnerability Description
An issue discovered in MSP360 Backup Agent v7.8.5.15 and v7.9.4.84 allows attackers to obtain network share credentials used in a backup due to enginesettings.list being encrypted with a hard coded key.

### Vulnerability Description Key Phrases
- **rootcause:** **hard coded encryption key**
- **impact:** obtain network share credentials
- **attacker:** attackers
- **product:** MSP360 Backup Agent
- **version:** v7.8.5.15 and v7.9.4.84
- **component:** enginesettings.list

## CVE Reference Links Content Summary
The provided content details a vulnerability in MSP360 Backup Agent software, where hardcoded encryption keys are used to protect network share credentials.

**Root cause of vulnerability:**
The root cause is the usage of a hardcoded key for encrypting network credentials within the `enginesettings.list` configuration file, coupled with the backup of this file to accessible locations.

**Weaknesses/vulnerabilities present:**
- Hardcoded cryptographic key within the MSP360 software.
- Use of AES in ECB mode, which is known to be insecure.
- Storage of the `enginesettings.list` file, containing encrypted credentials, in backup locations that might be accessible to attackers (especially when users configure their own buckets that allow directory listing)
- Lack of proper protection for sensitive credential data

**Impact of exploitation:**
- Exposure of network credentials (usernames and passwords) for SMB shares.
- Potential for an attacker to gain a foothold within a network using the exposed credentials.
- Access to sensitive data if network shares contain sensitive information

**Attack vectors:**
- An attacker needs access to the `enginesettings.list` file (or the exported configuration .cbbconfiguration), which is typically stored in the backup destination alongside actual backup data
- The backup destinations could be on S3 or any other location. Specifically, it is noted that MSP360 managed buckets do not enable directory listing, but user-configured ones might.

**Required attacker capabilities/position:**
- Access to backup storage where `enginesettings.list` is stored.
- Ability to download the file.
- The attacker does not need access to the MSP360 software, but they must be able to decrypt the `Password` field with the hardcoded key.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.313 |
| 2 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.290 |
| 3 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.253 |
| 4 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.249 |
| 5 | 912 | Hidden Functionality | Class | Allowed-with-Review | sparse | 0.232 |
| 6 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.225 |
| 7 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | sparse | 0.215 |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.211 |
| 9 | 311 | Missing Encryption of Sensitive Data | Class | Discouraged | dense | 0.554 |
| 10 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-321: Use of Hard-coded Cryptographic Key

CWE-798: Use of Hard-coded Credentials

CWE-259: Use of Hard-coded Password

CWE-1391: Use of Weak Credentials

CWE-912: Hidden Functionality

CWE-522: Insufficiently Protected Credentials

CWE-312: Cleartext Storage of Sensitive Information

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-311: Missing Encryption of Sensitive Data

CWE-472: External Control of Assumed-Immutable Web Parameter