## Vulnerability Description
Discourse is an open source platform for community discussion. PM titles and metadata can be read by other users when the PM tags allowed for groups option is enabled, the other user is a member of a group added to this option, and the PM has been tagged. This issue has been patched in the latest `stable`, `beta` and `tests-passed` versions of Discourse. Users are advised to upgrade. Users unable to upgrade should remove all groups from the the PM tags allowed for groups option.

### Vulnerability Description Key Phrases
- **rootcause:** **PM tags allowed for groups option enabled**
- **impact:** read PM titles and metadata
- **attacker:** other users
- **product:** Discourse

## CVE Reference Links Content Summary
## Analysis of CVE-2024-56197 based on provided content:

**1. Verification:**

The provided content directly relates to CVE-2024-56197. The advisory explicitly references the CVE ID.

**2. Extracted Information:**

*   **Root cause of vulnerability:** PM titles and metadata can be read by other users when the "PM tags allowed for groups" option is enabled, the other user is a member of a group added to this option, and the PM has been tagged.
*   **Weaknesses/vulnerabilities present:**  Information disclosure due to improper access control of private message metadata.
*   **Impact of exploitation:** Other users can view the titles and metadata of private messages.
*   **Attack vectors:**  Exploitation occurs when the "PM tags allowed for groups" option is enabled, a user is a member of a tagged group, and a PM is tagged.
*   **Required attacker capabilities/position:** An attacker needs to be a member of a group that has been granted access to PM tags.
*   **Mitigation or fix:**
    *   Remove all groups from the "PM tags allowed for groups" option.
    *   Upgrade to Discourse stable >= 3.3.4, beta >= 3.4.0.beta5, or tests-passed >= 3.4.0.beta5.
*   **CVSS Score:** 2.2/10 (Low)
*   **CVSS Vector:** CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:N/A:N

**3. Detail compared to official CVE description:**

The provided content offers significantly more detail than a typical CVE description. It includes:

*   Specific details about the configuration options involved ("PM tags allowed for groups").
*   A clear explanation of the attack scenario.
*   Workaround instructions.
*   CVSS scoring and vector details.
*   Affected and patched versions.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.588 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.587 |
| 3 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | Allowed | sparse | 0.580 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.574 |
| 5 | 837 | Improper Enforcement of a Single, Unique Action | Base | Allowed | sparse | 0.545 |
| 6 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.526 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.517 |
| 8 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.512 |
| 9 | 286 | Incorrect User Management | Class | Allowed-with-Review | dense | 0.397 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-863: Incorrect Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-525: Use of Web Browser Cache Containing Sensitive Information

CWE-1390: Weak Authentication

CWE-837: Improper Enforcement of a Single, Unique Action

CWE-1333: Inefficient Regular Expression Complexity

CWE-285: Improper Authorization

CWE-918: Server-Side Request Forgery (SSRF)

CWE-286: Incorrect User Management

CWE-226: Sensitive Information in Resource Not Removed Before Reuse