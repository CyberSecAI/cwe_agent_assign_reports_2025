# Vulnerability Information: CVE-2024-41114

## Vulnerability Description
streamlit-geospatial is a streamlit multipage app for geospatial applications. Prior to commit c4f81d9616d40c60584e36abb15300853a66e489, the `palette` variable on line 430 in `pages/1__Timelapse.py` takes user input, which is later used in the `eval()` function on line 435, leading to remote code execution. Commit c4f81d9616d40c60584e36abb15300853a66e489 fixes this issue.

### Vulnerability Description Key Phrases
- **rootcause:** **improper input sanitization**
- **impact:** remote code execution
- **product:** streamlit-geospatial
- **version:** prior to commit c4f81d9616d40c60584e36abb15300853a66e489
- **component:** palette variable in pages/1__Timelapse.py

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-NVD-noinfo

#### Top CWEs
- CWE-NVD-noinfo (Count: 34)
- CWE-918 (Count: 4)

## CVE Reference Links Content Summary
The provided content contains vulnerability information related to CVE-2024-41114.

**Root cause of vulnerability:**
The application uses the `eval()` function on user-controlled input to process the `palette` variable when using the `MODIS Gap filled Land Surface Temperature Daily` option within the `pages/1_ðŸ“·_Timelapse.py` module. This allows an attacker to inject and execute arbitrary code.

**Weaknesses/vulnerabilities present:**
- Unsafe use of `eval()`: The application directly evaluates user-supplied strings as code, allowing for arbitrary code execution.

**Impact of exploitation:**
- Remote code execution: An attacker can execute arbitrary commands on the server running the streamlit-geospatial application.

**Attack vectors:**
- User-supplied input: The `palette` variable is populated through a text area in the application's web interface, making it directly controlled by the user.

**Required attacker capabilities/position:**
- The attacker needs access to the application's web interface and the ability to input text into the designated input field. No special privileges are required beyond using the application as intended.

**Technical Details:**
- The vulnerable code is located in `pages/1_ðŸ“·_Timelapse.py` on line 435:
```python
st.session_state["palette"] = eval(palette)
```
- The attack involves entering malicious Python code into the `Enter a custom palette:` text area.
- An example payload provided is:
  ```python
  __import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')
  ```
- This payload demonstrates the ability to execute arbitrary operating system commands.

The provided content includes multiple other vulnerabilities, but only the vulnerability related to `MODIS Gap filled Land Surface Temperature Daily` option is associated with CVE-2024-41114. The other vulnerabilities are associated with other CVEs as described in the document.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.249 |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.248 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.236 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.235 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.232 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.226 |
| 7 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.224 |
| 8 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.219 |
| 9 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | dense | 0.381 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |

