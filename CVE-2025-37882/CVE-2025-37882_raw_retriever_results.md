# Raw Retriever Results for CVE-2025-37882

# Raw Retriever Results for CVE-2025-37882
## Query
In the Linux kernel, the following vulnerability has been resolved usb xhci Fix isochronous Ring Underrun/Overrun event handling The TRB pointer of these events points at enqueue at the time of error occurrence on xHCI 1.1+ HCs or its NULL on older ones. By the time we are handling the event, a new TD may be queued at this ring position. I can trigger this race by rising interrupt moderation to increase IRQ handling delay. Similar delay may occur naturally due to system load. If this ever happens after a Missed Service Error, missed TDs will be skipped and the new TD processed as if it matched the event. It could be given back prematurely, risking data loss or buffer UAF by the xHC. Dont complete TDs on xrun events and dont warn if queued TDs dont match the events TRB pointer, which can be NULL or a link/no-op TRB. Dont warn if there are no queued TDs at all. Now that its safe, also handle xrun events if the skip flag is clear. This ensures completion of any TD stuck in error mid TD state right before the xrun event, which could happen if a driver submits a finite number of URBs to a buggy HC and then an error occurs on the last TD.

## Keyphrases
- **rootcause**: 'race condition'
- **weakness**: 'memory corruption', 'buffer UAF'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4376 | 0.5091 | 0.4698 | 0.4776 | 20 |
| Sparse | 292.4706 | 1010.6630 | 864.8617 | 896.5987 | 15 |
| Graph | 1.6848 | 2.8652 | 2.0162 | 2.0400 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 123 | Write-what-where Condition | base | 2.8652 | Allowed |
| 2 | 787 | Out-of-bounds Write | base | 2.3998 | Allowed |
| 3 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 4 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 5 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 6 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 8 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 9 | 364 | Signal Handler Race Condition | Base | 2.1389 | Allowed |
| 10 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 11 | 415 | Double Free | variant | 2.0400 | Allowed |
| 12 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 13 | 125 | Out-of-bounds Read | base | 1.7680 | Allowed |
| 14 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 15 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5091 | 0.5091 | Allowed |
| 2 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.5006 | 0.5006 | Allowed |
| 3 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4993 | 0.4993 | Allowed |
| 4 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4924 | 0.4924 | Allowed |
| 5 | 364 | Signal Handler Race Condition | Base | 0.4924 | 0.4924 | Allowed |
| 6 | 1261 | Improper Handling of Single Event Upsets | Base | 0.4884 | 0.4884 | Allowed |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4880 | 0.4880 | Allowed-with-Review |
| 8 | 606 | Unchecked Input for Loop Condition | Base | 0.4850 | 0.4850 | Allowed |
| 9 | 366 | Race Condition within a Thread | Base | 0.4832 | 0.4832 | Allowed |
| 10 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4785 | 0.4785 | Allowed |
| 11 | 1223 | Race Condition for Write-Once Attributes | Base | 0.4767 | 0.4767 | Allowed |
| 12 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4535 | 0.4535 | Allowed |
| 13 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.4514 | 0.4514 | Allowed |
| 14 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4493 | 0.4493 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4451 | 0.4451 | Allowed |

## Sparse Retriever Results (15)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1010.6630 | 1010.6630 | Allowed-with-Review |
| 2 | 364 | Signal Handler Race Condition | 1007.5526 | 1007.5526 | Allowed |
| 3 | 787 | Out-of-bounds Write | 1000.0000 | 1000.0000 | Allowed |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 923.2561 | 923.2561 | Allowed |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | 919.0019 | 919.0019 | Allowed |
| 6 | 476 | NULL Pointer Dereference | 907.4248 | 907.4248 | Allowed |
| 7 | 754 | Improper Check for Unusual or Exceptional Conditions | 902.1821 | 902.1821 | Allowed-with-Review |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | 896.5987 | 896.5987 | Allowed |
| 9 | 667 | Improper Locking | 886.3752 | 886.3752 | Allowed-with-Review |
| 10 | 193 | Off-by-one Error | 885.0964 | 885.0964 | Allowed |
| 11 | 617 | Reachable Assertion | 884.7382 | 884.7382 | Allowed |
| 12 | 125 | Out-of-bounds Read | 833.1976 | 833.1976 | Allowed |
| 13 | 770 | Allocation of Resources Without Limits or Throttling | 824.3678 | 824.3678 | Allowed |
| 14 | 416 | Use After Free | 800.0000 | 800.0000 | Allowed |
| 15 | 201 | Insertion of Sensitive Information Into Sent Data | 292.4706 | 292.4706 | Allowed |
