{
  "query": "In the Linux kernel, the following vulnerability has been resolved usb xhci Fix isochronous Ring Underrun/Overrun event handling The TRB pointer of these events points at enqueue at the time of error occurrence on xHCI 1.1+ HCs or its NULL on older ones. By the time we are handling the event, a new TD may be queued at this ring position. I can trigger this race by rising interrupt moderation to increase IRQ handling delay. Similar delay may occur naturally due to system load. If this ever happens after a Missed Service Error, missed TDs will be skipped and the new TD processed as if it matched the event. It could be given back prematurely, risking data loss or buffer UAF by the xHC. Dont complete TDs on xrun events and dont warn if queued TDs dont match the events TRB pointer, which can be NULL or a link/no-op TRB. Dont warn if there are no queued TDs at all. Now that its safe, also handle xrun events if the skip flag is clear. This ensures completion of any TD stuck in error mid TD state right before the xrun event, which could happen if a driver submits a finite number of URBs to a buggy HC and then an error occurs on the last TD.",
  "keyphrases": {
    "rootcause": [
      "race condition"
    ],
    "weakness": [
      "memory corruption",
      "buffer UAF"
    ]
  },
  "timestamp": "2025-07-12T13:27:24.512447",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "123",
        "name": "Write-what-where Condition",
        "abstraction": "base",
        "score": 2.8651999999999997,
        "description": "CWE-123: Write-what-where Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "787",
        "name": "Out-of-bounds Write",
        "abstraction": "base",
        "score": 2.3998000000000004,
        "description": "CWE-787: Out-of-bounds Write...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "386",
        "name": "Symbolic Name not Mapping to Correct Object",
        "abstraction": "base",
        "score": 2.3764000000000003,
        "description": "CWE-386: Symbolic Name not Mapping to Correct Object...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "609",
        "name": "Double-Checked Locking",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-609: Double-Checked Locking...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-476: NULL Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "825",
        "name": "Expired Pointer Dereference",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-825: Expired Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "824",
        "name": "Access of Uninitialized Pointer",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-824: Access of Uninitialized Pointer...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "390",
        "name": "Detection of Error Condition Without Action",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-390: Detection of Error Condition Without Action...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "364",
        "name": "Signal Handler Race Condition",
        "abstraction": "Base",
        "score": 2.1388589716569806,
        "description": "The product uses a signal handler that introduces a race condition....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "variant",
        "score": 2.04,
        "description": "CWE-416: Use After Free...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "415",
        "name": "Double Free",
        "abstraction": "variant",
        "score": 2.04,
        "description": "CWE-415: Double Free...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-125: Out-of-bounds Read...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "562",
        "name": "Return of Stack Variable Address",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-562: Return of Stack Variable Address...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "252",
        "name": "Unchecked Return Value",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-252: Unchecked Return Value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1325",
        "name": "Improperly Controlled Sequential Memory Allocation",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1325: Improperly Controlled Sequential Memory Allocation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1265",
        "name": "Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1265: Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1257",
        "name": "Improper Access Control Applied to Mirrored or Aliased Memory Regions",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1257: Improper Access Control Applied to Mirrored or Aliased Memory Regions...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "128",
        "name": "Wrap-around Error",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-128: Wrap-around Error...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1339",
        "name": "Insufficient Precision or Accuracy of a Real Number",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1339: Insufficient Precision or Accuracy of a Real Number...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "191",
        "name": "Integer Underflow (Wrap or Wraparound)",
        "abstraction": "Base",
        "score": 0.5091308128049415,
        "description": "The product subtracts one value from another, such that the result is less than the minimum allowable integer value, which produces a value that is not equal to the correct result....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1260",
        "name": "Improper Handling of Overlap Between Protected Memory Ranges",
        "abstraction": "Base",
        "score": 0.5005778890405828,
        "description": "The product allows address regions to overlap, which can result in the bypassing of intended memory protection....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1342",
        "name": "Information Exposure through Microarchitectural State after Transient Execution",
        "abstraction": "Base",
        "score": 0.49930912924131865,
        "description": "The processor does not properly clear microarchitectural state after incorrect microcode assists or speculative execution, resulting in transient execution....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1332",
        "name": "Improper Handling of Faults that Lead to Instruction Skips",
        "abstraction": "Base",
        "score": 0.49239113052784245,
        "description": "The device is missing or incorrectly implements circuitry or sensors that detect and mitigate the skipping of security-critical CPU instructions when they occur....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "364",
        "name": "Signal Handler Race Condition",
        "abstraction": "Base",
        "score": 0.49236138882747493,
        "description": "The product uses a signal handler that introduces a race condition....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1261",
        "name": "Improper Handling of Single Event Upsets",
        "abstraction": "Base",
        "score": 0.48841255132760175,
        "description": "The hardware logic does not effectively handle when single-event upsets (SEUs) occur....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "abstraction": "Class",
        "score": 0.48797819018131006,
        "description": "The product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code ...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "606",
        "name": "Unchecked Input for Loop Condition",
        "abstraction": "Base",
        "score": 0.48502825796244675,
        "description": "The product does not properly check inputs that are used for loop conditions, potentially leading to a denial of service or other consequences because of excessive looping....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "366",
        "name": "Race Condition within a Thread",
        "abstraction": "Base",
        "score": 0.4832319840092867,
        "description": "If two threads of execution use a resource simultaneously, there exists the possibility that resources may be used while invalid, in turn making the state of execution undefined....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1421",
        "name": "Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution",
        "abstraction": "Base",
        "score": 0.4785387630759027,
        "description": "\n\t\t\tA processor event may allow transient operations to access\n\t\t\tarchitecturally restricted data (for example, in another address\n\t\t\tspace) in a shared microarchitectural structure (for example, a CP...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1223",
        "name": "Race Condition for Write-Once Attributes",
        "abstraction": "Base",
        "score": 0.4767145540020008,
        "description": "A write-once register in hardware design is programmable by an untrusted software component earlier than the trusted software component, resulting in a race condition issue....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1264",
        "name": "Hardware Logic with Insecure De-Synchronization between Control and Data Channels",
        "abstraction": "Base",
        "score": 0.4534622983029668,
        "description": "The hardware logic for error handling and security checks can incorrectly forward data before the security check is complete....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1316",
        "name": "Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges",
        "abstraction": "Base",
        "score": 0.4514422124163743,
        "description": "The address map of the on-chip fabric has protected and unprotected regions overlapping, allowing an attacker to bypass access control to the overlapping portion of the protected region....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "782",
        "name": "Exposed IOCTL with Insufficient Access Control",
        "abstraction": "Variant",
        "score": 0.44929619967632767,
        "description": "The product implements an IOCTL with functionality that should be restricted, but it does not properly enforce access control for the IOCTL....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1285",
        "name": "Improper Validation of Specified Index, Position, or Offset in Input",
        "abstraction": "Base",
        "score": 0.4450580644341633,
        "description": "The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the spe...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "822",
        "name": "Untrusted Pointer Dereference",
        "abstraction": "Base",
        "score": 0.44466049633126836,
        "description": "The product obtains a value from an untrusted source, converts this value to a pointer, and dereferences the resulting pointer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "363",
        "name": "Race Condition Enabling Link Following",
        "abstraction": "Base",
        "score": 0.4430283073921255,
        "description": "The product checks the status of a file or directory before accessing it, which produces a race condition in which the file can be replaced with a link before the access is performed, causing the prod...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "413",
        "name": "Improper Resource Locking",
        "abstraction": "Base",
        "score": 0.43922007555173614,
        "description": "The product does not lock or does not correctly lock a resource when the product must have exclusive access to the resource....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1262",
        "name": "Improper Access Control for Register Interface",
        "abstraction": "Base",
        "score": 0.4389987679365578,
        "description": "The product uses memory-mapped I/O registers that act as an interface to hardware functionality from software, but there is improper access control to those registers....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "823",
        "name": "Use of Out-of-range Pointer Offset",
        "abstraction": "Base",
        "score": 0.43758234980228766,
        "description": "The product performs pointer arithmetic on a valid pointer, but it uses an offset that can point outside of the intended range of valid memory locations for the resulting pointer....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "abstraction": "Class",
        "score": 1010.6630225615347,
        "description": "The product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code ...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "364",
        "name": "Signal Handler Race Condition",
        "abstraction": "Base",
        "score": 1007.5525696454283,
        "description": "The product uses a signal handler that introduces a race condition....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "787",
        "name": "Out-of-bounds Write",
        "abstraction": "Base",
        "score": 1000.0,
        "description": "The product writes data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "abstraction": "Base",
        "score": 923.2560784890784,
        "description": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can ca...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "401",
        "name": "Missing Release of Memory after Effective Lifetime",
        "abstraction": "Variant",
        "score": 919.0019483958348,
        "description": "The product does not sufficiently track and release allocated memory after it has been used, which slowly consumes remaining memory....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "Base",
        "score": 907.424752110812,
        "description": "The product dereferences a pointer that it expects to be valid but is NULL....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "754",
        "name": "Improper Check for Unusual or Exceptional Conditions",
        "abstraction": "Class",
        "score": 902.1821458233161,
        "description": "The product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 896.5986873201125,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "667",
        "name": "Improper Locking",
        "abstraction": "Class",
        "score": 886.3752145066542,
        "description": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "193",
        "name": "Off-by-one Error",
        "abstraction": "Base",
        "score": 885.0964136989012,
        "description": "A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "617",
        "name": "Reachable Assertion",
        "abstraction": "Base",
        "score": 884.7381951448378,
        "description": "The product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "Base",
        "score": 833.1976056003689,
        "description": "The product reads data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "abstraction": "Base",
        "score": 824.3677555782733,
        "description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the in...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "Variant",
        "score": 800.0,
        "description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a locati...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "abstraction": "Base",
        "score": 292.47057153509536,
        "description": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.43758234980228766,
      "max": 0.5091308128049415,
      "mean": 0.4698211711422259,
      "median": 0.47762665853895175,
      "count": 20
    },
    "sparse": {
      "min": 292.47057153509536,
      "max": 1010.6630225615347,
      "mean": 864.86166402735,
      "median": 896.5986873201125,
      "count": 15
    },
    "graph": {
      "min": 1.6848000000000003,
      "max": 2.8651999999999997,
      "mean": 2.0161529485828495,
      "median": 2.04,
      "count": 20
    }
  }
}