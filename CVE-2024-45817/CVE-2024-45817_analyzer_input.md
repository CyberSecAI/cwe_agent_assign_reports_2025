# Vulnerability Information: CVE-2024-45817

## Vulnerability Description
In x86s APIC (Advanced Programmable Interrupt Controller) architecture, error conditions are reported in a status register. Furthermore, the OS can opt to receive an interrupt when a new error occurs. It is possible to configure the error interrupt with an illegal vector, which generates an error when an error interrupt is raised. This case causes Xen to recurse through vlapic_error(). The **recursion** itself is bounded errors accumulate in the the status register and only generate an interrupt when a new status bit becomes set. However, the lock protecting this state in Xen will try to be taken recursively, and deadlock.

### Vulnerability Description Key Phrases
- **rootcause:** **illegal vector for error interrupt**
- **weakness:** **recursion**
- **impact:** deadlock
- **product:** Xen
- **component:** vlapc_error()

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Recursive call to `vlapic_error()` due to an illegal vector configuration for the error interrupt in the x86 APIC.
- **Weaknesses/vulnerabilities present:**
    - Recursion in `vlapic_error()` function.
    - Recursive lock acquisition attempt.
- **Impact of exploitation:** Deadlock of Xen, leading to a Denial of Service (DoS).
- **Attack vectors:** A buggy or malicious HVM or PVH guest can trigger the vulnerability.
- **Required attacker capabilities/position:**
    - Ability to configure the error interrupt with an illegal vector within an HVM or PVH guest.
    - Must be running on an x86 system using Xen 4.5 or later.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.583 |
| 2 | 833 | Deadlock | Base | Allowed | sparse | 0.582 |
| 3 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.574 |
| 4 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | Allowed-with-Review | sparse | 0.557 |
| 5 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.546 |
| 6 | 828 | Signal Handler with Functionality that is not Asynchronous-Safe | Variant | Allowed | sparse | 0.541 |
| 7 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | Allowed | sparse | 0.535 |
| 8 | 670 | Always-Incorrect Control Flow Implementation | Class | Allowed-with-Review | sparse | 0.533 |
| 9 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | Allowed | dense | 0.490 |
| 10 | 476 | NULL Pointer Dereference | Base | Allowed | graph | 0.002 |

