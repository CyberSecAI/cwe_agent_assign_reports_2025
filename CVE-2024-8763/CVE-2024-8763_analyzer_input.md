# Vulnerability Information: CVE-2024-8763

## Vulnerability Description
A **Regular Expression Denial of Service (ReDoS)** vulnerability exists in the lunary-ai/lunary repository, specifically in the compileTextTemplate function. The affected version is git be54057. An attacker can exploit this vulnerability by manipulating the regular expression /{{(.*?)}}/g, causing the server to hang indefinitely and become unresponsive to any requests. This is due to the regular expressions susceptibility to second-degree polynomial time complexity, which can be triggered by a large number of braces in the input.

### Vulnerability Description Key Phrases
- **weakness:** **Regular Expression Denial of Service (ReDoS)**
- **impact:** become unresponsive to any requests and hang
- **vector:** manipulating the regular expression /{{(.*?)}}/g
- **attacker:** attacker
- **product:** lunary-ai/lunary repository
- **version:** git be54057
- **component:** compileTextTemplate function

## CVE Reference Links Content Summary
The content relates to CVE-2024-8763.

**Root cause of vulnerability:**
The commit message indicates a fix for Regular Expression Denial of Service (ReDoS).

**Weaknesses/vulnerabilities present:**
Regular Expression Denial of Service (ReDoS) vulnerability.

**Impact of exploitation:**
The impact is not explicitly stated, but ReDoS can lead to excessive CPU consumption and potentially cause a denial of service.

**Attack vectors:**
Crafted regular expressions that cause backtracking in the regex engine.

**Required attacker capabilities/position:**
An attacker needs to be able to supply input that is processed by the vulnerable regular expression.

**Mitigation or fix:**
The commit `7ff89b0` fixes the ReDoS vulnerability (as referenced by pull request #557). The specific changes are in the files: `package-lock.json`, `packages/backend/package.json`, `packages/backend/src/api/v1/auth/utils.ts`, `packages/backend/src/checks/index.ts`, `packages/backend/src/utils/calcCost.ts`, and `packages/backend/src/utils/playground.ts`.

**More detail than official CVE description:**
Yes, the content provides details about the specific commit and files modified to address the vulnerability, which is more detailed than a typical CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | alternate_terms | 0.800 |
| 2 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.503 |
| 3 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.480 |
| 4 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.448 |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.446 |
| 6 | 185 | Incorrect Regular Expression | Class | Allowed-with-Review | sparse | 0.434 |
| 7 | 131 | Incorrect Calculation of Buffer Size | Base | Allowed | sparse | 0.426 |
| 8 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.426 |
| 9 | 777 | Regular Expression without Anchors | Variant | Allowed | dense | 0.500 |
| 10 | 182 | Collapse of Data into Unsafe Value | Base | Allowed | graph | 0.002 |

