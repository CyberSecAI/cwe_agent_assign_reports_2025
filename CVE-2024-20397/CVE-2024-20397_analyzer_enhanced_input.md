## Vulnerability Description
A vulnerability in the bootloader of Cisco NX-OS Software could allow an unauthenticated attacker with physical access to an affected device, or an authenticated, local attacker with administrative credentials, to bypass NX-OS image signature verification. This vulnerability is due to **insecure bootloader settings**. An attacker could exploit this vulnerability by executing a series of bootloader commands. A successful exploit could allow the attacker to bypass NX-OS image signature verification and load unverified software.

### Vulnerability Description Key Phrases
- **rootcause:** **insecure bootloader settings**
- **impact:** bypass NX-OS image signature verification and load unverified software
- **vector:** executing a series of bootloader commands
- **attacker:** unauthenticated attacker with physical access and authenticated local attacker with administrative credentials
- **product:** Cisco NX-OS Software
- **component:** bootloader

## CVE Reference Links Content Summary
```
{
  "CVE-2024-20397": {
    "related_content": [
      {
        "source": "www.cisco.com_eb6a33b1_20250115_121920.html",
        "text": "This document discusses managing FPGA/EPLD/BIOS firmware on Cisco switches within the context of Cisco ACI. It explains that under normal conditions, the firmware is automatically updated through the APIC during a regular switch firmware upgrade. However, when a switch boots up using an ACI image outside of the APIC-initiated upgrade process, a firmware mismatch can occur. The document explains that since APIC release 5.2(1) and ACI switch release 15.2(1), ACI switches automatically upgrade the FPGA/EPLD/BIOS during bootup for leaf switches and box-type spine switches, along with the supervisor, linecard, and fabric modules in modular-type spine switches. The upgrade process involves comparing the BIOS and EPLD/FPGA versions and initiating an upgrade followed by power cycling the component if needed. It also mentions that system controllers do not get firmware upgrades during normal boot up sequence, and you would need to upgrade them through APICs."
      },
      {
        "source": "sec.cloudapps.cisco.com_d40ca4f4_20250115_121914.html",
        "text": "This document is a Cisco Security Advisory for CVE-2024-20397. It describes a vulnerability in the bootloader of Cisco NX-OS Software that could allow an unauthenticated attacker with physical access or an authenticated local attacker with administrative credentials to bypass NX-OS image signature verification. This vulnerability stems from insecure bootloader settings and can be exploited through a series of bootloader commands. A successful exploit allows an attacker to load unverified software. The advisory also indicates which products are affected (MDS 9000, Nexus 3000, 7000, 9000 series switches, and UCS 6400/6500 Fabric Interconnects), how to determine the NX-OS BIOS version, and states that there are no workarounds. A fix requires a BIOS update, which can be completed by upgrading NX-OS software or using specific SMUs for standalone devices. Fixed versions for specific devices and software releases are also included."
      },
      {
        "source": "sec.cloudapps.cisco.com_53341f93_20250115_121917.html",
        "text": "This document is Cisco's Security Vulnerability Policy. It outlines Cisco's approach to security vulnerabilities in its products, including incident response, reporting methods, and how security vulnerability information is communicated to customers.  It mentions Cisco's PSIRT is responsible for handling security incidents, and encourages individuals to report suspected issues via psirt@cisco.com or phone.  It also describes the use of CVSS and SIR ratings, various security publications like security advisories, event responses, and release note enclosures, along with the schedule for disclosing security advisories. It also touches upon security software updates and the Cisco bug bounty programs."
      },
      {
        "source": "www.cisco.com_2f9f34d7_20250115_121914.html",
        "text": "This document is a Cisco Intersight Managed Mode Configuration Guide, specifically focusing on managing firmware. It outlines how to upgrade firmware for various components in a Cisco UCS Domain through Cisco Intersight, including Fabric Interconnects and servers (B-Series and C-Series). It details the workflows for fabric and host firmware upgrades, and emphasizes the automatic firmware upgrades available for specific components, as well as guidelines for managing firmware when using RMA for Fabric Interconnects and servers. The document also includes information about using firmware policies for server upgrades."
      },
      {
        "source": "sec.cloudapps.cisco.com_a26a01cc_20250115_121916.html",
        "text": "This document is Cisco's Security Vulnerability Policy. It outlines Cisco's approach to security vulnerabilities in its products, including incident response, reporting methods, and how security vulnerability information is communicated to customers. It mentions Cisco's PSIRT is responsible for handling security incidents, and encourages individuals to report suspected issues via psirt@cisco.com or phone. It also describes the use of CVSS and SIR ratings, various security publications like security advisories, event responses, and release note enclosures, along with the schedule for disclosing security advisories. It also touches upon security software updates and the Cisco bug bounty programs."
      },
      {
        "source": "sec.cloudapps.cisco.com_541defda_20250115_185545.html",
        "text": "This document is a CSAF (Common Security Advisory Framework) file detailing the Cisco NX-OS Software Image Verification Bypass Vulnerability (CVE-2024-20397). It outlines the vulnerability summary, which involves bypassing NX-OS image signature verification through insecure bootloader settings, allowing attackers with physical access or local admin access to load unverified software. It also lists affected Cisco products (MDS, Nexus, and UCS Fabric Interconnect platforms that support secure boot), workarounds (none), and fixed software, including specific BIOS versions and corresponding NX-OS software releases or SMUs. The document also notes a thanks to a researcher for reporting the vulnerability."
      },
      {
          "source": "www.cisco.com_c8d6cf26_20250115_121923.html",
        "text": "This document is the Cisco Nexus 9000 Series NX-OS Software Upgrade and Downgrade Guide, Release 10.4(x). It contains information about software images, including details about  64-bit images supported on Cisco Nexus platforms. It also outlines guidelines for upgrading and downgrading the Cisco Nexus 9000 Series NX-OS software, touching upon ISSU, recommendations, prerequisites, upgrade paths, and how to manage upgrades in vPC topologies. The guide also provides software patch instructions."
      },
       {
        "source": "sec.cloudapps.cisco.com_a26a01cc_20250115_121916.html",
         "text": "This document is Cisco's Security Vulnerability Policy. It outlines Cisco's approach to security vulnerabilities in its products, including incident response, reporting methods, and how security vulnerability information is communicated to customers. It mentions Cisco's PSIRT is responsible for handling security incidents, and encourages individuals to report suspected issues via psirt@cisco.com or phone. It also describes the use of CVSS and SIR ratings, various security publications like security advisories, event responses, and release note enclosures, along with the schedule for disclosing security advisories. It also touches upon security software updates and the Cisco bug bounty programs."
      },
          {
        "source": "www.cisco.com_c8d6cf26_20250115_121923.html",
          "text":"This document provides guidelines for upgrading and downgrading Cisco Nexus 9000 Series NX-OS Software, Release 10.4(x). It includes information about Cisco NX-OS software images, ISSU (In Service Software Upgrade), and recommendations, prerequisites for upgrades and downgrades, upgrade paths, as well as instructions on how to perform upgrades via CLI and guidelines for vPC topologies. "
      },
         {
            "source": "www.cisco.com_1c1a8903_20250115_121914.html",
            "text": "This document is the Cisco Worldwide Support Contacts page. It provides phone numbers for Cisco TAC (Technical Assistance Center) support in various regions, and also provides links to additional resources like the support portal, product returns and replacement, and the Cisco community."
          },
          {
             "source": "www.cisco.com_3d92c17b_20250115_121911.html",
             "text": "This document is a Cisco end-of-sale and end-of-life announcement for the Cisco Nexus N9K-C92160YC-X. It includes information regarding the end-of-sale date, last ship date, end-of-life milestones, product part numbers affected, product migration options, and other details related to the lifecycle of the product."
           },
{
        "source": "sec.cloudapps.cisco.com_6bc878d7_20250115_121916.html",
        "text": "This document is Cisco's Security Vulnerability Policy. It outlines Cisco's approach to security vulnerabilities in its products, including incident response, reporting methods, and how security vulnerability information is communicated to customers.  It mentions Cisco's PSIRT is responsible for handling security incidents, and encourages individuals to report suspected issues via psirt@cisco.com or phone. It also describes the use of CVSS and SIR ratings, various security publications like security advisories, event responses, and release note enclosures, along with the schedule for disclosing security advisories. It also touches upon security software updates and the Cisco bug bounty programs."
      },
 {
         "source": "www.cisco.com_abe025ae_20250115_121914.html",
         "text": "This page is for My Notifications, a service that allows registered Cisco.com users to create custom subscriptions for Cisco products to receive email alerts or RSS feeds regarding Cisco Security Advisories, Field Notices, End of Sale and End of Support Announcements, software updates and bug information."
       },
    {
        "source": "www.cisco.com_d8503aba_20250115_121924.html",
        "text": "This page is a general Cisco Support & Downloads page with links to product support, software downloads, licensing, support tools, and various other help resources. It provides links to various support resources like open cases, software downloads, and links to Cisco communities."
      },
    {
        "source": "sec.cloudapps.cisco.com_cf985588_20250115_121922.html",
        "text": "This document is a listing of Cisco Security Advisories with the option to filter by product, severity and date, along with search functionality.  It mentions that Cisco security advisories are point in time documents and information should be considered up to date as of the last publication update."
      },
        {
        "source": "www.cisco.com_4b838abc_20250115_121913.html",
        "text": "This document is Cisco's customer contract experience page which explains how Cisco contracts work; covering general terms, supplemental terms, and offer descriptions. It provides additional resources related to Cisco services, buying programs, trust portal, and software transfer/re-use and portability policies along with other contracts-related information."
         },
      {
        "source": "www.cisco.com_32921cb8_20250115_121919.html",
          "text": "This document provides details on managing firmware through Cisco UCS Manager (UCSM). It covers downloading and managing firmware, firmware upgrades through auto install and firmware packages in service profiles, firmware automatic synchronization, and direct firmware upgrade at endpoints. The topics included in this section are download and manage firmware, firmware upgrades through auto install, firmware upgrades through firmware packages in service profiles, firmware automatic synchronization, and direct firmware upgrades at endpoints."
      },
       {
            "source": "bst.cloudapps.cisco.com_0d9c9001_20250115_121915.html",
            "text": "This is a page from Cisco's bug search tool, showing an error message and stating that cookies are required."
          },
{
            "source": "sec.cloudapps.cisco.com_7f67dae0_20250115_185544.html",
             "text": "This document provides a CVSS (Common Vulnerability Scoring System) calculator that allows users to compute the CVSS score based on various parameters such as Attack Vector, Attack Complexity, Privileges Required, User Interaction, Scope, Confidentiality, Integrity and Availability Impact."
           }
        ]
   ,
    "vulnerability_details": {
      "root_cause": "The vulnerability is due to insecure bootloader settings.",
      "weaknesses": [
        "Insecure bootloader settings",
        "Lack of proper image signature verification"
      ],
      "impact": "Bypassing NX-OS image signature verification, leading to the ability to load unverified software, potentially compromising the device.",
      "attack_vectors": [
        "Physical access to the device",
        "Local access with administrative credentials"
      ],
      "attacker_capabilities": "An attacker needs either physical access to the device or local administrative credentials, and an understanding of bootloader commands."
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.545 |
| 2 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.493 |
| 3 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.475 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.472 |
| 5 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.472 |
| 6 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | Allowed | dense | 0.569 |
| 7 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | Allowed | graph | 0.002 |
| 8 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.455 |
| 9 | 250 | Execution with Unnecessary Privileges | Base | Allowed | sparse | 0.453 |
| 10 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.451 |



# Complete CWE Specifications


## CWE-347: Improper Verification of Cryptographic Signature
**Abstraction:** Base
**Status:** Draft

### Description
The product does not verify, or incorrectly verifies, the cryptographic signature for data.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-345
ChildOf -> CWE-345

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2002-1796:** Does not properly verify signatures for "trusted" entities.
- **CVE-2005-2181:** Insufficient verification allows spoofing.
- **CVE-2005-2182:** Insufficient verification allows spoofing.




## CWE-345: Insufficient Verification of Data Authenticity
**Abstraction:** Class
**Status:** Draft

### Description
The product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-693

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction


### Additional Notes
**[Relationship]** "origin validation" could fall under this.

**[Maintenance]** The specific ways in which the origin is not properly identified should be laid out as separate weaknesses. In some sense, this is more like a category.



### Observed Examples
- **CVE-2022-30260:** Distributed Control System (DCS) does not sign firmware images and only relies on insecure checksums for integrity checks
- **CVE-2022-30267:** Distributed Control System (DCS) does not sign firmware images and only relies on insecure checksums for integrity checks
- **CVE-2022-30272:** Remote Terminal Unit (RTU) does not use signatures for firmware images and relies on insecure checksums




## CWE-20: Improper Input Validation
**Abstraction:** Class
**Status:** Stable

### Description
The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly.

### Extended Description


Input validation is a frequently-used technique for checking potentially dangerous inputs in order to ensure that the inputs are safe for processing within the code, or when communicating with other components. When software does not validate input properly, an attacker is able to craft the input in a form that is not expected by the rest of the application. This will lead to parts of the system receiving unintended input, which may result in altered control flow, arbitrary control of a resource, or arbitrary code execution.


Input validation is not the only technique for processing input, however. Other techniques attempt to transform potentially-dangerous input into something safe, such as filtering (CWE-790) - which attempts to remove dangerous inputs - or encoding/escaping (CWE-116), which attempts to ensure that the input is not misinterpreted when it is included in output to another component. Other techniques exist as well (see CWE-138 for more examples.)


Input validation can be applied to:


  - raw data - strings, numbers, parameters, file contents, etc.

  - metadata - information about the raw data, such as headers or size

Data can be simple or structured. Structured data can be composed of many nested layers, composed of combinations of metadata and raw data, with other simple or structured data.

Many properties of raw data or metadata may need to be validated upon entry into the code, such as:


  - specified quantities such as size, length, frequency, price, rate, number of operations, time, etc.

  - implied or derived quantities, such as the actual size of a file instead of a specified size

  - indexes, offsets, or positions into more complex data structures

  - symbolic keys or other elements into hash tables, associative arrays, etc.

  - well-formedness, i.e. syntactic correctness - compliance with expected syntax 

  - lexical token correctness - compliance with rules for what is treated as a token

  - specified or derived type - the actual type of the input (or what the input appears to be)

  - consistency - between individual data elements, between raw data and metadata, between references, etc.

  - conformance to domain-specific rules, e.g. business logic 

  - equivalence - ensuring that equivalent inputs are treated the same

  - authenticity, ownership, or other attestations about the input, e.g. a cryptographic signature to prove the source of the data

Implied or derived properties of data must often be calculated or inferred by the code itself. Errors in deriving properties may be considered a contributing factor to improper input validation. 

Note that "input validation" has very different meanings to different people, or within different classification schemes. Caution must be used when referencing this CWE entry or mapping to it. For example, some weaknesses might involve inadvertently giving control to an attacker over an input when they should not be able to provide an input at all, but sometimes this is referred to as input validation.


Finally, it is important to emphasize that the distinctions between input validation and output escaping are often blurred, and developers must be careful to understand the difference, including how input validation is not always sufficient to prevent vulnerabilities, especially when less stringent data types must be supported, such as free-form text. Consider a SQL injection scenario in which a person's last name is inserted into a query. The name "O'Reilly" would likely pass the validation step since it is a common last name in the English language. However, this valid name cannot be directly inserted into the database because it contains the "'" apostrophe character, which would need to be escaped or otherwise transformed. In this case, removing the apostrophe might reduce the risk of SQL injection, but it would produce incorrect behavior because the wrong name would be recorded.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-707
PeerOf -> CWE-345
CanPrecede -> CWE-22
CanPrecede -> CWE-41
CanPrecede -> CWE-74
CanPrecede -> CWE-119
CanPrecede -> CWE-770

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-20 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available [REF-1287]. It is not useful for trend analysis. It is also a level-1 Class (i.e., a child of a Pillar).
**Comments:** Consider lower-level children such as Improper Use of Validation Framework (CWE-1173) or improper validation involving specific types or properties of input such as Specified Quantity (CWE-1284); Specified Index, Position, or Offset (CWE-1285); Syntactic Correctness (CWE-1286); Specified Type (CWE-1287); Consistency within Input (CWE-1288); or Unsafe Equivalence (CWE-1289).
**Reasons:**
- Frequent Misuse
**Suggested Alternatives:**
- CWE-1284: Specified Quantity
- CWE-1285: Specified Index, Position, or Offset
- CWE-1286: Syntactic Correctness
- CWE-1287: Specified Type
- CWE-1288: Consistency within Input
- CWE-1289: Unsafe Equivalence
- CWE-116: Improper Encoding or Escaping of Output


### Additional Notes
**[Relationship]** 

CWE-116 and CWE-20 have a close association because, depending on the nature of the structured message, proper input validation can indirectly prevent special characters from changing the meaning of a structured message. For example, by validating that a numeric ID field should only contain the 0-9 characters, the programmer effectively prevents injection attacks.


**[Maintenance]** As of 2020, this entry is used more often than preferred, and it is a source of frequent confusion. It is being actively modified for CWE 4.1 and subsequent versions.

**[Maintenance]** Concepts such as validation, data transformation, and neutralization are being refined, so relationships between CWE-20 and other entries such as CWE-707 may change in future versions, along with an update to the Vulnerability Theory document.

**[Maintenance]** Input validation - whether missing or incorrect - is such an essential and widespread part of secure development that it is implicit in many different weaknesses. Traditionally, problems such as buffer overflows and XSS have been classified as input validation problems by many security professionals. However, input validation is not necessarily the only protection mechanism available for avoiding such problems, and in some cases it is not even sufficient. The CWE team has begun capturing these subtleties in chains within the Research Concepts view (CWE-1000), but more work is needed.

**[Terminology]** 

The "input validation" term is extremely common, but it is used in many different ways. In some cases its usage can obscure the real underlying weakness or otherwise hide chaining and composite relationships.


Some people use "input validation" as a general term that covers many different neutralization techniques for ensuring that input is appropriate, such as filtering, canonicalization, and escaping. Others use the term in a more narrow context to simply mean "checking if an input conforms to expectations without changing it." CWE uses this more narrow interpretation.




### Observed Examples
- **CVE-2024-37032:** Large language model (LLM) management tool does not validate the format of a digest value (CWE-1287) from a private, untrusted model registry, enabling relative path traversal (CWE-23), a.k.a. Probllama
- **CVE-2022-45918:** Chain: a learning management tool debugger uses external input to locate previous session logs (CWE-73) and does not properly validate the given path (CWE-20), allowing for filesystem path traversal using "../" sequences (CWE-24)
- **CVE-2021-30860:** Chain: improper input validation (CWE-20) leads to integer overflow (CWE-190) in mobile OS, as exploited in the wild per CISA KEV.




## CWE-287: Improper Authentication
**Abstraction:** Class
**Status:** Draft

### Description
When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.

### Extended Description
Not provided

### Alternative Terms
authentification: An alternate term is "authentification", which appears to be most commonly used by people from non-English-speaking countries.
AuthN: "AuthN" is typically used as an abbreviation of "authentication" within the web application security community. It is also distinct from "AuthZ," which is an abbreviation of "authorization." The use of "Auth" as an abbreviation is discouraged, since it could be used for either authentication or authorization.
AuthC: "AuthC" is used as an abbreviation of "authentication," but it appears to used less frequently than "AuthN."

### Relationships
ChildOf -> CWE-284
ChildOf -> CWE-284

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** This CWE entry might be misused when lower-level CWE entries are likely to be applicable. It is a level-1 Class (i.e., a child of a Pillar).
**Comments:** Consider children or descendants, beginning with CWE-1390: Weak Authentication or CWE-306: Missing Authentication for Critical Function.
**Reasons:**
- Frequent Misuse
**Suggested Alternatives:**
- CWE-1390: Weak Authentication
- CWE-306: Missing Authentication for Critical Function


### Additional Notes
**[Relationship]** This can be resultant from SQL injection vulnerabilities and other issues.

**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the "Mapping CWE to 62443" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.



### Observed Examples
- **CVE-2022-35248:** Chat application skips validation when Central Authentication Service (CAS) is enabled, effectively removing the second factor from two-factor authentication
- **CVE-2022-36436:** Python-based authentication proxy does not enforce password authentication during the initial handshake, allowing the client to bypass authentication by specifying a 'None' authentication type.
- **CVE-2022-30034:** Chain: Web UI for a Python RPC framework does not use regex anchors to validate user login emails (CWE-777), potentially allowing bypass of OAuth (CWE-1390).




## CWE-284: Improper Access Control
**Abstraction:** Pillar
**Status:** Incomplete

### Description
The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.

### Extended Description


Access control involves the use of several protection mechanisms such as:


  - Authentication (proving the identity of an actor)

  - Authorization (ensuring that a given actor can access a resource), and

  - Accountability (tracking of activities that were performed)

When any mechanism is not applied or otherwise fails, attackers can compromise the security of the product by gaining privileges, reading sensitive information, executing commands, evading detection, etc.

There are two distinct behaviors that can introduce access control weaknesses:


  - Specification: incorrect privileges, permissions, ownership, etc. are explicitly specified for either the user or the resource (for example, setting a password file to be world-writable, or giving administrator capabilities to a guest user). This action could be performed by the program or the administrator.

  - Enforcement: the mechanism contains errors that prevent it from properly enforcing the specified access control requirements (e.g., allowing the user to specify their own privileges, or allowing a syntactically-incorrect ACL to produce insecure settings). This problem occurs within the program itself, in that it does not actually enforce the intended security policy that the administrator specifies.



### Alternative Terms
Authorization: The terms "access control" and "authorization" are often used interchangeably, although many people have distinct definitions. The CWE usage of "access control" is intended as a general term for the various mechanisms that restrict which users can access which resources, and "authorization" is more narrowly defined. It is unlikely that there will be community consensus on the use of these terms.

### Relationships
None

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-284 is extremely high-level, a Pillar. Its name, "Improper Access Control," is often misused in low-information vulnerability reports [REF-1287] or by active use of the OWASP Top Ten, such as "A01:2021-Broken Access Control". It is not useful for trend analysis.
**Comments:** Consider using descendants of CWE-284 that are more specific to the kind of access control involved, such as those involving authorization (Missing Authorization (CWE-862), Incorrect Authorization (CWE-863), Incorrect Permission Assignment for Critical Resource (CWE-732), etc.); authentication (Missing Authentication (CWE-306) or Weak Authentication (CWE-1390)); Incorrect User Management (CWE-286); Improper Restriction of Communication Channel to Intended Endpoints (CWE-923); etc.
**Reasons:**
- Frequent Misuse
- Abstraction
**Suggested Alternatives:**
- CWE-862: Missing Authorization
- CWE-863: Incorrect Authorization
- CWE-732: Incorrect Permission Assignment for Critical Resource
- CWE-306: Missing Authentication
- CWE-1390: Weak Authentication
- CWE-923: Improper Restriction of Communication Channel to Intended Endpoints


### Additional Notes
**[Maintenance]** 

This entry needs more work. Possible sub-categories include:


  - Trusted group includes undesired entities (partially covered by CWE-286)

  - Group can perform undesired actions

  - ACL parse error does not fail closed





### Observed Examples
- **CVE-2022-24985:** A form hosting website only checks the session authentication status for a single form, making it possible to bypass authentication when there are multiple forms
- **CVE-2022-29238:** Access-control setting in web-based document collaboration tool is not properly implemented by the code, which prevents listing hidden directories but does not prevent direct requests to files in those directories.
- **CVE-2022-23607:** Python-based HTTP library did not scope cookies to a particular domain such that "supercookies" could be sent to any domain on redirect




## CWE-1274: Improper Access Control for Volatile Memory Containing Boot Code
**Abstraction:** Base
**Status:** Stable

### Description
The product conducts a secure-boot process that transfers bootloader code from Non-Volatile Memory (NVM) into Volatile Memory (VM), but it does not have sufficient access control or other protections for the Volatile Memory.

### Extended Description


Adversaries could bypass the secure-boot process and execute their own untrusted, malicious boot code.


As a part of a secure-boot process, the read-only-memory (ROM) code for a System-on-Chip (SoC) or other system fetches bootloader code from Non-Volatile Memory (NVM) and stores the code in Volatile Memory (VM), such as dynamic, random-access memory (DRAM) or static, random-access memory (SRAM). The NVM is usually external to the SoC, while the VM is internal to the SoC. As the code is transferred from NVM to VM, it is authenticated by the SoC's ROM code.


If the volatile-memory-region protections or access controls are insufficient to prevent modifications from an adversary or untrusted agent, the secure boot may be bypassed or replaced with the execution of an adversary's code.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-284

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2019-2267:** Locked memory regions may be modified through other interfaces in a secure-boot-loader image due to improper access control.




## CWE-1299: Missing Protection Mechanism for Alternate Hardware Interface
**Abstraction:** Base
**Status:** Draft

### Description
The lack of protections on alternate paths to access
                control-protected assets (such as unprotected shadow registers
                and other external facing unguarded interfaces) allows an
                attacker to bypass existing protections to the asset that are
		only performed against the primary path.

### Extended Description


An asset inside a chip might have access-control protections through one interface. However, if all paths to the asset are not protected, an attacker might compromise the asset through alternate paths. These alternate paths could be through shadow or mirror registers inside the IP core, or could be paths from other external-facing interfaces to the IP core or SoC.


Consider an SoC with various interfaces such as UART, SMBUS, PCIe, USB, etc. If access control is implemented for SoC internal registers only over the PCIe interface, then an attacker could still modify the SoC internal registers through alternate paths by coming through interfaces such as UART, SMBUS, USB, etc. 


Alternatively, attackers might be able to bypass existing protections by exploiting unprotected, shadow registers. Shadow registers and mirror registers typically refer to registers that can be accessed from multiple addresses. Writing to or reading from the aliased/mirrored address has the same effect as writing to the address of the main register. They are typically implemented within an IP core or SoC to temporarily hold certain data. These data will later be updated to the main register, and both registers will be in synch. If the shadow registers are not access-protected, attackers could simply initiate transactions to the shadow registers and compromise system security. 


### Alternative Terms
None

### Relationships
PeerOf -> CWE-1191
ChildOf -> CWE-420
ChildOf -> CWE-288

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2022-38399:** Missing protection mechanism on serial connection allows for arbitrary OS command execution.
- **CVE-2020-9285:** Mini-PCI Express slot does not restrict direct memory access.
- **CVE-2020-8004:** When the internal flash is protected by blocking access on the Data Bus (DBUS), it can still be indirectly accessed through the Instruction Bus (IBUS).




## CWE-532: Insertion of Sensitive Information into Log File
**Abstraction:** Base
**Status:** Incomplete

### Description
The product writes sensitive information to a log file.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-538
ChildOf -> CWE-200

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2017-9615:** verbose logging stores admin credentials in a world-readable log file
- **CVE-2018-1999036:** SSH password for private key stored in build log




## CWE-250: Execution with Unnecessary Privileges
**Abstraction:** Base
**Status:** Draft

### Description
The product performs an operation at a privilege level that is higher than the minimum level required, which creates new weaknesses or amplifies the consequences of other weaknesses.

### Extended Description


New weaknesses can be exposed because running with extra privileges, such as root or Administrator, can disable the normal security checks being performed by the operating system or surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if they occur while operating at raised privileges.


Privilege management functions can behave in some less-than-obvious ways, and they have different quirks on different platforms. These inconsistencies are particularly pronounced if you are transitioning from one non-root user to another. Signal handlers and spawned processes run at the privilege of the owning process, so if a process is running as root when a signal fires or a sub-process is executed, the signal handler or sub-process will operate with root privileges.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-269
ChildOf -> CWE-657

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** There is a close association with CWE-653 (Insufficient Separation of Privileges). CWE-653 is about providing separate components for each privilege; CWE-250 is about ensuring that each component has the least amount of privileges possible.

**[Maintenance]** CWE-271, CWE-272, and CWE-250 are all closely related and possibly overlapping. CWE-271 is probably better suited as a category. Both CWE-272 and CWE-250 are in active use by the community. The "least privilege" phrase has multiple interpretations.

**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the "Mapping CWE to 62443" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.



### Observed Examples
- **CVE-2007-4217:** FTP client program on a certain OS runs with setuid privileges and has a buffer overflow. Most clients do not need extra privileges, so an overflow is not a vulnerability for those clients.
- **CVE-2008-1877:** Program runs with privileges and calls another program with the same privileges, which allows read of arbitrary files.
- **CVE-2007-5159:** OS incorrectly installs a program with setuid privileges, allowing users to gain privileges.




## CWE-269: Improper Privilege Management
**Abstraction:** Class
**Status:** Draft

### Description
The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-284

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-269 is commonly misused. It can be conflated with "privilege escalation," which is a technical impact that is listed in many low-information vulnerability reports [REF-1287]. It is not useful for trend analysis.
**Comments:** If an error or mistake allows privilege escalation, then use the CWE ID for that mistake. Avoid using CWE-269 when only phrases such as "privilege escalation" or "gain privileges" are available, as these indicate technical impact of the vulnerability - not the root cause weakness. If the root cause seems to be directly related to privileges, then examine the children of CWE-269 for additional hints, such as Execution with Unnecessary Privileges (CWE-250) or Incorrect Privilege Assignment (CWE-266).
**Reasons:**
- Frequent Misuse


### Additional Notes
**[Maintenance]** The relationships between privileges, permissions, and actors (e.g. users and groups) need further refinement within the Research view. One complication is that these concepts apply to two different pillars, related to control of resources (CWE-664) and protection mechanism failures (CWE-693).



### Observed Examples
- **CVE-2001-1555:** Terminal privileges are not reset when a user logs out.
- **CVE-2001-1514:** Does not properly pass security context to child processes in certain cases, allows privilege escalation.
- **CVE-2001-0128:** Does not properly compute roles.

