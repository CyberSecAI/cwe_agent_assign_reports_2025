## Vulnerability Description
Finit provides fast init for Linux systems. Finits urandom plugin has a heap buffer overwrite vulnerability at boot which leads to it overwriting other parts of the heap, possibly causing random instabilities and undefined behavior. The urandom plugin is enabled by default, so this bug affects everyone using Finit 4.2 or later that do not explicitly disable the plugin at build time. This bug is fixed in Finit 4.12. Those who cannot upgrade or backport the fix to urandom.c are strongly recommended to disable the plugin in the call to the `configure` script.

### Vulnerability Description Key Phrases
- **component:** urandom plugin
- **weakness:** **heap buffer overflow**
- **product:** Finit
- **impact:** random instabilities, undefined behavior
- **version:** 4.2 or later

## CVE Reference Links Content Summary
## CVE-2025-32022 Analysis

This content is directly related to CVE-2025-32022 and provides significantly more detail than the placeholder description.

**Root cause of vulnerability:**

A heap-based buffer overwrite vulnerability exists in the `urandom.so` plugin during boot. The vulnerability occurs when saving random seed data at shutdown and seeding `/dev/urandom` at boot.

**Weaknesses/vulnerabilities present:**

*   Heap-based buffer overflow (CWE-787)

**Impact of exploitation:**

*   Overwriting other parts of the heap.
*   Random instabilities.
*   Undefined behavior.
*   High integrity impact.
*   Low availability impact.

**Attack vectors:**

*   Local

**Attack complexity:**

*   High

**Required attacker capabilities/position:**

*   High privileges are required.
*   User interaction is required.

**Mitigation or fix:**

*   Upgrade to Finit 4.12 (patched version).
*   Disable the `urandom` plugin in the `configure` script if upgrading is not possible.
*   Backport the fix from commit [3feff37ba51fa0a6a0a06f59682a0918aa5b04de](https://github.com/troglobit/finit/commit/3feff37ba51fa0a6a0a06f59682a0918aa5b04de) to `urandom.c`.

**Additional Details:**

*   The `urandom` plugin is enabled by default, affecting users of Finit 4.2 or later who haven't disabled the plugin.
*   CVSS v3 score: 4.6/10 (AV:L/AC:H/PR:H/UI:R/S:U/C:N/I:H/A:L)
*   Reporter: @aanderse

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.490 |
| 4 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.461 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.454 |
| 6 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.452 |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.450 |
| 8 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.449 |
| 9 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | dense | 0.495 |
| 10 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-125: Out-of-bounds Read

CWE-863: Incorrect Authorization

CWE-122: Heap-based Buffer Overflow

CWE-789: Memory Allocation with Excessive Size Value

CWE-193: Off-by-one Error

CWE-909: Missing Initialization of Resource

CWE-1339: Insufficient Precision or Accuracy of a Real Number