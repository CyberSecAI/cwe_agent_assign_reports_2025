# Vulnerability Information: CVE-2024-13903

## Vulnerability Description
A vulnerability was found in quickjs-ng QuickJS up to 0.8.0. It has been declared as problematic. Affected by this vulnerability is the function JS_GetRuntime of the file quickjs.c of the component qjs. The manipulation leads to **stack-based buffer overflow**. The attack can be launched remotely. Upgrading to version 0.9.0 is able to address this issue. The patch is named 99c02eb45170775a9a679c32b45dd4000ea67aff. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **product:** quickjs-ng QuickJS
- **version:** up to 0.8.0
- **component:** JS_GetRuntime of the file quickjs.c

## CVE Reference Links Content Summary
## Analysis of CVE-2024-13903 related content

Based on the provided content, here's an analysis relevant to CVE-2024-13903 (assuming the CVE description relates to a stack-overflow vulnerability in quickjs):

**Relevant Content:**

The following content is relevant:

*   **Github Issue #775:**  Describes a stack-overflow issue in `JS_CallInternal` when running a specific JavaScript input (`input.js`). The provided input causes an `ASAN:DEADLYSIGNAL` error, specifically a stack-overflow.
*   **Commit 99c02eb:** This commit addresses the stack-overflow issue reported in issues #775, #671, and #776. The commit message states it updates the stack limit in ASan builds and removes unnecessary definitions related to sanitizers.
*   **Release v0.9.0:** This release includes the fix for the stack-overflow issue (fixes #775).

**Extracted Information:**

*   **Root cause of vulnerability:** Recursive function calls in the JavaScript code (`f(1,2,3)` within `f()`) lead to excessive stack usage, resulting in a stack-overflow.
*   **Weaknesses/vulnerabilities present:**  Insufficient stack size handling in `JS_CallInternal` when dealing with recursive function calls.
*   **Impact of exploitation:**  The vulnerability causes a crash (ASAN:DEADLYSIGNAL) due to a stack-overflow.  This could potentially lead to denial of service.
*   **Attack vectors:**  Providing a crafted JavaScript input with deeply nested or recursive function calls.
*   **Required attacker capabilities/position:** An attacker needs to be able to execute JavaScript code within the quickjs environment.
*   **Mitigation or fix:** The commit 99c02eb updates the stack limit in AddressSanitizer (ASan) builds to prevent the stack-overflow.  The commit also removes unnecessary sanitizer-related definitions.  This fix is included in release v0.9.0.

**Details beyond the official CVE description:**

The provided content gives more detail than a typical CVE description by:

*   Providing the specific JavaScript code that triggers the vulnerability (`input.js`).
*   Showing the stack trace from the AddressSanitizer (ASan) report, pinpointing the vulnerable function (`JS_CallInternal`).
*   Detailing the specific commit that fixes the issue and the reasoning behind the fix.
*   Indicating the release where the fix is included (v0.9.0).

**Note:** This analysis assumes that CVE-2024-13903 is related to the stack-overflow vulnerability described in the provided content. Without the official CVE description, this is an educated guess based on the information available.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.481 |
| 4 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.465 |
| 5 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.460 |
| 6 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.437 |
| 7 | 704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | sparse | 0.433 |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.432 |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.511 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

