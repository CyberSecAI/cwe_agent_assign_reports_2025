# Vulnerability Information: CVE-2024-52517

## Vulnerability Description
Nextcloud Server is a self hosted personal cloud system. After **storing Global credentials on the server**, the API returns them and adds them into the frontend again, allowing to read them in plain text when an attacker already has access to an active session of a user. It is recommended that the Nextcloud Server is upgraded to 28.0.11, 29.0.8 or 30.0.1 and Nextcloud Enterprise Server is upgraded to 25.0.13.13, 26.0.13.9, 27.1.11.9, 28.0.11, 29.0.8 or 30.0.1.

### Vulnerability Description Key Phrases
- **rootcause:** **storing Global credentials on the server**
- **impact:** read them in plain text
- **attacker:** attacker
- **product:** Nextcloud Server

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-52517:

**Root Cause of Vulnerability:**
The vulnerability stems from the fact that after storing "Global credentials" for external storage on the server, the API returns these credentials and adds them back to the frontend. This allows the credentials to be read in plain text.

**Weaknesses/Vulnerabilities Present:**
- Exposure of sensitive information (passwords) in plain text.
- Insecure handling of credentials by sending them to the frontend.
- Lack of proper masking or placeholder usage when returning credentials via API.

**Impact of Exploitation:**
- An attacker who has already gained access to an active user session can read the global credentials in plain text.
- This allows for potential unauthorized access to external storage systems linked to the Nextcloud instance.
- Compromise of external systems and data.

**Attack Vectors:**
- An attacker needs to have an active session in Nextcloud to exploit the vulnerability.
- The vulnerability is triggered when the API returns the stored "Global credentials" for external storage.

**Required Attacker Capabilities/Position:**
- The attacker needs to be logged into an active user session of Nextcloud.
- Access to the web browser and the Nextcloud frontend is required to intercept the credentials returned by the API.
- The attacker does not need any specific technical knowledge, besides being able to use the developer tools of the browser.

**Additional Notes**
- The fix implemented involved using a placeholder for the password when returning the credentials via the API.
- The vulnerability is assigned a CVSS score of 4.6, which is considered Moderate.
- The vulnerability was reported by Bundesamt f√ºr Sicherheit in der Informationstechnik (BSI) and mgm-sp.
- Patched versions include Nextcloud Server 28.0.11, 29.0.8, 30.0.1 and Nextcloud Enterprise Server versions 25.0.13.13, 26.0.13.9, 27.1.11.9, 28.0.11, 29.0.8, and 30.0.1
- The vulnerability is tracked as GHSA-x9q3-c7f8-3rcg.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.621 |
| 2 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.589 |
| 3 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.576 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.570 |
| 5 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.560 |
| 6 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.556 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.556 |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.532 |
| 9 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | dense | 0.438 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.002 |

