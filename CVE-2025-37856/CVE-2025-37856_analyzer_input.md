# Vulnerability Information: CVE-2025-37856

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved btrfs harden block_groupbg_list against list_del() races As far as I can tell, these calls of list_del_init() on bg_list cannot run concurrently with btrfs_mark_bg_unused() or btrfs_mark_bg_to_reclaim(), as they are in transaction error paths and situations where the block group is readonly. However, if there is any chance at all of racing with mark_bg_unused(), or a different future user of bg_list, better to be safe than sorry. Otherwise we risk the following interleaving (bg_list refcount in parens) T1 (some random op) T2 (btrfs_mark_bg_unused) !list_empty(&bg->bg_list) (1) list_del_init(&bg->bg_list) (1) list_move_tail (1) btrfs_put_block_group (0) btrfs_delete_unused_bgs bg = list_first_entry list_del_init(&bg->bg_list) btrfs_put_block_group(bg) (-1) Ultimately, this results in a broken ref count that hits zero one deref early and the real final deref underflows the refcount, resulting in a WARNING.

### Vulnerability Description Key Phrases
- **rootcause:** **races with list_del()**
- **weakness:** **double free**
- **impact:** broken ref count
- **product:** Linux kernel
- **component:** btrfs

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.517 |
| 2 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.514 |
| 3 | 415 | Double Free | Variant | Allowed | sparse | 0.513 |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.505 |
| 5 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.504 |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.504 |
| 7 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.499 |
| 8 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.496 |
| 9 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | dense | 0.465 |
| 10 | 364 | Signal Handler Race Condition | Base | Allowed | graph | 0.003 |

