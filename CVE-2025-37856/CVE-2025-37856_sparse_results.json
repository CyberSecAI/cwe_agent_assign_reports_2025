{
  "query": "In the Linux kernel, the following vulnerability has been resolved btrfs harden block_groupbg_list against list_del() races As far as I can tell, these calls of list_del_init() on bg_list cannot run concurrently with btrfs_mark_bg_unused() or btrfs_mark_bg_to_reclaim(), as they are in transaction error paths and situations where the block group is readonly. However, if there is any chance at all of racing with mark_bg_unused(), or a different future user of bg_list, better to be safe than sorry. Otherwise we risk the following interleaving (bg_list refcount in parens) T1 (some random op) T2 (btrfs_mark_bg_unused) !list_empty(&bg->bg_list) (1) list_del_init(&bg->bg_list) (1) list_move_tail (1) btrfs_put_block_group (0) btrfs_delete_unused_bgs bg = list_first_entry list_del_init(&bg->bg_list) btrfs_put_block_group(bg) (-1) Ultimately, this results in a broken ref count that hits zero one deref early and the real final deref underflows the refcount, resulting in a WARNING.",
  "count": 12,
  "results": [
    {
      "cwe_id": "617",
      "name": "Reachable Assertion",
      "abstraction": "Base",
      "score": 516.6661002624345,
      "original_score": 516.6661002624345,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "328",
      "name": "Use of Weak Hash",
      "abstraction": "Base",
      "score": 514.3101186303704,
      "original_score": 514.3101186303704,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "415",
      "name": "Double Free",
      "abstraction": "Variant",
      "score": 513.410807825295,
      "original_score": 513.410807825295,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "59",
      "name": "Improper Link Resolution Before File Access ('Link Following')",
      "abstraction": "Base",
      "score": 505.351776377073,
      "original_score": 505.351776377073,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "476",
      "name": "NULL Pointer Dereference",
      "abstraction": "Base",
      "score": 504.1646624685887,
      "original_score": 504.1646624685887,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 503.53190169253014,
      "original_score": 503.53190169253014,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "923",
      "name": "Improper Restriction of Communication Channel to Intended Endpoints",
      "abstraction": "Class",
      "score": 499.3912916789948,
      "original_score": 499.3912916789948,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "918",
      "name": "Server-Side Request Forgery (SSRF)",
      "abstraction": "Base",
      "score": 496.1244466294356,
      "original_score": 496.1244466294356,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 495.281761125029,
      "original_score": 495.281761125029,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "212",
      "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
      "abstraction": "Base",
      "score": 494.3486546583625,
      "original_score": 494.3486546583625,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "364",
      "name": "Signal Handler Race Condition",
      "abstraction": "Base",
      "score": 464.3286204048719,
      "original_score": 464.3286204048719,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "335",
      "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
      "abstraction": "Base",
      "score": 460.5941345228249,
      "original_score": 460.5941345228249,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 460.5941345228249,
    "max": 516.6661002624345,
    "mean": 497.2920230229842,
    "median": 501.46159668576246,
    "count": 12
  }
}