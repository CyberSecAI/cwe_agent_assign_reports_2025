# Vulnerability Information: CVE-2024-11275

## Vulnerability Description
The WP Timetics- AI-powered Appointment Booking Calendar and Online Scheduling Plugin plugin for WordPress is vulnerable to unauthorized loss of data due to a **missing capability check** on the /wp-json/timetics/v1/customers/ REST API endpoint in all versions up to, and including, 1.0.27. This makes it possible for authenticated attackers, with Timetics Customer access and above, to delete arbitrary users.

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **impact:** delete arbitrary users and unauthorized loss of data
- **attacker:** authenticated attackers
- **product:** WP Timetics- AI-powered Appointment Booking Calendar and Online Scheduling Plugin
- **version:** up to and including 1.0.27
- **component:** /wp-json/timetics/v1/customers/ REST API endpoint

## CVE Reference Links Content Summary
### Root cause of vulnerability
The vulnerability stems from a missing capability check on the `/wp-json/timetics/v1/customers/` REST API endpoint. Specifically, the `delete_item` function in `/core/customers/api-customer.php` used to allow users with the `timetics-customer` capability to delete arbitrary user data, due to an incorrect permission check. This was changed in version 1.0.28 to require the 'manage_options' capability. The `bulk_delete` function, which allowed deletion of multiple customer records, also had insufficient authorization checks.

### Weaknesses/vulnerabilities present
- **Missing Authorization Check:** The primary weakness is the lack of proper authorization checks for the delete functionality on the customers REST API endpoint.
- **Inadequate Capability:** The `timetics-customer` capability was insufficient for performing user deletion.

### Impact of exploitation
- **Unauthorized Data Loss:** Authenticated attackers with the `timetics-customer` role (or higher) could delete arbitrary users on the site. This results in data loss, as user information is deleted.

### Attack vectors
- **REST API Endpoint:** The attack vector is the `/wp-json/timetics/v1/customers/` REST API endpoint, specifically through the delete methods.
- **HTTP Requests:** Attackers would send HTTP requests to this endpoint to trigger the deletion of user records.

### Required attacker capabilities/position
- **Authenticated User:** The attacker needs to be an authenticated user on the WordPress site.
- **Sufficient Role/Capability:** The attacker needs to have the `timetics-customer` role (or higher access).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.440 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.421 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.418 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.394 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.387 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.374 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.367 |
| 8 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.360 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.474 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

