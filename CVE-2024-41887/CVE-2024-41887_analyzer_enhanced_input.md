## Vulnerability Description
Team ENVY, a Security Research TEAM has found a flaw that allows for a remote code execution on the NVR. An attacker can create an NVR log file in a directory one level higher on the system, which can be used to corrupt files in the directory. The manufacturer has released patch firmware for the flaw, please refer to the manufacturers report for details and workarounds.

### Vulnerability Description Key Phrases
- **vector:** create NVR log file
- **product:** NVR
- **impact:** Remote Code Execution, create NVR log file one level higher
- **attacker:** attacker

## CVE Reference Links Content Summary
Based on the provided document, here's the breakdown for CVE-2024-41887:

**Root Cause of Vulnerability:**
The vulnerability stems from the way the NVR's log generation feature handles directory specifications, allowing an attacker to write log files to a directory one level above the intended log directory.

**Weaknesses/Vulnerabilities Present:**
- **Arbitrary File Overwrite (limited):** The core vulnerability is the ability to write log files outside of the intended directory, effectively overwriting files. However, the overwrite path is limited to only one directory level up.

**Impact of Exploitation:**
- **Limited Arbitrary File Overwrite:** The attacker can overwrite existing files, but it's limited to the directory immediately above the configured log directory. This overwrite has the potential to impact NVR functionality or create unwanted log data.
- **Compromised availability:** Overwriting certain files may impact the availability of the NVR.

**Attack Vectors:**
- The vulnerability is exploited through the log generation feature of the NVR.

**Required Attacker Capabilities/Position:**
- **Administrative Privileges:** The attacker must have administrative authentication privileges on the NVR's web interface to exploit the vulnerability.
- **Network Access:** Attackers need to be able to access the NVR's web admin page.

**Additional Notes:**
- The document states that the attacker cannot change the path to any arbitrary directory, limiting the scope of the overwrite.
- The report characterizes the risk as "low" because of the limited nature of the arbitrary file overwrite and the requirement for administrative authentication.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.130 |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.129 |
| 3 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.129 |
| 4 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.126 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.126 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.125 |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.125 |
| 8 | 250 | Execution with Unnecessary Privileges | Base | Allowed | sparse | 0.124 |
| 9 | 378 | Creation of Temporary File With Insecure Permissions | Base | Allowed | dense | 0.519 |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-276: Incorrect Default Permissions

CWE-863: Incorrect Authorization

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-250: Execution with Unnecessary Privileges

CWE-378: Creation of Temporary File With Insecure Permissions

CWE-386: Symbolic Name not Mapping to Correct Object