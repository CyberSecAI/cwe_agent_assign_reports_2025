# Vulnerability Information: CVE-2025-21656

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved hwmon (drivetemp) Fix driver producing garbage data when SCSI errors occur scsi_execute_cmd() function can return both negative (linux codes) and positive (scsi_cmnd result field) error codes. Currently the driver just passes error codes of scsi_execute_cmd() to hwmon core, which is incorrect because **hwmon only checks for negative error codes**. This leads to hwmon reporting uninitialized data to userspace in case of SCSI errors (for example if the disk drive was disconnected). This patch checks scsi_execute_cmd() output and returns -EIO if its error code is positive. [groeck Avoid inline variable declaration for portability]

### Vulnerability Description Key Phrases
- **rootcause:** **hwmon only checks for negative error codes**
- **impact:** hwmon reporting uninitialized data to userspace
- **product:** Linux kernel
- **component:** hwmon (drivetemp)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 839 | Numeric Range Comparison Without Minimum Check | Base | Allowed | sparse | 0.482 |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.477 |
| 3 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | Allowed-with-Review | sparse | 0.459 |
| 4 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | sparse | 0.444 |
| 5 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.434 |
| 6 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.432 |
| 7 | 908 | Use of Uninitialized Resource | Base | Allowed | sparse | 0.430 |
| 8 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.420 |
| 9 | 394 | Unexpected Status Code or Return Value | Base | Allowed | dense | 0.509 |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | graph | 0.002 |

