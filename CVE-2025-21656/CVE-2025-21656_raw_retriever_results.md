# Raw Retriever Results for CVE-2025-21656

# Raw Retriever Results for CVE-2025-21656
## Query
In the Linux kernel, the following vulnerability has been resolved hwmon (drivetemp) Fix driver producing garbage data when SCSI errors occur scsi_execute_cmd() function can return both negative (linux codes) and positive (scsi_cmnd result field) error codes. Currently the driver just passes error codes of scsi_execute_cmd() to hwmon core, which is incorrect because hwmon only checks for negative error codes. This leads to hwmon reporting uninitialized data to userspace in case of SCSI errors (for example if the disk drive was disconnected). This patch checks scsi_execute_cmd() output and returns -EIO if its error code is positive. [groeck Avoid inline variable declaration for portability]

## Keyphrases
- **rootcause**: 'hwmon only checks for negative error codes'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4323 | 0.5093 | 0.4505 | 0.4472 | 20 |
| Sparse | 131.7103 | 481.9925 | 370.1599 | 429.9133 | 13 |
| Graph | 1.6848 | 4.3290 | 2.1035 | 1.7464 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 124 | Buffer Underwrite ('Buffer Underflow') | base | 4.3290 | Allowed |
| 2 | 839 | Numeric Range Comparison Without Minimum Check | base | 4.3290 | Allowed |
| 3 | 908 | Use of Uninitialized Resource | Base | 2.8026 | Allowed |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2594 | Allowed-with-Review |
| 5 | 456 | Missing Initialization of a Variable | variant | 2.0554 | Allowed |
| 6 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 7 | 195 | Signed to Unsigned Conversion Error | variant | 2.0400 | Allowed |
| 8 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 9 | 170 | Improper Null Termination | base | 1.7680 | Allowed |
| 10 | 822 | Untrusted Pointer Dereference | base | 1.7680 | Allowed |
| 11 | 909 | Missing Initialization of Resource | Class | 1.7247 | Allowed-with-Review |
| 12 | 394 | Unexpected Status Code or Return Value | Base | 1.7067 | Allowed |
| 13 | 364 | Signal Handler Race Condition | base | 1.6848 | Allowed |
| 14 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 15 | 681 | Incorrect Conversion between Numeric Types | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 394 | Unexpected Status Code or Return Value | Base | 0.5093 | 0.5093 | Allowed |
| 2 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4725 | 0.4725 | Allowed |
| 3 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4675 | 0.4675 | Allowed |
| 4 | 1262 | Improper Access Control for Register Interface | Base | 0.4621 | 0.4621 | Allowed |
| 5 | 908 | Use of Uninitialized Resource | Base | 0.4580 | 0.4580 | Allowed |
| 6 | 393 | Return of Wrong Status Code | Base | 0.4528 | 0.4528 | Allowed |
| 7 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4516 | 0.4516 | Allowed |
| 8 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4488 | 0.4488 | Allowed |
| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4483 | 0.4483 | Discouraged |
| 10 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4473 | 0.4473 | Allowed |
| 11 | 1338 | Improper Protections Against Hardware Overheating | Base | 0.4471 | 0.4471 | Allowed |
| 12 | 1314 | Missing Write Protection for Parametric Data Values | Base | 0.4466 | 0.4466 | Allowed |
| 13 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | Variant | 0.4451 | 0.4451 | Allowed |
| 14 | 1351 | Improper Handling of Hardware Behavior in Exceptionally Cold Environments | Base | 0.4403 | 0.4403 | Allowed |
| 15 | 457 | Use of Uninitialized Variable | Variant | 0.4374 | 0.4374 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 839 | Numeric Range Comparison Without Minimum Check | 481.9925 | 481.9925 | Allowed |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | 477.3445 | 477.3445 | Allowed |
| 3 | 754 | Improper Check for Unusual or Exceptional Conditions | 458.8218 | 458.8218 | Allowed-with-Review |
| 4 | 124 | Buffer Underwrite ('Buffer Underflow') | 444.2482 | 444.2482 | Allowed |
| 5 | 909 | Missing Initialization of Resource | 434.3155 | 434.3155 | Allowed-with-Review |
| 6 | 667 | Improper Locking | 432.3791 | 432.3791 | Allowed-with-Review |
| 7 | 908 | Use of Uninitialized Resource | 429.9133 | 429.9133 | Allowed |
| 8 | 197 | Numeric Truncation Error | 419.7142 | 419.7142 | Allowed |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 418.5869 | 418.5869 | Allowed |
| 10 | 195 | Signed to Unsigned Conversion Error | 417.8503 | 417.8503 | Allowed |
| 11 | 833 | Deadlock | 132.6904 | 132.6904 | Allowed |
| 12 | 457 | Use of Uninitialized Variable | 132.5124 | 132.5124 | Allowed |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 131.7103 | 131.7103 | Allowed-with-Review |
