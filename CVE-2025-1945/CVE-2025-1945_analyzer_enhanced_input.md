## Vulnerability Description
picklescan before 0.0.23 fails to detect malicious pickle files inside PyTorch model archives when certain **ZIP file flag bits are modified**. By flipping specific bits in the ZIP file headers, an attacker can embed malicious pickle files that remain undetected by PickleScan while still being successfully loaded by PyTorchs torch.load(). This can lead to arbitrary code execution when loading a compromised model.

### Vulnerability Description Key Phrases
- **vector:** malicious pickle files
- **weakness:** **ZIP file flag bits are modified**
- **product:** PyTorch model
- **impact:** arbitrary code execution, remote code execution
- **attacker:** attacker

## CVE Reference Links Content Summary
Here's an analysis of the provided content related to CVE-2025-1945:

**github.com_64a72211_20250624_211301.html:**

*   **Relates to CVE-2025-1945:** YES
*   **Extraction:**
    *   **Root cause of vulnerability:** PickleScan fails to properly handle modified ZIP file flag bits, allowing malicious pickle files to bypass detection.
    *   **Weaknesses/vulnerabilities present:** CWE-345 (Improperly Implemented Security Check for Standard)
    *   **Impact of exploitation:** Arbitrary code execution when a compromised PyTorch model is loaded. Specifically, attackers can embed malicious pickle payloads inside PyTorch models that evade PickleScan's detection but still execute upon loading.
    *   **Attack vectors:** Machine learning supply chain attacks, distributing backdoored models on platforms like Hugging Face or PyTorch Hub.
    *   **Required attacker capabilities/position:** Modify the flag\_bits field in the ZIP file entry and embed a malicious pickle file in a PyTorch model archive.
    *   **Mitigation or fix:**
        *   PickleScan should use a more relaxed ZIP parser.
        *   Scan all embedded files regardless of flags.
*   **More detail than CVE description:** YES. It includes a Proof of Concept (PoC) code and detailed CVSS information.

**github.com_d0226768_20250624_200751.html:**

*   **Relates to CVE-2025-1945:** YES
*   **Extraction:**
    *   **Root cause of vulnerability:** PickleScan fails to properly handle modified ZIP file flag bits, allowing malicious pickle files to bypass detection.
    *   **Weaknesses/vulnerabilities present:** CWE-345 (Improperly Implemented Security Check for Standard)
    *   **Impact of exploitation:** Arbitrary code execution when a compromised PyTorch model is loaded. Specifically, attackers can embed malicious pickle payloads inside PyTorch models that evade PickleScan's detection but still execute upon loading.
    *   **Attack vectors:** Machine learning supply chain attacks, distributing backdoored models on platforms like Hugging Face or PyTorch Hub.
    *   **Required attacker capabilities/position:** Modify the flag\_bits field in the ZIP file entry and embed a malicious pickle file in a PyTorch model archive.
    *   **Mitigation or fix:**
        *   PickleScan should use a more relaxed ZIP parser.
        *   Scan all embedded files regardless of flags.
    *   Provides a link to the commit that fixes the vulnerability.

**github.com_efb4ac35_20250624_200752.html:**

*   **Relates to CVE-2025-1945:** YES
*   **Extraction:**
    *   **Root cause of vulnerability:** PickleScan fails to detect malicious pickle files inside PyTorch model archives when certain ZIP file flag bits are modified.
    *   **Weaknesses/vulnerabilities present:** CWE-345 (Improperly Implemented Security Check for Standard)
    *   **Impact of exploitation:** Arbitrary code execution when a compromised PyTorch model is loaded.
    *   **Attack vectors:** Exploited in machine learning supply chain attacks.
    *   **Required attacker capabilities/position:** Modifying ZIP file headers to include malicious pickle files.
    *   **Mitigation or fix:**
        *   Improve ZIP Handling: PickleScan should use a more relaxed ZIP parser.
        *   Scan all embedded files regardless of flags.

*   **More detail than CVE description:** YES. Includes PoC and detailed CVSS information.

**sites.google.com_8015f64d_20250624_200753.html:**

*   **Relates to CVE-2025-1945:** YES
*   **Extraction:**
    *   **Root cause of vulnerability:** PickleScan fails to detect malicious pickle files inside PyTorch model archives when certain ZIP file flag bits are modified.
    *   **Weaknesses/vulnerabilities present:** CWE-358: Improperly Implemented Security Check for Standard
    *   **Impact of exploitation:** Attackers can embed malicious pickle payloads inside PyTorch models that evade PickleScan's detection but still execute upon loading.
    *   **Attack vectors:** This vulnerability could be exploited in machine learning supply chain attacks.
    *   **Required attacker capabilities/position:** The attacker modifies the flag\_bits field in the ZIP file entry and embeds a malicious pickle file.
    *   **Mitigation or fix:**
        *   Improve ZIP Handling: PickleScan should use a more relaxed ZIP parser.
        *   Scan All Embedded Files Regardless of Flags: Ensure that files with altered metadata are still extracted and analyzed.
    *   Provides a link to the fixed version of the software.
*   **More detail than CVE description:** YES. It includes a Proof of Concept (PoC) code, CVSS scores, and mitigation advice.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.328 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.300 |
| 3 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.285 |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.282 |
| 5 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | sparse | 0.278 |
| 6 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.270 |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.259 |
| 8 | 649 | Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking | Base | Allowed | sparse | 0.255 |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | dense | 0.417 |
| 10 | 363 | Race Condition Enabling Link Following | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-23: Relative Path Traversal

CWE-502: Deserialization of Untrusted Data

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-409: Improper Handling of Highly Compressed Data (Data Amplification)

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-649: Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-363: Race Condition Enabling Link Following