# Raw Retriever Results for CVE-2024-45041

# Raw Retriever Results for CVE-2024-45041
## Query
External Secrets Operator is a Kubernetes operator that integrates external secret management systems. The external-secrets has a deployment called default-external-secrets-cert-controller, which is bound with a same-name ClusterRole. This ClusterRole has get/list verbs of secrets resources. It also has path/update verb of validatingwebhookconfigurations resources. This can be used to abuse the SA token of the deployment to retrieve or get ALL secrets in the whole cluster, capture and log all data from requests attempting to update Secrets, or make a webhook deny all Pod create and update requests. This vulnerability is fixed in 0.10.2.

## Keyphrases
- **weakness**: 'ClusterRole has get', 'list verbs of secrets resources'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3913 | 0.4782 | 0.4188 | 0.4185 | 20 |
| Sparse | 483.8459 | 604.4061 | 516.1030 | 508.1604 | 10 |
| Graph | 1.6100 | 2.7196 | 1.9590 | 1.9040 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 2.7196 | Allowed |
| 2 | 23 | Relative Path Traversal | base | 2.3998 | Allowed |
| 3 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | base | 2.2100 | Allowed |
| 5 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 6 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 2.2100 | Allowed |
| 7 | 425 | Direct Request ('Forced Browsing') | base | 2.2090 | Allowed |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 9 | 306 | Missing Authentication for Critical Function | base | 2.1190 | Allowed |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 11 | 94 | Improper Control of Generation of Code ('Code Injection') | base | 1.7680 | Allowed-with-Review |
| 12 | 15 | External Control of System or Configuration Setting | Base | 1.6924 | Allowed |
| 13 | 183 | Permissive List of Allowed Inputs | base | 1.6848 | Allowed |
| 14 | 363 | Race Condition Enabling Link Following | base | 1.6848 | Allowed |
| 15 | 184 | Incomplete List of Disallowed Inputs | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 15 | External Control of System or Configuration Setting | Base | 0.4782 | 0.4782 | Allowed |
| 2 | 642 | External Control of Critical State Data | Class | 0.4587 | 0.4587 | Allowed-with-Review |
| 3 | 73 | External Control of File Name or Path | Base | 0.4456 | 0.4456 | Allowed |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | 0.4334 | 0.4334 | Allowed |
| 5 | 552 | Files or Directories Accessible to External Parties | Base | 0.4319 | 0.4319 | Allowed |
| 6 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.4315 | 0.4315 | Allowed |
| 7 | 529 | Exposure of Access Control List Files to an Unauthorized Control Sphere | Variant | 0.4313 | 0.4313 | Allowed |
| 8 | 749 | Exposed Dangerous Method or Function | Base | 0.4297 | 0.4297 | Allowed |
| 9 | 656 | Reliance on Security Through Obscurity | Class | 0.4287 | 0.4287 | Allowed-with-Review |
| 10 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | 0.4267 | 0.4267 | Allowed |
| 11 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.4102 | 0.4102 | Allowed |
| 12 | 610 | Externally Controlled Reference to a Resource in Another Sphere | Class | 0.4023 | 0.4023 | Discouraged |
| 13 | 267 | Privilege Defined With Unsafe Actions | Base | 0.4013 | 0.4013 | Allowed |
| 14 | 668 | Exposure of Resource to Wrong Sphere | Class | 0.4003 | 0.4003 | Discouraged |
| 15 | 497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | Base | 0.3979 | 0.3979 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | 604.4061 | 604.4061 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | 537.0760 | 537.0760 | Allowed |
| 3 | 863 | Incorrect Authorization | 532.5969 | 532.5969 | Allowed-with-Review |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | 524.3862 | 524.3862 | Allowed |
| 5 | 23 | Relative Path Traversal | 509.9036 | 509.9036 | Allowed |
| 6 | 214 | Invocation of Process Using Visible Sensitive Information | 506.4172 | 506.4172 | Allowed |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | 488.0177 | 488.0177 | Allowed |
| 8 | 285 | Improper Authorization | 487.4152 | 487.4152 | Discouraged |
| 9 | 668 | Exposure of Resource to Wrong Sphere | 486.9648 | 486.9648 | Discouraged |
| 10 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 483.8459 | 483.8459 | Allowed |
