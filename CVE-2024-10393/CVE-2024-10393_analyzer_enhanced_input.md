## Vulnerability Description
The Tutor LMS plugin for WordPress is vulnerable to bypass to user registration in versions up to, and including, 2.7.6. This is due to a missing check for the users_can_register option in the register_instructor function. This makes it possible for unauthenticated attackers to register as the default role on the site, even if registration is disabled.

### Vulnerability Description Key Phrases
- **rootcause:** **missing check for users_can_register option**
- **impact:** register as the default role on the site
- **attacker:** unauthenticated attackers
- **product:** Tutor LMS plugin for WordPress
- **version:** up to and including 2.7.6
- **component:** register_instructor function

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-10393:

**Root cause of vulnerability:**
- The vulnerability stems from a missing check for the 'users\_can\_register' option within the `register_instructor` function of the Tutor LMS plugin.

**Weaknesses/vulnerabilities present:**
- **Improper Access Control:** The plugin fails to properly verify if user registration is enabled on the WordPress site before allowing a registration request.

**Impact of exploitation:**
- **Unauthorized User Registration:** Unauthenticated attackers can register as the default user role on the site, even when registration is disabled in WordPress settings. This could allow attackers to gain a foothold on the site and potentially cause further harm, depending on the permissions of the default role.

**Attack vectors:**
- **Network:** The attack vector is over the network (AV:N).
- The vulnerability is triggered via a request to the `tutor_register_instructor` action

**Required attacker capabilities/position:**
- **Unauthenticated:** The attacker does not need any prior authentication or access to the WordPress site (PR:N).
- The attacker does not require user interaction (UI:N)

**Additional details:**

- The vulnerability is present in Tutor LMS versions up to and including 2.7.6.
- The vulnerability was fixed in version 2.7.7 by adding a check for `get_option( 'users_can_register', false )` before allowing registration.
- The Wordfence vulnerability database entry provides a CVSS score of 5.3 (Medium).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.449 |
| 2 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | sparse | 0.435 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.433 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.428 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.421 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.392 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.392 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.390 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.416 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-862: Missing Authorization

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-306: Missing Authentication for Critical Function

CWE-863: Incorrect Authorization

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-285: Improper Authorization

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-471: Modification of Assumed-Immutable Data (MAID)