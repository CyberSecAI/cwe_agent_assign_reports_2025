# Raw Retriever Results for CVE-2024-53859

# Raw Retriever Results for CVE-2024-53859
## Query
go-gh is a Go module for interacting with the `gh` utility and the GitHub API from the command line. A security vulnerability has been identified in `go-gh` that could leak authentication tokens intended for GitHub hosts to non-GitHub hosts when within a codespace. `go-gh` sources authentication tokens from different environment variables depending on the host involved 1. `GITHUB_TOKEN`, `GH_TOKEN` for GitHub.com and ghe.com and 2. `GITHUB_ENTERPRISE_TOKEN`, `GH_ENTERPRISE_TOKEN` for GitHub Enterprise Server. Prior to version `2.11.1`, `auth.TokenForHost` could source a token from the `GITHUB_TOKEN` environment variable for a host other than GitHub.com or ghe.com when within a codespace. In version `2.11.1`, `auth.TokenForHost` will only source a token from the `GITHUB_TOKEN` environment variable for GitHub.com or ghe.com hosts. Successful exploitation could send authentication token to an unintended host. This issue has been addressed in version 2.11.1 and all users are advised to upgrade. Users are also advised to regenerate authentication tokens and to review their personal security log and any relevant audit logs for actions associated with their account or enterprise.

## Keyphrases
- **rootcause**: 'go-gh could leak authentication tokens intended for GitHub hosts to non-GitHub hosts when within a codespace'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3944 | 0.4695 | 0.4268 | 0.4227 | 20 |
| Sparse | 290.1542 | 1183.3453 | 940.7367 | 984.1430 | 11 |
| Graph | 1.0062 | 2.8652 | 1.5447 | 1.4248 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.8652 | Allowed |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 2.7797 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 2.7703 | Allowed |
| 4 | 202 | Exposure of Sensitive Information Through Data Queries | base | 2.0452 | Allowed |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6610 | Allowed |
| 6 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.5210 | Allowed |
| 7 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | base | 1.4602 | Allowed |
| 8 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 1.4597 | Allowed |
| 9 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 1.4542 | Allowed |
| 10 | 918 | Server-Side Request Forgery (SSRF) | Base | 1.4457 | Allowed |
| 11 | 526 | Cleartext Storage of Sensitive Information in an Environment Variable | variant | 1.4040 | Allowed |
| 12 | 244 | Improper Clearing of Heap Memory Before Release ('Heap Inspection') | variant | 1.3747 | Allowed |
| 13 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.2864 | Allowed |
| 14 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.1466 | Allowed |
| 15 | 209 | Generation of Error Message Containing Sensitive Information | Base | 1.0832 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 863 | Incorrect Authorization | Class | 0.4695 | 0.4695 | Allowed-with-Review |
| 2 | 285 | Improper Authorization | Class | 0.4664 | 0.4664 | Discouraged |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.4652 | 0.4652 | Allowed |
| 4 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.4531 | 0.4531 | Allowed |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 0.4494 | 0.4494 | Allowed |
| 6 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.4485 | 0.4485 | Allowed |
| 7 | 522 | Insufficiently Protected Credentials | Class | 0.4458 | 0.4458 | Allowed-with-Review |
| 8 | 287 | Improper Authentication | Class | 0.4449 | 0.4449 | Discouraged |
| 9 | 306 | Missing Authentication for Critical Function | Base | 0.4407 | 0.4407 | Allowed |
| 10 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4382 | 0.4382 | Allowed |
| 11 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.4072 | 0.4072 | Allowed |
| 12 | 862 | Missing Authorization | Class | 0.4050 | 0.4050 | Allowed-with-Review |
| 13 | 1390 | Weak Authentication | Class | 0.4039 | 0.4039 | Allowed-with-Review |
| 14 | 347 | Improper Verification of Cryptographic Signature | Base | 0.4031 | 0.4031 | Allowed |
| 15 | 290 | Authentication Bypass by Spoofing | Base | 0.4016 | 0.4016 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 214 | Invocation of Process Using Visible Sensitive Information | 1183.3453 | 1183.3453 | Allowed |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | 1132.3892 | 1132.3892 | Allowed |
| 3 | 863 | Incorrect Authorization | 999.6554 | 999.6554 | Allowed-with-Review |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | 989.4112 | 989.4112 | Allowed |
| 5 | 918 | Server-Side Request Forgery (SSRF) | 984.3340 | 984.3340 | Allowed |
| 6 | 285 | Improper Authorization | 984.1430 | 984.1430 | Discouraged |
| 7 | 23 | Relative Path Traversal | 951.0861 | 951.0861 | Allowed |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | 946.4928 | 946.4928 | Allowed |
| 9 | 287 | Improper Authentication | 945.9536 | 945.9536 | Discouraged |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | 941.1391 | 941.1391 | Allowed |
| 11 | 191 | Integer Underflow (Wrap or Wraparound) | 290.1542 | 290.1542 | Allowed |
