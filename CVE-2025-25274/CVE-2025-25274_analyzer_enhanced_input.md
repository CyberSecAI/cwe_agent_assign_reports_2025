## Vulnerability Description
Mattermost versions 10.4.x <= 10.4.2, 10.3.x <= 10.3.3, 9.11.x <= 9.11.8 **fail to restrict command execution** in archived channels, which allows authenticated users to run commands in archived channels.

### Vulnerability Description Key Phrases
- **rootcause:** **fail to restrict command execution**
- **impact:** run commands in archived channels
- **attacker:** authenticated users
- **product:** Mattermost
- **version:** 10.4.x <= 10.4.2 and 10.3.x <= 10.3.3 and 9.11.x <= 9.11.8

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.235 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.232 |
| 3 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.226 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.218 |
| 5 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.216 |
| 6 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | Allowed-with-Review | sparse | 0.213 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.213 |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.210 |
| 9 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | dense | 0.499 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-863: Incorrect Authorization

CWE-269: Improper Privilege Management

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-20: Improper Input Validation

CWE-754: Improper Check for Unusual or Exceptional Conditions

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-73: External Control of File Name or Path