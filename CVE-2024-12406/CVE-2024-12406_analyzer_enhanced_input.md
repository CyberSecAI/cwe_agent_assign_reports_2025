## Vulnerability Description
The Library Management System Manage e-Digital Books Library plugin for WordPress is vulnerable to SQL Injection via the owt7_borrow_books_id parameter in all versions up to, and including, 3.0.0 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Subscriber-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers
- **product:** Library Management System Manage e-Digital Books Library WordPress plugin
- **version:** up to and including 3.0.0
- **component:** owt7_borrow_books_id parameter

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-12406:

**1. Verification:**
   - The provided Wordfence content explicitly mentions **CVE-2024-12406** and describes a SQL Injection vulnerability in the "Library Management System" WordPress plugin, matching the CVE ID. Therefore the content is relevant.

**2. Root Cause of Vulnerability:**
   - The vulnerability stems from insufficient sanitization of user-supplied input (`owt7_borrow_books_id` parameter) combined with a lack of proper preparation of the SQL query.

**3. Weaknesses/Vulnerabilities Present:**
    - **SQL Injection:** The plugin directly incorporates user-supplied data into a SQL query without proper sanitization or parameterization.

**4. Impact of Exploitation:**
   - **Information Disclosure:** Attackers can inject malicious SQL code, potentially extracting sensitive information from the database.

**5. Attack Vectors:**
    - **HTTP Request:** The vulnerability is exploited via a specially crafted HTTP request targeting the vulnerable parameter (`owt7_borrow_books_id`).

**6. Required Attacker Capabilities/Position:**
    - **Authenticated User:** The attacker needs to be an authenticated user with at least "Subscriber" level privileges.
    - **Network Access:** The attacker must have network access to the WordPress site to send malicious requests.

**Additional Notes**
   - The provided code snippet from the plugin's `class-library-management-system-admin.php` file includes a section (lines 1874-1945) that handles the "owt7_lms_return_book" action. This section seems to be the vulnerable location, as it uses the `$_REQUEST['owt7_borrow_books_id']` parameter. This parameter is used in line 1881 for a select statement, which can be manipulated using the sql injection. The code snippet provides additional context which supports the information given by Wordfence.
   - The Wordfence article states that there is no patch available for the plugin, and recommends mitigating the risk by uninstalling the plugin.

This analysis provides more detail than a standard CVE description, including the vulnerable parameter, user role requirements, and a link to the affected source code line.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.563 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.533 |
| 4 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.513 |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.502 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.500 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.496 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.495 |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | dense | 0.495 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-502: Deserialization of Untrusted Data

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-862: Missing Authorization

CWE-863: Incorrect Authorization

CWE-138: Improper Neutralization of Special Elements

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-471: Modification of Assumed-Immutable Data (MAID)