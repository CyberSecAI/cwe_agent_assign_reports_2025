# Vulnerability Information: CVE-2025-37920

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved xsk Fix **race condition** in AF_XDP generic RX path Move rx_lock from xsk_socket to xsk_buff_pool. Fix synchronization for shared umem mode in generic RX path where multiple sockets share single xsk_buff_pool. RX queue is exclusive to xsk_socket, while FILL queue can be shared between multiple sockets. This could result in **race condition** where two CPU cores access RX path of two different sockets sharing the same umem. Protect both queues by acquiring spinlock in shared xsk_buff_pool. Lock contention may be minimized in the future by some per-thread FQ buffering. Its safe and necessary to move spin_lock_bh(rx_lock) after xsk_rcv_check() * xs->pool and spinlock_init is synchronized by xsk_bind() -> xsk_is_bound() memory barriers. * xsk_rcv_check() may return true at the moment of xsk_release() or xsk_unbind_dev(), however this will not cause any data races or **race condition**s. xsk_unbind_dev() removes xdp socket from all maps and waits for completion of all outstanding rx operations. Packets in RX path will either complete safely or drop.

### Vulnerability Description Key Phrases
- **rootcause:** **race condition**
- **product:** Linux kernel
- **component:** AF_XDP generic RX path

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 662 | Improper Synchronization | Class | Discouraged | sparse | 0.840 |
| 3 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.717 |
| 4 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.707 |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.699 |
| 6 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.667 |
| 7 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.605 |
| 8 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.603 |
| 9 | 366 | Race Condition within a Thread | Base | Allowed | dense | 0.489 |
| 10 | 609 | Double-Checked Locking | Base | Allowed | graph | 0.003 |

