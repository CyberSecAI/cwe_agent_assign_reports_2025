# Vulnerability Information: CVE-2025-48708

## Vulnerability Description
gs_lib_ctx_stash_sanitized_arg in base/gslibctx.c in Artifex Ghostscript before 10.05.1 **lacks argument sanitization for the # case**. A created PDF document includes its password in cleartext.

### Vulnerability Description Key Phrases
- **rootcause:** **lacks argument sanitization for the # case**
- **impact:** created PDF document includes its password in cleartext
- **product:** Artifex Ghostscript
- **version:** before 10.05.1
- **component:** gs_lib_ctx_stash_sanitized_arg in base/gslibctx.c

## CVE Reference Links Content Summary
## Analysis of CVE-2025-48708 Content

Here's an analysis of the provided content, focusing on information relevant to CVE-2025-48708, following the specified guidelines:

**1. Verification:**

The content directly relates to CVE-2025-48708. The email explicitly references the CVE ID and links to the CVE record on cve.org. The bug report and commit link further confirm the relevance.

**2. Extracted Information:**

*   **Root cause of vulnerability:**
    The vulnerability stems from a lack of proper argument sanitization in the `gs_lib_ctx_stash_sanitized_arg` function within `base/gslibctx.c`. Specifically, the code incorrectly handles the '#' character when parsing command-line arguments, leading to the inclusion of the entire command line (including the password) in the generated PDF.

*   **Weaknesses/vulnerabilities present:**
    *   Insufficient input validation/sanitization.
    *   Exposure of sensitive information (plaintext password) in output files.

*   **Impact of exploitation:**
    An attacker with access to the generated PDF file can easily retrieve the plaintext password used for encryption by simply using standard command-line tools like `type` (Windows) or `cat` (Linux/macOS). This compromises the security of the PDF.

*   **Attack vectors:**
    The attack vector is straightforward: an attacker simply needs access to a PDF file generated by a vulnerable version of Ghostscript with a password set.

*   **Required attacker capabilities/position:**
    The attacker requires only access to the generated PDF file. No special privileges or advanced technical skills are needed.

*   **Mitigation or fix:**
    The vulnerability is fixed in Ghostscript version 10.05.1. The fix involves correctly handling the '#' character during argument parsing. The commit link provided points to the specific code change: <https://cgit.ghostscript.com/cgi-bin/cgit.cgi/ghostpdl.git/commit/?h=gs10.05.1&id=5b5968c306b3e35cdeec83bb15026fd74a7334de>

**3. Additional Notes:**

*   The provided content offers more detail than the official CVE description. It includes the specific function involved, the root cause explanation, and a link to the commit that fixes the issue.
*   The email from Alan Coopersmith provides a concise summary of the vulnerability and its fix, making it a valuable resource.
*   The bug report details the steps to reproduce the issue.
*   The cgit link shows the code diff for the fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.163 |
| 2 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.160 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.160 |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.154 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.154 |
| 6 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.151 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.150 |
| 8 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.150 |
| 9 | 316 | Cleartext Storage of Sensitive Information in Memory | Variant | Allowed | dense | 0.469 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

