# Vulnerability Information: CVE-2024-6391

## Vulnerability Description
The oik plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugins bw_button shortcode in all versions up to, and including, 4.10.3 due to **insufficient input sanitization and output escaping on user supplied attributes**. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping on user supplied attributes**
- **weakness:** **cross-site scripting**
- **impact:** arbitrary web script injection and inject arbitrary web scripts
- **attacker:** authenticated attackers
- **product:** oik plugin for WordPress
- **version:** up to and including 4.10.3
- **component:** bw_button shortcode

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-79

#### Top CWEs
- CWE-79 (Count: 89)

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The oik plugin for WordPress is vulnerable to Stored Cross-Site Scripting due to insufficient input sanitization and output escaping on user supplied attributes in the `bw_button` shortcode.",
    "weaknesses": [
      "Stored Cross-Site Scripting",
      "Insufficient input sanitization",
      "Insufficient output escaping"
     ],
    "impact": "Authenticated attackers with contributor-level access and above, can inject arbitrary web scripts in pages. These scripts will execute whenever a user accesses an injected page.",
    "attack_vectors": [
      "The `bw_button` shortcode is vulnerable to XSS injection via user-supplied attributes",
      "Injected through a post/page and triggered upon page view"
     ],
    "required_attacker_capabilities": [
      "Authenticated user with contributor-level access or above"
    ]
  },
    "affected_versions": "<= 4.10.3",
    "patched_versions": "4.12.0"
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.554 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.528 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.485 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.470 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.413 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.407 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.395 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.392 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.522 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

