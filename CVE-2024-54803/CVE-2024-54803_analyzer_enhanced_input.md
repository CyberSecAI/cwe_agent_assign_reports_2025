## Vulnerability Description
Netgear WNR854T 1.5.2 (North America) is vulnerable to Command Injection. An attacker can send a specially crafted request to post.cgi, updating the nvram parameter pppoe_peer_mac and forcing a reboot. This will result in **command injection**.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **vector:** specially crafted request
- **attacker:** attacker
- **product:** Netgear WNR854T
- **version:** 1.5.2
- **component:** post.cgi

## CVE Reference Links Content Summary
CVE-2024-54803

**Root cause of vulnerability:**
The vulnerability is a command injection in the router’s PPPoE configuration, specifically within the `sysinit` binary. It occurs because the `pppoe_peer_mac` NVRAM parameter is processed without proper sanitization. The `sprintf` function incorporates this value into a system call without validating its content.

**Weaknesses/vulnerabilities present:**
- Command Injection
- Insufficient Input Validation
- Improper Sanitization

**Impact of exploitation:**
Successful exploitation allows authenticated attackers to execute arbitrary system commands with root privileges. The injected commands persist across device reboots as they are stored in NVRAM, providing permanent access until manually remediated. This can lead to complete compromise of the router.

**Attack vectors:**
- Attacker must be authenticated to the router’s administrative interface.
- Modify the PPPoE peer MAC setting via the web administration interface.
- Send a specially crafted HTTP POST request to the router’s `/post.cgi` endpoint.

**Required attacker capabilities/position:**
- Authentication to the router’s administrative interface.
- Knowledge of the vulnerable parameter (`pppoe_peer_mac`).
- Ability to craft a malicious payload containing shell metacharacters.

**Mitigation or fix:**
The content does not specify a fix, but implies that proper input validation and sanitization of the `pppoe_peer_mac` parameter are necessary to prevent the vulnerability.

**Additional Details:**
The content provides more detail than the official CVE description, detailing the specific function (`sysinit`) and address (`0x0000d0f4`) where the vulnerability occurs, as well as the specific `sprintf` call involved. It also provides a sample exploit payload. The vulnerability is boot persistent due to storage in NVRAM.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.252 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.245 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.236 |
| 6 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.235 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.233 |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.228 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.565 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-1287: Improper Validation of Specified Type of Input

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-790: Improper Filtering of Special Elements

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs