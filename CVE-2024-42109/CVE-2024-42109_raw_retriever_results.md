# Raw Retriever Results for CVE-2024-42109

# Raw Retriever Results for CVE-2024-42109
## Query
In the Linux kernel, the following vulnerability has been resolved netfilter nf_tables unconditionally flush pending work before notifier syzbot reports KASAN slab-uaf in nft_ctx_update include/net/netfilter/nf_tables.h1831 KASAN slab-uaf in nft_commit_release net/netfilter/nf_tables_api.c9530 KASAN slab-uaf int nf_tables_trans_destroy_work+0x152b/0x1750 net/netfilter/nf_tables_api.c9597 Read of size 2 at addr ffff88802b0051c4 by task kworker/11/45 [..] Workqueue events nf_tables_trans_destroy_work Call Trace nft_ctx_update include/net/netfilter/nf_tables.h1831 [inline] nft_commit_release net/netfilter/nf_tables_api.c9530 [inline] nf_tables_trans_destroy_work+0x152b/0x1750 net/netfilter/nf_tables_api.c9597 Problem is that the notifier does a conditional flush, but its possible that the table-to-be-removed is still referenced by transactions being processed by the worker, so we need to flush unconditionally. We could make the flush_work depend on whether we found a table to delete in nf-next to avoid the flush for most cases. AFAICS this problem is only exposed in nf-next, with commit e169285f8c56 (netfilter nf_tables do not store nft_ctx in transaction objects), with this commit applied there is an unconditional fetch of table->family which is whats triggering the above splat.

## Keyphrases
- **weakness**: 'KASAN slab-uaf'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4530 | 0.5253 | 0.4801 | 0.4751 | 20 |
| Sparse | 590.3233 | 848.5860 | 646.4657 | 610.1876 | 11 |
| Graph | 1.6848 | 2.8652 | 2.1143 | 2.0961 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 2 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | base | 2.8210 | Allowed |
| 3 | 123 | Write-what-where Condition | base | 2.7014 | Allowed |
| 4 | 415 | Double Free | variant | 2.6827 | Allowed |
| 5 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.3400 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 7 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 8 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 9 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |
| 10 | 416 | Use After Free | Variant | 2.1438 | Allowed |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | Base | 2.0484 | Allowed |
| 12 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.0179 | Allowed |
| 13 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.8143 | Allowed |
| 14 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 15 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5253 | 0.5253 | Allowed-with-Review |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5221 | 0.5221 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5206 | 0.5206 | Allowed-with-Review |
| 4 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5080 | 0.5080 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4986 | 0.4986 | Allowed |
| 6 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4968 | 0.4968 | Allowed |
| 7 | 833 | Deadlock | Base | 0.4927 | 0.4927 | Allowed |
| 8 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4901 | 0.4901 | Allowed |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4895 | 0.4895 | Allowed |
| 10 | 667 | Improper Locking | Class | 0.4875 | 0.4875 | Allowed-with-Review |
| 11 | 908 | Use of Uninitialized Resource | Base | 0.4627 | 0.4627 | Allowed |
| 12 | 252 | Unchecked Return Value | Base | 0.4603 | 0.4603 | Allowed |
| 13 | 617 | Reachable Assertion | Base | 0.4602 | 0.4602 | Allowed |
| 14 | 476 | NULL Pointer Dereference | Base | 0.4576 | 0.4576 | Allowed |
| 15 | 416 | Use After Free | Variant | 0.4573 | 0.4573 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 909 | Missing Initialization of Resource | 848.5860 | 848.5860 | Allowed-with-Review |
| 2 | 416 | Use After Free | 800.0000 | 800.0000 | Allowed |
| 3 | 675 | Multiple Operations on Resource in Single-Operation Context | 644.8181 | 644.8181 | Allowed-with-Review |
| 4 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | 614.3267 | 614.3267 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 612.3627 | 612.3627 | Allowed-with-Review |
| 6 | 667 | Improper Locking | 610.1876 | 610.1876 | Allowed-with-Review |
| 7 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 607.0824 | 607.0824 | Discouraged |
| 8 | 502 | Deserialization of Untrusted Data | 598.1292 | 598.1292 | Allowed |
| 9 | 674 | Uncontrolled Recursion | 593.9367 | 593.9367 | Allowed-with-Review |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | 591.3695 | 591.3695 | Allowed |
| 11 | 125 | Out-of-bounds Read | 590.3233 | 590.3233 | Allowed |
