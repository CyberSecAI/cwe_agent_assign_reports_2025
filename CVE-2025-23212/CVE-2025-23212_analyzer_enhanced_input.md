## Vulnerability Description
Tandoor Recipes is an application for managing recipes, planning meals, and building shopping lists. The external storage feature allows any user to enumerate the name and content of files on the server. This vulnerability is fixed in 1.5.28.

### Vulnerability Description Key Phrases
- **impact:** enumerate the name and content of files
- **attacker:** any user
- **product:** Tandoor Recipes
- **component:** external storage feature

## CVE Reference Links Content Summary
CVE-2025-23212 - Local file disclosure - Users can read the content of any file on the server

**Root cause of vulnerability:**

The external storage feature allows any user to enumerate the name and content of files on the server.

**Weaknesses/vulnerabilities present:**

*   Local File Disclosure

**Impact of exploitation:**

*   Enumeration of all uploaded files, even those from other users/spaces.
*   Ability to view/download files, including potentially sensitive system files like `/etc/passwd` or `/root/.ash_history`.

**Attack vectors:**

*   Creating a new storage backend.
*   Using the API endpoint `/api/get_recipe_file/[ID]` to access file content.
*   Enumerating files in directories like `/etc` and accessing their content.

**Required attacker capabilities/position:**

*   A regular user with access to the application.

**Mitigation or fix:**

*   Restrict local external recipes to superusers.
*   Restrict file path/type. (Commit 36e83a9d0108ac56b9538b45ead57efc8b97c5ff implements this by only allowing PDF, PNG, JPG, JPEG, and GIF files to be imported and restricting access to certain directories like `/etc/`, `/root/`, `/mediafiles/`, and `/usr/`.)
*   Require superuser privileges to edit storage configurations.

**Additional details:**

The provided content includes a commit that addresses the vulnerability by restricting access to sensitive directories and file types. The vulnerability allows unauthorized access to files on the server, potentially exposing sensitive information. The CVSS score is 7.7 (High).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.072 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.070 |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.070 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.068 |
| 5 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | sparse | 0.068 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.068 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.068 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.067 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.379 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-532: Insertion of Sensitive Information into Log File

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-863: Incorrect Authorization

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-138: Improper Neutralization of Special Elements

CWE-116: Improper Encoding or Escaping of Output

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-184: Incomplete List of Disallowed Inputs