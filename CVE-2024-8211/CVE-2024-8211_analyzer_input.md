# Vulnerability Information: CVE-2024-8211

## Vulnerability Description
A vulnerability was found in D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04 up to 20240814. It has been declared as critical. This vulnerability affects the function cgi_FMT_Std2R1_DiskMGR of the file /cgi-bin/hd_config.cgi. The manipulation of the argument f_newly_dev leads to **command injection**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. NOTE This vulnerability only affects products that are no longer supported by the maintainer. NOTE Vendor was contacted early and confirmed that the product is end-of-life. It should be retired and replaced.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** D-Link DNS-120 and DNR-202L and DNS-315L and DNS-320 and DNS-320L and DNS-320LW and DNS-321 and DNR-322L and DNS-323 and DNS-325 and DNS-326 and DNS-327L and DNR-326 and DNS-340L and DNS-343 and DNS-345 and DNS-726-4 and DNS-1100-4 and DNS-1200-05 and DNS-1550-04
- **version:** up to 20240814
- **component:** /cgi-bin/hd_config.cgi

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-78

#### Top CWEs
- CWE-78 (Count: 23)
- CWE-77 (Count: 3)

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**CVE ID:** CVE-2024-8211 (Note: Although this CVE is not mentioned explicitly, a command injection vulnerability with similar characteristics is described in the provided content.)

**Root Cause of Vulnerability:**

*   The vulnerability is a command injection flaw in the `cgi_FMT_Std2R1_DiskMGR` function of the `/cgi-bin/hd_config.cgi` file on D-Link DNS NAS devices.
*   The `f_newly_dev` variable, received from a POST request, is used to construct a command via the `sprintf` function without proper sanitization. This allows an attacker to inject arbitrary commands into the system call.

**Weaknesses/Vulnerabilities Present:**

*   **Command Injection:** The primary weakness is the lack of input sanitization on the `f_newly_dev` variable before it's used in a system command. This allows for arbitrary command execution via the `system` call.

**Impact of Exploitation:**

*   **Arbitrary Command Execution:** A successful exploit allows an attacker to execute arbitrary commands on the affected device. This can lead to:
    *   Complete system compromise.
    *   Data theft or modification.
    *   Installation of malware.
    *   Denial of service.

**Attack Vectors:**

*   **HTTP POST Request:** The attack vector is a crafted HTTP POST request targeting `/cgi-bin/hd_config.cgi`, where the attacker manipulates the `f_newly_dev` parameter.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the vulnerable D-Link NAS device.
*   **Knowledge of Vulnerable Endpoint:**  The attacker needs to know the vulnerable URL `/cgi-bin/hd_config.cgi` and the `f_newly_dev` parameter.
*   **Ability to Send HTTP Requests:** The attacker must be able to send crafted POST requests to the device.

**Additional Notes:**

*   **Affected Devices:** The vulnerability affects multiple D-Link NAS devices including DNS-320, DNS-320L, DNS-321, DNS-323, DNS-325, and DNS-327L. All firmware versions are likely vulnerable.
*   **End of Life:** D-Link has marked these devices as End of Life (EOL) / End of Service Life (EOS). They will not receive any security updates for this vulnerability.
*   **Mitigation:** The primary recommendation from D-Link is to retire and replace the affected devices. There are no official patches available from the vendor.
*   **Vendor Awareness:** D-Link is aware of the vulnerability based on reports from VulDB and other sources as referenced in their security advisory.
*   **CVE Overlap:** This vulnerability appears to be related to CVE-2024-3272 and CVE-2024-3273.

In summary, this is a critical command injection vulnerability in older D-Link NAS devices that allows remote attackers to execute arbitrary code, with no patch available, making device replacement the only viable mitigation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.720 |
| 4 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.678 |
| 5 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.665 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.655 |
| 7 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | Variant | Allowed | sparse | 0.647 |
| 8 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.638 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.649 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |

