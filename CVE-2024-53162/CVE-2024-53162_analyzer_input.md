# Vulnerability Information: CVE-2024-53162

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved crypto qat/qat_4xxx - fix **off by one in uof_get_name()** The fw_objs[] array has num_objs elements so the > needs to be >= to prevent an **out of bounds read**.

### Vulnerability Description Key Phrases
- **rootcause:** **off by one in uof_get_name()**
- **weakness:** **out of bounds read**
- **product:** Linux kernel
- **component:** crypto qat/qat_4xxx

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

*   The vulnerability is caused by an off-by-one error in the `uof_get_name()` function within the Intel QAT (Quick Assist Technology) driver for the 4xxx series.

**Weaknesses/Vulnerabilities Present:**

*   **Out-of-bounds read:** The `uof_get_name()` function accesses an array named `fw_objs[]` using an index `id`. The code incorrectly uses `id > num_objs` as a check, where `num_objs` is the number of elements in `fw_objs[]`.  This allows `id` to be equal to `num_objs`, resulting in an attempt to read beyond the end of the array if the `id` matches `num_objs`.

**Impact of Exploitation:**

*   **Potential crash or unexpected behavior:** An out-of-bounds read can lead to unpredictable behavior, potentially crashing the system, or exposing sensitive information.

**Attack Vectors:**

*   **Software Trigger:** The vulnerability is triggered through normal software operation and function calls to `uof_get_name`. An attacker would need to control or influence the `obj_num` passed to the function.

**Required Attacker Capabilities/Position:**

*   The attacker would need to be able to trigger the vulnerable code path. This would likely require the ability to interact with the QAT driver interface.

**Additional Details:**

*   The fix changes the condition from `id > num_objs` to `id >= num_objs`, which correctly prevents access beyond the allocated array.
* The code fix is in the `drivers/crypto/intel/qat/qat_4xxx/adf_4xxx_hw_data.c` file.
* The provided patches are for multiple stable branches of the Linux kernel and the changes are identical across all provided content.

The provided information gives more detail than a simple CVE description would offer by detailing the specific code and affected function as well as a specific fix for the out-of-bounds read.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.279 |
| 2 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.247 |
| 3 | 682 | Incorrect Calculation | Pillar | Discouraged | sparse | 0.239 |
| 4 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.238 |
| 5 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.227 |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.219 |
| 7 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.215 |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.214 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.600 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

