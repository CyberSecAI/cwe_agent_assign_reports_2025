# Raw Retriever Results for CVE-2024-43378

# Raw Retriever Results for CVE-2024-43378
## Query
calamares-nixos-extensions provides Calamares branding and modules for NixOS, a distribution of GNU/Linux. Users who installed NixOS through the graphical installer who used manual disk partitioning to create a setup where the system was booted via legacy BIOS rather than UEFI some disk partitions are encrypted but the partitions containing either `/` or `/boot` are unencrypted have their LUKS disk encryption key file in plain text either in `/crypto_keyfile.bin`, or in a CPIO archive attached to their NixOS initrd. `nixos-install` is not affected, nor are UEFI installations, nor was the default automatic partitioning configuration on legacy BIOS systems. The problem has been fixed in calamares-nixos-extensions 0.3.17, which was included in NixOS. The current installer images for the NixOS 24.05 and unstable (24.11) channels are unaffected. The fix reached 24.05 at 2024-08-13 200659 UTC, and unstable at 2024-08-15 090020 UTC. Installer images downloaded before those times may be vulnerable. The best solution for affected users is probably to back up their data and do a complete reinstallation. However, the mitigation procedure in GHSA-3rvf-24q2-24ww should work solely for the case where `/` is encrypted but `/boot` is not. If `/` is unencrypted, then the `/crypto_keyfile.bin` file will need to be deleted in addition to the remediation steps in the previous advisory. This issue is a partial regression of CVE-2023-36476 / GHSA-3rvf-24q2-24ww, which was more severe as it

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3956 | 0.4305 | 0.4065 | 0.4039 | 20 |
| Sparse | 319.1050 | 343.2978 | 328.2499 | 326.1915 | 10 |
| Graph | 1.5210 | 2.6784 | 1.8604 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 789 | Memory Allocation with Excessive Size Value | variant | 2.6784 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.5166 | Allowed |
| 3 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | 2.1121 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 6 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0856 | Allowed |
| 7 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.9094 | Allowed |
| 8 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 9 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 10 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 11 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 12 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 1.7475 | Allowed |
| 13 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 1.6702 | Allowed-with-Review |
| 14 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 15 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.6168 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.4305 | 0.4305 | Allowed |
| 2 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 0.4245 | 0.4245 | Allowed-with-Review |
| 3 | 277 | Insecure Inherited Permissions | Variant | 0.4208 | 0.4208 | Allowed |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 0.4187 | 0.4187 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4122 | 0.4122 | Allowed |
| 6 | 347 | Improper Verification of Cryptographic Signature | Base | 0.4096 | 0.4096 | Allowed |
| 7 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.4081 | 0.4081 | Allowed-with-Review |
| 8 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4049 | 0.4049 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4043 | 0.4043 | Allowed-with-Review |
| 10 | 862 | Missing Authorization | Class | 0.4040 | 0.4040 | Allowed-with-Review |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4039 | 0.4039 | Allowed |
| 12 | 20 | Improper Input Validation | Class | 0.4037 | 0.4037 | Discouraged |
| 13 | 284 | Improper Access Control | Pillar | 0.4033 | 0.4033 | Discouraged |
| 14 | 863 | Incorrect Authorization | Class | 0.3989 | 0.3989 | Allowed-with-Review |
| 15 | 321 | Use of Hard-coded Cryptographic Key | Variant | 0.3985 | 0.3985 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | 343.2978 | 343.2978 | Allowed |
| 2 | 522 | Insufficiently Protected Credentials | 342.7402 | 342.7402 | Allowed-with-Review |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | 331.9610 | 331.9610 | Allowed |
| 4 | 863 | Incorrect Authorization | 331.5143 | 331.5143 | Allowed-with-Review |
| 5 | 427 | Uncontrolled Search Path Element | 326.9970 | 326.9970 | Allowed |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 325.3860 | 325.3860 | Allowed |
| 7 | 287 | Improper Authentication | 322.1643 | 322.1643 | Discouraged |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 320.1036 | 320.1036 | Allowed-with-Review |
| 9 | 319 | Cleartext Transmission of Sensitive Information | 319.2292 | 319.2292 | Allowed |
| 10 | 256 | Plaintext Storage of a Password | 319.1050 | 319.1050 | Allowed |
