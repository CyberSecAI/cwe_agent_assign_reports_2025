# Vulnerability Information: CVE-2025-29509

## Vulnerability Description
Jan v0.5.14 and before is vulnerable to remote code execution (RCE) when the user clicks on a rendered link in the conversation, due to opening external website in the app and the exposure of electronAPI, with a **lack of filtering of URL when calling shell.openExternal()**.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of filtering of URL when calling shell.openExternal()**
- **weakness:** **improper URL filtering**
- **impact:** remote code execution
- **vector:** rendered link
- **product:** Jan
- **version:** v0.5.14 and before

## CVE Reference Links Content Summary
## Analysis of CVE-2025-29509 Content

The provided content details a Remote Code Execution (RCE) vulnerability in Jan Electron Desktop versions less than or equal to v0.5.14. This directly relates to a potential CVE and provides significantly more detail than a typical CVE description.

**Root cause of vulnerability:**

The vulnerability stems from opening external websites within the Jan application and the exposure of the `electronAPI` without proper filtering of URLs when calling `shell.openExternal()`.

**Weaknesses/vulnerabilities present:**

*   **Unfiltered URL opening:** The application opens URLs without validating the protocol or path, allowing execution of local files.
*   **Exposure of `electronAPI`:** The application exposes APIs to the renderer process, including `electronAPI.openExternalUrl`, which can be exploited by malicious websites.
*   **Lack of sandboxing:** Opening external links within the app's window bypasses browser security features.

**Impact of exploitation:**

Successful exploitation leads to Remote Code Execution (RCE), allowing an attacker to execute arbitrary code on the victim's machine.

**Attack vectors:**

1.  **LLM-generated links:** Malicious links can be generated by the Language Model (LLM) and rendered in the conversation.
2.  **User-pasted links:** A user can paste a malicious link (e.g., `[link](https://attacker.com/poc.html)`) into the chat, which is then rendered as a clickable link.

**Required attacker capabilities/position:**

*   The attacker needs to be able to control the content displayed in the Jan application, either through manipulating the LLM's output or by convincing a user to paste a malicious link.
*   The attacker needs to host a malicious webpage (e.g., `https://attacker.com/poc.html`) that utilizes the exposed `electronAPI`.

**Mitigation or fix:**

1.  **Open external links in external browsers:** Use `target=_blank` attribute in links to open them in the user's default browser.
2.  **URL filtering:** Implement URL filtering in the main process to only allow opening URLs with `https:` or `http:` protocols.
3.  **Reduce `electronAPI` exposure:** Limit the APIs exposed to the renderer process or restrict the arguments that can be passed.
4.  **Patch:** The vulnerability is patched in pull request [https://github.com/janhq/jan/pull/4651](https://github.com/janhq/jan/pull/4651).

The content provides a Proof of Concept (PoC) demonstrating the vulnerability using a calculator application. It also references a similar vulnerability in Bruno and provides links to relevant code snippets and resources.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.338 |
| 2 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.338 |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.337 |
| 4 | 610 | Externally Controlled Reference to a Resource in Another Sphere | Class | Discouraged | sparse | 0.334 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.334 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.333 |
| 7 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.333 |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.332 |
| 9 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | dense | 0.599 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.003 |

