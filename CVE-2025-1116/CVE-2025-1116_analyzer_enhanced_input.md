## Vulnerability Description
A vulnerability, which was classified as critical, has been found in Dreamvention Live AJAX Search Free up to 1.0.6 on OpenCart. Affected by this issue is the function searchresults/search of the file /?route=extension/live_search/module/live_search.searchresults. The manipulation of the argument keyword leads to **sql injection**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** Dreamvention Live AJAX Search Free
- **version:** up to 1.0.6
- **component:** searchresults/search function in /?route=extension/live_search/module/live_search.searchresults

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1116 Content

This content **relates** to CVE-2025-1116. It provides significantly more detail than the placeholder CVE description.

**Root cause of vulnerability:**

The root cause is the lack of proper input validation and sanitization when constructing SQL queries within the Dreamvention Live Ajax Search OpenCart module. Specifically, the module directly incorporates user-supplied input (`$this->request->get['keyword']`) into an SQL query without using prepared statements or escaping special characters.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection (SQLi):** The primary vulnerability is a classic SQL injection flaw.
*   **Error-based SQL Injection:** The vulnerability can be exploited using error-based techniques, where database errors reveal information.
*   **Blind SQL Injection:**  If error reporting is disabled, blind SQL injection techniques (e.g., time-based) can still be used.

**Impact of exploitation:**

*   **Full Database Access:** An unauthenticated attacker can access all data stored in the database.
*   **Credential Theft:**  The attacker can potentially exfiltrate admin session details and credentials.
*   **PII and Payment Data Exposure:**  Any Personally Identifiable Information (PII) and payment details stored in the database are vulnerable to theft.
*   **Site Compromise:** Full database access can lead to complete site compromise.

**Attack vectors:**

*   **GET Parameter Manipulation:** The vulnerability is triggered by manipulating the `keyword` GET parameter in the URL: `http://opencart.ddev.site/index.php?route=extension/live_search/module/live_search.searchresults&keyword=malicious_payload`
*   **Error-based Exploitation:** Exploiting database errors to reveal information.
*   **Blind SQL Injection:** Using time-based or other blind techniques when error reporting is disabled.
*   **sqlmap:** The `sqlmap` tool can be used to automate the exploitation process.

**Required attacker capabilities/position:**

*   **Unauthenticated:** No authentication is required to exploit the vulnerability.
*   **Network Access:** The attacker needs network access to the OpenCart instance.
*   **Basic SQL Knowledge:** Understanding of SQL syntax is helpful for crafting payloads.
*   **Tooling (Optional):** Tools like `sqlmap` can simplify the exploitation process.

**Mitigation or fix:**

*   **Input Validation:**  Thoroughly validate all user-supplied input used in SQL queries.
*   **Escaping:** Use the database driver's escaping mechanism (e.g., `$this->db->escape()`) to sanitize input.
*   **Prepared Statements:**  Ideally, use prepared statements or parameterized queries to prevent SQL injection.
*   **Example from OpenCart:** The document references a secure coding example from OpenCart itself, demonstrating the use of both casting to numeric types and escaping input.

**Vulnerable Code Snippets:**

The following code snippets are identified as vulnerable:

*   `catalog/controller/extension/module/d_ajax_search.php#L83` - Where the keyword is retrieved from the request.
*   `catalog/model/extension/module/d_ajax_search.php#L5` - Where the unsanitized keyword is directly used in the SQL query.

**Additional Information:**

*   **Affected Version:** 1.0.6 (Free version tested, PRO version potentially vulnerable)
*   **Tested with:** OpenCart 4.0.2.3
*   **CVSS:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L 9.9 Critical
*   **CWE/CAPEC:** CWE-89, CAPEC-66, CAPEC-7

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.444 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.373 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.371 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.367 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.353 |
| 7 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.352 |
| 8 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.350 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.531 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-502: Deserialization of Untrusted Data

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-427: Uncontrolled Search Path Element

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-73: External Control of File Name or Path