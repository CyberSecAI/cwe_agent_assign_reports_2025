# Vulnerability Information: CVE-2024-52591

## Vulnerability Description
Misskey is an open source, federated social media platform. In affected versions **missing validation** in `ApRequestService.signedGet` and `HttpRequestService.getActivityJson` allows an attacker to create fake user profiles and forged notes. The spoofed users will appear to be from a different instance than the one where they actually exist, and the forged notes will appear to be posted by a different user. Vulnerable Misskey instances will accept the spoofed objects as valid, allowing an attacker to impersonate other users and instances. The attacker retains full control of the spoofed user / note and can interact like a real account. This issue has been addressed in version 2024.11.0-alpha.3. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **component:** ApRequestService.signedGet, HttpRequestService.getActivityJson
- **rootcause:** **missing validation**
- **product:** Misskey
- **impact:** create fake user profiles, forged notes, spoof other users and instances
- **attacker:** attacker

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Missing validation in `ApRequestService.signedGet` and `HttpRequestService.getActivityJson`.
- **Weaknesses/vulnerabilities present:**  Insufficient input validation, allowing manipulation of data related to user profiles and notes.
- **Impact of exploitation:** An attacker can create spoofed user profiles appearing to originate from a different instance, and forge notes that seem to be posted by different users. This enables impersonation, allowing the attacker to interact with the system as a fake user and post fabricated notes. The compromised Misskey instance will treat these spoofed objects as legitimate.
- **Attack vectors:** Network based attack, involving the manipulation of data via the API endpoints `ApRequestService.signedGet` and `HttpRequestService.getActivityJson`.
- **Required attacker capabilities/position:** No specific privileges, user interaction, or special deployment/execution conditions are required. The attacker only needs to send malicious requests over the network.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.639 |
| 2 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.636 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.632 |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.629 |
| 5 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.613 |
| 6 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.612 |
| 7 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.612 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.610 |
| 9 | 294 | Authentication Bypass by Capture-replay | Base | Allowed | dense | 0.484 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

