## Vulnerability Description
Botan is a C++ cryptography library. X.509 certificates can identify elliptic curves using either an object identifier or using explicit encoding of the parameters. Prior to 3.5.0 and 2.19.5, checking name constraints in X.509 certificates is quadratic in the number of names and name constraints. An attacker who presented a certificate chain which contained a very large number of names in the SubjectAlternativeName, signed by a CA certificate which contained a large number of name constraints, could cause a denial of service. The problem has been addressed in Botan 3.5.0 and a partial backport has also been applied and is included in Botan 2.19.5.

### Vulnerability Description Key Phrases
- **weakness:** **quadratic complexity in certificate name constraint checking**
- **impact:** denial of service
- **vector:** certificate chain with large number of names and constraints
- **product:** Botan
- **version:** prior to 3.5.0 and 2.19.5
- **component:** X.509 certificate validation

## CVE Reference Links Content Summary
```
{
  "cveId": "CVE-2024-34702",
  "relatedContent": [
    {
      "source": "github.com_66e44c01_20250111_180605.html",
      "vulnerabilityDetails": "NOINFO"
    },
    {
      "source": "github.com_ec143c4f_20250111_180608.html",
      "vulnerabilityDetails": {
        "rootCause": "The vulnerability is caused by a quadratic complexity in the name constraint checking process within X.509 certificate validation. The number of comparisons grows quadratically with the number of names and constraints.",
        "weaknesses": [
          "Quadratic time complexity in name constraint processing leading to excessive resource consumption."
        ],
        "impact": "Denial of service. An attacker can cause significant delays by providing a crafted certificate with many names and constraints, leading to excessive processing time.",
        "attackVectors": [
          "Attacker provides a certificate chain containing a large number of names in the SubjectAlternativeName extension signed by a CA cert with a large number of name constraints."
        ],
          "requiredAttackerCapabilities": "Ability to create or manipulate X.509 certificates with many alternative names and a CA certificate with many name constraints."
      }
    },
    {
      "source": "github.com_178b7542_20250111_180602.html",
       "vulnerabilityDetails": {
        "rootCause": "Inefficient processing of name constraints. The original implementation of name constraints was less efficient than it could have been.",
        "weaknesses": [
            "Inefficient algorithms for processing name constraints causing performance overhead."
        ],
        "impact": "Performance degradation, leading to potential denial of service when processing certificates with numerous name constraints.",
         "attackVectors": [
            "An attacker could provide certificates with a high number of name constraints to exploit inefficient processing."
        ],
         "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with numerous name constraints."
      }
    },
    {
      "source": "github.com_328451ea_20250111_180604.html",
      "vulnerabilityDetails": {
        "rootCause": "An accidental quadratic code when checking for duplicate alternative names during certificate parsing.",
        "weaknesses": [
          "Quadratic time complexity for parsing alternative names."
        ],
        "impact": "Performance issue leading to excessive processing time when parsing certificates with thousands of alternative names.",
         "attackVectors": [
            "An attacker can create or modify certificates with large number of alternative names."
         ],
         "requiredAttackerCapabilities": "Ability to create or manipulate certificates with a high number of alternative names."
      }
    },
   {
      "source": "github.com_f14e3711_20250111_180559.html",
        "vulnerabilityDetails": {
         "rootCause": "Multiple bugs in name constraint processing, likely including insufficient checks on the size of inputs or other conditions.",
        "weaknesses": [
            "Multiple flaws in how name constraints are handled."
         ],
        "impact": "Potentially leading to incorrect validation results or performance issues related to name constraints.",
        "attackVectors": [
            "An attacker can manipulate name constraint fields to trigger flawed processing logic."
           ],
         "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates."
      }
    },
    {
      "source": "github.com_ffdb0f8d_20250111_180600.html",
      "vulnerabilityDetails": {
        "rootCause": "Path validation logic did not prioritize signature verification, allowing further processing with invalid certificates which could be attacked.",
        "weaknesses": [
          "Path validation did not verify the signatures first."
        ],
        "impact": "Further processing with invalid certificates can cause DoS.",
          "attackVectors": [
            "An attacker can provide a certificate chain which contains an invalid signature, but can still be processed."
          ],
        "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with an invalid signature."
      }
    },
    {
      "source": "github.com_25ca1c5a_20250111_180603.html",
      "vulnerabilityDetails": {
        "rootCause": "The vulnerability is due to the quadratic complexity of name constraint checking. The number of comparisons during name constraints check grows quadratically with the number of names and name constraints.",
         "weaknesses": [
          "Quadratic time complexity in name constraint processing."
        ],
        "impact": "Denial of service, where an attacker can cause significant delays by providing a crafted certificate with a large number of names and name constraints.",
        "attackVectors": [
          "Attacker provides certificate chain containing large number of names and constraints."
        ],
        "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with large number of names and constraints."
      }
    },
     {
      "source": "github.com_ff427447_20250111_180601.html",
       "vulnerabilityDetails": {
         "rootCause": "The vulnerability is caused by an inefficient implementation of name constraint matching, where comparisons are performed by parsing values from strings in every match attempt, causing a high overhead.",
        "weaknesses": [
            "Inefficient implementation of name constraint matching."
        ],
        "impact": "Performance degradation when processing certificates with large numbers of name constraints.",
          "attackVectors": [
            "An attacker can provide certificates with many name constraints to exploit slow matching algorithms."
           ],
         "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with numerous name constraints."
      }
    },
    {
        "source": "github.com_620dc2c0_20250111_180600.html",
       "vulnerabilityDetails": {
          "rootCause": "The vulnerability stems from not prioritizing signature verification in X.509 path validation, allowing further processing of certificates with invalid signatures. This can be exploited by an attacker.",
         "weaknesses": [
            "Path validation does not immediately reject invalid signatures."
        ],
        "impact": "Potential to trigger further processing on invalid certificates, resulting in a denial-of-service.",
          "attackVectors": [
            "An attacker can provide a certificate chain with an invalid signature, which can still be partially processed."
           ],
         "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with an invalid signature."
      }
    },
        {
      "source": "github.com_116aa3d4_20250111_180608.html",
       "vulnerabilityDetails": {
          "rootCause": "The vulnerability is due to improper handling of X.509 certificate chains with invalid signatures.",
         "weaknesses": [
            "Path validation did not prioritize the signature check."
        ],
        "impact": "Further processing with invalid certificates can cause DoS.",
        "attackVectors": [
          "An attacker provides a certificate chain with an invalid signature."
         ],
         "requiredAttackerCapabilities": "Ability to create or manipulate certificates with an invalid signature."
      }
    },
     {
      "source": "github.com_58fc09c4_20250111_180609.html",
      "vulnerabilityDetails": {
        "rootCause": "The root cause is quadratic complexity in X.509 certificate name constraint checks where processing time increases quadratically based on names and constraints. Also, inefficient processing, and incorrect parsing were observed.",
        "weaknesses": [
           "Quadratic complexity in name constraint checking",
           "Inefficient processing of name constraints",
           "Accidental quadratic algorithm during SubjectAlternativeName parsing"
        ],
         "impact": "Denial of service, potentially crashing the system. An attacker can provide a certificate chain with a large number of names and constraints, causing excessive processing time.",
           "attackVectors": [
            "Attacker presents a certificate chain with large names and constraints."
           ],
         "requiredAttackerCapabilities": "Ability to create or manipulate X.509 certificates with many alternative names and a CA certificate with many name constraints."
      }
    },
       {
      "source": "github.com_d962a6e4_20250111_180609.html",
      "vulnerabilityDetails": {
        "rootCause": "Multiple bugs in name constraint processing.",
        "weaknesses": [
          "Flaws in name constraint processing logic."
        ],
        "impact": "Incorrect certificate validation or performance issues related to name constraints.",
        "attackVectors": [
          "Attackers manipulate name constraint fields."
        ],
        "requiredAttackerCapabilities": "Ability to craft or modify X.509 certificates."
      }
    },
     {
      "source": "github.com_de56a950_20250111_180607.html",
      "vulnerabilityDetails": {
        "rootCause": "The vulnerability is caused by inefficient name constraint matching due to redundant parsing and processing of names and constraints and also not early-exiting from name constraints processing.",
        "weaknesses": [
          "Inefficient string-based name constraint matching",
           "Redundant parsing in each matching",
           "No early exit during name constraint processing"
        ],
        "impact": "Performance degradation during certificate validation potentially leading to denial of service.",
        "attackVectors": [
           "An attacker can craft certificates with a large number of names and name constraints."
        ],
        "requiredAttackerCapabilities": "Ability to craft or modify X.509 certificates with many names and name constraints."
      }
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 2 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.652 |
| 3 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.629 |
| 4 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | Allowed | sparse | 0.591 |
| 5 | 296 | Improper Following of a Certificate's Chain of Trust | Base | Allowed | sparse | 0.563 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.560 |
| 7 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.558 |
| 8 | 115 | Misinterpretation of Input | Base | Allowed | sparse | 0.551 |
| 9 | 325 | Missing Cryptographic Step | Base | Allowed | dense | 0.445 |
| 10 | 825 | Expired Pointer Dereference | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-407: Inefficient Algorithmic Complexity

CWE-295: Improper Certificate Validation

CWE-125: Out-of-bounds Read

CWE-297: Improper Validation of Certificate with Host Mismatch

CWE-296: Improper Following of a Certificate's Chain of Trust

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-400: Uncontrolled Resource Consumption

CWE-115: Misinterpretation of Input

CWE-325: Missing Cryptographic Step

CWE-825: Expired Pointer Dereference