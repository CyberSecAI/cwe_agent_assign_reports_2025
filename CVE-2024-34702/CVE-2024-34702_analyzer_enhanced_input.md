## Vulnerability Description
Botan is a C++ cryptography library. X.509 certificates can identify elliptic curves using either an object identifier or using explicit encoding of the parameters. Prior to 3.5.0 and 2.19.5, checking name constraints in X.509 certificates is quadratic in the number of names and name constraints. An attacker who presented a certificate chain which contained a very large number of names in the SubjectAlternativeName, signed by a CA certificate which contained a large number of name constraints, could cause a denial of service. The problem has been addressed in Botan 3.5.0 and a partial backport has also been applied and is included in Botan 2.19.5.

### Vulnerability Description Key Phrases
- **weakness:** **quadratic complexity in certificate name constraint checking**
- **impact:** denial of service
- **vector:** certificate chain with large number of names and constraints
- **product:** Botan
- **version:** prior to 3.5.0 and 2.19.5
- **component:** X.509 certificate validation

## CVE Reference Links Content Summary
```
{
  "cveId": "CVE-2024-34702",
  "relatedContent": [
    {
      "source": "github.com_66e44c01_20250111_180605.html",
      "vulnerabilityDetails": "NOINFO"
    },
    {
      "source": "github.com_ec143c4f_20250111_180608.html",
      "vulnerabilityDetails": {
        "rootCause": "The vulnerability is caused by a quadratic complexity in the name constraint checking process within X.509 certificate validation. The number of comparisons grows quadratically with the number of names and constraints.",
        "weaknesses": [
          "Quadratic time complexity in name constraint processing leading to excessive resource consumption."
        ],
        "impact": "Denial of service. An attacker can cause significant delays by providing a crafted certificate with many names and constraints, leading to excessive processing time.",
        "attackVectors": [
          "Attacker provides a certificate chain containing a large number of names in the SubjectAlternativeName extension signed by a CA cert with a large number of name constraints."
        ],
          "requiredAttackerCapabilities": "Ability to create or manipulate X.509 certificates with many alternative names and a CA certificate with many name constraints."
      }
    },
    {
      "source": "github.com_178b7542_20250111_180602.html",
       "vulnerabilityDetails": {
        "rootCause": "Inefficient processing of name constraints. The original implementation of name constraints was less efficient than it could have been.",
        "weaknesses": [
            "Inefficient algorithms for processing name constraints causing performance overhead."
        ],
        "impact": "Performance degradation, leading to potential denial of service when processing certificates with numerous name constraints.",
         "attackVectors": [
            "An attacker could provide certificates with a high number of name constraints to exploit inefficient processing."
        ],
         "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with numerous name constraints."
      }
    },
    {
      "source": "github.com_328451ea_20250111_180604.html",
      "vulnerabilityDetails": {
        "rootCause": "An accidental quadratic code when checking for duplicate alternative names during certificate parsing.",
        "weaknesses": [
          "Quadratic time complexity for parsing alternative names."
        ],
        "impact": "Performance issue leading to excessive processing time when parsing certificates with thousands of alternative names.",
         "attackVectors": [
            "An attacker can create or modify certificates with large number of alternative names."
         ],
         "requiredAttackerCapabilities": "Ability to create or manipulate certificates with a high number of alternative names."
      }
    },
   {
      "source": "github.com_f14e3711_20250111_180559.html",
        "vulnerabilityDetails": {
         "rootCause": "Multiple bugs in name constraint processing, likely including insufficient checks on the size of inputs or other conditions.",
        "weaknesses": [
            "Multiple flaws in how name constraints are handled."
         ],
        "impact": "Potentially leading to incorrect validation results or performance issues related to name constraints.",
        "attackVectors": [
            "An attacker can manipulate name constraint fields to trigger flawed processing logic."
           ],
         "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates."
      }
    },
    {
      "source": "github.com_ffdb0f8d_20250111_180600.html",
      "vulnerabilityDetails": {
        "rootCause": "Path validation logic did not prioritize signature verification, allowing further processing with invalid certificates which could be attacked.",
        "weaknesses": [
          "Path validation did not verify the signatures first."
        ],
        "impact": "Further processing with invalid certificates can cause DoS.",
          "attackVectors": [
            "An attacker can provide a certificate chain which contains an invalid signature, but can still be processed."
          ],
        "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with an invalid signature."
      }
    },
    {
      "source": "github.com_25ca1c5a_20250111_180603.html",
      "vulnerabilityDetails": {
        "rootCause": "The vulnerability is due to the quadratic complexity of name constraint checking. The number of comparisons during name constraints check grows quadratically with the number of names and name constraints.",
         "weaknesses": [
          "Quadratic time complexity in name constraint processing."
        ],
        "impact": "Denial of service, where an attacker can cause significant delays by providing a crafted certificate with a large number of names and name constraints.",
        "attackVectors": [
          "Attacker provides certificate chain containing large number of names and constraints."
        ],
        "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with large number of names and constraints."
      }
    },
     {
      "source": "github.com_ff427447_20250111_180601.html",
       "vulnerabilityDetails": {
         "rootCause": "The vulnerability is caused by an inefficient implementation of name constraint matching, where comparisons are performed by parsing values from strings in every match attempt, causing a high overhead.",
        "weaknesses": [
            "Inefficient implementation of name constraint matching."
        ],
        "impact": "Performance degradation when processing certificates with large numbers of name constraints.",
          "attackVectors": [
            "An attacker can provide certificates with many name constraints to exploit slow matching algorithms."
           ],
         "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with numerous name constraints."
      }
    },
    {
        "source": "github.com_620dc2c0_20250111_180600.html",
       "vulnerabilityDetails": {
          "rootCause": "The vulnerability stems from not prioritizing signature verification in X.509 path validation, allowing further processing of certificates with invalid signatures. This can be exploited by an attacker.",
         "weaknesses": [
            "Path validation does not immediately reject invalid signatures."
        ],
        "impact": "Potential to trigger further processing on invalid certificates, resulting in a denial-of-service.",
          "attackVectors": [
            "An attacker can provide a certificate chain with an invalid signature, which can still be partially processed."
           ],
         "requiredAttackerCapabilities": "Ability to create or modify X.509 certificates with an invalid signature."
      }
    },
        {
      "source": "github.com_116aa3d4_20250111_180608.html",
       "vulnerabilityDetails": {
          "rootCause": "The vulnerability is due to improper handling of X.509 certificate chains with invalid signatures.",
         "weaknesses": [
            "Path validation did not prioritize the signature check."
        ],
        "impact": "Further processing with invalid certificates can cause DoS.",
        "attackVectors": [
          "An attacker provides a certificate chain with an invalid signature."
         ],
         "requiredAttackerCapabilities": "Ability to create or manipulate certificates with an invalid signature."
      }
    },
     {
      "source": "github.com_58fc09c4_20250111_180609.html",
      "vulnerabilityDetails": {
        "rootCause": "The root cause is quadratic complexity in X.509 certificate name constraint checks where processing time increases quadratically based on names and constraints. Also, inefficient processing, and incorrect parsing were observed.",
        "weaknesses": [
           "Quadratic complexity in name constraint checking",
           "Inefficient processing of name constraints",
           "Accidental quadratic algorithm during SubjectAlternativeName parsing"
        ],
         "impact": "Denial of service, potentially crashing the system. An attacker can provide a certificate chain with a large number of names and constraints, causing excessive processing time.",
           "attackVectors": [
            "Attacker presents a certificate chain with large names and constraints."
           ],
         "requiredAttackerCapabilities": "Ability to create or manipulate X.509 certificates with many alternative names and a CA certificate with many name constraints."
      }
    },
       {
      "source": "github.com_d962a6e4_20250111_180609.html",
      "vulnerabilityDetails": {
        "rootCause": "Multiple bugs in name constraint processing.",
        "weaknesses": [
          "Flaws in name constraint processing logic."
        ],
        "impact": "Incorrect certificate validation or performance issues related to name constraints.",
        "attackVectors": [
          "Attackers manipulate name constraint fields."
        ],
        "requiredAttackerCapabilities": "Ability to craft or modify X.509 certificates."
      }
    },
     {
      "source": "github.com_de56a950_20250111_180607.html",
      "vulnerabilityDetails": {
        "rootCause": "The vulnerability is caused by inefficient name constraint matching due to redundant parsing and processing of names and constraints and also not early-exiting from name constraints processing.",
        "weaknesses": [
          "Inefficient string-based name constraint matching",
           "Redundant parsing in each matching",
           "No early exit during name constraint processing"
        ],
        "impact": "Performance degradation during certificate validation potentially leading to denial of service.",
        "attackVectors": [
           "An attacker can craft certificates with a large number of names and name constraints."
        ],
        "requiredAttackerCapabilities": "Ability to craft or modify X.509 certificates with many names and name constraints."
      }
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 2 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.652 |
| 3 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.629 |
| 4 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | Allowed | sparse | 0.591 |
| 5 | 296 | Improper Following of a Certificate's Chain of Trust | Base | Allowed | sparse | 0.563 |
| 6 | 325 | Missing Cryptographic Step | Base | Allowed | dense | 0.445 |
| 7 | 825 | Expired Pointer Dereference | Base | Allowed | graph | 0.002 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.560 |
| 9 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.558 |
| 10 | 115 | Misinterpretation of Input | Base | Allowed | sparse | 0.551 |



# Complete CWE Specifications


## CWE-407: Inefficient Algorithmic Complexity
**Abstraction:** Class
**Status:** Incomplete

### Description
An algorithm in a product has an inefficient worst-case computational complexity that may be detrimental to system performance and can be triggered by an attacker, typically using crafted manipulations that ensure that the worst case is being reached.

### Extended Description
Not provided

### Alternative Terms
Quadratic Complexity: Used when the algorithmic complexity is related to the square of the number of inputs (N^2)

### Relationships
ChildOf -> CWE-405

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction



### Observed Examples
- **CVE-2021-32617:** C++ library for image metadata has "quadratic complexity" issue with unnecessarily repetitive parsing each time an invalid character is encountered
- **CVE-2020-10735:** Python has "quadratic complexity" issue when converting string to int with many digits in unexpected bases
- **CVE-2020-5243:** server allows ReDOS with crafted User-Agent strings, due to overlapping capture groups that cause excessive backtracking.




## CWE-295: Improper Certificate Validation
**Abstraction:** Base
**Status:** Draft

### Description
The product does not validate, or incorrectly validates, a certificate.

### Extended Description
When a certificate is invalid or malicious, it might allow an attacker to spoof a trusted entity by interfering in the communication path between the host and client. The product might connect to a malicious host while believing it is a trusted host, or the product might be deceived into accepting spoofed data that appears to originate from a trusted host.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-287
ChildOf -> CWE-287
PeerOf -> CWE-322

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2019-12496:** A Go framework for robotics, drones, and IoT devices skips verification of root CA certificates by default.
- **CVE-2014-1266:** chain: incorrect "goto" in Apple SSL product bypasses certificate validation, allowing Adversary-in-the-Middle (AITM) attack (Apple "goto fail" bug). CWE-705 (Incorrect Control Flow Scoping) -> CWE-561 (Dead Code) -> CWE-295 (Improper Certificate Validation) -> CWE-393 (Return of Wrong Status Code) -> CWE-300 (Channel Accessible by Non-Endpoint).
- **CVE-2021-22909:** Chain: router's firmware update procedure uses curl with "-k" (insecure) option that disables certificate validation (CWE-295), allowing adversary-in-the-middle (AITM) compromise with a malicious firmware image (CWE-494).




## CWE-125: Out-of-bounds Read
**Abstraction:** Base
**Status:** Draft

### Description
The product reads data past the end, or before the beginning, of the intended buffer.

### Extended Description
Not provided

### Alternative Terms
OOB read: Shorthand for "Out of bounds" read

### Relationships
ChildOf -> CWE-119
ChildOf -> CWE-119
ChildOf -> CWE-119
ChildOf -> CWE-119

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2023-1018:** The reference implementation code for a Trusted Platform Module does not implement length checks on data, allowing for an attacker to read 2 bytes past the end of a buffer.
- **CVE-2020-11899:** Out-of-bounds read in IP stack used in embedded systems, as exploited in the wild per CISA KEV.
- **CVE-2014-0160:** Chain: "Heartbleed" bug receives an inconsistent length parameter (CWE-130) enabling an out-of-bounds read (CWE-126), returning memory that could include private cryptographic keys and other sensitive data.




## CWE-297: Improper Validation of Certificate with Host Mismatch
**Abstraction:** Variant
**Status:** Incomplete

### Description
The product communicates with a host that provides a certificate, but the product does not properly ensure that the certificate is actually associated with that host.

### Extended Description


Even if a certificate is well-formed, signed, and follows the chain of trust, it may simply be a valid certificate for a different site than the site that the product is interacting with. If the certificate's host-specific data is not properly checked - such as the Common Name (CN) in the Subject or the Subject Alternative Name (SAN) extension of an X.509 certificate - it may be possible for a redirection or spoofing attack to allow a malicious host with a valid certificate to provide data, impersonating a trusted host. In order to ensure data integrity, the certificate must be valid and it must pertain to the site that is being accessed.


Even if the product attempts to check the hostname, it is still possible to incorrectly check the hostname. For example, attackers could create a certificate with a name that begins with a trusted name followed by a NUL byte, which could cause some string-based comparisons to only examine the portion that contains the trusted name.


This weakness can occur even when the product uses Certificate Pinning, if the product does not verify the hostname at the time a certificate is pinned.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-923
ChildOf -> CWE-295

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2012-5810:** Mobile banking application does not verify hostname, leading to financial loss.
- **CVE-2012-5811:** Mobile application for printing documents does not verify hostname, allowing attackers to read sensitive documents.
- **CVE-2012-5807:** Software for electronic checking does not verify hostname, leading to financial loss.




## CWE-296: Improper Following of a Certificate's Chain of Trust
**Abstraction:** Base
**Status:** Draft

### Description
The product does not follow, or incorrectly follows, the chain of trust for a certificate back to a trusted root certificate, resulting in incorrect trust of any resource that is associated with that certificate.

### Extended Description


If a system does not follow the chain of trust of a certificate to a root server, the certificate loses all usefulness as a metric of trust. Essentially, the trust gained from a certificate is derived from a chain of trust -- with a reputable trusted entity at the end of that list. The end user must trust that reputable source, and this reputable source must vouch for the resource in question through the medium of the certificate.


In some cases, this trust traverses several entities who vouch for one another. The entity trusted by the end user is at one end of this trust chain, while the certificate-wielding resource is at the other end of the chain. If the user receives a certificate at the end of one of these trust chains and then proceeds to check only that the first link in the chain, no real trust has been derived, since the entire chain must be traversed back to a trusted source to verify the certificate.


There are several ways in which the chain of trust might be broken, including but not limited to:


  - Any certificate in the chain is self-signed, unless it the root.

  - Not every intermediate certificate is checked, starting from the original certificate all the way up to the root certificate.

  - An intermediate, CA-signed certificate does not have the expected Basic Constraints or other important extensions.

  - The root certificate has been compromised or authorized to the wrong party.



### Alternative Terms
None

### Relationships
ChildOf -> CWE-295
ChildOf -> CWE-573

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2016-2402:** Server allows bypass of certificate pinning by sending a chain of trust that includes a trusted CA that is not pinned.
- **CVE-2008-4989:** Verification function trusts certificate chains in which the last certificate is self-signed.
- **CVE-2012-5821:** Chain: Web browser uses a TLS-related function incorrectly, preventing it from verifying that a server's certificate is signed by a trusted certification authority (CA).




## CWE-325: Missing Cryptographic Step
**Abstraction:** Base
**Status:** Draft

### Description
The product does not implement a required step in a cryptographic algorithm, resulting in weaker encryption than advertised by the algorithm.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-573
PeerOf -> CWE-358

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** Overlaps incomplete/missing security check.

**[Relationship]** Can be resultant.



### Observed Examples
- **CVE-2001-1585:** Missing challenge-response step allows authentication bypass using public key.




## CWE-825: Expired Pointer Dereference
**Abstraction:** Base
**Status:** Incomplete

### Description
The product dereferences a pointer that contains a location for memory that was previously valid, but is no longer valid.

### Extended Description
When a product releases memory, but it maintains a pointer to that memory, then the memory might be re-allocated at a later time. If the original pointer is accessed to read or write data, then this could cause the product to read or modify data that is in use by a different function or process. Depending on how the newly-allocated memory is used, this could lead to a denial of service, information exposure, or code execution.

### Alternative Terms
Dangling pointer

### Relationships
ChildOf -> CWE-119
ChildOf -> CWE-119
ChildOf -> CWE-119
ChildOf -> CWE-672
CanPrecede -> CWE-125
CanPrecede -> CWE-787

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Maintenance]** There are close relationships between incorrect pointer dereferences and other weaknesses related to buffer operations. There may not be sufficient community agreement regarding these relationships. Further study is needed to determine when these relationships are chains, composites, perspective/layering, or other types of relationships. As of September 2010, most of the relationships are being captured as chains.

**[Terminology]** Many weaknesses related to pointer dereferences fall under the general term of "memory corruption" or "memory safety." As of September 2010, there is no commonly-used terminology that covers the lower-level variants.



### Observed Examples
- **CVE-2008-5013:** access of expired memory address leads to arbitrary code execution
- **CVE-2010-3257:** stale pointer issue leads to denial of service and possibly other consequences
- **CVE-2008-0062:** Chain: a message having an unknown message type may cause a reference to uninitialized memory resulting in a null pointer dereference (CWE-476) or dangling pointer (CWE-825), possibly crashing the system or causing heap corruption.




## CWE-770: Allocation of Resources Without Limits or Throttling
**Abstraction:** Base
**Status:** Incomplete

### Description
The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.

### Extended Description


Code frequently has to work with limited resources, so programmers must be careful to ensure that resources are not consumed too quickly, or too easily. Without use of quotas, resource limits, or other protection mechanisms, it can be easy for an attacker to consume many resources by rapidly making many requests, or causing larger resources to be used than is needed. When too many resources are allocated, or if a single resource is too large, then it can prevent the code from working correctly, possibly leading to a denial of service.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-400
ChildOf -> CWE-665
ChildOf -> CWE-400

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** This entry is different from uncontrolled resource consumption (CWE-400) in that there are other weaknesses that are related to inability to control resource consumption, such as holding on to a resource too long after use, or not correctly keeping track of active resources so that they can be managed and released when they are finished (CWE-771).

**[Theoretical]** Vulnerability theory is largely about how behaviors and resources interact. "Resource exhaustion" can be regarded as either a consequence or an attack, depending on the perspective. This entry is an attempt to reflect one of the underlying weaknesses that enable these attacks (or consequences) to take place.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2009-4017:** Language interpreter does not restrict the number of temporary files being created when handling a MIME request with a large number of parts..
- **CVE-2009-2726:** Driver does not use a maximum width when invoking sscanf style functions, causing stack consumption.




## CWE-400: Uncontrolled Resource Consumption
**Abstraction:** Class
**Status:** Draft

### Description
The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.

### Extended Description


Limited resources include memory, file system storage, database connection pool entries, and CPU. If an attacker can trigger the allocation of these limited resources, but the number or size of the resources is not controlled, then the attacker could cause a denial of service that consumes all available resources. This would prevent valid users from accessing the product, and it could potentially have an impact on the surrounding environment. For example, a memory exhaustion attack against an application could slow down the application as well as its host operating system.


There are at least three distinct scenarios which can commonly lead to resource exhaustion:


  - Lack of throttling for the number of allocated resources

  - Losing all references to a resource before reaching the shutdown stage

  - Not closing/returning a resource after processing

Resource exhaustion problems are often result due to an incorrect implementation of the following situations:

  - Error conditions and other exceptional circumstances.

  - Confusion over which part of the program is responsible for releasing the resource.



### Alternative Terms
Resource Exhaustion

### Relationships
ChildOf -> CWE-664

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-400 is intended for incorrect behaviors in which the product is expected to track and restrict how many resources it consumes, but CWE-400 is often misused because it is conflated with the "technical impact" of vulnerabilities in which resource consumption occurs. It is sometimes used for low-information vulnerability reports. It is a level-1 Class (i.e., a child of a Pillar).
**Comments:** Closely analyze the specific mistake that is causing resource consumption, and perform a CWE mapping for that mistake. Consider children/descendants such as CWE-770: Allocation of Resources Without Limits or Throttling, CWE-771: Missing Reference to Active Allocated Resource, CWE-410: Insufficient Resource Pool, CWE-772: Missing Release of Resource after Effective Lifetime, CWE-834: Excessive Iteration, CWE-405: Asymmetric Resource Consumption (Amplification), and others.
**Reasons:**
- Frequent Misuse


### Additional Notes
**[Maintenance]** "Resource consumption" could be interpreted as a consequence instead of an insecure behavior, so this entry is being considered for modification. It appears to be referenced too frequently when more precise mappings are available. Some of its children, such as CWE-771, might be better considered as a chain.

**[Theoretical]** Vulnerability theory is largely about how behaviors and resources interact. "Resource exhaustion" can be regarded as either a consequence or an attack, depending on the perspective. This entry is an attempt to reflect the underlying weaknesses that enable these attacks (or consequences) to take place.

**[Other]** 

Database queries that take a long time to process are good DoS targets. An attacker would have to write a few lines of Perl code to generate enough traffic to exceed the site's ability to keep up. This would effectively prevent authorized users from using the site at all. Resources can be exploited simply by ensuring that the target machine must do much more work and consume more resources in order to service a request than the attacker must do to initiate a request.


A prime example of this can be found in old switches that were vulnerable to "macof" attacks (so named for a tool developed by Dugsong). These attacks flooded a switch with random IP and MAC address combinations, therefore exhausting the switch's cache, which held the information of which port corresponded to which MAC addresses. Once this cache was exhausted, the switch would fail in an insecure way and would begin to act simply as a hub, broadcasting all traffic on all ports and allowing for basic sniffing attacks.


**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the "Mapping CWE to 62443" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2020-7218:** Go-based workload orchestrator does not limit resource usage with unauthenticated connections, allowing a DoS by flooding the service
- **CVE-2020-3566:** Resource exhaustion in distributed OS because of "insufficient" IGMP queue management, as exploited in the wild per CISA KEV.




## CWE-115: Misinterpretation of Input
**Abstraction:** Base
**Status:** Incomplete

### Description
The product misinterprets an input, whether from an attacker or another product, in a security-relevant fashion.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-436

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Research Gap]** This concept needs further study. It is likely a factor in several weaknesses, possibly resultant as well. Overlaps Multiple Interpretation Errors (MIE).



### Observed Examples
- **CVE-2005-2225:** Product sees dangerous file extension in free text of a group discussion, disconnects all users.
- **CVE-2001-0003:** Product does not correctly import and process security settings from another product.

