# Vulnerability Information: CVE-2024-47143

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved **dma-debug fix a possible **deadlock**** on radix_lock radix_lock() shouldnt be held while holding dma_hash_entry[idx].lock otherwise, theres a possible **deadlock** scenario when dma debug API is called holding rq_lock() CPU0 CPU1 CPU2 dma_free_attrs() check_unmap() add_dma_entry() __schedule() //out (A) rq_lock() get_hash_bucket() (A) dma_entry_hash check_sync() (A) radix_lock() (W) dma_entry_hash dma_entry_free() (W) radix_lock() // CPU2s one (W) rq_lock() CPU1 situation can happen when it extending radix tree and it tries to wake up kswapd via wake_all_kswapd(). CPU2 situation can happen while perf_event_task_sched_out() (i.e. dma sync operation is called while deleting perf_event using etm and etr tmc which are Arm Coresight hwtracing driver backends). To remove this possible situation, call dma_entry_free() after put_hash_bucket() in check_unmap().

### Vulnerability Description Key Phrases
- **rootcause:** **dma-debug fix a possible deadlock**
- **weakness:** **deadlock**
- **product:** Linux kernel

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.509 |
| 2 | 833 | Deadlock | Base | Allowed | sparse | 0.505 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.474 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.470 |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.442 |
| 6 | 1251 | Mirrored Regions with Different Values | Base | Allowed | sparse | 0.421 |
| 7 | 807 | Reliance on Untrusted Inputs in a Security Decision | Base | Allowed | sparse | 0.407 |
| 8 | 663 | Use of a Non-reentrant Function in a Concurrent Context | Base | Allowed | sparse | 0.397 |
| 9 | 413 | Improper Resource Locking | Base | Allowed | dense | 0.532 |
| 10 | 609 | Double-Checked Locking | Base | Allowed | graph | 0.003 |

