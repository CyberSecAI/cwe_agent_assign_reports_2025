{
  "cve_id": "CVE-2024-45791",
  "description": "Exposure of Sensitive Information to an Unauthorized Actor vulnerability in Apache HertzBeat. This issue affects Apache HertzBeat before 1.6.1. Users are recommended to upgrade to version 1.6.1, which fixes the issue.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "Exposure of Sensitive Information to an Unauthorized Actor",
    "vector": "",
    "attacker": "",
    "product": "Apache HertzBeat",
    "version": "before 1.6.1",
    "component": ""
  },
  "reference_content": "```\n{\n  \"Root cause of vulnerability\": \"The application exposes sensitive tokens via HTTP GET method with query string.\",\n  \"Weaknesses/vulnerabilities present\": \"Exposure of Sensitive Information to an Unauthorized Actor\",\n  \"Impact of exploitation\": \"Unauthorized access to sensitive tokens.\",\n  \"Attack vectors\": \"HTTP GET requests with query string.\",\n  \"Required attacker capabilities/position\": \"Attacker needs to be able to intercept or access HTTP requests containing the sensitive token in the URL.\"\n}\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-319 | Cleartext Transmission of Sensitive Information | 0.9 | Base | Allowed | Primary CWE |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.5 | Class | Discouraged | Secondary Candidate |\n| CWE-201 | Insertion of Sensitive Information Into Sent Data | 0.5 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-319 (Cleartext Transmission of Sensitive Information), which is a Base level CWE. CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) is a Class level CWE and is a parent of many more specific CWEs related to information exposure, thus is not specific enough. CWE-201 (Insertion of Sensitive Information Into Sent Data) can be related, however, the root cause is specifically the transmission of sensitive information in cleartext.\n\n```mermaid\ngraph TD\n    cwe319[\"CWE-319: Cleartext Transmission of Sensitive Information\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    cwe201[\"CWE-201: Insertion of Sensitive Information Into Sent Data\"]\n\n    cwe319 -->|CHILDOF| cwe200\n    cwe201 -->|CHILDOF| cwe200\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe319 primary\n    class cwe200,cwe201 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **root cause** of transmitting sensitive tokens via HTTP GET method with query string which leads to **cleartext transmission of sensitive information** (CWE-319), which results in the **impact** of **exposure of sensitive information to an unauthorized actor** (CWE-200).\n\n## Summary of Analysis\nThe analysis is based on the provided evidence, specifically the \"CVE Reference Links Content Summary\" section, which states \"The application exposes sensitive tokens via HTTP GET method with query string.\" This clearly indicates that the sensitive information (tokens) are being transmitted in cleartext.\n\nCWE-319 (Cleartext Transmission of Sensitive Information) is selected as the primary CWE because the vulnerability description and the CVE reference summary clearly indicate that the sensitive tokens are being transmitted in cleartext via HTTP GET requests. This aligns with the definition of CWE-319, which is \"The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.\"\n\nThe retriever results also list CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) and CWE-201 (Insertion of Sensitive Information Into Sent Data), but these are less specific than CWE-319. CWE-200 is a class level CWE and represents the impact of the vulnerability rather than the root cause. CWE-201 is relevant, but the core issue is the cleartext transmission, making CWE-319 the most accurate representation of the **weakness**.\n\nThe selected CWEs are at the optimal level of specificity because CWE-319 directly addresses the **root cause** of the vulnerability, while CWE-200 represents the high-level impact.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-319 | Cleartext Transmission of Sensitive Information | 0.9 | Base | Allowed | Primary CWE |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.5 | Class | Discouraged | Secondary Candidate |\n| CWE-201 | Insertion of Sensitive Information Into Sent Data | 0.5 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-319 (Cleartext Transmission of Sensitive Information), which is a Base level CWE. CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) is a Class level CWE and is a parent of many more specific CWEs related to information exposure, thus is not specific enough. CWE-201 (Insertion of Sensitive Information Into Sent Data) can be related, however, the root cause is specifically the transmission of sensitive information in cleartext.\n\n```mermaid\ngraph TD\n    cwe319[\"CWE-319: Cleartext Transmission of Sensitive Information\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    cwe201[\"CWE-201: Insertion of Sensitive Information Into Sent Data\"]\n\n    cwe319 -->|CHILDOF| cwe200\n    cwe201 -->|CHILDOF| cwe200\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe319 primary\n    class cwe200,cwe201 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **root cause** of transmitting sensitive tokens via HTTP GET method with query string which leads to **cleartext transmission of sensitive information** (CWE-319), which results in the **impact** of **exposure of sensitive information to an unauthorized actor** (CWE-200).\n\n## Summary of Analysis\nThe analysis is based on the provided evidence, specifically the \"CVE Reference Links Content Summary\" section, which states \"The application exposes sensitive tokens via HTTP GET method with query string.\" This clearly indicates that the sensitive information (tokens) are being transmitted in cleartext.\n\nCWE-319 (Cleartext Transmission of Sensitive Information) is selected as the primary CWE because the vulnerability description and the CVE reference summary clearly indicate that the sensitive tokens are being transmitted in cleartext via HTTP GET requests. This aligns with the definition of CWE-319, which is \"The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.\"\n\nThe retriever results also list CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) and CWE-201 (Insertion of Sensitive Information Into Sent Data), but these are less specific than CWE-319. CWE-200 is a class level CWE and represents the impact of the vulnerability rather than the root cause. CWE-201 is relevant, but the core issue is the cleartext transmission, making CWE-319 the most accurate representation of the **weakness**.\n\nThe selected CWEs are at the optimal level of specificity because CWE-319 directly addresses the **root cause** of the vulnerability, while CWE-200 represents the high-level impact.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-319:**\n- 319 (Cleartext Transmission of Sensitive Information) - ROOT\n\n\n**Chain starting from CWE-200:**\n- 200 (Exposure of Sensitive Information to an Unauthorized Actor) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 69.47255415735661
    },
    {
      "metadata": {
        "doc_id": "532",
        "name": "Insertion of Sensitive Information into Log File",
        "source": "sparse"
      },
      "similarity": 69.3432676704974
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 67.17889110748975
    },
    {
      "metadata": {
        "doc_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "source": "sparse"
      },
      "similarity": 65.23429633308928
    },
    {
      "metadata": {
        "doc_id": "359",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 63.10397028202602
    },
    {
      "metadata": {
        "doc_id": "319",
        "name": "Cleartext Transmission of Sensitive Information",
        "source": "sparse"
      },
      "similarity": 62.749269146863895
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 61.96952068883829
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 61.84517881198641
    },
    {
      "metadata": {
        "doc_id": "1004",
        "name": "Sensitive Cookie Without 'HttpOnly' Flag",
        "type": "Variant",
        "original_content": "The product uses a cookie to store sensitive information, but the cookie is not marked with the HttpOnly flag.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5072547539545762,
            "graph": 1.0655685506897723
          }
        }
      },
      "similarity": 0.5072547539545762
    },
    {
      "doc_id": "1272",
      "text": "CWE-1272: Sensitive Information Uncleared Before Debug/Power State Transition",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "1272",
        "name": "Sensitive Information Uncleared Before Debug/Power State Transition",
        "type": "base",
        "original_content": "CWE-1272: Sensitive Information Uncleared Before Debug/Power State Transition",
        "relationships": [
          {
            "source_id": "1272",
            "target_id": "200",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1272",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1272",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "200",
            "target_id": "1272",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "200",
                  "1272",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "200"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "200",
                  "1272",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "200"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "1272",
                  "200",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "200"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-319",
      "CWE-200",
      "CWE-201"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}