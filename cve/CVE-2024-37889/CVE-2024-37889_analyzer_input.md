# Vulnerability Information: CVE-2024-37889

## Vulnerability Description
MyFinances is a web application for managing finances. MyFinances has a way to access other customer invoices while signed in as a user. This method allows an actor to access PII and financial information from another account. The vulnerability is fixed in 0.4.6.

### Vulnerability Description Key Phrases
- **impact:** access PII and financial information from another account
- **product:** MyFinances

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-37889:

**Root cause of vulnerability:**
The vulnerability stems from a missing authorization check in the `edit_invoice` function within the `MyFinances/backend/api/invoices/edit.py` file. Specifically, the function was not properly verifying if the user attempting to access/edit an invoice had the necessary permissions.

**Weaknesses/vulnerabilities present:**
- **Insecure Direct Object Reference (IDOR):** The `edit_invoice` function takes an `invoice_id` parameter, and an attacker can manipulate this parameter to access invoices belonging to other users.
- **Missing Authorization Check:** The application failed to verify if the logged-in user had the right to access or modify the specified invoice, leading to unauthorized access.

**Impact of exploitation:**
- **Confidentiality Breach:** An attacker could potentially access the Personally Identifiable Information (PII) and financial data of other users by gaining unauthorized access to their invoices.
- **Unauthorized Data Access:** An attacker could view and potentially modify invoice data belonging to other users.

**Attack vectors:**
- **Network-based attack:** The attacker can exploit the vulnerability remotely via HTTP requests.

**Required attacker capabilities/position:**
- The attacker needs to have a valid user account on the platform.
- The attacker needs to be able to access the edit invoice functionality.
- The attacker needs to be able to manipulate the `invoice_id` parameter in the HTTP request.

**Additional Details:**
- The vulnerability was discovered by MatthewLaitinen.
- The vulnerable code exists in `backend/views/core/invoices/edit.py` in the `edit_invoice` function.
- The fix involves adding permission checks in the `edit_invoice` function to verify if the user has the required authorization.
- The patched version is 0.4.6, whereas versions prior to 0.3.0 are affected.
- The CVSS score is 6.5 which is considered Moderate.

The provided content gives a detailed explanation of the vulnerability, including the steps to reproduce it, which is useful information.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.084 |
| 2 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.083 |
| 3 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.081 |
| 4 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.081 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.081 |
| 6 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.080 |
| 7 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.080 |
| 8 | 613 | Insufficient Session Expiration | Base | Allowed | sparse | 0.080 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.449 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.002 |

