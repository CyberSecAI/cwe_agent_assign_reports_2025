## Vulnerability Description
The SIP Reviews Shortcode for WooCommerce plugin for WordPress is vulnerable to SQL Injection via the no_of_reviews attribute in the woocommerce_reviews shortcode in all versions up to, and including, 1.2.3 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** unauthenticated attackers
- **product:** SIP Reviews Shortcode for WooCommerce plugin for WordPress
- **version:** all versions up to and including 1.2.3
- **component:** woocommerce_reviews shortcode

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-6479

**Root Cause of Vulnerability:**
- Insufficient input sanitization and lack of proper SQL query preparation on the `no_of_reviews` parameter within the `woocommerce_reviews` shortcode.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The plugin is vulnerable to SQL injection via the `no_of_reviews` attribute within the shortcode.

**Impact of Exploitation:**
- **Information Disclosure:** Attackers can potentially extract sensitive information from the database.

**Attack Vectors:**
-  By injecting malicious SQL code into the `no_of_reviews` parameter of the `woocommerce_reviews` shortcode.

**Required Attacker Capabilities/Position:**
- **Authenticated (Contributor+):**  The attacker needs to be at least a Contributor to inject the shortcode

**Additional Details:**
- The vulnerability exists in all versions of the plugin up to and including 1.2.3.
- The vulnerable code is located in the `plugin-reviews-shortcode-display.php` file, specifically around line 332 where the SQL query is constructed
- The plugin's Trac repository is referenced for the vulnerable code location.
- The Wordfence analysis mentions that the vulnerability is due to insufficient escaping of the user-supplied parameter and lack of sufficient preparation on the existing SQL query

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.555 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.515 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.501 |
| 5 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.491 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.483 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.481 |
| 8 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.476 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.489 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-502: Deserialization of Untrusted Data

CWE-790: Improper Filtering of Special Elements

CWE-341: Predictable from Observable State

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-613: Insufficient Session Expiration