## Vulnerability Description
Tenda FH1201 v1.2.0.14 (408) was discovered to contain a **stack overflow** via the page parameter in the fromqossetting function. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted POST request.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **impact:** Denial of Service
- **vector:** crafted POST request
- **attacker:** attackers
- **product:** Tenda FH1201
- **version:** v1.2.0.14
- **component:** fromqossetting function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 148)
- CWE-120 (Count: 4)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

*   A stack-based buffer overflow vulnerability exists in the `fromqossetting` function of the Tenda FH1201 firmware.

**Vulnerabilities:**

*   **Stack Overflow:** The `sprintf` function is used to construct a string using a user-supplied parameter without proper bounds checking. The statement `sprintf(v7, "qos_list.asp?page=%s", v4);`, where `v4` is derived from user-controlled input `page`, copies the user-provided data into a fixed-size buffer `v7`. If the size of `v4` exceeds the size of `v7`, a stack-based buffer overflow occurs.

**Impact of Exploitation:**

*   **Code Execution:** By overflowing the buffer, an attacker can overwrite adjacent data on the stack, potentially gaining arbitrary code execution on the device. This could allow the attacker to fully control the router, leading to data theft, denial of service, or other malicious activities.

**Attack Vectors:**

*   **HTTP POST Request:** The vulnerability is triggered by sending a POST request to the `/goform/qossetting` endpoint.
*   **`page` Parameter:** The malicious payload is passed via the `page` parameter of the POST request.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to have network connectivity to the Tenda router's web interface.
*   **No Authentication Required**: The provided information doesn't mention any authentication needed for this particular request, indicating that this may be exploitable without credentials
*  **Crafting HTTP Request:** The attacker needs to be able to craft and send an HTTP POST request with a payload large enough to cause a buffer overflow.

**Additional Information:**

*   **Affected Firmware:** The vulnerability is specifically in the Tenda FH1201 Firmware V1.2.0.14(408).
*   **Proof of Concept:** The provided Python code demonstrates how to trigger the overflow using `requests.post` library.
*   **Reproducibility:** The provided images show the overflow happening, and the script shows how to reproduce it, giving it a high degree of confidence.

This information gives a clear and detailed understanding of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.241 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.226 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.221 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.220 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.219 |
| 8 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.217 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.558 |
| 10 | 787 | Out-of-bounds Write | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-121: Stack-based Buffer Overflow

CWE-190: Integer Overflow or Wraparound

CWE-674: Uncontrolled Recursion

CWE-122: Heap-based Buffer Overflow

CWE-125: Out-of-bounds Read

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-787: Out-of-bounds Write