# Vulnerability Description

    An **Incorrect Authorization** vulnerability exists in lunary-ai/lunary versions up to and including 1.2.2, which allows unauthenticated users to delete any dataset. The vulnerability is due to the **lack of proper authorization checks** in the dataset deletion endpoint. Specifically, the endpoint does not verify if the provided project ID belongs to the current user, thereby allowing any dataset to be deleted without proper authentication. This issue was fixed in version 1.2.8.

    # Keyphrase-Specific CWE Analysis
    This vulnerability contains multiple keyphrases that may map to different CWEs. 
    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.

    ## ROOTCAUSE: 'Incorrect Authorization'

Relevant CWEs for this ROOTCAUSE:

### 1. CWE-863: Incorrect Authorization (Score: 492.92)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-285: Improper Authorization (Score: 480.77)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 3. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 460.60)

The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....

### 4. CWE-862: Missing Authorization (Score: 456.11)

The product does not perform an authorization check when an actor attempts to access a resource or perform an action....

### 5. CWE-620: Unverified Password Change (Score: 445.98)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

## ROOTCAUSE: 'lack of proper authorization checks'

Relevant CWEs for this ROOTCAUSE:

### 1. CWE-863: Incorrect Authorization (Score: 492.92)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-285: Improper Authorization (Score: 480.77)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 3. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 460.60)

The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....

### 4. CWE-862: Missing Authorization (Score: 456.11)

The product does not perform an authorization check when an actor attempts to access a resource or perform an action....

### 5. CWE-620: Unverified Password Change (Score: 445.98)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

## IMPACT: 'delete any dataset'

Relevant CWEs for this IMPACT:

### 1. CWE-863: Incorrect Authorization (Score: 492.92)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-285: Improper Authorization (Score: 480.77)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 3. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 460.60)

The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....

### 4. CWE-862: Missing Authorization (Score: 456.11)

The product does not perform an authorization check when an actor attempts to access a resource or perform an action....

### 5. CWE-620: Unverified Password Change (Score: 445.98)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

## ATTACKER: 'unauthenticated users'

Relevant CWEs for this ATTACKER:

### 1. CWE-863: Incorrect Authorization (Score: 492.92)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-285: Improper Authorization (Score: 480.77)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 3. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 460.60)

The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....

### 4. CWE-862: Missing Authorization (Score: 456.11)

The product does not perform an authorization check when an actor attempts to access a resource or perform an action....

### 5. CWE-620: Unverified Password Change (Score: 445.98)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

## PRODUCT: 'lunary-ai/lunary'

Relevant CWEs for this PRODUCT:

### 1. CWE-863: Incorrect Authorization (Score: 492.92)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-285: Improper Authorization (Score: 480.77)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 3. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 460.60)

The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....

### 4. CWE-862: Missing Authorization (Score: 456.11)

The product does not perform an authorization check when an actor attempts to access a resource or perform an action....

### 5. CWE-620: Unverified Password Change (Score: 445.98)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

## VERSION: 'up to and including 1.2.2'

Relevant CWEs for this VERSION:

### 1. CWE-863: Incorrect Authorization (Score: 492.92)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-285: Improper Authorization (Score: 480.77)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 3. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 460.60)

The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....

### 4. CWE-862: Missing Authorization (Score: 456.11)

The product does not perform an authorization check when an actor attempts to access a resource or perform an action....

### 5. CWE-306: Missing Authentication for Critical Function (Score: 166.61)

The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....

## COMPONENT: 'dataset deletion endpoint'

Relevant CWEs for this COMPONENT:

### 1. CWE-863: Incorrect Authorization (Score: 492.92)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-285: Improper Authorization (Score: 480.77)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 3. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 460.60)

The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....

### 4. CWE-862: Missing Authorization (Score: 456.11)

The product does not perform an authorization check when an actor attempts to access a resource or perform an action....

### 5. CWE-306: Missing Authentication for Critical Function (Score: 166.61)

The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....


    # Analysis Instructions
    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.
    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.
    3. Provide a final determination of primary CWE(s) and any secondary CWEs.
    4. Format your response using the standard analysis template.

    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.
    

# Complete CWE Specifications

CWE-863: Incorrect Authorization

CWE-285: Improper Authorization

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-862: Missing Authorization

CWE-620: Unverified Password Change

CWE-306: Missing Authentication for Critical Function