# Vulnerability Information: CVE-2024-10921

## Vulnerability Description
An authorized user may trigger crashes or receive the contents of buffer over-reads of Server memory by issuing specially crafted requests that **construct malformed BSON** in the MongoDB Server. This issue affects MongoDB Server v5.0 versions prior to 5.0.30 , MongoDB Server v6.0 versions prior to 6.0.19, MongoDB Server v7.0 versions prior to 7.0.15 and MongoDB Server v8.0 versions prior to and including 8.0.2.

### Vulnerability Description Key Phrases
- **weakness:** **construct malformed BSON**
- **impact:** crashes and receive the contents of buffer over-reads of Server memory
- **vector:** specially crafted requests
- **attacker:** authorized user
- **product:** MongoDB Server
- **version:** v5.0 versions prior to 5.0.30, v6.0 versions prior to 6.0.19, v7.0 versions prior to 7.0.15, v8.0 versions prior to and including 8.0.2

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

*   **Root Cause:** Improper neutralization of null bytes within specially crafted BSON requests.
*   **Weaknesses/Vulnerabilities:** The vulnerability lies in the way MongoDB Server handles malformed BSON data, specifically the presence of null bytes. This improper handling can lead to buffer over-reads.
*   **Impact of Exploitation:** An authorized user can trigger crashes or receive the contents of buffer over-reads of server memory. This could potentially lead to information disclosure.
*  **Attack Vectors:** The attack vector involves sending specially crafted requests containing malformed BSON to the MongoDB server.
*   **Required Attacker Capabilities/Position:** The attacker needs to be an authorized user and must be able to send requests to the MongoDB server.

**Summary:** The vulnerability is due to the server's failure to properly handle null bytes in BSON requests. This can result in buffer over-reads, causing crashes or leaking server memory. It can be triggered by any authorized user sending malformed BSON.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.398 |
| 2 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.377 |
| 3 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.370 |
| 4 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.362 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.359 |
| 6 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.358 |
| 7 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.348 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.347 |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.475 |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | graph | 0.003 |

