# Vulnerability Information: CVE-2024-57876

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved drm/dp_mst Fix resetting msg rx state after topology removal If the MST topology is removed during the reception of an MST down reply or MST up request sideband message, the drm_dp_mst_topology_mgrup_req_recv/down_rep_recv states could be reset from one thread via drm_dp_mst_topology_mgr_set_mst(false), racing with the reading/parsing of the message from another thread via drm_dp_mst_handle_down_rep() or drm_dp_mst_handle_up_req(). The race is possible since the reader/parser doesnt hold any lock while accessing the reception state. This in turn can lead to a **memory corruption** in the reader/parser as described by commit bd2fccac61b4 (drm/dp_mst Fix MST sideband message body length check). Fix the above by resetting the message reception state if needed before reading/parsing a message. Another solution would be to hold the drm_dp_mst_topology_mgrlock for the whole duration of the message reception/parsing in drm_dp_mst_handle_down_rep() and drm_dp_mst_handle_up_req(), however this would require a bigger change. Since the fix is also needed for stable, opting for the simpler solution in this patch.

### Vulnerability Description Key Phrases
- **weakness:** **memory corruption**
- **product:** Linux kernel
- **component:** drm/dp_mst

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 787 | Out-of-bounds Write | Base | Allowed | alternate_terms | 1.000 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.819 |
| 3 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.797 |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.777 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.770 |
| 6 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.766 |
| 7 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.752 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.751 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.496 |
| 10 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | graph | 0.003 |

