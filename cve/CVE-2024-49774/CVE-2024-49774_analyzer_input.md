# Vulnerability Information: CVE-2024-49774

## Vulnerability Description
SuiteCRM is an open-source, enterprise-ready Customer Relationship Management (CRM) software application. SuiteCRM relies on the blacklist of functions/methods to prevent installation of malicious MLPs. But this checks can be bypassed with some syntax constructions. **SuiteCRM uses token_get_all to parse PHP scripts and check the resulted AST against blacklists. But it doesnt take into account all scenarios**. This issue has been addressed in versions 7.14.6 and 8.7.1. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **SuiteCRM uses token_get_all to parse PHP scripts and check the resulted AST against blacklists. But it doesnt take into account all scenarios**
- **impact:** installation of malicious MLPs
- **vector:** bypass the blacklist of functions/methods
- **product:** SuiteCRM

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "SuiteCRM uses token_get_all to parse PHP scripts and check the resulting Abstract Syntax Tree (AST) against a blacklist of functions/methods. However, this check can be bypassed using certain syntax constructions, as it doesn't account for all scenarios.",
    "weaknesses": [
      "Improper Input Validation (CWE-20)"
    ],
    "impact": "Successful exploitation leads to Remote Code Execution (RCE), which can result in:\n\t- Network penetration\n\t- Privilege escalation\n\t- Sensitive data exposure\n\t- Denial of Service (DoS)\n\t- Cryptomining\n\t- Ransomware deployment",
    "attack_vectors": [
      "Network"
    ],
     "required_capabilities": "The attacker requires high privileges to exploit this vulnerability."
  },
  "additional_information": {
        "affected_versions": "SuiteCRM versions <=7.14.4 and <=8.6.2",
        "patched_versions": "SuiteCRM versions 7.14.6 and 8.7.1",
        "cvss_score": "7.2",
        "cvss_vector":"CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | alternate_terms | 0.800 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.470 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.469 |
| 4 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.458 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.443 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.442 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.438 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.438 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.496 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.002 |

