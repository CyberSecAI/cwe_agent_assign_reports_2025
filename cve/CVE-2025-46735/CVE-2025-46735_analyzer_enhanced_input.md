## Vulnerability Description
Terraform WinDNS Provider allows users to manage their Windows DNS server resources through Terraform. A security issue has been found in Terraform WinDNS Provider before version `1.0.5`. The `windns_record` resource **did not sanitize the input variables**. This could lead to authenticated command injection in the underlyding powershell command prompt. Version 1.0.5 contains a fix for the issue.

### Vulnerability Description Key Phrases
- **rootcause:** **did not sanitize the input variables**
- **impact:** command injection
- **attacker:** authenticated users
- **product:** Terraform WinDNS Provider
- **version:** before version 1.0.5
- **component:** windns_record resource

## CVE Reference Links Content Summary
CVE-2025-46735

**Root cause of vulnerability:**
The `windns_record` resource did not sanitize the input variables.

**Weaknesses/vulnerabilities present:**
Improper input sanitization leading to authenticated command injection in the underlying PowerShell command prompt. (CWE-77)

**Impact of exploitation:**
Authenticated command injection.

**Attack vectors:**
Exploitation occurs through crafted input variables to the `windns_record` resource.

**Required attacker capabilities/position:**
Authenticated user.

**Mitigation or fix:**
The vulnerability was patched in version 1.0.5 with commit `83ef736 (fix: better input validation)`.  The fix includes sanitizing input strings using `SanitizeInputString` and `SanitiseTFInput` functions, and escaping PowerShell input.

**Additional details:**
The provided content includes test cases demonstrating the vulnerability and the fix, including a test case specifically for illegal characters. The vulnerability affects versions <= 1.0.4.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.345 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.314 |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.314 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.313 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.300 |
| 6 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.298 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.292 |
| 8 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.290 |
| 9 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | Variant | Allowed | dense | 0.471 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-138: Improper Neutralization of Special Elements

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-863: Incorrect Authorization

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action

CWE-117: Improper Output Neutralization for Logs