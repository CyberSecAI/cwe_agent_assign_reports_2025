# Vulnerability Information: CVE-2025-2731

## Vulnerability Description
A vulnerability was found in H3C Magic NX15, Magic NX30 Pro, Magic NX400, Magic R3010 and Magic BE18000 up to V100R014. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the file /api/wizard/getDualbandSync of the component HTTP POST Request Handler. The manipulation leads to **command injection**. The attack needs to be done within the local network. The exploit has been disclosed to the public and may be used. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **component:** /api/wizard/getDualbandSync of the component HTTP POST Request Handler
- **weakness:** **command injection**
- **product:** Magic NX15, Magic NX30 Pro, Magic NX400, Magic R3010, Magic BE18000
- **version:** up to V100R014

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on the aspects relevant to CVE-2025-2731:

**1. Verify if the content relates to the CVE specified based on the official description**
The content is about a security advisory for H3C Magic home routers, specifically mentioning a command injection vulnerability, which aligns with the CVE-2025-2731 description.

**2. If the content does not relate to this CVE, respond with "UNRELATED"**
N/A

**3. If no useful vulnerability information is found, respond with "NOINFO"**
N/A

**4. For relevant content, extract it if exists**

*   **Root cause of vulnerability:** The advisory states that the vulnerability is "未授权命令注入风险" (unauthorized command injection risk).
*   **Weaknesses/vulnerabilities present:** The primary weakness is the command injection vulnerability.
*   **Impact of exploitation:** The impact of exploitation is that an attacker can gain control of the device. This could lead to network unavailability. The advisory mentions that the devices themselves do not store or actively retrieve user sensitive information, so the risk of information leakage is low.
*   **Attack vectors:** The attack vector is the local network, with the attacker gaining access either through a wired connection (physical access) or wirelessly (within the device's wireless range and able to crack the password)
*   **Required attacker capabilities/position:** An attacker needs to be on the local network, either physically connected to the device or within wireless range, and able to potentially brute-force the wireless password.
*   **Mitigation or fix:** The advisory provides several workarounds:
    *   Enable anti-蹭网 (anti-theft network) features to prevent wireless password brute-forcing.
    *   Enable Wi-Fi access control, adding suspicious devices to a blacklist.
    *   Use a guest network.
    The advisory also provides a list of affected products and corresponding fixed versions.

**Additional information**

This content provides more detail than a typical CVE description, including:
*   Specific product models affected.
*   A clear description of the vulnerability.
*   An analysis of the risk level (中危, or medium risk).
*   Practical mitigation steps.
*   The fixed versions.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.574 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.507 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.444 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.437 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.434 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.425 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.613 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

