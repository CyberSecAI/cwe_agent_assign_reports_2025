# Vulnerability Information: CVE-2025-1752

## Vulnerability Description
A **Denial of Service (DoS) vulnerability** has been identified in the KnowledgeBaseWebReader class of the run-llama/llama_index project, affecting version ~ latest(v0.12.15). The vulnerability arises due to inappropriate secure coding measures, specifically the lack of proper implementation of the max_depth parameter in the get_article_urls function. This allows an attacker to exhaust Pythons recursion limit through repeated function calls, leading to resource consumption and ultimately crashing the Python process.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of proper implementation of max_depth parameter**
- **weakness:** **Denial of Service (DoS) vulnerability**
- **impact:** resource consumption
- **vector:** repeated function calls
- **attacker:** attacker
- **product:** run-llama/llama_index project
- **version:** ~ latest(v0.12.15)
- **component:** KnowledgeBaseWebReader class

## CVE Reference Links Content Summary
The content relates to a fix in the `llama_index` project, specifically within the `llama-index-readers-web` module.

**Root cause of vulnerability:**
The `get_article_urls` function did not properly limit the recursion depth when crawling a knowledge base, potentially leading to infinite loops or excessive resource consumption.

**Weaknesses/vulnerabilities present:**
- Uncontrolled recursion depth in web crawling.
- Potential for denial-of-service (DoS) if the crawler gets stuck in an infinite loop.

**Impact of exploitation:**
- Excessive resource consumption (CPU, memory).
- Potential denial-of-service.

**Attack vectors:**
- A malicious or poorly structured knowledge base with circular links.

**Required attacker capabilities/position:**
- Ability to control the `root_url` provided to the `KnowledgeBaseWebReader`.

**Mitigation or fix:**
- The commit introduces a `depth` parameter to the `get_article_urls` function and checks if `depth` exceeds `max_depth`. If it does, the function returns, preventing further recursion.
- A print statement was added to indicate when the maximum depth is reached.
- The version was updated to 0.3.6.

The content provides more detail than the official CVE description would likely contain, as it includes the specific code changes and the reasoning behind them.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.434 |
| 2 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.429 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.424 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.421 |
| 5 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.406 |
| 6 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.403 |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.392 |
| 8 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.391 |
| 9 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | dense | 0.480 |
| 10 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | Base | Allowed | graph | 0.002 |

