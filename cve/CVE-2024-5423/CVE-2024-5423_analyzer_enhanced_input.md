## Vulnerability Description
Multiple Denial of Service (DoS) conditions has been discovered in GitLab CE/EE affecting all versions starting from 1.0 prior to 17.0.6, starting from 17.1 prior to 17.1.4, and starting from 17.2 prior to 17.2.2 which allowed an attacker to cause resource exhaustion via banzai pipeline.

### Vulnerability Description Key Phrases
- **impact:** Denial of Service (DoS)
- **vector:** banzai pipeline
- **attacker:** attacker
- **product:** GitLab CE/EE
- **version:** all versions starting from 1.0 prior to 17.0.6, starting from 17.1 prior to 17.1.4, and starting from 17.2 prior to 17.2.2

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-400

#### Top CWEs
- CWE-400 (Count: 6)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The vulnerability stems from the lack of limitation on the number of inline diffs processed by the `InlineDiffFilter` in GitLab's markdown rendering pipeline (`banzai`). This allows an attacker to craft a payload with a large number of code diffs, leading to excessive CPU consumption during rendering.
- **Weaknesses/vulnerabilities present:**
    - Lack of input validation or rate limiting for inline diffs in markdown rendering.
    - The `InlineDiffFilter` does not have a limit like the `EmojiFilter` does.
- **Impact of exploitation:**
    - Denial of Service (DoS): By sending a crafted payload with a large number of code diffs, an attacker can cause high CPU usage, making the GitLab instance unresponsive or inaccessible.
    - Server resource exhaustion: The attack leads to excessive CPU consumption, potentially impacting other services running on the same server.
    - Slowdowns and delays: Users may experience significant delays and slowdowns while navigating the GitLab instance.
- **Attack vectors:**
    - A malicious user can create a comment or markdown field containing a crafted payload with a large number of inline diffs (`{++}\n`).
    - The attack vector is through a POST request to the `preview_markdown` endpoint.
- **Required attacker capabilities/position:**
    - Authenticated user: The attacker needs to be authenticated to make requests to the preview markdown endpoint.
    - Knowledge of CSRF token and session cookie: The attacker needs to have the user's session cookie and CSRF token in order to make a request.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.129 |
| 2 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.122 |
| 3 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.113 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.112 |
| 5 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.110 |
| 6 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.109 |
| 7 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.107 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.106 |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.544 |
| 10 | 390 | Detection of Error Condition Without Action | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-400: Uncontrolled Resource Consumption

CWE-696: Incorrect Behavior Order

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-285: Improper Authorization

CWE-755: Improper Handling of Exceptional Conditions

CWE-1333: Inefficient Regular Expression Complexity

CWE-1286: Improper Validation of Syntactic Correctness of Input

CWE-863: Incorrect Authorization

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-390: Detection of Error Condition Without Action