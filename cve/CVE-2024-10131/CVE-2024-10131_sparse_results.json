{
  "query": "The `add_llm` function in `llm_app.py` in infiniflow/ragflow version 0.11.0 contains a remote code execution (RCE) vulnerability. The function uses user-supplied input `req[llm_factory]` and `req[llm_name]` to dynamically instantiate classes from various model dictionaries. This approach allows an attacker to potentially execute arbitrary code due to the lack of comprehensive input validation or sanitization. An attacker could provide a malicious value for llm_factory that, when used as an index to these model dictionaries, results in the execution of arbitrary code.",
  "count": 11,
  "results": [
    {
      "cwe_id": "116",
      "name": "Improper Encoding or Escaping of Output",
      "abstraction": "Class",
      "score": 700.0,
      "original_score": 700.0,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "20",
      "name": "Improper Input Validation",
      "abstraction": "Class",
      "score": 461.77687368577153,
      "original_score": 461.77687368577153,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "138",
      "name": "Improper Neutralization of Special Elements",
      "abstraction": "Class",
      "score": 455.1348727991804,
      "original_score": 455.1348727991804,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 450.1216994301784,
      "original_score": 450.1216994301784,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "94",
      "name": "Improper Control of Generation of Code ('Code Injection')",
      "abstraction": "Base",
      "score": 443.4615261391697,
      "original_score": 443.4615261391697,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "502",
      "name": "Deserialization of Untrusted Data",
      "abstraction": "Base",
      "score": 442.2271018510123,
      "original_score": 442.2271018510123,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "78",
      "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
      "abstraction": "Base",
      "score": 434.90177723982885,
      "original_score": 434.90177723982885,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "787",
      "name": "Out-of-bounds Write",
      "abstraction": "Base",
      "score": 428.8176225266508,
      "original_score": 428.8176225266508,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "470",
      "name": "Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')",
      "abstraction": "Base",
      "score": 428.3859283653438,
      "original_score": 428.3859283653438,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "abstraction": "Class",
      "score": 422.7962981352849,
      "original_score": 422.7962981352849,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "abstraction": "Base",
      "score": 400.8735533360143,
      "original_score": 400.8735533360143,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 400.8735533360143,
    "max": 700.0,
    "mean": 460.7724775916759,
    "median": 442.2271018510123,
    "count": 11
  }
}