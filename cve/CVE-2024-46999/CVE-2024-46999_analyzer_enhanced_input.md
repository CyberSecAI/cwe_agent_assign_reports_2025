## Vulnerability Description
Zitadel is an open source identity management platform. **ZITADELs user grants deactivation mechanism did not work correctly**. Deactivated user grants were still provided in token, which could lead to unauthorized access to applications and resources. Additionally, the management and auth API always returned the state as active or did not provide any information about the state. Versions 2.62.1, 2.61.1, 2.60.2, 2.59.3, 2.58.5, 2.57.5, 2.56.6, 2.55.8, and 2.54.10 have been released which address this issue. Users are advised to upgrade. Users unable to upgrade may explicitly remove the user grants to make sure the user does not get access anymore.

### Vulnerability Description Key Phrases
- **rootcause:** **ZITADELs user grants deactivation mechanism did not work correctly**
- **impact:** unauthorized access to applications and resources
- **vector:** Deactivated user grants were still provided in token
- **product:** Zitadel
- **version:** 2.62.1, 2.61.1, 2.60.2, 2.59.3, 2.58.5, 2.57.5, 2.56.6, 2.55.8, and 2.54.10

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** ZITADEL's user grants deactivation mechanism was not functioning correctly. Deactivated user grants were still included in tokens.
- **Weaknesses/vulnerabilities present:** The system failed to properly revoke access rights when a user grant was deactivated, leading to the continued provision of access tokens with stale permissions. Additionally, the management and auth API did not reflect the deactivated state.
- **Impact of exploitation:** Unauthorized access to applications and resources due to the presence of deactivated user grants in access tokens.
- **Attack vectors:** Network-based attacks exploiting the flawed token generation and validation process.
- **Required attacker capabilities/position:** Requires low privileges, and some user interaction, to potentially leverage existing valid tokens. An attacker could use valid tokens containing deactivated user grants to access restricted resources until the user grant removal.

The provided content offers more detail than the CVE description placeholder, including specific vulnerable and patched versions, as well as workarounds and CVSS v3 base metrics.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.585 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.556 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.553 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.550 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.539 |
| 6 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.528 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.526 |
| 8 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | sparse | 0.521 |
| 9 | 267 | Privilege Defined With Unsafe Actions | Base | Allowed | dense | 0.408 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-863: Incorrect Authorization

CWE-1390: Weak Authentication

CWE-306: Missing Authentication for Critical Function

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-285: Improper Authorization

CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-288: Authentication Bypass Using an Alternate Path or Channel

CWE-267: Privilege Defined With Unsafe Actions

CWE-226: Sensitive Information in Resource Not Removed Before Reuse