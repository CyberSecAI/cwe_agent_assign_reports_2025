# Vulnerability Information: CVE-2024-45191

## Vulnerability Description
An issue was discovered in Matrix libolm through 3.2.16. The AES implementation is vulnerable to **cache-timing attacks** due to use of S-boxes. This is related to software that uses a lookup table for the SubWord step. This refers to the libolm implementation of Olm. NOTE This vulnerability only affects products that are no longer supported by the maintainer.

### Vulnerability Description Key Phrases
- **weakness:** **cache-timing attacks**
- **product:** Matrix libolm
- **version:** through 3.2.16
- **component:** AES implementation

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-45191:

**Verification:**

The provided content directly references CVE-2024-45191 and provides detailed information about the vulnerability. The vulnerability is present in the AES implementation of the Olm library.

**Root Cause of Vulnerability:**

The root cause is the use of a software-based implementation of AES that relies on a look-up table (S-box) for the `SubWord` step. This design makes the implementation vulnerable to cache-timing attacks.

**Weaknesses/Vulnerabilities Present:**

*   **Cache-timing vulnerability:** The software AES implementation uses a look-up table ( `aes_sbox`) indexed by secret data which leads to cache hits and misses that reveal information about the key.

**Impact of Exploitation:**

*   **Secret Key Extraction:** An attacker can potentially extract the secret key by observing the timing differences of the vulnerable AES implementation during encryption.
*  The blog mentions that similar attacks have been previously used to extract secret keys from other software, including OpenSSL and dm-crypt.

**Attack Vectors:**

*   **Local:** An attacker can observe cache timing differences locally, by running malicious processes on the same hardware as the vulnerable software
*   **Remote:** With enough samples, timing differences are observable over the network through normal operation of the vulnerable software.

**Required Attacker Capabilities/Position:**

*   **Local Access (for more precise attacks):** Ability to run code on the same machine as the vulnerable application to more accurately measure cache timings.
*   **Network Access (for remote attacks):** Ability to observe network traffic and collect many samples to detect timing differences over the network.

**Additional Details:**

*   The blog post provides specific code snippets of the vulnerable AES implementation.
*   It also references research papers which discuss cache-timing attacks and their feasibility.
*   It mentions the recommended mitigation which involves using hardware-accelerated AES, or bitsliced AES implementations (like the one in BearSSL).
*   The Matrix developers were aware of the vulnerability but knowingly shipped the vulnerable code for years without fixing it due to the deprecation of libolm.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.342 |
| 2 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.338 |
| 3 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.326 |
| 4 | 204 | Observable Response Discrepancy | Base | Allowed | sparse | 0.326 |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.325 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.316 |
| 7 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.315 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.313 |
| 9 | 294 | Authentication Bypass by Capture-replay | Base | Allowed | dense | 0.526 |
| 10 | 385 | Covert Timing Channel | Base | Allowed | graph | 0.002 |

