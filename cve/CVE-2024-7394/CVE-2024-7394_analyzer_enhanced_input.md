## Vulnerability Description
Concrete CMS versions 9 through 9.3.2 and below 8.5.18 are vulnerable to **Stored XSS** in getAttributeSetName(). A rogue administrator could inject malicious code. The Concrete CMS team gave this a CVSS v3.1 rank of 2 with vector AVN/ACH/PRH/UIR/SU/CL/IN/AN https//nvd.nist.gov/vuln-metrics/cvss/v3-calculator and a CVSS v4.0 rank of 1.8 with vector CVSS4.0/AVN/ACH/ATN/PRH/UIA/VCL/VIL/VAN/SCN/SIN/SAN https//www.first.org/cvss/calculator/4.0#CVSS4.0/AVN/ACH/ATN/PRH/UIA/VCL/VIL/VAN/SCN/SIN/SAN . Thanks, m3dium for reporting.

### Vulnerability Description Key Phrases
- **weakness:** **Stored XSS**
- **impact:** inject malicious code
- **attacker:** rogue administrator
- **product:** Concrete CMS
- **version:** 9 through 9.3.2 and below 8.5.18
- **component:** getAttributeSetName()

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2024-7394:

**Root Cause of Vulnerability:**
- Insufficient sanitization of Board instance names when outputting them in the `getAttributeSetName()` function.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS) vulnerability.

**Impact of Exploitation:**
- A rogue administrator could inject malicious JavaScript code, leading to potential execution of arbitrary scripts in the context of other users' browsers. This could be used to perform actions on behalf of another user, steal session information, or deface the website.

**Attack Vectors:**
- The vulnerability is triggered through the `getAttributeSetName()` function, which outputs a Board instance name that was not properly sanitized on input, leading to stored XSS when rendered to a victim.

**Required Attacker Capabilities/Position:**
- The attacker needs to be a high privileged user (administrator) to inject the malicious payload.
- The attacker also needs to have the ability to create or modify the names of Board instances, which would require administrative access.
- User interaction is required in that an administrative user has to view the name of the board for the stored XSS to be triggered.

**Additional Notes:**
- The fix involves sanitizing the Board instance names on output within the `getAttributeSetName()` function.
- The vulnerability affects Concrete CMS versions 8 and 9, and patches are applied through specific commits (12166 for version 9 and c08d9671cec4e7afdabb547339c4bc0bed8eab06 for version 8).
- The Concrete CMS team assigned a CVSS v3.1 score of 2.0 and a CVSS v4.0 score of 1.8 to this vulnerability.

The provided content offers detailed information on the vulnerability, including the affected versions, the fix, and the CVSS scores.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.399 |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.396 |
| 4 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.361 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.342 |
| 6 | 173 | Improper Handling of Alternate Encoding | Variant | Allowed | sparse | 0.328 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.325 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.322 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.627 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-347: Improper Verification of Cryptographic Signature

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-173: Improper Handling of Alternate Encoding

CWE-790: Improper Filtering of Special Elements

CWE-502: Deserialization of Untrusted Data

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-73: External Control of File Name or Path