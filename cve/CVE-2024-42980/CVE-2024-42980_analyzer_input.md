# Vulnerability Information: CVE-2024-42980

## Vulnerability Description
Tenda FH1206 v02.03.01.35 was discovered to contain a **stack overflow** via the page parameter in the frmL7ImForm function. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted POST request.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted POST request
- **attacker:** attackers
- **product:** Tenda FH1206
- **version:** v02.03.01.35
- **component:** frmL7ImForm function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 183)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A stack-based buffer overflow vulnerability exists within the `frmL7ImForm` function of the Tenda FH1206 router firmware.
- **Weaknesses/vulnerabilities present:** The `sprintf` function is used to format a string, copying the user-supplied `page` parameter into a fixed-size buffer `v10` without proper bounds checking. The function constructs a new string using user-controlled input.
- **Impact of exploitation:** By providing an overly long `page` parameter in a POST request, an attacker can overwrite data on the stack, leading to potential control of execution flow and potentially arbitrary code execution on the router.
- **Attack vectors:** The vulnerability can be triggered by sending a crafted POST request to the `/goform/L7Im` endpoint, including an overly long string as the value for the `page` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP POST requests to the web interface of the router. This usually requires being on the same network as the router or having access through a port forward or similar configuration.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.236 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.213 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.212 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.211 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.208 |
| 8 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.208 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.539 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.002 |

