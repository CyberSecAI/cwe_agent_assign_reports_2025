# Vulnerability Information: CVE-2025-24031

## Vulnerability Description
PAM-PKCS#11 is a Linux-PAM login module that allows a X.509 certificate based user login. In versions 0.6.12 and prior, the pam_pkcs11 module segfaults when a user presses ctrl-c/ctrl-d when they are asked for a PIN. When a user enters no PIN at all, `pam_get_pwd` will never initialize the password buffer pointer and as such `cleanse` will try to dereference an uninitialized pointer. On my system this pointer happens to have the value 3 most of the time when running sudo and as such it will segfault. The most likely impact to a system affected by this issue is an availability impact due to a daemon that uses PAM crashing. As of time of publication, a patch for the issue is unavailable.

### Vulnerability Description Key Phrases
- **component:** pam_pkcs11 module
- **rootcause:** **uninitialized pointer, uninitialized password buffer pointer**
- **vector:** ctrl-c/ctrl-d
- **product:** PAM-PKCS#11
- **impact:** availability impact
- **version:** 0.6.12 and prior

## CVE Reference Links Content Summary
## Analysis of CVE-2025-24031 based on provided content:

This content **relates to** CVE-2025-24031 and provides more detail than the placeholder description.

**Root cause of vulnerability:**

The vulnerability is triggered when pressing `ctrl-c` or `ctrl-d` while prompted for a PIN. This causes the `pam_pkcs11` module to attempt to `cleanse` an uninitialized `password` buffer, leading to a segmentation fault.

**Weaknesses/vulnerabilities present:**

*   Use of an uninitialized variable (`password` buffer) before being passed to a function (`cleanse`) that dereferences it.
*   Lack of proper error handling when a PIN is not entered.

**Impact of exploitation:**

*   Segmentation fault, causing the `pam_pkcs11` module to crash.
*   Potential for privilege escalation (though considered difficult to exploit reliably).
*   Potential for crashing PAM-using daemons.

**Attack vectors:**

*   An attacker can trigger the vulnerability by pressing `ctrl-c` or `ctrl-d` when prompted for a PIN by a service using `pam_pkcs11`.
*   Local attack vector.

**Required attacker capabilities/position:**

*   Local access to the system.
*   Ability to trigger a PIN prompt via a service using `pam_pkcs11` (e.g., `sudo su`).
*   No privileges required.
*   No user interaction beyond pressing `ctrl-c` or `ctrl-d`.

**Mitigation or fix:**

*   Initialize the `password` variable to `NULL` before it is used. The suggested location is line 211 in `pam_pkcs11/src/pam_pkcs11/pam_pkcs11.c`.

**CVSS Score:**

*   CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:N/SI:N/SA:L (Overall score: /10)

**Affected versions:**

*   `< 0.6.12`

**CVE ID:**

*   CVE-2025-24031

**Credits:**

*   Reporter: [@bjorn3](https://github.com/bjorn3)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.705 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.697 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.684 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.683 |
| 5 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.682 |
| 6 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.680 |
| 7 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.679 |
| 8 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.677 |
| 9 | 620 | Unverified Password Change | Base | Allowed | dense | 0.456 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

