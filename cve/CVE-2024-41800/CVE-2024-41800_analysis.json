{
  "cve_id": "CVE-2024-41800",
  "description": "Craft is a content management system (CMS). Craft CMS 5 allows **reuse of TOTP tokens multiple times** within the validity period. An attacker is able to re-submit a valid TOTP token to establish an authenticated session. This requires that the attacker has knowledge of the victims credentials. This has been patched in Craft 5.2.3.",
  "key_phrases": {
    "rootcause": "reuse of TOTP tokens multiple times",
    "weakness": "",
    "impact": "establish authenticated session",
    "vector": "re-submit valid TOTP token",
    "attacker": "attacker",
    "product": "Craft CMS",
    "version": "5",
    "component": ""
  },
  "reference_content": "Based on the provided content, here's a breakdown of the vulnerability:\n\n**Root Cause:**\nThe vulnerability stems from the improper implementation of Time-based One-Time Password (TOTP) authentication within Craft CMS. Specifically, the system failed to invalidate a TOTP token after its initial successful use, allowing for reuse within the validity period.\n\n**Weaknesses/Vulnerabilities:**\n- **TOTP Reuse:** The primary vulnerability is the ability to reuse a TOTP token multiple times for authentication, violating the one-time-use principle of TOTP.\n- **Missing timestamp validation:** The system did not track when a TOTP was last used.\n\n**Impact of Exploitation:**\n- An attacker who has obtained a valid TOTP token, along with the victim's credentials, can reuse the token within its validity period to gain unauthorized access to the victim's account. This allows session hijacking even if a valid token was used in an earlier session.\n\n**Attack Vectors:**\n- The attack vector is network-based.\n- An attacker needs the victim's credentials and a valid TOTP token generated for their account, within its validity window.\n\n**Required Attacker Capabilities/Position:**\n- The attacker must have prior knowledge of a valid user's credentials (username/password).\n- The attacker needs to obtain a valid TOTP token (either by observing the victim's entry, or through other means).\n- The attacker needs to make the authentication attempt within the token's validity window which, in this case, is 2 minutes, according to the advisory.\n- The attacker needs to send the TOTP token to the `/index.php?p=admin%2Factions%2Fauth%2Fverify-totp` endpoint.\n\n**Additional Details:**\n\n- The vulnerability is present in Craft CMS versions 5.0.0-beta.1 through 5.2.2.\n- The issue has been fixed in version 5.2.3 by using the `verifyKeyNewer` function of the used Google2FA library which ensures that the token is only used once.\n- The fix involved storing a timestamp indicating the last time a TOTP was used, and comparing subsequent attempts with this timestamp.\n- The validity period of a TOTP token is 2 minutes, increasing the likelihood of a successful brute-force attack given multiple valid tokens.\n- The CVSS score is 4.8 (Medium) with a vector of CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name   | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|-------------------------|-----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| CWE-307 | Improper Restriction of Excessive Authentication Attempts | 0.8 | Base | Allowed | The product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame.|\n| CWE-287 | Improper Authentication | 0.5 | Class | Discouraged | When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct. This is a class level CWE and the description is generic.|\n| CWE-613 | Insufficient Session Expiration | 0.5 | Base | Allowed | According to WASC, \"Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.\" The vulnerability allows an attacker to re-submit a valid TOTP token to establish an authenticated session. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is the **reuse of TOTP tokens multiple times**, which violates the one-time-use principle. CWE-307, \"Improper Restriction of Excessive Authentication Attempts\", is a good fit because the system doesn't prevent **reuse of TOTP tokens multiple times** within a short time frame. CWE-287, \"Improper Authentication\", is a class-level CWE and a more general case. CWE-613, \"Insufficient Session Expiration\", is related but less direct, as the core issue isn't session expiration, but rather the **reuse of TOTP tokens multiple times** within a session's validity period.\n\n```mermaid\ngraph TD\n    cwe307[\"CWE-307: Improper Restriction of Excessive Authentication Attempts\"]\n    cwe287[\"CWE-287: Improper Authentication\"]\n    cwe613[\"CWE-613: Insufficient Session Expiration\"]\n    \n    cwe307 -->|CHILDOF| cwe287\n    cwe613 -->|CANPRECEDE| cwe287\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe307 primary\n    class cwe287,cwe613 secondary\n```\n\n## Vulnerability Chain\n1.  **Root Cause:** The system does not properly restrict **reuse of TOTP tokens multiple times** within the validity period.\n2.  **Weakness:** The system fails to invalidate a TOTP token after its first successful use.\n3.  **Impact:** An attacker can re-submit a valid TOTP token to establish an authenticated session, even if the token was previously used.\n\n## Summary of Analysis\nThe primary CWE is CWE-307, \"Improper Restriction of Excessive Authentication Attempts,\" because the core vulnerability is the system's failure to prevent **reuse of TOTP tokens multiple times** within a short time frame. This aligns with the root cause and the technical details provided. The evidence directly supports this classification. I am also considering CWE-287 and CWE-613 as secondary mappings. CWE-287 is a class level CWE and is a more general case of failing to properly authenticate. CWE-613 is related, because the attacker is able to establish an authenticated session using the **reuse of TOTP tokens multiple times**. However, CWE-307 is more specific to the vulnerability.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-613: Insufficient Session Expiration\n**Abstraction Level**: Base\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nAccording to WASC, \"Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.\"\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nThe product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-1390: Weak Authentication\n**Abstraction Level**: Class\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nThe product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-294: Authentication Bypass by Capture-replay\n**Abstraction Level**: Base\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nA capture-replay flaw exists when the design of the product makes it possible for a malicious user to sniff network traffic and bypass authentication by replaying it to the server in question to the same effect as the original message (or with minor changes).\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-208: Observable Timing Discrepancy\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nTwo separate operations in a product require different amounts of time to complete, in a way that is observable to an actor and reveals security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-288: Authentication Bypass Using an Alternate Path or Channel\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product requires authentication, but the product has an alternate path or channel that does not require authentication.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-472: External Control of Assumed-Immutable Web Parameter\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe web application does not sufficiently verify inputs that are assumed to be immutable but are actually externally controllable, such as hidden form fields.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-307: Improper Restriction of Excessive Authentication Attempts\n**Abstraction Level**: Base\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-330: Use of Insufficiently Random Values\n**Abstraction Level**: Class\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-1390: Weak Authentication\n**Abstraction Level**: Class\n**Similarity Score**: 1027.32\n**Source**: sparse\n\n**Description**:\nThe product uses an authentication mechanism to restrict access to",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name   | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|-------------------------|-----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| CWE-307 | Improper Restriction of Excessive Authentication Attempts | 0.8 | Base | Allowed | The product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame.|\n| CWE-287 | Improper Authentication | 0.5 | Class | Discouraged | When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct. This is a class level CWE and the description is generic.|\n| CWE-613 | Insufficient Session Expiration | 0.5 | Base | Allowed | According to WASC, \"Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.\" The vulnerability allows an attacker to re-submit a valid TOTP token to establish an authenticated session. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is the **reuse of TOTP tokens multiple times**, which violates the one-time-use principle. CWE-307, \"Improper Restriction of Excessive Authentication Attempts\", is a good fit because the system doesn't prevent **reuse of TOTP tokens multiple times** within a short time frame. CWE-287, \"Improper Authentication\", is a class-level CWE and a more general case. CWE-613, \"Insufficient Session Expiration\", is related but less direct, as the core issue isn't session expiration, but rather the **reuse of TOTP tokens multiple times** within a session's validity period.\n\n```mermaid\ngraph TD\n    cwe307[\"CWE-307: Improper Restriction of Excessive Authentication Attempts\"]\n    cwe287[\"CWE-287: Improper Authentication\"]\n    cwe613[\"CWE-613: Insufficient Session Expiration\"]\n    \n    cwe307 -->|CHILDOF| cwe287\n    cwe613 -->|CANPRECEDE| cwe287\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe307 primary\n    class cwe287,cwe613 secondary\n```\n\n## Vulnerability Chain\n1.  **Root Cause:** The system does not properly restrict **reuse of TOTP tokens multiple times** within the validity period.\n2.  **Weakness:** The system fails to invalidate a TOTP token after its first successful use.\n3.  **Impact:** An attacker can re-submit a valid TOTP token to establish an authenticated session, even if the token was previously used.\n\n## Summary of Analysis\nThe primary CWE is CWE-307, \"Improper Restriction of Excessive Authentication Attempts,\" because the core vulnerability is the system's failure to prevent **reuse of TOTP tokens multiple times** within a short time frame. This aligns with the root cause and the technical details provided. The evidence directly supports this classification. I am also considering CWE-287 and CWE-613 as secondary mappings. CWE-287 is a class level CWE and is a more general case of failing to properly authenticate. CWE-613 is related, because the attacker is able to establish an authenticated session using the **reuse of TOTP tokens multiple times**. However, CWE-307 is more specific to the vulnerability.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-613: Insufficient Session Expiration\n**Abstraction Level**: Base\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nAccording to WASC, \"Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.\"\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nThe product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-1390: Weak Authentication\n**Abstraction Level**: Class\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nThe product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-294: Authentication Bypass by Capture-replay\n**Abstraction Level**: Base\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nA capture-replay flaw exists when the design of the product makes it possible for a malicious user to sniff network traffic and bypass authentication by replaying it to the server in question to the same effect as the original message (or with minor changes).\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-208: Observable Timing Discrepancy\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nTwo separate operations in a product require different amounts of time to complete, in a way that is observable to an actor and reveals security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-288: Authentication Bypass Using an Alternate Path or Channel\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product requires authentication, but the product has an alternate path or channel that does not require authentication.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-472: External Control of Assumed-Immutable Web Parameter\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe web application does not sufficiently verify inputs that are assumed to be immutable but are actually externally controllable, such as hidden form fields.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-307: Improper Restriction of Excessive Authentication Attempts\n**Abstraction Level**: Base\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-330: Use of Insufficiently Random Values\n**Abstraction Level**: Class\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-1390: Weak Authentication\n**Abstraction Level**: Class\n**Similarity Score**: 1027.32\n**Source**: sparse\n\n**Description**:\nThe product uses an authentication mechanism to restrict access to\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-1390:**\n- 1390 (Weak Authentication) - ROOT\n\n\n**Chain starting from CWE-288:**\n- 288 (Authentication Bypass Using an Alternate Path or Channel) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "613",
        "name": "Insufficient Session Expiration",
        "source": "sparse"
      },
      "similarity": 351.465565133468
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 334.93249448064813
    },
    {
      "metadata": {
        "doc_id": "1390",
        "name": "Weak Authentication",
        "source": "sparse"
      },
      "similarity": 334.5469359281847
    },
    {
      "metadata": {
        "doc_id": "303",
        "name": "Incorrect Implementation of Authentication Algorithm",
        "source": "sparse"
      },
      "similarity": 324.02053672314554
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 320.0089350062161
    },
    {
      "metadata": {
        "doc_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "source": "sparse"
      },
      "similarity": 318.94368043472736
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 316.3799236490738
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 314.4742284489713
    },
    {
      "metadata": {
        "doc_id": "384",
        "name": "Session Fixation",
        "type": "Compound",
        "original_content": "Authenticating a user, or otherwise establishing a new user session, without invalidating any existing session identifier gives an attacker the opportunity to steal authenticated sessions.",
        "keyphrase_source": "rootcause:reuse of TOTP tokens multiple times",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This is a well-known Composite of multiple weaknesses that must all occur simultaneously, although it is attack-oriented in nature.",
          "comments": "While attack-oriented composites are supported in CWE, they have not been a focus of research. There is a chance that future research or CWE scope clarifications will change or deprecate them. Perform root-cause analysis to determine which weaknesses allow session fixation to occur, and map to those weaknesses. For example, predictable session identifiers might enable session fixation attacks to succeed; if this occurs, they might be better characterized as randomness/predictability weaknesses.",
          "reasons": [
            "Other"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.4919585352953943,
            "graph": 1.5575069657210205
          }
        }
      },
      "similarity": 0.4919585352953943
    },
    {
      "doc_id": "309",
      "text": "CWE-309: Use of Password System for Primary Authentication",
      "score": 2.1762,
      "metadata": {
        "doc_id": "309",
        "name": "Use of Password System for Primary Authentication",
        "type": "base",
        "original_content": "CWE-309: Use of Password System for Primary Authentication",
        "relationships": [
          {
            "source_id": "309",
            "target_id": "308",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "309",
            "target_id": "654",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "309",
            "target_id": "1390",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "654",
            "target_id": "309",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "308",
            "target_id": "309",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "262",
            "target_id": "309",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1390",
            "target_id": "309",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 0.7,
          "abstraction_path": 0.7200000000000001,
          "peer_group": 0.9
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "308",
                  "309",
                  "PEEROF"
                ]
              ],
              "score": 0.7,
              "type": "relationship_chain",
              "source": "308"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "1390",
                  "309",
                  "PARENTOF"
                ]
              ],
              "score": 0.7200000000000001,
              "type": "abstraction_path_down",
              "source": "1390"
            },
            "peer_relationship": {
              "path": [
                [
                  "308",
                  "309",
                  "PEEROF"
                ]
              ],
              "score": 0.9,
              "type": "peer_relationship",
              "source": "308"
            }
          }
        },
        "abstraction_level": "base",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.1762
          }
        }
      },
      "similarity": 2.1762
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-1390",
      "CWE-288",
      "CWE-330",
      "CWE-613",
      "CWE-472",
      "CWE-294",
      "CWE-208",
      "CWE-303",
      "CWE-1391",
      "CWE-287",
      "CWE-307"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}