# Vulnerability Information: CVE-2024-42943

## Vulnerability Description
Tenda FH1201 v1.2.0.14 (408) was discovered to contain a **stack overflow** via the PPPOEPassword parameter in the fromAdvSetWan function. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted POST request.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted POST request
- **attacker:** attackers
- **product:** Tenda FH1201
- **version:** v1.2.0.14 (408)
- **component:** fromAdvSetWan function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 147)
- CWE-120 (Count: 4)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
- A stack-based buffer overflow exists in the `decodePwd` function of the Tenda FH1201 router firmware.

**Weaknesses/Vulnerabilities:**
- The `decodePwd` function copies data from a source buffer to a destination buffer without proper bounds checking.
- The size of the destination buffer is fixed (v52 array), while the size of the source buffer (PPPOEPassword) is controlled by the user.
- When the user-supplied `PPPOEPassword` is larger than the destination buffer `v52`, it overwrites adjacent memory on the stack.

**Impact of Exploitation:**
- A successful exploit allows an attacker to overwrite stack memory, which could lead to:
    - Denial of Service (DoS) by crashing the device.
    - Remote Code Execution (RCE) by overwriting return addresses on the stack with attacker controlled addresses.

**Attack Vectors:**
- The vulnerability can be triggered by sending a crafted POST request to the `/goform/AdvSetWan` endpoint.
- The POST request must include the "wanmode" parameter set to "2", and a "PPPOEPassword" parameter containing the overflow payload.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send HTTP requests to the vulnerable router. This could be from the local network or, depending on the router configuration, potentially from the internet.
- The attacker needs to know the vulnerable endpoint and the required parameters to trigger the vulnerable code path.

**Additional Notes:**
- The content provides a Proof-of-Concept (PoC) exploit script that demonstrates how to trigger the buffer overflow.
- The content also includes the disassembly of the vulnerable `decodePwd` function, which helps understand the vulnerability.
- The vulnerability is located in the Tenda FH1201 Firmware V1.2.0.14(408).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.241 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.219 |
| 5 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.218 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.218 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.216 |
| 8 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.216 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.575 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.002 |

