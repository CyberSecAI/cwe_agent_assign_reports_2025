{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved usb dwc3 core remove lock of otg mode during gadget suspend/resume to avoid deadlock When config CONFIG_USB_DWC3_DUAL_ROLE is selected, and trigger system to enter suspend status with below command echo mem > /sys/power/state There will be a deadlock issue occurring. Detailed invoking path as below dwc3_suspend_common() spin_lock_irqsave(&dwc->lock, flags) lock, flags) gadget_driver is NULL or not. It causes the following code is executed and deadlock occurs when trying to get the spinlock. In fact, the root cause is the commit 5265397f9442(usb dwc3 Remove DWC3 locking during gadget suspend/resume) that forgot to remove the lock of otg mode. So, remove the redundant lock of otg mode during gadget suspend/resume.",
  "keyphrases": {
    "rootcause": [
      "Remove DWC3 locking during gadget suspend",
      "resume"
    ],
    "weakness": [
      "deadlock"
    ]
  },
  "timestamp": "2025-07-13 13:43:38",
  "cve_id": "CVE-2024-42085",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 665.3417029942195,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 649.9515966130442,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "476",
      "name": "NULL Pointer Dereference",
      "score": 531.1604042503056,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 522.3685662100652,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "score": 518.5332091272098,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "score": 517.1231416376146,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 510.6193424678346,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "score": 496.83652682813374,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "732",
      "name": "Incorrect Permission Assignment for Critical Resource",
      "score": 489.30909049550905,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 486.673256200885,
      "search_source": "rootcause:Remove DWC3 locking during gadget suspend"
    },
    {
      "cwe_id": "451",
      "name": "User Interface (UI) Misrepresentation of Critical Information",
      "score": 479.4894860435236,
      "search_source": "rootcause:resume"
    }
  ]
}