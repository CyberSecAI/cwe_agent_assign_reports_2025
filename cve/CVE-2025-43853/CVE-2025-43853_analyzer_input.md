# Vulnerability Information: CVE-2025-43853

## Vulnerability Description
The WebAssembly Micro Runtimes (WAMR) iwasm package is the executable binary built with WAMR VMcore which supports WebAssembly System Interface (WASI) and command line interface. Anyone running WAMR up to and including version 2.2.0 or WAMR built with libc-uvwasi on Windows is affected by a **symlink following vulnerability**. On WAMR running in Windows, creating a symlink pointing outside of the preopened directory and subsequently opening it with create flag will create a file on host outside of the sandbox. If the symlink points to an existing host file, its also possible to open it and read its content. Version 2.3.0 fixes the issue.

### Vulnerability Description Key Phrases
- **rootcause:** **symlink following vulnerability**
- **impact:** read host file
- **vector:** creating a symlink pointing outside of the preopened directory
- **product:** WAMR
- **version:** up to and including version 2.2.0
- **component:** iwasm package

## CVE Reference Links Content Summary
## Analysis of CVE-2025-43853 based on provided content

The provided content is relevant to CVE-2025-43853. It details a filesystem sandbox escape vulnerability in wasm-micro-runtime. Here's a breakdown of the information extracted:

**Root cause of vulnerability:**

Creating a symlink pointing outside of the preopened directory and subsequently opening it with the create flag allows a file to be created on the host outside of the sandbox. If the symlink points to an existing host file, it's also possible to open and read its content. The uvwasi implementation doesn't properly validate the symlink path.

**Weaknesses/vulnerabilities present:**

*   Filesystem sandbox escape
*   Improper symlink handling in uvwasi
*   Lack of validation of symlink paths

**Impact of exploitation:**

Untrusted Wasm modules can access the host filesystem, potentially leading to arbitrary code execution or data theft.

**Attack vectors:**

*   A malicious Wasm module can create symlinks pointing outside the sandbox.
*   The module can then open these symlinks to create or read files on the host system.

**Required attacker capabilities/position:**

*   The attacker needs to be able to execute a Wasm module within the wasm-micro-runtime environment.
*   No specific privileges are required within the host system.

**Mitigation or fix:**

*   Upgrade to version 2.3.0 or later of iwasm.
*   The commit 28702ed addresses the issue by updating libuv and uvwasi versions and adding a workaround to check if the old path is valid before creating the symlink.
*   The commit also adds a warning about the limitations of uvwasi's filesystem security properties.

**Additional Details (more than official CVE description):**

*   The vulnerability is specific to Windows.
*   A Proof-of-Concept (PoC) is provided in Rust using the `wasi` crate.
*   The PoC demonstrates creating a symlink and then opening it to create a file outside the sandbox and read an existing file.
*   CVSS v4 score is 7.0/10.
*   The vulnerability is related to the uvwasi feature and the use of libuv.
*   The commit updates libuv to v1.51.0 and uvwasi to v0.0.21.
*   The commit adds a warning that uvwasi does not currently provide comprehensive filesystem security properties.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | alternate_terms | 0.800 |
| 2 | 64 | Windows Shortcut Following (.LNK) | Variant | Allowed | alternate_terms | 0.800 |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.710 |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.584 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.549 |
| 6 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.545 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.542 |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.540 |
| 9 | 65 | Windows Hard Link | Variant | Allowed | dense | 0.488 |
| 10 | 363 | Race Condition Enabling Link Following | Base | Allowed | graph | 0.003 |

