# Vulnerability Information: CVE-2024-39770

## Vulnerability Description
**Multiple buffer overflow vulnerabilities** exist in the internet.cgi set_qos() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to stack-based buffer overflow. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.This vulnerability exists in the `en_enable` POST parameter.

### Vulnerability Description Key Phrases
- **component:** internet.cgi set_qos() functionality
- **rootcause:** **Multiple buffer overflow vulnerabilities**
- **vector:** specially crafted HTTP request
- **weakness:** **stack-based buffer overflow, buffer overflow**
- **product:** Wavlink AC3000
- **attacker:** attacker
- **version:** M33A8.V5030.210505

## CVE Reference Links Content Summary
## Analysis of CVE-2024-39770 based on provided content:

This content is directly related to CVE-2024-39770, as it is listed among the CVE numbers addressed in the Talos Vulnerability Report TALOS-2024-2022. The report provides significantly more detail than the placeholder CVE description.

**Root cause of vulnerability:**

The vulnerabilities stem from insufficient input validation when handling HTTP POST requests to the `internet.cgi` script, specifically within the `set_qos()` function. The script uses `strcat` to concatenate user-supplied data (`cli_name`, `cli_mac`, `en_enable`) into a fixed-size stack buffer (`buf_0x424`) without checking the length of the input.

**Weaknesses/vulnerabilities present:**

*   **CWE-120 - Buffer Copy without Checking Size of Input (‘Classic Buffer Overflow’):** This is the core vulnerability.
*   Stack-based buffer overflow vulnerabilities in the `cli_name`, `cli_mac`, and `en_enable` parameters of the `set_qos()` function.

**Impact of exploitation:**

Successful exploitation allows an attacker to overwrite the return address of the function, leading to arbitrary code execution.

**Attack vectors:**

*   An authenticated attacker can send a specially crafted HTTP POST request to the `internet.cgi` script with malicious data in the `cli_name`, `cli_mac`, or `en_enable` parameters.
*   The attacker needs network access to the vulnerable device.

**Required attacker capabilities/position:**

*   The attacker needs to be authenticated to the Wavlink AC3000 router (have valid session cookie).
*   Knowledge of the vulnerable parameters and the buffer overflow vulnerability.

**Mitigation or fix:**

The report does not explicitly state a fix. However, the root cause indicates that proper input validation and bounds checking are required to prevent the buffer overflows. The vendor was working on patches at the time of the report's release, but the product has been discontinued.

**Confirmed Vulnerable Versions:**

*   Wavlink AC3000 M33A8.V5030.210505

**CVSSv3 Score:**

*   9.1 - CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.369 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.346 |
| 6 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.333 |
| 7 | 129 | Improper Validation of Array Index | Variant | Allowed | sparse | 0.323 |
| 8 | 195 | Signed to Unsigned Conversion Error | Variant | Allowed | sparse | 0.321 |
| 9 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | dense | 0.626 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

