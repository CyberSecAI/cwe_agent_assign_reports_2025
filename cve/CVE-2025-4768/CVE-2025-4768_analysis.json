{
  "cve_id": "CVE-2025-4768",
  "description": "A vulnerability classified as critical has been found in feng_ha_ha/megagao ssm-erp and production_ssm 1.0. This affects the function uploadPicture of the file PictureServiceImpl.java. The manipulation of the argument File leads to **unrestricted upload**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. This product is distributed under two entirely different names.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "unrestricted upload",
    "impact": "",
    "vector": "manipulation of File argument",
    "attacker": "",
    "product": "feng_ha_ha/megagao ssm-erp and production_ssm",
    "version": "1",
    "component": "uploadPicture in PictureServiceImpl.java"
  },
  "reference_content": "## Analysis of CVE-2025-4768 Content\n\nBased on the provided content, this report details a Remote Code Execution (RCE) vulnerability in the `production_ssm` project (versions available on GitHub and Gitee).\n\n**Root cause of vulnerability:**\n\nThe vulnerability stems from insufficient file validation in the picture upload functionality. Specifically, the `PictureServiceImpl.java` file does not filter or process the file name, allowing the upload of malicious script files (JSP packages).\n\n**Weaknesses/vulnerabilities present:**\n\n*   **Unrestricted File Upload:** The application allows uploading files without proper validation of their type or content.\n*   **Lack of Input Validation:** The file name is directly concatenated with the save path without sanitization.\n*   **Remote Code Execution (RCE):** Successful exploitation allows an attacker to execute arbitrary code on the server.\n\n**Impact of exploitation:**\n\nAn attacker can achieve arbitrary code execution on the server hosting the `production_ssm` application.\n\n**Attack vectors:**\n\n1.  Install and configure the application.\n2.  Access the `/pic/upload` route.\n3.  Upload a malicious JSP package.\n4.  Access the path of the uploaded malicious plugin to execute arbitrary commands.\n\n**Required attacker capabilities/position:**\n\nThe attacker needs to be able to access the `/pic/upload` endpoint of the application. No authentication is explicitly mentioned as a requirement in the provided content.\n\n**Mitigation or fix:**\n\nThe suggested mitigation is to implement a whitelist for allowed file suffixes during the upload process. This would prevent the upload of potentially malicious script files.\n\n**Additional Details (compared to a hypothetical CVE description):**\n\nThe provided content offers significantly more detail than a standard CVE description would. It includes:\n\n*   Specific file names and classes involved (`PictureServiceImpl.java`, `PictureController.java`).\n*   Detailed steps for reproduction.\n*   Screenshots illustrating the vulnerability and exploitation process.\n*   Links to the affected repositories on GitHub and Gitee.\n*   Specific code locations.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n\n| CWE ID  | CWE Name                                                                                    | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :------------------------------------------------------------------------------------------ | :--------- | :-------------------- | :------------------------------ | :-------------------------------- |\n| CWE-434 | Unrestricted Upload of File with Dangerous Type | 1          | Base                  | Allowed                       | Primary CWE                     |\n| CWE-434 | Unrestricted Upload of File with Dangerous Type | 0.75       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-73  | External Control of File Name or Path                                                        | 0.60       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-98  | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')         | 0.50       | Variant                | Allowed                       | Secondary Candidate             |\n| CWE-22  | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')                                                        | 0.50       | Base                  | Allowed                       | Secondary Candidate             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\n\nThe primary weakness is **unrestricted upload**, which directly corresponds to CWE-434. CWE-73 is related because the file name or path is externally controlled, which is a prerequisite for CWE-434. CWE-98 (PHP Remote File Inclusion) and CWE-22 (Path Traversal) are possible consequences or related weaknesses that can occur if the uploaded file is mishandled or if path traversal is possible. However, the provided information focuses on the unrestricted upload itself, making CWE-434 the most direct and relevant classification.\n\n```mermaid\ngraph TD\n    cwe434[\"CWE-434: Unrestricted Upload of File with Dangerous Type\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    cwe98[\"CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n\n    cwe434 -->|CANFOLLOW| cwe73\n    cwe73 -->|CANPRECEDE| cwe434\n    cwe98 -->|CANFOLLOW| cwe73\n    cwe22 -->|CANFOLLOW| cwe73\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe434 primary\n    class cwe73,cwe98,cwe22 secondary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with the **unrestricted upload** (CWE-434), where the application fails to validate file types or content. This can lead to the attacker uploading a malicious file. If the file name or path is externally controlled (CWE-73), it can further enable the attacker to execute arbitrary code on the server. This may also lead to Path Traversal (CWE-22) or PHP Remote File Inclusion (CWE-98) if the application improperly handles the uploaded file.\n\n## Summary of Analysis\n\nThe primary focus is on the **unrestricted upload** of dangerous file types, making CWE-434 the most appropriate primary classification. The evidence clearly indicates that the application lacks proper validation of uploaded files, allowing for the potential upload of malicious files.\n\nThe vulnerability description includes the key phrase \"**unrestricted upload**\" and the analysis of CVE-2025-4768 confirms \"**Unrestricted File Upload:** The application allows uploading files without proper validation of their type or content.\". The suggested mitigation of implementing a whitelist for allowed file suffixes during upload further supports this classification.\n\nOther CWEs were considered but ultimately deemed less relevant as the primary weakness. While CWE-73 (External Control of File Name or Path), CWE-98, and CWE-22 could be involved, they are secondary to the initial **unrestricted upload** issue.\n\nThe selected CWE is at the optimal level of specificity, representing the core weakness in the application.\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-434: Unrestricted Upload of File with Dangerous Type\n**Abstraction Level**: Base\n**Similarity Score**: 0.82\n**Source**: dense\n\n**Description**:\nThe product allows the upload or transfer of dangerous file types that are automatically processed within its environment.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-425: Direct Request ('Forced Browsing')\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-73: External Control of File Name or Path\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product allows user input to control or influence paths or file names that are used in filesystem operations.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-552: Files or Directories Accessible to External Parties\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product makes files or directories accessible to unauthorized actors, even though they should not be.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-116: Improper Encoding or Escaping of Output\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product prepares a structured message for communication with another component, but encoding or escaping of the data is either missing or done incorrectly. As a result, the intended structure of the message is not preserved.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.\n\n\n\n## CWE-23: Relative Path Traversal\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as \"..\" that can resolve to a location that is outside of that directory.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product places sensitive information into files or directories that are accessible to actors who are allowed to have access to the files, but not to the sensitive information.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-472: External Control of Assumed-Immutable Web Parameter\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe web application does not",
  "analysis_with_relationships": "# Summary\n\n| CWE ID  | CWE Name                                                                                    | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :------------------------------------------------------------------------------------------ | :--------- | :-------------------- | :------------------------------ | :-------------------------------- |\n| CWE-434 | Unrestricted Upload of File with Dangerous Type | 1          | Base                  | Allowed                       | Primary CWE                     |\n| CWE-434 | Unrestricted Upload of File with Dangerous Type | 0.75       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-73  | External Control of File Name or Path                                                        | 0.60       | Base                  | Allowed                       | Secondary Candidate             |\n| CWE-98  | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')         | 0.50       | Variant                | Allowed                       | Secondary Candidate             |\n| CWE-22  | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')                                                        | 0.50       | Base                  | Allowed                       | Secondary Candidate             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\n\nThe primary weakness is **unrestricted upload**, which directly corresponds to CWE-434. CWE-73 is related because the file name or path is externally controlled, which is a prerequisite for CWE-434. CWE-98 (PHP Remote File Inclusion) and CWE-22 (Path Traversal) are possible consequences or related weaknesses that can occur if the uploaded file is mishandled or if path traversal is possible. However, the provided information focuses on the unrestricted upload itself, making CWE-434 the most direct and relevant classification.\n\n```mermaid\ngraph TD\n    cwe434[\"CWE-434: Unrestricted Upload of File with Dangerous Type\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    cwe98[\"CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n\n    cwe434 -->|CANFOLLOW| cwe73\n    cwe73 -->|CANPRECEDE| cwe434\n    cwe98 -->|CANFOLLOW| cwe73\n    cwe22 -->|CANFOLLOW| cwe73\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe434 primary\n    class cwe73,cwe98,cwe22 secondary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with the **unrestricted upload** (CWE-434), where the application fails to validate file types or content. This can lead to the attacker uploading a malicious file. If the file name or path is externally controlled (CWE-73), it can further enable the attacker to execute arbitrary code on the server. This may also lead to Path Traversal (CWE-22) or PHP Remote File Inclusion (CWE-98) if the application improperly handles the uploaded file.\n\n## Summary of Analysis\n\nThe primary focus is on the **unrestricted upload** of dangerous file types, making CWE-434 the most appropriate primary classification. The evidence clearly indicates that the application lacks proper validation of uploaded files, allowing for the potential upload of malicious files.\n\nThe vulnerability description includes the key phrase \"**unrestricted upload**\" and the analysis of CVE-2025-4768 confirms \"**Unrestricted File Upload:** The application allows uploading files without proper validation of their type or content.\". The suggested mitigation of implementing a whitelist for allowed file suffixes during upload further supports this classification.\n\nOther CWEs were considered but ultimately deemed less relevant as the primary weakness. While CWE-73 (External Control of File Name or Path), CWE-98, and CWE-22 could be involved, they are secondary to the initial **unrestricted upload** issue.\n\nThe selected CWE is at the optimal level of specificity, representing the core weakness in the application.\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-434: Unrestricted Upload of File with Dangerous Type\n**Abstraction Level**: Base\n**Similarity Score**: 0.82\n**Source**: dense\n\n**Description**:\nThe product allows the upload or transfer of dangerous file types that are automatically processed within its environment.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-425: Direct Request ('Forced Browsing')\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-73: External Control of File Name or Path\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product allows user input to control or influence paths or file names that are used in filesystem operations.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-552: Files or Directories Accessible to External Parties\n**Abstraction Level**: Base\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product makes files or directories accessible to unauthorized actors, even though they should not be.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-116: Improper Encoding or Escaping of Output\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product prepares a structured message for communication with another component, but encoding or escaping of the data is either missing or done incorrectly. As a result, the intended structure of the message is not preserved.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.\n\n\n\n## CWE-23: Relative Path Traversal\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as \"..\" that can resolve to a location that is outside of that directory.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product places sensitive information into files or directories that are accessible to actors who are allowed to have access to the files, but not to the sensitive information.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-472: External Control of Assumed-Immutable Web Parameter\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe web application does not\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-116:**\n- 116 (Improper Encoding or Escaping of Output) - ROOT\n\n\n**Chain starting from CWE-22:**\n- 22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "source": "sparse"
      },
      "similarity": 425.0197825425244
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse"
      },
      "similarity": 403.87033195795374
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 403.22452323304844
    },
    {
      "metadata": {
        "doc_id": "1391",
        "name": "Use of Weak Credentials",
        "source": "sparse"
      },
      "similarity": 355.24573727658
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 346.5541563956587
    },
    {
      "metadata": {
        "doc_id": "427",
        "name": "Uncontrolled Search Path Element",
        "source": "sparse"
      },
      "similarity": 345.6562963074924
    },
    {
      "metadata": {
        "doc_id": "1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "source": "sparse"
      },
      "similarity": 342.542745826431
    },
    {
      "metadata": {
        "doc_id": "99",
        "name": "Improper Control of Resource Identifiers ('Resource Injection')",
        "source": "sparse"
      },
      "similarity": 342.35994646148237
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "type": "Class",
        "original_content": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Discouraged",
          "rationale": "CWE-200 is commonly misused to represent the loss of confidentiality in a vulnerability, but confidentiality loss is a technical impact - not a root cause error. As of CWE 4.9, over 400 CWE entries can lead to a loss of confidentiality. Other options are often available. [REF-1287].",
          "comments": "If an error or mistake causes information to be disclosed, then use the CWE ID for that error. Consider starting with improper authorization (CWE-285), insecure permissions (CWE-732), improper authentication (CWE-287), etc. Also consider children such as Insertion of Sensitive Information Into Sent Data (CWE-201), Observable Discrepancy (CWE-203), Insertion of Sensitive Information into Externally-Accessible File or Directory (CWE-538), or others.",
          "reasons": [
            "Frequent Misuse"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5703747193371622
          }
        }
      },
      "similarity": 0.5703747193371622
    },
    {
      "doc_id": "22",
      "text": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
      "score": 0.5784052550238649,
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "type": "Base",
        "extended_description": "\n\nMany file operations are intended to take place within a restricted directory. By using special elements such as \"..\" and \"/\" separators, attackers can escape outside of the restricted location to access files or directories that are elsewhere on the system. One of the most common special elements is the \"../\" sequence, which in most modern operating systems is interpreted as the parent directory of the current location. This is referred to as relative path traversal. Path traversal also covers the use of absolute pathnames such as \"/usr/local/bin\" to access unexpected files. This is referred to as absolute path traversal.\n",
        "alternate_terms": [
          "Directory traversal",
          "Path traversal"
        ],
        "original_content": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
        "relationships": [
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "36",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "23",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "20",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "172",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "668",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "706",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "22",
            "target_id": "706",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "706",
            "target_id": "22",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "668",
            "target_id": "22",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "36",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1340"
            }
          },
          {
            "source_id": "36",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          },
          {
            "source_id": "36",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "23",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1340"
            }
          },
          {
            "source_id": "23",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          },
          {
            "source_id": "23",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "172",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "source": "graph",
        "sources": [
          "vector",
          "graph"
        ],
        "vector_score": 0.5784052550238649,
        "graph_score": 3.653,
        "score_components": {
          "relationship_chain": 0.6,
          "explicit_mention": 1.0,
          "abstraction_path": 0.9,
          "sequence_path": 0.8
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "89",
                  "74",
                  "CHILDOF"
                ],
                [
                  "74",
                  "20",
                  "CANFOLLOW"
                ],
                [
                  "20",
                  "22",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.6,
              "type": "relationship_chain",
              "source": "89"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "434",
                  "73",
                  "CANFOLLOW"
                ],
                [
                  "73",
                  "22",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.8,
              "type": "vulnerability_sequence_forward",
              "source": "434"
            }
          }
        },
        "is_explicit": true,
        "abstraction_level": "base",
        "position": "after",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "retriever_count": 3,
          "normalized_scores": {
            "dense": 0.5454598872374233,
            "sparse": 340.12422841298206,
            "graph": 2.4231621020095457
          }
        }
      },
      "similarity": 2.4231621020095457
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-116",
      "CWE-22",
      "CWE-73",
      "CWE-98",
      "CWE-472",
      "CWE-552",
      "CWE-538",
      "CWE-74",
      "CWE-497",
      "CWE-23",
      "CWE-425",
      "CWE-434"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}