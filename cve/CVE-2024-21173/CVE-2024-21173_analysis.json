{
  "cve_id": "CVE-2024-21173",
  "description": "Vulnerability in the MySQL Server product of Oracle MySQL (component InnoDB). Supported versions that are affected are 8.0.37 and prior and 8.4.0 and prior. Easily exploitable vulnerability allows high privileged attacker with network access via multiple protocols to compromise MySQL Server. Successful attacks of this vulnerability can result in unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of MySQL Server. CVSS 3.1 Base Score 4.9 (Availability impacts). CVSS Vector (CVSS3.1/AVN/ACL/PRH/UIN/SU/CN/IN/AH).",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": [
      "cause a hang or frequently repeatable crash",
      "hang or frequently repeatable crash (complete DOS)"
    ],
    "vector": "multiple protocols",
    "attacker": "high privileged attacker with network access",
    "product": "MySQL Server",
    "version": "8.0.37 and prior and 8.4.0 and prior",
    "component": "InnoDB"
  },
  "reference_content": "```\n{\n  \"vulnerability_details\": [\n    {\n      \"cve_id\": \"CVE-2024-21173\",\n      \"products\": [\n        \"MySQL Server\"\n      ],\n      \"affected_versions\": [\n        \"8.0.37 and prior\",\n        \"8.4.0 and prior\"\n      ],\n        \"component\": \"InnoDB\",\n        \"protocol\": \"MySQL Protocol\",\n        \"exploit_type\": \"non-remote\",\n        \"cvss_v3_1_risk\": \"4.9\",\n      \"attack_vector\": \"Network\",\n        \"attack_complexity\": \"Low\",\n        \"privileges_required\": \"None\",\n        \"user_interaction\": \"None\",\n        \"scope\": \"Unchanged\",\n        \"confidentiality_impact\": \"None\",\n        \"integrity_impact\": \"None\",\n        \"availability_impact\": \"High\",\n      \"root_cause\": \"An unspecified vulnerability exists in the InnoDB component.\",\n      \"weaknesses\": [\n        \"Improper access control\"\n      ],\n      \"impact\": \"Successful exploitation can lead to a denial of service\",\n      \"attack_vectors\": [\n          \"Network\"\n      ],\n      \"attacker_capabilities\": \"The attacker must have network access to the MySQL server.\",\n        \"notes\": \"The vulnerability is not remotely exploitable without authentication.\"\n    }\n  ]\n}\n```",
  "similar_info": {
    "cwe_distribution": {
      "95": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 416
        },
        "total_samples": 419,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 416,
            "proportion": 0.993
          },
          {
            "cwes": [],
            "frequency": 3,
            "proportion": 0.007
          }
        ]
      },
      "90": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 219,
          "CWE-191": 1
        },
        "total_samples": 225,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 219,
            "proportion": 0.973
          },
          {
            "cwes": [],
            "frequency": 5,
            "proportion": 0.022
          },
          {
            "cwes": [
              "CWE-191"
            ],
            "frequency": 1,
            "proportion": 0.004
          }
        ]
      },
      "85": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 669,
          "CWE-191": 1
        },
        "total_samples": 678,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 669,
            "proportion": 0.987
          },
          {
            "cwes": [],
            "frequency": 8,
            "proportion": 0.012
          },
          {
            "cwes": [
              "CWE-191"
            ],
            "frequency": 1,
            "proportion": 0.001
          }
        ]
      },
      "80": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 193,
          "CWE-191": 1
        },
        "total_samples": 195,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 193,
            "proportion": 0.99
          },
          {
            "cwes": [],
            "frequency": 1,
            "proportion": 0.005
          },
          {
            "cwes": [
              "CWE-191"
            ],
            "frequency": 1,
            "proportion": 0.005
          }
        ]
      },
      "75": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 267
        },
        "total_samples": 267,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 267,
            "proportion": 1.0
          }
        ]
      },
      "70": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 113,
          "CWE-191": 1
        },
        "total_samples": 115,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 113,
            "proportion": 0.983
          },
          {
            "cwes": [
              "CWE-191"
            ],
            "frequency": 1,
            "proportion": 0.009
          },
          {
            "cwes": [],
            "frequency": 1,
            "proportion": 0.009
          }
        ]
      }
    },
    "cwe_consensus": "CWE-NVD-noinfo",
    "similarity_stats": {
      "thresholds": [
        95,
        90,
        85,
        80,
        75,
        70
      ],
      "total_samples_by_threshold": {
        "95": 419,
        "90": 225,
        "85": 678,
        "80": 195,
        "75": 267,
        "70": 115
      },
      "top_cwes_by_threshold": {
        "95": [
          [
            "CWE-NVD-noinfo",
            416
          ]
        ],
        "90": [
          [
            "CWE-NVD-noinfo",
            219
          ],
          [
            "CWE-191",
            1
          ]
        ],
        "85": [
          [
            "CWE-NVD-noinfo",
            669
          ],
          [
            "CWE-191",
            1
          ]
        ],
        "80": [
          [
            "CWE-NVD-noinfo",
            193
          ],
          [
            "CWE-191",
            1
          ]
        ],
        "75": [
          [
            "CWE-NVD-noinfo",
            267
          ]
        ],
        "70": [
          [
            "CWE-NVD-noinfo",
            113
          ],
          [
            "CWE-191",
            1
          ]
        ]
      }
    },
    "raw_matches": [
      {
        "similarity": 95,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 419,
        "frequency": 416,
        "proportion": 0.993
      },
      {
        "similarity": 95,
        "cwes": [],
        "total": 419,
        "frequency": 3,
        "proportion": 0.007
      },
      {
        "similarity": 90,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 225,
        "frequency": 219,
        "proportion": 0.973
      },
      {
        "similarity": 90,
        "cwes": [],
        "total": 225,
        "frequency": 5,
        "proportion": 0.022
      },
      {
        "similarity": 90,
        "cwes": [
          "191"
        ],
        "total": 225,
        "frequency": 1,
        "proportion": 0.004
      },
      {
        "similarity": 85,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 678,
        "frequency": 669,
        "proportion": 0.987
      },
      {
        "similarity": 85,
        "cwes": [],
        "total": 678,
        "frequency": 8,
        "proportion": 0.012
      },
      {
        "similarity": 85,
        "cwes": [
          "191"
        ],
        "total": 678,
        "frequency": 1,
        "proportion": 0.001
      },
      {
        "similarity": 80,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 195,
        "frequency": 193,
        "proportion": 0.99
      },
      {
        "similarity": 80,
        "cwes": [],
        "total": 195,
        "frequency": 1,
        "proportion": 0.005
      },
      {
        "similarity": 80,
        "cwes": [
          "191"
        ],
        "total": 195,
        "frequency": 1,
        "proportion": 0.005
      },
      {
        "similarity": 75,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 267,
        "frequency": 267,
        "proportion": 1.0
      },
      {
        "similarity": 70,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 115,
        "frequency": 113,
        "proportion": 0.983
      },
      {
        "similarity": 70,
        "cwes": [
          "191"
        ],
        "total": 115,
        "frequency": 1,
        "proportion": 0.009
      },
      {
        "similarity": 70,
        "cwes": [],
        "total": 115,
        "frequency": 1,
        "proportion": 0.009
      }
    ]
  },
  "similarity_summary": {
    "consensus_cwe": "CWE-NVD-noinfo",
    "top_cwes": [
      [
        "CWE-NVD-noinfo",
        1877
      ],
      [
        "CWE-191",
        4
      ]
    ],
    "confidence_levels": {
      "high": [],
      "medium": [],
      "low": []
    },
    "total_samples": 1899
  },
  "analysis": "# Summary\n| CWE ID        | CWE Name                                                                                                     | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| ------------- | ------------------------------------------------------------------------------------------------------------- | ---------- | ----------------------- | ------------------------------- | ------------------------------- |\n| CWE-770       | Allocation of Resources Without Limits or Throttling                                                          | 0.75       | Base                    | Primary CWE                     | Allowed                         |\n| CWE-400       | Uncontrolled Resource Consumption                                                                                       | 0.65       | Class                    | Secondary Candidate                    | Allowed-with-Review                         |\n| CWE-NVD-noinfo | NVD Analyzed Data, no information available                                                                    | 0.50       | -                      | Secondary Candidate                     | -                             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.70\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE is CWE-770, which is a base-level CWE and a child of CWE-400.\nCWE-400 is a class-level CWE representing uncontrolled resource consumption and related to the DoS vulnerability due to resource allocation issues.\nCWE-NVD-noinfo is included as the vulnerability report itself provides minimal information and depends on external sources to be fully understood.\n\n```mermaid\ngraph TD\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    cwe_noinfo[\"CWE-NVD-noinfo: NVD Analyzed Data, no information available\"]\n    \n    cwe770 -->|CHILDOF| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe770 primary\n    class cwe400,cwe_noinfo secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **uncontrolled allocation of resources**, leading to excessive resource consumption and ultimately a denial-of-service condition.\nCWE-770 (Root Cause) -> Excessive resource allocation -> Resource Exhaustion -> CWE-400 (Impact: Denial of Service)\n\n## Summary of Analysis\nThe analysis focuses on the root cause and impact of the vulnerability, which is a denial of service due to **uncontrolled resource allocation**.\nThe primary CWE, CWE-770, accurately represents the root cause, while CWE-400 represents the impact.\n\nThe vulnerability description indicates that successful attacks can result in a hang or frequently repeatable crash of the MySQL Server, leading to a complete denial of service. The CVE Reference Links Content Summary states, \"Successful exploitation can lead to a denial of service\".\n\nCWE-770 (Allocation of Resources Without Limits or Throttling) is selected as the primary CWE because it directly addresses the **uncontrolled allocation of resources**, which is the root cause of the denial-of-service vulnerability. This aligns with the vulnerability description and the provided evidence.\n\nCWE-400 (Uncontrolled Resource Consumption) is included to represent the denial-of-service impact.\n\nCWE-NVD-noinfo is included because the initial description lacks specific technical details.\n\nThe retriever results offered several potential CWEs, but most were rejected as less relevant than CWE-770. For example:\n\n*   CWE-129 (Improper Validation of Array Index) was considered, but it does not directly relate to the resource allocation issue described in the vulnerability.\n*   CWE-89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) was not selected because the vulnerability is not related to SQL injection.\n*   CWE-20 (Improper Input Validation) was not selected because it is too general and a more specific CWE (CWE-770) is available.\n\nRelevant CWE Information:\n```\nCWE-770: Allocation of Resources Without Limits or Throttling\nThe product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.\n```",
  "analysis_with_relationships": "# Summary\n| CWE ID        | CWE Name                                                                                                     | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| ------------- | ------------------------------------------------------------------------------------------------------------- | ---------- | ----------------------- | ------------------------------- | ------------------------------- |\n| CWE-770       | Allocation of Resources Without Limits or Throttling                                                          | 0.75       | Base                    | Primary CWE                     | Allowed                         |\n| CWE-400       | Uncontrolled Resource Consumption                                                                                       | 0.65       | Class                    | Secondary Candidate                    | Allowed-with-Review                         |\n| CWE-NVD-noinfo | NVD Analyzed Data, no information available                                                                    | 0.50       | -                      | Secondary Candidate                     | -                             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.70\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE is CWE-770, which is a base-level CWE and a child of CWE-400.\nCWE-400 is a class-level CWE representing uncontrolled resource consumption and related to the DoS vulnerability due to resource allocation issues.\nCWE-NVD-noinfo is included as the vulnerability report itself provides minimal information and depends on external sources to be fully understood.\n\n```mermaid\ngraph TD\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    cwe_noinfo[\"CWE-NVD-noinfo: NVD Analyzed Data, no information available\"]\n    \n    cwe770 -->|CHILDOF| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe770 primary\n    class cwe400,cwe_noinfo secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **uncontrolled allocation of resources**, leading to excessive resource consumption and ultimately a denial-of-service condition.\nCWE-770 (Root Cause) -> Excessive resource allocation -> Resource Exhaustion -> CWE-400 (Impact: Denial of Service)\n\n## Summary of Analysis\nThe analysis focuses on the root cause and impact of the vulnerability, which is a denial of service due to **uncontrolled resource allocation**.\nThe primary CWE, CWE-770, accurately represents the root cause, while CWE-400 represents the impact.\n\nThe vulnerability description indicates that successful attacks can result in a hang or frequently repeatable crash of the MySQL Server, leading to a complete denial of service. The CVE Reference Links Content Summary states, \"Successful exploitation can lead to a denial of service\".\n\nCWE-770 (Allocation of Resources Without Limits or Throttling) is selected as the primary CWE because it directly addresses the **uncontrolled allocation of resources**, which is the root cause of the denial-of-service vulnerability. This aligns with the vulnerability description and the provided evidence.\n\nCWE-400 (Uncontrolled Resource Consumption) is included to represent the denial-of-service impact.\n\nCWE-NVD-noinfo is included because the initial description lacks specific technical details.\n\nThe retriever results offered several potential CWEs, but most were rejected as less relevant than CWE-770. For example:\n\n*   CWE-129 (Improper Validation of Array Index) was considered, but it does not directly relate to the resource allocation issue described in the vulnerability.\n*   CWE-89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) was not selected because the vulnerability is not related to SQL injection.\n*   CWE-20 (Improper Input Validation) was not selected because it is too general and a more specific CWE (CWE-770) is available.\n\nRelevant CWE Information:\n```\nCWE-770: Allocation of Resources Without Limits or Throttling\nThe product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.\n```\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-89:**\n- 89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) - ROOT\n\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "173",
        "name": "Improper Handling of Alternate Encoding",
        "source": "sparse"
      },
      "similarity": 186.76762154030726
    },
    {
      "metadata": {
        "doc_id": "129",
        "name": "Improper Validation of Array Index",
        "source": "sparse"
      },
      "similarity": 172.78524405790162
    },
    {
      "metadata": {
        "doc_id": "611",
        "name": "Improper Restriction of XML External Entity Reference",
        "source": "sparse"
      },
      "similarity": 145.22261006258793
    },
    {
      "metadata": {
        "doc_id": "790",
        "name": "Improper Filtering of Special Elements",
        "source": "sparse"
      },
      "similarity": 137.7560605681894
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse"
      },
      "similarity": 133.07896684653815
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 132.2503173756072
    },
    {
      "metadata": {
        "doc_id": "502",
        "name": "Deserialization of Untrusted Data",
        "source": "sparse"
      },
      "similarity": 131.5524208108257
    },
    {
      "metadata": {
        "doc_id": "20",
        "name": "Improper Input Validation",
        "source": "sparse"
      },
      "similarity": 131.26419312261126
    },
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5425961400969919
          }
        }
      },
      "similarity": 0.5425961400969919
    },
    {
      "doc_id": "789",
      "text": "CWE-789: Memory Allocation with Excessive Size Value",
      "score": 2.6784000000000003,
      "metadata": {
        "doc_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "type": "variant",
        "original_content": "CWE-789: Memory Allocation with Excessive Size Value",
        "relationships": [
          {
            "source_id": "789",
            "target_id": "129",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "1284",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "476",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "770",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "770",
            "target_id": "789",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "476",
            "target_id": "789",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1325",
            "target_id": "789",
            "label": "PEEROF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "129",
            "target_id": "789",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1284",
            "target_id": "789",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.76,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.2,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "129",
                  "789",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "129"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "770",
                  "789",
                  "PARENTOF"
                ]
              ],
              "score": 0.76,
              "type": "abstraction_path_down",
              "source": "770"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "129",
                  "789",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "129"
            }
          }
        },
        "abstraction_level": "variant",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.6784000000000003
          }
        }
      },
      "similarity": 2.6784000000000003
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-89",
      "CWE-400",
      "CWE-770",
      "CWE-20",
      "CWE-129"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}