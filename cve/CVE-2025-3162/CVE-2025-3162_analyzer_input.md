# Vulnerability Information: CVE-2025-3162

## Vulnerability Description
A vulnerability was found in InternLM LMDeploy up to 0.7.1. It has been classified as critical. Affected is the function load_weight_ckpt of the file lmdeploy/lmdeploy/vl/model/utils.py of the component PT File Handler. The manipulation leads to **deserialization**. Attacking locally is a requirement. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **deserialization**
- **product:** InternLM LMDeploy
- **version:** up to 0.7.1
- **component:** load_weight_ckpt function in lmdeploy/lmdeploy/vl/model/utils.py

## CVE Reference Links Content Summary
The content describes a vulnerability in the `load_weight_ckpt` function within the lmdeploy project that is vulnerable to arbitrary code execution.

*   **Root cause of vulnerability:** The `load_weight_ckpt` function uses `torch.load` to deserialize untrusted `.pt` files without setting the `weights_only=True` parameter.
*   **Weaknesses/vulnerabilities present:** Arbitrary code execution via deserialization of untrusted data.
*   **Impact of exploitation:** Unauthorized access, data leakage, or system compromise.
*   **Attack vectors:** Providing a maliciously crafted `.pt` file.
*   **Required attacker capabilities/position:** The attacker needs to be able to supply a malicious `.pt` file.
*   **Affected versions:** all versions <=0.7.1
*   **Mitigation or fix:** The content does not provide a fix. However, the vulnerability is in the improper use of the `torch.load` function.

The content provides more detail than the official CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.354 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.342 |
| 3 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.329 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.313 |
| 5 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.308 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.300 |
| 7 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.297 |
| 8 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.297 |
| 9 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | dense | 0.558 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

