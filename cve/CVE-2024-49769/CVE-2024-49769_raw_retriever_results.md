# Raw Retriever Results for CVE-2024-49769

# Raw Retriever Results for CVE-2024-49769
## Query
Waitress is a Web Server Gateway Interface server for Python 2 and 3. When a remote client closes the connection before waitress has had the opportunity to call getpeername() waitress wont correctly clean up the connection leading to the main thread attempting to write to a socket that no longer exists, but not removing it from the list of sockets to attempt to process. This leads to a busy-loop calling the write function. A remote attacker could run waitress out of available sockets with very little resources required. Waitress 3.0.1 contains fixes that remove the race condition.

## Keyphrases
- **rootcause**: 'race condition'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3007 | 0.3524 | 0.3227 | 0.3221 | 12 |
| Sparse | 159.7561 | 1000.0000 | 509.7892 | 492.4408 | 11 |
| Graph | 1.6278 | 4.3290 | 2.1726 | 2.1081 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | base | 4.3290 | Allowed |
| 2 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | class | 2.5520 | Allowed-with-Review |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.4700 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 6 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 7 | 252 | Unchecked Return Value | base | 2.2100 | Allowed |
| 8 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 9 | 619 | Dangling Database Cursor ('Cursor Injection') | base | 2.2100 | Allowed |
| 10 | 412 | Unrestricted Externally Accessible Lock | base | 2.1762 | Allowed |
| 11 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 12 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 13 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | base | 1.7680 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (12)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1385 | Missing Origin Validation in WebSockets | Variant | 0.3524 | 0.3524 | Allowed |
| 2 | 605 | Multiple Binds to the Same Port | Variant | 0.3460 | 0.3460 | Allowed |
| 3 | 410 | Insufficient Resource Pool | Base | 0.3283 | 0.3283 | Allowed |
| 4 | 404 | Improper Resource Shutdown or Release | Class | 0.3229 | 0.3229 | Allowed-with-Review |
| 5 | 246 | J2EE Bad Practices: Direct Use of Sockets | Variant | 0.3226 | 0.3226 | Allowed |
| 6 | 421 | Race Condition During Access to Alternate Channel | Base | 0.3226 | 0.3226 | Allowed |
| 7 | 577 | EJB Bad Practices: Use of Sockets | Variant | 0.3217 | 0.3217 | Allowed |
| 8 | 603 | Use of Client-Side Authentication | Base | 0.3196 | 0.3196 | Allowed |
| 9 | 1327 | Binding to an Unrestricted IP Address | Base | 0.3174 | 0.3174 | Allowed |
| 10 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | 0.3131 | 0.3131 | Allowed |
| 11 | 602 | Client-Side Enforcement of Server-Side Security | Class | 0.3044 | 0.3044 | Allowed-with-Review |
| 12 | 394 | Unexpected Status Code or Return Value | Base | 0.3007 | 0.3007 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 516.0837 | 516.0837 | Allowed |
| 3 | 476 | NULL Pointer Dereference | 510.0856 | 510.0856 | Allowed |
| 4 | 667 | Improper Locking | 500.3430 | 500.3430 | Allowed-with-Review |
| 5 | 833 | Deadlock | 493.0152 | 493.0152 | Allowed |
| 6 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 492.4408 | 492.4408 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | 487.1367 | 487.1367 | Allowed |
| 8 | 404 | Improper Resource Shutdown or Release | 485.7830 | 485.7830 | Allowed-with-Review |
| 9 | 346 | Origin Validation Error | 483.2693 | 483.2693 | Allowed-with-Review |
| 10 | 400 | Uncontrolled Resource Consumption | 479.7683 | 479.7683 | Discouraged |
| 11 | 772 | Missing Release of Resource after Effective Lifetime | 159.7561 | 159.7561 | Allowed |
