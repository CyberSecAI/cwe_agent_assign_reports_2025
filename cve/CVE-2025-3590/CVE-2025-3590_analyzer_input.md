# Vulnerability Information: CVE-2025-3590

## Vulnerability Description
A vulnerability has been found in Adianti Framework up to 8.0 and classified as critical. Affected by this vulnerability is an unknown functionality. The manipulation leads to **deserialization**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 8.1 is able to address this issue. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **weakness:** **deserialization**
- **product:** Adianti Framework
- **version:** up to 8.0
- **component:** unknown functionality

## CVE Reference Links Content Summary
CVE-2025-3590 is related to this content.

**Root cause of vulnerability:**

Deserialization of untrusted data via PHP's `unserialize()` function.

**Weaknesses/vulnerabilities present:**

* CWE-502: Deserialization of Untrusted Data
* CAPEC-586: Object Injection
* PHP Object Injection

**Impact of exploitation:**

* Arbitrary file deletion (demonstrated with LICENSE file)
* Potential Denial of Service (by deleting important files like .htaccess)
* Potential for File Writes and Remote Code Execution (depending on Gadget Chains available)

**Attack vectors:**

* HTTP requests containing serialized objects in parameters like `$param['previous_parameters']` or `$param['extensions']`.
* Specifically, the `LoginForm::onLogin` and `AdiantiUploaderService::show` functions are vulnerable.
* Base64 encoding is sometimes used on the serialized data.

**Required attacker capabilities/position:**

* Authenticated user with low privileges.
* Knowledge of PHP Object Injection and available Gadget Chains (e.g., DomPdf).

**Mitigation or fix:**

* Use the `allowed_classes` option with `unserialize()` to restrict deserialization to specific classes.
* Replace serialization with `json_encode` and `json_decode` if possible.

**Additional Details (more than official CVE description):**

* The vulnerable version is <= 8.0.
* A Proof of Concept (PoC) is provided using the DomPdf library's File Delete Gadget Chain.
* A bash script (`poc.sh`) is included to automate the exploit.
* The script demonstrates deleting a file via the Adianti Framework's login form and file upload functionality.
* The content provides specific code examples of vulnerable functions and parameters.
* The timeline of disclosure is included.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.484 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.476 |
| 3 | 334 | Small Space of Random Values | Base | Allowed | sparse | 0.426 |
| 4 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.422 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.410 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.402 |
| 7 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.391 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.387 |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | dense | 0.545 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.003 |

