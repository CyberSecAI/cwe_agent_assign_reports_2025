{
  "cve_id": "CVE-2024-23454",
  "description": "Apache Hadoops RunJar.run() does not set permissions for temporary directory by default. If sensitive data will be present in this file, all the other local users may be able to view the content. This is because, on unix-like systems, the system temporary directory is shared between all local users. As such, files written in this directory, without setting the correct posix permissions explicitly, may be viewable by all other local users.",
  "key_phrases": {
    "rootcause": "improper permissions",
    "weakness": "",
    "impact": "view sensitive data",
    "vector": "",
    "attacker": "local users",
    "product": "Apache Hadoop",
    "version": "",
    "component": "RunJar.run()"
  },
  "reference_content": "Based on the provided information, here's an analysis of CVE-2024-23454:\n\n**Root Cause of Vulnerability:**\n\nThe vulnerability stems from Apache Hadoop's `RunJar.run()` method not setting proper permissions on temporary directories by default. Specifically, it fails to set specific POSIX permissions when creating temporary files in a shared system directory.\n\n**Weaknesses/Vulnerabilities Present:**\n\n*   **Insecure Temporary File Creation:** The core weakness is the creation of temporary files in a shared directory (`/tmp` on Unix-like systems) without setting restrictive permissions.\n*   **Information Disclosure:** Because the permissions are not set correctly, other local users can potentially read the contents of these temporary files if sensitive data is present.\n\n**Impact of Exploitation:**\n\n*   **Sensitive Information Disclosure:** Successful exploitation allows local users to gain unauthorized access to sensitive information that might be stored in temporary files created by Hadoop's `RunJar.run()` method.\n\n**Attack Vectors:**\n\n*   **Local Access:** The attack vector is local access to the affected system, because the vulnerability affects how temporary files are created and accessed by different local users on the same system.\n\n**Required Attacker Capabilities/Position:**\n\n*   **Local User:** The attacker needs to be a local user on the same system where the vulnerable Hadoop instance is running.\n*   **No Elevated Privileges Required:** The attacker doesn't require any special privileges or elevated access to exploit the vulnerability because the issue is related to the shared file system permissions and that the files are readable by other users.\n\n**Additional details from the provided content:**\n\n*   **Affected Versions:** Apache Hadoop versions prior to 3.4.0 are affected.\n*   **Fix:** The vulnerability is resolved in Hadoop versions 3.4.0 and 3.5.0.\n*   **NetApp's Stance:** NetApp has acknowledged the vulnerability in its products but states that none of its products are affected. This likely means that either they don't use the vulnerable part of Hadoop or have implemented mitigations.\n*   **CVSS Score:** The vulnerability is rated as 6.2 (MEDIUM) with a vector of `CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N`.\n\nIn summary, CVE-2024-23454 is a local information disclosure vulnerability in Apache Hadoop due to insecure temporary file creation.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-378 | Creation of Temporary File With Insecure Permissions | 0.9 | Base | Allowed | Primary CWE |\n| CWE-668 | Exposure of Resource to Wrong Sphere | 0.6 | Class | Discouraged | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship that influenced the decision was the direct match between the vulnerability description and the CWE-378 description, which directly addresses the creation of temporary files with **improper permissions**. CWE-668 was considered due to the exposure of resources, but CWE-378 is more specific.\n\n```mermaid\ngraph TD\n    cwe378[\"CWE-378: Creation of Temporary File With Insecure Permissions\"]\n    cwe668[\"CWE-668: Exposure of Resource to Wrong Sphere\"]\n    \n    cwe378 -->|CANPRECEDE| cwe668\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe378 primary\n    class cwe668 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper creation of a temporary file with insecure permissions** (CWE-378), which leads to the potential **exposure of sensitive information** to other local users (CWE-668).\n\n## Summary of Analysis\nThe analysis is primarily based on the provided evidence, especially the \"Vulnerability Description Key Phrases\" and \"CVE Reference Links Content Summary\". The key phrase \"**improper permissions**\" and the summary mentioning \"insecure temporary file creation\" directly support the selection of CWE-378. The relationship analysis also indicates that CWE-378 can lead to CWE-668, forming a vulnerability chain. The selected CWEs are at the optimal level of specificity because CWE-378 is a base-level CWE that accurately describes the **rootcause** of the vulnerability, while CWE-668 describes the impact.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-378: Creation of Temporary File With Insecure Permissions\n**Abstraction Level**: Base\n**Similarity Score**: 0.78\n**Source**: dense\n\n**Description**:\nOpening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n# Complete CWE Specifications\n\nCWE-378: Creation of Temporary File With Insecure Permissions\nOpening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.\n\nCWE-668: Exposure of Resource to Wrong Sphere\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\nCWE-378 is selected as the primary CWE because it directly addresses the **rootcause**: the **improper creation of temporary files with insecure permissions**. This aligns with the vulnerability description, which states that \"Apache Hadoops RunJar.run() does not set permissions for temporary directory by default.\" CWE-378 is at the Base level of abstraction, which is preferred for mapping root causes.\n\nCWE-668 is considered as a secondary CWE because it describes the impact of the vulnerability: the exposure of sensitive data to unauthorized users. However, it is a Class-level CWE and is discouraged for use when more specific CWEs are available. Since CWE-378 directly addresses the **rootcause**, it is the primary CWE.\n\nThe other CWEs were considered but not selected because they were either too general (e.g., CWE-863 Incorrect Authorization, CWE-732 Incorrect Permission Assignment for Critical Resource, CWE-269 Improper Privilege Management) or did not directly address the **rootcause** of the vulnerability (e.g., CWE-59 Improper Link Resolution Before File Access ('Link Following'), CWE-73 External Control of File Name or Path, CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')).",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-378 | Creation of Temporary File With Insecure Permissions | 0.9 | Base | Allowed | Primary CWE |\n| CWE-668 | Exposure of Resource to Wrong Sphere | 0.6 | Class | Discouraged | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship that influenced the decision was the direct match between the vulnerability description and the CWE-378 description, which directly addresses the creation of temporary files with **improper permissions**. CWE-668 was considered due to the exposure of resources, but CWE-378 is more specific.\n\n```mermaid\ngraph TD\n    cwe378[\"CWE-378: Creation of Temporary File With Insecure Permissions\"]\n    cwe668[\"CWE-668: Exposure of Resource to Wrong Sphere\"]\n    \n    cwe378 -->|CANPRECEDE| cwe668\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe378 primary\n    class cwe668 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper creation of a temporary file with insecure permissions** (CWE-378), which leads to the potential **exposure of sensitive information** to other local users (CWE-668).\n\n## Summary of Analysis\nThe analysis is primarily based on the provided evidence, especially the \"Vulnerability Description Key Phrases\" and \"CVE Reference Links Content Summary\". The key phrase \"**improper permissions**\" and the summary mentioning \"insecure temporary file creation\" directly support the selection of CWE-378. The relationship analysis also indicates that CWE-378 can lead to CWE-668, forming a vulnerability chain. The selected CWEs are at the optimal level of specificity because CWE-378 is a base-level CWE that accurately describes the **rootcause** of the vulnerability, while CWE-668 describes the impact.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-378: Creation of Temporary File With Insecure Permissions\n**Abstraction Level**: Base\n**Similarity Score**: 0.78\n**Source**: dense\n\n**Description**:\nOpening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n# Complete CWE Specifications\n\nCWE-378: Creation of Temporary File With Insecure Permissions\nOpening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.\n\nCWE-668: Exposure of Resource to Wrong Sphere\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\nCWE-378 is selected as the primary CWE because it directly addresses the **rootcause**: the **improper creation of temporary files with insecure permissions**. This aligns with the vulnerability description, which states that \"Apache Hadoops RunJar.run() does not set permissions for temporary directory by default.\" CWE-378 is at the Base level of abstraction, which is preferred for mapping root causes.\n\nCWE-668 is considered as a secondary CWE because it describes the impact of the vulnerability: the exposure of sensitive data to unauthorized users. However, it is a Class-level CWE and is discouraged for use when more specific CWEs are available. Since CWE-378 directly addresses the **rootcause**, it is the primary CWE.\n\nThe other CWEs were considered but not selected because they were either too general (e.g., CWE-863 Incorrect Authorization, CWE-732 Incorrect Permission Assignment for Critical Resource, CWE-269 Improper Privilege Management) or did not directly address the **rootcause** of the vulnerability (e.g., CWE-59 Improper Link Resolution Before File Access ('Link Following'), CWE-73 External Control of File Name or Path, CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')).\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-378:**\n- 378 (Creation of Temporary File With Insecure Permissions) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "378",
        "name": "Creation of Temporary File With Insecure Permissions",
        "source": "sparse"
      },
      "similarity": 528.4803100393922
    },
    {
      "metadata": {
        "doc_id": "379",
        "name": "Creation of Temporary File in Directory with Insecure Permissions",
        "source": "sparse"
      },
      "similarity": 501.6700966771424
    },
    {
      "metadata": {
        "doc_id": "277",
        "name": "Insecure Inherited Permissions",
        "source": "sparse"
      },
      "similarity": 431.6381675618195
    },
    {
      "metadata": {
        "doc_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "source": "sparse"
      },
      "similarity": 422.6304789138634
    },
    {
      "metadata": {
        "doc_id": "59",
        "name": "Improper Link Resolution Before File Access ('Link Following')",
        "source": "sparse"
      },
      "similarity": 422.5185332456467
    },
    {
      "metadata": {
        "doc_id": "668",
        "name": "Exposure of Resource to Wrong Sphere",
        "source": "sparse"
      },
      "similarity": 414.35920779050787
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 404.92162127617826
    },
    {
      "metadata": {
        "doc_id": "377",
        "name": "Insecure Temporary File",
        "source": "sparse"
      },
      "similarity": 397.8868871149532
    },
    {
      "metadata": {
        "doc_id": "530",
        "name": "Exposure of Backup File to an Unauthorized Control Sphere",
        "type": "Variant",
        "original_content": "A backup file is stored in a directory or archive that is made accessible to unauthorized actors.",
        "keyphrase_source": "rootcause:improper permissions",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.36017195552335457
          }
        }
      },
      "similarity": 0.36017195552335457
    },
    {
      "doc_id": "73",
      "text": "CWE-73: External Control of File Name or Path",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "type": "base",
        "original_content": "CWE-73: External Control of File Name or Path",
        "relationships": [
          {
            "source_id": "73",
            "target_id": "114",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "59",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "41",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "20",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "73",
            "target_id": "610",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "642",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "99",
            "target_id": "73",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "642",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "610",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "59",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "41",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "114",
            "target_id": "73",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "59",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "59"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "59",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "59"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "73",
                  "59",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "59"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-378",
      "CWE-732",
      "CWE-22",
      "CWE-59",
      "CWE-73",
      "CWE-269",
      "CWE-668"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}