## Vulnerability Description
In Eclipse Jetty versions 12.0.0 to 12.0.16 included, an HTTP/2 client can specify a very large value for the HTTP/2 settings parameter SETTINGS_MAX_HEADER_LIST_SIZE. The Jetty HTTP/2 server **does not perform validation** on this setting, and tries to allocate a ByteBuffer of the specified capacity to encode HTTP responses, likely resulting in OutOfMemoryError being thrown, or even the JVM process exiting.

### Vulnerability Description Key Phrases
- **component:** HTTP/2 server
- **rootcause:** **does not perform validation**
- **vector:** very large value for SETTINGS_MAX_HEADER_LIST_SIZE
- **product:** Eclipse Jetty
- **impact:** allocate a ByteBuffer, JVM process exiting, OutOfMemoryError
- **attacker:** HTTP/2 client
- **version:** versions 12.0.0 to 12.0.16

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1948 based on provided content:

Both provided content sources relate to CVE-2025-1948. The GitHub advisory provides more detailed information than the GitLab entry.

**Root cause of vulnerability:**

The Jetty HTTP/2 server does not validate the `SETTINGS_MAX_HEADER_LIST_SIZE` parameter sent by an HTTP/2 client. This allows a malicious client to specify a very large value. The server then attempts to allocate a ByteBuffer of this size, leading to an OutOfMemoryError (OOM) or JVM process exit.

**Weaknesses/vulnerabilities present:**

*   **CWE-400: Uncontrolled Resource Consumption:** Specifically, excessive memory allocation.

**Impact of exploitation:**

*   Remote peers can cause the JVM to crash.
*   Continuous reporting of OutOfMemoryErrors (OOM).
*   Denial of Service (DoS).

**Attack vectors:**

*   **Network:** An attacker can exploit this vulnerability remotely over the network.
*   An HTTP/2 client sends a crafted `SETTINGS_MAX_HEADER_LIST_SIZE` value to the server.

**Required attacker capabilities/position:**

*   The attacker needs to be able to act as an HTTP/2 client and connect to the Jetty server. No privileges or user interaction are required.

**Mitigation or fix:**

*   Upgrade to Jetty version 12.0.17 or later, which includes a fix for this vulnerability.
*   No workarounds are available.

**CVSS Score:** 7.5 (High)

*   **CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H**

**Additional Details (from GitHub advisory - more detail than official CVE description):**

*   The vulnerability was originally reported by Bj√∏rn Seime (bjorncs@vespa.ai).
*   A proof of concept is available in a zip file attached to the original report.
*   The issue is tracked as #12690 on the Jetty project's GitHub repository.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.389 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.388 |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.369 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.368 |
| 5 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.357 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.356 |
| 7 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.355 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.354 |
| 9 | 6 | J2EE Misconfiguration: Insufficient Session-ID Length | Variant | Allowed | dense | 0.445 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-789: Memory Allocation with Excessive Size Value

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')

CWE-862: Missing Authorization

CWE-755: Improper Handling of Exceptional Conditions

CWE-20: Improper Input Validation

CWE-6: J2EE Misconfiguration: Insufficient Session-ID Length

CWE-1325: Improperly Controlled Sequential Memory Allocation