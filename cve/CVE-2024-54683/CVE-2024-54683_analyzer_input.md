# Vulnerability Information: CVE-2024-54683

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved netfilter IDLETIMER Fix for possible ABBA deadlock Deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs | ====================================================== | WARNING possible circular locking dependency detected | 6.12.0-rc7-01692-g5e9a28f41134-dirty #594 Not tainted | ------------------------------------------------------ | iptables/3303 is trying to acquire lock | ffff8881057e04b8 (kn->active#48){++++}-{00}, at __kernfs_remove+0x20 | | but task is already holding lock | ffffffffa0249068 (list_mutex){+.+.}-{33}, at idletimer_tg_destroy_v] | | which lock already depends on the new lock. A simple reproducer is | #!/bin/bash | | while true do | iptables -A INPUT -i foo -j IDLETIMER --timeout 10 --label testme | iptables -D INPUT -i foo -j IDLETIMER --timeout 10 --label testme | done & | while true do | cat /sys/class/xt_idletimer/timers/testme >/dev/null | done Avoid this by freeing list_mutex right after deleting the element from the list, then continuing with the teardown.

### Vulnerability Description Key Phrases
- **component:** netfilter IDLETIMER
- **rootcause:** **circular locking dependency, deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs**
- **product:** Linux kernel
- **version:** 6.12.0-rc7-01692-g5e9a28f41134-dirty

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.737 |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.645 |
| 3 | 833 | Deadlock | Base | Allowed | sparse | 0.643 |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.608 |
| 5 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.605 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.602 |
| 7 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.598 |
| 8 | 451 | User Interface (UI) Misrepresentation of Critical Information | Class | Allowed-with-Review | sparse | 0.595 |
| 9 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | dense | 0.541 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

