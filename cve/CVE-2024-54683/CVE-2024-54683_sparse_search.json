{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved netfilter IDLETIMER Fix for possible ABBA deadlock Deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs | ====================================================== | WARNING possible circular locking dependency detected | 6.12.0-rc7-01692-g5e9a28f41134-dirty #594 Not tainted | ------------------------------------------------------ | iptables/3303 is trying to acquire lock | ffff8881057e04b8 (kn->active#48){++++}-{00}, at __kernfs_remove+0x20 | | but task is already holding lock | ffffffffa0249068 (list_mutex){+.+.}-{33}, at idletimer_tg_destroy_v] | | which lock already depends on the new lock. A simple reproducer is | #!/bin/bash | | while true do | iptables -A INPUT -i foo -j IDLETIMER --timeout 10 --label testme | iptables -D INPUT -i foo -j IDLETIMER --timeout 10 --label testme | done & | while true do | cat /sys/class/xt_idletimer/timers/testme >/dev/null | done Avoid this by freeing list_mutex right after deleting the element from the list, then continuing with the teardown.",
  "keyphrases": {
    "rootcause": [
      "circular locking dependency",
      "deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    ]
  },
  "timestamp": "2025-07-13 22:58:36",
  "cve_id": "CVE-2024-54683",
  "result_count": 12,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 736.7375237835189,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 644.7249351088032,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 642.5347179526327,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "score": 608.1052784622486,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "1390",
      "name": "Weak Authentication",
      "score": 604.9968096759553,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 601.757192211549,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "674",
      "name": "Uncontrolled Recursion",
      "score": 597.905151311417,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "451",
      "name": "User Interface (UI) Misrepresentation of Critical Information",
      "score": 595.3530784343412,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 592.6277580364917,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "95",
      "name": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "score": 591.1763127264222,
      "search_source": "rootcause:deletion of the last rule referencing a given idletimer may happen at the same time as a read of its file in sysfs"
    },
    {
      "cwe_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "score": 493.73302268252485,
      "search_source": "rootcause:circular locking dependency"
    },
    {
      "cwe_id": "306",
      "name": "Missing Authentication for Critical Function",
      "score": 478.9489125821045,
      "search_source": "rootcause:circular locking dependency"
    }
  ]
}