# Raw Retriever Results for CVE-2024-11234

# Raw Retriever Results for CVE-2024-11234
## Query
In PHP versions 8.1.* before 8.1.31, 8.2.* before 8.2.26, 8.3.* before 8.3.14, when using streams with configured proxy and request_fulluri option, the URI is not properly sanitized which can lead to HTTP request smuggling and allow the attacker to use the proxy to perform arbitrary HTTP requests originating from the server, thus potentially gaining access to resources not normally available to the external user.

## Keyphrases
- **rootcause**: 'improper URI sanitization'
- **weakness**: 'HTTP request smuggling'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4284 | 0.5815 | 0.4666 | 0.4654 | 20 |
| Sparse | 127.5778 | 1000.0000 | 424.7154 | 402.6659 | 13 |
| Graph | 1.6926 | 2.3296 | 2.0166 | 2.1040 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.3296 | Allowed |
| 2 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 2.2704 | Allowed |
| 3 | 322 | Key Exchange without Entity Authentication | base | 2.2100 | Allowed |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.2100 | Allowed |
| 5 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | base | 2.2100 | Allowed-with-Review |
| 7 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 8 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 2.1936 | Allowed |
| 9 | 473 | PHP External Variable Modification | Variant | 2.1709 | Allowed |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | 2.1680 | Allowed |
| 11 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.0400 | Allowed |
| 12 | 456 | Missing Initialization of a Variable | variant | 2.0400 | Allowed |
| 13 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 14 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.5815 | 0.5815 | Allowed |
| 2 | 473 | PHP External Variable Modification | Variant | 0.5115 | 0.5115 | Allowed |
| 3 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | 0.4954 | 0.4954 | Allowed |
| 4 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.4935 | 0.4935 | Allowed |
| 5 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | Class | 0.4865 | 0.4865 | Allowed-with-Review |
| 6 | 84 | Improper Neutralization of Encoded URI Schemes in a Web Page | Variant | 0.4784 | 0.4784 | Allowed |
| 7 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | 0.4765 | 0.4765 | Allowed |
| 8 | 598 | Use of GET Request Method With Sensitive Query Strings | Variant | 0.4756 | 0.4756 | Allowed |
| 9 | 790 | Improper Filtering of Special Elements | Class | 0.4739 | 0.4739 | Allowed-with-Review |
| 10 | 616 | Incomplete Identification of Uploaded File Variables (PHP) | Variant | 0.4738 | 0.4738 | Allowed |
| 11 | 177 | Improper Handling of URL Encoding (Hex Encoding) | Variant | 0.4569 | 0.4569 | Allowed |
| 12 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | 0.4503 | 0.4503 | Allowed |
| 13 | 939 | Improper Authorization in Handler for Custom URL Scheme | Base | 0.4476 | 0.4476 | Allowed |
| 14 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | 0.4428 | 0.4428 | Allowed |
| 15 | 829 | Inclusion of Functionality from Untrusted Control Sphere | Base | 0.4348 | 0.4348 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | 1000.0000 | 1000.0000 | Allowed |
| 2 | 863 | Incorrect Authorization | 418.1916 | 418.1916 | Allowed-with-Review |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 416.5708 | 416.5708 | Allowed |
| 4 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 411.3458 | 411.3458 | Allowed-with-Review |
| 5 | 138 | Improper Neutralization of Special Elements | 409.2561 | 409.2561 | Discouraged |
| 6 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 406.2692 | 406.2692 | Allowed |
| 7 | 116 | Improper Encoding or Escaping of Output | 402.6659 | 402.6659 | Allowed-with-Review |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 396.4971 | 396.4971 | Allowed |
| 9 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 396.4919 | 396.4919 | Allowed |
| 10 | 287 | Improper Authentication | 392.3262 | 392.3262 | Discouraged |
| 11 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 375.1213 | 375.1213 | Allowed |
| 12 | 1390 | Weak Authentication | 368.9863 | 368.9863 | Allowed-with-Review |
| 13 | 306 | Missing Authentication for Critical Function | 127.5778 | 127.5778 | Allowed |
