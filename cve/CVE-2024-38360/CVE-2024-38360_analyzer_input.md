# Vulnerability Information: CVE-2024-38360

## Vulnerability Description
Discourse is an open source platform for community discussion. In affected versions by creating replacement words with an almost unlimited number of characters, a moderator can reduce the availability of a Discourse instance. This issue has been addressed in stable version 3.2.3 and in current betas. Users are advised to upgrade. Users unable to upgrade may manually remove the long watched words either via SQL or Rails console.

### Vulnerability Description Key Phrases
- **impact:** reduce availability of Discourse instance
- **vector:** creating replacement words with an almost unlimited number of characters
- **attacker:** moderator
- **product:** Discourse
- **version:** affected versions

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-38360:

**Root cause of vulnerability:**
The `create_or_update_word()` function in the watched words controller did not validate the size of the `replacement` parameter when creating a replace watched word, unlike the `word` parameter.

**Weaknesses/vulnerabilities present:**
- Lack of input validation on the `replacement` parameter in the `create_or_update_word()` function.
- Allows creation of watched words with an almost unlimited number of characters in the replacement field.

**Impact of exploitation:**
- Denial of Service (DoS): By creating watched words with very long replacements, an attacker can significantly reduce the availability of a Discourse instance. This likely stems from excessive resource consumption when processing the lengthy replacement strings.

**Attack vectors:**
- Network: The vulnerability can be exploited remotely.
- The attack is of low complexity.
- The attacker needs high privileges, specifically moderator access.
- No user interaction is required to exploit the vulnerability.

**Required attacker capabilities/position:**
- The attacker must have moderator privileges on the Discourse instance to create or modify watched words.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.136 |
| 2 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | Allowed | sparse | 0.129 |
| 3 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.126 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.125 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.124 |
| 6 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.120 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.120 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.118 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.389 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

