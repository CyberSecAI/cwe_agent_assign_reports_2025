# Vulnerability Information: CVE-2024-39761

## Vulnerability Description
Multiple OS **command injection vulnerabilities** exist in the login.cgi set_sys_init() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary code execution. An attacker can make an unauthenticated HTTP request to trigger these vulnerabilities.A command injection vulnerability exists within the `restart_week_value` POST parameter.

### Vulnerability Description Key Phrases
- **weakness:** **command injection vulnerabilities**
- **impact:** arbitrary code execution
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Wavlink AC3000
- **version:** M33A8.V5030.210505
- **component:** restart_week_value POST parameter in login.cgi set_sys_init() functionality

## CVE Reference Links Content Summary
```
Root cause of vulnerability:
The vulnerability lies within the `login.cgi` set_sys_init() functionality of Wavlink AC3000 routers. The `restart_hour_value`, `restart_min_value`, and `restart_week_value` POST parameters are combined into a buffer and written to the `SCH_Reboot` nvram item. This buffer resembles a crontab item, which is then added to a crontab and run. The lack of input validation allows for command injection.

Weaknesses/vulnerabilities present:
- OS command injection

Impact of exploitation:
- Arbitrary code execution

Attack vectors:
- A specially crafted HTTP request can trigger the vulnerability.

Required attacker capabilities/position:
- An attacker can make an unauthenticated HTTP request.

Mitigation or fix:
- The vendor has discontinued the product, but patches are being worked on.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.353 |
| 3 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.350 |
| 4 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.343 |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.328 |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.301 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.295 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.292 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.625 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

