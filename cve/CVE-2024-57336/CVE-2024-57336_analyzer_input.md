# Vulnerability Information: CVE-2024-57336

## Vulnerability Description
**Incorrect access control** in M2Soft CROWNIX Report & ERS affected v7.x to v7.4.3.599 and v8.x to v8.0.3.79 allows unauthorized attackers to obtain Administrator account access.

### Vulnerability Description Key Phrases
- **rootcause:** **Incorrect access control**
- **impact:** obtain Administrator account access
- **attacker:** unauthorized attackers
- **product:** M2Soft CROWNIX Report & ERS
- **version:** v7.x to v7.4.3.599 and v8.x to v8.0.3.79

## CVE Reference Links Content Summary
```
# [M2Soft Report]

* [Products]
  + [CROWNIX Report & ERS]
  + [CROWNIX Smart Form]
  + [CROWNIX Chart]
* [Support]
  + [Technical Support]
  + [Education]
  + [Schedule]
* [Reference]
  + [Major Customer]
  + [Case Study]
* [PR]
  + [Materials]
  + [Notice]
  + [Awards]
* [Company]
  + [CEO Greeting]
  + [Company Introduction]
  + [Company History]
  + [Recruitment]
  + [Location]
* [Sustainability]
  + [ESG]

* Product
  + [CROWNIX Report & ERS]
  + [CROWNIX Smart Form]
  + [CROWNIX Chart]
* Support
  + [Technical Support]
  + [Education]
  + [Schedule]
* Reference
  + [Major Customer]
  + [Case Study]
* PR
  + [Materials]
  + [Notice]
  + [Awards]
* Company
  + [CEO Greeting]
  + [Company Introduction]
  + [Company History]
  + [Recruitment]
  + [Location]

SITE MAP

* Product
  + [CROWNIX Report & ERS]
  + [CROWNIX Smart Form]
  + [CROWNIX Chart]
* Support
  + [Technical Support]
  + [Education]
  + [Schedule]
* Reference
  + [Major Customer]
  + [Case Study]
* PR
  + [Materials]
  + [Notice]
  + [Awards]
* Company
  + [CEO Greeting]
  + [Company Introduction]
  + [Company History]
  + [Recruitment]
  + [Location]

QUICK
MENU

![](/img/common/quick_icon01.png)
Purchase inquiries

[![](/img/common/quick_icon02.png)
Technical inquiries](/support/main.asp)
![](/img/common/quick_top_arrow.png)
TOP

#####

M2Soft informs customers.

Notice | M2Soft

Bulletin board content

| [Administrator] 취약점 (KVE-2024-0285/0286/0287/0291) 관련 패치 권고 | |
| --- | --- |
| Administrator 조회수 : 3315   |   2024-07-24      **1. 취약점 (KVE-2024-0285/0286/0287/0291) 관련 사항**    **â  CROWNIX 7 부적절한 사용자 인증 여부 (KVE-2024-0285)**  CROWNIX 7 ManagerSerivce 관련 부적절한 사용자 인증 여부 취약점을 통한 관리자 계정 탈취    - 조치 내용  ã MananagerService를 통한 API 사용 시 로그인 세션을 검사하는 코드를 추가하여 관리자 로그인 없이 getUserInfo / updateUserInfo 사용 불가하도록 조치  ã download 경로에 Linux OS의 루트(/)와 Window OS의 각 드라이브 루트경로를 설정하지 못하도록 조치  - 대상 제품  CROWNIX Report & ERS  7.x ~ 7.4.3.599 버전  CROWNIX Report & ERS  8.x ~ 8.0.3.79 버전    - 해결 방안  각 버전에 맞게 CROWNIX Report & ERS 패치  CROWNIX Report & ERS 7.x -> 7.4.3.561 상위 버전  CROWNIX Report & ERS 8.x -> 8.0.3.82 상위 버전      **â¡ CROWNIX 7,8 버전 파일 다운로드 및 삭제 (KVE-2024-0286)**  부적절한 사용자 인증 여부 취약점 연계를 통한 파일 다운로드 및 삭제    - 조치 내용  ã 권한 없는 사용자가 CROWNIX Reporting Server(7.2.2.302) 관련 설정 값을 변경할 수 없도록 조치  ã 또한, html5.save.dir과 같은 다운로드 관련 경로의 경우, 아무리 사용자 편의성 향상을 위한 목적이라도 루트 경로로 설정할 수 없도록 조치  ã delete true/false 와 같은 기능은 사용자 입력값을 통해 변경되지 않도록 조치    - 대상 제품  CROWNIX Report & ERS  7.x ~ 7.4.3.599 버전  CROWNIX Report & ERS  8.x ~ 8.0.3.79 버전    - 해결 방안  각 버전에 맞게 CROWNIX Report & ERS 패치  CROWNIX Report & ERS 7.x -> 7.4.3.561 상위 버전  CROWNIX Report & ERS 8.x -> 8.0.3.82 상위 버전      **â¢ CROWNIX Report/ERS 7 및 8버전 파일 업로드 및 실행 (KVE-2024-0287)**  CROWNIX ERS Reporting Server opcode 500 기능을 이용한 악의적인 파일 업로드 및 실행이 가능함    - 조치 내용  ã opcode=500 에서 mrd_path 와 mrd_param 을 통해 외부 데이터를 가져올 수 없도록 조치  ã mrd_param /rfn을 통해 가져오는 파일 내용에 대한 검증 및 필터링 적용  ã 필수 파라미터 export_type과 action 파라미터인 export_name 의 취약점 조치방안 확장자가 동일한지 검증하는 로직 추가  ã export_type이 ‘csv’인 경우, export_name의 파일 확장자를 검증하여 csv, txt, ini 까지 허용하고 그 외 확장자는 파일을 생성하지 않고 에러 처리    - 대상 제품  CROWNIX Report & ERS 5.x ~ 5.5.14.1070  CROWNIX Report & ERS 7.x ~ 7.4.3.960  CROWNIX Report & ERS 8.x ~ 8.2.0.345    - 해결 방안  각 버전에 맞게 CROWNIX Report & ERS 패치  CROWNIX Report & ERS 5.x -> 5.5.14.1071 상위 버전  CROWNIX Report & ERS 7.x -> 7.4.3.961 상위 버전  CROWNIX Report & ERS 8.x -> 8.2.0.346 상위 버전      **â£ CROWNIX Report/ERS 7 및 8버전 파일 업로드 및 실행2  (KVE-2024-0291)**  악의적인 파일 업로드 및 실행 가능    - 조치 내용  ã export_type이 ‘csv’인 경우, export_name의 파일 확장자를 검증하여 csv, txt, ini 까지 허용하고 그 외 확장자는 파일을 생성하지 않고 에러 처리  ã mrd_param /rdata 와 mrd_data 의 내용 검증 로직 추가  ã export_name 파라미터의 확장자를 확인하는 검증 로직 추가  ã export_name 파라미터의 확장자와 export_type 파라미터가 동일한지 검증 로직 추가  ã export_name 파라미터에 ../ 과 같은 경로 이동 문자열에 대한 처리    - 대상 제품  CROWNIX Report & ERS 5.x ~ 5.5.14.1070  CROWNIX Report & ERS 7.x ~ 7.4.3.960  CROWNIX Report & ERS 8.x ~ 8.2.0.345    - 해결 방안  각 버전에 맞게 CROWNIX Report & ERS 패치  CROWNIX Report & ERS 5.x -> 5.5.14.1071 상위 버전  CROWNIX Report & ERS 7.x -> 7.4.3.961 상위 버전  CROWNIX Report & ERS 8.x -> 8.2.0.346 상위 버전      **2. Patch Request Method**  ãTechnical Support Center Inquiry: 02-2188-8500 (Press 1)  ãTechnical Support Center Email Inquiry: report@m2soft.co.kr      - Inquiry Matters  Korea Internet & Security Agency Internet Attack Response Center: without country code 118  M2Soft Security Patch Inquiry Center: rdvistasupport@m2soft.co.kr | |

* Product

  + [CROWNIX Report & ERS]
  + [CROWNIX Smart Form]
  + [CROWNIX Chart]
* Support

  + [Technical Support]
  + [Education]
  + [Schedule]
* Reference

  + [Major Customer]
  + [Case Study]
* PR

  + [Materials]
  + [Notice]
  + [Awards]
* About us

  + [CEO Greeting]
  + [Company Introduction]
  + [Company History]
  + [Recruitment]
  + [Location]

[(주) M2Soft]

* [Personal Information Processing Policy]
* Email address collection refusal
* [Notice]
* [Location]

27, Seongsuil-ro 7-gil, Seongdong-gu, Seoul, Seoul CO-OBLU Digital Tower 2nd 7th floor (707ho)

**TEL**02-2188-8500 **FAX**02-2188-8508

COPYRIGHT (c)
2020 M2SOFT CO., LTD. All Rights Reserved.

![Purchase/Technical Inquiry](/img/common/tell_icon.png)Purchase/Technical Inquiry

02-2188-8500

E-mail : contact@m2soft.co.kr
```

The content discusses security vulnerabilities in CROWNIX Report & ERS products. The following vulnerabilities are described:

*   **KVE-2024-0285:** Improper user authentication in CROWNIX 7. This allows unauthorized users to potentially gain administrative privileges.

    *   **Weakness/Vulnerability:** Improper user authentication.
    *   **Impact:** Unauthorized users can potentially gain administrative privileges.
    *   **Fix:** Add code to ManagerService to check login sessions when using the API, preventing the use of getUserInfo / updateUserInfo without administrator login. Also, prevent setting Linux OS root(/) and Window OS drive root paths in the download path.
    *   **Affected versions:** CROWNIX Report & ERS 7.x ~ 7.4.3.599 and 8.x ~ 8.0.3.79
*   **KVE-2024-0286:** File download and deletion due to improper user authentication.

    *   **Weakness/Vulnerability:** Vulnerability in file download and deletion functions.
    *   **Fix:** Prevent unauthorized users from changing settings related to CROWNIX Reporting Server(7.2.2.302). Also, prevent root path settings in download paths. Also, the function of delete true/false must not be changed through user input values.
    *   **Affected versions:** CROWNIX Report & ERS 7.x ~ 7.4.3.599 and 8.x ~ 8.0.3.79
*   **KVE-2024-0287:** File upload and execution in CROWNIX Report/ERS 7 and 8.

    *   **Weakness/Vulnerability:** File upload and execution vulnerability.
    *   **Fix:** Prevent the import of external data through mrd\_path and mrd\_param in opcode=500. Apply validation and filtering for file content fetched through mrd\_param /rfn. Add validation to check if the file extension of export\_name parameter is the same as export\_type parameter. In case of export\_type is 'csv', permit only csv, txt, and ini extensions.
    *   **Affected versions:** CROWNIX Report & ERS 5.x ~ 5.5.14.1070, 7.x ~ 7.4.3.960, and 8.x ~ 8.2.0.345
*   **KVE-2024-0291:** File upload and execution 2 in CROWNIX Report/ERS 7 and 8.

    *   **Weakness/Vulnerability:** File upload and execution vulnerability.
    *   **Fix:** In case of export\_type is 'csv', permit only csv, txt, and ini extensions. Add content verification logic for mrd\_param /rdata and mrd\_data. Add validation logic to check the extension of the export\_name parameter. Add validation logic to check if the extension of export\_name parameter is the same as the export\_type parameter. Process path traversal strings like ../ in export\_name parameters.
    *   **Affected versions:** CROWNIX Report & ERS 5.x ~ 5.5.14.1070, 7.x ~ 7.4.3.960, and 8.x ~ 8.2.0.345

This content provides more detail than the official CVE description because it specifically mentions the affected versions and provides details of fixes and affected products.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.186 |
| 2 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.185 |
| 3 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.180 |
| 4 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.180 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.179 |
| 6 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.177 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.176 |
| 8 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.173 |
| 9 | 280 | Improper Handling of Insufficient Permissions or Privileges  | Base | Allowed | dense | 0.571 |
| 10 | 266 | Incorrect Privilege Assignment | Base | Allowed | graph | 0.002 |


---

## CWE Classification Guidance

The following guidance has been automatically included because relevant keywords were detected in the vulnerability description:

### Authentication vs Authorization vs Access Control Guidance

## ===Guidance===

### Level Set – Authentication vs Authorization vs Access Control

**Authentication**:
Determines *who* the actor is (identity validation). This is typically the *first step* in access control.

* Example phrases: "user must log in", "lack of login check", "bypasses login"
* CWE relevance: authentication is usually mapped to CWE-306 or its children.

  * **CWE-306**: *Missing Authentication for Critical Function* – used when no identity validation is enforced for sensitive functionality (e.g., password reset, user deletion).

**Authorization**:
Determines *what* an authenticated actor is allowed to do. It decides access *after* identity is verified.

* Example phrases: "unauthorized access", "regular user can access admin panel", "role checks are missing"
* CWE relevance: use CWEs like 862, 863, 285 for authorization errors:

  * **CWE-862**: *Missing Authorization* – the application doesn't check whether the user is authorized at all.
  * **CWE-863**: *Incorrect Authorization* – the application checks authorization, but does it incorrectly (e.g., flawed logic).
  * **CWE-285**: *Improper Authorization* – general category for any flawed authorization logic or design.

**Access Control**:
A broader term that includes both authentication and authorization. Governs how resources are protected and who can access them under what conditions.

* CWE relevance:

  * **CWE-284**: *Improper Access Control* – top-level category used when access control failure exists but root cause is unclear.
  * This should be avoided **if** a more specific child CWE like 285, 862, 863, or 306 is appropriate.

---

## Mapping Discussion – Common Misclassification Patterns

### 1. **CWE-306 vs CWE-862**:

* **306** is about lack of **authentication** (e.g., *no login required at all*).
* **862** is about lack of **authorization** *after* authentication (e.g., *admin check missing*).
* ✅ Example CWE-306: *“An unauthenticated attacker can invoke the password reset API.”*
* ✅ Example CWE-862: *“An authenticated user without admin privileges can delete any user account.”*

### 2. **CWE-285 vs CWE-284**:

* **285** is specific to authorization flaws – it's a better choice than 284 **if** the issue involves *improper or missing role checks*.
* **284** should be reserved for general access control issues when it’s unclear whether the issue lies in authn or authz.

---

## Technical Impact vs Root Cause Clarification

**Phrase like "unauthorized access" is not enough.**

* If you **cannot determine whether identity was checked**, assume it’s **authorization** and consider 862 or 863.
* If you **know no login happened**, lean toward **authentication** → CWE-306.
* If the **access control policy is unclear or inconsistently enforced**, but it's not due to missing checks, consider **CWE-284**.

---

## Good Mapping Examples

* ✅ **CWE-306**: “The endpoint `/admin/deleteUser` does not require any authentication.”
* ✅ **CWE-862**: “Any logged-in user can change any other user's email without being an admin.”
* ✅ **CWE-863**: “An admin check exists but incorrectly grants access to non-admin users.”
* ✅ **CWE-285**: “Application uses a static role check that fails when roles change dynamically.”
* ✅ **CWE-284**: “Inconsistent enforcement of access rules across services with unclear policy source.”

---

## Summary – Quick LLM Rules of Thumb

| **Indicator**                                              | **Likely CWE** |
| ---------------------------------------------------------- | -------------- |
| No identity check (no login)                               | CWE-306        |
| No role/privilege check after login                        | CWE-862        |
| Role check is present but flawed                           | CWE-863        |
| General or ambiguous authorization failure                 | CWE-285        |
| High-level access control problem with no clear root cause | CWE-284        |


