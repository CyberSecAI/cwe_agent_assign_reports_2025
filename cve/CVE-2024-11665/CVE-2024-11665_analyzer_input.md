# Vulnerability Information: CVE-2024-11665

## Vulnerability Description
**Improper Neutralization of Special Elements used in a Command** (Command Injection) vulnerability in hardy-barth cph2_echarge_firmware allows OS Command Injection.This issue affects cph2_echarge_firmware through 2.0.4.

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Neutralization of Special Elements used in a Command**
- **weakness:** **command injection**
- **impact:** OS command injection
- **product:** hardy-barth cph2_echarge_firmware
- **version:** through 2.0.4

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability information related to CVE-2024-11665:

**Root Cause of Vulnerability:**

*   The web administration interface of the affected EV charging station controllers is built using PHP scripts. These scripts are not protected against unauthorized access and directly use user-controlled input in system commands without proper sanitization. This allows for command injection.
*  The lighttpd webserver is configured to enforce authentication, but these settings do not apply to the vulnerable PHP scripts.

**Weaknesses/Vulnerabilities Present:**

*   **Unauthenticated Command Injection:** Multiple PHP scripts within the web interface allow execution of arbitrary OS commands due to lack of input sanitization.
*   **Lack of Access Control:** Vulnerable PHP scripts are accessible without any authentication, despite the web server being configured for authentication.
*   **Incomplete Fix:** The vendor attempted to fix a previously reported command injection vulnerability but failed, leaving the vulnerability present in the latest firmware version at the time of analysis (2.0.4).

**Impact of Exploitation:**

*   An attacker on the same local network as the EV charging station can execute arbitrary commands with elevated (root) privileges on the affected device. This can lead to full compromise of the charging station controller, potentially disrupting charging services, causing damage to the device or other connected systems, or enabling further attacks on the local network.

**Attack Vectors:**

*   **Network-based:** An attacker needs to be on the same local network (LAN) as the vulnerable device.
*   **HTTP Requests:** The attacker exploits the vulnerabilities through HTTP requests to the web interface.

**Required Attacker Capabilities/Position:**

*   Attacker must be on the same LAN as the charging station controller.
*   No authentication is required.
*   Attacker needs knowledge of the vulnerable endpoints/parameters.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.250 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.243 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.233 |
| 6 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | sparse | 0.227 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.219 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.207 |
| 9 | 160 | Improper Neutralization of Leading Special Elements | Variant | Allowed | dense | 0.620 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

