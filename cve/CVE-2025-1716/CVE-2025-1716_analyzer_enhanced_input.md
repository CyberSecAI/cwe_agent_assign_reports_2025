## Vulnerability Description
**picklescan before 0.0.21 does not treat pip as an unsafe global**. An attacker could craft a malicious model that uses Pickle to pull in a malicious PyPI package (hosted, for example, on pypi.org or GitHub) via `pip.main()`. Because **pip is not a restricted global**, the model, when scanned with picklescan, would pass security checks and appear to be safe, when it could instead prove to be problematic.

### Vulnerability Description Key Phrases
- **rootcause:** **picklescan before 0.0.21 does not treat pip as an unsafe global**
- **weakness:** **pip is not a restricted global**
- **impact:** pull in a malicious PyPI package
- **vector:** craft a malicious model that uses Pickle
- **attacker:** attacker
- **product:** picklescan
- **version:** before 0.0.21

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1716 based on provided content:

The provided content details a vulnerability in `picklescan` (versions <= 0.0.21) that allows bypassing security checks during deserialization of pickle files. Here's a breakdown of the relevant information:

**Root cause of vulnerability:**

The vulnerability stems from `picklescan` not treating `pip` as an unsafe global. This allows an attacker to leverage `pip.main()` within a malicious pickle file to install a malicious PyPI package during deserialization.

**Weaknesses/vulnerabilities present:**

*   **Unsafe deserialization:** Python's `pickle` module allows arbitrary code execution via the `reduce` method.
*   **Insufficient input validation:** `picklescan` fails to identify `pip.main()` as a potentially dangerous operation.
*   **CWE-184:** Incomplete List of Disallowed Inputs

**Impact of exploitation:**

*   **Remote Code Execution (RCE):** Successful exploitation leads to arbitrary code execution on the system deserializing the malicious pickle file.
*   **Supply Chain Attack:** Attackers can distribute malicious pickle files through various channels (ML models, APIs, saved Python objects).
*   **Bypassing Security Tools:** The attack bypasses `picklescan` and potentially other similar security tools.

**Attack vectors:**

*   An attacker crafts a malicious pickle file that, when deserialized, calls `pip.main()` to install a malicious package from a source like PyPI or GitHub.
*   The malicious package's `setup.py`, entry points, or post-install hooks execute arbitrary code.

**Required attacker capabilities/position:**

*   The attacker needs to be able to deliver a malicious pickle file to a system that will deserialize it.
*   The attacker needs to be able to host a malicious PyPI package or a malicious package on a platform like GitHub.

**Mitigation or fix:**

*   Add `"pip": "*"` to the list of unsafe globals in `picklescan`.
*   Upgrade to `picklescan` version 0.0.22 or higher, which includes this fix and additional restricted globals.

**Additional Details (more than CVE description):**

*   **Proof-of-Concept (PoC):** The content provides a detailed PoC, including example code for creating a malicious `setup.py` and a malicious pickle file.
*   **CVSS Score:** The CVSS score is provided as 5.3 (Moderate severity).
*   **CVSS v4 Metrics:** Detailed CVSS v4 metrics are provided.
*   **Credits:** Trevor Madge (@madgetr) of Sonatype is credited with discovering the vulnerability.
*   **EPSS Score:** 0.22% (45th percentile)
*   **Affected Versions:** <= 0.0.21, Patched versions: 0.0.22

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | Base | Allowed | sparse | 0.457 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.419 |
| 3 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.418 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.407 |
| 5 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.404 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.393 |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.392 |
| 8 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.390 |
| 9 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | dense | 0.413 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere

CWE-138: Improper Neutralization of Special Elements

CWE-1333: Inefficient Regular Expression Complexity

CWE-23: Relative Path Traversal

CWE-522: Insufficiently Protected Credentials

CWE-863: Incorrect Authorization

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-1286: Improper Validation of Syntactic Correctness of Input

CWE-184: Incomplete List of Disallowed Inputs

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')