# Vulnerability Information: CVE-2024-42987

## Vulnerability Description
Tenda FH1206 v02.03.01.35 was discovered to contain a **stack overflow** via the modino parameter in the fromPptpUserAdd function. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted POST request.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted POST request
- **attacker:** attackers
- **product:** Tenda FH1206
- **version:** v02.03.01.35
- **component:** fromPptpUserAdd function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 145)
- CWE-120 (Count: 4)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A stack-based buffer overflow vulnerability exists in the `fromPptpUserAdd` function of the Tenda FH1206 router firmware. This vulnerability stems from the use of `sprintf` without proper bounds checking when handling user-supplied data.

- **Weaknesses/vulnerabilities present:** The vulnerability is a classic stack buffer overflow. The `sprintf` function is used to copy data into fixed-size buffers (`v16` and `v20`) without verifying the size of the input, which can cause the buffer to overflow if the input is larger than the buffer's capacity.

- **Impact of exploitation:** An attacker could potentially overwrite parts of the stack, including the return address, which could allow arbitrary code execution on the affected device. This could lead to a complete compromise of the router.

- **Attack vectors:** The vulnerability is triggered via a POST request to `/goform/PPTPDClient`. The `modino` parameter in the POST data is the source of the overflow.

- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP POST requests to the vulnerable router. This would require the attacker to be on the same network as the router, or have a way to send requests to the router through a vulnerable network configuration. The attacker does not need to be authenticated since the vulnerable parameter is received prior authentication procedures.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.236 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.211 |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.209 |
| 6 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.208 |
| 7 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.204 |
| 8 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.204 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.563 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.002 |

