# Vulnerability Information: CVE-2024-10969

## Vulnerability Description
A vulnerability was found in 1000 Projects Bookstore Management System 1.0. It has been rated as critical. Affected by this issue is some unknown functionality of the file /admin/login_process.php of the component Login. The manipulation of the argument unm leads to **sql injection**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** 1000 Projects Bookstore Management System
- **version:** 1
- **component:** /admin/login_process.php

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Vulnerability:** SQL Injection

**Root Cause:**
- The `admin/login_process.php` file in the "Bookstore Management System PHP MySQL Project V1.0" is vulnerable to SQL injection.
- The vulnerability stems from the lack of proper input sanitization and validation of the `unm` parameter. User-supplied input from this parameter is directly incorporated into SQL queries without being sanitized or validated. This allows an attacker to inject malicious SQL code.

**Weaknesses:**
- **Lack of Input Sanitization:** User input is not properly sanitized or filtered before being used in SQL queries.
- **Direct Use of User Input in SQL Queries:**  The application directly embeds user-provided data into SQL queries, opening the door for SQL injection.

**Impact of Exploitation:**
- **Unauthorized Database Access:** Attackers can gain access to the database without proper credentials.
- **Sensitive Data Leakage:** Attackers can extract sensitive data from the database.
- **Data Tampering:** Attackers can modify or delete data in the database.
- **System Control:** Attackers can potentially gain comprehensive control over the system.
- **Service Interruption:** The vulnerability could lead to denial-of-service by manipulating database operations.

**Attack Vectors:**
- The primary attack vector is the `unm` parameter in the `admin/login_process.php` file.
- Attackers can inject SQL payloads via HTTP POST requests to this file.

**Required Attacker Capabilities/Position:**
- No login or authorization is required to exploit this vulnerability.
- The attacker needs to be able to send HTTP POST requests to the vulnerable `admin/login_process.php` file.
- The attacker can be an unauthenticated user.

**Technical Details:**
- The vulnerability can be exploited through boolean-based blind SQL injection, time-based blind SQL injection and UNION query injection.
- Example payloads for exploiting the SQL injection are provided, showing how to perform boolean-based blind injection, time-based injection, and UNION query injection using the `unm` parameter.
- sqlmap was used to demonstrate the vulnerability. The sqlmap commands, along with screenshots, illustrate how an attacker could enumerate databases, tables, columns, and dump data.

**Suggested Repairs:**
- Use prepared statements with parameter binding to prevent SQL injection.
- Validate and filter user input to ensure it conforms to the expected format.
- Minimize database user permissions to limit the impact of a successful attack.
- Conduct regular security audits to find and fix potential vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.444 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.378 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.376 |
| 5 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.372 |
| 6 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.350 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.344 |
| 8 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.344 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.571 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

