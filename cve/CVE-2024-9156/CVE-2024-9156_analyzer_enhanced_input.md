## Vulnerability Description
The TI WooCommerce Wishlist WordPress plugin through 2.8.2 is vulnerable to SQL Injection due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** unauthenticated attackers
- **product:** TI WooCommerce Wishlist WordPress plugin
- **version:** through 2.8.2

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-9156

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient escaping of user-supplied input and a lack of proper preparation in the existing SQL query within the "TI WooCommerce Wishlist" plugin. Specifically, the `lang` parameter is not properly sanitized, allowing attackers to inject SQL code.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The primary vulnerability is SQL injection (SQLI). The plugin fails to sanitize the `lang` parameter, which is then directly used in an SQL query, allowing an attacker to insert malicious SQL code.

**Impact of Exploitation:**
- **Sensitive Information Disclosure:** Successful exploitation of this vulnerability could allow an attacker to extract sensitive information from the database by injecting crafted SQL queries. This could include usernames, passwords, customer data, and other confidential information.

**Attack Vectors:**
- **Unauthenticated Access:** The vulnerability can be exploited by unauthenticated attackers, requiring no prior access to the system.
- **HTTP POST Request:** The attack vector involves sending an HTTP POST request to the server that adds or removes wishlist items, including the malicious `lang` parameter.
- **Specific Parameter:** The vulnerability is triggered by manipulating the `lang` parameter in the POST request.
- **SitePress Plugin Dependency**: The vulnerability requires that the "sitepress-multilingual-cms" plugin is installed for the attack to succeed.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send HTTP POST requests to the vulnerable server.
- No authentication is required.
- The attacker needs to be aware of the `lang` parameter used by the plugin.
- The "sitepress-multilingual-cms" plugin needs to be installed.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.457 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.410 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.403 |
| 5 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.397 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.386 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.385 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.385 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.552 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-502: Deserialization of Untrusted Data

CWE-790: Improper Filtering of Special Elements

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-425: Direct Request ('Forced Browsing')