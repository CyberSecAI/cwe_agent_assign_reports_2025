## Vulnerability Description
Horovod versions up to and including v0.28.1 are vulnerable to unauthenticated remote code execution. The vulnerability is due to **improper handling of base64-encoded data** in the `ElasticRendezvousHandler`, a subclass of `KVStoreHandler`. Specifically, the `_put_value` method in `ElasticRendezvousHandler` calls `codec.loads_base64(value)`, which eventually invokes `cloudpickle.loads(decoded)`. This allows an attacker to send a malicious pickle object via a PUT request, leading to arbitrary code execution on the server.

### Vulnerability Description Key Phrases
- **rootcause:** **improper handling of base64-encoded data**
- **impact:** unauthenticated remote code execution and arbitrary code execution
- **vector:** malicious pickle object via a PUT request
- **attacker:** attacker
- **product:** Horovod
- **version:** up to and including v0.28.1
- **component:** ElasticRendezvousHandler

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.377 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.368 |
| 3 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | sparse | 0.368 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.366 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.366 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.364 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.364 |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.361 |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | dense | 0.560 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-502: Deserialization of Untrusted Data

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-611: Improper Restriction of XML External Entity Reference

CWE-138: Improper Neutralization of Special Elements

CWE-306: Missing Authentication for Critical Function

CWE-125: Out-of-bounds Read

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-347: Improper Verification of Cryptographic Signature

CWE-918: Server-Side Request Forgery (SSRF)

CWE-117: Improper Output Neutralization for Logs