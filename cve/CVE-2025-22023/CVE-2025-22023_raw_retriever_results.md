# Raw Retriever Results for CVE-2025-22023

# Raw Retriever Results for CVE-2025-22023
## Query
In the Linux kernel, the following vulnerability has been resolved usb xhci Dont skip on Stopped - Length Invalid Up until commit d56b0b2ab142 (usb xhci ensure skipped isoc TDs are returned when isoc ring is stopped) in v6.11, the driver didnt skip missed isochronous TDs when handling Stoppend and Stopped - Length Invalid events. Instead, it erroneously cleared the skip flag, which would cause the ring to get stuck, as future events wont match the missed TD which is never removed from the queue until its cancelled. This buggy logic seems to have been in place substantially unchanged since the 3.x series over 10 years ago, which probably speaks first and foremost about relative rarity of this case in normal usage, but by the spec I see no reason why it shouldnt be possible. After d56b0b2ab142, TDs are immediately skipped when handling those Stopped events. This poses a potential problem in case of Stopped - Length Invalid, which occurs either on completed TDs (likely already given back) or Link and No-Op TRBs. Such event wont be recognized as matching any TD (unless its the rare Link TRB inside a TD) and will result in skipping all pending TDs, giving them back possibly before they are done, risking isoc data loss and maybe UAF by HW. As a compromise, dont skip and dont clear the skip flag on this kind of event. Then the next event will skip missed TDs. A downside of not handling Stopped - Length Invalid on a Link inside a TD is that if the TD is cancelled, its actual length will not be updated to account for TRBs (silently) completed before the TD was stopped. I had no luck producing this sequence of completion events so there is no compelling demonstration of any resulting disaster. It may be a very rare, obscure condition. The sole motivation for this patch is that if such unlikely event does occur, Id rather risk reporting a cancelled partially done isoc frame as empty than gamble with UAF. This will be fixed more properly by looking at Stopped events TRB pointer when making skipping decisions, but such rework is unlikely to be backported to v6.12, which will stay around for a few years.

## Keyphrases
- **weakness**: 'UAF'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4587 | 0.5351 | 0.4825 | 0.4745 | 20 |
| Sparse | 1000.0000 | 1423.9128 | 1329.7885 | 1355.3475 | 11 |
| Graph | 1.5249 | 3.2400 | 2.0102 | 1.7615 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 789 | Memory Allocation with Excessive Size Value | variant | 3.2400 | Allowed |
| 2 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 2.8230 | Allowed |
| 3 | 805 | Buffer Access with Incorrect Length Value | Base | 2.8151 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.8070 | Allowed |
| 5 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.3868 | Allowed |
| 6 | 1333 | Inefficient Regular Expression Complexity | base | 2.1190 | Allowed |
| 7 | 129 | Improper Validation of Array Index | variant | 2.0400 | Allowed |
| 8 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 9 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 10 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 11 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 12 | 606 | Unchecked Input for Loop Condition | Base | 1.7083 | Allowed |
| 13 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 1.6848 | Allowed |
| 14 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 15 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.5351 | 0.5351 | Allowed |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5209 | 0.5209 | Allowed |
| 3 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.5176 | 0.5176 | Allowed |
| 4 | 606 | Unchecked Input for Loop Condition | Base | 0.5162 | 0.5162 | Allowed |
| 5 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4988 | 0.4988 | Allowed |
| 6 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4938 | 0.4938 | Allowed |
| 7 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4906 | 0.4906 | Allowed |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4892 | 0.4892 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4861 | 0.4861 | Allowed-with-Review |
| 10 | 457 | Use of Uninitialized Variable | Variant | 0.4793 | 0.4793 | Allowed |
| 11 | 197 | Numeric Truncation Error | Base | 0.4696 | 0.4696 | Allowed |
| 12 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4676 | 0.4676 | Allowed |
| 13 | 909 | Missing Initialization of Resource | Class | 0.4640 | 0.4640 | Allowed-with-Review |
| 14 | 366 | Race Condition within a Thread | Base | 0.4636 | 0.4636 | Allowed |
| 15 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4606 | 0.4606 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | 1423.9128 | 1423.9128 | Allowed |
| 2 | 789 | Memory Allocation with Excessive Size Value | 1409.1930 | 1409.1930 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1391.7505 | 1391.7505 | Allowed-with-Review |
| 4 | 863 | Incorrect Authorization | 1365.6278 | 1365.6278 | Allowed-with-Review |
| 5 | 1333 | Inefficient Regular Expression Complexity | 1357.6273 | 1357.6273 | Allowed |
| 6 | 754 | Improper Check for Unusual or Exceptional Conditions | 1355.3475 | 1355.3475 | Allowed-with-Review |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1338.5704 | 1338.5704 | Allowed |
| 8 | 347 | Improper Verification of Cryptographic Signature | 1335.7312 | 1335.7312 | Allowed |
| 9 | 125 | Out-of-bounds Read | 1328.8454 | 1328.8454 | Allowed |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | 1321.0671 | 1321.0671 | Allowed |
| 11 | 416 | Use After Free | 1000.0000 | 1000.0000 | Allowed |
