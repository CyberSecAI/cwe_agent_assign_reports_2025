## Vulnerability Description
A **html code injection vulnerability** exists in the vlan management part of Observium CE 24.4.13528. A specially crafted HTTP request can lead to an arbitrary html code. An authenticated user would need to click a malicious link provided by the attacker.

### Vulnerability Description Key Phrases
- **weakness:** **html code injection vulnerability**
- **impact:** arbitrary html code
- **vector:** specially crafted HTTP request
- **attacker:** authenticated user
- **product:** Observium CE
- **version:** 24.4.13528
- **component:** vlan management part

## CVE Reference Links Content Summary
## CVE-2024-47002 - Observium vlan html code injection vulnerability

**Root cause of vulnerability:**

The vulnerability is due to improper neutralization of input during web page generation, specifically within the `vlan` functionality of Observium. The `vlan_id` parameter is not properly sanitized, allowing an attacker to inject arbitrary HTML code.

**Weaknesses/vulnerabilities present:**

*   CWE-79 - Improper Neutralization of Input During Web Page Generation (‘Cross-site Scripting’)
*   Reflected Cross-Site Scripting (XSS)

**Impact of exploitation:**

Successful exploitation allows an attacker to inject arbitrary HTML code into the web page, potentially leading to:

*   Execution of malicious scripts in the victim's browser.
*   Stealing sensitive information (cookies, session tokens).
*   Defacement of the web page.
*   Redirection to malicious websites.

**Attack vectors:**

*   An attacker needs to craft a malicious HTTP request with a specially crafted `vlan_id` parameter.
*   The attacker must then trick a user into clicking a malicious link containing the crafted URL.

**Required attacker capabilities/position:**

*   The attacker does not need any special privileges to craft the malicious request.
*   The attacker needs to be able to deliver the malicious link to a legitimate, authenticated user of the Observium instance.
*   Authenticated user interaction is required (clicking a malicious link).

**Mitigation or fix:**

*   The vendor released a patch on December 24, 2024.
*   Proper input validation and sanitization of the `vlan_id` parameter in `html/pages/vlan.inc.php` is required.

**Confirmed Vulnerable Versions:**

*   Observium CE 24.4.13528

**CVSSv3 Score:**

*   8.7 - CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N

**Additional Details (more than official CVE description):**

*   The vulnerable code is located in `html/pages/vlan.inc.php`.
*   Example malicious URL: `http://192.168.0.40/vlan/?vlan_id=<LINK REL="stylesheet" HREF="http://192.168.0.140:8000/very_evil.css">`
*   The report provides the full HTTP request and response examples.
*   Discovered by Marcin 'Icewall' Noga of Cisco Talos.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.291 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.276 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.264 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.253 |
| 5 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.253 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.248 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.248 |
| 8 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.246 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.568 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-138: Improper Neutralization of Special Elements

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-502: Deserialization of Untrusted Data

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-184: Incomplete List of Disallowed Inputs