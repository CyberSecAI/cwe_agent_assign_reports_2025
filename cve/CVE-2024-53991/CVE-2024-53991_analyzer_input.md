# Vulnerability Information: CVE-2024-53991

## Vulnerability Description
Discourse is an open source platform for community discussion. This vulnerability only impacts Discourse instances configured to use `FileStoreLocalStore` which means uploads and backups are stored locally on disk. If an attacker knows the name of the Discourse backup file, the attacker can trick nginx into sending the Discourse backup file with a well crafted request. This issue is patched in the latest stable, beta and tests-passed versions of Discourse. Users are advised to upgrade. Users unable to upgrade can either 1. Download all local backups on to another storage device, disable the `enable_backups` site setting and delete all backups until the site has been upgraded to pull in the fix. Or 2. Change the `backup_location` site setting to `s3` so that backups are stored and downloaded directly from S3.

### Vulnerability Description Key Phrases
- **vector:** well crafted request
- **attacker:** attacker
- **product:** Discourse

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability stems from a misconfiguration in Nginx that allows an attacker to potentially access Discourse backup files when using `FileStore::LocalStore` if the attacker knows the name of the backup file.
- **Weaknesses/vulnerabilities present**: The primary vulnerability is related to the handling of backup files when stored locally. Nginx can be tricked into serving these files due to a lack of proper access control or path validation.
- **Impact of exploitation**: Successful exploitation can lead to a confidentiality breach by exposing backup files. These backup files likely contain sensitive information, including database content and application configurations.
- **Attack vectors**: The attack vector is network-based, requiring the attacker to craft a specific HTTP request to retrieve the backup file.
- **Required attacker capabilities/position**: An attacker needs to know the name of the backup file and must be able to send HTTP requests to the server. No privileges or user interaction are required to exploit this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.277 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.257 |
| 3 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | Allowed | sparse | 0.254 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.246 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.242 |
| 6 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | Allowed | sparse | 0.235 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.232 |
| 8 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.230 |
| 9 | 256 | Plaintext Storage of a Password | Base | Allowed | dense | 0.441 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

