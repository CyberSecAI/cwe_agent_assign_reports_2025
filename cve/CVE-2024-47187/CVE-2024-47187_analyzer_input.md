# Vulnerability Information: CVE-2024-47187

## Vulnerability Description
Suricata is a network Intrusion Detection System, Intrusion Prevention System and Network Security Monitoring engine. Prior to version 7.0.7, **missing initialization of the random seed for thash** leads to datasets having predictable hash table behavior. This can lead to dataset file loading to use excessive time to load, as well as runtime performance issues during traffic handling. This issue has been addressed in 7.0.7. As a workaround, avoid loading datasets from untrusted sources. Avoid dataset rules that track traffic in rules.

### Vulnerability Description Key Phrases
- **rootcause:** **missing initialization of the random seed for thash**
- **impact:** predictable hash table behavior and excessive time to load and runtime performance issues
- **product:** Suricata
- **version:** prior to 7.0.7

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

*   The `util-thash.c` file in Suricata initializes a random factor for hash table creation, but this factor is never used. This results in predictable hash table behavior.

**Weaknesses/Vulnerabilities:**

*   **Predictable Hash Collisions:** Due to the lack of a random seed in the hash function, hash collisions are predictable.
*   **Missing Random Seed:**  The core issue is the missing initialization of the random seed for the "thash" function used by datasets.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** An attacker can craft datasets that cause excessive hash collisions. This leads to:
    *   **Excessive Load Time:**  Dataset loading takes an unreasonable amount of time.
    *   **Runtime Performance Issues:** Traffic handling performance degrades significantly during runtime.
*   The vulnerability can be triggered by network traffic.

**Attack Vectors:**

*   **Malicious Datasets:** Attackers can craft malicious dataset files with predictable hash keys that exploit the lack of randomness in the hash function.
*   **Network Traffic:**  The issue can be triggered by network traffic as the hash function is used during the processing.

**Required Attacker Capabilities/Position:**

*   **Ability to provide malicious datasets:** An attacker needs to be able to provide malicious datasets to be loaded by Suricata, either through access to the filesystem or via configuration.
*   **Network access:** Alternatively, the attacker can send network traffic that triggers this hash function.

**Additional Details:**
*   The vulnerability is tracked as CVE-2024-47187 and also as GHSA-64ww-4f6x-863p.
*   The issue is present in Suricata versions prior to 7.0.7 and was fixed in 7.0.7.
*   The issue was also backported to the 7.0.x branch.
*   The vulnerability is rated as CRITICAL with a CVSS score of 7.5.
*   The weakness is categorized as CWE-330, which refers to the use of insufficiently random values.
* The affected hash function is StringHashDjb2.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | sparse | 0.438 |
| 2 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.409 |
| 3 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.406 |
| 4 | 1392 | Use of Default Credentials | Base | Allowed | sparse | 0.406 |
| 5 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.397 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.395 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.394 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.394 |
| 9 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | Allowed | dense | 0.399 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |

