# Vulnerability Information: CVE-2024-8238

## Vulnerability Description
In version 3.22.0 of aimhubio/aim, the AimQL query language uses an outdated version of the safer_getattr() function from RestrictedPython. This version does not protect against the str.format_map() method, allowing an attacker to leak server-side secrets or potentially gain unrestricted code execution. The vulnerability arises because **str.format_map() can read arbitrary attributes of Python objects**, enabling attackers to access sensitive variables such as os.environ. If an attacker can write files to a known location on the Aim server, they can use str.format_map() to load a malicious .dll/.so file into the Python interpreter, leading to unrestricted code execution.

### Vulnerability Description Key Phrases
- **component:** AimQL query language
- **rootcause:** **outdated version of safer_getattr() function**
- **weakness:** **str.format_map() can read arbitrary attributes of Python objects**
- **product:** aimhubio/aim
- **impact:** ['leak server-side secrets', 'potentially gain unrestricted code execution', 'unrestricted code execution']
- **attacker:** attacker
- **version:** 3.22.0

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.532 |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.520 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.511 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.508 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.499 |
| 6 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.498 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.498 |
| 8 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.496 |
| 9 | 36 | Absolute Path Traversal | Base | Allowed | dense | 0.479 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

