## Vulnerability Description
Synapse is an open-source Matrix homeserver. Synapse versions before 1.120.1 fail to properly validate invites received over federation. This vulnerability allows a malicious server to send a specially crafted invite that disrupts the invited users /sync functionality. Synapse 1.120.1 rejects such invalid invites received over federation and restores the ability to sync for affected users.

### Vulnerability Description Key Phrases
- **rootcause:** **improper invite validation**
- **impact:** disruption of /sync functionality
- **vector:** specially crafted invite
- **attacker:** malicious server
- **product:** Synapse
- **version:** before 1.120.1

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The vulnerability stems from a failure to properly validate invites received over federation.
- **Weaknesses/vulnerabilities present:** Improper input validation of federated invites.
- **Impact of exploitation:** A malicious server can send a specially crafted invite that disrupts the invited user's `/sync` functionality, effectively breaking the user's ability to synchronize.
- **Attack vectors:** The attack vector is network-based, leveraging federation between matrix servers. A malicious server sends a crafted invite to a vulnerable Synapse server.
- **Required attacker capabilities/position:** The attacker needs to control a malicious federated Matrix server. They do not require any privileges on the target server. No user interaction is needed to trigger the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.291 |
| 2 | 772 | Missing Release of Resource after Effective Lifetime | Base | Allowed | sparse | 0.287 |
| 3 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.275 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.272 |
| 5 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.263 |
| 6 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.262 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.262 |
| 8 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.258 |
| 9 | 346 | Origin Validation Error | Class | Allowed-with-Review | dense | 0.440 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-772: Missing Release of Resource after Effective Lifetime

CWE-20: Improper Input Validation

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-400: Uncontrolled Resource Consumption

CWE-1333: Inefficient Regular Expression Complexity

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-290: Authentication Bypass by Spoofing

CWE-346: Origin Validation Error

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')