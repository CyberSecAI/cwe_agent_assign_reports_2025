# Vulnerability Information: CVE-2024-6175

## Vulnerability Description
The Booking Ultra Pro Appointments Booking Calendar Plugin plugin for WordPress is vulnerable to unauthorized modification of data due to a **missing capability check** on the multiple functions in all versions up to, and including, 1.1.13. This makes it possible for authenticated attackers, with Subscriber-level access and above, to modify and delete. multiple plugin options and data such as payments, pricing, booking information, business hours, calendars, profile information, and email templates.

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **impact:** unauthorized modification of data
- **attacker:** authenticated attackers
- **product:** Booking Ultra Pro Appointments Booking Calendar Plugin
- **version:** all versions up to and including 1.1.13
- **component:** multiple functions

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from a missing authorization check in the Booking Ultra Pro Appointments Booking Calendar Plugin for WordPress. Specifically, multiple AJAX functions, such as `save_fields_settings`, `bup_delete_user_avatar`, and `bup_crop_avatar_user_profile_image`, lack proper capability checks.

**Weaknesses/Vulnerabilities:**
- **Missing Authorization:** The primary weakness is the absence of capability checks on AJAX functions, allowing unauthorized users to access and modify plugin settings.
- **Insecure Direct Object Reference:** Although not explicitly stated, the ability to modify data via AJAX requests without proper authorization suggests that the AJAX endpoints are vulnerable to insecure direct object references.

**Impact of Exploitation:**
- **Data Modification:** Authenticated attackers (Subscriber level and above) can modify various plugin options and data, including:
    - Payment settings
    - Pricing information
    - Booking details
    - Business hours
    - Calendars
    - Profile information
    - Email templates
- **Data Deletion:** Attackers can delete data, such as user avatars.
- **Potential for Further Exploitation:** Modifying sensitive settings could potentially lead to further exploitation or compromise of the site.

**Attack Vectors:**
- **Network:** The vulnerability can be exploited remotely over the network.
- **AJAX Requests:** Attackers send crafted AJAX requests to vulnerable functions to modify plugin settings.

**Required Attacker Capabilities/Position:**
- **Authentication:** The attacker needs to be authenticated as a WordPress user with at least Subscriber-level privileges.
- **Network Access:** The attacker needs network access to the WordPress site.

**Additional Notes:**
- The vulnerability is present in all versions up to and including 1.1.13 of the plugin.
- Version 1.1.14 patches this vulnerability.
- The Wordfence article provides more details than the original CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.514 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.470 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.467 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.448 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.438 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.415 |
| 7 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.413 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.401 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.480 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

