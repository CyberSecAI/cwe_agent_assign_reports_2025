## Vulnerability Description
A buffer overflow vulnerability exists in the adm.cgi set_TR069() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to **stack-based buffer overflow**. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Wavlink AC3000 M33A8
- **version:** V5030.210505
- **component:** adm.cgi set_TR069() functionality

## CVE Reference Links Content Summary
Here's the analysis of the provided content:

**Relevant Content Extracted:**

*   **Vulnerability:** Stack-based buffer overflow in the `adm.cgi`'s `set_TR069()` functionality.
*   **Affected Product:** Wavlink AC3000 M33A8.V5030.210505 wireless router.
*   **Root Cause:** Insufficient bounds checking on the `TR069_local_port` POST parameter when used in `sprintf` calls which copy the data to the stack.
*   **Weakness/Vulnerability:** CWE-120 - Buffer Copy without Checking Size of Input (‘Classic Buffer Overflow’)
*   **Impact:** Arbitrary code execution.
*   **Attack Vector:** An attacker can make an authenticated HTTP POST request to trigger this vulnerability.
    *   The attacker sends a POST request to `adm.cgi` with `page=TR069`.
    *   The attacker provides a long string as the value for the `TR069_local_port` parameter in the POST data.
*   **Required Attacker Capabilities/Position:**
    *   Authenticated user (administrator) on the router.
    *   Network access to the device.
*   **Details:**
    *   The `set_TR069` function copies the `TR069_local_port` POST parameter to the heap. Then the `TR069_local_port` is used in two `sprintf` calls to build iptables commands which are then copied to a stack buffer of size 0x100. Since the input isn't checked, a buffer overflow occurs.
    *   The vulnerability can be triggered by sending a POST request to the `adm.cgi` binary with the `page=TR069` parameter and a crafted `TR069_local_port` value (longer than 0x100 bytes).
*   **Mitigation/Fix:** The vendor has discontinued the product, but patches are being worked on.

**Note:** The content provides more detail than the official CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.329 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.316 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.282 |
| 6 | 195 | Signed to Unsigned Conversion Error | Variant | Allowed | sparse | 0.274 |
| 7 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.272 |
| 8 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.272 |
| 9 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | dense | 0.590 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-121: Stack-based Buffer Overflow

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-195: Signed to Unsigned Conversion Error

CWE-674: Uncontrolled Recursion

CWE-122: Heap-based Buffer Overflow

CWE-805: Buffer Access with Incorrect Length Value

CWE-128: Wrap-around Error