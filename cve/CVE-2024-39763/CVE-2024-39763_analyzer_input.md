# Vulnerability Information: CVE-2024-39763

## Vulnerability Description
Multiple OS command injection vulnerabilities exist in the internet.cgi set_add_routing() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary command execution. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.A command injection vulnerability exists in the `gateway` POST parameter.

### Vulnerability Description Key Phrases
- **component:** internet.cgi set_add_routing() functionality
- **vector:** specially crafted HTTP request
- **weakness:** **Multiple OS command injection vulnerabilities, OS command injection**
- **product:** Wavlink AC3000
- **impact:** arbitrary command execution
- **attacker:** attacker
- **version:** M33A8.V5030.210505

## CVE Reference Links Content Summary
Root cause of vulnerability:
The Wavlink AC3000 router's `internet.cgi` script does not properly sanitize user-supplied input from HTTP POST requests before using it in system commands executed via `popen`. Specifically, the `dest`, `hostnet`, `netmask`, `gateway`, `interface`, `custom_interface`, and `comment` parameters are vulnerable.

Weaknesses/vulnerabilities present:
- CWE-77: Improper Neutralization of Special Elements used in a Command (‘Command Injection’)
- Lack of input validation/sanitization in the `internet.cgi` script.
- Use of `popen` with unsanitized user input.

Impact of exploitation:
- Arbitrary command execution on the Wavlink AC3000 router.

Attack vectors:
- An attacker can send a crafted HTTP POST request to the `internet.cgi` script with malicious input in the vulnerable parameters.
- Requires network access to the device.
- Authentication is required (attacker needs to be a logged-in user).

Required attacker capabilities/position:
- Authenticated HTTP access to the router's web interface.
- Knowledge of the vulnerable parameters and how to craft a malicious HTTP POST request.

Mitigation or fix:
- The report does not specify a fix, but implies that proper input validation and sanitization are required to prevent command injection.
- The vendor is working on patches, but the product has been discontinued.

This content provides more detail than the official CVE description.

CVEs covered:
CVE-2024-39764
CVE-2024-39765
CVE-2024-39763
CVE-2024-39762

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.365 |
| 4 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.353 |
| 5 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.351 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.327 |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.325 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.319 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.654 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |

