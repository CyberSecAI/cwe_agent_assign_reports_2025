# Raw Retriever Results for CVE-2024-57900

# Raw Retriever Results for CVE-2024-57900
## Query
In the Linux kernel, the following vulnerability has been resolved ila serialize calls to nf_register_net_hooks() syzbot found a race in ila_add_mapping() [1] commit 031ae72825ce (ila call nf_unregister_net_hooks() sooner) attempted to fix a similar issue. Looking at the syzbot repro, we have concurrent ILA_CMD_ADD commands. Add a mutex to make sure at most one thread is calling nf_register_net_hooks(). [1] BUG KASAN slab-use-after-free in rht_key_hashfn include/linux/rhashtable.h159 [inline] BUG KASAN slab-use-after-free in __rhashtable_lookup.constprop.0+0x426/0x550 include/linux/rhashtable.h604 Read of size 4 at addr ffff888028f40008 by task dhcpcd/5501 CPU 1 UID 0 PID 5501 Comm dhcpcd Not tainted 6.13.0-rc4-syzkaller-00054-gd6ef8b40d075 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024 Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x116/0x1f0 lib/dump_stack.c120 print_address_description mm/kasan/report.c378 [inline] print_report+0xc3/0x620 mm/kasan/report.c489 kasan_report+0xd9/0x110 mm/kasan/report.c602 rht_key_hashfn include/linux/rhashtable.h159 [inline] __rhashtable_lookup.constprop.0+0x426/0x550 include/linux/rhashtable.h604 rhashtable_lookup include/linux/rhashtable.h646 [inline] rhashtable_lookup_fast include/linux/rhashtable.h672 [inline] ila_lookup_wildcards net/ipv6/ila/ila_xlat.c127 [inline] ila_xlat_addr net/ipv6/ila/ila_xlat.c652 [inline] ila_nf_input+0x1ee/0x620 net/ipv6/ila/ila_xlat.c185 nf_hook_entry_hookfn include/linux/netfilter.h154 [inline] nf_hook_slow+0xbb/0x200 net/netfilter/core.c626 nf_hook.constprop.0+0x42e/0x750 include/linux/netfilter.h269 NF_HOOK include/linux/netfilter.h312 [inline] ipv6_rcv+0xa4/0x680 net/ipv6/ip6_input.c309 __netif_receive_skb_one_core+0x12e/0x1e0 net/core/dev.c5672 __netif_receive_skb+0x1d/0x160 net/core/dev.c5785 process_backlog+0x443/0x15f0 net/core/dev.c6117 __napi_poll.constprop.0+0xb7/0x550 net/core/dev.c6883 napi_poll net/core/dev.c6952 [inline] net_rx_action+0xa94/0x1010 net/core/dev.c7074 handle_softirqs+0x213/0x8f0 kernel/softirq.c561 __do_softirq kernel/softirq.c595 [inline] invoke_softirq kernel/softirq.c435 [inline] __irq_exit_rcu+0x109/0x170 kernel/softirq.c662 irq_exit_rcu+0x9/0x30 kernel/softirq.c678 instr_sysvec_apic_timer_interrupt arch/x86/kernel/apic/apic.c1049 [inline] sysvec_apic_timer_interrupt+0xa4/0xc0 arch/x86/kernel/apic/apic.c1049

## Keyphrases
- **weakness**: 'slab-use-after-free', 'use-after-free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4877 | 0.5777 | 0.5246 | 0.5337 | 20 |
| Sparse | 609.7710 | 1000.0000 | 703.9710 | 655.3878 | 10 |
| Graph | 1.6315 | 3.3720 | 2.0827 | 1.9136 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 415 | Double Free | variant | 3.3720 | Allowed |
| 2 | 123 | Write-what-where Condition | base | 2.9120 | Allowed |
| 3 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 4 | 416 | Use After Free | Variant | 2.5555 | Allowed |
| 5 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 7 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 8 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | base | 2.2100 | Allowed |
| 9 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |
| 10 | 911 | Improper Update of Reference Count | Base | 2.0543 | Allowed |
| 11 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7729 | Allowed-with-Review |
| 12 | 134 | Use of Externally-Controlled Format String | base | 1.6848 | Allowed |
| 13 | 170 | Improper Null Termination | base | 1.6848 | Allowed |
| 14 | 826 | Premature Release of Resource During Expected Lifetime | base | 1.6848 | Allowed |
| 15 | 562 | Return of Stack Variable Address | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.5777 | 0.5777 | Allowed-with-Review |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5759 | 0.5759 | Allowed-with-Review |
| 3 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5497 | 0.5497 | Allowed |
| 4 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.5487 | 0.5487 | Allowed |
| 5 | 667 | Improper Locking | Class | 0.5433 | 0.5433 | Allowed-with-Review |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5416 | 0.5416 | Allowed |
| 7 | 121 | Stack-based Buffer Overflow | Variant | 0.5390 | 0.5390 | Allowed |
| 8 | 416 | Use After Free | Variant | 0.5375 | 0.5375 | Allowed |
| 9 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5363 | 0.5363 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5338 | 0.5338 | Allowed |
| 11 | 476 | NULL Pointer Dereference | Base | 0.5337 | 0.5337 | Allowed |
| 12 | 190 | Integer Overflow or Wraparound | Base | 0.5073 | 0.5073 | Allowed |
| 13 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5048 | 0.5048 | Discouraged |
| 14 | 122 | Heap-based Buffer Overflow | Variant | 0.4995 | 0.4995 | Allowed |
| 15 | 126 | Buffer Over-read | Variant | 0.4991 | 0.4991 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 416 | Use After Free | 1000.0000 | 1000.0000 | Allowed |
| 2 | 909 | Missing Initialization of Resource | 785.9693 | 785.9693 | Allowed-with-Review |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 724.1200 | 724.1200 | Allowed-with-Review |
| 4 | 415 | Double Free | 705.1709 | 705.1709 | Allowed |
| 5 | 911 | Improper Update of Reference Count | 666.0910 | 666.0910 | Allowed |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | 644.6847 | 644.6847 | Allowed |
| 7 | 667 | Improper Locking | 644.6819 | 644.6819 | Allowed-with-Review |
| 8 | 125 | Out-of-bounds Read | 635.1451 | 635.1451 | Allowed |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 624.0765 | 624.0765 | Allowed |
| 10 | 674 | Uncontrolled Recursion | 609.7710 | 609.7710 | Allowed-with-Review |
