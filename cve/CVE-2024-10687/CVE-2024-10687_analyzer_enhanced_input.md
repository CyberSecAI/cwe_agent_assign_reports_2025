## Vulnerability Description
The Photos, Files, YouTube, Twitter, Instagram, TikTok, Ecommerce Contest Gallery Upload, Vote, Sell via PayPal, Social Share Buttons plugin for WordPress is vulnerable to time-based SQL Injection via the $collectedIds parameter in all versions up to, and including, 24.0.3 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** unauthenticated attackers
- **product:** Photos and Files and YouTube and Twitter and Instagram and TikTok and Ecommerce Contest Gallery Upload and Vote and Sell via PayPal and Social Share Buttons WordPress plugin
- **version:** all versions up to and including 24.0.3
- **component:** $collectedIds parameter

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-10687:

**1. Verification of CVE Relevance:**

The content directly relates to CVE-2024-10687. It describes a vulnerability in the "Photos, Files, YouTube, Twitter, Instagram, TikTok, Ecommerce Contest Gallery" WordPress plugin, which is identified as CVE-2024-10687 by Wordfence.

**2. Root Cause of Vulnerability:**

*   **Insufficient Input Sanitization:** The plugin fails to properly sanitize the `$collectedIds` parameter before using it in a SQL query.
*   **Lack of Prepared Statements:** The existing SQL query lacks sufficient preparation, which allows an attacker to inject malicious SQL code.

**3. Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** A time-based SQL Injection vulnerability exists due to the lack of proper input sanitization and the failure to use prepared statements.

**4. Impact of Exploitation:**

*   **Sensitive Data Extraction:** Attackers can exploit the vulnerability to extract sensitive data from the WordPress database. This could include user credentials, personal information, and other confidential data.
*  **Full compromise of database**: Attackers can write additional queries, leading to full database compromise

**5. Attack Vectors:**

*   **Unauthenticated Access:** The vulnerability can be exploited by unauthenticated attackers, meaning no login is required.
*   **HTTP Request Manipulation:** Attackers manipulate the `$collectedIds` parameter in the HTTP request to inject SQL code.

**6. Required Attacker Capabilities/Position:**

*   **Remote Access:** Attackers can exploit this vulnerability remotely over the network.
*   **No Special Privileges:** The attacker doesn't need any special privileges or access to the WordPress system or database.

**Additional Notes:**

*   The Wordfence report provides a CVSS score of 9.8, classifying it as a critical vulnerability.
*   The vulnerability is present in versions <= 24.0.3 of the plugin.
*   The fix is to update the plugin to version 24.0.4 or a newer patched version.
*   The provided links to `plugins.trac.wordpress.org` give insight to the vulnerable code and the changes that were made to fix it.
* The vulnerable parameter is located in the file `v10/v10-frontend/ecommerce/ecommerce-get-raw-data-from-galleries.php`

This content provides more details than the official CVE description, which was just a placeholder.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.535 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.499 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.495 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.479 |
| 6 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.479 |
| 7 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.469 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.466 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.523 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-790: Improper Filtering of Special Elements

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-502: Deserialization of Untrusted Data

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-73: External Control of File Name or Path