# Vulnerability Information: CVE-2024-45678

## Vulnerability Description
Yubico YubiKey 5 Series devices with firmware before 5.7.0 and YubiHSM 2 devices with firmware before 2.4.0 allow an ECDSA secret-key extraction attack (that requires physical access and expensive equipment) in which an **electromagnetic side channel** is present because of a **non-constant-time modular inversion for the Extended Euclidean Algorithm**, aka the EUCLEAK issue. Other uses of an Infineon cryptographic library may also be affected.

### Vulnerability Description Key Phrases
- **rootcause:** **non-constant-time modular inversion for the Extended Euclidean Algorithm**
- **weakness:** **electromagnetic side channel**
- **impact:** ECDSA secret-key extraction
- **product:** Yubico YubiKey 5 Series devices and YubiHSM 2 devices
- **version:** before 5.7.0 and before 2.4.0

## CVE Reference Links Content Summary
```
{
  "related": true,
  "summary": "A side-channel vulnerability in Infineon's cryptographic library, used in YubiKey 5 and Security Key series (firmware prior to 5.7.0) and YubiHSM 2 (firmware prior to 2.4.0), allows attackers with physical access to recover ECDSA private keys. This is due to a non-constant-time modular inversion in the library's ECDSA implementation.",
  "vulnerability_details": {
    "root_cause": "The root cause of the vulnerability is a non-constant-time modular inversion within the Infineon cryptographic library's implementation of the Extended Euclidean Algorithm (EEA) used during ECDSA signature generation. This timing variation leaks information about the ephemeral ECDSA key (nonce).",
    "weaknesses": [
      "Side-channel vulnerability through timing variations during modular inversion.",
      "Non-constant time implementation of Extended Euclidean Algorithm (EEA).",
      "Use of a multiplicative mask for nonce blinding with limited (32-bit) size.",
      "Vulnerable Infineon cryptographic library used in multiple products."
    ],
    "impact": "Successful exploitation allows an attacker with physical access to a vulnerable device to recover the ECDSA private keys. This enables cloning of FIDO credentials, PIV and OpenPGP signing keys and HSM keys, bypassing security controls.",
     "attack_vectors": [
        "Physical access to the device is required.",
        "Side-channel analysis via electromagnetic emanations or power consumption measurements.",
        "Knowledge of accounts the attacker wants to target is required.",
        "Specialized equipment to perform side-channel analysis is required (oscilloscope, EM probe).",
        "May require knowledge of account username, PIN, password, or HSM authentication key."
     ],
    "attacker_capabilities": "An attacker needs physical possession of the vulnerable device, specialized equipment for side-channel analysis, knowledge of the target accounts, and potentially user PINs or passwords. Sophisticated knowledge of cryptography and electrical engineering is also required."
    }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.453 |
| 2 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.423 |
| 3 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | sparse | 0.415 |
| 4 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.406 |
| 5 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.390 |
| 6 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.383 |
| 7 | 1254 | Incorrect Comparison Logic Granularity | Base | Allowed | sparse | 0.374 |
| 8 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.370 |
| 9 | 1300 | Improper Protection of Physical Side Channels | Base | Allowed | dense | 0.602 |
| 10 | 385 | Covert Timing Channel | Base | Allowed | graph | 0.002 |

