# Raw Retriever Results for CVE-2024-6086

# Raw Retriever Results for CVE-2024-6086
## Query
In version 1.2.7 of lunary-ai/lunary, any authenticated user, regardless of their role, can change the name of an organization due to improper access control. The function checkAccess() is not implemented, allowing users with the lowest privileges, such as the Prompt Editor role, to modify organization attributes without proper authorization.

## Keyphrases
- **rootcause**: 'improper access control'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3295 | 0.4391 | 0.3705 | 0.3683 | 20 |
| Sparse | 92.0766 | 342.7362 | 291.4192 | 304.8953 | 11 |
| Graph | 1.0062 | 1.6794 | 1.2366 | 1.1466 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 842 | Placement of User into Incorrect Group | Base | 1.6794 | Allowed |
| 2 | 708 | Incorrect Ownership Assignment | Base | 1.6769 | Allowed |
| 3 | 283 | Unverified Ownership | Base | 1.6714 | Allowed |
| 4 | 267 | Privilege Defined With Unsafe Actions | Base | 1.6670 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.5210 | Allowed |
| 6 | 266 | Incorrect Privilege Assignment | Base | 1.4790 | Allowed |
| 7 | 425 | Direct Request ('Forced Browsing') | base | 1.2262 | Allowed |
| 8 | 610 | Externally Controlled Reference to a Resource in Another Sphere | class | 1.1920 | Discouraged |
| 9 | 1304 | Improperly Preserved Integrity of Hardware Configuration State During a Power Save/Restore Operation | base | 1.1466 | Allowed |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 1.1466 | Allowed |
| 11 | 358 | Improperly Implemented Security Check for Standard | base | 1.1466 | Allowed |
| 12 | 486 | Comparison of Classes by Name | variant | 1.0584 | Allowed |
| 13 | 282 | Improper Ownership Management | Class | 1.0345 | Allowed-with-Review |
| 14 | 286 | Incorrect User Management | Class | 1.0287 | Allowed-with-Review |
| 15 | 863 | Incorrect Authorization | Class | 1.0137 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 842 | Placement of User into Incorrect Group | Base | 0.4391 | 0.4391 | Allowed |
| 2 | 708 | Incorrect Ownership Assignment | Base | 0.4229 | 0.4229 | Allowed |
| 3 | 282 | Improper Ownership Management | Class | 0.4127 | 0.4127 | Allowed-with-Review |
| 4 | 283 | Unverified Ownership | Base | 0.4087 | 0.4087 | Allowed |
| 5 | 286 | Incorrect User Management | Class | 0.3991 | 0.3991 | Allowed-with-Review |
| 6 | 939 | Improper Authorization in Handler for Custom URL Scheme | Base | 0.3943 | 0.3943 | Allowed |
| 7 | 267 | Privilege Defined With Unsafe Actions | Base | 0.3934 | 0.3934 | Allowed |
| 8 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.3919 | 0.3919 | Allowed |
| 9 | 915 | Improperly Controlled Modification of Dynamically-Determined Object Attributes | Base | 0.3911 | 0.3911 | Allowed |
| 10 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.3896 | 0.3896 | Allowed |
| 11 | 620 | Unverified Password Change | Base | 0.3469 | 0.3469 | Allowed |
| 12 | 224 | Obscured Security-relevant Information by Alternate Name | Base | 0.3455 | 0.3455 | Allowed |
| 13 | 268 | Privilege Chaining | Base | 0.3400 | 0.3400 | Allowed |
| 14 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.3356 | 0.3356 | Allowed |
| 15 | 1220 | Insufficient Granularity of Access Control | Base | 0.3354 | 0.3354 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 342.7362 | 342.7362 | Allowed-with-Review |
| 2 | 285 | Improper Authorization | 335.9932 | 335.9932 | Discouraged |
| 3 | 267 | Privilege Defined With Unsafe Actions | 321.3216 | 321.3216 | Allowed |
| 4 | 610 | Externally Controlled Reference to a Resource in Another Sphere | 308.9611 | 308.9611 | Discouraged |
| 5 | 269 | Improper Privilege Management | 305.6855 | 305.6855 | Discouraged |
| 6 | 472 | External Control of Assumed-Immutable Web Parameter | 304.8953 | 304.8953 | Allowed |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | 304.5195 | 304.5195 | Allowed |
| 8 | 862 | Missing Authorization | 301.2646 | 301.2646 | Allowed-with-Review |
| 9 | 284 | Improper Access Control | 299.8102 | 299.8102 | Discouraged |
| 10 | 306 | Missing Authentication for Critical Function | 288.3478 | 288.3478 | Allowed |
| 11 | 352 | Cross-Site Request Forgery (CSRF) | 92.0766 | 92.0766 | Allowed |
