## Vulnerability Description
The The Coupon Affiliates Affiliate Plugin for WooCommerce plugin for WordPress is vulnerable to arbitrary shortcode execution in all versions up to, and including, 5.16.7.1. This is due to the software allowing users to execute an action that does not properly validate a value before running do_shortcode. This makes it possible for unauthenticated attackers to execute arbitrary shortcodes. This functionality is also vulnerable to Reflected **Cross-Site Scripting**. The **Cross-Site Scripting** was patched in version 5.16.7.1, while the arbitrary shortcode execution was patched in 5.16.7.2.

### Vulnerability Description Key Phrases
- **rootcause:** **executing action that does not properly validate value before running do_shortcode**
- **weakness:** **Cross-Site Scripting**
- **impact:** arbitrary shortcode execution
- **attacker:** unauthenticated attackers
- **product:** The Coupon Affiliates Affiliate Plugin for WooCommerce
- **version:** all versions up to and including 5.16.7.1

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The plugin allows users to execute an action that does not properly validate a value before running `do_shortcode`.",
    "weaknesses": [
      "Unauthenticated Arbitrary Shortcode Execution",
      "Reflected Cross-Site Scripting"
    ],
    "impact": "Unauthenticated attackers can execute arbitrary shortcodes, potentially leading to malicious code injection and reflected XSS.",
    "attack_vectors": "An unauthenticated attacker can trigger the vulnerable functionality by crafting a malicious request with an unvalidated value that gets passed to `do_shortcode`.",
    "required_capabilities": "The attacker needs no specific capabilities or position, they can be unauthenticated."
  },
  "fixes": [
    "The Cross-Site Scripting was patched in version 5.16.7.1",
    "The arbitrary shortcode execution was patched in 5.16.7.2"
  ],
  "details": "The vulnerability is present in the `Coupon Affiliates â€“ Affiliate Plugin for WooCommerce` plugin for WordPress. The plugin fails to validate user-provided input before passing it to the `do_shortcode` function. This allows an unauthenticated user to inject malicious shortcodes and execute them on the website. Additionally, there is a reflected Cross-Site Scripting vulnerability.",
  "affected_versions": "<= 5.16.7.1",
  "patched_version": "5.16.7.2",
   "cve_description": "PLACEHOLDER - Implement CVE description retrieval"
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.713 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.657 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.646 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.644 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.636 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.631 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.612 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.603 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.558 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-862: Missing Authorization

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-138: Improper Neutralization of Special Elements

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-863: Incorrect Authorization

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-73: External Control of File Name or Path