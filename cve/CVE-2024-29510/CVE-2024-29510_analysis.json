{
  "cve_id": "CVE-2024-29510",
  "description": "Artifex Ghostscript before 10.03.1 allows **memory corruption**, and SAFER **sandbox bypass**, via ****format string injection**** with a uniprint device.",
  "key_phrases": {
    "rootcause": "format string injection",
    "weakness": [
      "format string injection",
      "memory corruption",
      "sandbox bypass"
    ],
    "impact": "SAFER sandbox bypass",
    "vector": "",
    "attacker": "",
    "product": "Artifex Ghostscript",
    "version": "before 10.03.1",
    "component": "uniprint device"
  },
  "reference_content": "Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2024-29510:\n\n**Root Cause:**\n\n*   The `uniprint` device in Ghostscript allows users to specify string fragments as device options. Two specific parameters, `upWriteComponentCommands` and `upYMoveCommand`, are treated as format strings during output generation, specifically when using the Pcl output format. The format string is used with `gs_snprintf`.\n*   There is no validation or sanitization of these format strings, allowing an attacker to inject arbitrary format specifiers.\n\n**Weaknesses/Vulnerabilities:**\n\n*   **Format String Vulnerability:** The primary vulnerability is the uncontrolled use of user-supplied strings as format specifiers in `gs_snprintf`, allowing for format string injection. The format string parsing logic is not hardened by compiler measures like `D_FORTIFY_SOURCE`, while it still supports the `%n` modifier.\n*   Lack of input validation: The application does not validate the contents of the `upWriteComponentCommands` and `upYMoveCommand` parameters.\n*   **Information Leakage:** Attackers can use format string specifiers like `%x` and `%s` to read arbitrary data from the stack.\n*   **Memory Corruption:** Using the `%n` format specifier, attackers can write to memory addresses on the stack, allowing for memory corruption.\n*  **SAFER sandbox bypass:** By corrupting a specific memory location, the `path_control_active` flag can be set to zero, bypassing the `-dSAFER` sandbox.\n\n**Impact of Exploitation:**\n\n*   **Arbitrary Code Execution:** By combining the information leak and memory corruption capabilities, an attacker can disable the `-dSAFER` sandbox and execute arbitrary shell commands.\n*   **Information Disclosure:** The attacker can leak sensitive information from the stack, such as environment variables, pointers, and stack cookies.\n*   **Control Flow Hijacking:** The arbitrary write primitive could be used to hijack the control flow of the application, leading to arbitrary code execution.\n*   **Bypass of security measures:** The `-dSAFER` sandbox is designed to limit access and prevent system commands. This vulnerability allows bypassing this mechanism.\n\n**Attack Vectors:**\n\n*   **Specially crafted PostScript files:** An attacker can create a specially crafted PostScript file that uses `setpagedevice` to configure the `uniprint` device and set the vulnerable format string parameters.\n*   **File Upload:** This exploit can be used when a user uploads a document, like an EPS file, to a web service which uses Ghostscript (directly or indirectly) for file conversion or preview.\n*   **Embedded files:** The exploit can also be embedded in files like LibreOffice documents which internally use Ghostscript for rendering (e.g. embedded EPS).\n\n**Required Attacker Capabilities/Position:**\n\n*   **Ability to supply a Postscript file to Ghostscript:** The attacker needs to be able to provide a malicious PostScript file as input to a vulnerable Ghostscript process.\n*   **Ability to read the output:** The attacker needs read access to the device output (e.g. by setting it to a temporary file path).\n*   **Understanding of format string vulnerabilities:** The attacker needs knowledge of how format string vulnerabilities can be exploited.\n\n**Additional Notes:**\n\n* The vulnerability is present in Ghostscript versions <= 10.03.0 (but >= 9.50).\n* The vulnerability was fixed in Ghostscript version 10.03.1.\n* The fix involves preventing PostScript code from altering the `upWriteComponentCommands` and `upYMoveCommand` parameters when `-dSAFER` is enabled. These parameters can only be set from the command line when `-dSAFER` is active.\n* The vulnerability is exploitable because the parameters `upWriteComponentCommands` and `upYMoveCommand` can be set via the `setpagedevice` operator, which is available in the SAFER sandbox, and there is no mechanism to prevent the user from supplying format string specifiers.\n* The `gs_snprintf` function used for string formatting does not implement protections against format string vulnerabilities (such as `FORTIFY_SOURCE`).\n* The vulnerability can be used to bypass the `-dSAFER` sandbox via a memory corruption exploit, ultimately leading to arbitrary command execution.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "```markdown\n# Summary\n| CWE ID   | CWE Name                                                                | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| -------- | ----------------------------------------------------------------------- | ---------- | ----------------------- | ------------------------------- | ------------------------------- |\n| CWE-134  | Use of Externally-Controlled Format String                             | 0.9        | Base                    | Primary                         | Allowed                        |\n| CWE-787  | Out-of-bounds Write                                                     | 0.7        | Base                    | Secondary                       | Allowed                        |\n| CWE-653 | Improper Isolation or Compartmentalization | 0.5 | Class | Secondary | Allowed-with-Review |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary weakness is **format string injection**, which directly corresponds to CWE-134. The **memory corruption** aspect suggests CWE-787. The **sandbox bypass** implies a failure in isolation, leading to CWE-653. CWE-134 can lead to memory corruption and potentially sandbox bypass, establishing a chain.\n\n```mermaid\ngraph TD\n    cwe134[\"CWE-134: Use of Externally-Controlled Format String\"]\n    cwe787[\"CWE-787: Out-of-bounds Write\"]\n    cwe653[\"CWE-653: Improper Isolation or Compartmentalization\"]\n\n    cwe134 -->|CANPRECEDE| cwe787\n    cwe134 -->|CANPRECEDE| cwe653\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe134 primary\n    class cwe787,cwe653 secondary\n```\n\n## Vulnerability Chain\n1.  **Root Cause:** CWE-134 (Use of Externally-Controlled Format String) - The application uses a format string from an external source without proper sanitization.\n2.  **Weakness 1:** Memory Corruption - The format string injection leads to memory corruption (CWE-787).\n3.  **Weakness 2:** SAFER Sandbox Bypass - The memory corruption allows bypassing the SAFER sandbox (CWE-653).\n\n## Summary of Analysis\nThe primary CWE is CWE-134, as the vulnerability description explicitly mentions **format string injection** as the root cause. This aligns perfectly with the definition of CWE-134, which involves using an externally-controlled format string. The resulting **memory corruption** maps to CWE-787 and the **sandbox bypass** maps to CWE-653. The retriever results also strongly suggest CWE-134.\n\nThe other suggested CWEs were considered but deemed less relevant:\n\n*   CWE-95 ('Eval Injection'): While related to code injection, the description specifically mentions format string issues, making CWE-134 more precise.\n*   CWE-78 ('OS Command Injection'): Not applicable as the vulnerability does not involve OS commands.\n\nThe selected CWEs are at the base level of abstraction, providing sufficient detail for the identified weaknesses.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-138: Improper Neutralization of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n\n\n## CWE-345: Insufficient Verification of Data Authenticity\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-134: Use of Externally-Controlled Format String\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product uses a function that accepts a format string as an argument, but the format string originates from an external source.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-41: Improper Resolution of Path Equivalence\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product is vulnerable to file system contents disclosure through path equivalence. Path equivalence involves the use of special characters in file and directory names. The associated manipulations are intended to generate multiple names for the same object.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-703: Improper Check or Handling of Exceptional Conditions\n**Abstraction Level**: Pillar\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is extremely high-level, a Pillar.\n\n\n\n## CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.\n\n\n\n## CWE-696: Incorrect Behavior Order\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\n**Abstraction Level**: Variant\n**Similarity Score**: 3548.87\n**Source**: sparse\n\n**Description**:\nThe product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes code syntax before using the input in a dynamic evaluation call (e.g. \"eval\").\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale",
  "analysis_with_relationships": "# Summary\n| CWE ID   | CWE Name                                                                | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| -------- | ----------------------------------------------------------------------- | ---------- | ----------------------- | ------------------------------- | ------------------------------- |\n| CWE-134  | Use of Externally-Controlled Format String                             | 0.9        | Base                    | Primary                         | Allowed                        |\n| CWE-787  | Out-of-bounds Write                                                     | 0.7        | Base                    | Secondary                       | Allowed                        |\n| CWE-653 | Improper Isolation or Compartmentalization | 0.5 | Class | Secondary | Allowed-with-Review |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary weakness is **format string injection**, which directly corresponds to CWE-134. The **memory corruption** aspect suggests CWE-787. The **sandbox bypass** implies a failure in isolation, leading to CWE-653. CWE-134 can lead to memory corruption and potentially sandbox bypass, establishing a chain.mermaid\n```mermaid\ngraph TD\n    cwe134[\"CWE-134: Use of Externally-Controlled Format String\"]\n    cwe787[\"CWE-787: Out-of-bounds Write\"]\n    cwe653[\"CWE-653: Improper Isolation or Compartmentalization\"]\n\n    cwe134 -->|CANPRECEDE| cwe787\n    cwe134 -->|CANPRECEDE| cwe653\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe134 primary\n    class cwe787,cwe653 secondary\n\n```\n\n\n## Vulnerability Chain\n1.  **Root Cause:** CWE-134 (Use of Externally-Controlled Format String) - The application uses a format string from an external source without proper sanitization.\n2.  **Weakness 1:** Memory Corruption - The format string injection leads to memory corruption (CWE-787).\n3.  **Weakness 2:** SAFER Sandbox Bypass - The memory corruption allows bypassing the SAFER sandbox (CWE-653).\n\n## Summary of Analysis\nThe primary CWE is CWE-134, as the vulnerability description explicitly mentions **format string injection** as the root cause. This aligns perfectly with the definition of CWE-134, which involves using an externally-controlled format string. The resulting **memory corruption** maps to CWE-787 and the **sandbox bypass** maps to CWE-653. The retriever results also strongly suggest CWE-134.\n\nThe other suggested CWEs were considered but deemed less relevant:\n\n*   CWE-95 ('Eval Injection'): While related to code injection, the description specifically mentions format string issues, making CWE-134 more precise.\n*   CWE-78 ('OS Command Injection'): Not applicable as the vulnerability does not involve OS commands.\n\nThe selected CWEs are at the base level of abstraction, providing sufficient detail for the identified weaknesses.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-138: Improper Neutralization of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n\n\n## CWE-345: Insufficient Verification of Data Authenticity\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-134: Use of Externally-Controlled Format String\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product uses a function that accepts a format string as an argument, but the format string originates from an external source.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-41: Improper Resolution of Path Equivalence\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product is vulnerable to file system contents disclosure through path equivalence. Path equivalence involves the use of special characters in file and directory names. The associated manipulations are intended to generate multiple names for the same object.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-703: Improper Check or Handling of Exceptional Conditions\n**Abstraction Level**: Pillar\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is extremely high-level, a Pillar.\n\n\n\n## CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.\n\n\n\n## CWE-696: Incorrect Behavior Order\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\n**Abstraction Level**: Variant\n**Similarity Score**: 3548.87\n**Source**: sparse\n\n**Description**:\nThe product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes code syntax before using the input in a dynamic evaluation call (e.g. \"eval\").\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-653:**\n- 653 (Improper Isolation or Compartmentalization) - ROOT\n\n\n**Chain starting from CWE-345:**\n- 345 (Insufficient Verification of Data Authenticity) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "134",
        "name": "Use of Externally-Controlled Format String",
        "source": "sparse",
        "original_content": "The product uses a function that accepts a format string as an argument, but the format string originates from an external source.",
        "keyphrase_sources": [
          {
            "id": "rootcause:format string injection",
            "keyphrase": "format string injection",
            "type": "rootcause"
          },
          {
            "id": "weakness:format string injection",
            "keyphrase": "format string injection",
            "type": "weakness"
          },
          {
            "id": "weakness:memory corruption",
            "keyphrase": "memory corruption",
            "type": "weakness"
          },
          {
            "id": "product:Artifex Ghostscript",
            "keyphrase": "Artifex Ghostscript",
            "type": "product"
          },
          {
            "id": "component:uniprint device",
            "keyphrase": "uniprint device",
            "type": "component"
          }
        ]
      },
      "similarity": 191.83597583697062
    },
    {
      "metadata": {
        "doc_id": "95",
        "name": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
        "source": "sparse",
        "original_content": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes code syntax before using the input in a dynamic evaluation call (e.g. \"eval\").",
        "keyphrase_sources": [
          {
            "id": "rootcause:format string injection",
            "keyphrase": "format string injection",
            "type": "rootcause"
          },
          {
            "id": "weakness:format string injection",
            "keyphrase": "format string injection",
            "type": "weakness"
          },
          {
            "id": "product:Artifex Ghostscript",
            "keyphrase": "Artifex Ghostscript",
            "type": "product"
          },
          {
            "id": "version:before 10.03.1",
            "keyphrase": "before 10.03.1",
            "type": "version"
          },
          {
            "id": "component:uniprint device",
            "keyphrase": "uniprint device",
            "type": "component"
          }
        ]
      },
      "similarity": 145.7093165591434
    },
    {
      "metadata": {
        "doc_id": "115",
        "name": "Misinterpretation of Input",
        "source": "sparse",
        "original_content": "The product misinterprets an input, whether from an attacker or another product, in a security-relevant fashion.",
        "keyphrase_sources": [
          {
            "id": "rootcause:format string injection",
            "keyphrase": "format string injection",
            "type": "rootcause"
          },
          {
            "id": "weakness:format string injection",
            "keyphrase": "format string injection",
            "type": "weakness"
          }
        ]
      },
      "similarity": 145.01288591427547
    },
    {
      "metadata": {
        "doc_id": "1286",
        "name": "Improper Validation of Syntactic Correctness of Input",
        "source": "sparse",
        "original_content": "The product receives input that is expected to be well-formed - i.e., to comply with a certain syntax - but it does not validate or incorrectly validates that the input complies with the syntax.",
        "keyphrase_sources": [
          {
            "id": "rootcause:format string injection",
            "keyphrase": "format string injection",
            "type": "rootcause"
          },
          {
            "id": "weakness:format string injection",
            "keyphrase": "format string injection",
            "type": "weakness"
          }
        ]
      },
      "similarity": 128.17401990085366
    },
    {
      "metadata": {
        "doc_id": "787",
        "name": "Out-of-bounds Write",
        "source": "sparse",
        "original_content": "The product writes data past the end, or before the beginning, of the intended buffer.",
        "keyphrase_sources": [
          {
            "id": "weakness:memory corruption",
            "keyphrase": "memory corruption",
            "type": "weakness"
          },
          {
            "id": "product:Artifex Ghostscript",
            "keyphrase": "Artifex Ghostscript",
            "type": "product"
          }
        ]
      },
      "similarity": 126.82948395197059
    },
    {
      "metadata": {
        "doc_id": "122",
        "name": "Heap-based Buffer Overflow",
        "source": "sparse",
        "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().",
        "keyphrase_sources": [
          {
            "id": "weakness:memory corruption",
            "keyphrase": "memory corruption",
            "type": "weakness"
          },
          {
            "id": "weakness:sandbox bypass",
            "keyphrase": "sandbox bypass",
            "type": "weakness"
          },
          {
            "id": "impact:SAFER sandbox bypass",
            "keyphrase": "SAFER sandbox bypass",
            "type": "impact"
          },
          {
            "id": "product:Artifex Ghostscript",
            "keyphrase": "Artifex Ghostscript",
            "type": "product"
          }
        ]
      },
      "similarity": 121.00667522426139
    },
    {
      "metadata": {
        "doc_id": "843",
        "name": "Access of Resource Using Incompatible Type ('Type Confusion')",
        "source": "sparse",
        "original_content": "The product allocates or initializes a resource such as a pointer, object, or variable using one type, but it later accesses that resource using a type that is incompatible with the original type.",
        "keyphrase_sources": [
          {
            "id": "weakness:memory corruption",
            "keyphrase": "memory corruption",
            "type": "weakness"
          }
        ]
      },
      "similarity": 118.98596262872219
    },
    {
      "metadata": {
        "doc_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "source": "sparse",
        "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.",
        "keyphrase_sources": [
          {
            "id": "weakness:memory corruption",
            "keyphrase": "memory corruption",
            "type": "weakness"
          },
          {
            "id": "weakness:sandbox bypass",
            "keyphrase": "sandbox bypass",
            "type": "weakness"
          },
          {
            "id": "impact:SAFER sandbox bypass",
            "keyphrase": "SAFER sandbox bypass",
            "type": "impact"
          },
          {
            "id": "product:Artifex Ghostscript",
            "keyphrase": "Artifex Ghostscript",
            "type": "product"
          },
          {
            "id": "component:uniprint device",
            "keyphrase": "uniprint device",
            "type": "component"
          }
        ]
      },
      "similarity": 117.36899578073275
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "source": "sparse",
        "original_content": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
        "keyphrase_sources": [
          {
            "id": "rootcause:format string injection",
            "keyphrase": "format string injection",
            "type": "rootcause"
          },
          {
            "id": "weakness:format string injection",
            "keyphrase": "format string injection",
            "type": "weakness"
          },
          {
            "id": "version:before 10.03.1",
            "keyphrase": "before 10.03.1",
            "type": "version"
          }
        ]
      },
      "similarity": 116.70976179141692
    },
    {
      "metadata": {
        "doc_id": "183",
        "name": "Permissive List of Allowed Inputs",
        "source": "sparse",
        "original_content": "The product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are explicitly allowed by policy because the inputs are assumed to be safe, but the list is too permissive - that is, it allows an input that is unsafe, leading to resultant weaknesses.",
        "keyphrase_sources": [
          {
            "id": "weakness:sandbox bypass",
            "keyphrase": "sandbox bypass",
            "type": "weakness"
          },
          {
            "id": "impact:SAFER sandbox bypass",
            "keyphrase": "SAFER sandbox bypass",
            "type": "impact"
          }
        ]
      },
      "similarity": 104.58715860715738
    },
    {
      "metadata": {
        "doc_id": "653",
        "name": "Improper Isolation or Compartmentalization",
        "source": "sparse",
        "original_content": "The product does not properly compartmentalize or isolate functionality, processes, or resources that require different privilege levels, rights, or permissions.",
        "keyphrase_sources": [
          {
            "id": "weakness:sandbox bypass",
            "keyphrase": "sandbox bypass",
            "type": "weakness"
          },
          {
            "id": "impact:SAFER sandbox bypass",
            "keyphrase": "SAFER sandbox bypass",
            "type": "impact"
          }
        ]
      },
      "similarity": 98.32211556906523
    },
    {
      "metadata": {
        "doc_id": "470",
        "name": "Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')",
        "source": "sparse",
        "original_content": "The product uses external input with reflection to select which classes or code to use, but it does not sufficiently prevent the input from selecting improper classes or code.",
        "keyphrase_sources": [
          {
            "id": "weakness:sandbox bypass",
            "keyphrase": "sandbox bypass",
            "type": "weakness"
          },
          {
            "id": "impact:SAFER sandbox bypass",
            "keyphrase": "SAFER sandbox bypass",
            "type": "impact"
          }
        ]
      },
      "similarity": 95.49953041487198
    },
    {
      "metadata": {
        "doc_id": "121",
        "name": "Stack-based Buffer Overflow",
        "source": "sparse",
        "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).",
        "keyphrase_sources": [
          {
            "id": "version:before 10.03.1",
            "keyphrase": "before 10.03.1",
            "type": "version"
          }
        ]
      },
      "similarity": 44.156970992300835
    },
    {
      "metadata": {
        "doc_id": "36",
        "name": "Absolute Path Traversal",
        "source": "sparse",
        "original_content": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize absolute path sequences such as \"/abs/path\" that can resolve to a location that is outside of that directory.",
        "keyphrase_sources": [
          {
            "id": "version:before 10.03.1",
            "keyphrase": "before 10.03.1",
            "type": "version"
          }
        ]
      },
      "similarity": 39.1910043611661
    },
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "sparse",
        "original_content": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.",
        "keyphrase_sources": [
          {
            "id": "version:before 10.03.1",
            "keyphrase": "before 10.03.1",
            "type": "version"
          }
        ]
      },
      "similarity": 39.10140411158265
    },
    {
      "metadata": {
        "doc_id": "20",
        "name": "Improper Input Validation",
        "source": "sparse",
        "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
        "keyphrase_sources": [
          {
            "id": "component:uniprint device",
            "keyphrase": "uniprint device",
            "type": "component"
          }
        ]
      },
      "similarity": 32.24482522381193
    },
    {
      "metadata": {
        "doc_id": "457",
        "name": "Use of Uninitialized Variable",
        "source": "sparse",
        "original_content": "The code uses a variable that has not been initialized, leading to unpredictable or unintended results.",
        "keyphrase_sources": [
          {
            "id": "component:uniprint device",
            "keyphrase": "uniprint device",
            "type": "component"
          }
        ]
      },
      "similarity": 31.56410300905893
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-653",
      "CWE-345",
      "CWE-703",
      "CWE-787",
      "CWE-95",
      "CWE-696",
      "CWE-74",
      "CWE-668",
      "CWE-78",
      "CWE-138",
      "CWE-134",
      "CWE-497",
      "CWE-212",
      "CWE-41"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {
    "134": [
      {
        "id": "rootcause:format string injection",
        "keyphrase": "format string injection",
        "type": "rootcause"
      },
      {
        "id": "weakness:format string injection",
        "keyphrase": "format string injection",
        "type": "weakness"
      },
      {
        "id": "weakness:memory corruption",
        "keyphrase": "memory corruption",
        "type": "weakness"
      },
      {
        "id": "product:Artifex Ghostscript",
        "keyphrase": "Artifex Ghostscript",
        "type": "product"
      },
      {
        "id": "component:uniprint device",
        "keyphrase": "uniprint device",
        "type": "component"
      }
    ],
    "95": [
      {
        "id": "rootcause:format string injection",
        "keyphrase": "format string injection",
        "type": "rootcause"
      },
      {
        "id": "weakness:format string injection",
        "keyphrase": "format string injection",
        "type": "weakness"
      },
      {
        "id": "product:Artifex Ghostscript",
        "keyphrase": "Artifex Ghostscript",
        "type": "product"
      },
      {
        "id": "version:before 10.03.1",
        "keyphrase": "before 10.03.1",
        "type": "version"
      },
      {
        "id": "component:uniprint device",
        "keyphrase": "uniprint device",
        "type": "component"
      }
    ],
    "115": [
      {
        "id": "rootcause:format string injection",
        "keyphrase": "format string injection",
        "type": "rootcause"
      },
      {
        "id": "weakness:format string injection",
        "keyphrase": "format string injection",
        "type": "weakness"
      }
    ],
    "1286": [
      {
        "id": "rootcause:format string injection",
        "keyphrase": "format string injection",
        "type": "rootcause"
      },
      {
        "id": "weakness:format string injection",
        "keyphrase": "format string injection",
        "type": "weakness"
      }
    ],
    "78": [
      {
        "id": "rootcause:format string injection",
        "keyphrase": "format string injection",
        "type": "rootcause"
      },
      {
        "id": "weakness:format string injection",
        "keyphrase": "format string injection",
        "type": "weakness"
      },
      {
        "id": "version:before 10.03.1",
        "keyphrase": "before 10.03.1",
        "type": "version"
      }
    ],
    "787": [
      {
        "id": "weakness:memory corruption",
        "keyphrase": "memory corruption",
        "type": "weakness"
      },
      {
        "id": "product:Artifex Ghostscript",
        "keyphrase": "Artifex Ghostscript",
        "type": "product"
      }
    ],
    "122": [
      {
        "id": "weakness:memory corruption",
        "keyphrase": "memory corruption",
        "type": "weakness"
      },
      {
        "id": "weakness:sandbox bypass",
        "keyphrase": "sandbox bypass",
        "type": "weakness"
      },
      {
        "id": "impact:SAFER sandbox bypass",
        "keyphrase": "SAFER sandbox bypass",
        "type": "impact"
      },
      {
        "id": "product:Artifex Ghostscript",
        "keyphrase": "Artifex Ghostscript",
        "type": "product"
      }
    ],
    "843": [
      {
        "id": "weakness:memory corruption",
        "keyphrase": "memory corruption",
        "type": "weakness"
      }
    ],
    "367": [
      {
        "id": "weakness:memory corruption",
        "keyphrase": "memory corruption",
        "type": "weakness"
      },
      {
        "id": "weakness:sandbox bypass",
        "keyphrase": "sandbox bypass",
        "type": "weakness"
      },
      {
        "id": "impact:SAFER sandbox bypass",
        "keyphrase": "SAFER sandbox bypass",
        "type": "impact"
      },
      {
        "id": "product:Artifex Ghostscript",
        "keyphrase": "Artifex Ghostscript",
        "type": "product"
      },
      {
        "id": "component:uniprint device",
        "keyphrase": "uniprint device",
        "type": "component"
      }
    ],
    "183": [
      {
        "id": "weakness:sandbox bypass",
        "keyphrase": "sandbox bypass",
        "type": "weakness"
      },
      {
        "id": "impact:SAFER sandbox bypass",
        "keyphrase": "SAFER sandbox bypass",
        "type": "impact"
      }
    ],
    "653": [
      {
        "id": "weakness:sandbox bypass",
        "keyphrase": "sandbox bypass",
        "type": "weakness"
      },
      {
        "id": "impact:SAFER sandbox bypass",
        "keyphrase": "SAFER sandbox bypass",
        "type": "impact"
      }
    ],
    "470": [
      {
        "id": "weakness:sandbox bypass",
        "keyphrase": "sandbox bypass",
        "type": "weakness"
      },
      {
        "id": "impact:SAFER sandbox bypass",
        "keyphrase": "SAFER sandbox bypass",
        "type": "impact"
      }
    ],
    "121": [
      {
        "id": "version:before 10.03.1",
        "keyphrase": "before 10.03.1",
        "type": "version"
      }
    ],
    "36": [
      {
        "id": "version:before 10.03.1",
        "keyphrase": "before 10.03.1",
        "type": "version"
      }
    ],
    "284": [
      {
        "id": "version:before 10.03.1",
        "keyphrase": "before 10.03.1",
        "type": "version"
      }
    ],
    "20": [
      {
        "id": "component:uniprint device",
        "keyphrase": "uniprint device",
        "type": "component"
      }
    ],
    "457": [
      {
        "id": "component:uniprint device",
        "keyphrase": "uniprint device",
        "type": "component"
      }
    ]
  }
}