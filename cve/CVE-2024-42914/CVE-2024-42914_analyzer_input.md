# Vulnerability Information: CVE-2024-42914

## Vulnerability Description
A **host header injection** vulnerability exists in the forgot password functionality of ArrowCMS version 1.0.0. By sending a specially crafted host header in the forgot password request, it is possible to send password reset links to users which, once clicked, lead to an attacker-controlled server and thus leak the password reset token. This may allow an attacker to reset other users passwords.

### Vulnerability Description Key Phrases
- **weakness:** **host header injection**
- **impact:** password reset links to attacker-controlled server
- **product:** ArrowCMS
- **version:** 1.0.0
- **component:** forgot password functionality

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability related to CVE-2024-42914:

**Root Cause of Vulnerability:**
- The vulnerability stems from the "Forgot Password" functionality in ArrowCMS version 1.0.0 which is susceptible to a host header injection. Specifically, the application does not properly validate or sanitize the host header in the request, leading to the possibility of manipulating the password reset link generation.

**Weaknesses/Vulnerabilities Present:**
- **Host Header Injection:** The primary vulnerability is the application's failure to validate the "Host" header in the password reset request. This allows an attacker to inject a malicious host, causing the password reset email to contain a link pointing to an attacker-controlled server.
- **Lack of Input Sanitization/Validation:** The application lacks proper input validation for the host header, which makes it vulnerable to the attack.

**Impact of Exploitation:**
- **Password Reset Token Leakage:** By controlling the host in the reset link, the attacker can have the reset token sent to their own server when the user clicks the malicious link, instead of the intended reset link.
- **Account Takeover:** Once the attacker has the password reset token, they can reset the user's password and gain unauthorized access to the account.

**Attack Vectors:**
- **Malicious "Host" Header:** The attacker crafts a password reset request and includes a malicious `Host` header, such as `Host: attacker-controlled.com`. This modified header is then used by the application to generate the password reset email.
- **Email Phishing:** The victim receives an email that looks legitimate but contains a link leading to a server controlled by the attacker.

**Required Attacker Capabilities/Position:**
- **Ability to Send HTTP Requests:** The attacker needs to be able to send HTTP requests to the ArrowCMS application with a modified `Host` header. This can typically be achieved with tools such as curl, or by crafting an application that performs the request.
- **Knowledge of Existing User:** The attacker needs to know the email address of an existing user on the system to trigger the reset password functionality.
- **Attacker Controlled Server:** The attacker requires a server that they control to receive and capture the password reset token from the victim.

**Summary of the vulnerability:**
The vulnerability lies in the fact that the "Forgot Password" function does not sanitize the host header before generating a password reset link. This can allow an attacker to redirect the victim to an attacker-controlled server where they could capture the password reset token and takeover the user's account.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.493 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.371 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.370 |
| 4 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.368 |
| 5 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.364 |
| 6 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.361 |
| 7 | 620 | Unverified Password Change | Base | Allowed | sparse | 0.361 |
| 8 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.361 |
| 9 | 640 | Weak Password Recovery Mechanism for Forgotten Password | Base | Allowed-with-Review | dense | 0.506 |
| 10 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | graph | 0.002 |

