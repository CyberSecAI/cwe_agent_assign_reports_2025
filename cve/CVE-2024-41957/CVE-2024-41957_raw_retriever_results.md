# Raw Retriever Results for CVE-2024-41957

# Raw Retriever Results for CVE-2024-41957
## Query
Vim is an open source command line text editor. Vim < v9.1.0647 has double free in src/alloc.c616. When closing a window, the corresponding tagstack data will be cleared and freed. However a bit later, the quickfix list belonging to that window will also be cleared and if that quickfix list points to the same tagstack data, Vim will try to free it again, resulting in a double-free/use-after-free access exception. Impact is low since the user must intentionally execute vim with several non-default flags, but it may cause a crash of Vim. The issue has been fixed as of Vim patch v9.1.0647

## Keyphrases
- **rootcause**: 'race condition'
- **weakness**: 'double free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3852 | 0.4799 | 0.4150 | 0.4118 | 20 |
| Sparse | 451.9454 | 1000.0000 | 559.9893 | 519.0243 | 11 |
| Graph | 1.5552 | 4.3290 | 2.1756 | 2.1931 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 4.3290 | Allowed |
| 2 | 123 | Write-what-where Condition | base | 2.9120 | Allowed |
| 3 | 415 | Double Free | Variant | 2.5383 | Allowed |
| 4 | 416 | Use After Free | Variant | 2.5163 | Allowed |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.4700 | Allowed |
| 6 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 7 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 9 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 10 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 11 | 368 | Context Switching Race Condition | base | 2.1762 | Allowed |
| 12 | 479 | Signal Handler Use of a Non-reentrant Function | variant | 2.0659 | Allowed |
| 13 | 590 | Free of Memory not on the Heap | Variant | 1.8402 | Allowed |
| 14 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.6995 | Allowed-with-Review |
| 15 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 415 | Double Free | Variant | 0.4799 | 0.4799 | Allowed |
| 2 | 761 | Free of Pointer not at Start of Buffer | Variant | 0.4469 | 0.4469 | Allowed |
| 3 | 590 | Free of Memory not on the Heap | Variant | 0.4375 | 0.4375 | Allowed |
| 4 | 416 | Use After Free | Variant | 0.4367 | 0.4367 | Allowed |
| 5 | 126 | Buffer Over-read | Variant | 0.4219 | 0.4219 | Allowed |
| 6 | 366 | Race Condition within a Thread | Base | 0.4169 | 0.4169 | Allowed |
| 7 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.4149 | 0.4149 | Allowed |
| 8 | 122 | Heap-based Buffer Overflow | Variant | 0.4145 | 0.4145 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4138 | 0.4138 | Allowed-with-Review |
| 10 | 909 | Missing Initialization of Resource | Class | 0.4124 | 0.4124 | Allowed-with-Review |
| 11 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.4112 | 0.4112 | Allowed |
| 12 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4108 | 0.4108 | Allowed |
| 13 | 674 | Uncontrolled Recursion | Class | 0.4098 | 0.4098 | Allowed-with-Review |
| 14 | 14 | Compiler Removal of Code to Clear Buffers | Variant | 0.4077 | 0.4077 | Allowed |
| 15 | 244 | Improper Clearing of Heap Memory Before Release ('Heap Inspection') | Variant | 0.4010 | 0.4010 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 126 | Buffer Over-read | 564.2918 | 564.2918 | Allowed |
| 3 | 415 | Double Free | 559.2980 | 559.2980 | Allowed |
| 4 | 364 | Signal Handler Race Condition | 540.8504 | 540.8504 | Allowed |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 534.5923 | 534.5923 | Allowed |
| 6 | 122 | Heap-based Buffer Overflow | 519.0243 | 519.0243 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | 511.4878 | 511.4878 | Allowed |
| 8 | 667 | Improper Locking | 502.6053 | 502.6053 | Allowed-with-Review |
| 9 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 491.3027 | 491.3027 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | 484.4841 | 484.4841 | Allowed |
| 11 | 416 | Use After Free | 451.9454 | 451.9454 | Allowed |
