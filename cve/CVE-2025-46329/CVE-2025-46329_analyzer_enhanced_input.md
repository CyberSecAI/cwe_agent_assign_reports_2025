## Vulnerability Description
libsnowflakeclient is the Snowflake Connector for C/C++. Versions starting from 0.5.0 to before 2.2.0, are vulnerable to local logging of sensitive information. When the logging level was set to DEBUG, the Connector would log locally the client-side encryption master key of the target stage during the execution of GET/PUT commands. This key by itself does not grant access to any sensitive data without additional access authorizations, and is not logged server-side by Snowflake. This issue has been patched in version 2.2.0.

### Vulnerability Description Key Phrases
- **impact:** local logging of sensitive information
- **product:** libsnowflakeclient
- **version:** 0.5.0 to before 2.2.0

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
When the logging level was set to DEBUG, the Connector would log locally the client-side encryption master key of the target stage during the execution of GET/PUT commands.

Weaknesses/vulnerabilities present:
The Connector would locally log the client-side encryption master key of the target stage.

Impact of exploitation:
The key by itself does not grant access to any sensitive data without additional access authorizations.

Attack vectors:
The vulnerability exists when the logging level was set to DEBUG.

Required attacker capabilities/position:
Not specified.

Mitigation or fix:
Snowflake released version 2.2.0 of the Snowflake Connector for C/C++, which fixes this issue. We recommend users upgrade to version 2.2.0.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.173 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.161 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.160 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.157 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.155 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.155 |
| 7 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.154 |
| 8 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.153 |
| 9 | 311 | Missing Encryption of Sensitive Data | Class | Discouraged | dense | 0.445 |
| 10 | 301 | Reflection Attack in an Authentication Protocol | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-532: Insertion of Sensitive Information into Log File

CWE-863: Incorrect Authorization

CWE-306: Missing Authentication for Critical Function

CWE-1390: Weak Authentication

CWE-285: Improper Authorization

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-522: Insufficiently Protected Credentials

CWE-287: Improper Authentication

CWE-311: Missing Encryption of Sensitive Data

CWE-301: Reflection Attack in an Authentication Protocol