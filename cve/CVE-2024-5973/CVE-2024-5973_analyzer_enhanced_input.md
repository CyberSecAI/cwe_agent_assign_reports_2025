## Vulnerability Description
The MasterStudy LMS WordPress Plugin WordPress plugin before 3.3.24 does not prevent students from creating instructor accounts, which could be used to get access to functionalities they shouldnt have.

### Vulnerability Description Key Phrases
- **impact:** create instructor accounts
- **attacker:** students
- **product:** MasterStudy LMS WordPress Plugin
- **version:** before 3.3.24

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
The MasterStudy LMS plugin fails to prevent students from creating instructor accounts. This occurs because the plugin doesn't properly restrict access to the registration endpoint (`/wp-admin/admin-ajax.php?action=stm_lms_register`), allowing unauthenticated users to register with the "Instructor" role.

**Weaknesses/vulnerabilities present:**
- **Privilege Escalation:** Unauthenticated users can escalate their privileges by registering as an instructor.
- **Insecure Registration Process:** The registration process for instructors is not adequately protected, allowing unauthorized access.
- **Lack of Input Validation/Sanitization:**  The plugin appears to lack proper checks on the submitted data, allowing users to directly specify their role as "instructor" during registration.

**Impact of exploitation:**
- **Unauthorized access to Instructor functionalities:** A student, by creating an instructor account, gains access to features and capabilities reserved for instructors. This could lead to various malicious activities, such as modifying course content, manipulating user data, or potentially gaining further access to the system.
- **Compromise of the Learning Platform:** The integrity of the LMS platform could be compromised if malicious actors gain instructor-level access.

**Attack vectors:**
- The primary attack vector is through the `admin-ajax.php` endpoint used for user registration.
- The attacker crafts a malicious POST request to this endpoint, including the necessary parameters to register a new user with the "Instructor" role.

**Required attacker capabilities/position:**
-   **Unauthenticated:** The attacker does not need any existing user account.
-   **Network Access:**  The attacker needs to be able to send HTTP requests to the target WordPress site.
-  **Knowledge of the target registration endpoint:** The attacker needs to know the endpoint `/wp-admin/admin-ajax.php?action=stm_lms_register` and the required parameters

**Additional details from the provided content:**

*   The vulnerability affects versions of the MasterStudy LMS plugin prior to 3.3.24.
*   A proof-of-concept (PoC) is provided showing the exact HTTP request that can be used to exploit the vulnerability.
*   The vulnerability is classified as a Privilege Escalation (PRIVESC) issue.
*   It's categorized under OWASP Top 10 as "A2: Broken Authentication and Session Management".
*   The CWE classification is CWE-269 (Improper Privilege Management).
*   The CVSS score is 6.5 (Medium).
*   The vulnerability was discovered by Jaime F. Murillo.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.065 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.060 |
| 3 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.060 |
| 4 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | sparse | 0.059 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.059 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.058 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.057 |
| 8 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.055 |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | dense | 0.369 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-863: Incorrect Authorization

CWE-862: Missing Authorization

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-285: Improper Authorization

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-306: Missing Authentication for Critical Function

CWE-1390: Weak Authentication

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-471: Modification of Assumed-Immutable Data (MAID)