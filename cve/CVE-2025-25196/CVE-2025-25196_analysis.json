{
  "cve_id": "CVE-2025-25196",
  "description": "OpenFGA is a high-performance and flexible authorization/permission engine built for developers and inspired by Google Zanzibar. OpenFGA < v1.8.4 (Helm chart < openfga-0.2.22, docker < v.1.8.4) are vulnerable to **authorization bypass** when certain Check and ListObject calls are executed. Users on OpenFGA v1.8.4 or previous, specifically under the following conditions are affected by this **authorization bypass** vulnerability 1. Calling Check API or ListObjects with a model that has a relation directly assignable to both public access AND userset with the same type. 2. A type bound public access tuple is assigned to an object. 3. userset tuple is not assigned to the same object. and 4. Check requests user field is a userset that has the same type as the type bound public access tuples user type. Users are advised to upgrade to v1.8.5 which is backwards compatible. There are no known workarounds for this vulnerability.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "authorization bypass",
    "impact": "",
    "vector": "",
    "attacker": "",
    "product": "OpenFGA",
    "version": "v1.8.4 or previous",
    "component": "Check and ListObject calls"
  },
  "reference_content": "```\n- Root cause of vulnerability: The vulnerability is an authorization bypass issue that occurs when specific conditions are met in the Check and ListObjects calls.\n- Weaknesses/vulnerabilities present: Authorization bypass.\n- Impact of exploitation: The impact is a bypass of authorization.\n- Attack vectors: Calling Check API or ListObjects with a model that has a relation directly assignable to both public access and userset with the same type, and a type-bound public access tuple is assigned to an object and userset tuple is not assigned to the same object, and the Check request's user field is a userset that has the same type as the type bound public access tuple's user type.\n- Required attacker capabilities/position: The attacker needs to be able to send crafted requests to the Check API or ListObjects.\n- Mitigation or fix: Upgrade to v1.8.5, which is a backwards compatible upgrade.\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-863 | Incorrect Authorization | 1.0 | Class | Primary | Allowed-with-Review |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE selected is CWE-863, which is a Class-level CWE. Several other CWEs were considered, including its parent CWEs. CWE-862 (Missing Authorization) and CWE-285 (Improper Authorization) are closely related, but CWE-863 was chosen because the vulnerability description indicates that authorization checks are performed, but they are done incorrectly, leading to the **authorization bypass**.\n\n```mermaid\ngraph TD\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n\n    cwe863 -->|CHILDOF| cwe285\n    cwe862 -->|CHILDOF| cwe285\n    cwe285 -->|CHILDOF| cwe284\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe863 primary\n    class cwe862,cwe285,cwe284 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with the **incorrect authorization** logic (CWE-863), which leads to the impact of an **authorization bypass**.\n\n## Summary of Analysis\nThe analysis indicates an **authorization bypass** vulnerability in OpenFGA versions prior to v1.8.5. The core issue lies in the **incorrect authorization** logic within the Check API and ListObjects calls when specific conditions related to public access and userset assignments are met. This allows unauthorized access.\n\nThe primary CWE selected is CWE-863 (Incorrect Authorization). This is because the vulnerability occurs due to authorization checks being performed incorrectly, leading to an **authorization bypass**. The vulnerability description clearly states that the **authorization bypass** occurs when certain conditions are met in the Check API and ListObjects calls, indicating that authorization checks are present but flawed.\n\nThe selection of CWE-863 is based on the following evidence:\n- The vulnerability description explicitly mentions \"**authorization bypass**\" as the core **weakness**.\n- The description details specific conditions related to public access and userset assignments that trigger the **authorization bypass**, implying that there is an attempt to perform authorization, but it is flawed.\n- The \"CVE Reference Links Content Summary\" confirms that the root cause is an **authorization bypass** issue in the Check and ListObjects calls.\n\nThe CWE guidance provided also supports this selection, as CWE-863 is recommended when \"Role check is present but flawed.\"\n\nCWE-862 (Missing Authorization) was considered but not selected because the vulnerability description suggests that authorization checks are present but flawed, rather than completely missing. Similarly, CWE-285 (Improper Authorization) is a more general category and less specific than CWE-863.\nCWE-284 (Improper Access Control) was not selected, as it's a high-level category and a more specific CWE could be identified.\nThe final decision is strongly based on the provided evidence and the CWE specifications.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-863 | Incorrect Authorization | 1.0 | Class | Primary | Allowed-with-Review |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE selected is CWE-863, which is a Class-level CWE. Several other CWEs were considered, including its parent CWEs. CWE-862 (Missing Authorization) and CWE-285 (Improper Authorization) are closely related, but CWE-863 was chosen because the vulnerability description indicates that authorization checks are performed, but they are done incorrectly, leading to the **authorization bypass**.\n\n```mermaid\ngraph TD\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n\n    cwe863 -->|CHILDOF| cwe285\n    cwe862 -->|CHILDOF| cwe285\n    cwe285 -->|CHILDOF| cwe284\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe863 primary\n    class cwe862,cwe285,cwe284 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with the **incorrect authorization** logic (CWE-863), which leads to the impact of an **authorization bypass**.\n\n## Summary of Analysis\nThe analysis indicates an **authorization bypass** vulnerability in OpenFGA versions prior to v1.8.5. The core issue lies in the **incorrect authorization** logic within the Check API and ListObjects calls when specific conditions related to public access and userset assignments are met. This allows unauthorized access.\n\nThe primary CWE selected is CWE-863 (Incorrect Authorization). This is because the vulnerability occurs due to authorization checks being performed incorrectly, leading to an **authorization bypass**. The vulnerability description clearly states that the **authorization bypass** occurs when certain conditions are met in the Check API and ListObjects calls, indicating that authorization checks are present but flawed.\n\nThe selection of CWE-863 is based on the following evidence:\n- The vulnerability description explicitly mentions \"**authorization bypass**\" as the core **weakness**.\n- The description details specific conditions related to public access and userset assignments that trigger the **authorization bypass**, implying that there is an attempt to perform authorization, but it is flawed.\n- The \"CVE Reference Links Content Summary\" confirms that the root cause is an **authorization bypass** issue in the Check and ListObjects calls.\n\nThe CWE guidance provided also supports this selection, as CWE-863 is recommended when \"Role check is present but flawed.\"\n\nCWE-862 (Missing Authorization) was considered but not selected because the vulnerability description suggests that authorization checks are present but flawed, rather than completely missing. Similarly, CWE-285 (Improper Authorization) is a more general category and less specific than CWE-863.\nCWE-284 (Improper Access Control) was not selected, as it's a high-level category and a more specific CWE could be identified.\nThe final decision is strongly based on the provided evidence and the CWE specifications.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-284:**\n- 284 (Improper Access Control) - ROOT\n\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Authorization",
        "match_reason": "term_in_phrase_whole_phrase"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 829.0512316290723
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 806.1231209647336
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 782.4485438543252
    },
    {
      "metadata": {
        "doc_id": "862",
        "name": "Missing Authorization",
        "source": "sparse"
      },
      "similarity": 756.9133755939597
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 745.8856892458125
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 741.8309847012147
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 741.5160260885863
    },
    {
      "metadata": {
        "doc_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "type": "Base",
        "original_content": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information.",
        "keyphrase_source": "weakness:authorization bypass",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.48767335034650705,
            "graph": 1.646895480699408
          }
        }
      },
      "similarity": 0.48767335034650705
    },
    {
      "doc_id": "266",
      "text": "A product incorrectly assigns a privilege to a particular actor, creating an unintended sphere of control for that actor.",
      "score": 0.4777590069115654,
      "metadata": {
        "doc_id": "266",
        "name": "Incorrect Privilege Assignment",
        "type": "Base",
        "extended_description": null,
        "alternate_terms": [],
        "original_content": "A product incorrectly assigns a privilege to a particular actor, creating an unintended sphere of control for that actor.",
        "relationships": [
          {
            "source_id": "266",
            "target_id": "9",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "266",
            "target_id": "556",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "266",
            "target_id": "520",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "266",
            "target_id": "1022",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "266",
            "target_id": "286",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "266",
            "target_id": "269",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "9",
            "target_id": "266",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "556",
            "target_id": "266",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "520",
            "target_id": "266",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "269",
            "target_id": "266",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1022",
            "target_id": "266",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "source": "graph",
        "sources": [
          "vector",
          "graph"
        ],
        "vector_score": 0.4777590069115654,
        "graph_score": 2.04516,
        "score_components": {
          "relationship_chain": 0.7,
          "abstraction_path": 0.5760000000000002,
          "peer_group": 0.9
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "266",
                  "286",
                  "CANALSOBE"
                ]
              ],
              "score": 0.7,
              "type": "relationship_chain",
              "source": "286"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "284",
                  "269",
                  "PARENTOF"
                ],
                [
                  "269",
                  "266",
                  "PARENTOF"
                ]
              ],
              "score": 0.5760000000000002,
              "type": "abstraction_path_down",
              "source": "284"
            },
            "peer_relationship": {
              "path": [
                [
                  "266",
                  "286",
                  "CANALSOBE"
                ]
              ],
              "score": 0.9,
              "type": "peer_relationship",
              "source": "286"
            }
          }
        },
        "abstraction_level": "base",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.44455889624052425,
            "graph": 1.4181996027646262
          }
        }
      },
      "similarity": 1.4181996027646262
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-284",
      "CWE-863",
      "CWE-285",
      "CWE-862"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}