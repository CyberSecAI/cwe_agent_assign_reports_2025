# Vulnerability Information: CVE-2024-52513

## Vulnerability Description
Nextcloud Server is a self hosted personal cloud system. After receiving a Files drop or Password protected share link a malicious user was able to download attachments that are referenced in Text files without providing the password. It is recommended that the Nextcloud Server is upgraded to 28.0.11, 29.0.8 or 30.0.1 and Nextcloud Enterprise Server is upgraded to 25.0.13.13, 26.0.13.9, 27.1.11.9, 28.0.11, 29.0.8 or 30.0.1.

### Vulnerability Description Key Phrases
- **impact:** download attachments without providing the password
- **vector:** receiving a Files drop or Password protected share link
- **attacker:** malicious user
- **product:** Nextcloud Server

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-52513:

**Root Cause of Vulnerability:**

The vulnerability stems from a lack of proper access control checks in the Nextcloud Text app's middleware when handling "Files drop" or "Password protected" shares. Specifically, when a user accesses a Text file through a share link, the system failed to adequately verify if the user was authorized to download attachments referenced within that Text file.

**Weaknesses/Vulnerabilities Present:**

*   **Insufficient Access Control:** The core issue is that the middleware did not correctly enforce the share's permissions and password protection when accessing attachments linked in Text files.
*   **Information Disclosure:** This lack of proper checking allowed unauthorized users to download attachments, bypassing the intended security measures of "Files drop" and "Password Protected" shares.

**Impact of Exploitation:**

*   **Unauthorized Access to Attachments:** A malicious user, after obtaining a "Files drop" or "Password Protected" share link, could download attachments referenced in Text files without needing the password for the share, leading to data exposure.
*   **Confidentiality Breach:** This could expose sensitive information contained within the attachments.

**Attack Vectors:**

*   **Network-based:** The attacker only needs a share link to initiate the attack, which can be obtained remotely.
*   **Exploitation requires user interaction**: The attacker needs a user to create a files drop or password protected share link.

**Required Attacker Capabilities/Position:**

*   **Share Link:** The attacker needs to obtain a share link created with the "Files drop" or "Password protected" option.
*   **No Authentication Required:** The attacker does not require any other form of authentication (e.g., a valid Nextcloud account) to access the attachments after obtaining the share link.
* **Low Privileges**: Only low privileges are required to exploit this vulnerability.

**Additional Notes:**

*   The fix involves applying stricter checks on shares within the `SessionMiddleware.php` file.
*   The vulnerability was addressed in Nextcloud Server versions 28.0.11, 29.0.8, 30.0.1 and Nextcloud Enterprise Server versions 25.0.13.13, 26.0.13.9, 27.1.11.9, 28.0.11, 29.0.8, 30.0.1
*   The vulnerability is classified as having a "Low" severity.
*   The vulnerability is categorized under CWE-200 (Information Exposure).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.184 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.156 |
| 3 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.153 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.151 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.143 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.142 |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.140 |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.139 |
| 9 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | dense | 0.504 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.003 |

