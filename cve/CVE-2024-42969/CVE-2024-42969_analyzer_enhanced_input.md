## Vulnerability Description
Tenda FH1206 v02.03.01.35 was discovered to contain a **stack overflow** via the page parameter in the fromSafeUrlFilter function. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted POST request.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted POST request
- **attacker:** attackers
- **product:** Tenda FH1206
- **version:** v02.03.01.35
- **component:** fromSafeUrlFilter function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 149)
- CWE-120 (Count: 4)

## CVE Reference Links Content Summary
The provided content describes a stack overflow vulnerability in Tenda FH1206 router firmware.

**Root cause of vulnerability:**
- A stack buffer overflow exists in the `fromSafeUrlFilter` function due to the use of `sprintf` with a user-controlled `page` parameter without proper bounds checking.

**Weaknesses/vulnerabilities present:**
- Stack buffer overflow.
- Unsafe use of `sprintf`.

**Impact of exploitation:**
- The stack overflow can allow an attacker to potentially execute arbitrary code by overwriting return addresses or other sensitive data on the stack. This could lead to full control of the device, potentially allowing the attacker to modify firmware settings or eavesdrop on traffic.

**Attack vectors:**
- The vulnerability is triggered by sending a POST request to the `/goform/SafeMacFilter` endpoint with a large value in the `page` parameter.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP POST requests to the router. This generally implies the attacker is on the same local network as the vulnerable device.
- The attacker doesn't require prior authentication.

**Additional Details:**
- The vulnerable function is `fromSafeUrlFilter`
- The vulnerable firmware version is FH1206 V02.03.01.35
- The vulnerable code snippet is `sprintf(v11, "firewall_mac.asp?page=%s", v8);`
- A proof of concept exploit is provided using a python script and sends 1000 'a' characters in the page parameter.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.236 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.213 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.212 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.211 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.208 |
| 8 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.208 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.564 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-121: Stack-based Buffer Overflow

CWE-190: Integer Overflow or Wraparound

CWE-674: Uncontrolled Recursion

CWE-122: Heap-based Buffer Overflow

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-125: Out-of-bounds Read

CWE-130: Improper Handling of Length Parameter Inconsistency

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-128: Wrap-around Error