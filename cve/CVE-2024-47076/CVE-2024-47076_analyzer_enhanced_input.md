## Vulnerability Description
CUPS is a standards-based, open-source printing system, and `libcupsfilters` contains the code of the filters of the former `cups-filters` package as library functions to be used for the data format conversion tasks needed in Printer Applications. The `cfGetPrinterAttributes5` function in `libcupsfilters` **does not sanitize IPP attributes** returned from an IPP server. When these IPP attributes are used, for instance, to generate a PPD file, this can lead to attacker controlled data to be provided to the rest of the CUPS system.

### Vulnerability Description Key Phrases
- **weakness:** **does not sanitize IPP attributes**
- **impact:** attacker controlled data
- **product:** libcupsfilters
- **component:** cfGetPrinterAttributes5 function

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-47076:

**Verification:**

The provided content directly mentions CVE-2024-47076, specifically in the context of `libcupsfilters` and its function `cfGetPrinterAttributes5`. The content also details the exploit chain that includes this vulnerability, confirming its relevance.

**Vulnerability Details:**

*   **Root Cause:** The `cfGetPrinterAttributes5` function within `libcupsfilters` fails to sanitize IPP attributes received from an IPP server. This lack of sanitization allows an attacker to inject arbitrary data through these attributes.
*   **Weaknesses/Vulnerabilities Present:**
    *   **Lack of Input Sanitization:** The primary weakness is the absence of proper sanitization of IPP attributes in `cfGetPrinterAttributes5`. This means that any data provided by a malicious IPP server is blindly accepted.
    *   **Improper Data Handling**: The vulnerability allows for injection of arbitrary data into a PPD file.
*  **Impact of Exploitation:** When combined with other vulnerabilities in the CUPS printing system, this lack of sanitization leads to arbitrary code execution on the target machine. Specifically, the injected data can be used to insert malicious commands into a PPD file, which are later executed.
*   **Attack Vectors:**
    *   **Network-based:** An attacker can exploit this vulnerability by setting up a malicious IPP server, then advertising that server as a printer over the network, either locally or remotely.
    *   **UDP Packet:** A specifically crafted UDP packet sent to the target system on port 631 will trigger the vulnerability. The packet includes a URL pointing to the malicious IPP server.
*   **Required Attacker Capabilities/Position:**
    *   **Network Access:** The attacker needs to be able to send UDP packets to the target system (either on the local network or over the internet if port 631 is exposed).
    *   **Malicious IPP Server:** The attacker must have a malicious IPP server to provide the crafted, unsanitized attributes.

**Additional Details:**

*   **Exploit Chain:** The content describes how this vulnerability is part of a larger exploit chain. It requires a series of vulnerabilities across different components of the CUPS printing system to achieve remote code execution:
    1.  **cups-browsed:**  Listens on UDP port 631 and accepts arbitrary URLs, which can point to an attacker-controlled IPP server.
    2.  **libcupsfilters:** The vulnerable `cfGetPrinterAttributes5` function fetches unsanitized IPP attributes from the malicious server.
    3.  **libppd:** `ppdCreatePPDFromIPP2` function then takes the unsanitized attributes and injects them into a temporary PPD file.
    4.  **cups-filters:** `foomatic-rip` filter executes arbitrary commands defined in the PPD file (through the `FoomaticRIPCommandLine` directive).
*   **Affected versions:** The vulnerability affects versions of `libcupsfilters` up to and including 2.1b1.
*   **Patch Status:** No patches were available at the time of writing.
*   **Severity:** The vulnerability is considered low in isolation, but as part of a chain, it leads to a high severity vulnerability, remote code execution, as described in the `cups-browsed` advisory.
*   **CVE ID:** The CVE ID for this specific vulnerability is **CVE-2024-47076**, but it's tied to CVE-2024-47176, CVE-2024-47175 and CVE-2024-47177, which represent the full RCE chain.
*   **Credits:** The vulnerability was reported by "evilsocket."

**Summary**
CVE-2024-47076 is a vulnerability in libcupsfilters where the cfGetPrinterAttributes5 function does not sanitize IPP attributes returned from an IPP server. This vulnerability allows for the injection of malicious data that, when combined with other vulnerabilities, enables remote code execution through the CUPS printing system.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.472 |
| 2 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.437 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.435 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.434 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.432 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.423 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.422 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.417 |
| 9 | 791 | Incomplete Filtering of Special Elements | Base | Allowed | dense | 0.395 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1321: Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')

CWE-917: Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-138: Improper Neutralization of Special Elements

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-863: Incorrect Authorization

CWE-791: Incomplete Filtering of Special Elements

CWE-471: Modification of Assumed-Immutable Data (MAID)