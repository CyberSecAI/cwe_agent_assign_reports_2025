# Vulnerability Information: CVE-2024-7206

## Vulnerability Description
**SSL Pinning Bypass** in eWeLink Some hardware products allows local ATTACKER to Decrypt TLS communication and Extract secrets to clone the device via Flash the modified firmware

### Vulnerability Description Key Phrases
- **rootcause:** **SSL Pinning Bypass**
- **impact:** Decrypt TLS communication and Extract secrets and clone the device
- **vector:** Flash the modified firmware
- **attacker:** local ATTACKER
- **product:** eWeLink Some hardware products

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The ability to extract firmware via a serial port connection and the lack of proper security measures allowing modification of the firmware, specifically the SSL certificate.
- **Weaknesses/vulnerabilities present:**
    - Firmware extraction vulnerability via serial port.
    - Lack of integrity checks on the firmware during updates enabling the attacker to modify and re-flash the device.
    - Hardcoded SSL pinning bypass that allows man-in-the-middle attacks by replacing the legitimate certificate with a malicious one.
- **Impact of exploitation:**
    - Decryption of TLS communication between the device and the cloud server.
    - Extraction of secrets to clone the device.
    - Man-in-the-middle (MITM) attacks, allowing for eavesdropping and manipulation of communication between the device and the server.
- **Attack vectors:**
    - Physical access to the device to disassemble it.
    - Connecting the device to a PC via a serial port.
- **Required attacker capabilities/position:**
    - Physical access to the device.
    - Ability to disassemble the device.
    - Knowledge of serial port communication.
    - Technical skills to extract, modify, and re-flash firmware.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.174 |
| 2 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.170 |
| 3 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.161 |
| 4 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.156 |
| 5 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.146 |
| 6 | 296 | Improper Following of a Certificate's Chain of Trust | Base | Allowed | sparse | 0.142 |
| 7 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.139 |
| 8 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.139 |
| 9 | 1319 | Improper Protection against Electromagnetic Fault Injection (EM-FI) | Base | Allowed | dense | 0.539 |
| 10 | 208 | Observable Timing Discrepancy | Base | Allowed | graph | 0.003 |

