# Raw Retriever Results for CVE-2025-21688

# Raw Retriever Results for CVE-2025-21688
## Query
In the Linux kernel, the following vulnerability has been resolved drm/v3d Assign job pointer to NULL before signaling the fence In commit e4b5ccd392b9 (drm/v3d Ensure job pointer is set to NULL after job completion), we introduced a change to assign the job pointer to NULL after completing a job, indicating job completion. However, this approach created a race condition between the DRM scheduler workqueue and the IRQ execution thread. As soon as the fence is signaled in the IRQ execution thread, a new job starts to be executed. This results in a race condition where the IRQ execution thread sets the job pointer to NULL simultaneously as the `run_job()` function assigns a new job to the pointer. This race condition can lead to a NULL pointer dereference if the IRQ execution thread sets the job pointer to NULL after `run_job()` assigns it to the new job. When the new job completes and the GPU emits an interrupt, `v3d_irq()` is triggered, potentially causing a crash. [ 466.310099] Unable to handle kernel NULL pointer dereference at virtual address 00000000000000c0 [ 466.318928] Mem abort info [ 466.321723] ESR = 0x0000000096000005 [ 466.325479] EC = 0x25 DABT (current EL), IL = 32 bits [ 466.330807] SET = 0, FnV = 0 [ 466.333864] EA = 0, S1PTW = 0 [ 466.337010] FSC = 0x05 level 1 translation fault [ 466.341900] Data abort info [ 466.344783] ISV = 0, ISS = 0x00000005, ISS2 = 0x00000000 [ 466.350285] CM = 0, WnR = 0, TnD = 0, TagAccess = 0 [ 466.355350] GCS = 0, Overlay = 0, DirtyBit = 0, Xs = 0 [ 466.360677] user pgtable 4k pages, 39-bit VAs, pgdp=0000000089772000 [ 466.367140] [00000000000000c0] pgd=0000000000000000, p4d=0000000000000000, pud=0000000000000000 [ 466.375875] Internal error Oops 0000000096000005

## Keyphrases
- **rootcause**: 'race condition'
- **weakness**: 'kernel NULL pointer dereference'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4760 | 0.5426 | 0.5053 | 0.5003 | 20 |
| Sparse | 941.8732 | 1162.1478 | 1018.7804 | 1004.2170 | 11 |
| Graph | 1.5554 | 2.8226 | 2.0087 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | Base | 2.8226 | Allowed |
| 2 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.7342 | Allowed |
| 3 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.6784 | Allowed |
| 4 | 789 | Memory Allocation with Excessive Size Value | variant | 2.5507 | Allowed |
| 5 | 466 | Return of Pointer Value Outside of Expected Range | base | 2.3998 | Allowed |
| 6 | 617 | Reachable Assertion | base | 2.3296 | Allowed |
| 7 | 193 | Off-by-one Error | base | 2.2100 | Allowed |
| 8 | 822 | Untrusted Pointer Dereference | Base | 2.0581 | Allowed |
| 9 | 908 | Use of Uninitialized Resource | Base | 1.9299 | Allowed |
| 10 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 170 | Improper Null Termination | base | 1.7680 | Allowed |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7518 | Allowed-with-Review |
| 14 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 15 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 822 | Untrusted Pointer Dereference | Base | 0.5426 | 0.5426 | Allowed |
| 2 | 476 | NULL Pointer Dereference | Base | 0.5425 | 0.5425 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5424 | 0.5424 | Allowed-with-Review |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5381 | 0.5381 | Allowed-with-Review |
| 5 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5291 | 0.5291 | Allowed |
| 6 | 667 | Improper Locking | Class | 0.5234 | 0.5234 | Allowed-with-Review |
| 7 | 190 | Integer Overflow or Wraparound | Base | 0.5208 | 0.5208 | Allowed |
| 8 | 908 | Use of Uninitialized Resource | Base | 0.5109 | 0.5109 | Allowed |
| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5034 | 0.5034 | Discouraged |
| 10 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5027 | 0.5027 | Allowed |
| 11 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4980 | 0.4980 | Allowed |
| 12 | 366 | Race Condition within a Thread | Base | 0.4978 | 0.4978 | Allowed |
| 13 | 787 | Out-of-bounds Write | Base | 0.4846 | 0.4846 | Allowed |
| 14 | 763 | Release of Invalid Pointer or Reference | Base | 0.4839 | 0.4839 | Allowed |
| 15 | 126 | Buffer Over-read | Variant | 0.4833 | 0.4833 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 476 | NULL Pointer Dereference | 1162.1478 | 1162.1478 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1076.6234 | 1076.6234 | Allowed-with-Review |
| 3 | 617 | Reachable Assertion | 1020.5699 | 1020.5699 | Allowed |
| 4 | 466 | Return of Pointer Value Outside of Expected Range | 1014.8282 | 1014.8282 | Allowed |
| 5 | 665 | Improper Initialization | 1005.9353 | 1005.9353 | Discouraged |
| 6 | 364 | Signal Handler Race Condition | 1004.2170 | 1004.2170 | Allowed |
| 7 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 1001.8798 | 1001.8798 | Allowed |
| 8 | 822 | Untrusted Pointer Dereference | 995.4566 | 995.4566 | Allowed |
| 9 | 667 | Improper Locking | 993.4817 | 993.4817 | Allowed-with-Review |
| 10 | 252 | Unchecked Return Value | 989.5715 | 989.5715 | Allowed |
| 11 | 908 | Use of Uninitialized Resource | 941.8732 | 941.8732 | Allowed |
