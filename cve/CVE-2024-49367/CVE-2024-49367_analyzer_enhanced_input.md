## Vulnerability Description
Nginx UI is a web user interface for the Nginx web server. Prior to version 2.0.0-beta.36, the log path of nginxui is controllable. This issue can be combined with the **directory traversal** at `/api/configs` to read directories and file contents on the server. Version 2.0.0-beta.36 fixes the issue.

### Vulnerability Description Key Phrases
- **weakness:** **directory traversal**
- **impact:** read directories and file contents
- **vector:** directory traversal at /api/configs
- **product:** Nginx UI
- **version:** Prior to version 2.0.0-beta.36
- **component:** log path of nginxui

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

*   The application allows users to control the log path for Nginx logs. This is read from the settings.
*   The application also has a directory traversal vulnerability in the `/api/configs` endpoint. This endpoint directly obtains a path from the frontend and concatenates it to the config path, making a system call without proper sanitization.

**Weaknesses/Vulnerabilities:**

*   **Path Traversal:** The `/api/configs` endpoint is vulnerable to path traversal, allowing an attacker to navigate outside of the intended directory by using `../` sequences.
*   **Uncontrolled Log Path:** The application allows the user to specify the log file paths, allowing an attacker to set them to arbitrary files on the system.
*   **Lack of Input Validation:** There's a lack of proper input validation and sanitization of the `dir` parameter in the `/api/configs` endpoint and log paths in settings.

**Impact of Exploitation:**

*   **Arbitrary File Reading:** An attacker can read any file on the server's file system. This can include sensitive configuration files, application code, database credentials, etc.

**Attack Vectors:**

1.  **Modify Log Path:** An attacker would first modify the application settings via a `POST` request to the `/api/settings` endpoint, setting the `access_log_path` and `error_log_path` to the path of a target file.
2.  **Path Traversal:** An attacker would then craft a `GET` request to `/api/configs` with a malicious `dir` parameter, such as `../../../../Users/snake/Downloads/nginx-ui-macos-64`, to perform directory traversal and list files.
3.  **Read File:** Finally, the attacker would access the logs through `/nginx_log/access` to read the file content.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be authenticated to the application with a valid JWT token.
*   The attacker must have the ability to send HTTP requests to the server hosting the nginx-ui application.
*   The attacker needs to know or guess the location of the files they wish to read.

**Additional Notes:**

*   The vulnerability was reported by `@unam4`.
*   The issue is fixed in version `v2.0.0-beta.36` of `nginx-ui`.
*   The advisory provides a clear Proof of Concept (PoC) with example requests.
*   The vulnerability is rated as "Moderate" in severity.

This information is more detailed than the official CVE description, giving a good overview of the technical details, attack vectors and impact of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.339 |
| 3 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.303 |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.302 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.288 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.283 |
| 7 | 158 | Improper Neutralization of Null Byte or NUL Character | Variant | Allowed | sparse | 0.272 |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.271 |
| 9 | 449 | The UI Performs the Wrong Action | Base | Allowed | dense | 0.348 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-23: Relative Path Traversal

CWE-36: Absolute Path Traversal

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-158: Improper Neutralization of Null Byte or NUL Character

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-449: The UI Performs the Wrong Action

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')