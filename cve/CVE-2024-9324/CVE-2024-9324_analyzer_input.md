# Vulnerability Information: CVE-2024-9324

## Vulnerability Description
A vulnerability was found in Intelbras InControl up to 2.21.57. It has been rated as critical. Affected by this issue is some unknown functionality of the file /v1/operador/ of the component Relatorio de Operadores Page. The manipulation of the argument fields leads to code injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was informed early on 2024-07-19 about this issue. The release of a fixed version 2.21.58 was announced for the end of August 2024 but then was postponed until 2024-09-20.

### Vulnerability Description Key Phrases
- **impact:** code injection
- **vector:** manipulation of arguments
- **product:** Intelbras InControl
- **version:** up to 2.21.57
- **component:** /v1/operador/

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-9324:

**Root Cause of Vulnerability:**

*   The vulnerability is due to a lack of proper input sanitization in the `fields` parameter of the API calls related to report generation, specifically in the `/v1/operador/relatorio` and `/v1/evento_operador/relatorio` endpoints. This allows for the injection of arbitrary Python code.

**Weaknesses/Vulnerabilities Present:**

*   **Code Injection:** The primary vulnerability is a Python code injection flaw. The application uses the `eval` and `compile` functions on the unsanitized `fields` parameter, enabling the execution of arbitrary python code provided by the attacker.

**Impact of Exploitation:**

*   **Full Server Control:** The attacker can achieve full control of the server by executing arbitrary operating system commands via the injected code.
*   **Remote Code Execution (RCE):** The ability to execute arbitrary Python code allows for RCE, enabling the attacker to potentially install malware, steal data, or disrupt operations.
*   **Data Exfiltration**: An attacker can exfiltrate data through network requests.

**Attack Vectors:**

*   **HTTP GET Request:** The attack vector is through crafted HTTP GET requests to the vulnerable API endpoints.
*   **Modified `fields` parameter:**  The malicious code is injected into the `fields` parameter of the HTTP request.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the vulnerable Intelbras InControl server.
*   **Authentication (potentially):** While the provided text mentions default credentials (`admin/admin`), which indicates an issue on the product setup, it is not clear whether a successful authentication is required.
*   **API Knowledge:** The attacker needs to be aware of the vulnerable API endpoints.

**Additional Information:**

*   **Vulnerable Versions:** Intelbras InControl versions 2.21.56 and 2.21.57 are vulnerable.
*   **Fixed Version:** The vulnerability is fixed in version 2.21.58.
*   **Exploitability:** The vulnerability is easily exploitable using tools like Burp Suite to intercept and modify the request.
*  **Severity**: Intelbras rates this vulnerability as medium risk.
* **Affected Product**: InControl Web

The content provides more details than a simple CVE description, such as the specific API endpoints, vulnerable parameters, and example payloads. It also provides a Proof of Concept (PoC) and a video demonstration.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.209 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.208 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.180 |
| 4 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.175 |
| 5 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.173 |
| 6 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.171 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.171 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.170 |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | dense | 0.598 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |

