## Vulnerability Description
An **arbitrary file upload vulnerability** in M2Soft CROWNIX Report & ERS v5.x to v5.5.14.1070, v7.x to v7.4.3.960, and v8.x to v8.2.0.345 allows attackers to execute arbitrary code via supplying a crafted file.

### Vulnerability Description Key Phrases
- **weakness:** **arbitrary file upload vulnerability**
- **impact:** execute arbitrary code
- **vector:** crafted file
- **attacker:** attackers
- **product:** M2Soft CROWNIX Report & ERS
- **version:** v5.x to v5.5.14.1070, v7.x to v7.4.3.960, and v8.x to v8.2.0.345

## CVE Reference Links Content Summary
The content relates to CVE-2024-57338 as it details multiple vulnerabilities (KVE-2024-0285, KVE-2024-0286, KVE-2024-0287, and KVE-2024-0291) affecting CROWNIX Report & ERS. The content provides more detail than the placeholder CVE description.

Here's a breakdown of the vulnerabilities:

**Vulnerability Details:**

*   **KVE-2024-0285 (CROWNIX 7 ManagerService privilege escalation):**
    *   **Root cause:**  A flaw in the ManagerService allowing unauthorized access to API functions.
    *   **Weaknesses:** Improper access control.
    *   **Impact:** Allows attackers to execute arbitrary code and potentially gain system-level access.
    *   **Attack Vector:** Exploitation involves accessing specific API endpoints (getUserInfo / updateUserInfo).
    *   **Affected versions:** CROWNIX Report & ERS 7.x ~ 7.4.3.599 and 8.x ~ 8.0.3.79
    *   **Mitigation:** Upgrade to CROWNIX Report & ERS 7.x -> 7.4.3.561 or 8.x -> 8.0.3.82.

*   **KVE-2024-0286 (CROWNIX 7,8 arbitrary file upload):**
    *   **Root cause:**  Insufficient validation of file uploads.
    *   **Weaknesses:** Unrestricted file upload.
    *   **Impact:** Allows attackers to upload arbitrary files to the server.
    *   **Attack Vector:** Exploitation involves uploading files through the CROWNIX Reporting Server (7.2.2.302).
    *   **Affected versions:** CROWNIX Report & ERS 7.x ~ 7.4.3.599 and 8.x ~ 8.0.3.79
    *   **Mitigation:** Upgrade to CROWNIX Report & ERS 7.x -> 7.4.3.561 or 8.x -> 8.0.3.82.

*   **KVE-2024-0287 (CROWNIX Report/ERS 7 & 8 arbitrary code execution):**
    *   **Root cause:** Vulnerability in opcode 500 processing.
    *   **Weaknesses:** Improper handling of parameters in opcode 500.
    *   **Impact:** Allows attackers to execute arbitrary code.
    *   **Attack Vector:** Exploitation involves manipulating `mrd_path` and `mrd_param` parameters.
    *   **Affected versions:** CROWNIX Report & ERS 5.x ~ 5.5.14.1070, 7.x ~ 7.4.3.960, and 8.x ~ 8.2.0.345
    *   **Mitigation:** Upgrade to CROWNIX Report & ERS 5.x -> 5.5.14.1071, 7.x -> 7.4.3.961, or 8.x -> 8.2.0.346.

*   **KVE-2024-0291 (CROWNIX Report/ERS 7 & 8 arbitrary code execution 2):**
    *   **Root cause:** Vulnerability related to `export_type` and `export_name` parameters.
    *   **Weaknesses:** Improper handling of parameters.
    *   **Impact:** Allows attackers to execute arbitrary code.
    *   **Attack Vector:** Exploitation involves manipulating `mrd_param` and `rdata` parameters, and potentially using `../` in `export_name`.
    *   **Affected versions:** CROWNIX Report & ERS 5.x ~ 5.5.14.1070, 7.x ~ 7.4.3.960, and 8.x ~ 8.2.0.345
    *   **Mitigation:** Upgrade to CROWNIX Report & ERS 5.x -> 5.5.14.1071, 7.x -> 7.4.3.961, or 8.x -> 8.2.0.346.

**Attacker Capabilities/Position:**

The attacker needs network access to the vulnerable CROWNIX Report & ERS server and the ability to send crafted requests to specific API endpoints or manipulate parameters in file uploads or data processing.

**Contact Information:**

*   Support: 02-2188-8500
*   Email: report@m2soft.co.kr, rdvistasupport@m2soft.co.kr

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.246 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.214 |
| 3 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.204 |
| 4 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.202 |
| 5 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.199 |
| 6 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.196 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.193 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.191 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.654 |
| 10 | 190 | Integer Overflow or Wraparound | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-20: Improper Input Validation

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-269: Improper Privilege Management

CWE-23: Relative Path Traversal

CWE-306: Missing Authentication for Critical Function

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-190: Integer Overflow or Wraparound