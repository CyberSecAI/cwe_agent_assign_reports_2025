# Vulnerability Information: CVE-2025-48370

## Vulnerability Description
auth-js is an isomorphic Javascript library for Supabase Auth. Prior to version 2.69.1, the library functions getUserById, deleteUser, updateUserById, listFactors and deleteFactor did not require the user supplied values to be valid UUIDs. This could lead to a **URL path traversal**, resulting in the wrong API function being called. Implementations that follow security best practice and validate user controlled inputs, such as the userId are not affected by this. This issue has been patched in version 2.69.1.

### Vulnerability Description Key Phrases
- **weakness:** **URL path traversal**
- **impact:** wrong API function being called
- **product:** Supabase Auth
- **version:** Prior to version 2.69.1

## CVE Reference Links Content Summary
```text
- Root cause of vulnerability: The library functions `getUserById`, `deleteUser`, `updateUserById`, `listFactors` and `deleteFactor` did not require the user supplied values to be valid UUIDs. This could lead to a URL path traversal, resulting in the wrong API function being called.
- Weaknesses/vulnerabilities present: URL path traversal.
- Impact of exploitation: Calling the wrong API function.
- Attack vectors: Passing malformed user input to the library functions `getUserById`, `deleteUser`, `updateUserById`, `listFactors` and `deleteFactor`.
- Required attacker capabilities/position: User controlled input.
- Mitigation or fix: Strict value checks have been added to all affected functions. These functions now require that the `userId` and `factorId` parameters MUST be valid UUID (v4).  Patched version: >= 2.69.1.
- More detail than the official CVE description: Yes
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.382 |
| 3 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.375 |
| 4 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.366 |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.362 |
| 6 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.360 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.360 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.359 |
| 9 | 204 | Observable Response Discrepancy | Base | Allowed | dense | 0.413 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |

