## Vulnerability Description
Snipe-IT before 7.0.10 allows remote code execution (associated with cookie serialization) when an attacker knows the APP_KEY. This is exacerbated by .env files, available from the products repository, that have default APP_KEY values.

### Vulnerability Description Key Phrases
- **impact:** remote code execution
- **vector:** cookie serialization
- **attacker:** attacker
- **product:** Snipe-IT
- **version:** before 7.0.10

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-48987.

**Root Cause of Vulnerability:**
- The vulnerability stems from the potential exploitation of the `APP_KEY` within the Snipe-IT application, specifically how it was used with cookie serialization.

**Weaknesses/Vulnerabilities Present:**
-  **Insecure Cookie Serialization:** The application was vulnerable to a Remote Code Execution (RCE) attack if an attacker gained access to the `APP_KEY`, due to the ability to serialize cookies.

**Impact of Exploitation:**
- **Remote Code Execution (RCE):** An attacker with access to the `APP_KEY` could execute arbitrary code on the server.
-  **Data Compromise:**  If custom fields were encrypted, the `APP_KEY` could be used to compromise this encryption.

**Attack Vectors:**
-  **Compromised `APP_KEY`:** The primary attack vector involves an attacker obtaining the `APP_KEY`. This could be achieved through various means, such as unauthorized access to server configuration files, or exploitation of another vulnerability.

**Required Attacker Capabilities/Position:**
-   **Access to `APP_KEY`:** An attacker needs access to the `APP_KEY` to exploit the vulnerability.
-   **Network Access:** The attacker needs network access to the Snipe-IT application to send malicious requests.

**Mitigation:**
-   **Disabled Cookie Serialization:** The vulnerability is mitigated by disabling cookie serialization within the Snipe-IT application.
-   **Key Rotation:** The application offers a CLI utility to handle `APP_KEY` rotation to mitigate the impact of a compromised key.
-   **Secure Key Storage:** The documentation stresses that the `APP_KEY` should never be shared and that default keys should never be used.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.062 |
| 2 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.061 |
| 3 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.061 |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.061 |
| 5 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.059 |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.057 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.057 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.057 |
| 9 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | Allowed | dense | 0.567 |
| 10 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-502: Deserialization of Untrusted Data

CWE-321: Use of Hard-coded Cryptographic Key

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-918: Server-Side Request Forgery (SSRF)

CWE-1390: Weak Authentication

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-287: Improper Authentication

CWE-863: Incorrect Authorization

CWE-784: Reliance on Cookies without Validation and Integrity Checking in a Security Decision

CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action