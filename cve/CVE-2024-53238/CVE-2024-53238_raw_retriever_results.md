# Raw Retriever Results for CVE-2024-53238

# Raw Retriever Results for CVE-2024-53238
## Query
In the Linux kernel, the following vulnerability has been resolved Bluetooth btmtk adjust the position to init iso data anchor MediaTek iso data anchor init should be moved to where MediaTek claims iso data interface. If there is an unexpected BT usb disconnect during setup flow, it will cause a NULL pointer crash issue when releasing iso anchor since the anchor wasnt been init yet. Adjust the position to do iso data anchor init. [ 17.137991] pc usb_kill_anchored_urbs+0x60/0x168 [ 17.137998] lr usb_kill_anchored_urbs+0x44/0x168 [ 17.137999] sp ffffffc0890cb5f0 [ 17.138000] x29 ffffffc0890cb5f0 x28 ffffff80bb6c2e80 [ 17.144081] gpio gpiochip0 registered chardev handle for 1 lines [ 17.148421] x27 0000000000000000 [ 17.148422] x26 ffffffd301ff4298 x25 0000000000000003 x24 00000000000000f0 [ 17.148424] x23 0000000000000000 x22 00000000ffffffff x21 0000000000000001 [ 17.148425] x20 ffffffffffffffd8 x19 ffffff80c0f25560 x18 0000000000000000 [ 17.148427] x17 ffffffd33864e408 x16 ffffffd33808f7c8 x15 0000000000200000 [ 17.232789] x14 e0cd73cf80ffffff x13 50f2137c0a0338c9 x12 0000000000000001 [ 17.239912] x11 0000000080150011 x10 0000000000000002 x9 0000000000000001 [ 17.247035] x8 0000000000000000 x7 0000000000008080 x6 8080000000000000 [ 17.254158] x5 ffffffd33808ebc0 x4 fffffffe033dcf20 x3 0000000080150011 [ 17.261281] x2 ffffff8087a91400 x1 0000000000000000 x0 ffffff80c0f25588 [ 17.268404] Call trace [ 17.270841] usb_kill_anchored_urbs+0x60/0x168 [ 17.275274] btusb_mtk_release_iso_intf+0x2c/0xd8 [btusb (HASH5afe 6)] [ 17.284226] btusb_mtk_disconnect+0x14/0x28 [btusb (HASH5afe 6)] [ 17.292652] btusb_disconnect+0x70/0x140 [btusb (HASH5afe 6)] [ 17.300818] usb_unbind_interface+0xc4/0x240 [ 17.305079] device_release_driver_internal+0x18c/0x258 [ 17.310296] device_release_driver+0x1c/0x30 [ 17.314557] bus_remove_device+0x140/0x160 [ 17.318643] device_del+0x1c0/0x330 [ 17.322121] usb_disable_device+0x80/0x180 [ 17.326207] usb_disconnect+0xec/0x300 [ 17.329948] hub_quiesce+0x80/0xd0 [ 17.333339] hub_disconnect+0x44/0x190 [ 17.337078] usb_unbind_interface+0xc4/0x240 [ 17.341337] device_release_driver_internal+0x18c/0x258 [ 17.346551] device_release_driver+0x1c/0x30 [ 17.350810] usb_driver_release_interface+0x70/0x88 [ 17.355677] proc_ioctl+0x13c/0x228 [ 17.359157] proc_ioctl_default+0x50/0x80 [ 17.363155] usbdev_ioctl+0x830/0xd08 [ 17.366808] __arm64_sys_ioctl+0x94/0xd0 [ 17.370723] invoke_syscall+0x6c/0xf8 [ 17.374377] el0_svc_common+0x84/0xe0 [ 17.378030] do_el0_svc+0x20/0x30 [ 17.381334] el0_svc+0x34/0x60 [ 17.384382] el0t_64_sync_handler+0x88/0xf0 [ 17.388554] el0t_64_sync+0x180/0x188 [ 17.392208] Code f9400677 f100a2f4 54fffea0 d503201f (b8350288) [ 17.398289] ---[ end trace 0000000000000000 ]---

## Keyphrases
- **weakness**: 'NULL pointer crash'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4538 | 0.5305 | 0.4860 | 0.4844 | 20 |
| Sparse | 262.8627 | 878.5229 | 757.2096 | 790.0105 | 11 |
| Graph | 1.6848 | 3.5698 | 2.1355 | 2.1211 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 3.5698 | Allowed |
| 2 | 390 | Detection of Error Condition Without Action | base | 2.8652 | Allowed |
| 3 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.6784 | Allowed |
| 4 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 5 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 6 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 7 | 787 | Out-of-bounds Write | base | 2.2100 | Allowed |
| 8 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 9 | 129 | Improper Validation of Array Index | variant | 2.1936 | Allowed |
| 10 | 368 | Context Switching Race Condition | base | 2.1762 | Allowed |
| 11 | 479 | Signal Handler Use of a Non-reentrant Function | variant | 2.0659 | Allowed |
| 12 | 822 | Untrusted Pointer Dereference | Base | 2.0478 | Allowed |
| 13 | 190 | Integer Overflow or Wraparound | Base | 1.9130 | Allowed |
| 14 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.5305 | 0.5305 | Allowed-with-Review |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5286 | 0.5286 | Allowed |
| 3 | 126 | Buffer Over-read | Variant | 0.5109 | 0.5109 | Allowed |
| 4 | 190 | Integer Overflow or Wraparound | Base | 0.5090 | 0.5090 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5079 | 0.5079 | Allowed-with-Review |
| 6 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5055 | 0.5055 | Allowed |
| 7 | 121 | Stack-based Buffer Overflow | Variant | 0.5048 | 0.5048 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5014 | 0.5014 | Allowed |
| 9 | 476 | NULL Pointer Dereference | Base | 0.4977 | 0.4977 | Allowed |
| 10 | 122 | Heap-based Buffer Overflow | Variant | 0.4973 | 0.4973 | Allowed |
| 11 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4714 | 0.4714 | Allowed |
| 12 | 416 | Use After Free | Variant | 0.4708 | 0.4708 | Allowed |
| 13 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4706 | 0.4706 | Allowed |
| 14 | 667 | Improper Locking | Class | 0.4635 | 0.4635 | Allowed-with-Review |
| 15 | 413 | Improper Resource Locking | Base | 0.4621 | 0.4621 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 364 | Signal Handler Race Condition | 878.5229 | 878.5229 | Allowed |
| 2 | 822 | Untrusted Pointer Dereference | 853.3180 | 853.3180 | Allowed |
| 3 | 755 | Improper Handling of Exceptional Conditions | 841.2440 | 841.2440 | Discouraged |
| 4 | 401 | Missing Release of Memory after Effective Lifetime | 839.6983 | 839.6983 | Allowed |
| 5 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | 818.6101 | 818.6101 | Allowed-with-Review |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 790.0105 | 790.0105 | Allowed-with-Review |
| 7 | 696 | Incorrect Behavior Order | 788.9965 | 788.9965 | Allowed-with-Review |
| 8 | 497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | 756.6387 | 756.6387 | Allowed |
| 9 | 121 | Stack-based Buffer Overflow | 755.1860 | 755.1860 | Allowed |
| 10 | 789 | Memory Allocation with Excessive Size Value | 744.2181 | 744.2181 | Allowed |
| 11 | 250 | Execution with Unnecessary Privileges | 262.8627 | 262.8627 | Allowed |
