## Vulnerability Description
Nextcloud Photos is a photo management app. Users can remove photos from the album of registered users. It is recommended that the Nextcloud Server is upgraded to 25.0.7 or 26.0.2 and the Nextcloud Enterprise Server is upgraded to 25.0.7 or 26.0.2.

### Vulnerability Description Key Phrases
- **impact:** remove photos from the album of registered users
- **product:** Nextcloud Server and Nextcloud Enterprise Server
- **version:** 25.0.7 and 26.0.2
- **component:** Photos app

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a missing permission check when removing a photo from a shared album. Specifically, users who have access to a shared album (including via public link) could remove photos from it, even if they were not the owner/creator of the album or the photos.

**Weaknesses/Vulnerabilities:**

*   **Missing Authorization Check:** The primary weakness is the absence of a proper authorization check before allowing a user to remove a photo from an album. This means that any user with access to the album could delete photos.
*   **Inadequate Access Control:** The system doesn't properly enforce access control policies related to modifying album content (removing photos), especially for publicly shared albums.

**Impact of Exploitation:**

*   **Data Integrity Loss:** Attackers could remove photos from a shared album, resulting in the loss of the data (photos) for other users expecting the photos to be available in the album.
*   **Potential for Data Manipulation:** While not stated, repeated removal of photos could be used to disrupt shared resources or to harass other users.
*   **Availability Impact:** Removal of photos affects the availability of content within the shared albums for legitimate users.

**Attack Vectors:**

*   **Network (Remote):** The attack can be carried out remotely over the network, as it involves interaction with a web application.
*   **Publicly Shared Album Access:** The vulnerability is present when a photo album is shared using a public link, which gives anyone access to the album without authentication.

**Required Attacker Capabilities/Position:**

*   **Low Privileges:** The attacker only needs an account on the Nextcloud server or the public link to the photo album to exploit the issue
*   **User Interaction (Required):** User interaction is needed, presumably, the attacker needs to interact with the web interface to remove photos.

**Additional Details:**

*   The vulnerability was found by user "juliusknorr".
*   The issue was addressed in versions 25.0.7 and 26.0.2.
*   The fix was implemented by removing the ability for users to remove photos from public albums.
*   The issue was initially found on public albums, which were intended to be read-only, but included the ability to delete photos.
*   The provided CVSS score is: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:L. This indicates a network-based attack (AV:N) with low complexity (AC:L), requiring low privileges (PR:L), user interaction (UI:R), and a scope unchanged (S:U). The impact is low (A:L), with no impact to confidentiality and integrity.

The content includes a reference to the pull request that fixed this issue. This pull request indicates that initially, a half-baked feature of public album editing was implemented, which lacked proper access controls.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.118 |
| 2 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | sparse | 0.109 |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.106 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.106 |
| 5 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.104 |
| 6 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | sparse | 0.103 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.102 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.099 |
| 9 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.002 |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse_additional | 0.099 |



# Complete CWE Specifications

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-226: Sensitive Information in Resource Not Removed Before Reuse

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-532: Insertion of Sensitive Information into Log File

CWE-288: Authentication Bypass Using an Alternate Path or Channel

CWE-23: Relative Path Traversal

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-117: Improper Output Neutralization for Logs

CWE-789: Memory Allocation with Excessive Size Value