# Vulnerability Information: CVE-2025-1217

## Vulnerability Description
In PHP from 8.1.* before 8.1.32, from 8.2.* before 8.2.28, from 8.3.* before 8.3.19, from 8.4.* before 8.4.5, when http request module parses HTTP response obtained from a server, **folded headers are parsed incorrectly**, which may lead to misinterpreting the response and using incorrect headers, MIME types, etc.

### Vulnerability Description Key Phrases
- **rootcause:** **folded headers are parsed incorrectly**
- **impact:** misinterpreting the response and using incorrect headers, MIME types, etc
- **product:** PHP
- **version:** 8.1.* before 8.1.32 and 8.2.* before 8.2.28 and 8.3.* before 8.3.19 and 8.4.* before 8.4.5
- **component:** http request module

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1217 based on provided content:

The provided content from github.com/php/php-src/security/advisories/GHSA-v8xr-gpvj-cx9g **is directly related to CVE-2025-1217**. The CVE ID is explicitly mentioned in the advisory. The content provides significantly more detail than a typical CVE description.

Here's a breakdown of the extracted information:

**Root cause of vulnerability:**

The header parser of the `http` stream wrapper does not handle folded headers correctly. It treats newlines within a header as header separators instead of recognizing them as continuations of the previous header.

**Weaknesses/vulnerabilities present:**

*   Incorrect parsing of HTTP headers, specifically folded headers.
*   Failure to adhere to RFC9112#5.2 regarding handling of `obs-fold` in HTTP responses.

**Impact of exploitation:**

*   Incorrect MIME type reporting via `STREAM_NOTIFY_MIME_TYPE_IS` notification.
*   Misparsing of the HTTP response, potentially leading to incorrect interpretation of headers, especially in scenarios involving redirects.

**Attack vectors:**

A malicious server can send HTTP responses with folded headers.  The provided PoC demonstrates this using `netcat` to serve a crafted HTTP response.

**Required attacker capabilities/position:**

The attacker needs to be able to control the HTTP response sent to the PHP application using the `http` stream wrapper. This could be a malicious web server or a man-in-the-middle position.

**Mitigation or fix:**

*   Upgrade PHP to version 8.1.32 or later.
*   Upgrade PHP to version 8.2.28 or later.
*   Upgrade PHP to version 8.3.18 or later.
*   Upgrade PHP to version 8.4.5 or later.

**Additional Details (more than official CVE description):**

*   A Proof-of-Concept (PoC) is provided, demonstrating the vulnerability and how to reproduce it.
*   The advisory includes a detailed explanation of the issue and its consequences.
*   The advisory credits TimWolla as the reporter of the vulnerability.
*   The advisory references the relevant RFC (RFC9112) for proper header parsing.

The content from security.netapp.com is unrelated and does not provide any useful information.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.362 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.341 |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.333 |
| 4 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.326 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.326 |
| 6 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.318 |
| 7 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | Allowed | sparse | 0.317 |
| 8 | 156 | Improper Neutralization of Whitespace | Variant | Allowed | sparse | 0.315 |
| 9 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | Allowed | dense | 0.400 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.003 |

