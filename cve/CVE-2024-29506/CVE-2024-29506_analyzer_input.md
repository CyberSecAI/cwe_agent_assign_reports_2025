# Vulnerability Information: CVE-2024-29506

## Vulnerability Description
Artifex Ghostscript before 10.03.0 has a **stack-based buffer overflow** in the pdfi_apply_filter() function via a long PDF filter name.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **vector:** long PDF filter name
- **product:** Artifex Ghostscript
- **version:** before 10.03.0
- **component:** pdfi_apply_filter() function

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-29506:

**CVE-2024-29506: Stack buffer overflow in `pdfi_apply_filter()`**

*   **Root Cause:** A stack buffer overflow vulnerability exists in the `pdfi_apply_filter` function within the Ghostscript PDF interpreter.
*   **Weakness:** The code copies the PDF filter name into a fixed-size stack buffer (`str[100]`) without proper bounds checking. The size of the filter name (`n->length`) is controlled by the attacker, which causes a buffer overflow if the filter name is larger than 100 bytes.
*   **Vulnerability:** Unchecked `memcpy` into a stack buffer.
*  **Impact of Exploitation:** An attacker can cause a stack buffer overflow which could lead to denial of service or potentially arbitrary code execution.
*   **Attack Vector:** The attacker needs to provide a crafted PDF file that contains a filter name larger than 100 bytes in length. The `-dPDFDEBUG` flag must also be enabled to trigger the vulnerable code path.
*   **Required Attacker Capabilities/Position:** The attacker needs to be able to supply a crafted PDF file to Ghostscript and control the command line arguments to enable the `-dPDFDEBUG` flag.

**Summary of relevant details:**
* The vulnerability is located in `pdfi_apply_filter` within the Ghostscript PDF interpreter.
* It is triggered when the `-dPDFDEBUG` flag is enabled.
* A `memcpy` copies an attacker-controlled filter name into a 100-byte stack buffer without any size checks.
* The vulnerability is triggered by a crafted PDF file.
* This vulnerability was fixed in Ghostscript version 10.03.0.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.184 |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.175 |
| 5 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.147 |
| 6 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.147 |
| 7 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.146 |
| 8 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.143 |
| 9 | 788 | Access of Memory Location After End of Buffer | Base | Discouraged | dense | 0.478 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

