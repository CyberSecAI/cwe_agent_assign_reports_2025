## Vulnerability Description
A vulnerability has been found in FreeFloat FTP Server 1.0 and classified as critical. This vulnerability affects unknown code of the component MLS Command Handler. The manipulation leads to **buffer overflow**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** FreeFloat FTP Server
- **version:** 1.0
- **component:** MLS Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-4847 Content

Based on the provided content, this relates to a vulnerability in Freefloat FTP Server version 1.0. The official CVE description is missing, but the content details a remote buffer overflow vulnerability.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the handling of the `MLS` command. The exploit sends a crafted `MLS` command with a payload larger than the buffer allocated to handle it, overwriting memory and potentially gaining control of the execution flow.

**Weaknesses/vulnerabilities present:**

*   **Buffer Overflow:** The Freefloat FTP Server does not properly validate the size of the input provided to the `MLS` command, leading to a buffer overflow.
*   **Lack of Input Validation:** Insufficient input validation allows an attacker to send an oversized payload.

**Impact of exploitation:**

Successful exploitation allows an attacker to overwrite the instruction pointer (EIP) and execute arbitrary code on the target system. The provided exploit attempts to execute shellcode, likely resulting in remote code execution.

**Attack vectors:**

*   **Remote:** The vulnerability is exploitable remotely via the FTP protocol.
*   **MLS Command:** The attack specifically targets the `MLS` command.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the target FTP server.
*   **FTP Client:** The attacker needs an FTP client to send the crafted `MLS` command.
*   **Knowledge of Buffer Offset:** The attacker needs to know the buffer offset (246 bytes in this case) and the address to overwrite EIP (0x7C86467B).

**Mitigation or fix:**

The content does not provide information about a specific fix. However, general mitigation strategies include:

*   **Input Validation:** Implement robust input validation to ensure that the size of the data received in the `MLS` command does not exceed the buffer's capacity.
*   **Buffer Overflow Protection:** Employ buffer overflow protection mechanisms such as stack canaries or Address Space Layout Randomization (ASLR).
*   **Update Software:** Update to a patched version of Freefloat FTP Server if available.

**Additional Details (More than official CVE description):**

The content provides a complete exploit script, including:

*   The offset to overwrite EIP (246).
*   The EIP address to jump to (0x7C86467B - JMP ESP).
*   Shellcode generated using `msfvenom` to establish a reverse TCP shell.
*   Bad characters to avoid (\x00\x0a\x0d).
*   Instructions for setting up a listener using `nc`.
*   The complete exploit code in Perl.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.357 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.335 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.306 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.294 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.292 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.586 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-125: Out-of-bounds Read

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-674: Uncontrolled Recursion

CWE-121: Stack-based Buffer Overflow

CWE-128: Wrap-around Error