# Vulnerability Information: CVE-2024-9358

## Vulnerability Description
A vulnerability has been found in ThingsBoard up to 3.7.0 and classified as problematic. Affected by this vulnerability is an unknown functionality of the component HTTP RPC API. The manipulation leads to resource consumption. The attack can be launched remotely. The complexity of an attack is rather high. The exploitation appears to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 3.7.1 is able to address this issue. It is recommended to upgrade the affected component. The vendor was informed on 2024-07-24 about this vulnerability and announced the release of 3.7.1 for the second half of September 2024.

### Vulnerability Description Key Phrases
- **impact:** resource consumption
- **product:** ThingsBoard
- **version:** up to 3.7.0
- **component:** HTTP RPC API

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The Thingsboard platform attempts to handle a large response from a device's RPC server, leading to resource exhaustion.",
  "Weaknesses/vulnerabilities present": "The vulnerability lies in the lack of proper handling of excessively large responses from an RPC server, leading to resource exhaustion.",
  "Impact of exploitation": "The Thingsboard platform experiences Out-of-Memory (OOM) errors and eventually crashes, resulting in a denial of service.",
  "Attack vectors": "An attacker can exploit this vulnerability by configuring a device's RPC server to return a large amount of data in response to a request initiated through the Thingsboard platform.",
  "Required attacker capabilities/position": "The attacker needs to have control over a device that can host an RPC server that is connected to the Thingsboard platform."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.265 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.251 |
| 3 | 927 | Use of Implicit Intent for Sensitive Communication | Variant | Allowed | sparse | 0.233 |
| 4 | 334 | Small Space of Random Values | Base | Allowed | sparse | 0.233 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.221 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.221 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.220 |
| 8 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.220 |
| 9 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | dense | 0.566 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

