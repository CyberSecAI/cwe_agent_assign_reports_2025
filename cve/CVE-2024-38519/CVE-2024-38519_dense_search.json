{
  "retriever": "dense",
  "query": "`yt-dlp` and `youtube-dl` are command-line audio/video downloaders. Prior to the fixed versions, `yt-dlp` and `youtube-dl` do not limit the extensions of downloaded files, which could lead to arbitrary filenames being created in the download folder (and path traversal on Windows). Since `yt-dlp` and `youtube-dl` also read config from the working directory (and on Windows executables will be executed from the `yt-dlp` or `youtube-dl` directory), this could lead to arbitrary code being executed. `yt-dlp` version 2024.07.01 fixes this issue by whitelisting the allowed extensions. `youtube-dl` fixes this issue in commit `d42a222` on the `master` branch and in nightly builds tagged 2024-07-03 or later. This might mean some very uncommon extensions might not get downloaded, however it will also limit the possible exploitation surface. In addition to upgrading, have `.%(ext)s` at the end of the output template and make sure the user trusts the websites that they are downloading from. Also, make sure to never download to a directory within PATH or other sensitive locations like ones user directory, `system32`, or other binaries locations. For users who are not able to upgrade, keep the default output template (`-o %(title)s [%(id)s].%(ext)s`) make sure the extension of the media to download is a common video/audio/sub/... one try to avoid the generic extractor and/or use `--ignore-config --config-location ...` to not load config from common locations.",
  "keyphrases": {
    "rootcause": [
      "do not limit the extensions of downloaded files"
    ],
    "weakness": [
      "path traversal"
    ]
  },
  "timestamp": "2025-07-13 10:40:23",
  "cve_id": "CVE-2024-38519",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "427",
      "name": "Uncontrolled Search Path Element",
      "type": "Base",
      "score": 0.5017220539828957
    },
    {
      "cwe_id": "61",
      "name": "UNIX Symbolic Link (Symlink) Following",
      "type": "Compound",
      "score": 0.478959503352836
    },
    {
      "cwe_id": "277",
      "name": "Insecure Inherited Permissions",
      "type": "Variant",
      "score": 0.47672208189651777
    },
    {
      "cwe_id": "59",
      "name": "Improper Link Resolution Before File Access ('Link Following')",
      "type": "Base",
      "score": 0.4666718886707596
    },
    {
      "cwe_id": "494",
      "name": "Download of Code Without Integrity Check",
      "type": "Base",
      "score": 0.45917509600905376
    },
    {
      "cwe_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "type": "Base",
      "score": 0.4537745188283062
    },
    {
      "cwe_id": "184",
      "name": "Incomplete List of Disallowed Inputs",
      "type": "Base",
      "score": 0.4531184728128196
    },
    {
      "cwe_id": "379",
      "name": "Creation of Temporary File in Directory with Insecure Permissions",
      "type": "Base",
      "score": 0.45172555249191726
    },
    {
      "cwe_id": "346",
      "name": "Origin Validation Error",
      "type": "Class",
      "score": 0.45145172889596186
    },
    {
      "cwe_id": "73",
      "name": "External Control of File Name or Path",
      "type": "Base",
      "score": 0.44736713707870557
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "type": "Base",
      "score": 0.4337659169648732
    },
    {
      "cwe_id": "1333",
      "name": "Inefficient Regular Expression Complexity",
      "type": "Base",
      "score": 0.4333487001055288
    },
    {
      "cwe_id": "434",
      "name": "Unrestricted Upload of File with Dangerous Type",
      "type": "Base",
      "score": 0.4185675830933747
    },
    {
      "cwe_id": "378",
      "name": "Creation of Temporary File With Insecure Permissions",
      "type": "Base",
      "score": 0.4153358695683121
    },
    {
      "cwe_id": "646",
      "name": "Reliance on File Name or Extension of Externally-Supplied File",
      "type": "Variant",
      "score": 0.4092670615074029
    },
    {
      "cwe_id": "214",
      "name": "Invocation of Process Using Visible Sensitive Information",
      "type": "Base",
      "score": 0.40677510871266576
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "type": "Class",
      "score": 0.40406038688160295
    },
    {
      "cwe_id": "732",
      "name": "Incorrect Permission Assignment for Critical Resource",
      "type": "Class",
      "score": 0.40376961717852156
    },
    {
      "cwe_id": "36",
      "name": "Absolute Path Traversal",
      "type": "Base",
      "score": 0.4017973836374591
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "type": "Base",
      "score": 0.4014447526009488
    }
  ]
}