## Vulnerability Description
Artifex Ghostscript before 10.03.1, when Tesseract is used for OCR, has a **directory traversal** issue that allows arbitrary file reading (and writing of error messages to arbitrary files) via OCRLanguage. For example, exploitation can use debug_file /tmp/out and user_patterns_file /etc/passwd.

### Vulnerability Description Key Phrases
- **weakness:** **directory traversal**
- **impact:** arbitrary file reading and writing
- **vector:** OCR input
- **product:** Artifex Ghostscript
- **version:** before 10.03.1

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of CVE-2024-29511:

**Root Cause:**

The vulnerability stems from the way Ghostscript's `ocr` device interacts with Tesseract, an OCR engine. The `OCRLanguage` parameter, used to specify the language for OCR, allows for path traversal. By using a path like `../../../../../tmp/test`, an attacker can force Tesseract to load a language data file from an arbitrary location, such as `/tmp/test.traineddata`, instead of the expected location within the Ghostscript installation. Tesseract `traineddata` files can contain configuration values, `user_patterns_file` and `debug_file` parameters that are used to load a pattern file and write debug information to a given path respectively. An attacker can create a custom traineddata file with these parameters to perform arbitrary file read and write.

**Weaknesses/Vulnerabilities Present:**

1.  **Path Traversal:** The `OCRLanguage` parameter in Ghostscript's `ocr` device does not properly sanitize or validate the provided path, allowing for directory traversal to access arbitrary files.
2.  **Unvalidated Tesseract Configuration:** Tesseract's configuration files (`traineddata`) include parameters that allow for loading of external files and outputting debug information to arbitrary file paths.
3.  **Lack of Input Validation/Sanitization**: The combination of these allows an attacker to effectively control which files Tesseract will use and output, leading to arbitrary file read and write.

**Impact of Exploitation:**

An attacker can achieve arbitrary file read and write capabilities:
*   **Arbitrary File Read:** By crafting a malicious Tesseract `traineddata` file that specifies a `user_patterns_file`, the attacker can force Tesseract to attempt to load patterns from an arbitrary file (e.g., `/etc/passwd`). The verbose debug output will then contain the contents of that file prefixed by "Error: failed to insert pattern".
*   **Arbitrary File Write:** By crafting a malicious `traineddata` file that specifies a `debug_file`, the attacker can write debug output, which includes contents of the pattern file, to any location the Ghostscript process has write access to.

**Attack Vectors:**

*   The attacker crafts a malicious Tesseract `traineddata` file.
*   The attacker then crafts a PostScript file using the `ocr` device, specifying `OCRLanguage` with a path traversal to the location of the malicious `traineddata` file.
*   When Ghostscript processes the PostScript file, it uses the path-traversal-modified `OCRLanguage` parameter to load the malicious `traineddata` file.
*   Tesseract, based on configuration in the malicious traineddata file, loads and processes the attacker specified `user_patterns_file` and outputs its contents to the attacker specified `debug_file`.

**Required Attacker Capabilities/Position:**

*   The attacker needs the ability to provide a PostScript file that will be processed by Ghostscript with Tesseract support enabled.
*   The attacker needs to have write access to a location where they can store the malicious `traineddata` file (e.g., `/tmp`).
*   The attacker needs to be able to specify a path with path traversal through the `OCRLanguage` parameter in the PostScript file to force the use of the malicious Tesseract config.
*   The attacker needs to have read access to the Ghostscript output file to extract data that was read by the Tesseract library.
*   Ghostscript must be compiled with Tesseract support.

**Additional Notes**

*   The vulnerability does not lead to Remote Code Execution (RCE) directly, as stated in the changelog, despite being initially stated as a possible RCE vector.
*   The vulnerability is a partial SAFER sandbox bypass, as it allows for file system access that is normally restricted.
*   The fix for this vulnerability was included in Ghostscript version 10.03.0.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.212 |
| 3 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.206 |
| 4 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.191 |
| 5 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.188 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.186 |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.184 |
| 8 | 62 | UNIX Hard Link | Variant | Allowed | sparse | 0.180 |
| 9 | 24 | Path Traversal: '../filedir' | Variant | Allowed | dense | 0.545 |
| 10 | 363 | Race Condition Enabling Link Following | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-23: Relative Path Traversal

CWE-36: Absolute Path Traversal

CWE-427: Uncontrolled Search Path Element

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-62: UNIX Hard Link

CWE-24: Path Traversal: '../filedir'

CWE-363: Race Condition Enabling Link Following