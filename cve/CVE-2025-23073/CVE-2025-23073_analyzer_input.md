# Vulnerability Information: CVE-2025-23073

## Vulnerability Description
Exposure of Sensitive Information to an Unauthorized Actor vulnerability in Wikimedia Foundation Mediawiki - GlobalBlocking Extension allows Retrieve Embedded Sensitive Data. This issue briefly impacted the master branch of MediaWikis GlobalBlocking Extension.

### Vulnerability Description Key Phrases
- **impact:** Exposure of Sensitive Information to an Unauthorized Actor
- **product:** Wikimedia Foundation Mediawiki - GlobalBlocking Extension

## CVE Reference Links Content Summary
## CVE-2025-23073 Analysis

This content is **RELATED** to CVE-2025-23073. It provides detailed information about the vulnerability, its resolution, and related code changes.

**Root cause of vulnerability:**

The vulnerability occurs because the `action=query&list=globalblocks` API endpoint, when provided with both a username and IP address in the `bgtargets` parameter, reveals information about both the global block on the username *and* the associated autoblock on the IP address.

**Weaknesses/vulnerabilities present:**

*   Information disclosure: The API unintentionally exposes the IP address associated with a global block, which could be considered sensitive information.

**Impact of exploitation:**

*   Exposure of user IP addresses: An attacker who knows a username and correctly guesses the associated IP address can discover the IP address that was autoblocked.

**Attack vectors:**

*   API request: An attacker can send a crafted API request to the `action=query&list=globalblocks` endpoint with the `bgtargets` parameter set to `<username>|<user's ip>`.

**Required attacker capabilities/position:**

*   Knowledge of a username.
*   Ability to guess the user's IP address (e.g., by observing the user's edits on a wiki).
*   Ability to make API requests to the MediaWiki instance.

**Mitigation or fix:**

*   The API was modified to hide autoblocks when the `bgtargets` parameter includes both a username and an IP address.
*   Two Gerrit commits were merged to address the issue:
    *   [https://gerrit.wikimedia.org/r/1082231](https://gerrit.wikimedia.org/r/1082231)
    *   [https://gerrit.wikimedia.org/r/1084748](https://gerrit.wikimedia.org/r/1084748)

**Additional Details (more than official CVE description):**

*   The vulnerability was not present in any release version of MediaWiki.
*   The issue was initially found on local docker GlobalBlocking builds and beta wikis.
*   The CVE description was initially incorrect and has been updated.
*   The fix has been deployed and the issue is no longer reproducible.
*   The risk rating was assessed as Medium.
*   The task was assigned to Dreamy\_Jazz and authored by dom\_walden.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.055 |
| 2 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.052 |
| 3 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.045 |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.044 |
| 5 | 540 | Inclusion of Sensitive Information in Source Code | Base | Allowed | sparse | 0.044 |
| 6 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.044 |
| 7 | 524 | Use of Cache Containing Sensitive Information | Base | Allowed | sparse | 0.043 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.043 |
| 9 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | Allowed | dense | 0.555 |
| 10 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | graph | 0.002 |

