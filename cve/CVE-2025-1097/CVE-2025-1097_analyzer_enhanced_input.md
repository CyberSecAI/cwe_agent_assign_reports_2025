## Vulnerability Description
A security issue was discovered in ingress-nginx https//github.com/kubernetes/ingress-nginx where the `auth-tls-match-cn` Ingress annotation can be used to inject configuration into nginx. This can lead to **arbitrary code execution** in the context of the ingress-nginx controller, and disclosure of Secrets accessible to the controller. (Note that in the default installation, the controller can access all Secrets cluster-wide.)

### Vulnerability Description Key Phrases
- **rootcause:** **improper configuration**
- **vector:** auth-tls-match-cn Ingress annotation
- **weakness:** **arbitrary code execution**
- **product:** ingress-nginx
- **impact:** arbitrary code execution, disclosure of Secrets

## CVE Reference Links Content Summary
```
- **Root cause of vulnerability:** The `auth-tls-match-cn` Ingress annotation in ingress-nginx is not properly sanitized, allowing for configuration injection.
- **Weaknesses/vulnerabilities present:** Configuration injection, arbitrary code execution, and disclosure of Secrets.
- **Impact of exploitation:** Arbitrary code execution in the context of the ingress-nginx controller and disclosure of Secrets accessible to the controller.
- **Attack vectors:** Exploitation through the `auth-tls-match-cn` annotation in an Ingress resource.
- **Required attacker capabilities/position:** An attacker with the ability to create or modify Ingress resources.
- **Mitigation or fix:** Upgrade ingress-nginx to v1.11.5, v1.12.1, or any later version.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.392 |
| 2 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.388 |
| 3 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.384 |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.382 |
| 5 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.381 |
| 6 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.379 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.367 |
| 8 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.366 |
| 9 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | dense | 0.541 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-256: Plaintext Storage of a Password

CWE-522: Insufficiently Protected Credentials

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-287: Improper Authentication

CWE-668: Exposure of Resource to Wrong Sphere

CWE-306: Missing Authentication for Critical Function

CWE-319: Cleartext Transmission of Sensitive Information

CWE-941: Incorrectly Specified Destination in a Communication Channel

CWE-613: Insufficient Session Expiration