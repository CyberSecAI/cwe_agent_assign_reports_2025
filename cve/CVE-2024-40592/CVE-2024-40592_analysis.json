{
  "cve_id": "CVE-2024-40592",
  "description": "An improper verification of cryptographic signature vulnerability [CWE-347] in FortiClient MacOS version 7.4.0, version 7.2.4 and below, version 7.0.10 and below, version 6.4.10 and below may allow a local authenticated attacker toswap the installer with a malicious package via a **race condition** during the installation process.",
  "key_phrases": {
    "rootcause": [
      "improper verification of cryptographic signature vulnerability CWE-347",
      "race condition"
    ],
    "weakness": "",
    "impact": "swap the installer with a malicious package",
    "vector": "race condition during the installation process",
    "attacker": "local authenticated attacker",
    "product": "FortiClient MacOS",
    "version": [
      "['7.4.0'",
      "'7.2.4 and below'",
      "'7.0.10 and below'",
      "'6.4.10 and below']"
    ],
    "component": ""
  },
  "reference_content": "Based on the provided content, here's a breakdown of the vulnerability:\n\n**Vulnerability:** Improper verification of cryptographic signatures during the installation process of FortiClient MacOS.\n\n**Root Cause:**  The application fails to properly verify the cryptographic signature of the installer package, which is downloaded and installed. Specifically, there is a race condition where an attacker can replace the genuine installer with a malicious one before the signature check takes place.\n\n**Weakness/Vulnerability:**\n*   **CWE-347:** Improper Verification of Cryptographic Signature\n\n**Impact of Exploitation:**\n*   Successful exploitation allows a local authenticated attacker to execute unauthorized code or commands on the affected system by installing a malicious package.\n\n**Attack Vectors:**\n*   A local attacker needs to have authenticated access to the system.\n*   The attacker exploits a race condition during the installation process.\n\n**Required Attacker Capabilities/Position:**\n*   Local authenticated access to the target MacOS system.\n*   Ability to manipulate files in the target system's file system during the installation process to exploit the race condition.\n\n**Affected Versions:**\n*   FortiClientMac 7.4.0\n*   FortiClientMac 7.2.0 through 7.2.4\n*   FortiClientMac 7.0.0 through 7.0.10\n*   FortiClientMac 6.4 all versions\n\n**Mitigation:**\n*   Upgrade to FortiClientMac 7.4.1 or above\n*   Upgrade to FortiClientMac 7.2.5 or above\n*   Migrate to a fixed release for FortiClientMac 7.0 and 6.4 versions.\n\n**Additional Notes:**\n*   The vulnerability was reported by Mykola Grymalyuk from RIPEDA Consulting.\n*   The severity is rated as Medium with a CVSSv3 score of 6.8 (AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H/E:P/RL:X/RC:R)",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name  | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-347 | Improper Verification of Cryptographic Signature | 1.0 | Base | Primary | Allowed |\n| CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 0.9 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.95\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **improper verification of cryptographic signature** (CWE-347), which allows for the possibility of swapping a legitimate installer with a malicious one. This is further enabled by a **race condition** (CWE-367) during the installation process. The race condition makes it more likely that the **improper verification** can be exploited.\n\n```mermaid\ngraph TD\n    cwe347[\"CWE-347: Improper Verification of Cryptographic Signature\"]\n    cwe367[\"CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition\"]\n\n    cwe367 -- CANPRECEDE --> cwe347\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe347 primary\n    class cwe367 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **improper verification of the cryptographic signature** (CWE-347). The **race condition** (CWE-367) during the installation process creates a window of opportunity for an attacker to swap the legitimate installer with a malicious one. The impact is that a local authenticated attacker can execute arbitrary code by installing the malicious package.\n  - The first in the \"Vulnerability Chain\" is CWE-347\n## Summary of Analysis\nThe analysis is based on the provided evidence, which includes the vulnerability description and key phrases. The description clearly states an \"**improper verification of cryptographic signature vulnerability**\" and a \"**race condition**\".\n\nThe retriever results and the vulnerability description consistently point to CWE-347 as the primary weakness. The **race condition** is also mentioned and has a high retriever score for CWE-367.\n\nThe selection of CWE-347 and CWE-367 is at the optimal level of specificity, as they directly represent the identified weaknesses.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-345: Insufficient Verification of Data Authenticity\n**Abstraction Level**: Class\n**Similarity Score**: 0.77\n**Source**: dense\n\n**Description**:\nThe product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-203: Observable Discrepancy\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-330: Use of Insufficiently Random Values\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-41: Improper Resolution of Path Equivalence\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product is vulnerable to file system contents disclosure through path equivalence. Path equivalence involves the use of special characters in file and directory names. The associated manipulations are intended to generate multiple names for the same object.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-451: User Interface (UI) Misrepresentation of Critical Information\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe user interface (UI) does not properly represent critical information to the user, allowing the information - or its source - to be obscured or spoofed. This is often a component in phishing attacks.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-59: Improper Link Resolution Before File Access ('Link Following')\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-347: Improper Verification of Cryptographic Signature\n**Abstraction Level**: Base\n**Similarity Score**: 3922.80\n**Source**: sparse\n\n**Description**:\nThe product does not verify, or incorrectly verifies, the cryptographic signature for data.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-732: Incorrect Permission Assignment for Critical Resource\n**Abstraction Level**: Class\n**Similarity Score**: 3483.97\n**Source**: sparse\n\n**Description**:\nThe product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: While the name itself indicates an assignment of permissions for resources, this is often misused for vulnerabilities in which \"permissions\" are not checked, which is an \"authorization\" weakness (CWE-285 or descendants) within CWE's model [REF-1287].\n\n\n\n## CWE-99: Improper Control of Resource Identifiers ('Resource Injection",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name  | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-347 | Improper Verification of Cryptographic Signature | 1.0 | Base | Primary | Allowed |\n| CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 0.9 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.95\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **improper verification of cryptographic signature** (CWE-347), which allows for the possibility of swapping a legitimate installer with a malicious one. This is further enabled by a **race condition** (CWE-367) during the installation process. The race condition makes it more likely that the **improper verification** can be exploited.\n\n```mermaid\ngraph TD\n    cwe347[\"CWE-347: Improper Verification of Cryptographic Signature\"]\n    cwe367[\"CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition\"]\n\n    cwe367 -- CANPRECEDE --> cwe347\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe347 primary\n    class cwe367 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **improper verification of the cryptographic signature** (CWE-347). The **race condition** (CWE-367) during the installation process creates a window of opportunity for an attacker to swap the legitimate installer with a malicious one. The impact is that a local authenticated attacker can execute arbitrary code by installing the malicious package.\n  - The first in the \"Vulnerability Chain\" is CWE-347\n## Summary of Analysis\nThe analysis is based on the provided evidence, which includes the vulnerability description and key phrases. The description clearly states an \"**improper verification of cryptographic signature vulnerability**\" and a \"**race condition**\".\n\nThe retriever results and the vulnerability description consistently point to CWE-347 as the primary weakness. The **race condition** is also mentioned and has a high retriever score for CWE-367.\n\nThe selection of CWE-347 and CWE-367 is at the optimal level of specificity, as they directly represent the identified weaknesses.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-345: Insufficient Verification of Data Authenticity\n**Abstraction Level**: Class\n**Similarity Score**: 0.77\n**Source**: dense\n\n**Description**:\nThe product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n\n\n## CWE-303: Incorrect Implementation of Authentication Algorithm\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-203: Observable Discrepancy\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-330: Use of Insufficiently Random Values\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n\n\n## CWE-41: Improper Resolution of Path Equivalence\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product is vulnerable to file system contents disclosure through path equivalence. Path equivalence involves the use of special characters in file and directory names. The associated manipulations are intended to generate multiple names for the same object.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-451: User Interface (UI) Misrepresentation of Critical Information\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe user interface (UI) does not properly represent critical information to the user, allowing the information - or its source - to be obscured or spoofed. This is often a component in phishing attacks.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n\n## CWE-59: Improper Link Resolution Before File Access ('Link Following')\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-347: Improper Verification of Cryptographic Signature\n**Abstraction Level**: Base\n**Similarity Score**: 3922.80\n**Source**: sparse\n\n**Description**:\nThe product does not verify, or incorrectly verifies, the cryptographic signature for data.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n\n## CWE-732: Incorrect Permission Assignment for Critical Resource\n**Abstraction Level**: Class\n**Similarity Score**: 3483.97\n**Source**: sparse\n\n**Description**:\nThe product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: While the name itself indicates an assignment of permissions for resources, this is often misused for vulnerabilities in which \"permissions\" are not checked, which is an \"authorization\" weakness (CWE-285 or descendants) within CWE's model [REF-1287].\n\n\n\n## CWE-99: Improper Control of Resource Identifiers ('Resource Injection\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-99:**\n- 99 (Improper Control of Resource Identifiers ('Resource Injection')) - ROOT\n\n\n**Chain starting from CWE-203:**\n- 203 (Observable Discrepancy) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "source": "sparse",
        "original_content": "The product does not verify, or incorrectly verifies, the cryptographic signature for data.",
        "keyphrase_sources": [
          {
            "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
            "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
            "type": "rootcause"
          },
          {
            "id": "rootcause:race condition",
            "keyphrase": "race condition",
            "type": "rootcause"
          },
          {
            "id": "impact:swap the installer with a malicious package",
            "keyphrase": "swap the installer with a malicious package",
            "type": "impact"
          },
          {
            "id": "vector:race condition during the installation process",
            "keyphrase": "race condition during the installation process",
            "type": "vector"
          },
          {
            "id": "attacker:local authenticated attacker",
            "keyphrase": "local authenticated attacker",
            "type": "attacker"
          },
          {
            "id": "product:FortiClient MacOS",
            "keyphrase": "FortiClient MacOS",
            "type": "product"
          },
          {
            "id": "version:['7.4.0'",
            "keyphrase": "['7.4.0'",
            "type": "version"
          },
          {
            "id": "version:'7.2.4 and below'",
            "keyphrase": "'7.2.4 and below'",
            "type": "version"
          },
          {
            "id": "version:'7.0.10 and below'",
            "keyphrase": "'7.0.10 and below'",
            "type": "version"
          },
          {
            "id": "version:'6.4.10 and below']",
            "keyphrase": "'6.4.10 and below']",
            "type": "version"
          }
        ]
      },
      "similarity": 625.3344439405835
    },
    {
      "metadata": {
        "doc_id": "325",
        "name": "Missing Cryptographic Step",
        "source": "sparse",
        "original_content": "The product does not implement a required step in a cryptographic algorithm, resulting in weaker encryption than advertised by the algorithm.",
        "keyphrase_sources": [
          {
            "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
            "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
            "type": "rootcause"
          }
        ]
      },
      "similarity": 410.0806900304959
    },
    {
      "metadata": {
        "doc_id": "345",
        "name": "Insufficient Verification of Data Authenticity",
        "source": "sparse",
        "original_content": "The product does not sufficiently verify the origin or authenticity of data, in a way that causes it to accept invalid data.",
        "keyphrase_sources": [
          {
            "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
            "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
            "type": "rootcause"
          }
        ]
      },
      "similarity": 405.64236360963775
    },
    {
      "metadata": {
        "doc_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "source": "sparse",
        "original_content": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.",
        "keyphrase_sources": [
          {
            "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
            "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
            "type": "rootcause"
          },
          {
            "id": "rootcause:race condition",
            "keyphrase": "race condition",
            "type": "rootcause"
          },
          {
            "id": "impact:swap the installer with a malicious package",
            "keyphrase": "swap the installer with a malicious package",
            "type": "impact"
          },
          {
            "id": "vector:race condition during the installation process",
            "keyphrase": "race condition during the installation process",
            "type": "vector"
          },
          {
            "id": "attacker:local authenticated attacker",
            "keyphrase": "local authenticated attacker",
            "type": "attacker"
          },
          {
            "id": "product:FortiClient MacOS",
            "keyphrase": "FortiClient MacOS",
            "type": "product"
          },
          {
            "id": "version:['7.4.0'",
            "keyphrase": "['7.4.0'",
            "type": "version"
          },
          {
            "id": "version:'7.2.4 and below'",
            "keyphrase": "'7.2.4 and below'",
            "type": "version"
          },
          {
            "id": "version:'7.0.10 and below'",
            "keyphrase": "'7.0.10 and below'",
            "type": "version"
          },
          {
            "id": "version:'6.4.10 and below']",
            "keyphrase": "'6.4.10 and below']",
            "type": "version"
          }
        ]
      },
      "similarity": 374.7502488173517
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse",
        "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
        "keyphrase_sources": [
          {
            "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
            "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
            "type": "rootcause"
          }
        ]
      },
      "similarity": 373.8748923053286
    },
    {
      "metadata": {
        "doc_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "source": "sparse",
        "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.",
        "keyphrase_sources": [
          {
            "id": "rootcause:race condition",
            "keyphrase": "race condition",
            "type": "rootcause"
          },
          {
            "id": "vector:race condition during the installation process",
            "keyphrase": "race condition during the installation process",
            "type": "vector"
          }
        ]
      },
      "similarity": 358.17049044522383
    },
    {
      "metadata": {
        "doc_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "source": "sparse",
        "original_content": "The product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence operating concurrently.",
        "keyphrase_sources": [
          {
            "id": "rootcause:race condition",
            "keyphrase": "race condition",
            "type": "rootcause"
          }
        ]
      },
      "similarity": 332.3722610836189
    },
    {
      "metadata": {
        "doc_id": "427",
        "name": "Uncontrolled Search Path Element",
        "source": "sparse",
        "original_content": "The product uses a fixed or controlled search path to find resources, but one or more locations in that path can be under the control of unintended actors.",
        "keyphrase_sources": [
          {
            "id": "rootcause:race condition",
            "keyphrase": "race condition",
            "type": "rootcause"
          },
          {
            "id": "impact:swap the installer with a malicious package",
            "keyphrase": "swap the installer with a malicious package",
            "type": "impact"
          },
          {
            "id": "vector:race condition during the installation process",
            "keyphrase": "race condition during the installation process",
            "type": "vector"
          }
        ]
      },
      "similarity": 320.3025540031424
    },
    {
      "metadata": {
        "doc_id": "277",
        "name": "Insecure Inherited Permissions",
        "source": "sparse",
        "original_content": "A product defines a set of insecure permissions that are inherited by objects that are created by the program.",
        "keyphrase_sources": [
          {
            "id": "impact:swap the installer with a malicious package",
            "keyphrase": "swap the installer with a malicious package",
            "type": "impact"
          },
          {
            "id": "product:FortiClient MacOS",
            "keyphrase": "FortiClient MacOS",
            "type": "product"
          }
        ]
      },
      "similarity": 136.8479873033805
    },
    {
      "metadata": {
        "doc_id": "250",
        "name": "Execution with Unnecessary Privileges",
        "source": "sparse",
        "original_content": "The product performs an operation at a privilege level that is higher than the minimum level required, which creates new weaknesses or amplifies the consequences of other weaknesses.",
        "keyphrase_sources": [
          {
            "id": "impact:swap the installer with a malicious package",
            "keyphrase": "swap the installer with a malicious package",
            "type": "impact"
          },
          {
            "id": "vector:race condition during the installation process",
            "keyphrase": "race condition during the installation process",
            "type": "vector"
          },
          {
            "id": "attacker:local authenticated attacker",
            "keyphrase": "local authenticated attacker",
            "type": "attacker"
          },
          {
            "id": "product:FortiClient MacOS",
            "keyphrase": "FortiClient MacOS",
            "type": "product"
          },
          {
            "id": "version:['7.4.0'",
            "keyphrase": "['7.4.0'",
            "type": "version"
          }
        ]
      },
      "similarity": 136.75059157193076
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "source": "sparse",
        "original_content": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
        "keyphrase_sources": [
          {
            "id": "version:'7.2.4 and below'",
            "keyphrase": "'7.2.4 and below'",
            "type": "version"
          },
          {
            "id": "version:'7.0.10 and below'",
            "keyphrase": "'7.0.10 and below'",
            "type": "version"
          },
          {
            "id": "version:'6.4.10 and below']",
            "keyphrase": "'6.4.10 and below']",
            "type": "version"
          }
        ]
      },
      "similarity": 126.22909667936145
    },
    {
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "source": "sparse",
        "original_content": "The product allows user input to control or influence paths or file names that are used in filesystem operations.",
        "keyphrase_sources": [
          {
            "id": "version:'7.2.4 and below'",
            "keyphrase": "'7.2.4 and below'",
            "type": "version"
          },
          {
            "id": "version:'7.0.10 and below'",
            "keyphrase": "'7.0.10 and below'",
            "type": "version"
          },
          {
            "id": "version:'6.4.10 and below']",
            "keyphrase": "'6.4.10 and below']",
            "type": "version"
          }
        ]
      },
      "similarity": 125.49622651207238
    },
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "sparse",
        "original_content": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.",
        "keyphrase_sources": [
          {
            "id": "attacker:local authenticated attacker",
            "keyphrase": "local authenticated attacker",
            "type": "attacker"
          },
          {
            "id": "product:FortiClient MacOS",
            "keyphrase": "FortiClient MacOS",
            "type": "product"
          },
          {
            "id": "version:['7.4.0'",
            "keyphrase": "['7.4.0'",
            "type": "version"
          },
          {
            "id": "version:'7.0.10 and below'",
            "keyphrase": "'7.0.10 and below'",
            "type": "version"
          },
          {
            "id": "version:'6.4.10 and below']",
            "keyphrase": "'6.4.10 and below']",
            "type": "version"
          }
        ]
      },
      "similarity": 117.55329971104588
    },
    {
      "metadata": {
        "doc_id": "522",
        "name": "Insufficiently Protected Credentials",
        "source": "sparse",
        "original_content": "The product transmits or stores authentication credentials, but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval.",
        "keyphrase_sources": [
          {
            "id": "attacker:local authenticated attacker",
            "keyphrase": "local authenticated attacker",
            "type": "attacker"
          },
          {
            "id": "version:['7.4.0'",
            "keyphrase": "['7.4.0'",
            "type": "version"
          },
          {
            "id": "version:'7.2.4 and below'",
            "keyphrase": "'7.2.4 and below'",
            "type": "version"
          }
        ]
      },
      "similarity": 117.07906253280088
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-99",
      "CWE-203",
      "CWE-345",
      "CWE-732",
      "CWE-330",
      "CWE-59",
      "CWE-347",
      "CWE-668",
      "CWE-303",
      "CWE-1391",
      "CWE-451",
      "CWE-285",
      "CWE-367",
      "CWE-497",
      "CWE-41"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {
    "347": [
      {
        "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
        "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
        "type": "rootcause"
      },
      {
        "id": "rootcause:race condition",
        "keyphrase": "race condition",
        "type": "rootcause"
      },
      {
        "id": "impact:swap the installer with a malicious package",
        "keyphrase": "swap the installer with a malicious package",
        "type": "impact"
      },
      {
        "id": "vector:race condition during the installation process",
        "keyphrase": "race condition during the installation process",
        "type": "vector"
      },
      {
        "id": "attacker:local authenticated attacker",
        "keyphrase": "local authenticated attacker",
        "type": "attacker"
      },
      {
        "id": "product:FortiClient MacOS",
        "keyphrase": "FortiClient MacOS",
        "type": "product"
      },
      {
        "id": "version:['7.4.0'",
        "keyphrase": "['7.4.0'",
        "type": "version"
      },
      {
        "id": "version:'7.2.4 and below'",
        "keyphrase": "'7.2.4 and below'",
        "type": "version"
      },
      {
        "id": "version:'7.0.10 and below'",
        "keyphrase": "'7.0.10 and below'",
        "type": "version"
      },
      {
        "id": "version:'6.4.10 and below']",
        "keyphrase": "'6.4.10 and below']",
        "type": "version"
      }
    ],
    "325": [
      {
        "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
        "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
        "type": "rootcause"
      }
    ],
    "345": [
      {
        "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
        "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
        "type": "rootcause"
      }
    ],
    "732": [
      {
        "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
        "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
        "type": "rootcause"
      },
      {
        "id": "rootcause:race condition",
        "keyphrase": "race condition",
        "type": "rootcause"
      },
      {
        "id": "impact:swap the installer with a malicious package",
        "keyphrase": "swap the installer with a malicious package",
        "type": "impact"
      },
      {
        "id": "vector:race condition during the installation process",
        "keyphrase": "race condition during the installation process",
        "type": "vector"
      },
      {
        "id": "attacker:local authenticated attacker",
        "keyphrase": "local authenticated attacker",
        "type": "attacker"
      },
      {
        "id": "product:FortiClient MacOS",
        "keyphrase": "FortiClient MacOS",
        "type": "product"
      },
      {
        "id": "version:['7.4.0'",
        "keyphrase": "['7.4.0'",
        "type": "version"
      },
      {
        "id": "version:'7.2.4 and below'",
        "keyphrase": "'7.2.4 and below'",
        "type": "version"
      },
      {
        "id": "version:'7.0.10 and below'",
        "keyphrase": "'7.0.10 and below'",
        "type": "version"
      },
      {
        "id": "version:'6.4.10 and below']",
        "keyphrase": "'6.4.10 and below']",
        "type": "version"
      }
    ],
    "287": [
      {
        "id": "rootcause:improper verification of cryptographic signature vulnerability CWE-347",
        "keyphrase": "improper verification of cryptographic signature vulnerability CWE-347",
        "type": "rootcause"
      }
    ],
    "367": [
      {
        "id": "rootcause:race condition",
        "keyphrase": "race condition",
        "type": "rootcause"
      },
      {
        "id": "vector:race condition during the installation process",
        "keyphrase": "race condition during the installation process",
        "type": "vector"
      }
    ],
    "362": [
      {
        "id": "rootcause:race condition",
        "keyphrase": "race condition",
        "type": "rootcause"
      }
    ],
    "427": [
      {
        "id": "rootcause:race condition",
        "keyphrase": "race condition",
        "type": "rootcause"
      },
      {
        "id": "impact:swap the installer with a malicious package",
        "keyphrase": "swap the installer with a malicious package",
        "type": "impact"
      },
      {
        "id": "vector:race condition during the installation process",
        "keyphrase": "race condition during the installation process",
        "type": "vector"
      }
    ],
    "277": [
      {
        "id": "impact:swap the installer with a malicious package",
        "keyphrase": "swap the installer with a malicious package",
        "type": "impact"
      },
      {
        "id": "product:FortiClient MacOS",
        "keyphrase": "FortiClient MacOS",
        "type": "product"
      }
    ],
    "250": [
      {
        "id": "impact:swap the installer with a malicious package",
        "keyphrase": "swap the installer with a malicious package",
        "type": "impact"
      },
      {
        "id": "vector:race condition during the installation process",
        "keyphrase": "race condition during the installation process",
        "type": "vector"
      },
      {
        "id": "attacker:local authenticated attacker",
        "keyphrase": "local authenticated attacker",
        "type": "attacker"
      },
      {
        "id": "product:FortiClient MacOS",
        "keyphrase": "FortiClient MacOS",
        "type": "product"
      },
      {
        "id": "version:['7.4.0'",
        "keyphrase": "['7.4.0'",
        "type": "version"
      }
    ],
    "284": [
      {
        "id": "attacker:local authenticated attacker",
        "keyphrase": "local authenticated attacker",
        "type": "attacker"
      },
      {
        "id": "product:FortiClient MacOS",
        "keyphrase": "FortiClient MacOS",
        "type": "product"
      },
      {
        "id": "version:['7.4.0'",
        "keyphrase": "['7.4.0'",
        "type": "version"
      },
      {
        "id": "version:'7.0.10 and below'",
        "keyphrase": "'7.0.10 and below'",
        "type": "version"
      },
      {
        "id": "version:'6.4.10 and below']",
        "keyphrase": "'6.4.10 and below']",
        "type": "version"
      }
    ],
    "522": [
      {
        "id": "attacker:local authenticated attacker",
        "keyphrase": "local authenticated attacker",
        "type": "attacker"
      },
      {
        "id": "version:['7.4.0'",
        "keyphrase": "['7.4.0'",
        "type": "version"
      },
      {
        "id": "version:'7.2.4 and below'",
        "keyphrase": "'7.2.4 and below'",
        "type": "version"
      }
    ],
    "78": [
      {
        "id": "version:'7.2.4 and below'",
        "keyphrase": "'7.2.4 and below'",
        "type": "version"
      },
      {
        "id": "version:'7.0.10 and below'",
        "keyphrase": "'7.0.10 and below'",
        "type": "version"
      },
      {
        "id": "version:'6.4.10 and below']",
        "keyphrase": "'6.4.10 and below']",
        "type": "version"
      }
    ],
    "73": [
      {
        "id": "version:'7.2.4 and below'",
        "keyphrase": "'7.2.4 and below'",
        "type": "version"
      },
      {
        "id": "version:'7.0.10 and below'",
        "keyphrase": "'7.0.10 and below'",
        "type": "version"
      },
      {
        "id": "version:'6.4.10 and below']",
        "keyphrase": "'6.4.10 and below']",
        "type": "version"
      }
    ]
  }
}