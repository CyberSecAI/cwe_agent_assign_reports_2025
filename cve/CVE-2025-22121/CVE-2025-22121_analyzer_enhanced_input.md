## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved ext4 fix out-of-bound read in ext4_xattr_inode_dec_ref_all() Theres issue as follows BUG KASAN **use-after-free** in ext4_xattr_inode_dec_ref_all+0x6ff/0x790 Read of size 4 at addr ffff88807b003000 by task syz-executor.0/15172 CPU 3 PID 15172 Comm syz-executor.0 Call Trace __dump_stack lib/dump_stack.c82 [inline] dump_stack+0xbe/0xfd lib/dump_stack.c123 print_address_description.constprop.0+0x1e/0x280 mm/kasan/report.c400 __kasan_report.cold+0x6c/0x84 mm/kasan/report.c560 kasan_report+0x3a/0x50 mm/kasan/report.c585 ext4_xattr_inode_dec_ref_all+0x6ff/0x790 fs/ext4/xattr.c1137 ext4_xattr_delete_inode+0x4c7/0xda0 fs/ext4/xattr.c2896 ext4_evict_inode+0xb3b/0x1670 fs/ext4/inode.c323 evict+0x39f/0x880 fs/inode.c622 iput_final fs/inode.c1746 [inline] iput fs/inode.c1772 [inline] iput+0x525/0x6c0 fs/inode.c1758 ext4_orphan_cleanup fs/ext4/super.c3298 [inline] ext4_fill_super+0x8c57/0xba40 fs/ext4/super.c5300 mount_bdev+0x355/0x410 fs/super.c1446 legacy_get_tree+0xfe/0x220 fs/fs_context.c611 vfs_get_tree+0x8d/0x2f0 fs/super.c1576 do_new_mount fs/namespace.c2983 [inline] path_mount+0x119a/0x1ad0 fs/namespace.c3316 do_mount+0xfc/0x110 fs/namespace.c3329 __do_sys_mount fs/namespace.c3540 [inline] __se_sys_mount+0x219/0x2e0 fs/namespace.c3514 do_syscall_64+0x33/0x40 arch/x86/entry/common.c46 entry_SYSCALL_64_after_hwframe+0x67/0xd1 Memory state around the buggy address ffff88807b002f00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ffff88807b002f80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >ffff88807b003000 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ^ ffff88807b003080 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ffff88807b003100 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff Above issue happens as ext4_xattr_delete_inode() isnt check xattr is valid if xattr is in inode. To solve above issue call xattr_check_inode() check if xattr if valid in inode. In fact, we can directly verify in ext4_iget_extra_inode(), so that there is no divergent verification.

### Vulnerability Description Key Phrases
- **weakness:** **use-after-free**
- **product:** Linux kernel
- **component:** ext4_xattr_inode_dec_ref_all

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 416 | Use After Free | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | sparse | 1.055 |
| 3 | 912 | Hidden Functionality | Class | Allowed-with-Review | sparse | 1.022 |
| 4 | 763 | Release of Invalid Pointer or Reference | Base | Allowed | sparse | 0.890 |
| 5 | 294 | Authentication Bypass by Capture-replay | Base | Allowed | sparse | 0.820 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.788 |
| 7 | 657 | Violation of Secure Design Principles | Class | Discouraged | sparse | 0.774 |
| 8 | 158 | Improper Neutralization of Null Byte or NUL Character | Variant | Allowed | sparse | 0.745 |
| 9 | 667 | Improper Locking | Class | Allowed-with-Review | dense | 0.543 |
| 10 | 364 | Signal Handler Race Condition | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-416: Use After Free

CWE-288: Authentication Bypass Using an Alternate Path or Channel

CWE-912: Hidden Functionality

CWE-763: Release of Invalid Pointer or Reference

CWE-294: Authentication Bypass by Capture-replay

CWE-306: Missing Authentication for Critical Function

CWE-657: Violation of Secure Design Principles

CWE-158: Improper Neutralization of Null Byte or NUL Character

CWE-667: Improper Locking

CWE-364: Signal Handler Race Condition