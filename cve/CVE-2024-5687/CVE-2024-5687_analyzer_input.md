# Vulnerability Information: CVE-2024-5687

## Vulnerability Description
If a specific sequence of actions is performed when opening a new tab, the triggering principal associated with the new tab may have been incorrect. The triggering principal is used to calculate many values, including the `Referer` and `Sec-*` headers, meaning there is the potential for incorrect security checks within the browser in addition to incorrect or misleading information sent to remote websites. *This bug only affects Firefox for Android. Other versions of Firefox are unaffected.* This vulnerability affects Firefox < 127.

### Vulnerability Description Key Phrases
- **rootcause:** **incorrect triggering principal**
- **impact:** incorrect security checks
- **vector:** specific sequence of actions
- **product:** Firefox
- **version:** < 127
- **component:** Android version

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-5687:

**Root cause of vulnerability:**
- An incorrect principal could be used when opening new tabs under specific circumstances.

**Weaknesses/vulnerabilities present:**
- Incorrect triggering principal: The principal associated with a new tab can be incorrectly assigned if a specific sequence of actions is performed during tab creation.

**Impact of exploitation:**
- Incorrect Security Checks: The triggering principal is used to calculate values like the `Referer` and `Sec-` headers. An incorrect principal can result in flawed security checks within the browser.
- Misleading Information: Incorrect information can be sent to remote websites due to the wrong headers being used, this could have an impact on the way the remote sites respond to the user.

**Attack vectors:**
- A specific sequence of actions while opening a new tab. The exact nature of this sequence is not specified but it is likely a specific combination of user actions and browser events.

**Required attacker capabilities/position:**
- An attacker needs to be able to manipulate the browser through actions in such a manner that it results in the described sequence of actions. The specific requirements for this are not known.

**Additional Notes:**
- This vulnerability only affects Firefox for Android.
- The provided bug report (Bug 1889066) is not publicly accessible, further limiting details about the exact exploitation process.
- The vulnerability can lead to incorrect security checks and incorrect/misleading information sent to remote websites.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 451 | User Interface (UI) Misrepresentation of Critical Information | Class | Allowed-with-Review | sparse | 0.465 |
| 2 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.456 |
| 3 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.429 |
| 4 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.426 |
| 5 | 267 | Privilege Defined With Unsafe Actions | Base | Allowed | sparse | 0.425 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.425 |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.424 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.414 |
| 9 | 1022 | Use of Web Link to Untrusted Target with window.opener Access | Variant | Allowed | dense | 0.547 |
| 10 | 825 | Expired Pointer Dereference | Base | Allowed | graph | 0.002 |

