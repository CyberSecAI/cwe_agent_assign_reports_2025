# Vulnerability Information: CVE-2024-39360

## Vulnerability Description
An os **command injection** vulnerability exists in the nas.cgi remove_dir() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary code execution. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **component:** nas.cgi remove_dir() functionality
- **vector:** specially crafted HTTP request
- **weakness:** **command injection**
- **product:** Wavlink AC3000
- **impact:** arbitrary code execution, execute arbitrary code
- **version:** M33A8.V5030.210505

## CVE Reference Links Content Summary
## Analysis of CVE-2024-39360 based on provided content:

The provided content is directly related to CVE-2024-39360. It's a Talos Vulnerability Report detailing the vulnerability. Here's the extracted information:

**Root cause of vulnerability:**

Improper neutralization of special elements in a command, specifically a command injection vulnerability in the `nas.cgi` file's `remove_dir()` function. The vulnerability stems from using user-supplied data (the `dir_path` parameter) directly in a system command without proper sanitization.

**Weaknesses/vulnerabilities present:**

*   **CWE-77:** Improper Neutralization of Special Elements used in a Command (‘Command Injection’)
*   OS Command Injection

**Impact of exploitation:**

Arbitrary code execution on the affected device. An attacker can execute system commands with the privileges of the web server process.

**Attack vectors:**

*   An attacker can send a specially crafted HTTP POST request to the `nas.cgi` script.
*   The request must include the `page=rmdir` parameter.
*   The `dir_path` parameter within the POST data is where the malicious command is injected.
*   Requires authenticated access (session cookie check), but the report notes that accessing the .cgi files doesn't necessarily require logging in due to the lighttpd server configuration.

**Required attacker capabilities/position:**

*   Network access to the Wavlink AC3000 router.
*   Authenticated access (valid session cookie) - though the report suggests bypassing authentication may be possible.
*   Ability to craft a malicious HTTP POST request.

**Mitigation or fix:**

The report does not explicitly state a fix. It notes the vendor was working on patches, but the product has been discontinued.  Proper input validation and sanitization of the `dir_path` parameter in the `nas.cgi` script would be necessary to mitigate the vulnerability.

**Additional Details (more detail than official CVE description):**

*   **Affected Product:** Wavlink AC3000 M33A8.V5030.210505
*   **CVSSv3 Score:** 9.1 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)
*   **Technical details:** The report includes snippets of the vulnerable code, showing how the `system()` function is used with unsanitized user input. It also details the input length limitations (0x200 bytes).
*   **Timeline:** The report provides a detailed timeline of vendor communication and disclosure.
*   **Discovered by:** Lilith >\_> of Cisco Talos.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.274 |
| 4 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.273 |
| 5 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.260 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.255 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.249 |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.236 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.595 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

