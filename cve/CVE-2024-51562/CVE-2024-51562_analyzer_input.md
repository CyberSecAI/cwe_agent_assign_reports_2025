# Vulnerability Information: CVE-2024-51562

## Vulnerability Description
The NVMe driver function nvme_opc_get_log_page is vulnerable to a **buffer over-read** from a guest-controlled value.

### Vulnerability Description Key Phrases
- **weakness:** **buffer over-read**
- **component:** nvme_opc_get_log_page

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2024-51562:

**Root cause of vulnerability:**
- The vulnerability lies within the `nvme_opc_get_log_page` function of the NVMe driver in the bhyve hypervisor.

**Weaknesses/vulnerabilities present:**
- **Buffer Over-read:** The function is susceptible to a buffer over-read due to a guest-controlled value. This means a malicious guest can manipulate input values to cause the driver to read beyond the intended memory boundary.

**Impact of exploitation:**
- **Information Disclosure:** A malicious guest VM can potentially read sensitive memory within the bhyve process that it should not be able to access.
- **Denial of Service (DoS):** The advisory mentions that malicious guests can perform DoS attacks against the bhyve host, however it does not specifically tie this to the buffer over-read.

**Attack vectors:**
- **Guest VM Controlled Input:** The attack vector involves a malicious guest VM manipulating input values passed to the NVMe driver function `nvme_opc_get_log_page`.

**Required attacker capabilities/position:**
- The attacker needs to have control over a guest virtual machine running on the vulnerable bhyve hypervisor. They must also have the ability to interact with the NVMe device and send specific requests to the `nvme_opc_get_log_page` function, with the ability to manipulate the input to trigger the over-read.

**Summary**
The vulnerability is a buffer over-read in the NVMe driver of the bhyve hypervisor that is triggered by crafted guest input, allowing a malicious guest to read host memory.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.142 |
| 2 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.128 |
| 3 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | sparse | 0.127 |
| 4 | 908 | Use of Uninitialized Resource | Base | Allowed | sparse | 0.126 |
| 5 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.126 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.125 |
| 7 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.120 |
| 8 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.120 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.524 |
| 10 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | Allowed | graph | 0.003 |

