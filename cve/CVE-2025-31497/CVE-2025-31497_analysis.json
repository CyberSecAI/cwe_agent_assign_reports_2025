{
  "cve_id": "CVE-2025-31497",
  "description": "TEIGarage is a webservice and RESTful service to transform, convert and validate various formats, focussing on the TEI format. The Document Conversion Service contains a critical **XML External Entity (XXE) Injection** vulnerability in its document conversion functionality. The service processes XML files during the conversion process but **fails to disable external entity processing**, allowing an attacker to read arbitrary files from the servers filesystem. This vulnerability could allow attackers to read sensitive files from the servers filesystem, potentially exposing configuration files, credentials, or other confidential information. Additionally, depending on the server configuration, this could potentially be used to perform server-side request forgery (SSRF) attacks by making the server connect to internal services. This issue is patched in version 1.2.4. A workaround for this vulnerability includes disabling external entity processing in the XML parser by setting the appropriate security features (e.g., XMLConstants.FEATURE_SECURE_PROCESSING).",
  "key_phrases": {
    "component": "Document Conversion Service",
    "rootcause": "fails to disable external entity processing",
    "vector": "",
    "weakness": "XML External Entity (XXE) Injection",
    "product": "TEIGarage",
    "impact": "read arbitrary files from servers filesystem, read sensitive files, server-side request forgery",
    "attacker": "attackers",
    "version": "prior to 1.2.4"
  },
  "reference_content": "## Analysis of CVE-2025-31497 Content\n\nThis content **IS RELATED** to CVE-2025-31497. It provides a detailed security advisory regarding an XML External Entity (XXE) Injection vulnerability in the TEIGarage Document Conversion Service. The content provides more detail than the placeholder CVE description.\n\nHere's an extraction of the relevant information:\n\n**Root cause of vulnerability:**\n\nThe TEIGarage Document Conversion Service processes XML files without disabling external entity processing.\n\n**Weaknesses/vulnerabilities present:**\n\n*   XML External Entity (XXE) Injection\n\n**Impact of exploitation:**\n\n*   An attacker can read arbitrary files from the server's filesystem.\n*   Potential exposure of sensitive information (configuration files, credentials).\n*   Potential for Server-Side Request Forgery (SSRF) attacks.\n\n**Attack vectors:**\n\n*   An attacker can create a malicious XML file (exploit.xml) with an XXE payload referencing a target file.\n*   The malicious XML file is sent via a POST request to the conversion endpoint (`http://teigarage:8080/ege-webservice/Conversions/TEI:text:xml/txt:text:plain`) along with conversion properties.\n\n**Required attacker capabilities/position:**\n\n*   No authentication is required.\n*   Network access to the conversion endpoint.\n\n**Mitigation or fix:**\n\n*   Disable external entity processing in the XML parser (e.g., using `XMLConstants.FEATURE_SECURE_PROCESSING`).\n*   Implement XML parsing using safe defaults.\n*   Use XML parsing libraries that are not vulnerable to XXE by default, or configure them properly.\n*   Implement proper input validation and sanitization for all XML documents.\n\n**Affected versions:**\n\n*   `org.tei.tei-javalib` < 1.0.0\n*   `teigarage` Docker image < 1.2.3\n\n**Patched versions:**\n\n*   `org.tei.tei-javalib` 1.1.0\n*   `teigarage` Docker image 1.2.4\n\n**CVSS Score:** 7.5 (High)\n\n**CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N\n\n**Disclosure Policy:** 90-day disclosure deadline.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|-----------------|--------------------------------------------------------------------------------------------------------------------|--------------------|---------------------------|------------------------------------|-----------------------------------------------------------------------------------------------|\n| CWE-611 | Improper Restriction of XML External Entity Reference | 1 | Base | Allowed | Primary CWE |\n| CWE-918 | Server-Side Request Forgery (SSRF) | 0.7 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship influencing the CWE selection is the direct match of the vulnerability description to **CWE-611** (Improper Restriction of XML External Entity Reference), indicating that the service **fails to disable external entity processing** when parsing XML files. **CWE-918** (Server-Side Request Forgery (SSRF)) is considered a secondary candidate because the XXE vulnerability could potentially be leveraged to perform SSRF attacks, depending on the server configuration. Both are Base level CWEs.\n\n```mermaid\ngraph TD\n    cwe611[\"CWE-611: Improper Restriction of XML External Entity Reference\"]\n    cwe918[\"CWE-918: Server-Side Request Forgery (SSRF)\"]\n    \n    cwe611 -->|CAN_LEAD_TO| cwe918\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe611 primary\n    class cwe918 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with the **failure to disable external entity processing** in the XML parser (**CWE-611**). This allows an attacker to inject malicious XML containing external entity references. The processing of these external entities can then lead to the reading of arbitrary files from the server's filesystem and, potentially, to Server-Side Request Forgery (**CWE-918**).\n  - The chain consists of **CWE-611** (root cause) potentially leading to **CWE-918** (impact).\n\n## Summary of Analysis\nThe analysis is based on the provided vulnerability description and the CVE reference link content summary, both of which highlight the **failure to disable external entity processing** as the root cause of the XXE vulnerability. The vulnerability description states: \"The service processes XML files during the conversion process but **fails to disable external entity processing**, allowing an attacker to read arbitrary files from the servers filesystem.\" This aligns directly with the description of **CWE-611**. The possibility of SSRF is also mentioned, making **CWE-918** a secondary consideration.\n\nThe decision to prioritize **CWE-611** is based on the direct evidence of the **improper restriction of XML external entity references**, which is the core weakness. While SSRF is a potential consequence, it depends on specific server configurations and is not the primary, immediate result of the vulnerability. Therefore, **CWE-611** is the more accurate and specific classification.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-611: Improper Restriction of XML External Entity Reference\n**Abstraction Level**: Base\n**Similarity Score**: 0.79\n**Source**: dense\n\n**Description**:\nThe product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')\n**Abstraction Level**: Base\n**Similarity Score**: 1084.44\n**Source**: sparse\n\n**Description**:\nThe product uses XML documents and allows their structure to be defined with a Document Type Definition (DTD), but it does not properly control the number of recursive definitions of entities.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-918: Server-Side Request Forgery (SSRF)\n**Abstraction Level**: Base\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nThe web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n### Other CWEs Considered and Rejected:\n*   CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') - While related to XML vulnerabilities, this is more specific to recursive entity definitions, not the general issue of external entity processing.\n*   CWE-79, CWE-917, CWE-1286, CWE-212, CWE-80, CWE-74, CWE-923, CWE-138, CWE-941, CWE-184, CWE-322, CWE-306, CWE-94, CWE-434, CWE-78, CWE-116: These were considered less relevant as they address different types of weaknesses.",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|-----------------|--------------------------------------------------------------------------------------------------------------------|--------------------|---------------------------|------------------------------------|-----------------------------------------------------------------------------------------------|\n| CWE-611 | Improper Restriction of XML External Entity Reference | 1 | Base | Allowed | Primary CWE |\n| CWE-918 | Server-Side Request Forgery (SSRF) | 0.7 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship influencing the CWE selection is the direct match of the vulnerability description to **CWE-611** (Improper Restriction of XML External Entity Reference), indicating that the service **fails to disable external entity processing** when parsing XML files. **CWE-918** (Server-Side Request Forgery (SSRF)) is considered a secondary candidate because the XXE vulnerability could potentially be leveraged to perform SSRF attacks, depending on the server configuration. Both are Base level CWEs.\n\n```mermaid\ngraph TD\n    cwe611[\"CWE-611: Improper Restriction of XML External Entity Reference\"]\n    cwe918[\"CWE-918: Server-Side Request Forgery (SSRF)\"]\n    \n    cwe611 -->|CAN_LEAD_TO| cwe918\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe611 primary\n    class cwe918 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with the **failure to disable external entity processing** in the XML parser (**CWE-611**). This allows an attacker to inject malicious XML containing external entity references. The processing of these external entities can then lead to the reading of arbitrary files from the server's filesystem and, potentially, to Server-Side Request Forgery (**CWE-918**).\n  - The chain consists of **CWE-611** (root cause) potentially leading to **CWE-918** (impact).\n\n## Summary of Analysis\nThe analysis is based on the provided vulnerability description and the CVE reference link content summary, both of which highlight the **failure to disable external entity processing** as the root cause of the XXE vulnerability. The vulnerability description states: \"The service processes XML files during the conversion process but **fails to disable external entity processing**, allowing an attacker to read arbitrary files from the servers filesystem.\" This aligns directly with the description of **CWE-611**. The possibility of SSRF is also mentioned, making **CWE-918** a secondary consideration.\n\nThe decision to prioritize **CWE-611** is based on the direct evidence of the **improper restriction of XML external entity references**, which is the core weakness. While SSRF is a potential consequence, it depends on specific server configurations and is not the primary, immediate result of the vulnerability. Therefore, **CWE-611** is the more accurate and specific classification.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-611: Improper Restriction of XML External Entity Reference\n**Abstraction Level**: Base\n**Similarity Score**: 0.79\n**Source**: dense\n\n**Description**:\nThe product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')\n**Abstraction Level**: Base\n**Similarity Score**: 1084.44\n**Source**: sparse\n\n**Description**:\nThe product uses XML documents and allows their structure to be defined with a Document Type Definition (DTD), but it does not properly control the number of recursive definitions of entities.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-918: Server-Side Request Forgery (SSRF)\n**Abstraction Level**: Base\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nThe web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n### Other CWEs Considered and Rejected:\n*   CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') - While related to XML vulnerabilities, this is more specific to recursive entity definitions, not the general issue of external entity processing.\n*   CWE-79, CWE-917, CWE-1286, CWE-212, CWE-80, CWE-74, CWE-923, CWE-138, CWE-941, CWE-184, CWE-322, CWE-306, CWE-94, CWE-434, CWE-78, CWE-116: These were considered less relevant as they address different types of weaknesses.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-611:**\n- 611 (Improper Restriction of XML External Entity Reference) - ROOT\n\n\n**Chain starting from CWE-94:**\n- 94 (Improper Control of Generation of Code ('Code Injection')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "611",
        "name": "Improper Restriction of XML External Entity Reference",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: XXE",
        "match_reason": "term_in_phrase_whole_phrase"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "source": "sparse"
      },
      "similarity": 739.8003728319269
    },
    {
      "metadata": {
        "doc_id": "776",
        "name": "Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')",
        "source": "sparse"
      },
      "similarity": 725.7039744527284
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 697.7180406634182
    },
    {
      "metadata": {
        "doc_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "source": "sparse"
      },
      "similarity": 692.3120313544244
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 683.7976619930528
    },
    {
      "metadata": {
        "doc_id": "1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "source": "sparse"
      },
      "similarity": 683.1563039640519
    },
    {
      "metadata": {
        "doc_id": "941",
        "name": "Incorrectly Specified Destination in a Communication Channel",
        "source": "sparse"
      },
      "similarity": 677.6278444951414
    },
    {
      "metadata": {
        "doc_id": "8",
        "name": "J2EE Misconfiguration: Entity Bean Declared Remote",
        "type": "Variant",
        "original_content": "When an application exposes a remote interface for an entity bean, it might also expose methods that get or set the bean's data. These methods could be leveraged to read sensitive information, or to change data in ways that violate the application's expectations, potentially leading to other vulnerabilities.",
        "keyphrase_source": "rootcause:fails to disable external entity processing",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5102340789037978,
            "graph": 1.0440428198365759
          }
        }
      },
      "similarity": 0.5102340789037978
    },
    {
      "doc_id": "184",
      "text": "CWE-184: Incomplete List of Disallowed Inputs",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "184",
        "name": "Incomplete List of Disallowed Inputs",
        "type": "base",
        "original_content": "CWE-184: Incomplete List of Disallowed Inputs",
        "relationships": [
          {
            "source_id": "184",
            "target_id": "692",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "78",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "79",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "1023",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "693",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "86",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "78",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "693",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "STARTSWITH",
            "properties": {
              "view_id": "709"
            }
          },
          {
            "source_id": "625",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "186",
            "target_id": "184",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1023",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "79"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "79"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "184",
                  "79",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "79"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-611",
      "CWE-94",
      "CWE-80",
      "CWE-1286",
      "CWE-79",
      "CWE-74",
      "CWE-322",
      "CWE-184",
      "CWE-917",
      "CWE-306",
      "CWE-918",
      "CWE-434",
      "CWE-923",
      "CWE-776",
      "CWE-138",
      "CWE-78",
      "CWE-941",
      "CWE-212",
      "CWE-116"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}