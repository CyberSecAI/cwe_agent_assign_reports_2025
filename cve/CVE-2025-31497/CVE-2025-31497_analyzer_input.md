# Vulnerability Information: CVE-2025-31497

## Vulnerability Description
TEIGarage is a webservice and RESTful service to transform, convert and validate various formats, focussing on the TEI format. The Document Conversion Service contains a critical **XML External Entity (XXE) Injection** vulnerability in its document conversion functionality. The service processes XML files during the conversion process but **fails to disable external entity processing**, allowing an attacker to read arbitrary files from the servers filesystem. This vulnerability could allow attackers to read sensitive files from the servers filesystem, potentially exposing configuration files, credentials, or other confidential information. Additionally, depending on the server configuration, this could potentially be used to perform server-side request forgery (SSRF) attacks by making the server connect to internal services. This issue is patched in version 1.2.4. A workaround for this vulnerability includes disabling external entity processing in the XML parser by setting the appropriate security features (e.g., XMLConstants.FEATURE_SECURE_PROCESSING).

### Vulnerability Description Key Phrases
- **component:** Document Conversion Service
- **rootcause:** **fails to disable external entity processing**
- **weakness:** **XML External Entity (XXE) Injection**
- **product:** TEIGarage
- **impact:** read arbitrary files from servers filesystem, read sensitive files, server-side request forgery
- **attacker:** attackers
- **version:** prior to 1.2.4

## CVE Reference Links Content Summary
## Analysis of CVE-2025-31497 Content

This content **IS RELATED** to CVE-2025-31497. It provides a detailed security advisory regarding an XML External Entity (XXE) Injection vulnerability in the TEIGarage Document Conversion Service. The content provides more detail than the placeholder CVE description.

Here's an extraction of the relevant information:

**Root cause of vulnerability:**

The TEIGarage Document Conversion Service processes XML files without disabling external entity processing.

**Weaknesses/vulnerabilities present:**

*   XML External Entity (XXE) Injection

**Impact of exploitation:**

*   An attacker can read arbitrary files from the server's filesystem.
*   Potential exposure of sensitive information (configuration files, credentials).
*   Potential for Server-Side Request Forgery (SSRF) attacks.

**Attack vectors:**

*   An attacker can create a malicious XML file (exploit.xml) with an XXE payload referencing a target file.
*   The malicious XML file is sent via a POST request to the conversion endpoint (`http://teigarage:8080/ege-webservice/Conversions/TEI:text:xml/txt:text:plain`) along with conversion properties.

**Required attacker capabilities/position:**

*   No authentication is required.
*   Network access to the conversion endpoint.

**Mitigation or fix:**

*   Disable external entity processing in the XML parser (e.g., using `XMLConstants.FEATURE_SECURE_PROCESSING`).
*   Implement XML parsing using safe defaults.
*   Use XML parsing libraries that are not vulnerable to XXE by default, or configure them properly.
*   Implement proper input validation and sanitization for all XML documents.

**Affected versions:**

*   `org.tei.tei-javalib` < 1.0.0
*   `teigarage` Docker image < 1.2.3

**Patched versions:**

*   `org.tei.tei-javalib` 1.1.0
*   `teigarage` Docker image 1.2.4

**CVSS Score:** 7.5 (High)

**CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

**Disclosure Policy:** 90-day disclosure deadline.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | alternate_terms | 0.800 |
| 2 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.740 |
| 3 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | Allowed | sparse | 0.726 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.698 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.692 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.684 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.683 |
| 8 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.678 |
| 9 | 8 | J2EE Misconfiguration: Entity Bean Declared Remote | Variant | Allowed | dense | 0.510 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

