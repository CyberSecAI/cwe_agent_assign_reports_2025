## Vulnerability Description
A vulnerability was found in cjbi wetech-cms 1.0/1.1/1.2. It has been declared as critical. Affected by this vulnerability is the function findUser of the file wetech-cms-master\wetech-core\src\main\java\tech\wetech\cms\dao\UserDao.java. The manipulation of the argument searchValue/gId/rId leads to **sql injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** cjbi wetech-cms
- **version:** 1.0/1.1/1.2
- **component:** findUser function in findUser of the file wetech-cms-master\wetech-core\src\main\java\tech\wetech\cms\dao\UserDao.java

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the SQL injection vulnerability:

**Root Cause:**
The vulnerability stems from the insecure construction of SQL queries in the `UserDao.java` file. The application uses string concatenation to build the HQL query, directly embedding user-supplied parameters `searchValue`, `gId`, and `rId` without proper sanitization or parameterization.

**Weaknesses/Vulnerabilities:**
* **SQL Injection:** The primary vulnerability is SQL injection. The application is vulnerable to SQL injection due to the direct use of string concatenation with user-controlled input.
* **Lack of Input Validation/Sanitization:** The application fails to properly validate or sanitize the `searchValue`, `gId`, and `rId` parameters before incorporating them into the SQL query.

**Impact of Exploitation:**
* **Data Breach/Manipulation:** An attacker could exploit the vulnerability to bypass authentication, access sensitive data, modify the database, or potentially execute arbitrary commands on the database server.
* **Privilege Escalation:** Depending on the database user's privileges, an attacker may gain elevated privileges within the application.
* **Database Integrity Compromise:** The attacker can potentially modify, delete, or corrupt data within the database.

**Attack Vectors:**
* **HTTP GET Parameters:** The attacker manipulates the `searchValue`, `gId`, and `rId` parameters in the HTTP GET request to the `/admin/user/list.do` endpoint.
* **User Search Functionality:** The vulnerable code is located in the user management search feature of the admin console.

**Required Attacker Capabilities/Position:**
* **Access to Admin Console:** The attacker needs access to the administrative interface to exploit this vulnerability.
* **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable application.
* **Understanding of SQL:** The attacker needs to have knowledge of SQL to craft malicious payloads.
* **Ability to Intercept/Modify HTTP Requests:** While not explicitly required, the attacker may need to intercept and modify HTTP requests to construct the exploit effectively.

**Additional Details from the Content:**
* The content provides a specific vulnerable code snippet from `UserDao.java`.
* It highlights the use of `like` clauses with user-supplied input in the SQL query.
* It shows how the `searchValue` parameter is used to inject SQL by using a single quote and a crafted case statement.
* It mentions the same injection method applies to `gId` and `rId` parameters.
* It identifies the vulnerable user management search feature within the admin console.
* It shows the HTTP GET request which carries the vulnerable parameters.
* The specific injection payloads are provided for `searchValue` and for `gId`/`rId`

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.488 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.441 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.421 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.405 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.395 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.392 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.391 |
| 9 | 564 | SQL Injection: Hibernate | Variant | Allowed | dense | 0.595 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-502: Deserialization of Untrusted Data

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-306: Missing Authentication for Critical Function

CWE-564: SQL Injection: Hibernate

CWE-73: External Control of File Name or Path