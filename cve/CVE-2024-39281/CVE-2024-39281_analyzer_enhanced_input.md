## Vulnerability Description
The command ctl_persistent_reserve_out allows the caller to specify an arbitrary size which will be passed to the kernels memory allocator.

### Vulnerability Description Key Phrases
- **vector:** arbitrary size passed to kernel memory allocator
- **component:** ctl_persistent_reserve_out command

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The `ctl_persistent_reserve_out` command in the ctl(4) subsystem allows a caller to specify an arbitrary size that is then passed to the kernel's memory allocator without proper bounds checking.
- **Weaknesses/vulnerabilities present:** Unbounded memory allocation. The lack of size validation on the input to `ctl_persistent_reserve_out` before allocation allows an attacker to request an arbitrarily large allocation.
- **Impact of exploitation:** A malicious guest can cause a Denial of Service (DoS) on the host by exhausting memory resources.
- **Attack vectors:** This vulnerability can be triggered by a malicious guest using virtio_scsi(4) or ctld(8).
- **Required attacker capabilities/position:** The attacker must be able to send commands to the ctl subsystem, meaning they must have access to the guest OS and be able to use virtio_scsi or have access to ctld.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.045 |
| 2 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.045 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.044 |
| 4 | 824 | Access of Uninitialized Pointer | Base | Allowed | sparse | 0.044 |
| 5 | 681 | Incorrect Conversion between Numeric Types | Base | Allowed | sparse | 0.043 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.042 |
| 7 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.042 |
| 8 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.041 |
| 9 | 244 | Improper Clearing of Heap Memory Before Release ('Heap Inspection') | Variant | Allowed | dense | 0.398 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-789: Memory Allocation with Excessive Size Value

CWE-193: Off-by-one Error

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-824: Access of Uninitialized Pointer

CWE-681: Incorrect Conversion between Numeric Types

CWE-125: Out-of-bounds Read

CWE-190: Integer Overflow or Wraparound

CWE-835: Loop with Unreachable Exit Condition ('Infinite Loop')

CWE-244: Improper Clearing of Heap Memory Before Release ('Heap Inspection')

CWE-1325: Improperly Controlled Sequential Memory Allocation