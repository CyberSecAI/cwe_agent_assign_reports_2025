# Raw Retriever Results for CVE-2024-53845

# Raw Retriever Results for CVE-2024-53845
## Query
ESPTouch is a connection protocol for internet of things devices. In the ESPTouchV2 protocol, while there is an option to use a custom AES key, there is no option to set the IV (Initialization Vector) prior to versions 5.3.2, 5.2.4, 5.1.6, and 5.0.8. The IV is set to zero and remains constant throughout the products lifetime. In AES/CBC mode, if the IV is not properly initialized, the encrypted output becomes deterministic, leading to potential data leakage. To address the aforementioned issues, the application generates a random IV when activating the AES key starting in versions 5.3.2, 5.2.4, 5.1.6, and 5.0.8. This IV is then transmitted along with the provision data to the provision device. The provision device has also been equipped with a parser for the AES IV. The upgrade is applicable for all applications and users of ESPTouch v2 component from ESP-IDF. As it is implemented in the ESP Wi-Fi stack, there is no workaround for the user to fix the application layer without upgrading the underlying firmware.

## Keyphrases
- **rootcause**: 'The IV (Initialization Vector) is set to zero', 'remains constant throughout the products lifetime'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3826 | 0.5468 | 0.4171 | 0.4065 | 20 |
| Sparse | 952.3700 | 1384.9037 | 1061.6226 | 1026.8195 | 11 |
| Graph | 1.0274 | 2.2100 | 1.6053 | 1.5276 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 208 | Observable Timing Discrepancy | base | 2.2100 | Allowed |
| 2 | 259 | Use of Hard-coded Password | variant | 2.1720 | Allowed |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.1190 | Allowed |
| 4 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 5 | 472 | External Control of Assumed-Immutable Web Parameter | base | 1.7680 | Allowed |
| 6 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 7 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 8 | 1204 | Generation of Weak Initialization Vector (IV) | Base | 1.7179 | Allowed |
| 9 | 129 | Improper Validation of Array Index | variant | 1.5552 | Allowed |
| 10 | 329 | Generation of Predictable IV with CBC Mode | Variant | 1.5343 | Allowed |
| 11 | 1291 | Public Key Re-Use for Signing both Debug and Production Code | base | 1.5210 | Allowed |
| 12 | 301 | Reflection Attack in an Authentication Protocol | base | 1.5210 | Allowed |
| 13 | 780 | Use of RSA Algorithm without OAEP | Variant | 1.4934 | Allowed |
| 14 | 1394 | Use of Default Cryptographic Key | Base | 1.4609 | Allowed |
| 15 | 823 | Use of Out-of-range Pointer Offset | base | 1.3676 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 329 | Generation of Predictable IV with CBC Mode | Variant | 0.5468 | 0.5468 | Allowed |
| 2 | 1204 | Generation of Weak Initialization Vector (IV) | Base | 0.5406 | 0.5406 | Allowed |
| 3 | 780 | Use of RSA Algorithm without OAEP | Variant | 0.4460 | 0.4460 | Allowed |
| 4 | 1394 | Use of Default Cryptographic Key | Base | 0.4294 | 0.4294 | Allowed |
| 5 | 453 | Insecure Default Variable Initialization | Variant | 0.4269 | 0.4269 | Allowed |
| 6 | 649 | Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking | Base | 0.4256 | 0.4256 | Allowed |
| 7 | 834 | Excessive Iteration | Class | 0.4110 | 0.4110 | Discouraged |
| 8 | 1319 | Improper Protection against Electromagnetic Fault Injection (EM-FI) | Base | 0.4095 | 0.4095 | Allowed |
| 9 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | 0.4094 | 0.4094 | Allowed |
| 10 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.4087 | 0.4087 | Allowed-with-Review |
| 11 | 1271 | Uninitialized Value on Reset for Registers Holding Security Settings | Base | 0.4043 | 0.4043 | Allowed |
| 12 | 323 | Reusing a Nonce, Key Pair in Encryption | Base | 0.3952 | 0.3952 | Allowed |
| 13 | 326 | Inadequate Encryption Strength | Class | 0.3930 | 0.3930 | Allowed-with-Review |
| 14 | 1188 | Initialization of a Resource with an Insecure Default | Base | 0.3875 | 0.3875 | Allowed |
| 15 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 0.3870 | 0.3870 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1204 | Generation of Weak Initialization Vector (IV) | 1384.9037 | 1384.9037 | Allowed |
| 2 | 329 | Generation of Predictable IV with CBC Mode | 1174.6544 | 1174.6544 | Allowed |
| 3 | 321 | Use of Hard-coded Cryptographic Key | 1116.1655 | 1116.1655 | Allowed |
| 4 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 1073.5135 | 1073.5135 | Allowed-with-Review |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 1027.6734 | 1027.6734 | Allowed |
| 6 | 319 | Cleartext Transmission of Sensitive Information | 1026.8195 | 1026.8195 | Allowed |
| 7 | 1390 | Weak Authentication | 984.5145 | 984.5145 | Allowed-with-Review |
| 8 | 306 | Missing Authentication for Critical Function | 982.1559 | 982.1559 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | 980.3875 | 980.3875 | Allowed |
| 10 | 863 | Incorrect Authorization | 974.6906 | 974.6906 | Allowed-with-Review |
| 11 | 287 | Improper Authentication | 952.3700 | 952.3700 | Discouraged |
