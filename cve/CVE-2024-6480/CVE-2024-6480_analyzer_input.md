# Vulnerability Information: CVE-2024-6480

## Vulnerability Description
The SIP Reviews Shortcode for WooCommerce plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the no_of_reviews attribute in the woocommerce_reviews shortcode in all versions up to, and including, 1.2.3 due to **insufficient input sanitization and output escaping on user supplied attributes**. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping on user supplied attributes**
- **weakness:** **cross-site scripting**
- **impact:** inject arbitrary web scripts
- **attacker:** authenticated attackers
- **product:** SIP Reviews Shortcode for WooCommerce plugin for WordPress
- **version:** all versions up to and including 1.2.3
- **component:** woocommerce_reviews shortcode

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-6480

**Root Cause of Vulnerability:**
- Insufficient input sanitization and output escaping of user-supplied attributes within the `woocommerce_reviews` shortcode. Specifically, the `no_of_reviews` attribute is vulnerable.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize and escape the `no_of_reviews` attribute, allowing the injection of arbitrary web scripts.

**Impact of Exploitation:**
- **Arbitrary Script Execution:** An attacker can inject malicious JavaScript code into a page, which will then execute in the browsers of users who visit the compromised page. This can lead to a variety of malicious activities.
- **Privilege Escalation:** While not directly stated, successful XSS can lead to privilege escalation by hijacking admin sessions, potentially taking full control of the site.

**Attack Vectors:**
- **Shortcode Injection:** An attacker injects a crafted `woocommerce_reviews` shortcode containing malicious JavaScript within the vulnerable `no_of_reviews` attribute on a WordPress page or post.
- **User Interaction:** When a user visits the page containing the malicious shortcode, the injected JavaScript executes within their browser.

**Required Attacker Capabilities/Position:**
- **Authenticated Access:** The attacker must have at least contributor-level access to the WordPress site, enabling them to create or edit posts and pages.

**Additional Information:**
- The vulnerability exists in all versions of the "SIP Reviews Shortcode for WooCommerce" plugin up to and including 1.2.3.
- The vulnerable code is located in the `plugin-reviews-shortcode-display.php` file.
- The vulnerability was publicly disclosed on October 31, 2024.
- No patch is available currently. The recommendation is to uninstall the plugin.

**Specific Code Location (From Trac):**
The Wordfence article references line 424 in `plugin-reviews-shortcode-display.php` as relevant. This corresponds to the line where the shortcode's output is generated and could be the location where the unsanitized `no_of_reviews` attribute is being used.
```php
if ( $out_reviews != '' ) {
  $out_reviews = '<ul id="'.$no_of_reviews.'" class="commentbox commentlist commentlist-'. $id .' commentlist_'. $id .'">' . $out_reviews . '</ul><button '. $button .' class="sip-rswc-more" id="sip-rswc-more-'. $id .'" type="button">'.__( 'Load More', 'sip-reviews-shortcode' ).'</button>';
}
```
This confirms that the `no_of_reviews` attribute is directly used to set the ID of a `<ul>` HTML element, thus making it vulnerable to XSS if not properly sanitized.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.585 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.556 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.511 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.502 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.444 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.435 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.425 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.424 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.520 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

