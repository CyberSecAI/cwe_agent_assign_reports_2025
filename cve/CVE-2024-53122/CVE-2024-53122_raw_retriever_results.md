# Raw Retriever Results for CVE-2024-53122

# Raw Retriever Results for CVE-2024-53122
## Query
In the Linux kernel, the following vulnerability has been resolved mptcp cope racing subflow creation in mptcp_rcv_space_adjust Additional active subflows - i.e. created by the in kernel path manager - are included into the subflow list before starting the 3whs. A racing recvmsg() spooling data received on an already established subflow would unconditionally call tcp_cleanup_rbuf() on all the current subflows, potentially hitting a divide by zero error on the newly created ones. Explicitly check that the subflow is in a suitable state before invoking tcp_cleanup_rbuf().

## Keyphrases
- **rootcause**: 'race condition'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4323 | 0.5002 | 0.4584 | 0.4594 | 20 |
| Sparse | 114.8361 | 1000.0000 | 357.5886 | 360.3767 | 13 |
| Graph | 1.6848 | 2.8652 | 1.9867 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 363 | Race Condition Enabling Link Following | base | 2.8652 | Allowed |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 2.8210 | Allowed |
| 3 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 4 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 5 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 6 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 7 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.0370 | Allowed |
| 9 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 2.0020 | Allowed |
| 10 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 11 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 12 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 13 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 14 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 15 | 606 | Unchecked Input for Loop Condition | Base | 1.6980 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5002 | 0.5002 | Allowed-with-Review |
| 2 | 421 | Race Condition During Access to Alternate Channel | Base | 0.4826 | 0.4826 | Allowed |
| 3 | 606 | Unchecked Input for Loop Condition | Base | 0.4814 | 0.4814 | Allowed |
| 4 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4788 | 0.4788 | Allowed |
| 5 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4753 | 0.4753 | Allowed |
| 6 | 366 | Race Condition within a Thread | Base | 0.4687 | 0.4687 | Allowed |
| 7 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4679 | 0.4679 | Allowed |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4670 | 0.4670 | Allowed |
| 9 | 364 | Signal Handler Race Condition | Base | 0.4649 | 0.4649 | Allowed |
| 10 | 909 | Missing Initialization of Resource | Class | 0.4642 | 0.4642 | Allowed-with-Review |
| 11 | 121 | Stack-based Buffer Overflow | Variant | 0.4547 | 0.4547 | Allowed |
| 12 | 126 | Buffer Over-read | Variant | 0.4532 | 0.4532 | Allowed |
| 13 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4522 | 0.4522 | Allowed |
| 14 | 122 | Heap-based Buffer Overflow | Variant | 0.4477 | 0.4477 | Allowed |
| 15 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4395 | 0.4395 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 412.8577 | 412.8577 | Allowed |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | 375.2621 | 375.2621 | Allowed |
| 4 | 863 | Incorrect Authorization | 370.7306 | 370.7306 | Allowed-with-Review |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 362.4897 | 362.4897 | Allowed |
| 6 | 667 | Improper Locking | 361.9582 | 361.9582 | Allowed-with-Review |
| 7 | 20 | Improper Input Validation | 360.3767 | 360.3767 | Discouraged |
| 8 | 427 | Uncontrolled Search Path Element | 359.9457 | 359.9457 | Allowed |
| 9 | 277 | Insecure Inherited Permissions | 349.6906 | 349.6906 | Allowed |
| 10 | 476 | NULL Pointer Dereference | 349.5835 | 349.5835 | Allowed |
| 11 | 782 | Exposed IOCTL with Insufficient Access Control | 115.7097 | 115.7097 | Allowed |
| 12 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 115.2111 | 115.2111 | Allowed |
| 13 | 909 | Missing Initialization of Resource | 114.8361 | 114.8361 | Allowed-with-Review |
