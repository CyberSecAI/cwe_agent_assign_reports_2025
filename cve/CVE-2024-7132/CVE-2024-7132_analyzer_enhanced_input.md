## Vulnerability Description
The Page Builder Gutenberg Blocks WordPress plugin before 3.1.13 does not escape the content of post embed via one of its block, which could allow users with the capability to publish posts (editor and admin by default) to perform Stored Cross-Site Scripting attacks even when the unfiltered_html capability is disallowed (for example in multisite setup)

### Vulnerability Description Key Phrases
- **weakness:** **cross-site scripting**
- **impact:** Stored Cross-Site Scripting attacks
- **attacker:** users with the capability to publish posts
- **product:** Page Builder Gutenberg Blocks WordPress plugin
- **version:** before 3.1.13
- **component:** post embed block

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The plugin fails to properly escape content when embedding posts, specifically when using the "Post Carousel (CoBlocks)" or "Posts (CoBlocks)" blocks.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS). The plugin does not sanitize user-supplied content, allowing malicious scripts to be stored in the database and executed when the affected block is rendered.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the context of a user's browser, potentially leading to actions such as session hijacking, defacement, or redirection. This can be exploited even when the `unfiltered_html` capability is disabled, making it more severe in multisite setups.
- **Attack vectors:** An attacker with the capability to publish posts (Editor role or higher) creates a post with malicious code (e.g., `<img src=x onerror=alert(1)>`) and publishes it. When a user adds a "Post Carousel (CoBlocks)" or "Posts (CoBlocks)" block to a page or post, the stored XSS is triggered when the malicious content is rendered.
- **Required attacker capabilities/position:** The attacker needs to have at least Editor role permissions or higher on the WordPress site, meaning they have the ability to create and publish posts.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.448 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.377 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.367 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.353 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.329 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.327 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.322 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.319 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.466 |
| 10 | 183 | Permissive List of Allowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-862: Missing Authorization

CWE-863: Incorrect Authorization

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-183: Permissive List of Allowed Inputs