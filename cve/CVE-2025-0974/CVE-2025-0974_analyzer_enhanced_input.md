## Vulnerability Description
A vulnerability, which was classified as critical, has been found in MaxD Lightning Module 4.43 on OpenCart. This issue affects some unknown processing. The manipulation of the argument li_op/md leads to **deserialization**. The attack may be initiated remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **deserialization**
- **vector:** manipulation of the argument li_op/md
- **product:** MaxD Lightning Module
- **version:** 4.43
- **component:** OpenCart

## CVE Reference Links Content Summary
CVE-2025-0974

The content is directly related to CVE-2025-0974 as it explicitly references it. It provides significantly more detail than the placeholder CVE description.

**Root cause of vulnerability:**

Deserialization of Untrusted Data. The OpenCart Lightning module uses `unserialize()` on data received in a GET parameter (`$_GET['md']`) without proper validation, allowing for PHP Object Injection.

**Weaknesses/vulnerabilities present:**

* CWE-502: Deserialization of Untrusted Data
* CAPEC-586: Object Injection
* PHP Object Injection

**Impact of exploitation:**

Compromise of the site, potentially leading to arbitrary file writing or Remote Code Execution (RCE) through the exploitation of POP/Gadget Chains in OpenCart (versions 3 and 4).

**Attack vectors:**

* Network: An attacker can send a crafted GET request to the vulnerable endpoint with a malicious serialized object in the `md` parameter.

**Required attacker capabilities/position:**

* Low privilege: The attacker needs to be able to send HTTP GET requests to the vulnerable server.
* Knowledge of PHP serialization and object injection techniques.
* Knowledge of available POP/Gadget Chains within OpenCart.

**Mitigation or fix:**

* **Recommended:** Replace `unserialize()` with `json_encode()` and `json_decode()`.
* **Alternative:** Use the `allowed_classes` option with `unserialize()` to disable object injection: `$Mmo = unserialize(substr($Mcs, $Maf + 1), ['allowed_classes' => FALSE]);`

The content includes a Proof of Concept (PoC) demonstrating the vulnerability using a `DateTime` object.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.456 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.444 |
| 3 | 704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | sparse | 0.381 |
| 4 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.375 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.369 |
| 6 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.367 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.366 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.363 |
| 9 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | dense | 0.542 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-704: Incorrect Type Conversion or Cast

CWE-117: Improper Output Neutralization for Logs

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-266: Incorrect Privilege Assignment

CWE-502: Deserialization of Untrusted Data

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-73: External Control of File Name or Path