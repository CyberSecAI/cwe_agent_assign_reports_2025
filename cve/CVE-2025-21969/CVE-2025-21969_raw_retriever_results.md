# Raw Retriever Results for CVE-2025-21969

# Raw Retriever Results for CVE-2025-21969
## Query
In the Linux kernel, the following vulnerability has been resolved Bluetooth L2CAP Fix slab-use-after-free Read in l2cap_send_cmd After the hci sync command releases l2cap_conn, the hci receive data work queue references the released l2cap_conn when sending to the upper layer. Add hci dev lock to the hci receive data work queue to synchronize the two. [1] BUG KASAN slab-use-after-free in l2cap_send_cmd+0x187/0x8d0 net/bluetooth/l2cap_core.c954 Read of size 8 at addr ffff8880271a4000 by task kworker/u92/5837 CPU 0 UID 0 PID 5837 Comm kworker/u92 Not tainted 6.13.0-rc5-syzkaller-00163-gab75170520d4 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024 Workqueue hci1 hci_rx_work Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c120 print_address_description mm/kasan/report.c378 [inline] print_report+0x169/0x550 mm/kasan/report.c489 kasan_report+0x143/0x180 mm/kasan/report.c602 l2cap_build_cmd net/bluetooth/l2cap_core.c2964 [inline] l2cap_send_cmd+0x187/0x8d0 net/bluetooth/l2cap_core.c954 l2cap_sig_send_rej net/bluetooth/l2cap_core.c5502 [inline] l2cap_sig_channel net/bluetooth/l2cap_core.c5538 [inline] l2cap_recv_frame+0x221f/0x10db0 net/bluetooth/l2cap_core.c6817 hci_acldata_packet net/bluetooth/hci_core.c3797 [inline] hci_rx_work+0x508/0xdb0 net/bluetooth/hci_core.c4040 process_one_work kernel/workqueue.c3229 [inline] process_scheduled_works+0xa66/0x1840 kernel/workqueue.c3310 worker_thread+0x870/0xd30 kernel/workqueue.c3391 kthread+0x2f0/0x390 kernel/kthread.c389 ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S244 Allocated by task 5837 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x3f/0x80 mm/kasan/common.c68 poison_kmalloc_redzone mm/kasan/common.c377 [inline] __kasan_kmalloc+0x98/0xb0 mm/kasan/common.c394 kasan_kmalloc include/linux/kasan.h260 [inline] __kmalloc_cache_noprof+0x243/0x390 mm/slub.c4329 kmalloc_noprof include/linux/slab.h901 [inline] kzalloc_noprof include/linux/slab.h1037 [inline] l2cap_conn_add+0xa9/0x8e0 net/bluetooth/l2cap_core.c6860 l2cap_connect_cfm+0x115/0x1090 net/bluetooth/l2cap_core.c7239 hci_connect_cfm include/net/bluetooth/hci_core.h2057 [inline] hci_remote_features_evt+0x68e/0xac0 net/bluetooth/hci_event.c3726 hci_event_func net/bluetooth/hci_event.c7473 [inline] hci_event_packet+0xac2/0x1540 net/bluetooth/hci_event.c7525 hci_rx_work+0x3f3/0xdb0 net/bluetooth/hci_core.c4035 process_one_work kernel/workqueue.c3229 [inline] process_scheduled_works+0xa66/0x1840 kernel/workqueue.c3310 worker_thread+0x870/0xd30 kernel/workqueue.c3391 kthread+0x2f0/0x390 kernel/kthread.c389 ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S244 Freed by task 54 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x3f/0x80 mm/kasan/common.c68 kasan_save_free_info+0x40/0x50 mm/kasan/generic.c582 poison_slab_object mm/kasan/common.c247 [inline] __kasan_slab_free+0x59/0x70 mm/kasan/common.c264 kasan_slab_free include/linux/kasan.h233 [inline] slab_free_hook mm/slub.c2353 [inline] slab_free mm/slub.c4613 [inline] kfree+0x196/0x430 mm/slub.c4761 l2cap_connect_cfm+0xcc/0x1090 net/bluetooth/l2cap_core.c7235 hci_connect_cfm include/net/bluetooth/hci_core.h2057 [inline] hci_conn_failed+0x287/0x400 net/bluetooth/hci_conn.c1266 hci_abort_conn_sync+0x56c/0x11f0 net/bluetooth/hci_sync.c5603 hci_cmd_sync_work+0x22b/0x400 net/bluetooth/hci_sync.c332 process_one_work kernel/workqueue.c3229 [inline] process_scheduled_works+0xa66/0x1840 kernel/workqueue.c3310 worker_thread+0x870/0xd30 kernel/workqueue.c3391 kthread+0x2f0/0x390 kernel/kthread.c389 ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entr ---truncated---

## Keyphrases
- **rootcause**: 'slab-use-after-free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4874 | 0.5541 | 0.5087 | 0.5038 | 20 |
| Sparse | 265.9916 | 1067.0077 | 863.7913 | 904.6824 | 11 |
| Graph | 1.6016 | 2.9120 | 2.0798 | 2.0165 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 123 | Write-what-where Condition | base | 2.9120 | Allowed |
| 2 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.7014 | Allowed-with-Review |
| 4 | 197 | Numeric Truncation Error | base | 2.6104 | Allowed |
| 5 | 416 | Use After Free | Variant | 2.5711 | Allowed |
| 6 | 415 | Double Free | Variant | 2.2424 | Allowed |
| 7 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 8 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 9 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 10 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |
| 11 | 129 | Improper Validation of Array Index | variant | 1.8394 | Allowed |
| 12 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7749 | Allowed-with-Review |
| 13 | 126 | Buffer Over-read | Variant | 1.7129 | Allowed |
| 14 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 15 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5541 | 0.5541 | Allowed-with-Review |
| 2 | 416 | Use After Free | Variant | 0.5438 | 0.5438 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5243 | 0.5243 | Allowed-with-Review |
| 4 | 126 | Buffer Over-read | Variant | 0.5229 | 0.5229 | Allowed |
| 5 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5174 | 0.5174 | Allowed |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5174 | 0.5174 | Allowed |
| 7 | 908 | Use of Uninitialized Resource | Base | 0.5169 | 0.5169 | Allowed |
| 8 | 667 | Improper Locking | Class | 0.5148 | 0.5148 | Allowed-with-Review |
| 9 | 366 | Race Condition within a Thread | Base | 0.5130 | 0.5130 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5080 | 0.5080 | Allowed |
| 11 | 121 | Stack-based Buffer Overflow | Variant | 0.4995 | 0.4995 | Allowed |
| 12 | 833 | Deadlock | Base | 0.4994 | 0.4994 | Allowed |
| 13 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4986 | 0.4986 | Discouraged |
| 14 | 122 | Heap-based Buffer Overflow | Variant | 0.4975 | 0.4975 | Allowed |
| 15 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4953 | 0.4953 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 415 | Double Free | 1067.0077 | 1067.0077 | Allowed |
| 2 | 401 | Missing Release of Memory after Effective Lifetime | 1010.7964 | 1010.7964 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1004.1995 | 1004.1995 | Allowed-with-Review |
| 4 | 833 | Deadlock | 933.0371 | 933.0371 | Allowed |
| 5 | 197 | Numeric Truncation Error | 905.7164 | 905.7164 | Allowed |
| 6 | 911 | Improper Update of Reference Count | 904.6824 | 904.6824 | Allowed |
| 7 | 416 | Use After Free | 879.4411 | 879.4411 | Allowed |
| 8 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 865.9663 | 865.9663 | Discouraged |
| 9 | 909 | Missing Initialization of Resource | 861.7101 | 861.7101 | Allowed-with-Review |
| 10 | 682 | Incorrect Calculation | 803.1555 | 803.1555 | Discouraged |
| 11 | 733 | Compiler Optimization Removal or Modification of Security-critical Code | 265.9916 | 265.9916 | Allowed |
