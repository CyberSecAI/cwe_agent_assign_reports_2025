# Vulnerability Information: CVE-2025-0725

## Vulnerability Description
When libcurl is asked to perform automatic gzip decompression of content-encoded HTTP responses with the `CURLOPT_ACCEPT_ENCODING` option, **using zlib 1.2.0.3 or older**, an attacker-controlled integer overflow would make libcurl perform a buffer overflow.

### Vulnerability Description Key Phrases
- **weakness:** **integer overflow, buffer overflow**
- **product:** libcurl
- **attacker:** attacker-controlled

## CVE Reference Links Content Summary
## CVE-2025-0725 Analysis

**CVE Description:** PLACEHOLDER - Implement CVE description retrieval (This is a placeholder, the actual description is provided in the content)

**RELATION TO CVE:** RELATED

**Root cause of vulnerability:**

An integer overflow in libcurl when performing automatic gzip decompression of content-encoded HTTP responses with `CURLOPT_ACCEPT_ENCODING`, specifically when using zlib 1.2.0.3 or older. This overflow leads to a buffer overflow.

**Weaknesses/vulnerabilities present:**

*   Integer Overflow (CWE-680)
*   Buffer Overflow

**Impact of exploitation:**

Potentially huge impact, but mitigated by the fact that vulnerable systems are likely already in a poor security state due to using a very old zlib version.

**Attack vectors:**

An attacker can trigger the vulnerability by providing a specially crafted HTTP response with gzip encoding.

**Required attacker capabilities/position:**

The attacker needs to be able to control the HTTP response content.

**Mitigation or fix:**

*   Upgrade curl and libcurl to version 8.12.0 or later.
*   Apply the patch available at <https://github.com/curl/curl/commit/76f83f0db23846e254d940ec7>.
*   Use a modern zlib version (>= 1.2.0.4).
*   Avoid using the `CURLOPT_ACCEPT_ENCODING` option.

**Additional Details (more than official CVE description):**

*   The vulnerability is a "C mistake" and likely avoidable with a different programming language.
*   The vulnerable code path is rarely used, only triggered for older zlib versions due to compatibility reasons.
*   The issue affects both libcurl and the curl command-line tool.
*   zlib 1.2.0.4 was released in August 2003.
*   The version check in the patch initially had an issue using string comparison instead of numeric comparison.
*   The issue was reported on January 23, 2025, and a fix was released on February 5, 2025.
*   A bounty of $505 USD was awarded for the report.
*   The vulnerability only triggers when using zlib 1.2.0.3 or older.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.209 |
| 5 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.205 |
| 6 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.200 |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.194 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.192 |
| 9 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | dense | 0.575 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

