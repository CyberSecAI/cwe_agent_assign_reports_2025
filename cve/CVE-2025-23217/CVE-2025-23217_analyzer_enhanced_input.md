## Vulnerability Description
mitmproxy is a interactive TLS-capable intercepting HTTP proxy for penetration testers and software developers and mitmweb is a web-based interface for mitmproxy. In mitmweb 11.1.1 and below, a malicious client can use mitmwebs proxy server (bound to `*8080` by default) to access mitmwebs internal API (bound to `127.0.0.18081` by default). In other words, while the cannot access the API directly, they can access the API through the proxy. An attacker may be able to escalate this **SSRF**-style access to remote code execution. The mitmproxy and mitmdump tools are unaffected. Only mitmweb is affected. This vulnerability has been fixed in mitmproxy 11.1.2 and above. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **component:** proxy server
- **vector:** access mitmwebs internal API
- **weakness:** **SSRF**
- **product:** mitmweb
- **impact:** remote code execution, escalate this SSRF-style access
- **attacker:** malicious client
- **version:** 11.1.1 and below

## CVE Reference Links Content Summary
```text
CVE ID: CVE-2025-23217

**Root cause of vulnerability:**
In mitmweb 11.1.0 and below, a malicious client can use mitmweb's proxy server to access mitmweb's internal API.

**Weaknesses/vulnerabilities present:**
SSRF (Server-Side Request Forgery) - style access to remote code execution.

**Impact of exploitation:**
An attacker may be able to escalate SSRF-style access to remote code execution.

**Attack vectors:**
An attacker needs to be in the same local network and utilize the proxy server to access the internal API.

**Required attacker capabilities/position:**
The attacker needs to be in the same local network as the target.

**Mitigation or fix:**
The vulnerability has been fixed in mitmproxy 11.1.2 and above. The `block_global` option, enabled by default, blocks connections originating from publicly-routable IP addresses in the proxy.

**Additional details (more than official CVE description):**
- The mitmproxy and mitmdump tools are unaffected, only mitmweb is affected.
- The vulnerability was reported by Stefan Gr√∂nke (@gronke) as part of a security audit by Radically Open Security, supported by the NGI0 Entrust fund and NLnet.
- Timeline of events is provided: report received (Jan 14, 2025), verified (Jan 14, 2025), patch shared (Jan 19, 2025), confirmation of patch (Feb 4, 2025), advisory published (Feb 5, 2025).
- CVE ID: CVE-2025-23217
- CWE IDs: CWE-288, CWE-441
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | alternate_terms | 1.000 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.649 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.636 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.616 |
| 5 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.611 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.604 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.602 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.601 |
| 9 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | Class | Allowed-with-Review | dense | 0.529 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-918: Server-Side Request Forgery (SSRF)

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-863: Incorrect Authorization

CWE-287: Improper Authentication

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-306: Missing Authentication for Critical Function

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-502: Deserialization of Untrusted Data

CWE-441: Unintended Proxy or Intermediary ('Confused Deputy')

CWE-322: Key Exchange without Entity Authentication