# Vulnerability Information: CVE-2025-21704

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved usb cdc-acm Check control transfer buffer size before access If the first fragment is shorter than struct usb_cdc_notification, we cant calculate an expected_size. Log an error and discard the notification instead of reading lengths from memory outside the received data, which can lead to **memory corruption** when the expected_size decreases between fragments, causing `expected_size - acm->nb_index` to wrap. This issue has been present since the beginning of git history however, it only leads to **memory corruption** since commit ea2583529cd1 (cdc-acm reassemble fragmented notifications). A mitigating factor is that acm_ctrl_irq() can only execute after userspace has opened /dev/ttyACM* but if ModemManager is running, ModemManager will do that automatically depending on the USB devices vendor/product IDs and its other interfaces.

### Vulnerability Description Key Phrases
- **weakness:** **memory corruption**
- **impact:** memory corruption
- **vector:** reading lengths from memory outside the received data
- **product:** Linux kernel
- **component:** usb cdc-acm

## CVE Reference Links Content Summary
UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 787 | Out-of-bounds Write | Base | Allowed | alternate_terms | 1.000 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.556 |
| 3 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.544 |
| 4 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.540 |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.530 |
| 6 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.528 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.519 |
| 8 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | sparse | 0.516 |
| 9 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | dense | 0.531 |
| 10 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | graph | 0.003 |

