# Vulnerability Information: CVE-2024-13187

## Vulnerability Description
A vulnerability was found in Kingsoft WPS Office 6.14.0 on macOS. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the component TCC Handler. The manipulation leads to code injection. It is possible to launch the attack on the local host. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **impact:** code injection
- **vector:** manipulation
- **product:** Kingsoft WPS Office
- **version:** 6.14.0
- **component:** TCC Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2024-13187 Content

The provided content details a vulnerability in the WPS Office application for macOS. It relates to the lack of Hardened Runtime enabling, leading to a TCC bypass via DYLD_INSERT_LIBRARY injection.

**Root cause of vulnerability:**

The Mac version of WPS app does not enable the `Hardened Runtime` signing option, which is a security mechanism designed to prevent code injection attacks.

**Weaknesses/vulnerabilities present:**

*   Lack of Hardened Runtime protection.
*   Vulnerable to DYLD\_INSERT\_LIBRARY injection.
*   TCC bypass.

**Impact of exploitation:**

*   Privacy Leakage: Access to user's camera, microphone, and other hardware components. Reading contents of protected directories (e.g., Downloads).
*   Intrusion Threats: Malicious code injection into the WPS process with WPS's permissions.
*   Data Security: Leakage of business sensitive information and personal user data. Unauthorized access to hardware.

**Attack vectors:**

*   DYLD\_INSERT\_LIBRARY injection.
*   Exploitation requires the attacker to load a malicious dylib into the WPS process.

**Required attacker capabilities/position:**

*   The attacker needs to be able to inject a malicious dylib into the WPS process. This could be achieved through various means, such as controlling the victim's Mac device through a reverse shell or C2.
*   Knowledge of creating and compiling a malicious dylib.
*   Understanding of LaunchAgent configuration.

**Mitigation or fix:**

*   Enable the Hardened Runtime option. This will significantly reduce the risk of code injection and improve the application's overall security.

**Additional Details (more than official CVE description):**

*   The content provides detailed reproduction steps, including code examples for creating a malicious dylib and a LaunchAgent plist file.
*   It references similar vulnerabilities in other applications (Signal and Telegram) with assigned CVE numbers.
*   It explains the implications of WPS having multiple powerful TCC permissions, making it a prime target for attackers.
*   The content includes screenshots illustrating the vulnerability and exploitation process.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.169 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.166 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.141 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.141 |
| 5 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.140 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.140 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.137 |
| 8 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.136 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.543 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.003 |

