## Vulnerability Description
silverstripe/reports is an API for creating backend reports in the Silverstripe Framework. In affected versions reports can be accessed by their direct URL by any user who has access to view the reports admin section, even if the `canView()` method for that report returns `false`. This issue has been addressed in version 5.2.3. All users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **impact:** access reports via direct URL
- **attacker:** user with access to reports admin section
- **product:** silverstripe/reports
- **version:** before 5.2.3

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**
The `Report` class in Silverstripe CMS has a `canView` method intended to control access to reports. However, even when this method is configured to return `false`, reports could still be accessed directly via their URL if the user had the `CMS_ACCESS_ReportAdmin` permission.

**Weaknesses/Vulnerabilities:**
- **Insufficient Access Control:** The `canView` method's access restrictions were not enforced when accessing reports directly, bypassing intended access controls.
- **Permission Bypass:** Users with `CMS_ACCESS_ReportAdmin` were able to bypass `canView` restrictions.

**Impact of Exploitation:**
- Unauthorized Access: Users could view reports they were not supposed to access based on the `canView` method's configuration.
- Confidentiality Breach: Sensitive information contained in reports could be exposed to unauthorized users.

**Attack Vectors:**
- Direct URL Access: An attacker could directly access the report via its URL.

**Required Attacker Capabilities/Position:**
- `CMS_ACCESS_ReportAdmin` Permission: The attacker needs to have the permission to access the reports admin section.
- Knowledge of Report URL: The attacker needs to know the URL of the report they want to access.

**Additional Details:**

- The vulnerability affects `silverstripe/reports` versions prior to 5.2.3
- The fix ensures that the `canView` check is properly respected when accessing reports directly.
- The vulnerability has a CVSS score of 4.3 (Medium severity)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.138 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.135 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.134 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.131 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.125 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.124 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.124 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.124 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.415 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-863: Incorrect Authorization

CWE-138: Improper Neutralization of Special Elements

CWE-306: Missing Authentication for Critical Function

CWE-285: Improper Authorization

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')