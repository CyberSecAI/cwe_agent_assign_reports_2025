# Vulnerability Information: CVE-2024-11710

## Vulnerability Description
The WP Job Portal A Complete Recruitment System for Company or Job Board website plugin for WordPress is vulnerable to SQL Injection via the fieldfor, visibleParent and id parameters in all versions up to, and including, 2.2.2 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Administrator-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** authenticated attackers
- **product:** WP Job Portal A Complete Recruitment System for Company or Job Board
- **version:** up to and including 2.2.2
- **component:** fieldfor and visibleParent and id parameters

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-11710

**Vulnerable Software:** WP Job Portal WordPress plugin

**Affected Versions:** <= 2.2.2

**Root Cause of Vulnerability:**
The plugin is vulnerable to SQL Injection due to insufficient escaping of user-supplied parameters ('fieldfor', 'visibleParent', and 'id') and lack of proper preparation in the SQL queries.

**Weaknesses/Vulnerabilities Present:**
*   **SQL Injection:**  The plugin directly incorporates user-provided input into SQL queries without proper sanitization or parameterization, allowing an attacker to inject malicious SQL code.

**Impact of Exploitation:**
*   **Information Disclosure:** Successful exploitation allows attackers to execute arbitrary SQL queries. This could lead to the extraction of sensitive information from the database.

**Attack Vectors:**
*   The vulnerability is triggered through the 'fieldfor', 'visibleParent' and 'id' parameters.

**Required Attacker Capabilities/Position:**
*   **Authentication:** The attacker needs to be authenticated with at least Administrator-level access.
*   **Access:**  The attacker must have the ability to send requests that utilize the vulnerable parameters.

**Additional Notes:**
*   The vulnerability was patched in version 2.2.3 of the plugin.
*   The provided code diff highlights the changes made to address the vulnerability, including checks for numeric inputs and escaping. Specifically, the changes include:
    *   `if(!is_numeric($section)){ return false; }` is added to check for numeric input of the `$section` variable in the `getResumeCustomSectionFields` function.
    *   `if (!is_numeric($data['fieldfor'])) { return false; }` is added to check if the `fieldfor` input is numeric.
    *   `if(is_numeric($data['visibleParent'])){...}` is added to ensure `$data['visibleParent']` input is numeric before being used in an SQL query.
    *   `if(is_numeric($visibleParent)){...}` is added to ensure `$visibleParent` input is numeric before being used in an SQL query.
    *   `if(!is_numeric($field)){ return false; }` is added to check if the `$field` input is numeric.
    *   `if( is_numeric($result->section) && $result->section > 8){...}` is added to validate the `$result->section` input is numeric before executing a query.
    *   `if (is_numeric($id) == false) return false;` and `if (is_numeric($fieldfor) == false) return false;` are added to check for numeric inputs for `$id` and `$fieldfor` respectively.
    *   `if(isset($visibleparams['visibleParent']) && is_numeric($visibleparams['visibleParent'])){...}` is added to validate that the  `$visibleparams['visibleParent']` is numeric.
    *   `if(!is_numeric($fieldfor)){ return false; }` is added before several queries to validate the numeric input of the `$fieldfor` variable.
    *   `if(isset($cid) && $cid !='' && is_numeric($cid)){...}` is added to validate that the `$cid` input is numeric.
    *   `if(isset($section) && $section !='' && is_numeric($section)){...}` is added to validate that the `$section` input is numeric.
    *  The `~~` operator used for type coercion has been removed and `esc_sql` has been added in many places for sanitization.

This information is more detailed than the original CVE description, providing specifics about the vulnerable parameters and the fixes implemented.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.627 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.574 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.546 |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.543 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.542 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.541 |
| 8 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.535 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.516 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

