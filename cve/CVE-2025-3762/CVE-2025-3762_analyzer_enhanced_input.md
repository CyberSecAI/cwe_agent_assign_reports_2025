## Vulnerability Description
A vulnerability was found in PCMan FTP Server 2.0.7. It has been rated as critical. Affected by this issue is some unknown functionality of the component MPUT Command Handler. The manipulation leads to **buffer overflow**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** MPUT Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3762 Content

This content **RELATES** to a vulnerability in PCMan FTP Server, specifically a buffer overflow in the `MPUT` command. It provides a detailed exploit script.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the `MPUT` command handling of PCMan FTP Server version 2.0.7. The server does not properly validate the size of the input provided with the `MPUT` command, allowing an attacker to send a payload larger than the allocated buffer.

**Weaknesses/vulnerabilities present:**

*   Buffer Overflow
*   Improper Input Validation

**Impact of exploitation:**

Successful exploitation allows the attacker to overwrite the execution flow of the program, potentially leading to arbitrary code execution. The exploit script aims to redirect execution to a shellcode payload.

**Attack vectors:**

*   Remote attacker can send a crafted `MPUT` command to the FTP server.

**Required attacker capabilities/position:**

*   Network access to the FTP server.
*   Ability to send arbitrary data to the FTP server on port 21.

**Mitigation or fix:**

The content does not provide information about a specific fix. However, the root cause suggests that proper input validation and buffer size checks in the `MPUT` command handling are necessary to mitigate the vulnerability.

**Additional Details (more than official CVE description):**

*   **Version Affected:** 2.0.7
*   **Tested on:** Windows XP SP3 (Build 2600)
*   **Exploit Details:** The script uses `msfvenom` to generate shellcode for Windows, specifically a reverse TCP shell.
*   **Offset:** The exploit uses an offset of 2006 bytes to reach the EIP register.
*   **EIP overwrite:** The exploit overwrites EIP with `0x74e32fd9` (JMP ESP).
*   **Bad Characters:** The exploit avoids using null bytes (`\x00`), line feeds (`\x0a`), and carriage returns (`\x0d`).
*   **Exploit Script:** The provided Perl script demonstrates a complete exploit, including connecting to the FTP server, authenticating as an anonymous user, and sending the malicious `MPUT` command.
*   **LHOST/LPORT:** The exploit is configured to connect back to `192.168.176.136` on port `4444`.
*   **NOP sled:** The exploit uses a 20-byte NOP sled (`\x90`x20) before the shellcode.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.383 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.362 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.323 |
| 7 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.321 |
| 8 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.315 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.584 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-125: Out-of-bounds Read

CWE-252: Unchecked Return Value

CWE-117: Improper Output Neutralization for Logs

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-128: Wrap-around Error