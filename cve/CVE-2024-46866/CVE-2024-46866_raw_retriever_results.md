# Raw Retriever Results for CVE-2024-46866

# Raw Retriever Results for CVE-2024-46866
## Query
In the Linux kernel, the following vulnerability has been resolved drm/xe/client add missing bo locking in show_meminfo() bo_meminfo() wants to inspect bo state like tt and the ttm resource, however this state can change at any point leading to stuff like NPD and UAF, if the bo lock is not held. Grab the bo lock when calling bo_meminfo(), ensuring we drop any spinlocks first. In the case of object_idr we now also need to hold a ref. v2 (MattB) - Also add xe_bo_assert_held() (cherry picked from commit 4f63d712fa104c3ebefcb289d1e733e86d8698c7)

## Keyphrases
- **rootcause**: 'missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4768 | 0.5408 | 0.5024 | 0.4996 | 20 |
| Sparse | 113.1497 | 485.0026 | 350.6442 | 403.7419 | 13 |
| Graph | 1.5154 | 2.8143 | 1.7926 | 1.6980 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | Base | 2.8143 | Allowed |
| 2 | 764 | Multiple Locks of a Critical Resource | base | 2.4700 | Allowed |
| 3 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | base | 1.7680 | Allowed |
| 5 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7628 | Allowed-with-Review |
| 8 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 9 | 413 | Improper Resource Locking | Base | 1.7208 | Allowed |
| 10 | 833 | Deadlock | Base | 1.7113 | Allowed |
| 11 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 12 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 13 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 14 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |
| 15 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 1.6255 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 667 | Improper Locking | Class | 0.5408 | 0.5408 | Allowed-with-Review |
| 2 | 413 | Improper Resource Locking | Base | 0.5327 | 0.5327 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5318 | 0.5318 | Allowed-with-Review |
| 4 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.5221 | 0.5221 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5217 | 0.5217 | Allowed-with-Review |
| 6 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5152 | 0.5152 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5071 | 0.5071 | Allowed |
| 8 | 591 | Sensitive Data Storage in Improperly Locked Memory | Variant | 0.5060 | 0.5060 | Allowed |
| 9 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.5046 | 0.5046 | Allowed |
| 10 | 908 | Use of Uninitialized Resource | Base | 0.5040 | 0.5040 | Allowed |
| 11 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4952 | 0.4952 | Allowed |
| 12 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4948 | 0.4948 | Allowed |
| 13 | 190 | Integer Overflow or Wraparound | Base | 0.4929 | 0.4929 | Allowed |
| 14 | 126 | Buffer Over-read | Variant | 0.4920 | 0.4920 | Allowed |
| 15 | 833 | Deadlock | Base | 0.4886 | 0.4886 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 485.0026 | 485.0026 | Allowed-with-Review |
| 2 | 833 | Deadlock | 459.0193 | 459.0193 | Allowed |
| 3 | 764 | Multiple Locks of a Critical Resource | 440.7114 | 440.7114 | Allowed |
| 4 | 476 | NULL Pointer Dereference | 419.9797 | 419.9797 | Allowed |
| 5 | 909 | Missing Initialization of Resource | 416.9507 | 416.9507 | Allowed-with-Review |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | 404.8137 | 404.8137 | Allowed |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 403.7419 | 403.7419 | Allowed-with-Review |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 398.7739 | 398.7739 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | 396.7435 | 396.7435 | Allowed |
| 10 | 306 | Missing Authentication for Critical Function | 391.9247 | 391.9247 | Allowed |
| 11 | 617 | Reachable Assertion | 114.2256 | 114.2256 | Allowed |
| 12 | 610 | Externally Controlled Reference to a Resource in Another Sphere | 113.3379 | 113.3379 | Discouraged |
| 13 | 663 | Use of a Non-reentrant Function in a Concurrent Context | 113.1497 | 113.1497 | Allowed |
