# Vulnerability Information: CVE-2024-45413

## Vulnerability Description
The HTTPD binary in multiple ZTE routers has a **stack-based buffer overflow** vulnerability in rsa_decrypt function. This function is an API wrapper for LUA to decrypt RSA encrypted ciphertext, the decrypted data is stored on the stack without checking its length. An authenticated attacker can get RCE as root by exploiting this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **impact:** RCE and remote code execution
- **attacker:** authenticated attacker
- **product:** ZTE routers
- **component:** rsa_decrypt function in HTTPD binary

## CVE Reference Links Content Summary
The provided content describes a stack-based buffer overflow vulnerability in the `rsa_decrypt` function of the HTTPD binary in multiple ZTE routers. This vulnerability is assigned CVE-2024-45413.

**Root cause of vulnerability:** The `rsa_decrypt` function decrypts RSA encrypted ciphertext and stores the result on the stack without checking its length, leading to a stack-based buffer overflow if the decrypted data exceeds the allocated buffer size.

**Weaknesses/vulnerabilities present:** Stack-based buffer overflow (CWE-121) in the `rsa_decrypt` function.

**Impact of exploitation:** Remote code execution (RCE) as root.

**Attack vectors:** An authenticated attacker can exploit this vulnerability by sending crafted RSA encrypted data to the vulnerable function.

**Required attacker capabilities/position:** The attacker needs to be authenticated to access the vulnerable API function.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.356 |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.329 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.323 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.310 |
| 7 | 131 | Incorrect Calculation of Buffer Size | Base | Allowed | sparse | 0.302 |
| 8 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.300 |
| 9 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | dense | 0.541 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

