# Vulnerability Information: CVE-2024-6162

## Vulnerability Description
A vulnerability was found in Undertow, where **URL-encoded request paths can be mishandled during concurrent requests on the AJP listener**. This issue arises because the same buffer is used to decode the paths for multiple requests simultaneously, leading to incorrect path information being processed. As a result, the server may attempt to access the wrong path, causing errors such as 404 Not Found or other application failures. This flaw can potentially lead to a denial of service, as legitimate resources become inaccessible due to the path mix-up.

### Vulnerability Description Key Phrases
- **rootcause:** **URL-encoded request paths can be mishandled during concurrent requests on the AJP listener**
- **impact:** denial of service
- **product:** Undertow

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-6162:

**Root Cause of Vulnerability:**

- The vulnerability lies in how Undertow handles URL-encoded request paths, specifically when using the AJP listener.
- The same buffer is used to decode paths for multiple concurrent requests.

**Weaknesses/Vulnerabilities Present:**

- **Incorrect Path Handling:** Due to the shared buffer, the path information for concurrent requests can become mixed up. This results in the server attempting to access the wrong resources.

**Impact of Exploitation:**

- **Denial of Service (DoS):**  The primary impact is a potential denial of service. This occurs because legitimate resources become inaccessible due to the path mix-up, leading to errors like "404 Not Found" or other application failures.

**Attack Vectors:**

- **Concurrent Requests:** The vulnerability is triggered when multiple requests are made to the server concurrently.
- **URL-Encoded Paths:** The issue arises specifically when the request path contains URL-encoded characters.
- **AJP Listener:** The vulnerability is specific to the AJP (Apache JServ Protocol) listener within Undertow.

**Required Attacker Capabilities/Position:**

- The attacker needs to be able to send multiple, concurrent requests to a server using the AJP listener and with URL-encoded paths.  No special privileges are required.

**Summary of Affected Products:**

Based on the provided advisories, the following products are confirmed to be affected:

-   NetApp:
    *   Active IQ Unified Manager for Linux
    *   Active IQ Unified Manager for Microsoft Windows
    *   Active IQ Unified Manager for VMware vSphere

-   Red Hat:
    *   Red Hat JBoss Enterprise Application Platform 8.0.1 (fixed in RHSA-2024:1194)
	*   Red Hat JBoss EAP 7.4.17 XP 4.0.2 (fixed in RHSA-2024:4386)
    *   Red Hat build of Apache Camel 4.4.1 for Spring Boot (fixed in RHSA-2024:4884)

**Additional details:**

- The vulnerability has a CVSS score of 7.5 (HIGH) with the vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H, indicating it is network-accessible, requires no special privileges or user interaction, and has a high impact on availability.
- Patches and updates are available for the affected Red Hat products.
- NetApp is still investigating and releasing fixes for the affected products.

This information is derived from multiple sources and should give a comprehensive understanding of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.559 |
| 2 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.538 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.520 |
| 4 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.519 |
| 5 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.506 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.504 |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.504 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.497 |
| 9 | 177 | Improper Handling of URL Encoding (Hex Encoding) | Variant | Allowed | dense | 0.565 |
| 10 | 476 | NULL Pointer Dereference | Base | Allowed | graph | 0.002 |

