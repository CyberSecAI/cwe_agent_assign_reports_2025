# Raw Retriever Results for CVE-2025-37921

# Raw Retriever Results for CVE-2025-37921
## Query
In the Linux kernel, the following vulnerability has been resolved vxlan vnifilter Fix unlocked deletion of default FDB entry When a VNI is deleted from a VXLAN device in vnifilter mode, the FDB entry associated with the default remote (assuming one was configured) is deleted without holding the hash lock. This is wrong and will result in a warning [1] being generated by the lockdep annotation that was added by commit ebe642067455 (vxlan Create wrappers for FDB lookup). Reproducer # ip link add vx0 up type vxlan dstport 4789 external vnifilter local 192.0.2.1 # bridge vni add vni 10010 remote 198.51.100.1 dev vx0 # bridge vni del vni 10010 dev vx0 Fix by acquiring the hash lock before the deletion and releasing it afterwards. Blame the original commit that introduced the issue rather than the one that exposed it. [1] WARNING CPU 3 PID 392 at drivers/net/vxlan/vxlan_core.c417 vxlan_find_mac+0x17f/0x1a0 [...] RIP 0010vxlan_find_mac+0x17f/0x1a0 [...] Call Trace __vxlan_fdb_delete+0xbe/0x560 vxlan_vni_delete_group+0x2ba/0x940 vxlan_vni_del.isra.0+0x15f/0x580 vxlan_process_vni_filter+0x38b/0x7b0 vxlan_vnifilter_process+0x3bb/0x510 rtnetlink_rcv_msg+0x2f7/0xb70 netlink_rcv_skb+0x131/0x360 netlink_unicast+0x426/0x710 netlink_sendmsg+0x75a/0xc20 __sock_sendmsg+0xc1/0x150 ____sys_sendmsg+0x5aa/0x7b0 ___sys_sendmsg+0xfc/0x180 __sys_sendmsg+0x121/0x1b0 do_syscall_64+0xbb/0x1d0 entry_SYSCALL_64_after_hwframe+0x4b/0x53

## Keyphrases
- **rootcause**: 'unlocked deletion'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4651 | 0.5216 | 0.4828 | 0.4829 | 20 |
| Sparse | 183.5998 | 588.5832 | 529.2551 | 558.5441 | 11 |
| Graph | 1.3010 | 2.3400 | 1.6734 | 1.6328 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 2 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 3 | 319 | Cleartext Transmission of Sensitive Information | base | 2.1190 | Allowed |
| 4 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 5 | 129 | Improper Validation of Array Index | variant | 1.8394 | Allowed |
| 6 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 8 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 9 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 11 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 1.5912 | Allowed |
| 12 | 476 | NULL Pointer Dereference | Base | 1.5444 | Allowed |
| 13 | 908 | Use of Uninitialized Resource | Base | 1.5296 | Allowed |
| 14 | 456 | Missing Initialization of a Variable | variant | 1.5154 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.4938 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5216 | 0.5216 | Allowed |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5026 | 0.5026 | Allowed |
| 3 | 121 | Stack-based Buffer Overflow | Variant | 0.4960 | 0.4960 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4956 | 0.4956 | Allowed-with-Review |
| 5 | 909 | Missing Initialization of Resource | Class | 0.4891 | 0.4891 | Allowed-with-Review |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4869 | 0.4869 | Allowed |
| 7 | 476 | NULL Pointer Dereference | Base | 0.4865 | 0.4865 | Allowed |
| 8 | 400 | Uncontrolled Resource Consumption | Class | 0.4848 | 0.4848 | Discouraged |
| 9 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4833 | 0.4833 | Allowed |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.4829 | 0.4829 | Allowed |
| 11 | 833 | Deadlock | Base | 0.4828 | 0.4828 | Allowed |
| 12 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4781 | 0.4781 | Discouraged |
| 13 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4773 | 0.4773 | Allowed |
| 14 | 667 | Improper Locking | Class | 0.4765 | 0.4765 | Allowed-with-Review |
| 15 | 755 | Improper Handling of Exceptional Conditions | Class | 0.4722 | 0.4722 | Discouraged |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 588.5832 | 588.5832 | Allowed-with-Review |
| 2 | 667 | Improper Locking | 585.1320 | 585.1320 | Allowed-with-Review |
| 3 | 674 | Uncontrolled Recursion | 564.8011 | 564.8011 | Allowed-with-Review |
| 4 | 319 | Cleartext Transmission of Sensitive Information | 562.2764 | 562.2764 | Allowed |
| 5 | 1390 | Weak Authentication | 558.9570 | 558.9570 | Allowed-with-Review |
| 6 | 754 | Improper Check for Unusual or Exceptional Conditions | 558.5441 | 558.5441 | Allowed-with-Review |
| 7 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 557.1141 | 557.1141 | Allowed-with-Review |
| 8 | 61 | UNIX Symbolic Link (Symlink) Following | 555.4444 | 555.4444 | Allowed |
| 9 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 554.1683 | 554.1683 | Allowed-with-Review |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 553.1854 | 553.1854 | Allowed |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | 183.5998 | 183.5998 | Allowed |
