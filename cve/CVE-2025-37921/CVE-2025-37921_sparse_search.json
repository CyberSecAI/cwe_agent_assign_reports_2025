{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved vxlan vnifilter Fix unlocked deletion of default FDB entry When a VNI is deleted from a VXLAN device in vnifilter mode, the FDB entry associated with the default remote (assuming one was configured) is deleted without holding the hash lock. This is wrong and will result in a warning [1] being generated by the lockdep annotation that was added by commit ebe642067455 (vxlan Create wrappers for FDB lookup). Reproducer # ip link add vx0 up type vxlan dstport 4789 external vnifilter local 192.0.2.1 # bridge vni add vni 10010 remote 198.51.100.1 dev vx0 # bridge vni del vni 10010 dev vx0 Fix by acquiring the hash lock before the deletion and releasing it afterwards. Blame the original commit that introduced the issue rather than the one that exposed it. [1] WARNING CPU 3 PID 392 at drivers/net/vxlan/vxlan_core.c417 vxlan_find_mac+0x17f/0x1a0 [...] RIP 0010vxlan_find_mac+0x17f/0x1a0 [...] Call Trace __vxlan_fdb_delete+0xbe/0x560 vxlan_vni_delete_group+0x2ba/0x940 vxlan_vni_del.isra.0+0x15f/0x580 vxlan_process_vni_filter+0x38b/0x7b0 vxlan_vnifilter_process+0x3bb/0x510 rtnetlink_rcv_msg+0x2f7/0xb70 netlink_rcv_skb+0x131/0x360 netlink_unicast+0x426/0x710 netlink_sendmsg+0x75a/0xc20 __sock_sendmsg+0xc1/0x150 ____sys_sendmsg+0x5aa/0x7b0 ___sys_sendmsg+0xfc/0x180 __sys_sendmsg+0x121/0x1b0 do_syscall_64+0xbb/0x1d0 entry_SYSCALL_64_after_hwframe+0x4b/0x53",
  "keyphrases": {
    "rootcause": [
      "unlocked deletion"
    ]
  },
  "timestamp": "2025-07-14 21:54:31",
  "cve_id": "CVE-2025-37921",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 588.5832291473959,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 585.1319911712354,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "674",
      "name": "Uncontrolled Recursion",
      "score": 564.8011175830504,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "319",
      "name": "Cleartext Transmission of Sensitive Information",
      "score": 562.2763812630053,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "1390",
      "name": "Weak Authentication",
      "score": 558.9570283111614,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "754",
      "name": "Improper Check for Unusual or Exceptional Conditions",
      "score": 558.544051405022,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "923",
      "name": "Improper Restriction of Communication Channel to Intended Endpoints",
      "score": 557.1140510267319,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "61",
      "name": "UNIX Symbolic Link (Symlink) Following",
      "score": 555.4444344522842,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "327",
      "name": "Use of a Broken or Risky Cryptographic Algorithm",
      "score": 554.1682673157206,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 553.1853889055872,
      "search_source": "rootcause:unlocked deletion"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "score": 183.59975714090936,
      "search_source": "base_query"
    }
  ]
}