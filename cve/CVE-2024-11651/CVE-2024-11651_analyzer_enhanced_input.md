## Vulnerability Description
A vulnerability was found in EnGenius ENH1350EXT, ENS500-AC and ENS620EXT up to 20241118. It has been classified as critical. Affected is an unknown function of the file /admin/network/wifi_schedule. The manipulation of the argument wifi_schedule_day_em_5 leads to **command injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** EnGenius ENH1350EXT and ENS500-AC and ENS620EXT
- **version:** up to 20241118
- **component:** /admin/network/wifi_schedule

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a lack of proper input sanitization in the `/admin/network/wifi_schedule` interface of ENGENIUS routers. User-supplied data within parameters like `wifi_schedule_day_em_5` are directly passed to an `exec` function without any filtering.

**Weaknesses/Vulnerabilities:**

*   **Command Injection:** The primary vulnerability is command injection. Because user input is directly used as a system command, an attacker can inject arbitrary commands that the router will execute with the privileges of the web server (which typically runs as root).
*   **Lack of Input Validation:** The system fails to validate and sanitize the input provided through parameters related to the wifi schedule interface, allowing malicious code to be injected.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** Successful exploitation of this vulnerability allows an attacker to execute arbitrary system commands on the affected router. This can lead to a variety of malicious outcomes.
*   **Full System Compromise:** Because the commands are executed with high privileges (potentially root), the attacker can gain complete control of the device.
*  **Data Breach**: Attacker can steal sensitive information stored on the router or intercept network traffic
*   **Malware Installation:** An attacker can install malware, botnets or other malicious software on the router.
*   **Denial of Service (DoS):** An attacker could disable services or brick the device.

**Attack Vectors:**

*   **HTTP POST Request:** The attack is carried out through a crafted HTTP POST request to the `/cgi-bin/luci/;stok=<token>/admin/network/wifi_schedule` endpoint.
*   **Modified `wifi_schedule_day_em_5` parameter:** The malicious command is injected into the request payload within parameters such as the `wifi_schedule_day_em_5` parameter.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to have network access to the router's web interface. This could be from the local network or, if the management interface is exposed, from the internet.
*   **Authentication:** The attacker needs to be authenticated to the router's web admin interface (have valid `sysauth` cookie).

**Additional Notes:**

*   The provided proof-of-concept demonstrates using `curl` to contact a remote server, which confirms the ability to execute arbitrary commands.
*   The vulnerability affects "all versions, including the latest firmware version," implying a widespread vulnerability.
*   The vendor was contacted but did not respond.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.521 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.489 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.421 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.411 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.406 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.401 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.627 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-306: Missing Authentication for Critical Function

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs