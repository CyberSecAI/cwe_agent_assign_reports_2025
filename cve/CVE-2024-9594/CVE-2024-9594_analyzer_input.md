# Vulnerability Information: CVE-2024-9594

## Vulnerability Description
A security issue was discovered in the Kubernetes Image Builder versions <= v0.1.37 where default credentials are enabled during the image build process when using the Nutanix, OVA, QEMU or raw providers. The credentials can be used to gain root access. The credentials are disabled at the conclusion of the image build process. Kubernetes clusters are only affected if their nodes use VM images created via the Image Builder project. Because these images were vulnerable during the image build process, they are affected only if an attacker was able to reach the VM where the image build was happening and used the vulnerability to modify the image at the time the image build was occurring.

### Vulnerability Description Key Phrases
- **rootcause:** **default credentials enabled**
- **impact:** gain root access
- **attacker:** attacker
- **product:** Kubernetes Image Builder
- **version:** <= v0.1.37

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2024-9594:

**Root Cause of Vulnerability:**

*   The Kubernetes Image Builder, when used with Nutanix, OVA, QEMU, or raw providers, enabled default credentials during the image build process. These default credentials could be used to gain root access to the VM where the image build was occurring.

**Weaknesses/Vulnerabilities Present:**

*   **Default Credentials:** The primary weakness was the use of a predictable default password for the `builder` user during image creation.
*   **Insecure Configuration:** The affected providers didn't have built-in support for randomly generated SSH keys/passwords which led to reliance on a default password.

**Impact of Exploitation:**

*   **Root Access:** Successful exploitation allowed an attacker to gain root access to the VM during the image build process.
*   **Image Modification:** An attacker with root access could modify the image being built, potentially injecting malicious code or backdoors.
*   **Compromised Kubernetes Nodes**: If the compromised images were later used to create Kubernetes nodes, these nodes would also be compromised, leading to potential cluster compromise.

**Attack Vectors:**

*   **Network Access to Build VM:** The primary attack vector required the attacker to have network access to the VM where the image build process was taking place.
*   **Timing Dependence:** The attacker needed to exploit the vulnerability during the short window when the default credentials were active (i.e., during the image building process).

**Required Attacker Capabilities/Position:**

*   **Network Access:**  The attacker must have network access to the build environment.
*   **Privilege Escalation:** While not directly required by this CVE it was the impact, after exploiting the default password, the attacker gains root privileges.
*   **Timing:** The attacker needs to exploit the default credentials while the image is actively being built.

**Additional Notes:**

*   The vulnerability was present in Kubernetes Image Builder versions v0.1.37 and earlier.
*   The vulnerability was mitigated by generating a random SSH password for the `builder` account during the image build process. This was implemented in  Image Builder version v0.1.38 and also backported to the `master` branch.
*   A temporary mitigation was suggested: disabling the `builder` account on affected VMs.
*   The CVE has a CVSS v3.1 score of 6.3 (Medium), with a vector of `CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H`.

**In summary, CVE-2024-9594 is a medium-severity vulnerability that allowed attackers to gain root access to VMs during the image build process due to the use of default credentials in certain Kubernetes Image Builder providers. This vulnerability is mitigated by using a randomly generated password for the builder account.**

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.707 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.695 |
| 3 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.646 |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.637 |
| 5 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.625 |
| 6 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.625 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.618 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.617 |
| 9 | 1392 | Use of Default Credentials | Base | Allowed | dense | 0.516 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

