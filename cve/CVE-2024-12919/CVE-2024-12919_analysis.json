{
  "cve_id": "CVE-2024-12919",
  "description": "The Paid Membership Subscriptions Effortless Memberships, Recurring Payments & Content Restriction plugin for WordPress is vulnerable to **Authentication Bypass** in all versions up to, and including, 2.13.7. This is due to the pms_pb_payment_redirect_link function using the user-controlled value supplied via the pms_payment_id parameter to authenticate users without any further identity validation. This makes it possible for unauthenticated attackers with knowledge of a valid payment ID to log in as any user who has made a purchase on the targeted site.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "Authentication Bypass",
    "impact": "log in as any user",
    "vector": "valid payment ID",
    "attacker": "unauthenticated attackers",
    "product": "Paid Membership Subscriptions Effortless Memberships Recurring Payments & Content Restriction plugin for WordPress",
    "version": "all versions up to and including 2.13.7",
    "component": "pms_pb_payment_redirect_link function"
  },
  "reference_content": "Here's an analysis of the provided content:\n\nThe content describes changes made to the \"paid-member-subscriptions\" WordPress plugin. The changelog for version 2.13.8 includes a fix for \"A security issue.\"\n\n*   **Weaknesses/vulnerabilities present:** A security issue.\n*   **Mitigation or fix:** Fix for a security issue.\n*   **More Detail:** The content provides more detail than the official CVE description, mentioning a security fix and acknowledging a reporter.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-306 | Missing Authentication for Critical Function | 0.9 | Base | Primary | Allowed |\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship is that CWE-306 [Missing Authentication for Critical Function] and CWE-639 [Authorization Bypass Through User-Controlled Key] can both be present in the same vulnerability. CWE-306 represents the initial failure to authenticate, while CWE-639 describes the subsequent bypass of authorization controls. The abstraction levels (both Base) are appropriate for representing specific weaknesses.\n\n```mermaid\ngraph TD\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    \n    cwe639 -->|CANFOLLOW| cwe306\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe306 primary\n    class cwe639 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing authentication** (CWE-306) for the `pms_pb_payment_redirect_link` function. Because of the **missing authentication**, an attacker can then use a valid `pms_payment_id` to **bypass authorization** (CWE-639) and gain access to another user's account. This allows the attacker to log in as any user who has made a purchase on the targeted site.\n\n## Summary of Analysis\nThe initial assessment identified CWE-306 [Missing Authentication for Critical Function] as the primary weakness due to the lack of identity validation in the `pms_pb_payment_redirect_link` function. The vulnerability description explicitly states that the function uses a user-controlled value to authenticate users \"without any further identity validation.\" This aligns perfectly with the definition of CWE-306, which describes a scenario where a product does not perform any authentication for functionality that requires a provable user identity.\n\nThe retriever results also suggested CWE-639 [Authorization Bypass Through User-Controlled Key], which was considered as a secondary weakness because the attacker is using a known payment ID to gain unauthorized access.\n\nThe graph relationships influenced the selection by highlighting the potential for these two weaknesses to occur in sequence. The vulnerability description supports this chain of events, as the **missing authentication** allows the attacker to then **bypass authorization** using a valid payment ID.\n\nThe selected CWEs are at the optimal level of specificity, as they accurately represent the specific weaknesses present in the vulnerability. CWE-306 describes the **missing authentication**, while CWE-639 describes the **authorization bypass** that results from the missing authentication.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-306: Missing Authentication for Critical Function\n**Abstraction Level**: Base\n**Similarity Score**: 1336.06\n**Source**: sparse\n\n**Description**:\nThe product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Relationships**:\n- PARENTOF -> CWE-322\n- PARENTOF -> CWE-288\n- CHILDOF -> CWE-287\n- CHILDOF -> CWE-287\n- CHILDOF -> CWE-306\n\n## CWE-639: Authorization Bypass Through User-Controlled Key\n**Abstraction Level**: Base\n**Similarity Score**: 1402.43\n**Source**: sparse\n\n**Description**:\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Relationships**:\n- CANPRECEDE -> CWE-471\n\nCWE-863: Incorrect Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 1399.47\n**Source**: sparse\n\n**Description**:\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n### Considered but not used:\n\n*   CWE-863 [Incorrect Authorization], CWE-862 [Missing Authorization], CWE-285 [Improper Authorization] and CWE-287 [Improper Authentication] were considered, but ultimately deemed less appropriate because the core issue is the complete lack of authentication, not an incorrect or missing authorization check after authentication.\n*   CWE-352 [Cross-Site Request Forgery (CSRF)] was considered, but the vulnerability is not related to CSRF.\n*   CWE-471 [Modification of Assumed-Immutable Data (MAID)] was considered but the root cause is not related to modifying data.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-306 | Missing Authentication for Critical Function | 0.9 | Base | Primary | Allowed |\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship is that CWE-306 [Missing Authentication for Critical Function] and CWE-639 [Authorization Bypass Through User-Controlled Key] can both be present in the same vulnerability. CWE-306 represents the initial failure to authenticate, while CWE-639 describes the subsequent bypass of authorization controls. The abstraction levels (both Base) are appropriate for representing specific weaknesses.\n\n```mermaid\ngraph TD\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    \n    cwe639 -->|CANFOLLOW| cwe306\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe306 primary\n    class cwe639 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing authentication** (CWE-306) for the `pms_pb_payment_redirect_link` function. Because of the **missing authentication**, an attacker can then use a valid `pms_payment_id` to **bypass authorization** (CWE-639) and gain access to another user's account. This allows the attacker to log in as any user who has made a purchase on the targeted site.\n\n## Summary of Analysis\nThe initial assessment identified CWE-306 [Missing Authentication for Critical Function] as the primary weakness due to the lack of identity validation in the `pms_pb_payment_redirect_link` function. The vulnerability description explicitly states that the function uses a user-controlled value to authenticate users \"without any further identity validation.\" This aligns perfectly with the definition of CWE-306, which describes a scenario where a product does not perform any authentication for functionality that requires a provable user identity.\n\nThe retriever results also suggested CWE-639 [Authorization Bypass Through User-Controlled Key], which was considered as a secondary weakness because the attacker is using a known payment ID to gain unauthorized access.\n\nThe graph relationships influenced the selection by highlighting the potential for these two weaknesses to occur in sequence. The vulnerability description supports this chain of events, as the **missing authentication** allows the attacker to then **bypass authorization** using a valid payment ID.\n\nThe selected CWEs are at the optimal level of specificity, as they accurately represent the specific weaknesses present in the vulnerability. CWE-306 describes the **missing authentication**, while CWE-639 describes the **authorization bypass** that results from the missing authentication.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-306: Missing Authentication for Critical Function\n**Abstraction Level**: Base\n**Similarity Score**: 1336.06\n**Source**: sparse\n\n**Description**:\nThe product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Relationships**:\n- PARENTOF -> CWE-322\n- PARENTOF -> CWE-288\n- CHILDOF -> CWE-287\n- CHILDOF -> CWE-287\n- CHILDOF -> CWE-306\n\n## CWE-639: Authorization Bypass Through User-Controlled Key\n**Abstraction Level**: Base\n**Similarity Score**: 1402.43\n**Source**: sparse\n\n**Description**:\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Relationships**:\n- CANPRECEDE -> CWE-471\n\nCWE-863: Incorrect Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 1399.47\n**Source**: sparse\n\n**Description**:\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n### Considered but not used:\n\n*   CWE-863 [Incorrect Authorization], CWE-862 [Missing Authorization], CWE-285 [Improper Authorization] and CWE-287 [Improper Authentication] were considered, but ultimately deemed less appropriate because the core issue is the complete lack of authentication, not an incorrect or missing authorization check after authentication.\n*   CWE-352 [Cross-Site Request Forgery (CSRF)] was considered, but the vulnerability is not related to CSRF.\n*   CWE-471 [Modification of Assumed-Immutable Data (MAID)] was considered but the root cause is not related to modifying data.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-288:**\n- 288 (Authentication Bypass Using an Alternate Path or Channel) - ROOT\n\n\n**Chain starting from CWE-471:**\n- 471 (Modification of Assumed-Immutable Data (MAID)) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 444.8643278680606
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 433.54429873078254
    },
    {
      "metadata": {
        "doc_id": "862",
        "name": "Missing Authorization",
        "source": "sparse"
      },
      "similarity": 422.92641857631884
    },
    {
      "metadata": {
        "doc_id": "116",
        "name": "Improper Encoding or Escaping of Output",
        "source": "sparse"
      },
      "similarity": 421.08112932488626
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 418.27241306134715
    },
    {
      "metadata": {
        "doc_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "source": "sparse"
      },
      "similarity": 416.29020005540804
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 415.5450681575659
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 414.7428697192111
    },
    {
      "metadata": {
        "doc_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "type": "Compound",
        "original_content": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
        "keyphrase_source": "weakness:Authentication Bypass",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This is a well-known Composite of multiple weaknesses that must all occur simultaneously, although it is attack-oriented in nature.",
          "comments": "While attack-oriented composites are supported in CWE, they have not been a focus of research. There is a chance that future research or CWE scope clarifications will change or deprecate them. Perform root-cause analysis to determine if other weaknesses allow CSRF attacks to occur, and map to those weaknesses. For example, predictable CSRF tokens might allow bypass of CSRF protection mechanisms; if this occurs, they might be better characterized as randomness/predictability weaknesses.",
          "reasons": [
            "Other"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "retriever_count": 3,
          "normalized_scores": {
            "dense": 0.5379083448638615,
            "sparse": 145.0029267101459,
            "graph": 1.4928943249739515
          }
        }
      },
      "similarity": 0.5379083448638615
    },
    {
      "doc_id": "471",
      "text": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
      "score": 2.7196000000000002,
      "metadata": {
        "doc_id": "471",
        "name": "Modification of Assumed-Immutable Data (MAID)",
        "type": "base",
        "original_content": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
        "relationships": [
          {
            "source_id": "471",
            "target_id": "621",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "607",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "602",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "473",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "425",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "291",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1321",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1282",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "471",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "621",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "607",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "602",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "473",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "425",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "291",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1321",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1282",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.5599999999999999,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_up",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "425"
            },
            "abstraction_path_up": {
              "path": [
                [
                  "472",
                  "471",
                  "CHILDOF"
                ]
              ],
              "score": 0.5599999999999999,
              "type": "abstraction_path_up",
              "source": "472"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "425"
            }
          }
        },
        "abstraction_level": "base",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.7196000000000002
          }
        }
      },
      "similarity": 2.7196000000000002
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-288",
      "CWE-471",
      "CWE-863",
      "CWE-862",
      "CWE-639",
      "CWE-306",
      "CWE-352",
      "CWE-285",
      "CWE-322",
      "CWE-287"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}