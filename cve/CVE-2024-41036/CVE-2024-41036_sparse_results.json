{
  "query": "In the Linux kernel, the following vulnerability has been resolvednet ks8851 Fix deadlock with the SPI chip variantWhen SMP is enabled and spinlocks are actually functional then there isa deadlock with the statelock spinlock between ks8851_start_xmit_spiand ks8851_irq watchdog BUG soft lockup - CPU#0 stuck for 27s! call trace queued_spin_lock_slowpath+0x100/0x284 do_raw_spin_lock+0x34/0x44 ks8851_start_xmit_spi+0x30/0xb8 ks8851_start_xmit+0x14/0x20 netdev_start_xmit+0x40/0x6c dev_hard_start_xmit+0x6c/0xbc sch_direct_xmit+0xa4/0x22c __qdisc_run+0x138/0x3fc qdisc_run+0x24/0x3c net_tx_action+0xf8/0x130 handle_softirqs+0x1ac/0x1f0 __do_softirq+0x14/0x20 ____do_softirq+0x10/0x1c call_on_irq_stack+0x3c/0x58 do_softirq_own_stack+0x1c/0x28 __irq_exit_rcu+0x54/0x9c irq_exit_rcu+0x10/0x1c el1_interrupt+0x38/0x50 el1h_64_irq_handler+0x18/0x24 el1h_64_irq+0x64/0x68 __netif_schedule+0x6c/0x80 netif_tx_wake_queue+0x38/0x48 ks8851_irq+0xb8/0x2c8 irq_thread_fn+0x2c/0x74 irq_thread+0x10c/0x1b0 kthread+0xc8/0xd8 ret_from_fork+0x10/0x20This issue has not been identified earlier because tests were done ona device with SMP disabled and so spinlocks were actually NOPs.Now use spin_(un)lock_bh for TX queue related locking to avoid executionof softirq work synchronously that would lead to a deadlock.",
  "count": 13,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 546.3258504234328,
      "original_score": 546.3258504234328,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "abstraction": "Base",
      "score": 493.47149549929566,
      "original_score": 493.47149549929566,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "score": 406.3659529509812,
      "original_score": 406.3659529509812,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "abstraction": "Class",
      "score": 395.442155746544,
      "original_score": 395.442155746544,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "755",
      "name": "Improper Handling of Exceptional Conditions",
      "abstraction": "Class",
      "score": 395.0196602409326,
      "original_score": 395.0196602409326,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 392.3006580334561,
      "original_score": 392.3006580334561,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "923",
      "name": "Improper Restriction of Communication Channel to Intended Endpoints",
      "abstraction": "Class",
      "score": 389.82109093606095,
      "original_score": 389.82109093606095,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 383.69516529123155,
      "original_score": 383.69516529123155,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "abstraction": "Base",
      "score": 381.9925145348077,
      "original_score": 381.9925145348077,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "606",
      "name": "Unchecked Input for Loop Condition",
      "abstraction": "Base",
      "score": 381.54709427275793,
      "original_score": 381.54709427275793,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "abstraction": "Base",
      "score": 346.9115174779135,
      "original_score": 346.9115174779135,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "116",
      "name": "Improper Encoding or Escaping of Output",
      "abstraction": "Class",
      "score": 337.7834996492856,
      "original_score": 337.7834996492856,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1269",
      "name": "Product Released in Non-Release Configuration",
      "abstraction": "Base",
      "score": 335.8223383522914,
      "original_score": 335.8223383522914,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 335.8223383522914,
    "max": 546.3258504234328,
    "mean": 398.9614610314609,
    "median": 389.82109093606095,
    "count": 13
  }
}