# Vulnerability Information: CVE-2024-10856

## Vulnerability Description
The Booking Calendar WpDevArt plugin is vulnerable to time-based, blind **SQL injection** via the `id` parameter in the wpdevart_booking_calendar shortcode in versions up to, and including, 3.2.19 due to insufficient escaping on the user-supplied parameter and lack of sufficient preparation on the existing SQL query. The vulnerability requires the delete_prev_date theme option being enabled. This makes it possible for authenticated attackers, with contributor-level access or above, to append additional SQL queries into already existing query that can be used to extract sensitive information such as passwords from the database.

### Vulnerability Description Key Phrases
- **component:** wpdevart_booking_calendar shortcode in versions
- **rootcause:** **insufficient escaping on the user-supplied parameter, lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **product:** Booking Calendar WpDevArt plugin
- **impact:** append additional SQL queries
- **attacker:** authenticated attackers with contributor-level access or above
- **version:** up to and including 3.2.19

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Vulnerability:** SQL Injection

**CVE ID:** CVE-2024-10856

**Root Cause:**
The vulnerability stems from insufficient sanitization of the `id` parameter within the `wpdevart_booking_calendar` shortcode. This lack of proper input validation and sanitization allows an attacker to inject arbitrary SQL queries via this parameter. The vulnerability is triggered when the “delete_prev_date” theme option is enabled within the Booking Calendar WpDevArt plugin.

**Weaknesses:**
*   **Insufficient Input Sanitization:** The plugin fails to adequately sanitize user-supplied input (specifically, the `id` parameter) before incorporating it into an SQL query.
*   **Lack of Prepared Statements:** The existing SQL query does not use prepared statements, which are crucial for preventing SQL injection vulnerabilities.

**Impact of Exploitation:**
*   **Sensitive Information Disclosure:** Successful exploitation can allow an attacker to extract sensitive data from the WordPress database. This could include user passwords, personal information, or other confidential data, depending on the specific SQL queries executed by the attacker.
*  **Potential Data Modification:** While the provided source focuses on information disclosure, the potential to modify the data is inherent in the SQL injection vulnerability.

**Attack Vector:**
*   **Shortcode Parameter Injection:** The vulnerable `id` parameter is accessible through the `wpdevart_booking_calendar` shortcode.
*  **Direct SQL query injection:** It is possible to inject malicious SQL commands by manipulating the id parameter to append SQL queries to the original query

**Required Attacker Capabilities/Position:**
*   **Authenticated Contributor Access:** The attacker needs to have at least contributor-level access to the WordPress site. This means they must be able to log in to the WordPress dashboard.
*   **Theme Option Requirement:** The “delete\_prev\_date” theme option must be enabled for the SQL injection vulnerability to be triggered.

**Additional Notes:**

*   The vulnerability is a *time-based blind SQL injection,* meaning attackers may need to employ techniques that infer information based on timing delays, as the results are not directly visible.
*   The vulnerability affects all versions of the plugin up to and including 3.2.19, and is fixed in 3.2.20.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.606 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.560 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.553 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.552 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.541 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.538 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.537 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.514 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

