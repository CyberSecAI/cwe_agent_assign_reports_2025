# Vulnerability Information: CVE-2025-2728

## Vulnerability Description
A vulnerability has been found in H3C Magic NX30 Pro and Magic NX400 up to V100R014 and classified as critical. This vulnerability affects unknown code of the file /api/wizard/getNetworkConf. The manipulation leads to **command injection**. The attack needs to be approached within the local network. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **component:** /api/wizard/getNetworkConf
- **weakness:** **command injection**
- **product:** H3C Magic NX30 Pro, Magic NX400
- **version:** up to V100R014

## CVE Reference Links Content Summary
Here's an analysis of the provided content based on the instructions:

**1. Verification of Content's Relation to CVE-2025-2728:**

The content from `zhiliao.h3c.com_f7ed4179_20250624_191047.html` *does* relate to a CVE, specifically CVE-2025-2728. The document explicitly mentions this CVE.

**2. Content Extraction:**

*   **Root cause of vulnerability:** The document states the root cause is a "未授权命令注入风险" or unauthorized command injection risk.
*   **Weaknesses/vulnerabilities present:** The primary vulnerability is command injection.
*   **Impact of exploitation:** The impact could lead to a user's network becoming unavailable.
*   **Attack vectors:** The attack vector involves sending special requests under a specific network setup. The attacker must be on the LAN (Local Area Network).
*   **Required attacker capabilities/position:** An attacker needs to be on the local network to exploit this vulnerability. This could be achieved through physical access or by knowing the wireless password.
*   **Mitigation or fix:**
    *   Enable anti-ARP spoofing features to protect against ARP poisoning
    *   Use a strong Wi-Fi password to prevent brute-force attacks.
    *   Enable Wi-Fi access control and add suspicious devices to the blacklist.
    *   Use a guest network.
    *   The document provides a table with fixed versions for specific product models.

**3. Additional Detail than CVE description**

The content provides more detail than the general CVE description, as it specifically lists affected product models, affected versions, the impact, and mitigation steps.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.362 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.337 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.306 |
| 6 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.299 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.290 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.287 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.608 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

