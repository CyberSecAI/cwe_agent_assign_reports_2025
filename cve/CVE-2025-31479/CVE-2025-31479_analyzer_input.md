# Vulnerability Information: CVE-2025-31479

## Vulnerability Description
canonical/get-workflow-version-action is a GitHub composite action to get commit SHA that GitHub Actions reusable workflow was called with. Prior to 1.0.1, if the get-workflow-version-action step fails, the exception output may include the GITHUB_TOKEN. If the full token is included in the exception output, GitHub will automatically redact the secret from the GitHub Actions logs. However, the token may be truncatedcausing part of the GITHUB_TOKEN to be displayed in plaintext in the GitHub Actions logs. Anyone with read access to the GitHub repository can view GitHub Actions logs. For public repositories, anyone can view the GitHub Actions logs. The opportunity to exploit this vulnerability is limitedthe GITHUB_TOKEN is automatically revoked when the job completes. However, there is an opportunity for an attack in the time between the GITHUB_TOKEN being displayed in the logs and the completion of the job. Users using the github-token input are impacted. This vulnerability is fixed in 1.0.1.

### Vulnerability Description Key Phrases
- **impact:** disclose GITHUB_TOKEN and read access
- **product:** GitHub Actions reusable workflow
- **version:** Prior to 1.0.1
- **component:** canonical/get-workflow-version-action

## CVE Reference Links Content Summary
## Analysis of CVE-2025-31479 based on provided content

The provided content is **RELEVANT** to CVE-2025-31479. It details a vulnerability in the `get-workflow-version-action` GitHub Action that can lead to partial leakage of the `GITHUB_TOKEN` secret. Here's a breakdown of the information:

**Root cause of vulnerability:**

The root cause is the way the action's traceback formatting library displays exception output, which includes a partial version of the `GITHUB_TOKEN` secret.  GitHub's secret redaction mechanism doesn't catch this partial exposure.

**Weaknesses/vulnerabilities present:**

*   **Information Leakage:**  Partial exposure of a sensitive secret (`GITHUB_TOKEN`).
*   **Insecure Exception Handling:**  Displaying potentially sensitive information in exception outputs.

**Impact of exploitation:**

*   An attacker with read access to the repository's GitHub Actions logs could potentially obtain a partial `GITHUB_TOKEN`.
*   Although the token is automatically revoked upon job completion, there's a window of opportunity for exploitation, especially if `continue-on-error` is used or status check functions are present.
*   A sophisticated attacker could potentially use the leaked token to perform actions on the repository, even with read-only permissions, potentially impacting other actions via the cache.

**Attack vectors:**

*   Triggering a failure in the `get-workflow-version-action` step.
*   Reading the GitHub Actions logs.

**Required attacker capabilities/position:**

*   Read access to the GitHub repository.
*   Ability to observe GitHub Actions logs.

**Mitigation or fix:**

*   **Update to v1.0.1:** The vulnerability is fixed in version 1.0.1 of the action. The `v1` tag has also been updated to include the fix.
*   **Disable displaying locals in exceptions:** The commit message indicates the fix involves disabling the display of locals in exceptions (`pretty_exceptions_show_locals=False`) to prevent the token from being included in the output.
*   **Revoke long-lived secrets:** If a long-lived secret (e.g., a personal access token) was used instead of the `GITHUB_TOKEN`, it should be immediately revoked.

**Additional Details (more than official CVE description):**

*   The issue was initially reported as GitHub Issue #2.
*   The CVSS score is 8.2 (High).
*   CVSS v3 base metrics: AV:N/AC:H/PR:L/UI:N/S:C/C:N/I:H/A:H
*   The vulnerability was discovered by @dannystaple.
*   A reference to a blog post detailing a similar attack scenario (CodeQL leaked secrets) is provided: <https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql/>
*   A reference to Cacheract is also provided: <https://github.com/AdnaneKhan/Cacheract>

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | sparse | 0.372 |
| 2 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.316 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.307 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.302 |
| 5 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.300 |
| 6 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.299 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.294 |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.288 |
| 9 | 527 | Exposure of Version-Control Repository to an Unauthorized Control Sphere | Variant | Allowed | dense | 0.391 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

