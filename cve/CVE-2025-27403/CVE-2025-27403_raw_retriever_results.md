# Raw Retriever Results for CVE-2025-27403

# Raw Retriever Results for CVE-2025-27403
## Query
Ratify is a verification engine as a binary executable and on Kubernetes which enables verification of artifact security metadata and admits for deployment only those that comply with policies the user creates. In a Kubernetes environment, Ratify can be configured to authenticate to a private Azure Container Registry (ACR). The Azure workload identity and Azure managed identity authentication providers are configured in this setup. Users that configure a private ACR to be used with the Azure authentication providers may be impacted by a vulnerability that exists in versions prior to 1.2.3 and 1.3.2. Both Azure authentication providers attempt to exchange an Entra ID (EID) token for an ACR refresh token. However, Ratifys Azure authentication providers did not verify that the target registry is an ACR. This could have led to the EID token being presented to a non-ACR registry during token exchange. EID tokens with ACR access can potentially be extracted and abused if a user workload contains an image reference to a malicious registry. As of versions 1.2.3 and 1.3.2, the Azure workload identity and Azure managed identity authentication providers are updated to add new validation prior to EID token exchange. Validation relies upon registry domain validation against a pre-configured list of well-known ACR endpoints. EID token exchange will be executed only if at least one of the configured well-known domain suffixes (wildcard support included) matches the registry domain of the image reference.

## Keyphrases
- **rootcause**: 'did not verify that the target registry is an ACR'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3207 | 0.3870 | 0.3452 | 0.3463 | 20 |
| Sparse | 1213.5444 | 1316.7630 | 1265.2815 | 1259.3304 | 10 |
| Graph | 1.0062 | 2.2100 | 1.4427 | 1.4486 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 2 | 370 | Missing Check for Certificate Revocation after Initial Check | variant | 1.9147 | Allowed |
| 3 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | 1.7239 | Allowed |
| 4 | 298 | Improper Validation of Certificate Expiration | variant | 1.6968 | Allowed |
| 5 | 295 | Improper Certificate Validation | Base | 1.6391 | Allowed |
| 6 | 178 | Improper Handling of Case Sensitivity | base | 1.6380 | Allowed |
| 7 | 347 | Improper Verification of Cryptographic Signature | Base | 1.5645 | Allowed |
| 8 | 283 | Unverified Ownership | Base | 1.5602 | Allowed |
| 9 | 41 | Improper Resolution of Path Equivalence | base | 1.5210 | Allowed |
| 10 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 1.4532 | Allowed |
| 11 | 322 | Key Exchange without Entity Authentication | Base | 1.4440 | Allowed |
| 12 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.3747 | Allowed |
| 13 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.2880 | Allowed |
| 14 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.2624 | Allowed |
| 15 | 257 | Storing Passwords in a Recoverable Format | base | 1.1794 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | Base | 0.3870 | 0.3870 | Allowed |
| 2 | 283 | Unverified Ownership | Base | 0.3838 | 0.3838 | Allowed |
| 3 | 295 | Improper Certificate Validation | Base | 0.3573 | 0.3573 | Allowed |
| 4 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.3562 | 0.3562 | Allowed |
| 5 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | 0.3561 | 0.3561 | Allowed |
| 6 | 287 | Improper Authentication | Class | 0.3549 | 0.3549 | Discouraged |
| 7 | 289 | Authentication Bypass by Alternate Name | Base | 0.3548 | 0.3548 | Allowed |
| 8 | 304 | Missing Critical Step in Authentication | Base | 0.3547 | 0.3547 | Allowed |
| 9 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.3521 | 0.3521 | Allowed-with-Review |
| 10 | 300 | Channel Accessible by Non-Endpoint | Class | 0.3519 | 0.3519 | Discouraged |
| 11 | 1283 | Mutable Attestation or Measurement Reporting Data | Base | 0.3407 | 0.3407 | Allowed |
| 12 | 308 | Use of Single-factor Authentication | Base | 0.3364 | 0.3364 | Allowed |
| 13 | 654 | Reliance on a Single Factor in a Security Decision | Base | 0.3346 | 0.3346 | Allowed |
| 14 | 556 | ASP.NET Misconfiguration: Use of Identity Impersonation | Variant | 0.3329 | 0.3329 | Allowed |
| 15 | 520 | .NET Misconfiguration: Use of Impersonation | Variant | 0.3287 | 0.3287 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1390 | Weak Authentication | 1316.7630 | 1316.7630 | Allowed-with-Review |
| 2 | 863 | Incorrect Authorization | 1306.9762 | 1306.9762 | Allowed-with-Review |
| 3 | 287 | Improper Authentication | 1294.3464 | 1294.3464 | Discouraged |
| 4 | 295 | Improper Certificate Validation | 1267.7148 | 1267.7148 | Allowed |
| 5 | 347 | Improper Verification of Cryptographic Signature | 1259.3495 | 1259.3495 | Allowed |
| 6 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 1259.3113 | 1259.3113 | Allowed-with-Review |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | 1256.2808 | 1256.2808 | Allowed |
| 8 | 668 | Exposure of Resource to Wrong Sphere | 1240.9113 | 1240.9113 | Discouraged |
| 9 | 306 | Missing Authentication for Critical Function | 1237.6176 | 1237.6176 | Allowed |
| 10 | 639 | Authorization Bypass Through User-Controlled Key | 1213.5444 | 1213.5444 | Allowed |
