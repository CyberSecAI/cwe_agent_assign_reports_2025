# Vulnerability Information: CVE-2025-4007

## Vulnerability Description
A vulnerability classified as critical was found in Tenda W12 and i24 3.0.0.4(2887)/3.0.0.5(3644). Affected by this vulnerability is the function cgidhcpsCfgSet of the file /goform/modules of the component httpd. The manipulation of the argument json leads to stack-based buffer overflow. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **component:** /goform/modules/httpd
- **weakness:** **stack-based buffer overflow, buffer overflow**
- **product:** Tenda W12 and i24
- **version:** 3.0.0.4(2887), 3.0.0.5(3644)

## CVE Reference Links Content Summary
## Analysis of CVE-2025-4007 Content

Based on the provided content, this relates to a vulnerability in Tenda routers. Here's a breakdown of the information extracted:

**Root cause of vulnerability:**

The vulnerability is a stack overflow in the `cgidhcpsCfgSet` function (located in `/bin/httpd`). This is due to a lack of length validation on the `startIp`, `endIp`, `gateway`, `mask`, `preDns`, and `altDns` parameters.

**Weaknesses/vulnerabilities present:**

*   Stack Overflow
*   Lack of input validation

**Impact of exploitation:**

The stack overflow allows modification of the `$RA` register, leading to a Remote Code Execution (RCE) vulnerability.

**Attack vectors:**

*   Network-based attack via HTTP POST request to the `/goform/modules` endpoint.
*   Specifically targeting the `dhcpsCfgSet` parameter with a crafted payload.

**Required attacker capabilities/position:**

*   Network access to the vulnerable Tenda router.
*   Ability to send HTTP POST requests with a crafted JSON payload.

**Mitigation or fix:**

The content does not provide information on mitigation or fixes.

**Affected Firmware:**

*   Tenda w12 V3.0.0.5(3644)
*   Tenda i24 V3.0.0.4(2887)

**Additional Details (more than official CVE description):**

The provided content includes a Python exploit script demonstrating how to trigger the vulnerability by sending a malicious payload to the `altDns` parameter. The script pads the `altDns` parameter with a large string (`0x4e4` bytes) followed by "bbbb" to overwrite the `$RA` register.

**Note:** The provided content offers significantly more detail than a typical CVE description, including a proof-of-concept exploit.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.456 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.437 |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.421 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.415 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.410 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.640 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

