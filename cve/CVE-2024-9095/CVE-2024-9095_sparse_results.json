{
  "query": "In lunary-ai/lunary version v1.4.28, the /bigquery API route lacks proper access control, allowing any logged-in user to create a Datastream to Google BigQuery and export the entire database. This includes sensitive data such as password hashes and secret API keys. The route is protected by a config check (`config.DATA_WAREHOUSE_EXPORTS_ALLOWED`), but it does not verify the users access level or implement any access control middleware. This vulnerability can lead to the extraction of sensitive data, disruption of services, credential compromise, and service integrity breaches.",
  "count": 11,
  "results": [
    {
      "cwe_id": "306",
      "name": "Missing Authentication for Critical Function",
      "abstraction": "Base",
      "score": 511.7289405762965,
      "original_score": 511.7289405762965,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "abstraction": "Class",
      "score": 483.13921279428837,
      "original_score": 483.13921279428837,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "abstraction": "Base",
      "score": 474.01266813529594,
      "original_score": 474.01266813529594,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "522",
      "name": "Insufficiently Protected Credentials",
      "abstraction": "Class",
      "score": 472.72300392225713,
      "original_score": 472.72300392225713,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "285",
      "name": "Improper Authorization",
      "abstraction": "Class",
      "score": 469.88295359078046,
      "original_score": 469.88295359078046,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "862",
      "name": "Missing Authorization",
      "abstraction": "Class",
      "score": 460.72235623228283,
      "original_score": 460.72235623228283,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "abstraction": "Base",
      "score": 458.6198619722186,
      "original_score": 458.6198619722186,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "284",
      "name": "Improper Access Control",
      "abstraction": "Pillar",
      "score": 457.66139495466155,
      "original_score": 457.66139495466155,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "532",
      "name": "Insertion of Sensitive Information into Log File",
      "abstraction": "Base",
      "score": 457.6302466352642,
      "original_score": 457.6302466352642,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "score": 457.43830586792365,
      "original_score": 457.43830586792365,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1390",
      "name": "Weak Authentication",
      "abstraction": "Class",
      "score": 146.4095730864342,
      "original_score": 146.4095730864342,
      "mapping_usage": "Allowed-with-Review"
    }
  ],
  "statistics": {
    "min": 146.4095730864342,
    "max": 511.7289405762965,
    "mean": 440.9062288879731,
    "median": 460.72235623228283,
    "count": 11
  }
}