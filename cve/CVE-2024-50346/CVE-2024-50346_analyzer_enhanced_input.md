## Vulnerability Description
WebFeed is a lightweight web feed reader extension for Firefox/Chrome. Multiple **HTML injection vulnerabilities** in WebFeed can lead to **CSRF** and UI spoofing attacks. A remote attacker can provide malicious RSS feeds and attract the victim user to visit it using WebFeed. The attacker can then inject malicious HTML into the extension page and fool the victim into sending out HTTP requests to arbitrary sites with the victims credentials. Users are vulnerable to **CSRF** attacks when visiting malicious RSS feeds via WebFeed. Unwanted actions could be executed on the users behalf on arbitrary websites. This issue has been addressed in release version 0.9.2. All users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **HTML injection vulnerabilities**
- **weakness:** **CSRF**
- **impact:** UI spoofing attacks
- **vector:** malicious RSS feeds
- **attacker:** remote attacker
- **product:** WebFeed
- **version:** prior to 0.9.2

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-50346.

**Root cause of vulnerability:**
The vulnerability stems from multiple instances of improper HTML sanitization and injection within the WebFeed extension. Specifically, the extension uses `innerHTML` to render content from RSS feeds and other sources without adequate sanitization, allowing for injection of malicious HTML. The `html2txt` utility was found to be ineffective against deeply nested HTML structures.

**Weaknesses/vulnerabilities present:**
- **CWE-79 (Cross-site Scripting):** The core issue is the injection of malicious HTML into the extension's UI. This enables an attacker to execute arbitrary JavaScript code within the context of the extension.
- **CWE-352 (Cross-Site Request Forgery):** By injecting malicious HTML, specifically forms, an attacker can force the user to perform actions on other websites without their consent or knowledge. This occurs because the extension has `<all_urls>` host permissions, allowing it to make cross-site requests with user cookies.

**Impact of exploitation:**
- **CSRF attacks:** An attacker can use the injected HTML forms to send cross-site requests with the victim's cookies, potentially leading to unwanted actions on arbitrary websites.
- **UI spoofing:** Malicious HTML can be injected into the extension's UI, which could trick the user into performing actions they did not intend.
- Potential execution of arbitrary Javascript within the context of the extension.

**Attack vectors:**
- A remote attacker provides malicious RSS feeds.
- The victim user is tricked into visiting the malicious RSS feed using the WebFeed extension.
- Malicious HTML within the feed is then rendered within the extension's UI.

**Required attacker capabilities/position:**
- The attacker needs to host a malicious RSS feed.
- The attacker needs to entice a WebFeed user to subscribe to the malicious feed.
- No special privileges are required as the exploit is triggered via user interaction with a malicious feed.

**Additional Information:**
- The vulnerability exists in versions <= 0.9.1 and was patched in version 0.9.2
- The provided Proof of Concept (PoC) includes an `index.html`, `feed.xml`, and `server.py` demonstrating the vulnerability in a local testing environment.
- The PoC shows that CSRF attacks are normally blocked by the Same-Origin Policy (SOP) but can be bypassed via the extension's permissions and the HTML injection.
- The severity of the vulnerability is rated as "Moderate".
- The advisory includes CVSS v4 metrics.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.666 |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.646 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.644 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.634 |
| 6 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.615 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.614 |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.609 |
| 9 | 1385 | Missing Origin Validation in WebSockets | Variant | Allowed | dense | 0.564 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-20: Improper Input Validation

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-1385: Missing Origin Validation in WebSockets

CWE-117: Improper Output Neutralization for Logs