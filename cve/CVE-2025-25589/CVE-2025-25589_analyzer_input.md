# Vulnerability Information: CVE-2025-25589

## Vulnerability Description
An XML external entity (XXE) injection vulnerability in the component /weixin/aes/XMLParse.java of yimioa before v2024.07.04 allows attackers to execute arbitrary code via supplying a crafted XML file.

### Vulnerability Description Key Phrases
- **component:** /weixin/aes/XMLParse.java
- **vector:** crafted XML file
- **weakness:** **XML external entity (XXE) injection, external entity injection**
- **product:** yimioa
- **impact:** execute arbitrary code
- **attacker:** attackers
- **version:** before v2024.07.04

## CVE Reference Links Content Summary
## Analysis of CVE-2025-25589 Content

This content **IS RELATED** to CVE-2025-25589. It details an Unauthorized XXE vulnerability in the ywoa project (OA协同办公系统，流程专家（带有低代码开发平台的OA）) hosted on Gitee. The information provided is **more detailed** than a typical CVE description.

Here's a breakdown of the extracted information:

**Root cause of vulnerability:**

*   The application parses XML data using `db.parse(is)` in `com.redmoon.weixin.aes.XMLParse.java:42` without proper restrictions.
*   The `/servlet/WXCallBack` path does not require permission verification (configured in `com.cloudweb.oa.config.WebSecurityConfig.java:189`).

**Weaknesses/vulnerabilities present:**

*   **XXE (XML External Entity) Injection:**  The lack of input validation when parsing XML allows for XXE attacks.
*   **Unauthorized Access:** The absence of authentication/authorization checks on the `/servlet/WXCallBack` endpoint allows attackers to exploit the XXE vulnerability without needing valid credentials.

**Impact of exploitation:**

*   **File Reading:**  The vulnerability can be used to read arbitrary files from the server's filesystem. The POC demonstrates reading `/Users/admin/Desktop/test/flag.txt`.
*   **Potential for Server-Side Request Forgery (SSRF):**  Depending on the JDK version, the attacker might be able to leverage the XXE vulnerability for SSRF attacks (using FTP protocol in specific JDK versions).

**Attack vectors:**

*   **HTTP POST Request:** The attack is performed by sending a crafted XML payload in a POST request to the `/oa/servlet/WXCallBack` endpoint.
*   **XML Payload:** The malicious XML payload utilizes external entity definitions to trigger the XXE injection.  The provided example uses a remote DTD to define an entity that reads a local file.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the vulnerable endpoint (`/oa/servlet/WXCallBack`).
*   **Ability to Send HTTP Requests:** The attacker must be able to send crafted HTTP POST requests.
*   **Understanding of XXE:**  Knowledge of XXE vulnerabilities and how to construct malicious XML payloads is required.

**Mitigation or fix:**

*   The report does not explicitly state a fix, but the root cause analysis implies that the following mitigations are necessary:
    *   **Input Validation:** Implement strict input validation and sanitization for all XML data received by the application.
    *   **Disable External Entities:** Disable the processing of external entities in the XML parser.  This is the most effective mitigation for XXE vulnerabilities.
    *   **Authentication/Authorization:** Implement proper authentication and authorization checks for the `/servlet/WXCallBack` endpoint to prevent unauthorized access.
    *   **Update Dependencies:** Ensure that the application is using a secure version of the XML parser and related libraries.
*   The report mentions setting the `encodingAesKey` length to 43 to avoid errors, but this is not a direct mitigation for the XXE vulnerability itself. It's a workaround to ensure the request processing continues to the vulnerable parsing stage.

**Additional Details:**

*   **Vulnerable Product:** ywoa
*   **Vulnerable Version:** before 2024.07.04
*   **POC Provided:** The content includes a sample POC (Proof of Concept) demonstrating the exploitation of the vulnerability.
*   **JDK Version Considerations:** The effectiveness of the exploit depends on the JDK version.  Older versions (7u141 < jdk < 8u162) are more susceptible to complete file reading via FTP.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | alternate_terms | 0.800 |
| 2 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | Allowed | sparse | 0.183 |
| 3 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.160 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.159 |
| 5 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.153 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.144 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.140 |
| 8 | 112 | Missing XML Validation | Base | Allowed | sparse | 0.138 |
| 9 | 91 | XML Injection (aka Blind XPath Injection) | Base | Allowed | dense | 0.621 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |

