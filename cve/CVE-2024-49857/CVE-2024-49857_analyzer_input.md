# Vulnerability Information: CVE-2024-49857

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved wifi iwlwifi mvm set the cipher for secured NDP ranging The cipher pointer is not set, but is derefereced trying to set its content, which leads to a **NULL pointer dereference**. Fix it by pointing to the cipher parameter before dereferencing.

### Vulnerability Description Key Phrases
- **rootcause:** **NULL pointer dereference**
- **vector:** accessing an uninitialized pointer
- **product:** Linux kernel
- **component:** wifi iwlwifi mvm

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The root cause is a NULL pointer dereference in the `iwl_mvm_ftm_set_secured_ranging` function within the Intel iwlwifi driver. The `cipher` pointer is not being properly set before being dereferenced, which results in the NULL pointer dereference when attempting to access its content.

**Weaknesses/Vulnerabilities:**
- **NULL Pointer Dereference:** The code attempts to dereference a null pointer, leading to a crash.
- **Incorrect Pointer Usage:** The `cipher` pointer was not being initialized properly.

**Impact of Exploitation:**
- The primary impact is a kernel crash due to the NULL pointer dereference. This can lead to denial of service, potentially disrupting wireless connectivity and system stability.

**Attack Vectors:**
- The vulnerability is triggered during the execution of Fine Timing Measurement (FTM) secured ranging. It involves operations related to setting the cipher for secured ranging.

**Required Attacker Capabilities/Position:**
- An attacker would need to trigger the specific code path in the iwlwifi driver which involves setting up an FTM secured ranging. This likely involves interacting with the wireless interface and network protocols related to FTM.
- The attacker may need to be in a position to initiate a secured FTM ranging operation, suggesting they would likely need to be a network peer or have control of the device performing the FTM ranging.

**Additional Details**
- The fix involves properly assigning the `cipher` parameter to `target.cipher` before dereferencing, ensuring that the pointer is valid.
- The vulnerability is present in the Linux kernel's iwlwifi driver.
- The commit message and code diff indicate that this vulnerability exists in the function `iwl_mvm_ftm_set_secured_ranging` and was introduced by the commit `626be4bf99f6`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.374 |
| 2 | 822 | Untrusted Pointer Dereference | Base | Allowed | sparse | 0.328 |
| 3 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.327 |
| 4 | 456 | Missing Initialization of a Variable | Variant | Allowed | sparse | 0.323 |
| 5 | 665 | Improper Initialization | Class | Discouraged | sparse | 0.301 |
| 6 | 690 | Unchecked Return Value to NULL Pointer Dereference | Compound | Discouraged | sparse | 0.291 |
| 7 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.288 |
| 8 | 824 | Access of Uninitialized Pointer | Base | Allowed | sparse | 0.286 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.490 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |

