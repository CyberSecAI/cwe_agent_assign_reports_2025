# Vulnerability Information: CVE-2024-7154

## Vulnerability Description
A vulnerability, which was classified as problematic, was found in TOTOLINK A3700R 9.1.2u.5822_B20200513. Affected is an unknown function of the file /wizard.html of the component Password Reset Handler. The manipulation leads to **improper access controls**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The identifier of this vulnerability is VDB-272568. NOTE The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access controls**
- **impact:** Password Reset Handler
- **product:** TOTOLINK A3700R
- **version:** 9.1.2u.5822_B20200513
- **component:** /wizard.html

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**

*   The vulnerability stems from **Incorrect Access Control** in the TOTOLINK A3700R router firmware. Specifically, the `/wizard.html` and `/phone/wizard.html` pages lack proper authentication checks.

**Weaknesses/vulnerabilities present:**

*   **Missing Authentication:** The web pages responsible for changing passwords (`/wizard.html` and `/phone/wizard.html`) can be accessed without prior authentication. This bypasses the intended access control mechanisms.

**Impact of exploitation:**

*   **Unauthorized Password Reset:** Attackers can reset critical passwords without needing any credentials, leading to a complete loss of control over the device. This can allow for unauthorized access to the network, modification of device settings, and potentially other malicious actions.

**Attack vectors:**

*   **Direct URL Access:** Attackers can exploit this vulnerability by directly visiting the vulnerable URLs (`/wizard.html` or `/phone/wizard.html`) in a web browser.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs to be able to access the router's web interface. This could be from the local network or potentially remotely if the router's management interface is exposed to the internet.
*   **No Credentials Required:** The attacker does not need any valid user credentials to exploit this vulnerability.

**Summary of Vulnerability:**

The vulnerability allows an unauthenticated attacker to reset the device passwords by simply accessing specific URLs, which means that the access control for these critical pages is missing. This could result in full control of the device.

**Additional Information:**

*   **Affected version:** TOTOLINK A3700R V9.1.2u.5822\_B20200513
*   **Proof of Concept (POC):** The provided images show the vulnerable pages being accessed in a web browser.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.599 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.576 |
| 3 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.501 |
| 4 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.486 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.486 |
| 6 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.478 |
| 7 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.478 |
| 8 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.473 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.690 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.003 |

