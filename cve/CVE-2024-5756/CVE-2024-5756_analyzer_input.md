# Vulnerability Information: CVE-2024-5756

## Vulnerability Description
The Email Subscribers by Icegram Express - Email Marketing, Newsletters, Automation for WordPress & WooCommerce plugin for WordPress is vulnerable to **time-based SQL Injection** via the db parameter in all versions up to, and including, 5.7.23 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL Injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** unauthenticated attackers
- **product:** Email Subscribers by Icegram Express
- **version:** all versions up to 5.7.23
- **component:** db parameter

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-89

#### Top CWEs
- CWE-89 (Count: 14)

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-5756:

**1. Verification of CVE Relevance:**

The provided content explicitly mentions CVE-2024-5756 and describes a SQL injection vulnerability in the "Email Subscribers by Icegram Express" WordPress plugin. This confirms the relevance of the content to the specified CVE.

**2. Root Cause of Vulnerability:**

The root cause of the vulnerability is insufficient input sanitization and lack of proper preparation in an SQL query. Specifically, the `db` parameter in the plugin is not properly escaped before being used in a SQL query. This allows an attacker to inject arbitrary SQL code.

**3. Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The primary vulnerability is an unauthenticated time-based SQL injection. The plugin fails to sanitize the `db` parameter, allowing malicious SQL code to be inserted and executed.

**4. Impact of Exploitation:**

*   **Sensitive Data Extraction:** Successful exploitation of this vulnerability allows attackers to extract sensitive information from the WordPress database, including potentially user data, admin credentials, and other confidential information.
*   **Complete System Compromise:** With the ability to execute arbitrary SQL commands, attackers can potentially modify or delete data and potentially escalate to take complete control of the WordPress website.

**5. Attack Vectors:**

*   **Unauthenticated HTTP Requests:** The vulnerability is accessible to unauthenticated attackers, making exploitation easier. Attackers can send crafted HTTP requests containing malicious SQL code in the `db` parameter to trigger the vulnerability.
*   **Vulnerable Parameter:** The `db` parameter is the direct injection point, making the attack vector clear.

**6. Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the target WordPress site.
*   **No Authentication:** The attacker does not need any authentication to exploit the vulnerability. They can directly send malicious requests to the vulnerable endpoint.
*   **Knowledge of the Vulnerable Parameter:** The attacker must know the name of the vulnerable parameter (`db`) to exploit this.

**Additional Details:**

*   **Affected Versions:** The vulnerability affects all versions of the "Email Subscribers by Icegram Express" plugin up to and including 5.7.23.
*   **Patched Version:** The vulnerability is patched in version 5.7.24 and later.
*   **CVSS Score:** The vulnerability has a critical CVSS score of 9.8.
*   **Time-Based SQL Injection:** The Wordfence article describes the vulnerability as time-based, meaning attackers can use time delays to confirm and extract data from the database.
*   **Code Change:** The provided Trac changeset shows that the vulnerable code was using `implode( ',', ~~$ids~~ )` to create an id string, and it was changed to use `implode( ',', array_map( 'absint', $ids ) )`, which is a fix for SQL injection, ensuring that IDs are integers.

**Summary:**

CVE-2024-5756 is a critical SQL injection vulnerability in the "Email Subscribers by Icegram Express" WordPress plugin. It allows unauthenticated attackers to inject malicious SQL code via the `db` parameter, leading to potential data breaches and complete system compromise. It is crucial to update to the patched version (5.7.24 or later) to mitigate this risk.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.584 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.531 |
| 4 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.524 |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.523 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.501 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.500 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.499 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.493 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

