{
  "vulnerability_info": "VulnerabilityInfo(cve_id='CVE-2024-39315', description='Pomerium is an identity and context-aware access proxy. Prior to version 0.26.1, the Pomerium user info page (at `/.pomerium`) unintentionally included serialized OAuth2 access and ID tokens from the logged-in users session. These tokens are not intended to be exposed to end users. This issue may be more severe in the presence of a **cross-site scripting** vulnerability in an upstream application proxied through Pomerium. If an attacker could insert a malicious script onto a web page proxied through Pomerium, that script could access these tokens by making a request to the `/.pomerium` endpoint. Upstream applications that authenticate only the ID token may be vulnerable to user impersonation using a token obtained in this manner. Note that an OAuth2 access token or ID token by itself is not sufficient to hijack a users Pomerium session. Upstream applications should not be vulnerable to user impersonation via these tokens provided the application verifies the Pomerium JWT for each request, the connection between Pomerium and the application is secured by mTLS, or the connection between Pomerium and the application is otherwise secured at the network layer. The issue is patched in Pomerium v0.26.1. No known workarounds are available.', key_phrases={'rootcause': '', 'weakness': ['cross-site scripting', 'information exposure'], 'impact': ['access serialized OAuth2 access and ID tokens', 'impersonation'], 'vector': '', 'attacker': '', 'product': 'Pomerium', 'version': 'prior to 0.26.1', 'component': '/.pomerium endpoint'}, reference_content='Based on the provided information, here\\'s an analysis of CVE-2024-39315:\\n\\n**Root Cause of Vulnerability:**\\n\\nThe Pomerium user info page (located at `/.pomerium`) was unintentionally including serialized OAuth2 access and ID tokens from the logged-in user\\'s session within the response. These tokens were not meant to be exposed to end-users.\\n\\n**Weaknesses/Vulnerabilities Present:**\\n\\n*   **Information Exposure:** The primary vulnerability is the exposure of sensitive OAuth2 access and ID tokens within the user info endpoint response.\\n*   **Data Leakage:** These tokens, intended for internal use within the Pomerium service and downstream applications, are leaked to the end user\\'s browser, potentially making them accessible to malicious actors.\\n\\n**Impact of Exploitation:**\\n\\n*   **Potential for User Impersonation:** If an attacker were to obtain the exposed ID token, they might be able to impersonate the user in upstream applications that rely solely on the ID token for authentication.\\n*   **Increased Severity with XSS:** The impact is more severe when combined with an XSS vulnerability in a proxied upstream application.  An attacker injecting a malicious script could then retrieve these leaked tokens by querying the `/.pomerium` endpoint.\\n*   **Privilege escalation**: Though not explicitly detailed, access tokens could potentially be used to perform actions on the user\\'s behalf depending on the permissions associated with the tokens.\\n\\n**Attack Vectors:**\\n\\n*   **Network-based:** An attacker could exploit this vulnerability by directly accessing the `/.pomerium` endpoint after a user has logged in.\\n*   **Cross-Site Scripting (XSS) Augmentation:** An XSS vulnerability in a proxied upstream application can be used as a means to retrieve the tokens from the vulnerable endpoint by injecting malicious scripts that then make a request to the `/.pomerium` endpoint.\\n\\n**Required Attacker Capabilities/Position:**\\n\\n*   **Low privilege:** An attacker would need to be a logged-in user of the Pomerium service (or have access to a logged-in user\\'s session to view the data).\\n*   **Network access:** The attacker would need network access to the Pomerium service.\\n*   **User interaction:** The user interaction required here is low. A user simply needs to be logged into Pomerium. The attacker may need additional interaction if using XSS in an upstream application to obtain the tokens, which would require the victim to visit the compromised site.\\n\\n**Additional Notes:**\\n\\n*   The vulnerability is mitigated in Pomerium v0.26.1.\\n*   The provided commit (`4c7c4320afb2ced70ba19b46de1ac4383f3daa48`) shows the fix where the excess user information, including the OAuth tokens, are removed from the userinfo endpoint response.\\n*   The severity is rated as \"Moderate\" with a CVSS score of 5.7.\\n*   The advisory states that while the tokens exposed might be used to impersonate users in upstream applications, the risk is reduced if applications verify the Pomerium JWT, use mTLS, or have network-level security.', similar_info={'cwe_distribution': {}, 'cwe_consensus': '', 'similarity_stats': {'thresholds': [], 'total_samples_by_threshold': {}, 'top_cwes_by_threshold': {}}}, similarity_summary=SimilarityInsight(consensus_cwe='', top_cwes=[], confidence_levels={}, total_samples=0), analysis='', analysis_with_relationships='', criticism='', resolution='', relevant_cwes=[{'metadata': {'doc_id': '489', 'name': 'Active Debug Code', 'source': 'sparse', 'original_content': 'The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information.', 'keyphrase_sources': [{'id': 'weakness:cross-site scripting', 'keyphrase': 'cross-site scripting', 'type': 'weakness'}, {'id': 'weakness:information exposure', 'keyphrase': 'information exposure', 'type': 'weakness'}, {'id': 'impact:access serialized OAuth2 access and ID tokens', 'keyphrase': 'access serialized OAuth2 access and ID tokens', 'type': 'impact'}, {'id': 'impact:impersonation', 'keyphrase': 'impersonation', 'type': 'impact'}, {'id': 'product:Pomerium', 'keyphrase': 'Pomerium', 'type': 'product'}, {'id': 'version:prior to 0.26.1', 'keyphrase': 'prior to 0.26.1', 'type': 'version'}, {'id': 'component:/.pomerium endpoint', 'keyphrase': '/.pomerium endpoint', 'type': 'component'}]}, 'similarity': np.float64(1122.2617101318685)}, {'metadata': {'doc_id': '863', 'name': 'Incorrect Authorization', 'source': 'sparse', 'original_content': 'The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.', 'keyphrase_sources': [{'id': 'weakness:cross-site scripting', 'keyphrase': 'cross-site scripting', 'type': 'weakness'}, {'id': 'weakness:information exposure', 'keyphrase': 'information exposure', 'type': 'weakness'}, {'id': 'impact:access serialized OAuth2 access and ID tokens', 'keyphrase': 'access serialized OAuth2 access and ID tokens', 'type': 'impact'}, {'id': 'impact:impersonation', 'keyphrase': 'impersonation', 'type': 'impact'}, {'id': 'product:Pomerium', 'keyphrase': 'Pomerium', 'type': 'product'}, {'id': 'version:prior to 0.26.1', 'keyphrase': 'prior to 0.26.1', 'type': 'version'}, {'id': 'component:/.pomerium endpoint', 'keyphrase': '/.pomerium endpoint', 'type': 'component'}]}, 'similarity': np.float64(1102.2413269823949)}, {'metadata': {'doc_id': '79', 'name': \"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\", 'source': 'sparse', 'original_content': 'The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.', 'keyphrase_sources': [{'id': 'weakness:cross-site scripting', 'keyphrase': 'cross-site scripting', 'type': 'weakness'}]}, 'similarity': np.float64(1080.1022915480125)}, {'metadata': {'doc_id': '201', 'name': 'Insertion of Sensitive Information Into Sent Data', 'source': 'sparse', 'original_content': 'The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor.', 'keyphrase_sources': [{'id': 'weakness:cross-site scripting', 'keyphrase': 'cross-site scripting', 'type': 'weakness'}, {'id': 'weakness:information exposure', 'keyphrase': 'information exposure', 'type': 'weakness'}, {'id': 'impact:access serialized OAuth2 access and ID tokens', 'keyphrase': 'access serialized OAuth2 access and ID tokens', 'type': 'impact'}, {'id': 'impact:impersonation', 'keyphrase': 'impersonation', 'type': 'impact'}, {'id': 'product:Pomerium', 'keyphrase': 'Pomerium', 'type': 'product'}, {'id': 'version:prior to 0.26.1', 'keyphrase': 'prior to 0.26.1', 'type': 'version'}, {'id': 'component:/.pomerium endpoint', 'keyphrase': '/.pomerium endpoint', 'type': 'component'}]}, 'similarity': np.float64(1079.8491688816603)}, {'metadata': {'doc_id': '639', 'name': 'Authorization Bypass Through User-Controlled Key', 'source': 'sparse', 'original_content': \"The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.\", 'keyphrase_sources': [{'id': 'weakness:cross-site scripting', 'keyphrase': 'cross-site scripting', 'type': 'weakness'}, {'id': 'weakness:information exposure', 'keyphrase': 'information exposure', 'type': 'weakness'}, {'id': 'version:prior to 0.26.1', 'keyphrase': 'prior to 0.26.1', 'type': 'version'}, {'id': 'component:/.pomerium endpoint', 'keyphrase': '/.pomerium endpoint', 'type': 'component'}]}, 'similarity': np.float64(1018.6276982002903)}, {'metadata': {'doc_id': '287', 'name': 'Improper Authentication', 'source': 'sparse', 'original_content': 'When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.', 'keyphrase_sources': [{'id': 'weakness:information exposure', 'keyphrase': 'information exposure', 'type': 'weakness'}, {'id': 'impact:access serialized OAuth2 access and ID tokens', 'keyphrase': 'access serialized OAuth2 access and ID tokens', 'type': 'impact'}, {'id': 'impact:impersonation', 'keyphrase': 'impersonation', 'type': 'impact'}, {'id': 'product:Pomerium', 'keyphrase': 'Pomerium', 'type': 'product'}, {'id': 'version:prior to 0.26.1', 'keyphrase': 'prior to 0.26.1', 'type': 'version'}]}, 'similarity': np.float64(1011.0991712185495)}, {'metadata': {'doc_id': '1390', 'name': 'Weak Authentication', 'source': 'sparse', 'original_content': 'The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct.', 'keyphrase_sources': [{'id': 'impact:access serialized OAuth2 access and ID tokens', 'keyphrase': 'access serialized OAuth2 access and ID tokens', 'type': 'impact'}, {'id': 'impact:impersonation', 'keyphrase': 'impersonation', 'type': 'impact'}, {'id': 'product:Pomerium', 'keyphrase': 'Pomerium', 'type': 'product'}]}, 'similarity': np.float64(384.83903215770914)}, {'metadata': {'doc_id': '923', 'name': 'Improper Restriction of Communication Channel to Intended Endpoints', 'source': 'sparse', 'original_content': 'The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint.', 'keyphrase_sources': [{'id': 'component:/.pomerium endpoint', 'keyphrase': '/.pomerium endpoint', 'type': 'component'}]}, 'similarity': np.float64(360.0758469047394)}], identified_cwes={'analyzer': [], 'critic_additional': []})",
  "retrieval_results": {
    "has_multiple_keyphrases": true,
    "keyphrase_cwe_sets": {
      "weakness:cross-site scripting": {
        "keyphrase": "cross-site scripting",
        "type": "weakness",
        "cwes": [
          {
            "metadata": {
              "doc_id": "489",
              "name": "Active Debug Code",
              "source": "sparse",
              "original_content": "The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information.",
              "keyphrase_sources": [
                {
                  "id": "weakness:cross-site scripting",
                  "keyphrase": "cross-site scripting",
                  "type": "weakness"
                },
                {
                  "id": "weakness:information exposure",
                  "keyphrase": "information exposure",
                  "type": "weakness"
                },
                {
                  "id": "impact:access serialized OAuth2 access and ID tokens",
                  "keyphrase": "access serialized OAuth2 access and ID tokens",
                  "type": "impact"
                },
                {
                  "id": "impact:impersonation",
                  "keyphrase": "impersonation",
                  "type": "impact"
                },
                {
                  "id": "product:Pomerium",
                  "keyphrase": "Pomerium",
                  "type": "product"
                },
                {
                  "id": "version:prior to 0.26.1",
                  "keyphrase": "prior to 0.26.1",
                  "type": "version"
                },
                {
                  "id": "component:/.pomerium endpoint",
                  "keyphrase": "/.pomerium endpoint",
                  "type": "component"
                }
              ]
            },
            "similarity": 1122.2617101318685
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.",
              "keyphrase_sources": [
                {
                  "id": "weakness:cross-site scripting",
                  "keyphrase": "cross-site scripting",
                  "type": "weakness"
                },
                {
                  "id": "weakness:information exposure",
                  "keyphrase": "information exposure",
                  "type": "weakness"
                },
                {
                  "id": "impact:access serialized OAuth2 access and ID tokens",
                  "keyphrase": "access serialized OAuth2 access and ID tokens",
                  "type": "impact"
                },
                {
                  "id": "impact:impersonation",
                  "keyphrase": "impersonation",
                  "type": "impact"
                },
                {
                  "id": "product:Pomerium",
                  "keyphrase": "Pomerium",
                  "type": "product"
                },
                {
                  "id": "version:prior to 0.26.1",
                  "keyphrase": "prior to 0.26.1",
                  "type": "version"
                },
                {
                  "id": "component:/.pomerium endpoint",
                  "keyphrase": "/.pomerium endpoint",
                  "type": "component"
                }
              ]
            },
            "similarity": 1102.2413269823949
          },
          {
            "metadata": {
              "doc_id": "79",
              "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
              "source": "sparse",
              "original_content": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
              "keyphrase_sources": [
                {
                  "id": "weakness:cross-site scripting",
                  "keyphrase": "cross-site scripting",
                  "type": "weakness"
                }
              ]
            },
            "similarity": 1080.1022915480125
          },
          {
            "metadata": {
              "doc_id": "201",
              "name": "Insertion of Sensitive Information Into Sent Data",
              "source": "sparse",
              "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor.",
              "keyphrase_sources": [
                {
                  "id": "weakness:cross-site scripting",
                  "keyphrase": "cross-site scripting",
                  "type": "weakness"
                },
                {
                  "id": "weakness:information exposure",
                  "keyphrase": "information exposure",
                  "type": "weakness"
                },
                {
                  "id": "impact:access serialized OAuth2 access and ID tokens",
                  "keyphrase": "access serialized OAuth2 access and ID tokens",
                  "type": "impact"
                },
                {
                  "id": "impact:impersonation",
                  "keyphrase": "impersonation",
                  "type": "impact"
                },
                {
                  "id": "product:Pomerium",
                  "keyphrase": "Pomerium",
                  "type": "product"
                },
                {
                  "id": "version:prior to 0.26.1",
                  "keyphrase": "prior to 0.26.1",
                  "type": "version"
                },
                {
                  "id": "component:/.pomerium endpoint",
                  "keyphrase": "/.pomerium endpoint",
                  "type": "component"
                }
              ]
            },
            "similarity": 1079.8491688816603
          },
          {
            "metadata": {
              "doc_id": "639",
              "name": "Authorization Bypass Through User-Controlled Key",
              "source": "sparse",
              "original_content": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
              "keyphrase_sources": [
                {
                  "id": "weakness:cross-site scripting",
                  "keyphrase": "cross-site scripting",
                  "type": "weakness"
                },
                {
                  "id": "weakness:information exposure",
                  "keyphrase": "information exposure",
                  "type": "weakness"
                },
                {
                  "id": "version:prior to 0.26.1",
                  "keyphrase": "prior to 0.26.1",
                  "type": "version"
                },
                {
                  "id": "component:/.pomerium endpoint",
                  "keyphrase": "/.pomerium endpoint",
                  "type": "component"
                }
              ]
            },
            "similarity": 1018.6276982002903
          }
        ]
      },
      "weakness:information exposure": {
        "keyphrase": "information exposure",
        "type": "weakness",
        "cwes": [
          {
            "metadata": {
              "doc_id": "489",
              "name": "Active Debug Code",
              "source": "sparse",
              "original_content": "The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information."
            },
            "similarity": 1127.0032820568545
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 1105.798435528299
          },
          {
            "metadata": {
              "doc_id": "201",
              "name": "Insertion of Sensitive Information Into Sent Data",
              "source": "sparse",
              "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor."
            },
            "similarity": 1086.0421693331512
          },
          {
            "metadata": {
              "doc_id": "287",
              "name": "Improper Authentication",
              "source": "sparse",
              "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
              "keyphrase_sources": [
                {
                  "id": "weakness:information exposure",
                  "keyphrase": "information exposure",
                  "type": "weakness"
                },
                {
                  "id": "impact:access serialized OAuth2 access and ID tokens",
                  "keyphrase": "access serialized OAuth2 access and ID tokens",
                  "type": "impact"
                },
                {
                  "id": "impact:impersonation",
                  "keyphrase": "impersonation",
                  "type": "impact"
                },
                {
                  "id": "product:Pomerium",
                  "keyphrase": "Pomerium",
                  "type": "product"
                },
                {
                  "id": "version:prior to 0.26.1",
                  "keyphrase": "prior to 0.26.1",
                  "type": "version"
                }
              ]
            },
            "similarity": 1011.0991712185495
          },
          {
            "metadata": {
              "doc_id": "639",
              "name": "Authorization Bypass Through User-Controlled Key",
              "source": "sparse",
              "original_content": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data."
            },
            "similarity": 1004.3911293821101
          }
        ]
      },
      "impact:access serialized OAuth2 access and ID tokens": {
        "keyphrase": "access serialized OAuth2 access and ID tokens",
        "type": "impact",
        "cwes": [
          {
            "metadata": {
              "doc_id": "489",
              "name": "Active Debug Code",
              "source": "sparse",
              "original_content": "The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information."
            },
            "similarity": 425.126648811843
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 417.50847652534526
          },
          {
            "metadata": {
              "doc_id": "201",
              "name": "Insertion of Sensitive Information Into Sent Data",
              "source": "sparse",
              "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor."
            },
            "similarity": 413.3413828236076
          },
          {
            "metadata": {
              "doc_id": "287",
              "name": "Improper Authentication",
              "source": "sparse",
              "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct."
            },
            "similarity": 386.7218118177718
          },
          {
            "metadata": {
              "doc_id": "1390",
              "name": "Weak Authentication",
              "source": "sparse",
              "original_content": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct.",
              "keyphrase_sources": [
                {
                  "id": "impact:access serialized OAuth2 access and ID tokens",
                  "keyphrase": "access serialized OAuth2 access and ID tokens",
                  "type": "impact"
                },
                {
                  "id": "impact:impersonation",
                  "keyphrase": "impersonation",
                  "type": "impact"
                },
                {
                  "id": "product:Pomerium",
                  "keyphrase": "Pomerium",
                  "type": "product"
                }
              ]
            },
            "similarity": 384.83903215770914
          }
        ]
      },
      "impact:impersonation": {
        "keyphrase": "impersonation",
        "type": "impact",
        "cwes": [
          {
            "metadata": {
              "doc_id": "489",
              "name": "Active Debug Code",
              "source": "sparse",
              "original_content": "The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information."
            },
            "similarity": 400.80775361852454
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 391.43523181086323
          },
          {
            "metadata": {
              "doc_id": "201",
              "name": "Insertion of Sensitive Information Into Sent Data",
              "source": "sparse",
              "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor."
            },
            "similarity": 381.22704028604306
          },
          {
            "metadata": {
              "doc_id": "287",
              "name": "Improper Authentication",
              "source": "sparse",
              "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct."
            },
            "similarity": 358.858371084297
          },
          {
            "metadata": {
              "doc_id": "1390",
              "name": "Weak Authentication",
              "source": "sparse",
              "original_content": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct."
            },
            "similarity": 356.7840959267941
          }
        ]
      },
      "product:Pomerium": {
        "keyphrase": "Pomerium",
        "type": "product",
        "cwes": [
          {
            "metadata": {
              "doc_id": "489",
              "name": "Active Debug Code",
              "source": "sparse",
              "original_content": "The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information."
            },
            "similarity": 423.4670669625118
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 396.68767755452495
          },
          {
            "metadata": {
              "doc_id": "201",
              "name": "Insertion of Sensitive Information Into Sent Data",
              "source": "sparse",
              "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor."
            },
            "similarity": 381.22704028604306
          },
          {
            "metadata": {
              "doc_id": "287",
              "name": "Improper Authentication",
              "source": "sparse",
              "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct."
            },
            "similarity": 357.7441245341564
          },
          {
            "metadata": {
              "doc_id": "1390",
              "name": "Weak Authentication",
              "source": "sparse",
              "original_content": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct."
            },
            "similarity": 356.7840959267941
          }
        ]
      },
      "version:prior to 0.26.1": {
        "keyphrase": "prior to 0.26.1",
        "type": "version",
        "cwes": [
          {
            "metadata": {
              "doc_id": "489",
              "name": "Active Debug Code",
              "source": "sparse",
              "original_content": "The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information."
            },
            "similarity": 409.6266463087278
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 404.5212009434408
          },
          {
            "metadata": {
              "doc_id": "201",
              "name": "Insertion of Sensitive Information Into Sent Data",
              "source": "sparse",
              "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor."
            },
            "similarity": 396.0909597858726
          },
          {
            "metadata": {
              "doc_id": "287",
              "name": "Improper Authentication",
              "source": "sparse",
              "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct."
            },
            "similarity": 372.6509444772212
          },
          {
            "metadata": {
              "doc_id": "639",
              "name": "Authorization Bypass Through User-Controlled Key",
              "source": "sparse",
              "original_content": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data."
            },
            "similarity": 371.9659849131753
          }
        ]
      },
      "component:/.pomerium endpoint": {
        "keyphrase": "/.pomerium endpoint",
        "type": "component",
        "cwes": [
          {
            "metadata": {
              "doc_id": "489",
              "name": "Active Debug Code",
              "source": "sparse",
              "original_content": "The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information."
            },
            "similarity": 423.4670669625118
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 403.38184162035964
          },
          {
            "metadata": {
              "doc_id": "201",
              "name": "Insertion of Sensitive Information Into Sent Data",
              "source": "sparse",
              "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor."
            },
            "similarity": 387.46680986814914
          },
          {
            "metadata": {
              "doc_id": "639",
              "name": "Authorization Bypass Through User-Controlled Key",
              "source": "sparse",
              "original_content": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data."
            },
            "similarity": 361.57426083575484
          },
          {
            "metadata": {
              "doc_id": "923",
              "name": "Improper Restriction of Communication Channel to Intended Endpoints",
              "source": "sparse",
              "original_content": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint.",
              "keyphrase_sources": [
                {
                  "id": "component:/.pomerium endpoint",
                  "keyphrase": "/.pomerium endpoint",
                  "type": "component"
                }
              ]
            },
            "similarity": 360.0758469047394
          }
        ]
      }
    },
    "keyphrase_mapping": {
      "489": [
        {
          "id": "weakness:cross-site scripting",
          "keyphrase": "cross-site scripting",
          "type": "weakness"
        },
        {
          "id": "weakness:information exposure",
          "keyphrase": "information exposure",
          "type": "weakness"
        },
        {
          "id": "impact:access serialized OAuth2 access and ID tokens",
          "keyphrase": "access serialized OAuth2 access and ID tokens",
          "type": "impact"
        },
        {
          "id": "impact:impersonation",
          "keyphrase": "impersonation",
          "type": "impact"
        },
        {
          "id": "product:Pomerium",
          "keyphrase": "Pomerium",
          "type": "product"
        },
        {
          "id": "version:prior to 0.26.1",
          "keyphrase": "prior to 0.26.1",
          "type": "version"
        },
        {
          "id": "component:/.pomerium endpoint",
          "keyphrase": "/.pomerium endpoint",
          "type": "component"
        }
      ],
      "863": [
        {
          "id": "weakness:cross-site scripting",
          "keyphrase": "cross-site scripting",
          "type": "weakness"
        },
        {
          "id": "weakness:information exposure",
          "keyphrase": "information exposure",
          "type": "weakness"
        },
        {
          "id": "impact:access serialized OAuth2 access and ID tokens",
          "keyphrase": "access serialized OAuth2 access and ID tokens",
          "type": "impact"
        },
        {
          "id": "impact:impersonation",
          "keyphrase": "impersonation",
          "type": "impact"
        },
        {
          "id": "product:Pomerium",
          "keyphrase": "Pomerium",
          "type": "product"
        },
        {
          "id": "version:prior to 0.26.1",
          "keyphrase": "prior to 0.26.1",
          "type": "version"
        },
        {
          "id": "component:/.pomerium endpoint",
          "keyphrase": "/.pomerium endpoint",
          "type": "component"
        }
      ],
      "79": [
        {
          "id": "weakness:cross-site scripting",
          "keyphrase": "cross-site scripting",
          "type": "weakness"
        }
      ],
      "201": [
        {
          "id": "weakness:cross-site scripting",
          "keyphrase": "cross-site scripting",
          "type": "weakness"
        },
        {
          "id": "weakness:information exposure",
          "keyphrase": "information exposure",
          "type": "weakness"
        },
        {
          "id": "impact:access serialized OAuth2 access and ID tokens",
          "keyphrase": "access serialized OAuth2 access and ID tokens",
          "type": "impact"
        },
        {
          "id": "impact:impersonation",
          "keyphrase": "impersonation",
          "type": "impact"
        },
        {
          "id": "product:Pomerium",
          "keyphrase": "Pomerium",
          "type": "product"
        },
        {
          "id": "version:prior to 0.26.1",
          "keyphrase": "prior to 0.26.1",
          "type": "version"
        },
        {
          "id": "component:/.pomerium endpoint",
          "keyphrase": "/.pomerium endpoint",
          "type": "component"
        }
      ],
      "639": [
        {
          "id": "weakness:cross-site scripting",
          "keyphrase": "cross-site scripting",
          "type": "weakness"
        },
        {
          "id": "weakness:information exposure",
          "keyphrase": "information exposure",
          "type": "weakness"
        },
        {
          "id": "version:prior to 0.26.1",
          "keyphrase": "prior to 0.26.1",
          "type": "version"
        },
        {
          "id": "component:/.pomerium endpoint",
          "keyphrase": "/.pomerium endpoint",
          "type": "component"
        }
      ],
      "287": [
        {
          "id": "weakness:information exposure",
          "keyphrase": "information exposure",
          "type": "weakness"
        },
        {
          "id": "impact:access serialized OAuth2 access and ID tokens",
          "keyphrase": "access serialized OAuth2 access and ID tokens",
          "type": "impact"
        },
        {
          "id": "impact:impersonation",
          "keyphrase": "impersonation",
          "type": "impact"
        },
        {
          "id": "product:Pomerium",
          "keyphrase": "Pomerium",
          "type": "product"
        },
        {
          "id": "version:prior to 0.26.1",
          "keyphrase": "prior to 0.26.1",
          "type": "version"
        }
      ],
      "1390": [
        {
          "id": "impact:access serialized OAuth2 access and ID tokens",
          "keyphrase": "access serialized OAuth2 access and ID tokens",
          "type": "impact"
        },
        {
          "id": "impact:impersonation",
          "keyphrase": "impersonation",
          "type": "impact"
        },
        {
          "id": "product:Pomerium",
          "keyphrase": "Pomerium",
          "type": "product"
        }
      ],
      "923": [
        {
          "id": "component:/.pomerium endpoint",
          "keyphrase": "/.pomerium endpoint",
          "type": "component"
        }
      ]
    },
    "relevant_cwes": [
      {
        "metadata": {
          "doc_id": "489",
          "name": "Active Debug Code",
          "source": "sparse",
          "original_content": "The product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information.",
          "keyphrase_sources": [
            {
              "id": "weakness:cross-site scripting",
              "keyphrase": "cross-site scripting",
              "type": "weakness"
            },
            {
              "id": "weakness:information exposure",
              "keyphrase": "information exposure",
              "type": "weakness"
            },
            {
              "id": "impact:access serialized OAuth2 access and ID tokens",
              "keyphrase": "access serialized OAuth2 access and ID tokens",
              "type": "impact"
            },
            {
              "id": "impact:impersonation",
              "keyphrase": "impersonation",
              "type": "impact"
            },
            {
              "id": "product:Pomerium",
              "keyphrase": "Pomerium",
              "type": "product"
            },
            {
              "id": "version:prior to 0.26.1",
              "keyphrase": "prior to 0.26.1",
              "type": "version"
            },
            {
              "id": "component:/.pomerium endpoint",
              "keyphrase": "/.pomerium endpoint",
              "type": "component"
            }
          ]
        },
        "similarity": 1122.2617101318685
      },
      {
        "metadata": {
          "doc_id": "863",
          "name": "Incorrect Authorization",
          "source": "sparse",
          "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.",
          "keyphrase_sources": [
            {
              "id": "weakness:cross-site scripting",
              "keyphrase": "cross-site scripting",
              "type": "weakness"
            },
            {
              "id": "weakness:information exposure",
              "keyphrase": "information exposure",
              "type": "weakness"
            },
            {
              "id": "impact:access serialized OAuth2 access and ID tokens",
              "keyphrase": "access serialized OAuth2 access and ID tokens",
              "type": "impact"
            },
            {
              "id": "impact:impersonation",
              "keyphrase": "impersonation",
              "type": "impact"
            },
            {
              "id": "product:Pomerium",
              "keyphrase": "Pomerium",
              "type": "product"
            },
            {
              "id": "version:prior to 0.26.1",
              "keyphrase": "prior to 0.26.1",
              "type": "version"
            },
            {
              "id": "component:/.pomerium endpoint",
              "keyphrase": "/.pomerium endpoint",
              "type": "component"
            }
          ]
        },
        "similarity": 1102.2413269823949
      },
      {
        "metadata": {
          "doc_id": "79",
          "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
          "source": "sparse",
          "original_content": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
          "keyphrase_sources": [
            {
              "id": "weakness:cross-site scripting",
              "keyphrase": "cross-site scripting",
              "type": "weakness"
            }
          ]
        },
        "similarity": 1080.1022915480125
      },
      {
        "metadata": {
          "doc_id": "201",
          "name": "Insertion of Sensitive Information Into Sent Data",
          "source": "sparse",
          "original_content": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor.",
          "keyphrase_sources": [
            {
              "id": "weakness:cross-site scripting",
              "keyphrase": "cross-site scripting",
              "type": "weakness"
            },
            {
              "id": "weakness:information exposure",
              "keyphrase": "information exposure",
              "type": "weakness"
            },
            {
              "id": "impact:access serialized OAuth2 access and ID tokens",
              "keyphrase": "access serialized OAuth2 access and ID tokens",
              "type": "impact"
            },
            {
              "id": "impact:impersonation",
              "keyphrase": "impersonation",
              "type": "impact"
            },
            {
              "id": "product:Pomerium",
              "keyphrase": "Pomerium",
              "type": "product"
            },
            {
              "id": "version:prior to 0.26.1",
              "keyphrase": "prior to 0.26.1",
              "type": "version"
            },
            {
              "id": "component:/.pomerium endpoint",
              "keyphrase": "/.pomerium endpoint",
              "type": "component"
            }
          ]
        },
        "similarity": 1079.8491688816603
      },
      {
        "metadata": {
          "doc_id": "639",
          "name": "Authorization Bypass Through User-Controlled Key",
          "source": "sparse",
          "original_content": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
          "keyphrase_sources": [
            {
              "id": "weakness:cross-site scripting",
              "keyphrase": "cross-site scripting",
              "type": "weakness"
            },
            {
              "id": "weakness:information exposure",
              "keyphrase": "information exposure",
              "type": "weakness"
            },
            {
              "id": "version:prior to 0.26.1",
              "keyphrase": "prior to 0.26.1",
              "type": "version"
            },
            {
              "id": "component:/.pomerium endpoint",
              "keyphrase": "/.pomerium endpoint",
              "type": "component"
            }
          ]
        },
        "similarity": 1018.6276982002903
      },
      {
        "metadata": {
          "doc_id": "287",
          "name": "Improper Authentication",
          "source": "sparse",
          "original_content": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
          "keyphrase_sources": [
            {
              "id": "weakness:information exposure",
              "keyphrase": "information exposure",
              "type": "weakness"
            },
            {
              "id": "impact:access serialized OAuth2 access and ID tokens",
              "keyphrase": "access serialized OAuth2 access and ID tokens",
              "type": "impact"
            },
            {
              "id": "impact:impersonation",
              "keyphrase": "impersonation",
              "type": "impact"
            },
            {
              "id": "product:Pomerium",
              "keyphrase": "Pomerium",
              "type": "product"
            },
            {
              "id": "version:prior to 0.26.1",
              "keyphrase": "prior to 0.26.1",
              "type": "version"
            }
          ]
        },
        "similarity": 1011.0991712185495
      },
      {
        "metadata": {
          "doc_id": "1390",
          "name": "Weak Authentication",
          "source": "sparse",
          "original_content": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct.",
          "keyphrase_sources": [
            {
              "id": "impact:access serialized OAuth2 access and ID tokens",
              "keyphrase": "access serialized OAuth2 access and ID tokens",
              "type": "impact"
            },
            {
              "id": "impact:impersonation",
              "keyphrase": "impersonation",
              "type": "impact"
            },
            {
              "id": "product:Pomerium",
              "keyphrase": "Pomerium",
              "type": "product"
            }
          ]
        },
        "similarity": 384.83903215770914
      },
      {
        "metadata": {
          "doc_id": "923",
          "name": "Improper Restriction of Communication Channel to Intended Endpoints",
          "source": "sparse",
          "original_content": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint.",
          "keyphrase_sources": [
            {
              "id": "component:/.pomerium endpoint",
              "keyphrase": "/.pomerium endpoint",
              "type": "component"
            }
          ]
        },
        "similarity": 360.0758469047394
      }
    ],
    "enhanced_query": "# Vulnerability Description\n\n    Pomerium is an identity and context-aware access proxy. Prior to version 0.26.1, the Pomerium user info page (at `/.pomerium`) unintentionally included serialized OAuth2 access and ID tokens from the logged-in users session. These tokens are not intended to be exposed to end users. This issue may be more severe in the presence of a **cross-site scripting** vulnerability in an upstream application proxied through Pomerium. If an attacker could insert a malicious script onto a web page proxied through Pomerium, that script could access these tokens by making a request to the `/.pomerium` endpoint. Upstream applications that authenticate only the ID token may be vulnerable to user impersonation using a token obtained in this manner. Note that an OAuth2 access token or ID token by itself is not sufficient to hijack a users Pomerium session. Upstream applications should not be vulnerable to user impersonation via these tokens provided the application verifies the Pomerium JWT for each request, the connection between Pomerium and the application is secured by mTLS, or the connection between Pomerium and the application is otherwise secured at the network layer. The issue is patched in Pomerium v0.26.1. No known workarounds are available.\n\n    # Keyphrase-Specific CWE Analysis\n    This vulnerability contains multiple keyphrases that may map to different CWEs. \n    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.\n\n    ## WEAKNESS: 'cross-site scripting'\n\nRelevant CWEs for this WEAKNESS:\n\n### 1. CWE-489: Active Debug Code (Score: 1122.26)\n\nThe product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1102.24)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') (Score: 1080.10)\n\nThe product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users....\n\n### 4. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 1079.85)\n\nThe code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....\n\n### 5. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 1018.63)\n\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....\n\n## WEAKNESS: 'information exposure'\n\nRelevant CWEs for this WEAKNESS:\n\n### 1. CWE-489: Active Debug Code (Score: 1122.26)\n\nThe product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1102.24)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 1079.85)\n\nThe code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....\n\n### 4. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 1018.63)\n\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....\n\n### 5. CWE-287: Improper Authentication (Score: 1011.10)\n\nWhen an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....\n\n## IMPACT: 'access serialized OAuth2 access and ID tokens'\n\nRelevant CWEs for this IMPACT:\n\n### 1. CWE-489: Active Debug Code (Score: 1122.26)\n\nThe product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1102.24)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 1079.85)\n\nThe code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....\n\n### 4. CWE-287: Improper Authentication (Score: 1011.10)\n\nWhen an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....\n\n### 5. CWE-1390: Weak Authentication (Score: 384.84)\n\nThe product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....\n\n## IMPACT: 'impersonation'\n\nRelevant CWEs for this IMPACT:\n\n### 1. CWE-489: Active Debug Code (Score: 1122.26)\n\nThe product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1102.24)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 1079.85)\n\nThe code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....\n\n### 4. CWE-287: Improper Authentication (Score: 1011.10)\n\nWhen an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....\n\n### 5. CWE-1390: Weak Authentication (Score: 384.84)\n\nThe product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....\n\n## PRODUCT: 'Pomerium'\n\nRelevant CWEs for this PRODUCT:\n\n### 1. CWE-489: Active Debug Code (Score: 1122.26)\n\nThe product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1102.24)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 1079.85)\n\nThe code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....\n\n### 4. CWE-287: Improper Authentication (Score: 1011.10)\n\nWhen an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....\n\n### 5. CWE-1390: Weak Authentication (Score: 384.84)\n\nThe product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....\n\n## VERSION: 'prior to 0.26.1'\n\nRelevant CWEs for this VERSION:\n\n### 1. CWE-489: Active Debug Code (Score: 1122.26)\n\nThe product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1102.24)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 1079.85)\n\nThe code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....\n\n### 4. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 1018.63)\n\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....\n\n### 5. CWE-287: Improper Authentication (Score: 1011.10)\n\nWhen an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....\n\n## COMPONENT: '/.pomerium endpoint'\n\nRelevant CWEs for this COMPONENT:\n\n### 1. CWE-489: Active Debug Code (Score: 1122.26)\n\nThe product is deployed to unauthorized actors with debugging code still enabled or active, which can create unintended entry points or expose sensitive information....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1102.24)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 1079.85)\n\nThe code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....\n\n### 4. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 1018.63)\n\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....\n\n### 5. CWE-923: Improper Restriction of Communication Channel to Intended Endpoints (Score: 360.08)\n\nThe product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint....\n\n\n    # Analysis Instructions\n    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.\n    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.\n    3. Provide a final determination of primary CWE(s) and any secondary CWEs.\n    4. Format your response using the standard analysis template.\n\n    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.\n    "
  },
  "retrieval_time": 2.069957971572876
}