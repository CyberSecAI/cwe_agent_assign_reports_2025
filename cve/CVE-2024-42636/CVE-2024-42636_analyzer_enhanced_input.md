## Vulnerability Description
DedeCMS V5.7.115 has a command execution vulnerability via file_manage_view.php?fmdo=newfile&activepath.

### Vulnerability Description Key Phrases
- **impact:** command execution
- **product:** DedeCMS
- **version:** V5.7.115
- **component:** file_manage_view.php

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Vulnerability:** Command Execution

**Affected Software:** DedeCMS V5.7.115

**Root Cause:** The vulnerability stems from insufficient filtering of uploaded files within the file manager of DedeCMS. Specifically, the system attempts to block certain PHP functions and constructs, but this filter can be bypassed through filename truncation.

**Weaknesses/Vulnerabilities Present:**
*   **Inadequate Input Validation:** The file manager does not properly validate or sanitize the filename and content of uploaded files.
*   **Bypassable Filter:** The implemented blacklist of functions and constructs can be bypassed by manipulating the filename (truncation).

**Impact of Exploitation:**
*   **Arbitrary Command Execution:** Attackers can execute arbitrary system commands on the server hosting the vulnerable DedeCMS instance.
*   **Full System Compromise:** Successful exploitation could lead to complete compromise of the server, including data theft, website defacement, and further malicious activities.

**Attack Vectors:**
1.  **File Upload:**
    *   Attackers need to access the file manager within the DedeCMS backend, which is usually behind authentication. The file manager can be accessed directly via `http://<website_address>/dede/file_manage_view.php?fmdo=newfile&activepath=`.
    *   An attacker uploads a file with a truncated filename (e.g., `system.php`) containing malicious PHP code. The code is designed to execute the `system()` function or other malicious commands
2.  **HTTP Request:**
   *  The attacker sends a crafted HTTP POST request to `/dede/file_manage_control.php` to save the file containing the malicious code.

**Required Attacker Capabilities/Position:**
*   **Authentication to the DedeCMS backend:** The attacker needs to have administrative access or a valid session to access the file manager section in the backend. This can be achieved if the attacker has valid login credentials.
*  **Ability to craft HTTP requests:** The attacker should be able to send POST requests with the required parameters to exploit the vulnerability.

**Technical Details:**

*   The content filter is implemented in the file `dede/file_manage_control.php` between lines 28-54. It uses `preg_replace` and a blacklist of functions and constructs (`$cfg_disable_funs`) to filter out potentially malicious code.
*   The bypass is achieved by using a filename like `system.php` and utilizing `substr(__FILE__, -10, 6)` to dynamically call the system function. This bypasses the filters because it does not explicitly use the function name `system` in the code.

**Additional Details from the Content:**
*   The provided content includes Proof of Concept (POC) demonstrating a successful attack.
*   The issue was reported on GitHub and subsequently closed and locked as resolved by the repository owner.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.031 |
| 2 | 27 | Path Traversal: 'dir/../../filename' | Variant | Allowed | sparse | 0.024 |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.021 |
| 4 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.020 |
| 5 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.020 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.018 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.017 |
| 8 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | sparse | 0.016 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.575 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-27: Path Traversal: 'dir/../../filename'

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-790: Improper Filtering of Special Elements

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-425: Direct Request ('Forced Browsing')