## Vulnerability Description
Zitadel is open-source identity infrastructure software. ZITADEL administrators can enable a setting called Ignoring unknown usernames which helps mitigate attacks that try to guess/enumerate usernames. If enabled, ZITADEL will show the password prompt even if the user doesnt exist and report Username or Password invalid. While the setting was correctly respected during the login flow, the users username was normalized leading to a disclosure of the users existence. This vulnerability is fixed in 2.71.6, 2.70.8, 2.69.9, 2.68.9, 2.67.13, 2.66.16, 2.65.7, 2.64.6, and 2.63.9.

### Vulnerability Description Key Phrases
- **weakness:** **username normalization**
- **impact:** disclosure of users existence
- **product:** Zitadel
- **component:** login flow

## CVE Reference Links Content Summary
CVE-2025-31124

**Vulnerability Description:**

The content details a user enumeration vulnerability in zitadel. The vulnerability stems from the removal of username normalization during the login process. Previously, a setting "Ignoring unknown usernames" was intended to prevent username enumeration, but the normalization process bypassed this protection, revealing whether a username existed.

**Root Cause:**

The root cause is the removal of username normalization during the login flow, which allowed an attacker to determine if a username exists within the system.

**Weaknesses/Vulnerabilities:**

*   User Enumeration: An attacker can enumerate valid usernames.

**Impact:**

Disclosure of user existence.

**Attack Vectors:**

An attacker can attempt to log in with various usernames to determine which ones are valid.

**Required Attacker Capabilities/Position:**

No special privileges or access are required. The attack can be performed remotely.

**Mitigation/Fix:**

Update to a patched version:

*   2.71.6 or later
*   2.70.8 or later
*   2.69.9 or later
*   2.68.9 or later
*   2.67.13 or later
*   2.66.16 or later
*   2.65.7 or later
*   2.64.6 or later
*   2.63.9 or later

The fix involves removing the normalization of usernames during the login process.

**Additional Details:**

*   **CVE ID:** CVE-2025-31124
*   **CVSS Score:** Moderate
*   The vulnerability was reported by Ivan Jedek.
*   The vulnerability affects versions prior to 2.71.6, 2.70.8, 2.69.9, 2.68.9, 2.67.13, 2.66.16, 2.65.7, 2.64.6, and 2.63.9.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 204 | Observable Response Discrepancy | Base | Allowed | sparse | 0.510 |
| 2 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.474 |
| 3 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.453 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.445 |
| 5 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.440 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.431 |
| 7 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.431 |
| 8 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.428 |
| 9 | 620 | Unverified Password Change | Base | Allowed | dense | 0.463 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-204: Observable Response Discrepancy

CWE-208: Observable Timing Discrepancy

CWE-287: Improper Authentication

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-203: Observable Discrepancy

CWE-1390: Weak Authentication

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-522: Insufficiently Protected Credentials

CWE-620: Unverified Password Change

CWE-613: Insufficient Session Expiration