# Vulnerability Information: CVE-2024-48899

## Vulnerability Description
A vulnerability was found in Moodle. Additional checks are required to ensure users can only fetch the list of course badges for courses that they are intended to have access to.

### Vulnerability Description Key Phrases
- **impact:** only fetch list of course badges for courses they have access to
- **attacker:** users
- **product:** Moodle

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-48899:

**Root cause of vulnerability:**
- The vulnerability is an Insecure Direct Object Reference (IDOR) issue in Moodle.

**Weaknesses/vulnerabilities present:**
- Insufficient access control checks when fetching lists of course badges. Specifically, users can access lists of course badges for courses they should not have access to.

**Impact of exploitation:**
- An attacker could potentially view information about course badges related to courses they are not enrolled in. This could reveal sensitive information about other courses.

**Attack vectors:**
- The vulnerability is triggered by accessing the list of course badges through a Moodle function or API call, without proper authorization checks.

**Required attacker capabilities/position:**
- The attacker needs to be a valid user on the Moodle platform. They don't need elevated privileges, but must have a valid account in the system to be able to make the request.

**Additional notes:**

- The Red Hat bug report indicates that additional checks are required to ensure users can only fetch the list of course badges for courses that they are intended to have access to.
- The bug report also shows that the CVE is related to bug 2318827

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.070 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.063 |
| 3 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.060 |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.060 |
| 5 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.059 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.059 |
| 7 | 214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | sparse | 0.058 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.058 |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | dense | 0.533 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.003 |

