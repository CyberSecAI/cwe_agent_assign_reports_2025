## Vulnerability Description
Corosync through 3.1.9, if encryption is disabled or the attacker knows the encryption key, has a **stack-based buffer overflow** in orf_token_endian_convert in exec/totemsrp.c via a large UDP packet.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **vector:** large UDP packet
- **product:** Corosync
- **version:** through 3.1.9
- **component:** orf_token_endian_convert in exec/totemsrp.c

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on potential vulnerabilities:

**Analysis of github.com_24819aaa_20250624_170109.html:**

*   **Vulnerability:** Stack-based buffer overflow
*   **Root Cause:** The `orf_token_endian_convert` function in `totemsrp.c` fails to properly check the size of `orf_token->rtr_list_entries` against the size of the `token_convert` buffer (1500 bytes) in `message_handler_orf_token`. This allows a remote user to send a crafted packet that overflows the buffer.
*   **Weakness/Vulnerability:** Stack buffer overflow.
*   **Impact:** Process crash or potentially arbitrary code execution.
*   **Attack Vector:** A remote attacker can send a specially crafted ORF\_TOKEN message with a large `rtr_list_entries` value.
*   **Required Attacker Capabilities/Position:** The attacker needs to be able to send network packets to the Corosync cluster. This likely requires network access to the cluster.
*   **Mitigation/Fix:** Not explicitly mentioned in this content.

**Summary**

The content describes a stack-based buffer overflow vulnerability in the Corosync Cluster Engine, specifically within the `orf_token_endian_convert` function, caused by a lack of size validation. This vulnerability allows for a denial-of-service (process crash) or potential arbitrary code execution. The attack involves sending a crafted ORF\_TOKEN message with a maliciously large `rtr_list_entries` value.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.239 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.228 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.215 |
| 6 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.208 |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.205 |
| 8 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.205 |
| 9 | 294 | Authentication Bypass by Capture-replay | Base | Allowed | dense | 0.543 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-121: Stack-based Buffer Overflow

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-193: Off-by-one Error

CWE-789: Memory Allocation with Excessive Size Value

CWE-126: Buffer Over-read

CWE-294: Authentication Bypass by Capture-replay

CWE-128: Wrap-around Error