# Vulnerability Information: CVE-2024-36420

## Vulnerability Description
Flowise is a drag & drop user interface to build a customized large language model flow. In version 1.4.3 of Flowise, the `/api/v1/openai-assistants-file` endpoint in `index.ts` is vulnerable to arbitrary file read due to **lack of sanitization** of the `fileName` body parameter. No known patches for this issue are available.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of sanitization**
- **impact:** arbitrary file read
- **product:** Flowise
- **version:** 1.4.3
- **component:** /api/v1/openai-assistants-file endpoint

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-36420:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a lack of sanitization of the `fileName` body parameter in the `/api/v1/openai-assistants-file` endpoint.

**Weaknesses/Vulnerabilities Present:**

*   **Path Injection:** The application directly uses the provided `fileName` from the request body to construct a file path, without proper validation or sanitization. This allows an attacker to manipulate the path, potentially accessing files outside the intended directory.

**Impact of Exploitation:**

*   **Arbitrary File Read:** Successful exploitation allows an attacker to read arbitrary files from the Flowise server's file system. This could include sensitive configuration files, user data, or other confidential information.

**Attack Vectors:**

*   An attacker can send a crafted POST request to the `/api/v1/openai-assistants-file` endpoint, including a malicious `fileName` parameter in the request body, to traverse directories and read arbitrary files.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to send HTTP POST requests to the vulnerable endpoint.
*   The attacker does not need to be authenticated if the default unauthenticated configuration is used.

**Additional Information:**

*   This vulnerability is identified as `GHSL-2023-232`.
*   The vulnerability exists in the `index.ts` file of the Flowise server.
*   The vulnerable code snippet is located around line 982, constructing the file path using `path.join(getUserHome(), '.flowise', 'openai-assistant', req.body.fileName)`.
*   The vulnerability is present in version `v1.4.3` of Flowise.
*   This vulnerability may be chained with XSS and CORS vulnerabilities to allow attackers without direct access to the Flowise server to read files.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.358 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.326 |
| 3 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.311 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.310 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.303 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.302 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.301 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.301 |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.424 |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | graph | 0.003 |

