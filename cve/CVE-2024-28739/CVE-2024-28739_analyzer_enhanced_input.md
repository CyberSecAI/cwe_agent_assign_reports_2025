## Vulnerability Description
An issue in Koha ILS 23.05 and before allows a remote attacker to execute arbitrary code via a crafted script to the format parameter.

### Vulnerability Description Key Phrases
- **impact:** execute arbitrary code
- **vector:** crafted script to the format parameter
- **attacker:** remote attacker
- **product:** Koha ILS
- **version:** 23.05 and before

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The vulnerability is present in the Task Scheduler feature, which allows arbitrary input from the user and appends it to a system command.",
  "Weaknesses/vulnerabilities present": [
    "Arbitrary command injection",
     "Cross-Site Scripting (XSS)"
    ],
  "Impact of exploitation": "An attacker can execute arbitrary commands on the system at the scheduled time. The XSS vulnerability can be used to bypass CSRF protections in Koha, steal the CSRF token, change username and password to completely takeover the Admin Staff account. If the plugin upload feature is enabled, the attacker can upload a malicious plugin to achieve RCE.",
  "Attack vectors": [
     "Modifying HTTP requests to inject arbitrary system commands via the `format` parameter in Task Scheduler",
     "Crafting a malicious URL with JavaScript to exploit XSS vulnerability and bypass CSRF protection",
     "Uploading a malicious plugin using the plugin upload feature"
  ],
  "Required attacker capabilities/position": [
    "For the command injection: Credentials for Koha Intranet Staff Admin user or the ability to exploit an XSS vulnerability.",
    "For the XSS to RCE: Ability to craft a malicious URL that an admin user will open in their browser while having an authenticated Koha session. For plugin upload, that feature must be enabled."
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.052 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.052 |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.051 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.051 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.051 |
| 6 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.050 |
| 7 | 912 | Hidden Functionality | Class | Allowed-with-Review | sparse | 0.050 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.049 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.534 |
| 10 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-787: Out-of-bounds Write

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-121: Stack-based Buffer Overflow

CWE-23: Relative Path Traversal

CWE-36: Absolute Path Traversal

CWE-912: Hidden Functionality

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')