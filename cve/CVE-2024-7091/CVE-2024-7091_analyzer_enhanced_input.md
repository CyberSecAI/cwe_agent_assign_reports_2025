## Vulnerability Description
An issue was discovered in GitLab CE/EE affecting all versions starting from 15.6 prior to 17.0.5, starting from 17.1 prior to 17.1.3, and starting from 17.2 prior to 17.2.1 where it was possible to disclose limited information of an exported group or project to another user.

### Vulnerability Description Key Phrases
- **impact:** disclose limited information of an exported group or project
- **product:** GitLab CE/EE
- **version:** all versions starting from 15.6 prior to 17.0.5, starting from 17.1 prior to 17.1.3, and starting from 17.2 prior to 17.2.1

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
The vulnerability arises from a flaw in how GitLab handles authorization during project/group exports. While authorization checks are performed for the user initiating the export, the exported file itself is not protected, making its content accessible to unauthorized users. This bypasses the intended access controls that would normally restrict visibility of certain resources (e.g., epic parent information).

**Weaknesses/Vulnerabilities Present:**
- **Insufficient Access Control:** The core weakness is the lack of access control on exported files.  The assumption that only authorized users can access the export functionality does not account for the fact that other users can download the generated files.
- **Information Exposure:** The vulnerability allows the exposure of sensitive information that should be restricted to authorized users only. Specifically, parent epic information is leaked which the downloading user is otherwise not authorized to see.

**Impact of Exploitation:**
- **Information Disclosure:** Unauthorized users can gain access to data they are not permitted to see. This can include details like parent epics, notes, and potentially other hidden resources included in the export.
- **Circumvention of Access Controls:** The vulnerability undermines the intended security measures implemented by GitLab, bypassing the authorization checks that aim to limit access to sensitive information.
- **Potential for Sensitive Data Leakage**: The data contained in the export files could reveal sensitive project information, development strategies, or confidential discussions depending on what's included.

**Attack Vectors:**
- **Direct Access to Exported Files:** An attacker simply needs to have access to the exported files.  This can be achieved by another user within the group that is authorized to export the data, which can then be shared with an unauthorized user or an attacker that has gained access to a location where these files have been downloaded to.

**Required Attacker Capabilities/Position:**
- **Knowledge of Exported Files Location:** An attacker must have some way of gaining access to the exported file, or have a user share it with them.  This could be via:
    - An insider threat: An authorized user could intentionally share these files.
    - File System Access: If an attacker were able to gain access to the file system on the server where these exports are being stored, they would have access to the files themselves.
    - Access to a user that has downloaded an export.

**Additional Notes:**
- The provided example specifically highlights the exposure of parent epic information, but the vulnerability may extend to other types of protected resources included in the exports.
- The description mentions merge requests that implement filtering, this indicates the intention to protect these resources.
- The steps to reproduce the issue are clear and concise and outline an easy to execute attack scenario.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.128 |
| 2 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.127 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.122 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.122 |
| 5 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.120 |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.111 |
| 7 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.109 |
| 8 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.108 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.550 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-696: Incorrect Behavior Order

CWE-285: Improper Authorization

CWE-863: Incorrect Authorization

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-400: Uncontrolled Resource Consumption

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-1333: Inefficient Regular Expression Complexity

CWE-1286: Improper Validation of Syntactic Correctness of Input

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-410: Insufficient Resource Pool