{
  "cve_id": "CVE-2025-2090",
  "description": "A vulnerability was found in PHPGurukul Pre-School Enrollment System 1.0 and classified as critical. Affected by this issue is some unknown functionality of the file /admin/add-subadmin.php of the component Sub Admin Handler. The manipulation leads to **improper access controls**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.",
  "key_phrases": {
    "rootcause": "improper access controls",
    "weakness": "",
    "impact": "",
    "vector": "",
    "attacker": "",
    "product": "PHPGurukul Pre-School Enrollment System",
    "version": "1.0",
    "component": "/admin/add-subadmin.php of the component Sub Admin Handler"
  },
  "reference_content": "```\nROOT CAUSE:\n*   There is a vertical override vulnerability in the /admin/add-subadmin.php system. In the system design, only super administrators can add sub administrators, but due to the lack of verification of user session identity in request verification, resulting in low privileged users being able to successfully send requests to add sub administrators directly.\n\nWEAKNESSES/VULNERABILITIES PRESENT:\n*   Access control vulnerability.\n\nIMPACT OF EXPLOITATION:\n*   The system does not have strict permission verification, resulting in the creation of unauthorized users, bringing information leakage and management risks.\n\nATTACK VECTORS:\n*   A low-privileged user can send a request to add a sub-administrator.\n\nREQUIRED ATTACKER CAPABILITIES/POSITION:\n*   Low-privileged user.\n\nMITIGATION OR FIX:\n*   Regarding access control vulnerabilities, suggestions are provided from three key aspects: authentication and authorization, session and token management, and secure coding and development. In terms of authentication and authorization, multi-factor authentication, role-based access control, and fine-grained permission management are adopted to ensure the authenticity of user identities and the rationality of permissions. For session and token management, access security is guaranteed through secure session policies, encrypted tokens, and regular token refreshing and revocation. In the secure coding and development phase, following standards, regularly reviewing code, and using secure frameworks and libraries reduce the risk of privilege escalation vulnerabilities.\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-284 | Improper Access Control | 1 | Base | Primary | Allowed |\n| CWE-306 | Missing Authentication for Critical Function | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **improper access control** (CWE-284), which is a fundamental security flaw. The vulnerability occurs because the system **lacks verification of user session identity**, allowing low-privileged users to add sub-administrators. This is related to **missing authentication** (CWE-306) since proper authentication would establish the user's identity before granting privileges.\n\n```mermaid\ngraph TD\n    cwe284[\"CWE-284: Improper Access Control\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    \n    cwe284 -->|REQUIRES| cwe306\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe284 primary\n    class cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **lack of user session identity verification**, which leads to **missing authentication**. This **missing authentication** directly causes the **improper access control**, allowing unauthorized users to perform administrative actions.\n\n`Missing Authentication` -> `Improper Access Control` -> `Unauthorized User Creation` -> `Information Leakage and Management Risks`\n\n## Summary of Analysis\nThe primary CWE is CWE-284 (Improper Access Control). The vulnerability description and the CVE reference summary clearly state that the root cause is the **improper access controls** due to the **lack of verification of user session identity**. This allows low-privileged users to perform actions they should not be authorized to do, such as adding sub-administrators. CWE-306 (Missing Authentication for Critical Function) is a secondary CWE, as the **missing authentication** is a prerequisite for the **improper access control** to occur.\n\nThe evidence for CWE-284 is found in the \"Vulnerability Description Key Phrases\" section, which states: \"**rootcause:** **improper access controls**\". Further evidence is in the \"CVE Reference Links Content Summary\" section, which states: \"due to the **lack of verification of user session identity** in request verification, resulting in low privileged users being able to successfully send requests to add sub administrators directly.\"\n\nThe abstraction level for both CWE-284 and CWE-306 is Base, which is the preferred level.\n\nOther CWEs Considered:\n*   CWE-425 (Direct Request ('Forced Browsing')): Similar to CWE-284, but CWE-284 more directly addresses the **improper access control**.\n*   CWE-639 (Authorization Bypass Through User-Controlled Key): Not applicable because the vulnerability does not involve modification of a key value.\n*   CWE-306 (Missing Authentication for Critical Function): Considered as a secondary CWE because the **lack of authentication** is a prerequisite for the **improper access control**.\n*   CWE-89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')): Not relevant, as there is no mention of SQL injection in the description.\n*   CWE-79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')): Not relevant, as there is no mention of cross-site scripting in the description.\n*   CWE-434 (Unrestricted Upload of File with Dangerous Type): Not relevant, as there is no mention of file uploads in the description.\n*   CWE-73 (External Control of File Name or Path): Not relevant, as there is no mention of file name or path manipulation in the description.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-284 | Improper Access Control | 1 | Base | Primary | Allowed |\n| CWE-306 | Missing Authentication for Critical Function | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **improper access control** (CWE-284), which is a fundamental security flaw. The vulnerability occurs because the system **lacks verification of user session identity**, allowing low-privileged users to add sub-administrators. This is related to **missing authentication** (CWE-306) since proper authentication would establish the user's identity before granting privileges.\n\n```mermaid\ngraph TD\n    cwe284[\"CWE-284: Improper Access Control\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    \n    cwe284 -->|REQUIRES| cwe306\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe284 primary\n    class cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **lack of user session identity verification**, which leads to **missing authentication**. This **missing authentication** directly causes the **improper access control**, allowing unauthorized users to perform administrative actions.\n\n`Missing Authentication` -> `Improper Access Control` -> `Unauthorized User Creation` -> `Information Leakage and Management Risks`\n\n## Summary of Analysis\nThe primary CWE is CWE-284 (Improper Access Control). The vulnerability description and the CVE reference summary clearly state that the root cause is the **improper access controls** due to the **lack of verification of user session identity**. This allows low-privileged users to perform actions they should not be authorized to do, such as adding sub-administrators. CWE-306 (Missing Authentication for Critical Function) is a secondary CWE, as the **missing authentication** is a prerequisite for the **improper access control** to occur.\n\nThe evidence for CWE-284 is found in the \"Vulnerability Description Key Phrases\" section, which states: \"**rootcause:** **improper access controls**\". Further evidence is in the \"CVE Reference Links Content Summary\" section, which states: \"due to the **lack of verification of user session identity** in request verification, resulting in low privileged users being able to successfully send requests to add sub administrators directly.\"\n\nThe abstraction level for both CWE-284 and CWE-306 is Base, which is the preferred level.\n\nOther CWEs Considered:\n*   CWE-425 (Direct Request ('Forced Browsing')): Similar to CWE-284, but CWE-284 more directly addresses the **improper access control**.\n*   CWE-639 (Authorization Bypass Through User-Controlled Key): Not applicable because the vulnerability does not involve modification of a key value.\n*   CWE-306 (Missing Authentication for Critical Function): Considered as a secondary CWE because the **lack of authentication** is a prerequisite for the **improper access control**.\n*   CWE-89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')): Not relevant, as there is no mention of SQL injection in the description.\n*   CWE-79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')): Not relevant, as there is no mention of cross-site scripting in the description.\n*   CWE-434 (Unrestricted Upload of File with Dangerous Type): Not relevant, as there is no mention of file uploads in the description.\n*   CWE-73 (External Control of File Name or Path): Not relevant, as there is no mention of file name or path manipulation in the description.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-89:**\n- 89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) - ROOT\n\n\n**Chain starting from CWE-639:**\n- 639 (Authorization Bypass Through User-Controlled Key) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "source": "sparse"
      },
      "similarity": 483.0171943038045
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 451.3227395580731
    },
    {
      "metadata": {
        "doc_id": "1391",
        "name": "Use of Weak Credentials",
        "source": "sparse"
      },
      "similarity": 387.62817713846107
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse"
      },
      "similarity": 386.0164222901172
    },
    {
      "metadata": {
        "doc_id": "705",
        "name": "Incorrect Control Flow Scoping",
        "source": "sparse"
      },
      "similarity": 384.58702428316343
    },
    {
      "metadata": {
        "doc_id": "99",
        "name": "Improper Control of Resource Identifiers ('Resource Injection')",
        "source": "sparse"
      },
      "similarity": 375.63705997290447
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 373.94611995339756
    },
    {
      "metadata": {
        "doc_id": "1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "source": "sparse"
      },
      "similarity": 371.6319608258643
    },
    {
      "metadata": {
        "doc_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "type": "Base",
        "original_content": "The web application does not sufficiently verify inputs that are assumed to be immutable but are actually externally controllable, such as hidden form fields.",
        "keyphrase_source": "rootcause:improper access controls",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.596180812233582,
            "graph": 1.6535273019400982
          }
        }
      },
      "similarity": 0.596180812233582
    },
    {
      "doc_id": "73",
      "text": "CWE-73: External Control of File Name or Path",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "type": "base",
        "original_content": "CWE-73: External Control of File Name or Path",
        "relationships": [
          {
            "source_id": "73",
            "target_id": "114",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "59",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "41",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "20",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "73",
            "target_id": "610",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "642",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "99",
            "target_id": "73",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "642",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "610",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "59",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "41",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "114",
            "target_id": "73",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "434",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "434"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "434",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "434"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "73",
                  "434",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "434"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-89",
      "CWE-639",
      "CWE-306",
      "CWE-79",
      "CWE-73",
      "CWE-284",
      "CWE-425",
      "CWE-434"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}