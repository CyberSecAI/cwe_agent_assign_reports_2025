## Vulnerability Description
In Splunk Enterprise versions 9.3.0, 9.2.3, and 9.1.6, a low-privileged user that does not hold the admin or power Splunk roles could view images on the machine that runs Splunk Enterprise by using the PDF export feature in Splunk classic dashboards. The images on the machine could be exposed by exporting the dashboard as a PDF, using the local image path in the img tag in the source extensible markup language (XML) code for the Splunk classic dashboard.

### Vulnerability Description Key Phrases
- **impact:** view images on the machine
- **vector:** exporting the dashboard as a PDF
- **attacker:** low-privileged user
- **product:** Splunk Enterprise
- **version:** 9.3.0, 9.2.3, and 9.1.6
- **component:** PDF export feature in Splunk classic dashboards

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability stems from how Splunk Enterprise's PDF export feature handles image references within classic dashboards.
- Specifically, if a low-privileged user creates a classic dashboard that contains an `<img>` tag with a local file path, the PDF export process will include the content of that image file in the exported PDF.

**Weaknesses/Vulnerabilities:**

- **Improper Access Control:** Low-privileged users can potentially access files on the Splunk server that they should not have access to.
- **Path Traversal/Local File Inclusion:** The vulnerability allows inclusion of local files by using the local image path in the img tag in the source XML code for the Splunk classic dashboard.

**Impact of Exploitation:**

- **Information Disclosure:** An attacker can gain access to sensitive images or other files stored on the server by including their paths in the img tags of the dashboards and exporting to PDF.
- The severity is rated as medium because if the server does not contain directories with images, or if Splunk Web is turned off, there will be no impact.

**Attack Vectors:**

- **Network:** The attack is performed over the network by a user with access to the Splunk web interface.

**Required Attacker Capabilities/Position:**

- **Low-Privilege User:** The attacker needs to have a valid Splunk user account with low privileges that allows them to create and edit classic dashboards.
- **Access to Splunk Web:** The attacker must be able to access the Splunk web interface to create and export dashboards.

**Additional Notes:**

- The vulnerability is mitigated in Splunk Enterprise versions 9.3.1, 9.2.3, and 9.1.6 and later.
- A detection query is provided to identify potentially vulnerable dashboards.
- The provided detection logic looks for PDFs being generated and joins that with classic dashboards that contain at least one img tag.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.151 |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.148 |
| 3 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.148 |
| 4 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.145 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.144 |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.144 |
| 7 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.143 |
| 8 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.143 |
| 9 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | Allowed | dense | 0.383 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-502: Deserialization of Untrusted Data

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-306: Missing Authentication for Critical Function

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-20: Improper Input Validation

CWE-532: Insertion of Sensitive Information into Log File

CWE-612: Improper Authorization of Index Containing Sensitive Information

CWE-322: Key Exchange without Entity Authentication