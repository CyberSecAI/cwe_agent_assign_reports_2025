{
  "cve_id": "CVE-2025-37757",
  "description": "In the Linux kernel, the following vulnerability has been resolved tipc fix **memory leak** in tipc_link_xmit In case the backlog transmit queue for system-importance messages is overloaded, tipc_link_xmit() returns -ENOBUFS but the skb list is not purged. This leads to **memory leak** and failure when a skb is allocated. This commit fixes this issue by purging the skb list before tipc_link_xmit() returns.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "memory leak",
    "impact": "memory leak and failure",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "tipc_link_xmit"
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-401 | Missing Release of Memory after Effective Lifetime | 1.0 | Variant | Allowed | Primary CWE |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship identified is that CWE-401 is a variant, representing a more specific type of resource management issue. It is also a child of the class CWE-404 (Improper Resource Shutdown or Release) and parent of CWE-1091 (Missing Release of Memory on Multiple Code Paths). These relationships confirm that CWE-401 is at an appropriate level of abstraction, focusing on the specific case of memory leaks due to missing releases after the memory's effective lifetime.\n\n```mermaid\ngraph TD\n    cwe401[\"CWE-401: Missing Release of Memory after Effective Lifetime\"]\n    cwe404[\"CWE-404: Improper Resource Shutdown or Release\"]\n    cwe1091[\"CWE-1091: Missing Release of Memory on Multiple Code Paths\"]\n    \n    cwe401 -->|CHILDOF| cwe404\n    cwe1091 -->|CHILDOF| cwe401\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe401 primary\n    class cwe404,cwe1091 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain involves the following steps:\n1.  The `tipc_link_xmit()` function attempts to transmit a system-importance message.\n2.  If the backlog transmit queue is overloaded, `tipc_link_xmit()` returns -ENOBUFS.\n3.  The **skb list is not purged**, leading to a **memory leak**.\n4.  This **memory leak** causes a failure when a skb is allocated.\n\nHere, the **missing purge operation** is the root cause, directly leading to the **memory leak** which then results in allocation failure.\n\n## Summary of Analysis\nThe vulnerability description clearly indicates a **memory leak** due to the **missing release** of memory after it is no longer needed. The phrase \"**memory leak** in tipc_link_xmit. In case the backlog transmit queue for system-importance messages is overloaded, tipc_link_xmit() returns -ENOBUFS but the skb list is not purged. This leads to **memory leak** and failure when a skb is allocated\" provides direct evidence.\n\nCWE-401 (Missing Release of Memory after Effective Lifetime) aligns perfectly with this description. The CWE description states: \"The product does not sufficiently track and release allocated memory after it has been used, which slowly consumes remaining memory.\" This is precisely what's happening in the described vulnerability.\n\nThe other CWEs from the **Retriever Results** were considered but ultimately deemed less appropriate:\n*   CWE-909 (Missing Initialization of Resource): This is about uninitialized resources, not unreleased ones.\n*   CWE-833 (Deadlock): This is about concurrency issues, not memory management.\n*   CWE-667 (Improper Locking): Similar to CWE-833, this focuses on concurrency.\n*   CWE-789 (Memory Allocation with Excessive Size Value): This is about allocating too much memory initially, not failing to release it.\n*   CWE-911 (Improper Update of Reference Count): While related to resource management, the description focuses on the reference count mechanism itself, not a general memory leak.\n*   CWE-125 (Out-of-bounds Read): This is about reading memory outside allocated bounds.\n*   CWE-362 (Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')): Similar to CWE-833 and CWE-667, this focuses on concurrency.\n*   CWE-122 (Heap-based Buffer Overflow): This is about writing beyond the allocated buffer size.\n*   CWE-772 (Missing Release of Resource after Effective Lifetime): is very close, being a parent of CWE-401, and has almost the same Description. It is not as specific as CWE-401 however, as it describes missing release of a resource in general and not necessarily memory.\n\nCWE-401 is at the optimal level of specificity (Variant) and accurately captures the root cause of the vulnerability.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-401 | Missing Release of Memory after Effective Lifetime | 1.0 | Variant | Allowed | Primary CWE |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship identified is that CWE-401 is a variant, representing a more specific type of resource management issue. It is also a child of the class CWE-404 (Improper Resource Shutdown or Release) and parent of CWE-1091 (Missing Release of Memory on Multiple Code Paths). These relationships confirm that CWE-401 is at an appropriate level of abstraction, focusing on the specific case of memory leaks due to missing releases after the memory's effective lifetime.\n\n```mermaid\ngraph TD\n    cwe401[\"CWE-401: Missing Release of Memory after Effective Lifetime\"]\n    cwe404[\"CWE-404: Improper Resource Shutdown or Release\"]\n    cwe1091[\"CWE-1091: Missing Release of Memory on Multiple Code Paths\"]\n    \n    cwe401 -->|CHILDOF| cwe404\n    cwe1091 -->|CHILDOF| cwe401\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe401 primary\n    class cwe404,cwe1091 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain involves the following steps:\n1.  The `tipc_link_xmit()` function attempts to transmit a system-importance message.\n2.  If the backlog transmit queue is overloaded, `tipc_link_xmit()` returns -ENOBUFS.\n3.  The **skb list is not purged**, leading to a **memory leak**.\n4.  This **memory leak** causes a failure when a skb is allocated.\n\nHere, the **missing purge operation** is the root cause, directly leading to the **memory leak** which then results in allocation failure.\n\n## Summary of Analysis\nThe vulnerability description clearly indicates a **memory leak** due to the **missing release** of memory after it is no longer needed. The phrase \"**memory leak** in tipc_link_xmit. In case the backlog transmit queue for system-importance messages is overloaded, tipc_link_xmit() returns -ENOBUFS but the skb list is not purged. This leads to **memory leak** and failure when a skb is allocated\" provides direct evidence.\n\nCWE-401 (Missing Release of Memory after Effective Lifetime) aligns perfectly with this description. The CWE description states: \"The product does not sufficiently track and release allocated memory after it has been used, which slowly consumes remaining memory.\" This is precisely what's happening in the described vulnerability.\n\nThe other CWEs from the **Retriever Results** were considered but ultimately deemed less appropriate:\n*   CWE-909 (Missing Initialization of Resource): This is about uninitialized resources, not unreleased ones.\n*   CWE-833 (Deadlock): This is about concurrency issues, not memory management.\n*   CWE-667 (Improper Locking): Similar to CWE-833, this focuses on concurrency.\n*   CWE-789 (Memory Allocation with Excessive Size Value): This is about allocating too much memory initially, not failing to release it.\n*   CWE-911 (Improper Update of Reference Count): While related to resource management, the description focuses on the reference count mechanism itself, not a general memory leak.\n*   CWE-125 (Out-of-bounds Read): This is about reading memory outside allocated bounds.\n*   CWE-362 (Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')): Similar to CWE-833 and CWE-667, this focuses on concurrency.\n*   CWE-122 (Heap-based Buffer Overflow): This is about writing beyond the allocated buffer size.\n*   CWE-772 (Missing Release of Resource after Effective Lifetime): is very close, being a parent of CWE-401, and has almost the same Description. It is not as specific as CWE-401 however, as it describes missing release of a resource in general and not necessarily memory.\n\nCWE-401 is at the optimal level of specificity (Variant) and accurately captures the root cause of the vulnerability.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-911:**\n- 911 (Improper Update of Reference Count) - ROOT\n\n\n**Chain starting from CWE-404:**\n- 404 (Improper Resource Shutdown or Release) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "401",
        "name": "Missing Release of Memory after Effective Lifetime",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Memory Leak",
        "match_reason": "exact_match_whole_phrase"
      },
      "similarity": 1000.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "909",
        "name": "Missing Initialization of Resource",
        "source": "sparse"
      },
      "similarity": 336.336626939249
    },
    {
      "metadata": {
        "doc_id": "833",
        "name": "Deadlock",
        "source": "sparse"
      },
      "similarity": 334.20921765341234
    },
    {
      "metadata": {
        "doc_id": "667",
        "name": "Improper Locking",
        "source": "sparse"
      },
      "similarity": 321.62244854447437
    },
    {
      "metadata": {
        "doc_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "source": "sparse"
      },
      "similarity": 316.4541381929277
    },
    {
      "metadata": {
        "doc_id": "911",
        "name": "Improper Update of Reference Count",
        "source": "sparse"
      },
      "similarity": 313.03079515376464
    },
    {
      "metadata": {
        "doc_id": "125",
        "name": "Out-of-bounds Read",
        "source": "sparse"
      },
      "similarity": 302.18142735898857
    },
    {
      "metadata": {
        "doc_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "source": "sparse"
      },
      "similarity": 299.985914108688
    },
    {
      "metadata": {
        "doc_id": "122",
        "name": "Heap-based Buffer Overflow",
        "type": "Variant",
        "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().",
        "keyphrase_source": "weakness:memory leak",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.4806083022716083
          }
        }
      },
      "similarity": 0.4806083022716083
    },
    {
      "doc_id": "772",
      "text": "CWE-772: Missing Release of Resource after Effective Lifetime",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "772",
        "name": "Missing Release of Resource after Effective Lifetime",
        "type": "base",
        "original_content": "CWE-772: Missing Release of Resource after Effective Lifetime",
        "relationships": [
          {
            "source_id": "772",
            "target_id": "911",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "775",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "401",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "1091",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "404",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1340"
            }
          },
          {
            "source_id": "772",
            "target_id": "404",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          },
          {
            "source_id": "772",
            "target_id": "404",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "772",
            "target_id": "404",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "911",
            "target_id": "772",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "775",
            "target_id": "772",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "404",
            "target_id": "772",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "401",
            "target_id": "772",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1091",
            "target_id": "772",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "911",
                  "772",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "911"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "911",
                  "772",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "911"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-911",
      "CWE-404",
      "CWE-125",
      "CWE-667",
      "CWE-1091",
      "CWE-401",
      "CWE-833",
      "CWE-909",
      "CWE-362",
      "CWE-122",
      "CWE-789",
      "CWE-772"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}