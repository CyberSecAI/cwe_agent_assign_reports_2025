{
  "cve_id": "CVE-2025-0981",
  "description": "A vulnerability exists in ChurchCRM 5.13.0 and prior that allows an attacker to hijack a users session by exploiting a **Stored Cross Site Scripting** (XSS) vulnerability in the Group Editor page. This allows admin users to inject malicious JavaScript in the description field, which captures the session cookie of authenticated users. The cookie can then be sent to an external server, enabling session hijacking. It can also lead to information disclosure, as exposed session cookies can be used to impersonate users and gain unauthorised access to sensitive information.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "Stored Cross Site Scripting",
    "impact": [
      "inject malicious JavaScript",
      "hijack a users session",
      "information disclosure",
      "impersonate users",
      "session hijacking"
    ],
    "vector": "",
    "attacker": "attacker",
    "product": "ChurchCRM",
    "version": "5.13.0 and prior",
    "component": "Group Editor page"
  },
  "reference_content": "## Analysis of CVE-2025-0981 based on provided content\n\nThe provided content is directly related to CVE-2025-0981. It provides a detailed description of the vulnerability, exceeding the information available in a typical CVE description.\n\n**Root cause of vulnerability:**\n\nStored Cross-Site Scripting (XSS) vulnerability in the Group Editor page of ChurchCRM.\n\n**Weaknesses/vulnerabilities present:**\n\n*   **CWE-79:** Cross-Site Scripting\n*   **CWE-287:** Improper Authentication (due to session hijacking)\n\n**Impact of exploitation:**\n\n*   **Session Hijacking:** An attacker can capture a user's session cookie and gain unauthorized access to their account.\n*   **Information Disclosure:** Exposure of session cookies can lead to impersonation and access to sensitive information.\n\n**Attack vectors:**\n\n*   An attacker injects malicious JavaScript code into the `description` field of a group in the Group Editor.\n*   When another user views the group details, the injected script executes, potentially stealing their session cookie.\n\n**Required attacker capabilities/position:**\n\n*   Administrator privileges are required to modify the group description.\n*   Network access to the ChurchCRM application.\n\n**Mitigation or fix:**\n\n*   Implement output encoding to prevent malicious script injection.\n*   Set the `HttpOnly` and `Secure` flags on session cookies.\n*   Validate and sanitize user input before displaying it.\n\n**Additional Details (more than official CVE description):**\n\n*   **Affected Version:** ChurchCRM 5.13.0 and prior.\n*   **Specific URLs affected:** `http://<server_ip>/GroupEditor.php?GroupID=7` and `http://<server_ip>/api/groups/7`\n*   **Proof of Concept (PoC):**  Includes `curl` commands demonstrating both a simple XSS payload (alerting the cookie) and an advanced payload (sending the cookie to an attacker-controlled server).\n*   **CVSS v4 Score:** 8.4 (High severity) with detailed breakdown of metrics.\n*   **EPSS Score:** 0.047% (14th percentile) - estimates the probability of exploitation in the next 30 days.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1.0 | Base | Allowed | Primary CWE. The application **does not neutralize or incorrectly neutralizes** user-controllable input before it is placed in output that is used as a web page that is served to other users. |\n| CWE-1004 | Sensitive Cookie Without 'HttpOnly' Flag | 0.7 | Variant | Allowed | Secondary Candidate. The product uses a cookie to store sensitive information, but the cookie is not marked with the HttpOnly flag. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship is that CWE-79 is the root cause, where user-controlled input is not properly neutralized, leading to the possibility of injecting malicious scripts into web pages. CWE-1004 is included because the vulnerability description and the CVE reference summary mentioned the ability of the attacker to steal the session cookie which is missing the HttpOnly flag. CWE-79 is a base level CWE, which is the preferred level of abstraction. CWE-1004 is a variant, which is also a preferred level of abstraction.\n\n```mermaid\ngraph TD\n    cwe79[\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\n    cwe1004[\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\n    cwe1004 -->|CAUSES| cwe79\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe79 primary\n    class cwe1004 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with a **Stored Cross-Site Scripting** (XSS) vulnerability (CWE-79) in the Group Editor page. An attacker injects malicious JavaScript into the description field. When a user views the group details, the script executes, allowing the attacker to capture the user's session cookie. The session cookie is vulnerable because it is a Sensitive Cookie Without 'HttpOnly' Flag (CWE-1004). This enables session hijacking and information disclosure.\n\n## Summary of Analysis\nThe initial assessment correctly identified CWE-79 as the primary weakness, as the root cause of the vulnerability is the **improper neutralization of input** leading to XSS. The CVE reference summary supports this, stating \"Stored Cross-Site Scripting (XSS) vulnerability in the Group Editor page of ChurchCRM.\"\nThe retriever results also strongly support CWE-79, with a high similarity score.\n\nCWE-1004 (Sensitive Cookie Without 'HttpOnly' Flag) is added as a secondary concern because the stolen cookie lacks the HttpOnly flag, making session hijacking easier. The CVE reference summary mentioned the need to \"Set the `HttpOnly` and `Secure` flags on session cookies,\" pointing to this weakness.\n\nOther CWEs considered but not used:\n\n*   CWE-352 (Cross-Site Request Forgery (CSRF)): While CSRF is a web application vulnerability, it does not directly relate to the **stored XSS** issue described.\n*   CWE-434 (Unrestricted Upload of File with Dangerous Type): This CWE is not relevant as the vulnerability does not involve file uploads.\n*   CWE-116 (Improper Encoding or Escaping of Output): While related to XSS, CWE-79 is more specific as it directly addresses the **improper neutralization of input during web page generation**.\n*   CWE-425 (Direct Request ('Forced Browsing')): This is not relevant as it is related to authorization issues.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1.0 | Base | Allowed | Primary CWE. The application **does not neutralize or incorrectly neutralizes** user-controllable input before it is placed in output that is used as a web page that is served to other users. |\n| CWE-1004 | Sensitive Cookie Without 'HttpOnly' Flag | 0.7 | Variant | Allowed | Secondary Candidate. The product uses a cookie to store sensitive information, but the cookie is not marked with the HttpOnly flag. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship is that CWE-79 is the root cause, where user-controlled input is not properly neutralized, leading to the possibility of injecting malicious scripts into web pages. CWE-1004 is included because the vulnerability description and the CVE reference summary mentioned the ability of the attacker to steal the session cookie which is missing the HttpOnly flag. CWE-79 is a base level CWE, which is the preferred level of abstraction. CWE-1004 is a variant, which is also a preferred level of abstraction.\n\n```mermaid\ngraph TD\n    cwe79[\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\n    cwe1004[\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\n    cwe1004 -->|CAUSES| cwe79\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe79 primary\n    class cwe1004 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with a **Stored Cross-Site Scripting** (XSS) vulnerability (CWE-79) in the Group Editor page. An attacker injects malicious JavaScript into the description field. When a user views the group details, the script executes, allowing the attacker to capture the user's session cookie. The session cookie is vulnerable because it is a Sensitive Cookie Without 'HttpOnly' Flag (CWE-1004). This enables session hijacking and information disclosure.\n\n## Summary of Analysis\nThe initial assessment correctly identified CWE-79 as the primary weakness, as the root cause of the vulnerability is the **improper neutralization of input** leading to XSS. The CVE reference summary supports this, stating \"Stored Cross-Site Scripting (XSS) vulnerability in the Group Editor page of ChurchCRM.\"\nThe retriever results also strongly support CWE-79, with a high similarity score.\n\nCWE-1004 (Sensitive Cookie Without 'HttpOnly' Flag) is added as a secondary concern because the stolen cookie lacks the HttpOnly flag, making session hijacking easier. The CVE reference summary mentioned the need to \"Set the `HttpOnly` and `Secure` flags on session cookies,\" pointing to this weakness.\n\nOther CWEs considered but not used:\n\n*   CWE-352 (Cross-Site Request Forgery (CSRF)): While CSRF is a web application vulnerability, it does not directly relate to the **stored XSS** issue described.\n*   CWE-434 (Unrestricted Upload of File with Dangerous Type): This CWE is not relevant as the vulnerability does not involve file uploads.\n*   CWE-116 (Improper Encoding or Escaping of Output): While related to XSS, CWE-79 is more specific as it directly addresses the **improper neutralization of input during web page generation**.\n*   CWE-425 (Direct Request ('Forced Browsing')): This is not relevant as it is related to authorization issues.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-116:**\n- 116 (Improper Encoding or Escaping of Output) - ROOT\n\n\n**Chain starting from CWE-79:**\n- 79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 623.7876011772527
    },
    {
      "metadata": {
        "doc_id": "1004",
        "name": "Sensitive Cookie Without 'HttpOnly' Flag",
        "source": "sparse"
      },
      "similarity": 588.7625106338502
    },
    {
      "metadata": {
        "doc_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "source": "sparse"
      },
      "similarity": 586.5401104359483
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse"
      },
      "similarity": 546.5883481879646
    },
    {
      "metadata": {
        "doc_id": "80",
        "name": "Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)",
        "source": "sparse"
      },
      "similarity": 541.6805891707937
    },
    {
      "metadata": {
        "doc_id": "116",
        "name": "Improper Encoding or Escaping of Output",
        "source": "sparse"
      },
      "similarity": 522.0584726633585
    },
    {
      "metadata": {
        "doc_id": "614",
        "name": "Sensitive Cookie in HTTPS Session Without 'Secure' Attribute",
        "source": "sparse"
      },
      "similarity": 520.5848807959069
    },
    {
      "metadata": {
        "doc_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "source": "sparse"
      },
      "similarity": 519.2173479568991
    },
    {
      "metadata": {
        "doc_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "type": "Base",
        "original_content": "The web application does not sufficiently verify inputs that are assumed to be immutable but are actually externally controllable, such as hidden form fields.",
        "keyphrase_source": "weakness:Stored Cross Site Scripting",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "retriever_count": 3,
          "normalized_scores": {
            "dense": 0.5581020846038475,
            "sparse": 515.0361099175107,
            "graph": 2.077375965222045
          }
        }
      },
      "similarity": 0.5581020846038475
    },
    {
      "doc_id": "184",
      "text": "CWE-184: Incomplete List of Disallowed Inputs",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "184",
        "name": "Incomplete List of Disallowed Inputs",
        "type": "base",
        "original_content": "CWE-184: Incomplete List of Disallowed Inputs",
        "relationships": [
          {
            "source_id": "184",
            "target_id": "692",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "78",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "79",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "1023",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "693",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "86",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "78",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "693",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "STARTSWITH",
            "properties": {
              "view_id": "709"
            }
          },
          {
            "source_id": "625",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "186",
            "target_id": "184",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1023",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "79"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "79"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "184",
                  "79",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "79"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-116",
      "CWE-79",
      "CWE-1004",
      "CWE-352",
      "CWE-425",
      "CWE-434"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}