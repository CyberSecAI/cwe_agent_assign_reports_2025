## Vulnerability Description
A vulnerability exists in ChurchCRM 5.13.0 and prior that allows an attacker to hijack a users session by exploiting a **Stored Cross Site Scripting** (XSS) vulnerability in the Group Editor page. This allows admin users to inject malicious JavaScript in the description field, which captures the session cookie of authenticated users. The cookie can then be sent to an external server, enabling session hijacking. It can also lead to information disclosure, as exposed session cookies can be used to impersonate users and gain unauthorised access to sensitive information.

### Vulnerability Description Key Phrases
- **weakness:** **Stored Cross Site Scripting**
- **impact:** inject malicious JavaScript and hijack a users session and information disclosure and impersonate users and session hijacking
- **attacker:** attacker
- **product:** ChurchCRM
- **version:** 5.13.0 and prior
- **component:** Group Editor page

## CVE Reference Links Content Summary
## Analysis of CVE-2025-0981 based on provided content

The provided content is directly related to CVE-2025-0981. It provides a detailed description of the vulnerability, exceeding the information available in a typical CVE description.

**Root cause of vulnerability:**

Stored Cross-Site Scripting (XSS) vulnerability in the Group Editor page of ChurchCRM.

**Weaknesses/vulnerabilities present:**

*   **CWE-79:** Cross-Site Scripting
*   **CWE-287:** Improper Authentication (due to session hijacking)

**Impact of exploitation:**

*   **Session Hijacking:** An attacker can capture a user's session cookie and gain unauthorized access to their account.
*   **Information Disclosure:** Exposure of session cookies can lead to impersonation and access to sensitive information.

**Attack vectors:**

*   An attacker injects malicious JavaScript code into the `description` field of a group in the Group Editor.
*   When another user views the group details, the injected script executes, potentially stealing their session cookie.

**Required attacker capabilities/position:**

*   Administrator privileges are required to modify the group description.
*   Network access to the ChurchCRM application.

**Mitigation or fix:**

*   Implement output encoding to prevent malicious script injection.
*   Set the `HttpOnly` and `Secure` flags on session cookies.
*   Validate and sanitize user input before displaying it.

**Additional Details (more than official CVE description):**

*   **Affected Version:** ChurchCRM 5.13.0 and prior.
*   **Specific URLs affected:** `http://<server_ip>/GroupEditor.php?GroupID=7` and `http://<server_ip>/api/groups/7`
*   **Proof of Concept (PoC):**  Includes `curl` commands demonstrating both a simple XSS payload (alerting the cookie) and an advanced payload (sending the cookie to an attacker-controlled server).
*   **CVSS v4 Score:** 8.4 (High severity) with detailed breakdown of metrics.
*   **EPSS Score:** 0.047% (14th percentile) - estimates the probability of exploitation in the next 30 days.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.624 |
| 2 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | sparse | 0.589 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.587 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.547 |
| 5 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.542 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.522 |
| 7 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | sparse | 0.521 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.519 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.558 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-116: Improper Encoding or Escaping of Output

CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute

CWE-138: Improper Neutralization of Special Elements

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-184: Incomplete List of Disallowed Inputs