## Vulnerability Description
The AI ChatBot with ChatGPT and Content Generator by AYS WordPress plugin before 2.1.0 discloses the Open AI API Key, allowing unauthenticated users to obtain it

### Vulnerability Description Key Phrases
- **impact:** disclose Open AI API Key
- **attacker:** unauthenticated users
- **product:** AI ChatBot with ChatGPT and Content Generator by AYS WordPress plugin
- **version:** before 2.1.0

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The plugin stores the OpenAI API key in a way that allows it to be accessed by unauthenticated users.
- **Weaknesses/vulnerabilities present:** Sensitive data exposure (OpenAI API key disclosure)
- **Impact of exploitation:** An attacker can obtain the OpenAI API key, potentially using it to make unauthorized calls to the OpenAI API, leading to financial loss or other security risks.
- **Attack vectors:**
    - For versions 2.0.8 and below: Intercepting the `ays_chatgpt_admin_ajax` AJAX call and base64 decoding the `dataObj` parameter.
    - For versions prior to 2.0.8: Intercepting the request to `api.openai.com` and extracting the API key from the `Authorization` header.
- **Required attacker capabilities/position:** No special capabilities or position are needed as the vulnerability is accessible to unauthenticated users, requiring only the ability to intercept network requests made by the plugin.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.053 |
| 2 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.050 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.050 |
| 4 | 1426 | Improper Validation of Generative AI Output | Base | Discouraged | sparse | 0.050 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.050 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.049 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.048 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.047 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.416 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1390: Weak Authentication

CWE-522: Insufficiently Protected Credentials

CWE-306: Missing Authentication for Critical Function

CWE-1426: Improper Validation of Generative AI Output

CWE-863: Incorrect Authorization

CWE-862: Missing Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-613: Insufficient Session Expiration