# Vulnerability Information: CVE-2024-47141

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved pinmux Use sequential access to access desc->pinmux data When two client of the same gpio call pinctrl_select_state() for the same functionality, we are seeing **NULL pointer issue** while accessing desc->mux_owner. Lets say two processes A, B executing in pin_request() for the same pin and process A updates the desc->mux_usecount but not yet updated the desc->mux_owner while process B see the desc->mux_usecount which got updated by A path and further executes strcmp and while accessing desc->mux_owner it crashes with NULL pointer. Serialize the access to mux related setting with a mutex lock. cpu0 (process A) cpu1(process B) pinctrl_select_state() { pinctrl_select_state() { pin_request() { pin_request() { ... .... } else { desc->mux_usecount++ desc->mux_usecount && strcmp(desc->mux_owner, owner)) { if (desc->mux_usecount > 1) return 0 desc->mux_owner = owner } }

### Vulnerability Description Key Phrases
- **weakness:** **NULL pointer issue**
- **product:** Linux kernel

## CVE Reference Links Content Summary
UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.552 |
| 2 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.531 |
| 3 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.515 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.515 |
| 5 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.503 |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.493 |
| 7 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.487 |
| 8 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.474 |
| 9 | 1189 | Improper Isolation of Shared Resources on System-on-a-Chip (SoC) | Base | Allowed | dense | 0.513 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |

