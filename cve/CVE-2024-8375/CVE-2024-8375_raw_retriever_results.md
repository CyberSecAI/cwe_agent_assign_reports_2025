# Raw Retriever Results for CVE-2024-8375

# Raw Retriever Results for CVE-2024-8375
## Query
There exists a use after free vulnerability in Reverb. Reverb supports the VARIANT datatype, which is supposed to represent an arbitrary object in C++. When a tensor proto of type VARIANT is unpacked, memory is first allocated to store the entire tensor, and a ctor is called on each instance. Afterwards, Reverb copies the content in tensor_content to the previously mentioned pre-allocated memory, which results in the bytes in tensor_content overwriting the vtable pointers of all the objects which were previously allocated. Reverb exposes 2 relevant gRPC endpoints InsertStream and SampleStream. The attacker can insert this stream into the servers database, then when the client next calls SampleStream they will unpack the tensor into RAM, and when any method on that object is called (including its destructor) the attacker gains control of the Program Counter. We recommend upgrading past git commit https//github.com/google-deepmind/reverb/commit/6a0dcf4c9e842b7f999912f792aaa6f6bd261a25

## Keyphrases
- **rootcause**: 'use after free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4368 | 0.4618 | 0.4511 | 0.4512 | 20 |
| Sparse | 226.4311 | 780.5627 | 682.5118 | 706.2021 | 11 |
| Graph | 1.5949 | 3.0550 | 2.0625 | 2.1129 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 911 | Improper Update of Reference Count | base | 3.0550 | Allowed |
| 2 | 123 | Write-what-where Condition | base | 2.9120 | Allowed |
| 3 | 787 | Out-of-bounds Write | base | 2.7196 | Allowed |
| 4 | 415 | Double Free | Variant | 2.2189 | Allowed |
| 5 | 416 | Use After Free | Variant | 2.2165 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 7 | 125 | Out-of-bounds Read | base | 2.2100 | Allowed |
| 8 | 364 | Signal Handler Race Condition | base | 2.2100 | Allowed |
| 9 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 10 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |
| 11 | 824 | Access of Uninitialized Pointer | Base | 2.0322 | Allowed |
| 12 | 170 | Improper Null Termination | base | 1.6848 | Allowed |
| 13 | 134 | Use of Externally-Controlled Format String | base | 1.6848 | Allowed |
| 14 | 823 | Use of Out-of-range Pointer Offset | base | 1.6848 | Allowed |
| 15 | 825 | Expired Pointer Dereference | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 122 | Heap-based Buffer Overflow | Variant | 0.4618 | 0.4618 | Allowed |
| 2 | 244 | Improper Clearing of Heap Memory Before Release ('Heap Inspection') | Variant | 0.4612 | 0.4612 | Allowed |
| 3 | 416 | Use After Free | Variant | 0.4604 | 0.4604 | Allowed |
| 4 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | 0.4600 | 0.4600 | Allowed |
| 5 | 909 | Missing Initialization of Resource | Class | 0.4596 | 0.4596 | Allowed-with-Review |
| 6 | 590 | Free of Memory not on the Heap | Variant | 0.4573 | 0.4573 | Allowed |
| 7 | 126 | Buffer Over-read | Variant | 0.4562 | 0.4562 | Allowed |
| 8 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.4562 | 0.4562 | Allowed |
| 9 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4560 | 0.4560 | Allowed |
| 10 | 415 | Double Free | Variant | 0.4513 | 0.4513 | Allowed |
| 11 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4511 | 0.4511 | Allowed |
| 12 | 190 | Integer Overflow or Wraparound | Base | 0.4489 | 0.4489 | Allowed |
| 13 | 674 | Uncontrolled Recursion | Class | 0.4463 | 0.4463 | Allowed-with-Review |
| 14 | 663 | Use of a Non-reentrant Function in a Concurrent Context | Base | 0.4461 | 0.4461 | Allowed |
| 15 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4461 | 0.4461 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 415 | Double Free | 780.5627 | 780.5627 | Allowed |
| 2 | 911 | Improper Update of Reference Count | 766.1936 | 766.1936 | Allowed |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | 761.0649 | 761.0649 | Allowed |
| 4 | 824 | Access of Uninitialized Pointer | 742.7307 | 742.7307 | Allowed |
| 5 | 122 | Heap-based Buffer Overflow | 730.3685 | 730.3685 | Allowed |
| 6 | 190 | Integer Overflow or Wraparound | 706.2021 | 706.2021 | Allowed |
| 7 | 125 | Out-of-bounds Read | 701.4625 | 701.4625 | Allowed |
| 8 | 476 | NULL Pointer Dereference | 701.2200 | 701.2200 | Allowed |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | 699.7162 | 699.7162 | Allowed |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 691.6772 | 691.6772 | Allowed-with-Review |
| 11 | 59 | Improper Link Resolution Before File Access ('Link Following') | 226.4311 | 226.4311 | Allowed |
