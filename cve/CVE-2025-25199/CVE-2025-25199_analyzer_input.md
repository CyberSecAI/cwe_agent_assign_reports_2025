# Vulnerability Information: CVE-2025-25199

## Vulnerability Description
go-crypto-winnative Go crypto backend for Windows using Cryptography API Next Generation (CNG). Prior to commit f49c8e1379ea4b147d5bff1b3be5b0ff45792e41, calls to `cng.TLS1PRF` dont release the key handle, producing a small **memory leak** every time. Commit f49c8e1379ea4b147d5bff1b3be5b0ff45792e41 contains a fix for the issue. The fix is included in versions 1.23.6-2 and 1.22.12-2 of the Microsoft build of go, as well as in the pseudoversion 0.0.0-20250211154640-f49c8e1379ea of the `github.com/microsoft/go-crypto-winnative` Go package.

### Vulnerability Description Key Phrases
- **rootcause:** **don't release the key handle**
- **weakness:** **memory leak**
- **product:** go-crypto-winnative Go crypto backend
- **component:** cng.TLS1PRF

## CVE Reference Links Content Summary
## Analysis of CVE-2025-25199 based on provided content:

The provided content is directly related to CVE-2025-25199. It details a memory leak in the `go-crypto-winnative` package. Here's a breakdown of the information:

**Root cause of vulnerability:**

Calls to `cng.TLS1PRF` did not release the key handle, leading to a memory leak each time the function was called.

**Weaknesses/vulnerabilities present:**

*   Memory Leak: Specifically, a failure to destroy a key handle after use.

**Impact of exploitation:**

*   High Availability impact: The CVSS score indicates a high impact on availability due to the memory leak.  Repeated calls to the function could eventually lead to resource exhaustion.

**Attack vectors:**

*   Network: The CVSS vector indicates the vulnerability is exploitable over a network.

**Required attacker capabilities/position:**

*   None: No privileges or user interaction are required to exploit the vulnerability.

**Mitigation or fix:**

*   The key handle is now destroyed using `bcrypt.DestroyKey(kh)` after the `bcrypt.GenerateSymmetricKey` call within the `TLS1PRF` function.
*   Patched versions: 1.23.6-2 and 1.22.12-2.
*   Affected versions: <= 1.23.6-1 and <= 1.22.12-1

**Additional Details (more than official CVE description):**

*   The commit `f49c8e1` explicitly addresses this issue by adding `defer bcrypt.DestroyKey(kh)` to ensure the key handle is released.
*   CVSS v3 base metrics are provided: AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
*   The vulnerability was reported by clarkb7.
*   The affected package is `github.com/microsoft/go-crypto-winnative`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.432 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.424 |
| 4 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.424 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.424 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.404 |
| 7 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.400 |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.398 |
| 9 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | Allowed | dense | 0.460 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.002 |

