# Vulnerability Information: CVE-2024-39134

## Vulnerability Description
A **Stack Buffer Overflow** vulnerability in zziplibv 0.13.77 allows attackers to cause a denial of service via the __zzip_fetch_disk_trailer() function at /zzip/zip.c.

### Vulnerability Description Key Phrases
- **weakness:** **Stack Buffer Overflow**
- **impact:** denial of service
- **attacker:** attackers
- **product:** zziplibv
- **version:** 0.13.77
- **component:** __zzip_fetch_disk_trailer() function at /zzip/zip.c

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-39134.

**Root cause of vulnerability:**
A stack-buffer-overflow occurs in the `__zzip_fetch_disk_trailer()` function within `zzip/zip.c`. This is due to insufficient bounds checking when reading the disk trailer from a zip archive, specifically when `ZZIP_DISK64_TRAILER` is defined.

**Weaknesses/vulnerabilities present:**
The vulnerability is a stack-buffer-overflow. The code attempts to read a `zzip_disk_trailer` struct into a stack allocated buffer. When `ZZIP_DISK64_TRAILER` is defined, the code only checks if `end - tail` is greater than 0 but does not verify it's greater or equal to size of the `zzip_disk_trailer` structure leading to an overflow when the size check is insufficient.

**Impact of exploitation:**
Attackers can exploit this vulnerability to achieve a denial of service (DoS) by causing a crash. Potentially, attackers could achieve arbitrary code execution.

**Attack vectors:**
The attack vector is by providing a crafted zip file that triggers the insufficient size check condition in `__zzip_fetch_disk_trailer()`.

**Required attacker capabilities/position:**
The attacker needs to be able to provide a specially crafted zip file to the vulnerable software (zziplib). The attacker does not need any special privileges on the system.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.192 |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.179 |
| 5 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.178 |
| 6 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.172 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.170 |
| 8 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.170 |
| 9 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | dense | 0.576 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

