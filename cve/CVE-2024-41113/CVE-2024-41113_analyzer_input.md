# Vulnerability Information: CVE-2024-41113

## Vulnerability Description
streamlit-geospatial is a streamlit multipage app for geospatial applications. Prior to commit c4f81d9616d40c60584e36abb15300853a66e489, the `vis_params` variable on line 383 or line 390 in `pages/1__Timelapse.py` takes user input, which is later used in the `eval()` function on line 395, leading to remote code execution. Commit c4f81d9616d40c60584e36abb15300853a66e489 fixes this issue.

### Vulnerability Description Key Phrases
- **rootcause:** **use of eval() with user input**
- **impact:** remote code execution
- **product:** streamlit-geospatial
- **version:** prior to commit c4f81d9616d40c60584e36abb15300853a66e489
- **component:** vis_params variable

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-NVD-noinfo

#### Top CWEs
- CWE-NVD-noinfo (Count: 34)
- CWE-918 (Count: 4)

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-41113:

**CVE-2024-41113**

*   **Root cause of vulnerability:** The application uses the `eval()` function on user-provided input for the `vis_params` variable in the `pages/1_ðŸ“·_Timelapse.py` file, specifically within the "Any Earth Engine ImageCollection" option. This allows for arbitrary code execution.
*   **Weaknesses/vulnerabilities present:**
    *   **Unsafe use of `eval()`:** The primary weakness is using `eval()` on untrusted user input, which directly translates to arbitrary code execution.
    *   **Lack of input sanitization/validation:** The application fails to sanitize or validate the user-provided string before passing it to `eval()`.
*  **Impact of exploitation:** Successful exploitation allows an attacker to execute arbitrary code on the server hosting the application. This could lead to:
    *   Full control of the server.
    *   Data exfiltration.
    *   Denial of service.
    *   Further attacks on other systems accessible from the server.
*   **Attack vectors:**
    *   The attacker would need to interact with the web application's user interface.
    *   Specifically, they would need to access the "Timelapse" feature under the "Any Earth Engine ImageCollection" option.
    *   They would then need to insert malicious code into the `Enter visualization parameters` text area.
*   **Required attacker capabilities/position:**
    *   The attacker must have network access to the web application.
    *   The attacker must be able to interact with the web interface, specifically the "Timelapse" tool.

**Summary of related content from the provided files:**

*   The file `github.com_8497f14a_20250110_213841.html` shows the vulnerable code in `pages/1_ðŸ“·_Timelapse.py` that takes user input and uses `eval()`:
    ```python
        if bands:
            vis_params = st.text_area(
                "Enter visualization parameters",
                "{'bands': ["
                + ", ".join([f"'{band}'" for band in bands])
                + "]}",
            )
        else:
            vis_params = st.text_area(
                "Enter visualization parameters",
                "{}",
            )
        try:
            st.session_state["vis_params"] = eval(vis_params)
    ```
*   The file `github.com_6724fdc4_20250110_213843.html` contains the commit that fixes the vulnerability by replacing `eval()` with `json.loads()`:
    ```diff
    --- a/pages/1_ðŸ“·_Timelapse.py
    +++ b/pages/1_ðŸ“·_Timelapse.py
    @@ -392,7 +395,9 @@
                 "{}",
             )
             try:
    -            st.session_state["vis_params"] = eval(vis_params)
    +            st.session_state["vis_params"] = json.loads(
    +                vis_params.replace("'", '"')
    +            )
                 st.session_state["vis_params"]["palette"] = st.session_state[
                     "palette"
                 ]
    ```
*   The file `securitylab.github.com_6f98c703_20250110_213843.html` describes the vulnerability (GHSL-2024-101) and provides a Proof of Concept.

**Additional details from the Github Security Lab report:**
The report confirms that the `vis_params` variable is vulnerable to Remote Code Execution (RCE) because the application uses `eval()` on user-controlled input.

This content provides more detail than the official CVE description (PLACEHOLDER).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.305 |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.280 |
| 3 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.276 |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.258 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.257 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.252 |
| 7 | 214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | sparse | 0.250 |
| 8 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.249 |
| 9 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | dense | 0.360 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.002 |

