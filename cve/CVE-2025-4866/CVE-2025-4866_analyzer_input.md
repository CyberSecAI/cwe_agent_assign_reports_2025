# Vulnerability Information: CVE-2025-4866

## Vulnerability Description
A vulnerability was found in weibocom rill-flow 0.1.18. It has been classified as critical. Affected is an unknown function of the component Management Console. The manipulation leads to **code injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **code injection**
- **product:** weibocom rill-flow
- **version:** 0.1.18
- **component:** unknown function of Management Console

## CVE Reference Links Content Summary
**CVE-2025-4866 - Analysis of Provided Content**

The provided content details a vulnerability in the Rillflow management console, specifically an **Aviator Expression Injection** leading to **Remote Code Execution (RCE)**. This directly relates to a security issue and provides substantial details.

**Root cause of vulnerability:**

The root cause is the ability for attackers to create process lists and set input mappings for nodes that process Aviator expressions without proper restrictions on what those expressions can do. Specifically, the vulnerability stems from the lack of restrictions on loading external classes within the Aviator expression evaluation.

**Weaknesses/vulnerabilities present:**

*   **Unsafe Expression Evaluation:** The application uses Aviator expressions without sufficient sanitization or restrictions.
*   **Lack of Class Loading Restrictions:** Aviator is allowed to load external classes, enabling arbitrary code execution.
*   **Input Injection:** Attackers can inject malicious Aviator expressions through input mappings.

**Impact of exploitation:**

Successful exploitation allows an attacker to escalate from a web user to gain machine privileges through Remote Code Execution.

**Attack vectors:**

1.  Create a process list in the Rillflow management console.
2.  Import a malicious demo file containing a crafted Aviator expression.
3.  Configure input mappings to execute the malicious expression.
4.  Trigger the execution of the process, leading to RCE.

**Required attacker capabilities/position:**

*   An attacker needs to be a web user with the ability to create process lists and import files into the Rillflow management console.
*   The attacker needs to be able to craft a malicious Aviator expression that leverages class loading to execute arbitrary code.

**Mitigation or fix:**

The suggested mitigation is to configure Aviator to prohibit the loading of external classes. This can be achieved by setting the classes in the whitelist to empty. A link to relevant documentation is provided: <https://www.yuque.com/boyan-avfmj/aviatorscript/yr1oau>

**Additional Notes:**

The content provides a detailed proof of concept, including a sample payload and step-by-step instructions for exploitation. This level of detail goes beyond the typical CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.408 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.379 |
| 3 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.347 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.321 |
| 5 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.310 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.310 |
| 7 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.307 |
| 8 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.304 |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | dense | 0.636 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.003 |

