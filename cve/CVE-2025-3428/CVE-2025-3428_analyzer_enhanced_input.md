## Vulnerability Description
The 3DPrint Lite plugin for WordPress is vulnerable to SQL Injection via the coating_text parameter in all versions up to, and including, 2.1.3.6 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** unauthenticated attackers
- **product:** 3DPrint Lite WordPress plugin
- **version:** all versions up to and including 2.1.3.6
- **component:** coating_text parameter

## CVE Reference Links Content Summary
Based on the provided content, this relates to CVE-2025-3428 as it describes a "Security fix" included in changesets for the 3dprint-lite WordPress plugin. The content provides more detail than a standard CVE description.

Here's a breakdown of the relevant information:

* **Root cause of vulnerability:** Not explicitly stated, but the changesets indicate a security issue was addressed.
* **Weaknesses/vulnerabilities present:** The changes involve adding nonce verification to several admin functions: `clone` and `add` actions for printers, materials, coatings, and infills. This suggests a potential vulnerability related to Cross-Site Request Forgery (CSRF) or unauthorized modification of data.
* **Impact of exploitation:**  Without more details, the impact is unclear, but could involve unauthorized creation, modification, or deletion of printer, material, coating, or infill data within the plugin.
* **Attack vectors:** The addition of nonce verification suggests the original attack vector involved manipulating requests to the admin interface without proper authentication.
* **Required attacker capabilities/position:** An attacker would likely need to be able to craft and send malicious requests to the WordPress admin interface, potentially requiring some level of access or the ability to trick an administrator into performing an action.
* **Mitigation or fix:** The fix involves implementing `wp_verify_nonce` checks before performing actions like cloning or adding data. This ensures that requests originate from a trusted source and haven't been tampered with.

**Specific changes observed:**

*   **`3dprint-lite.php`**: Version number updated from `2.1.3.5` to `2.1.3.6`.
*   **`includes/3dprint-lite-admin-coatings.php`, `includes/3dprint-lite-admin-infills.php`, `includes/3dprint-lite-admin-materials.php`, `includes/3dprint-lite-admin-printers.php`**:  Addition of nonce verification (`wp_create_nonce` and `wp_verify_nonce`) to the 'add' actions for coatings, infills, materials, and printers.
*   **`includes/3dprint-lite-admin.php`**: Extensive changes adding nonce verification to the 'add' and 'clone' actions for printers, materials, coatings, and infills.
*   **`readme.txt`**: Changelog entry added: "= 2.1.3.6 = Security fix".

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.532 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.482 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.476 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.465 |
| 6 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.465 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.462 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.447 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.536 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-790: Improper Filtering of Special Elements

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-502: Deserialization of Untrusted Data

CWE-138: Improper Neutralization of Special Elements

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')