# Raw Retriever Results for CVE-2024-21519

# Raw Retriever Results for CVE-2024-21519
## Query
This affects versions of the package opencart/opencart from 4.0.0.0. An Arbitrary File Creation issue was identified via the database restoration functionality. By injecting PHP code into the database, an attacker with admin privileges can create a backup file with an arbitrary filename (including the extension), within /system/storage/backup. **Note** It is less likely for the created file to be available within the web root, as part of the security recommendations for the application suggest moving the storage path outside of the web root.

## Keyphrases
- **weakness**: 'Arbitrary File Creation'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4313 | 0.5256 | 0.4754 | 0.4795 | 20 |
| Sparse | 448.2661 | 488.0144 | 459.8103 | 457.1548 | 10 |
| Graph | 1.5210 | 3.8870 | 2.1245 | 1.9435 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 3.8870 | Allowed |
| 2 | 363 | Race Condition Enabling Link Following | base | 2.8652 | Allowed |
| 3 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.7950 | Allowed |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.7742 | Allowed |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 2.5523 | Allowed |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.3877 | Allowed |
| 7 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 8 | 183 | Permissive List of Allowed Inputs | base | 2.2100 | Allowed |
| 9 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 10 | 306 | Missing Authentication for Critical Function | base | 2.1190 | Allowed |
| 11 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 12 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 13 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6620 | Allowed |
| 15 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.5256 | 0.5256 | Allowed |
| 2 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | 0.5255 | 0.5255 | Allowed |
| 3 | 530 | Exposure of Backup File to an Unauthorized Control Sphere | Variant | 0.5249 | 0.5249 | Allowed |
| 4 | 616 | Incomplete Identification of Uploaded File Variables (PHP) | Variant | 0.5207 | 0.5207 | Allowed |
| 5 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.5049 | 0.5049 | Allowed |
| 6 | 378 | Creation of Temporary File With Insecure Permissions | Base | 0.4940 | 0.4940 | Allowed |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.4931 | 0.4931 | Allowed |
| 8 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | 0.4912 | 0.4912 | Allowed |
| 9 | 24 | Path Traversal: '../filedir' | Variant | 0.4902 | 0.4902 | Allowed |
| 10 | 552 | Files or Directories Accessible to External Parties | Base | 0.4891 | 0.4891 | Allowed |
| 11 | 219 | Storage of File with Sensitive Data Under Web Root | Variant | 0.4700 | 0.4700 | Allowed |
| 12 | 377 | Insecure Temporary File | Class | 0.4589 | 0.4589 | Allowed-with-Review |
| 13 | 473 | PHP External Variable Modification | Variant | 0.4509 | 0.4509 | Allowed |
| 14 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.4475 | 0.4475 | Allowed |
| 15 | 220 | Storage of File With Sensitive Data Under FTP Root | Variant | 0.4421 | 0.4421 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | 488.0144 | 488.0144 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | 472.2251 | 472.2251 | Allowed |
| 3 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 460.6232 | 460.6232 | Allowed |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 460.6178 | 460.6178 | Allowed |
| 5 | 61 | UNIX Symbolic Link (Symlink) Following | 460.5597 | 460.5597 | Allowed |
| 6 | 23 | Relative Path Traversal | 453.7499 | 453.7499 | Allowed |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 452.4323 | 452.4323 | Allowed |
| 8 | 138 | Improper Neutralization of Special Elements | 451.9474 | 451.9474 | Discouraged |
| 9 | 732 | Incorrect Permission Assignment for Critical Resource | 449.6669 | 449.6669 | Allowed-with-Review |
| 10 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 448.2661 | 448.2661 | Allowed-with-Review |
