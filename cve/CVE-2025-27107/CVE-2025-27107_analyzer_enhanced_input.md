## Vulnerability Description
Integrated Scripting is a tool for creating scripts for handling complex operations in Integrated Dynamics. Minecraft users who use Integrated Scripting prior to versions 1.21.1-1.0.17, 1.21.4-1.0.9-254, 1.20.1-1.0.13, and 1.19.2-1.0.10 may be vulnerable to arbitrary code execution. By using **Java reflection on a thrown exception object** its possible to escape the JavaScript sandbox for IntegratedScriptings Variable Cards, and leverage that to construct arbitrary Java classes and invoke arbitrary Java methods. This vulnerability allows for execution of arbitrary Java methods, and by extension arbitrary native code e.g. from `java.lang.Runtime.exec`, on the Minecraft server by any player with the ability to create and use an IntegratedScripting Variable Card. Versions 1.21.1-1.0.17, 1.21.4-1.0.9-254, 1.20.1-1.0.13, and 1.19.2-1.0.10 fix the issue.

### Vulnerability Description Key Phrases
- **component:** IntegratedScripting Variable Cards
- **rootcause:** **Java reflection on a thrown exception object**
- **product:** Integrated Scripting
- **impact:** ['arbitrary code execution', 'arbitrary Java classes', 'invoke arbitrary Java methods']
- **version:** prior to versions 1.21.1-1.0.17, 1.21.4-1.0.9-254, 1.20.1-1.0.13, and 1.19.2-1.0.10

## CVE Reference Links Content Summary
## CVE-2025-27107 Analysis

The provided content is **RELEVANT** to CVE-2025-27107. It details a critical arbitrary code execution vulnerability in IntegratedScripting for Minecraft. Here's an extraction of the relevant information:

**Root cause of vulnerability:**

The vulnerability stems from using Java reflection on a thrown exception object within the IntegratedScripting environment. This allows escaping the JavaScript sandbox and leveraging the ability to construct arbitrary Java classes and invoke arbitrary Java methods.

**Weaknesses/vulnerabilities present:**

*   **Unrestricted Host Access:** The GraalJS context allows "HostAccess.ALL", which is discouraged for untrusted code.
*   **Java Reflection Escape:** The ability to access and manipulate native Java exception objects bypasses the intended security constraints of the JavaScript sandbox.
*   **Broken Invariant:** The security relies on only exposing "ValueTranslator" classes, but this is broken by handling native Java exceptions.

**Impact of exploitation:**

*   **Arbitrary Code Execution:**  Allows execution of arbitrary Java methods, and potentially native code (e.g., via `java.lang.Runtime.exec`), on the Minecraft server.
*   **Server Compromise:** Any player capable of creating and using an IntegratedScripting Variable Card can potentially compromise the server.

**Attack vectors:**

*   Crafting a malicious IntegratedScripting script (Variable Card) that intentionally throws an exception.
*   Utilizing Java reflection within the script to call arbitrary Java methods.

**Required attacker capabilities/position:**

*   A Minecraft player with the ability to create and use IntegratedScripting Variable Cards.
*   Knowledge of Java and the IntegratedScripting environment to craft a suitable exploit script.

**Mitigation or fix:**

*   Patched versions are available:
    *   >=1.21.1-1.0.17
    *   >=1.21.4-1.0.9-254
    *   >=1.20.1-1.0.13
    *   >=1.19.2-1.0.10

**Additional Details (more than official CVE description):**

*   The content provides a Proof-of-Concept (PoC) script that demonstrates how to grant operator privileges to a specific player.
*   It identifies specific code locations within the IntegratedScripting project that are relevant to the vulnerability (e.g., `ValueTranslators.java`, `ScriptHelpers.java`).
*   It mentions potential corner cases during exploitation related to class loading on dedicated servers, but states these are not practical blockers.
*   The vulnerability is credited to chc4 (finder) and rubensworks (remediation developer).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.760 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.757 |
| 3 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.755 |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.754 |
| 5 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.746 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.746 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.741 |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.739 |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | dense | 0.473 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-755: Improper Handling of Exceptional Conditions

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-917: Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-269: Improper Privilege Management

CWE-502: Deserialization of Untrusted Data

CWE-138: Improper Neutralization of Special Elements

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-73: External Control of File Name or Path