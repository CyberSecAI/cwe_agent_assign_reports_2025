## Vulnerability Description
A vulnerability, which was classified as critical, has been found in EnGenius ENH1350EXT, ENS500-AC and ENS620EXT up to 20241118. This issue affects some unknown processing of the file /admin/network/diag_ping6. The manipulation of the argument diag_ping6 leads to **command injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** EnGenius ENH1350EXT and ENS500-AC and ENS620EXT
- **version:** up to 20241118
- **component:** /admin/network/diag_ping6

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability stems from a lack of input sanitization in the `diag_ping6` interface of ENGENIUS routers. User-supplied input for the `diag_ping6` parameter is directly passed to a system command without any filtering or validation.

**Weaknesses/Vulnerabilities:**
*   **Command Injection:** The primary weakness is a command injection vulnerability. By injecting shell metacharacters within the `diag_ping6` parameter, an attacker can execute arbitrary system commands on the router's operating system.
*   **Lack of Input Sanitization:** The vulnerability is caused by a missing input validation or sanitization step that prevents the injection of malicious code through the `diag_ping6` parameter.

**Impact of Exploitation:**
*   **Arbitrary Code Execution:** Successful exploitation allows an attacker to execute arbitrary system commands with the privileges of the web server process, potentially gaining root access to the device.
*   **Full System Control:** This level of access enables the attacker to perform various malicious actions, including but not limited to:
    *   Data exfiltration
    *   Installation of backdoors or malware
    *   Denial of service attacks
    *   Configuration changes

**Attack Vectors:**
*   **HTTP GET Request:** The vulnerability can be triggered using a crafted HTTP GET request to the `/cgi-bin/luci/.../admin/network/diag_ping6` endpoint.
*   **Network Access:** The attacker needs network access to the web interface of the vulnerable router.

**Required Attacker Capabilities/Position:**
*   **Authentication:** The attacker must be authenticated to access the router's web interface as an administrator.
*   **Network Access:** The attacker needs network connectivity to the router.

**Additional Details:**
*   **Affected Devices:** The vulnerability affects multiple ENGENIUS router models and firmware versions.
*   **Exploitation Technique:** The provided proof-of-concept demonstrates the injection of a `curl` command within the `diag_ping6` parameter to trigger command execution.
*   **Lua Code:** The core of the vulnerability is located within a lua script, where user input from `diag_ping6` is directly used in a system command.
*   **Lack of Vendor Response:** The report indicates that attempts to contact the vendor have been unsuccessful.

This analysis provides a more detailed breakdown of the vulnerability than the placeholder description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.506 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.473 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.408 |
| 6 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.398 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.397 |
| 8 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.384 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.638 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-117: Improper Output Neutralization for Logs

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs