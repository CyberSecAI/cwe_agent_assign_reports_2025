# Vulnerability Information: CVE-2025-24888

## Vulnerability Description
The SecureDrop Client is a desktop application for journalists to communicate with sources and work with submissions on the SecureDrop Workstation. Prior to version 0.14.1, a malicious SecureDrop Server could obtain code execution on the SecureDrop Client virtual machine (`sd-app`). SecureDrop Server itself has multiple layers of built-in hardening, and is a dedicated physical machine exposed on the internet only via Tor hidden services for the Source and Journalist interfaces, and optionally via remote SSH access over another Tor hidden service. A newsrooms SecureDrop Workstation communicates only with its own dedicated SecureDrop Server. The SecureDrop Client runs in a dedicated Qubes virtual machine, named `sd-app`, as part of the SecureDrop Workstation. The private OpenPGP key used to decrypt submissions and replies is stored in a separate virtual machine and never accessed directly. The vulnerability lies in the code responsible for downloading replies. The filename of the reply is obtained from the `Content-Disposition` HTTP header and used to write the encrypted reply on disk. Note that filenames are generated and sanitized server-side, and files are downloaded in an encrypted format, so a remote attacker who has not achieved server compromise, such as one posing as a source, could not craft the HTTP response necessary for this attack. While the filename is later checked to guard against **path traversal** before being moved into the Clients data storage directory, the file has already been written to a potentially arbitrary location. In this case, `safe_move()` would detect the **path traversal** and fail, leaving the original downloaded file in the attacker-chosen directory. Code execution can be gained by writing an autostart file in `/home/user/.config/autostart/`. Version 0.14.1 fixes the issue. As of time of publication, there is no known evidence of exploitation in the wild. This attack requires a previously compromised SecureDrop Server.

### Vulnerability Description Key Phrases
- **component:** SecureDrop Client virtual machine (`sd-app`)
- **weakness:** **path traversal**
- **product:** SecureDrop Client
- **impact:** arbitrary file write, code execution
- **attacker:** attacker
- **version:** prior to 0.14.1

## CVE Reference Links Content Summary
```text
Relevant content extracted:

The SecureDrop Client runs in a dedicated Qubes virtual machine, named `sd-app`, as part of the SecureDrop Workstation. The private OpenPGP key used to decrypt submissions and replies is stored in a [separate virtual machine](https://www.qubes-os.org/doc/split-gpg/) and never accessed directly. The vulnerability lies in the [code responsible for downloading replies](https://github.com/freedomofpress/securedrop-client/blob/release/0.14.0/client/securedrop_client/sdk/__init__.py#L956-L957). The filename of the reply is obtained from the `Content-Disposition` HTTP header and used to write the encrypted reply on disk. Note that filenames are generated and sanitized server-side, and files are downloaded in an encrypted format, so a remote attacker who has not achieved server compromise, such as one posing as a source, could not craft the HTTP response necessary for this attack.

While the filename [is later checked](https://github.com/freedomofpress/securedrop-client/blob/main/client/securedrop_client/api_jobs/downloads.py#L164) to guard against path traversal before being moved into the Clientâ€™s data storage directory, the file has already been written to a potentially arbitrary location. In this case, [`safe_move()`](https://github.com/freedomofpress/securedrop-client/blob/0.14.0/client/securedrop_client/utils.py#L79) would detect the path traversal and fail, leaving the original downloaded file in the attacker-chosen directory. Code execution can be gained by writing an autostart file in `/home/user/.config/autostart/`.

Impact: Code execution can be gained by writing an autostart file in `/home/user/.config/autostart/`.

Attack vector: Requires a previously compromised SecureDrop Server.

Mitigation: Patched in version 0.14.1
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 1.413 |
| 3 | 23 | Relative Path Traversal | Base | Allowed | sparse | 1.409 |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 1.379 |
| 5 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 1.367 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 1.366 |
| 7 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 1.361 |
| 8 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 1.359 |
| 9 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | Allowed | dense | 0.505 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.003 |

