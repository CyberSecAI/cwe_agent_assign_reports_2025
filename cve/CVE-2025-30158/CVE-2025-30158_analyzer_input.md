# Vulnerability Information: CVE-2025-30158

## Vulnerability Description
NamelessMC is a free, easy to use & powerful website software for Minecraft servers. In version 2.1.4 and prior, the forum **allows users to post iframe elements inside forum topics/comments/feed with no restriction on the iframes width and height attributes**. This allows an authenticated attacker to perform a UI-based denial of service (DoS) by injecting oversized iframes that block the forum UI and disrupt normal user interactions. This issue has been patched in version 2.2.0.

### Vulnerability Description Key Phrases
- **weakness:** **allows users to post iframe elements inside forum topics/comments/feed with no restriction on the iframes width and height attributes**
- **impact:** perform a UI-based denial of service (DoS)
- **vector:** injecting oversized iframes
- **attacker:** authenticated attacker
- **product:** NamelessMC
- **version:** 2.1.4 and prior
- **component:** forum

## CVE Reference Links Content Summary
## Analysis of CVE-2025-30158 based on provided content

The provided content directly relates to CVE-2025-30158. Here's a breakdown of the vulnerability information extracted from the GitHub security advisory and release notes:

**Root cause of vulnerability:**

The vulnerability stems from insufficient restrictions on the `width` and `height` attributes of `iframe` elements allowed within forum posts.  HTMLPurifier is configured to allow iframes, but doesn't limit their dimensions.

**Weaknesses/vulnerabilities present:**

*   **Unrestricted iframe dimensions:** Lack of validation on `iframe` width and height attributes.
*   **UI-based Denial of Service (DoS):**  The ability to inject oversized iframes.

**Impact of exploitation:**

*   **UI disruption:** Legitimate content is blocked by oversized iframes, making the forum unusable.
*   **Service degradation:**  Spamming oversized iframes can cause a large-scale UI DoS.

**Attack vectors:**

*   **Authenticated attacker:** An attacker must be a logged-in user to post content containing the malicious iframe.
*   **Forum post injection:** The attacker injects an iframe with extremely large `width` and `height` attributes into a forum topic, comment, or feed.

**Required attacker capabilities/position:**

*   **Authenticated user:** Requires a valid account on the forum.
*   **Ability to post content:**  The attacker needs permission to create or edit forum posts.
*   **Basic HTML knowledge:** Understanding of iframe tags and attributes.

**Mitigation or fix:**

*   **Version 2.2.0:** The vulnerability is patched in version 2.2.0 of Nameless.
*   **HTML.ForbiddenAttributes:** The commit `caa42a9` adds `iframe@width,iframe@height` to the `HTML.ForbiddenAttributes` configuration in `Output.php`, preventing the setting of arbitrary width and height values for iframes.

**Additional Details (more than official CVE description):**

*   A Python PoC script is provided to automate the injection of oversized iframes across multiple topics.
*   The advisory details the specific configuration settings in `Output.php` related to HTMLPurifier.
*   The release notes detail the extensive list of changes included in version 2.2.0, providing context for the fix.
*   The advisory includes CVSS scoring information (7.1/10).
*   The advisory lists the CWE associated with the vulnerability (CWE-400).
*   The advisory credits the researchers who discovered and reported the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | sparse | 0.421 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.397 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.391 |
| 4 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.382 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.378 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.377 |
| 7 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.375 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.375 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.479 |
| 10 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | Allowed | graph | 0.003 |

