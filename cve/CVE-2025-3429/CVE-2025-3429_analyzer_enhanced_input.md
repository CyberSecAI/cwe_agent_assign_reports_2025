## Vulnerability Description
The 3DPrint Lite plugin for WordPress is vulnerable to SQL Injection via the material_text parameter in all versions up to, and including, 2.1.3.6 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** append additional SQL queries into already existing queries and extract sensitive information from the database
- **attacker:** unauthenticated attackers
- **product:** 3DPrint Lite plugin for WordPress
- **version:** all versions up to and including 2.1.3.6
- **component:** material_text parameter

## CVE Reference Links Content Summary
Based on the content provided, here's an analysis:

The content indicates a "Security fix" in version 2.1.3.6 of the 3dprint-lite plugin. The changesets include updates to several PHP files and the readme.txt file. The security fix appears to involve the addition of nonce verification to various admin actions (add, clone, and edit) for printers, materials, coatings, and infills within the plugin. This addresses a potential vulnerability where unauthorized actions could be performed if the requests were not properly authenticated.

*   **Root cause of vulnerability**: The original code did not properly verify the nonce, making it vulnerable to CSRF attacks, which could allow an attacker to perform unauthorized actions.
*   **Weaknesses/vulnerabilities present**: Cross-Site Request Forgery (CSRF)
*   **Impact of exploitation**: An attacker could potentially add, clone, edit, or delete printers, materials, coatings, and infills within the 3dprint-lite plugin.
*   **Attack vectors**: Crafting malicious requests and tricking an authenticated user to visit a malicious website, or by other means.
*   **Required attacker capabilities/position**: The attacker needs to be able to make the victim's browser send a malicious request to the vulnerable site while the user is authenticated.
*   **Mitigation or fix**: The fix involves adding nonce verification using `wp_verify_nonce` to the actions in the admin sections to protect against CSRF attacks.

**More detail than the official CVE description**: The content details the specific files and code modifications that addressed the security issue.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.532 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.482 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.476 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.465 |
| 6 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.465 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.462 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.447 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.522 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-790: Improper Filtering of Special Elements

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-502: Deserialization of Untrusted Data

CWE-138: Improper Neutralization of Special Elements

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')