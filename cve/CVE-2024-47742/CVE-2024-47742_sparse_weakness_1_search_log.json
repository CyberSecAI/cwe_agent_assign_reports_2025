{
  "method": "sparse_weakness_1",
  "query": "In the Linux kernel, the following vulnerability has been resolved firmware_loader Block path traversal Most firmware names are hardcoded strings, or are constructed from fairly constrained format strings where the dynamic parts are just some hex numbers or such. However, there are a couple codepaths in the kernel where firmware file names contain string components that are passed through from a device or semi-privileged userspace the ones I could find (not counting interfaces that require root privileges) are - lpfc_sli4_request_firmware_update() seems to construct the firmware filename from ModelName, a string that was previously parsed out of some descriptor (Vital Product Data) in lpfc_fill_vpd() - nfp_net_fw_find() seems to construct a firmware filename from a model name coming from nfp_hwinfo_lookup(pf->hwinfo, nffw.partno), which I think parses some descriptor that was read from the device. (But this case likely isnt exploitable because the format string looks like netronome/nic_%s, and there shouldnt be any *folders* starting with netronome/nic_. The previous case was different because there, the %s is *at the start* of the format string.) - module_flash_fw_schedule() is reachable from the ETHTOOL_MSG_MODULE_FW_FLASH_ACT netlink command, which is marked as GENL_UNS_ADMIN_PERM (meaning CAP_NET_ADMIN inside a user namespace is enough to pass the privilege check), and takes a userspace-provided firmware name.",
  "keyphrases": {
    "weakness": "path traversal"
  },
  "timestamp": "2025-07-13T18:24:23.343441",
  "results_count": 10,
  "results_summary": [
    {
      "doc_id": "22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "score": 858.6358014665175
    },
    {
      "doc_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "score": 852.5956925985097
    },
    {
      "doc_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "score": 839.7566994761816
    },
    {
      "doc_id": "125",
      "name": "Out-of-bounds Read",
      "score": 838.3875648494287
    },
    {
      "doc_id": "23",
      "name": "Relative Path Traversal",
      "score": 832.0355590190186
    }
  ]
}