# Raw Retriever Results for CVE-2024-47742

# Raw Retriever Results for CVE-2024-47742
## Query
In the Linux kernel, the following vulnerability has been resolved firmware_loader Block path traversal Most firmware names are hardcoded strings, or are constructed from fairly constrained format strings where the dynamic parts are just some hex numbers or such. However, there are a couple codepaths in the kernel where firmware file names contain string components that are passed through from a device or semi-privileged userspace the ones I could find (not counting interfaces that require root privileges) are - lpfc_sli4_request_firmware_update() seems to construct the firmware filename from ModelName, a string that was previously parsed out of some descriptor (Vital Product Data) in lpfc_fill_vpd() - nfp_net_fw_find() seems to construct a firmware filename from a model name coming from nfp_hwinfo_lookup(pf->hwinfo, nffw.partno), which I think parses some descriptor that was read from the device. (But this case likely isnt exploitable because the format string looks like netronome/nic_%s, and there shouldnt be any *folders* starting with netronome/nic_. The previous case was different because there, the %s is *at the start* of the format string.) - module_flash_fw_schedule() is reachable from the ETHTOOL_MSG_MODULE_FW_FLASH_ACT netlink command, which is marked as GENL_UNS_ADMIN_PERM (meaning CAP_NET_ADMIN inside a user namespace is enough to pass the privilege check), and takes a userspace-provided firmware name.

## Keyphrases
- **weakness**: 'path traversal'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4856 | 0.5716 | 0.5192 | 0.5173 | 20 |
| Sparse | 287.6645 | 1000.0000 | 793.0852 | 829.8357 | 11 |
| Graph | 1.5777 | 2.8210 | 2.0044 | 1.9435 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 2.8210 | Allowed |
| 2 | 23 | Relative Path Traversal | base | 2.4700 | Allowed |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | base | 2.3296 | Allowed |
| 4 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 5 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 6 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 8 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 9 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 639 | Authorization Bypass Through User-Controlled Key | base | 2.1190 | Allowed |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 12 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 13 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 14 | 787 | Out-of-bounds Write | base | 1.7680 | Allowed |
| 15 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5716 | 0.5716 | Allowed |
| 2 | 1277 | Firmware Not Updateable | Base | 0.5515 | 0.5515 | Allowed |
| 3 | 912 | Hidden Functionality | Class | 0.5501 | 0.5501 | Allowed-with-Review |
| 4 | 798 | Use of Hard-coded Credentials | Base | 0.5475 | 0.5475 | Allowed |
| 5 | 57 | Path Equivalence: 'fakedir/../realdir/filename' | Variant | 0.5456 | 0.5456 | Allowed |
| 6 | 73 | External Control of File Name or Path | Base | 0.5449 | 0.5449 | Allowed |
| 7 | 259 | Use of Hard-coded Password | Variant | 0.5429 | 0.5429 | Allowed |
| 8 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.5365 | 0.5365 | Allowed |
| 9 | 29 | Path Traversal: '\..\filename' | Variant | 0.5360 | 0.5360 | Allowed |
| 10 | 321 | Use of Hard-coded Cryptographic Key | Variant | 0.5328 | 0.5328 | Allowed |
| 11 | 641 | Improper Restriction of Names for Files and Other Resources | Base | 0.5019 | 0.5019 | Allowed |
| 12 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4997 | 0.4997 | Discouraged |
| 13 | 1243 | Sensitive Non-Volatile Information Not Protected During Debug | Base | 0.4937 | 0.4937 | Allowed |
| 14 | 67 | Improper Handling of Windows Device Names | Variant | 0.4925 | 0.4925 | Allowed |
| 15 | 134 | Use of Externally-Controlled Format String | Base | 0.4924 | 0.4924 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 1000.0000 | 1000.0000 | Allowed |
| 2 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 852.5957 | 852.5957 | Allowed |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | 839.7567 | 839.7567 | Allowed |
| 4 | 125 | Out-of-bounds Read | 838.3876 | 838.3876 | Allowed |
| 5 | 23 | Relative Path Traversal | 832.0356 | 832.0356 | Allowed |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 829.8357 | 829.8357 | Allowed |
| 7 | 116 | Improper Encoding or Escaping of Output | 816.5825 | 816.5825 | Allowed-with-Review |
| 8 | 1333 | Inefficient Regular Expression Complexity | 812.5599 | 812.5599 | Allowed |
| 9 | 863 | Incorrect Authorization | 807.6189 | 807.6189 | Allowed-with-Review |
| 10 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 806.9002 | 806.9002 | Discouraged |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | 287.6645 | 287.6645 | Allowed |
