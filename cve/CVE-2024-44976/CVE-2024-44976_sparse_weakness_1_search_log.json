{
  "method": "sparse_weakness_1",
  "query": "In the Linux kernel, the following vulnerability has been resolved ata pata_macio Fix DMA table overflow Kolbjrn and Jonas reported that their 32-bit PowerMacs were crashing in pata-macio since commit 09fe2bfa6b83 (ata pata_macio Fix max_segment_size with PAGE_SIZE == 64K). For example kernel BUG at drivers/ata/pata_macio.c544! Oops Exception in kernel mode, sig 5 [#1] BE PAGE_SIZE=4K MMU=Hash SMP NR_CPUS=2 DEBUG_PAGEALLOC PowerMac ... NIP pata_macio_qc_prep+0xf4/0x190 LR pata_macio_qc_prep+0xfc/0x190 Call Trace 0xc1421660 (unreliable) ata_qc_issue+0x14c/0x2d4 __ata_scsi_queuecmd+0x200/0x53c ata_scsi_queuecmd+0x50/0xe0 scsi_queue_rq+0x788/0xb1c __blk_mq_issue_directly+0x58/0xf4 blk_mq_plug_issue_direct+0x8c/0x1b4 blk_mq_flush_plug_list.part.0+0x584/0x5e0 __blk_flush_plug+0xf8/0x194 __submit_bio+0x1b8/0x2e0 submit_bio_noacct_nocheck+0x230/0x304 btrfs_work_helper+0x200/0x338 process_one_work+0x1a8/0x338 worker_thread+0x364/0x4c0 kthread+0x100/0x104 start_kernel_thread+0x10/0x14 That commit increased max_segment_size to 64KB, with the justification that the SCSI core was already using that size when PAGE_SIZE == 64KB, and that there was existing logic to split over-sized requests. However with a sufficiently large request, the splitting logic causes each sg to be split into two commands in the DMA table, leading to overflow of the DMA table, triggering the BUG_ON(). With default set",
  "keyphrases": {
    "weakness": "DMA table overflow"
  },
  "timestamp": "2025-07-13T15:51:54.953759",
  "results_count": 10,
  "results_summary": [
    {
      "doc_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 598.2298120842012
    },
    {
      "doc_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 589.0325692719023
    },
    {
      "doc_id": "190",
      "name": "Integer Overflow or Wraparound",
      "score": 564.6359341663222
    },
    {
      "doc_id": "674",
      "name": "Uncontrolled Recursion",
      "score": 544.2190275751093
    },
    {
      "doc_id": "125",
      "name": "Out-of-bounds Read",
      "score": 537.5053065241076
    }
  ]
}