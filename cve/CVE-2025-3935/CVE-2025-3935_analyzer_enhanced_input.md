## Vulnerability Description
ScreenConnect versions 25.2.3 and earlier versions may be susceptible to a ViewState **code injection** attack. ASP.NET Web Forms use ViewState to preserve page and control state, with data encoded using Base64 protected by machine keys. It is important to note that to obtain these machine keys, privileged system level access must be obtained. If these machine keys are compromised, attackers could create and send a malicious ViewState to the website, potentially leading to remote code execution on the server. The risk does not originate from a vulnerability introduced by ScreenConnect, but from platform level behavior. This had no direct impact to ScreenConnect Client. ScreenConnect 2025.4 patch disables ViewState and removes any dependency on it.

### Vulnerability Description Key Phrases
- **weakness:** **code injection**
- **impact:** remote code execution
- **vector:** malicious ViewState
- **attacker:** attackers
- **product:** ScreenConnect
- **version:** 25.2.3 and earlier versions
- **component:** ASP.NET Web Forms

## CVE Reference Links Content Summary
**1.  Content from www.connectwise.com_473c0f4a_20250624_162653.html (text)**

*   **Relevance:** This document discusses the ScreenConnect 25.2.4 security patch and the vulnerability related to the ViewState code injection attack.
*   **Root cause of vulnerability:** ASP.NET Web Forms use ViewState to preserve page and control state, and the data is encoded using Base64, protected by machine keys. If the machine keys are compromised, attackers could create and send a malicious ViewState to the website.
*   **Weaknesses/vulnerabilities present:** ViewState code injection vulnerability (CVE-2025-3935) and Improper Authentication (CWE-287).
*   **Impact of exploitation:** Remote code execution on the server.
*   **Attack vectors:** Sending a crafted malicious ViewState.
*   **Required attacker capabilities/position:** Compromise of machine keys.
*   **Mitigation or fix:**
    *   Cloud: No action required.
    *   On-premises:
        *   Install the latest build for the current version.
        *   Upgrade the license if it's out of maintenance.
        *   Download and install version 25.2.4.
        *   Assess systems for signs of compromise after patching.
        *   If compromised, follow incident response procedures.

**2.  Content from www.connectwise.com_b135bca1_20250624_162652.html (text)**

*   **Relevance:** This document provides details about the ScreenConnect security patch and other security advisories.
*   **Summary:** This document mentions multiple security advisories, including:
    *   **June 9, 2025 Code Signing Certificate Rotation**: ScreenConnect, ConnectWise Automate, and RMM are updating the digital signing certificates.
    *   **May 28, 2025 Security Event Advisory**: Suspicious activity within the environment, affecting a small number of ScreenConnect customers. A patch was released.
    *   **April 24, 2025 ScreenConnect Security Patch Advisory**: Addresses an ASP.NET weakness, code injection, partners must patch their ScreenConnect instance immediately.
    *   **January 30, 2025 Phishing Alert**: Phishing attempts impersonating ScreenConnect login alerts.
    *   **March 21, 2024 Unauthenticated Access to Legacy AWS Server**: A security incident involving a legacy AWS server in the EU region with potential data exposure (email addresses)
    *   **March 4, 2024 Hardening Guidelines for ConnectWise ScreenConnect CVE-2024-1708 (Path Traversal)**: Advice on patching ScreenConnect, including file system review, event log checks, and Mandiant hardening guide.
    *   **February 21, 2024 ConnectWise ScreenConnect Vulnerability CWE-288**: Instructions on upgrading ScreenConnect, addressing license errors, identifying issues, and checking for malicious activity.
    *   **February 20, 2024 Patch Immediately - Critical ScreenConnect Vulnerability**: Advisory on patching a ScreenConnect vulnerability, including indicators of compromise (IOCs) such as specific IP addresses.
    *   **February 9, 2024 FortiSIEM Critical Vulnerabilities**: Vulnerabilities (CVE-2024-23108 and CVE-2024-23109) in FortiSIEM, the advice to upgrade to version 7.1.3
    *   **January 22, 2024 Brute-Force Attempts on ConnectWise ScreenConnect**: Malicious activity, brute-force attacks, advice to use MFA, and best practices for security.
    *   **October 18, 2023 Beware the Hook: Malicious Actor Phishing Email Targeting ScreenConnect Users**: Phishing campaigns, impersonating login alerts.
    *   **October 4, 2023 WebP/libwebp Zero-Day Vulnerabilities**: Disclosing vulnerabilities related to WebP images (CVE-2023-4863), impacting the libwebp library. The advice to update to 23.7.8 or later versions.
    *   **April 14, 2023 Microsoft Message Queuing Vulnerability**: Vulnerability affecting Windows OS, executing remote code, advice to follow the steps in Microsoft's mitigations.
    *   **December 20, 2022 Best Practice Reminder – Download from Trusted Sources**: Malicious Python packages on PyPI, with SDK from SentinelOne, download content directly from the vendor and verify the content.
    *   **December 13, 2022 SentinelOne/Aikido Vulnerability – Action Required**: Time-of-check Time-of-use (TOCTOU) race condition, SentinelOne agents are vulnerable.
    *   **November 29, 2022 Remaining Vigilant Against Email Phishing Attempts**: Phishing campaign mimicking ConnectWise Control New Login Alert emails.
    *   **May 5, 2022 Email Security Best Practices**: Reminders on email security best practices, including SPF, DKIM, and DMARC.
    *   **January 31, 2022 ConnectWise Virtual Community Update**: Unauthorized access to virtual community search.

*   **Weaknesses/vulnerabilities present:**
    *   ViewState code injection vulnerability (CVE-2025-3935)
    *   CWE-287 Improper Authentication
    *   CVE-2024-1708 (Path Traversal)
    *   CWE-288
    *   CVE-2024-23108 and CVE-2024-23109
    *   Time-of-check Time-of-use (TOCTOU) Race Condition

*   **Impact of exploitation:** Remote code execution, data breaches.
*   **Mitigation or fix:** Patching, upgrades, incident response, and security hardening.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.523 |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.510 |
| 3 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.507 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.501 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.500 |
| 6 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.499 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.499 |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.496 |
| 9 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | dense | 0.522 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-346: Origin Validation Error

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-502: Deserialization of Untrusted Data

CWE-306: Missing Authentication for Critical Function

CWE-863: Incorrect Authorization

CWE-203: Observable Discrepancy

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-347: Improper Verification of Cryptographic Signature

CWE-1021: Improper Restriction of Rendered UI Layers or Frames

CWE-471: Modification of Assumed-Immutable Data (MAID)