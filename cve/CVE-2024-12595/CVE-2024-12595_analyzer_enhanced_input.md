## Vulnerability Description
The AHAthat Plugin WordPress plugin through 1.6 does not escape the $_SERVER[REQUEST_URI] parameter before outputting it back in an attribute, which could lead to Reflected Cross-Site Scripting in old web browsers

### Vulnerability Description Key Phrases
- **rootcause:** **improper escaping**
- **weakness:** **cross-site scripting**
- **impact:** cross-site scripting
- **product:** AHAthat Plugin WordPress plugin
- **version:** through 1.6

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-12595.

- **Root cause of vulnerability**: The plugin does not properly sanitize the `$_SERVER['REQUEST_URI']` parameter before outputting it within an attribute.
- **Weaknesses/vulnerabilities present**: Reflected Cross-Site Scripting (XSS).
- **Impact of exploitation**: An attacker can inject malicious scripts that execute in the victim's browser, potentially leading to session hijacking, data theft, or other malicious actions.
- **Attack vectors**: The attack is triggered by a crafted URL containing the malicious payload in the `REQUEST_URI`, specifically within the `page=share_report`, `order` and `cat` parameters.
- **Required attacker capabilities/position**: The attacker needs to trick a user into clicking a specially crafted link, and the user must be using a web browser that is susceptible to this vulnerability (older browsers are specifically mentioned).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.307 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.265 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.258 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.227 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.218 |
| 6 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | sparse | 0.214 |
| 7 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.208 |
| 8 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.203 |
| 9 | 473 | PHP External Variable Modification | Variant | Allowed | dense | 0.450 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag

CWE-862: Missing Authorization

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-473: PHP External Variable Modification

CWE-94: Improper Control of Generation of Code ('Code Injection')