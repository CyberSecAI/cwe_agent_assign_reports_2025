## Vulnerability Description
Ruijie NBR800G gateway NBR_RGOS_11.1(6)B4P9 is vulnerable to command execution in /itbox_pi/networksafe.php via the province parameter.

### Vulnerability Description Key Phrases
- **impact:** command execution
- **product:** Ruijie NBR800G gateway
- **version:** NBR_RGOS_11.1(6)B4P9
- **component:** /itbox_pi/networksafe.php

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-51027:

**Root Cause:**
The vulnerability stems from the insecure handling of the `province` parameter within the `/itbox_pi/networksafe.php` script. This parameter is directly incorporated into a command string without proper sanitization or validation, leading to command injection.

**Weaknesses/Vulnerabilities:**
- **Command Injection:** The primary weakness is the ability to inject arbitrary commands through the `province` parameter. The application executes these commands on the server.
- **Lack of Input Sanitization:** The application fails to sanitize or validate user-supplied input (`province` parameter) before using it in a system command.

**Impact of Exploitation:**
- **Remote Command Execution:** Attackers can execute arbitrary commands on the affected system.
- **Server Compromise:** Successful exploitation allows an attacker to obtain server permissions, potentially leading to full system compromise.
- **Denial of Service:** The attacker can cause the server to crash by executing commands that disrupt normal operation.

**Attack Vectors:**
- **HTTP POST Request:** The vulnerability is triggered through an HTTP POST request to the `/itbox_pi/networksafe.php` endpoint.
- **`province` Parameter:** The malicious command is injected via the `province` parameter in the POST data.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs network access to the Ruijie NBR800G gateway.
- **Ability to send HTTP requests:** The attacker must be able to send crafted HTTP POST requests to the vulnerable endpoint, including the `province` parameter with malicious code
- **Authentication:**  The provided information suggests that the vulnerability is accessible to an authenticated user, as it includes a cookie with 'user=admin'. However, it is not explicitly stated that authentication is required.

**Additional Details:**
- The vulnerable software is: Ruijie NBR800G gateway NBR_RGOS_11.1(6)B4P9.
- The specific vulnerable endpoint is: `/itbox_pi/networksafe.php`.
- The vulnerability can be verified by injecting commands into the `province` parameter of the HTTP POST request.
- The provided POC demonstrates how to inject the `id` command using backticks and redirect the output to a file named `1.php` on the server.

This information provides more detail than the official CVE description placeholder.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | sparse | 0.034 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.034 |
| 3 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.032 |
| 4 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.032 |
| 5 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.031 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.031 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.030 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.030 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.554 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-790: Improper Filtering of Special Elements

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-23: Relative Path Traversal

CWE-116: Improper Encoding or Escaping of Output

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs