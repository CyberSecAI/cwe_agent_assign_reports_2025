## Vulnerability Description
Calling any of the Parse functions on Go source code which contains deeply nested literals can cause a panic due to **stack exhaustion**.

### Vulnerability Description Key Phrases
- **rootcause:** **stack exhaustion**
- **impact:** panic
- **vector:** deeply nested literals
- **product:** Go
- **component:** Parse functions

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-34155:

**Root Cause of Vulnerability:**
The vulnerability is caused by a stack exhaustion issue in the `go/parser` package when parsing Go source code containing deeply nested literals. Specifically, calling any of the `Parse*` functions on such code can lead to a panic due to excessive stack usage.

**Weaknesses/Vulnerabilities Present:**
- Stack exhaustion vulnerability in the `go/parser` package.
- The vulnerability lies in how the parser handles deeply nested literals during the parsing process.

**Impact of Exploitation:**
- Denial of Service (DoS) - Successful exploitation leads to a panic due to stack exhaustion, effectively crashing the program or service using the vulnerable `go/parser` functionality.

**Attack Vectors:**
- Inputting specially crafted Go source code with deeply nested literals to any function that utilizes the vulnerable `go/parser` package.

**Required Attacker Capabilities/Position:**
- An attacker needs to be able to provide the vulnerable application or service with the specially crafted Go source code, likely via a file or string input.
-  No special privileges are required; a low-privileged attacker can cause a DoS.
- The attacker needs to be able to cause the vulnerable code to call any of the parse functions (`ParseDir`, `ParseExpr`, `ParseExprFrom`, `ParseFile`).

**Additional Notes:**

- The vulnerability affects Go versions before 1.22.7 and from 1.23.0-0 before 1.23.1.
- The fix involves tracking the depth of nested literals to prevent excessive stack consumption.
- This issue is tracked as Go issue #69138.
- NetApp products using the vulnerable versions of Go are also affected.
- The vulnerability has a CVSS v3.1 score of 4.3 (Medium) with the vector `CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L`

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | alternate_terms | 1.000 |
| 2 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 3 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | alternate_terms | 1.000 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.165 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.153 |
| 6 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.138 |
| 7 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.130 |
| 8 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.123 |
| 9 | 1108 | Excessive Reliance on Global Variables | Base | Allowed | dense | 0.371 |
| 10 | 476 | NULL Pointer Dereference | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1325: Improperly Controlled Sequential Memory Allocation

CWE-674: Uncontrolled Recursion

CWE-789: Memory Allocation with Excessive Size Value

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-400: Uncontrolled Resource Consumption

CWE-121: Stack-based Buffer Overflow

CWE-125: Out-of-bounds Read

CWE-1108: Excessive Reliance on Global Variables

CWE-476: NULL Pointer Dereference