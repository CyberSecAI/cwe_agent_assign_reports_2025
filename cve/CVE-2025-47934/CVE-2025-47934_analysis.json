{
  "cve_id": "CVE-2025-47934",
  "description": "OpenPGP.js is a JavaScript implementation of the OpenPGP protocol. Startinf in version 5.0.1 and prior to versions 5.11.3 and 6.1.1, a maliciously modified message can be passed to either `openpgp.verify` or `openpgp.decrypt`, causing these functions to **return a valid signature verification result while returning data that was not actually signed**. This flaw allows signature verifications of inline (non-detached) signed messages (using `openpgp.verify`) and signed-and-encrypted messages (using `openpgp.decrypt` with `verificationKeys`) to be spoofed, since both functions return extracted data that may not match the data that was originally signed. Detached signature verifications are not affected, as no signed data is returned in that case. In order to spoof a message, the attacker needs a single valid message signature (inline or detached) as well as the plaintext data that was legitimately signed, and can then construct an inline-signed message or signed-and-encrypted message with any data of the attackers choice, which will appear as legitimately signed by affected versions of OpenPGP.js. In other words, any inline-signed message can be modified to return any other data (while still indicating that the signature was valid), and the same is true for signed+encrypted messages if the attacker can obtain a valid signature and encrypt a new message (of the attackers choice) together with that signature. The issue has been patched in versions 5.11.3 and 6.1.1. Some workarounds are available. When verifying inline-signed messages, extract the message and signature(s) from the message returned by `openpgp.readMessage`, and verify the(/each) signature as a detached signature by passing the signature and a new message containing only the data (created using `openpgp.createMessage`) to `openpgp.verify`. When decrypting and verifying signed+encrypted messages, decrypt and verify the message in two steps, by first calling `openpgp.decrypt` without `verificationKeys`, and then passing the returned signature(s) and a new message containing the decrypted data (created using `openpgp.createMessage`) to `openpgp.verify`.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "return a valid signature verification result while returning data that was not actually signed",
    "impact": "spoof signature verifications",
    "vector": "maliciously modified message",
    "attacker": "",
    "product": "OpenPGP.js",
    "version": "5.0.1 to prior to 5.11.3 and 6.1.1",
    "component": "openpgp.verify or openpgp.decrypt"
  },
  "reference_content": "```text\n* Root cause of vulnerability:\n  * A maliciously modified message can be passed to either `openpgp.verify` or `openpgp.decrypt`, causing these functions to return a valid signature verification result while returning data that was not actually signed.\n* Weaknesses/vulnerabilities present:\n  * Allows signature verifications of inline (non-detached) signed messages (using `openpgp.verify`) and signed-and-encrypted messages (using `openpgp.decrypt` with `verificationKeys`) to be spoofed, since both functions return extracted data that may not match the data that was originally signed.\n* Impact of exploitation:\n  * Any inline-signed message can be modified to return any other data (while still indicating that the signature was valid), and the same is true for signed+encrypted messages if the attacker can obtain a valid signature and encrypt a new message (of the attacker's choice) together with that signature.\n* Attack vectors:\n  * The attacker needs a single valid message signature (inline or detached) as well as the plaintext data that was legitimately signed, and can then construct an inline-signed message or signed-and-encrypted message with any data of the attacker's choice.\n* Mitigation or fix:\n  * The issue has been patched in versions 5.11.3 and 6.1.1.\n  * Workarounds:\n    * When verifying inline-signed messages, extract the message and signature(s) from the message returned by `openpgp.readMessage`, and verify the(/each) signature as a detached signature by passing the signature and a new message containing only the data (created using `openpgp.createMessage`) to `openpgp.verify`.\n    * When decrypting and verifying signed+encrypted messages, decrypt and verify the message in two steps, by first calling `openpgp.decrypt` without `verificationKeys`, and then passing the returned signature(s) and a new message containing the decrypted data (created using `openpgp.createMessage`) to `openpgp.verify`.\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-347 | Improper Verification of Cryptographic Signature | 1.0 | Base | Allowed | Primary CWE: The root cause is the **improper verification of the cryptographic signature** which allows the attacker to spoof the signature. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-347, \"Improper Verification of Cryptographic Signature.\" This is a base-level CWE, which is appropriate. CWE-347 is a child of the class CWE-345 \"Insufficient Verification of Data Authenticity\", indicating that the root cause of the vulnerability involves a failure to adequately check the authenticity of data.\n\n```mermaid\ngraph TD\n    cwe347[\"CWE-347: Improper Verification of Cryptographic Signature\"]\n    cwe345[\"CWE-345: Insufficient Verification of Data Authenticity\"]\n    \n    cwe347 -->|CHILDOF| cwe345\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe347 primary\n    class cwe345 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper verification of the cryptographic signature (CWE-347)**. This leads to the ability to spoof signature verifications, allowing an attacker to modify messages and have them appear legitimately signed. The root cause is the **failure to properly validate the signature**, enabling the attacker to return data that was not actually signed.\n\n## Summary of Analysis\nThe analysis is strongly based on the provided evidence, particularly the vulnerability description and the CVE reference links content summary. The vulnerability description clearly states that the functions `openpgp.verify` and `openpgp.decrypt` **return a valid signature verification result while returning data that was not actually signed**. The CVE reference links content summary reinforces this by stating that the root cause is that a maliciously modified message can cause these functions to return a valid signature even if the data is not signed. The retriever results also list CWE-347 as the top candidate.\n\nThe hierarchical relationships influenced the final selection by confirming that CWE-347 is at the appropriate level of specificity.\n\nThe selected CWE, CWE-347, is at the optimal level of specificity because it directly addresses the root cause of the vulnerability which is the **improper verification of the cryptographic signature**.\n\nRelevant CWE Information:\n- CWE-347: Improper Verification of Cryptographic Signature\n  - The vulnerability description explicitly states that the functions return a valid signature verification result even when the data is not actually signed. This directly aligns with the description of CWE-347, which involves the product not verifying or incorrectly verifying the cryptographic signature for data.\n  - The security implication is that an attacker can spoof signature verifications, leading to potentially severe consequences, such as accepting malicious data as legitimate.\n  - CWE-347 is a child of CWE-345, Insufficient Verification of Data Authenticity.\n  - The mapping guidance for CWE-347 allows its use at the Base level of abstraction.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-347 | Improper Verification of Cryptographic Signature | 1.0 | Base | Allowed | Primary CWE: The root cause is the **improper verification of the cryptographic signature** which allows the attacker to spoof the signature. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-347, \"Improper Verification of Cryptographic Signature.\" This is a base-level CWE, which is appropriate. CWE-347 is a child of the class CWE-345 \"Insufficient Verification of Data Authenticity\", indicating that the root cause of the vulnerability involves a failure to adequately check the authenticity of data.\n\n```mermaid\ngraph TD\n    cwe347[\"CWE-347: Improper Verification of Cryptographic Signature\"]\n    cwe345[\"CWE-345: Insufficient Verification of Data Authenticity\"]\n    \n    cwe347 -->|CHILDOF| cwe345\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe347 primary\n    class cwe345 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper verification of the cryptographic signature (CWE-347)**. This leads to the ability to spoof signature verifications, allowing an attacker to modify messages and have them appear legitimately signed. The root cause is the **failure to properly validate the signature**, enabling the attacker to return data that was not actually signed.\n\n## Summary of Analysis\nThe analysis is strongly based on the provided evidence, particularly the vulnerability description and the CVE reference links content summary. The vulnerability description clearly states that the functions `openpgp.verify` and `openpgp.decrypt` **return a valid signature verification result while returning data that was not actually signed**. The CVE reference links content summary reinforces this by stating that the root cause is that a maliciously modified message can cause these functions to return a valid signature even if the data is not signed. The retriever results also list CWE-347 as the top candidate.\n\nThe hierarchical relationships influenced the final selection by confirming that CWE-347 is at the appropriate level of specificity.\n\nThe selected CWE, CWE-347, is at the optimal level of specificity because it directly addresses the root cause of the vulnerability which is the **improper verification of the cryptographic signature**.\n\nRelevant CWE Information:\n- CWE-347: Improper Verification of Cryptographic Signature\n  - The vulnerability description explicitly states that the functions return a valid signature verification result even when the data is not actually signed. This directly aligns with the description of CWE-347, which involves the product not verifying or incorrectly verifying the cryptographic signature for data.\n  - The security implication is that an attacker can spoof signature verifications, leading to potentially severe consequences, such as accepting malicious data as legitimate.\n  - CWE-347 is a child of CWE-345, Insufficient Verification of Data Authenticity.\n  - The mapping guidance for CWE-347 allows its use at the Base level of abstraction.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-347:**\n- 347 (Improper Verification of Cryptographic Signature) - ROOT\n\n\n**Chain starting from CWE-345:**\n- 345 (Insufficient Verification of Data Authenticity) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "source": "sparse"
      },
      "similarity": 2177.149203110217
    },
    {
      "metadata": {
        "doc_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "source": "sparse"
      },
      "similarity": 1932.5306908143991
    },
    {
      "metadata": {
        "doc_id": "203",
        "name": "Observable Discrepancy",
        "source": "sparse"
      },
      "similarity": 1776.5829192333101
    },
    {
      "metadata": {
        "doc_id": "295",
        "name": "Improper Certificate Validation",
        "source": "sparse"
      },
      "similarity": 1731.960287432839
    },
    {
      "metadata": {
        "doc_id": "325",
        "name": "Missing Cryptographic Step",
        "source": "sparse"
      },
      "similarity": 1683.0483451319462
    },
    {
      "metadata": {
        "doc_id": "451",
        "name": "User Interface (UI) Misrepresentation of Critical Information",
        "source": "sparse"
      },
      "similarity": 1629.970299800241
    },
    {
      "metadata": {
        "doc_id": "345",
        "name": "Insufficient Verification of Data Authenticity",
        "source": "sparse"
      },
      "similarity": 1563.0507365654207
    },
    {
      "metadata": {
        "doc_id": "208",
        "name": "Observable Timing Discrepancy",
        "source": "sparse"
      },
      "similarity": 1549.739328438525
    },
    {
      "metadata": {
        "doc_id": "649",
        "name": "Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking",
        "type": "Base",
        "original_content": "The product uses obfuscation or encryption of inputs that should not be mutable by an external actor, but the product does not use integrity checks to detect if those inputs have been modified.",
        "keyphrase_source": "weakness:return a valid signature verification result while returning data that was not actually signed",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.49024289983789926,
            "graph": 1.6065483123106996
          }
        }
      },
      "similarity": 0.49024289983789926
    },
    {
      "doc_id": "370",
      "text": "CWE-370: Missing Check for Certificate Revocation after Initial Check",
      "score": 1.91472,
      "metadata": {
        "doc_id": "370",
        "name": "Missing Check for Certificate Revocation after Initial Check",
        "type": "variant",
        "original_content": "CWE-370: Missing Check for Certificate Revocation after Initial Check",
        "relationships": [
          {
            "source_id": "370",
            "target_id": "298",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "370",
            "target_id": "297",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "370",
            "target_id": "296",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "370",
            "target_id": "299",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "299",
            "target_id": "370",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 0.7,
          "abstraction_path": 0.6080000000000001,
          "peer_group": 0.9
        },
        "abstraction_factor": 1.2,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "370",
                  "297",
                  "PEEROF"
                ]
              ],
              "score": 0.7,
              "type": "relationship_chain",
              "source": "297"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "295",
                  "299",
                  "PARENTOF"
                ],
                [
                  "299",
                  "370",
                  "PARENTOF"
                ]
              ],
              "score": 0.6080000000000001,
              "type": "abstraction_path_down",
              "source": "295"
            },
            "peer_relationship": {
              "path": [
                [
                  "370",
                  "297",
                  "PEEROF"
                ]
              ],
              "score": 0.9,
              "type": "peer_relationship",
              "source": "297"
            }
          }
        },
        "abstraction_level": "variant",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 1.91472
          }
        }
      },
      "similarity": 1.91472
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-347",
      "CWE-345"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}