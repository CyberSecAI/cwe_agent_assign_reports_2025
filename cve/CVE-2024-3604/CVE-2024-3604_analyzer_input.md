# Vulnerability Information: CVE-2024-3604

## Vulnerability Description
The OSM - OpenStreetMap plugin for WordPress is vulnerable to SQL Injection via the tagged_filter attribute of the osm_map_v3 shortcode in all versions up to, and including, 6.0.2 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with contributor-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** authenticated attackers
- **product:** OSM - OpenStreetMap plugin for WordPress
- **version:** all versions up to and including 6.0.2
- **component:** osm_map_v3 shortcode

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-3604

**Root Cause of Vulnerability:**
The vulnerability is due to insufficient escaping of user-supplied input and a lack of proper preparation within the existing SQL query within the 'osm\_map\_v3' shortcode. Specifically, the `tagged_filter` attribute of the shortcode is vulnerable to SQL injection.

**Weaknesses/Vulnerabilities Present:**
*   **SQL Injection:** The primary vulnerability is SQL injection, which occurs due to improper handling of the `tagged_filter` parameter. This allows an attacker to insert arbitrary SQL code into the database query.

**Impact of Exploitation:**
*   **Sensitive Information Disclosure:** Successful exploitation can allow attackers to extract sensitive data from the WordPress database.
*   **Potential for Full Database Compromise:**  While the provided information focuses on information extraction, SQL injection vulnerabilities can be leveraged for more severe attacks, including complete database compromise.

**Attack Vectors:**
*   **Network:** The attack is network-based as it involves crafted HTTP requests to the WordPress site.
*   **Shortcode Manipulation:**  The attacker crafts a malicious `osm_map_v3` shortcode, injecting SQL code through the `tagged_filter` attribute.

**Required Attacker Capabilities/Position:**
*   **Authenticated Access:** Attackers need to be authenticated WordPress users with at least contributor-level access to inject the malicious shortcode via a post/page.
*   **Knowledge of Vulnerable Parameter:** The attacker needs to know that the `tagged_filter` parameter within the `osm_map_v3` shortcode is vulnerable.

**Additional Details:**

*   **Affected Software:** The vulnerability is in the "OSM â€“ OpenStreetMap" WordPress plugin, specifically versions 6.0.3 and earlier.
*   **Patch:** The vulnerability is fixed in version 6.0.4 of the plugin.
*  **CVSS Score:** 9.9 (Critical)
*  **CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.569 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.528 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.520 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.511 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.505 |
| 7 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.501 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.497 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.479 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |

