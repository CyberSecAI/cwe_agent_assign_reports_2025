## Vulnerability Description
A Prototype Pollution issue in abw badger-database 1.2.1 allows an attacker to execute arbitrary code via dist/badger-database.esm.

### Vulnerability Description Key Phrases
- **rootcause:** **prototype pollution**
- **impact:** arbitrary code execution and execute arbitrary code
- **attacker:** attackers
- **product:** abw badger-database
- **version:** 1.2.1
- **component:** dist/badger-database.esm

## CVE Reference Links Content Summary
```json
{
  "vulnerability_details": {
    "root_cause": "The vulnerability arises from the ability to manipulate the prototype of an object by using the `__proto__` or `constructor.prototype` properties which are not properly sanitized.",
    "weaknesses": [
      "Prototype Pollution"
    ],
    "impact": "An attacker can alter the behavior of all objects inheriting from the affected prototype. This can lead to denial of service, remote code execution, or cross-site scripting attacks.",
    "attack_vectors": [
      "By providing crafted JSON input containing `__proto__` or `constructor.prototype` properties to the `setDebug` function."
    ],
      "required_capabilities": "The attacker needs to be able to control the input to the `setDebug` function."
  },
  "additional_information": {
    "affected_package": "@abw/badger-database",
    "affected_version": "1.2.1",
    "poc": "(async () => {\n  const lib = await import('@abw/badger-database');\n\nvar BAD_JSON = JSON.parse('{\"__proto__\":{\"polluted\":true}}');\nvar victim = {}\nconsole.log(\"Before Attack: \", JSON.stringify(victim.__proto__));\ntry {\n  lib.setDebug (BAD_JSON)\n} catch (e) { }\nconsole.log(\"After Attack: \", JSON.stringify(victim.__proto__));\ndelete Object.prototype.polluted;\n})();",
    "remediation": "Users of this module are urged to implement proper sanitization and validation over user's supplied inputs, such as blocking inputs containing `__proto__` and `contructor.prototype`."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.229 |
| 2 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.129 |
| 3 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | sparse | 0.114 |
| 4 | 112 | Missing XML Validation | Base | Allowed | sparse | 0.101 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.095 |
| 6 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.093 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.091 |
| 8 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.091 |
| 9 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | dense | 0.507 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1321: Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')

CWE-1188: Initialization of a Resource with an Insecure Default

CWE-843: Access of Resource Using Incompatible Type ('Type Confusion')

CWE-112: Missing XML Validation

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-502: Deserialization of Untrusted Data

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-409: Improper Handling of Highly Compressed Data (Data Amplification)

CWE-471: Modification of Assumed-Immutable Data (MAID)