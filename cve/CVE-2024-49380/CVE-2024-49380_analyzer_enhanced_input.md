## Vulnerability Description
Plenti, a static site generator, has an arbitrary file write vulnerability in versions prior to 0.7.2. The `/postLocal` endpoint is vulnerable to an arbitrary file write vulnerability when a plenti user serves their website. This issue may lead to Remote Code Execution. Version 0.7.2 fixes the vulnerability.

### Vulnerability Description Key Phrases
- **impact:** Remote Code Execution and arbitrary file write
- **attacker:** plenti user
- **product:** Plenti
- **version:** prior to 0.7.2
- **component:** /postLocal endpoint

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2024-49380:

**Root Cause:**

*   The vulnerability stems from the `/postLocal` endpoint within the `serve.go` file of the Plenti project. This endpoint allows for arbitrary file write operations on the server hosting the Plenti website.

**Weaknesses/Vulnerabilities:**

*   **Arbitrary File Write:** The `/postLocal` endpoint takes user-supplied data (including file path and content) in a JSON format. It then writes this content to the specified file path using `os.WriteFile`. Crucially, there isn't sufficient validation or sanitization of the provided file paths, which allows an attacker to specify paths outside the intended project directory.
*   The code attempts to ensure the path is relative to the project, but this is flawed: `if len(change.File) > 0 && change.File[0:1] == "/" { change.File = "." + change.File}`. This check only prepends a "." to paths that start with "/" but allows paths like `../evil.txt` to be written anywhere on the server.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** By exploiting the arbitrary file write vulnerability, an attacker can overwrite existing files or create new files on the server.  This could include injecting malicious code into server-side scripts, configuration files, or other sensitive locations to achieve remote code execution.

**Attack Vectors:**

*   An attacker sends a specially crafted POST request to the `/postLocal` endpoint of the Plenti server. This request includes JSON data defining the file path where the attacker wants to write the malicious file, and the content to be written.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to send HTTP POST requests to the vulnerable server. This is generally achievable for any user with access to the server hosting Plenti.
*   No authentication is required to exploit this vulnerability.

**Additional Notes:**

*   The vulnerability was found in Plenti version v0.7.1 and fixed in version v0.7.2.
*   The provided content also details a related Arbitrary File Deletion vulnerability (CVE-2024-49381) within the same endpoint.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.084 |
| 2 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.083 |
| 3 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.083 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.083 |
| 5 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.083 |
| 6 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.083 |
| 7 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.083 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.082 |
| 9 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | dense | 0.530 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-306: Missing Authentication for Critical Function

CWE-269: Improper Privilege Management

CWE-23: Relative Path Traversal

CWE-787: Out-of-bounds Write

CWE-20: Improper Input Validation

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-434: Unrestricted Upload of File with Dangerous Type