## Vulnerability Description
The License Manager for WooCommerce plugin for WordPress is vulnerable to unauthorized access of data due to a **missing capability check** on the showLicenseKey() and showAllLicenseKeys() functions in all versions up to, and including, 3.0.7. This makes it possible for authenticated attackers, with admin dashboard access (contributors by default due to WooCommerce) to view arbitrary decrypted license keys. The functions contain a referrer nonce check. However, these can be retrieved via the dashboard through the license JS variable.

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **impact:** view arbitrary decrypted license keys
- **attacker:** authenticated attackers with admin dashboard access
- **product:** License Manager for WooCommerce plugin for WordPress
- **version:** up to and including 3.0.7
- **component:** showLicenseKey() and showAllLicenseKeys() functions

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from a missing capability check in the `showLicenseKey()` and `showAllLicenseKeys()` functions within the License Manager for WooCommerce plugin. This allows unauthorized access to sensitive license keys.",
    "weaknesses": [
      "Improper Authorization",
       "Missing Capability Check"
    ],
    "impact": "Authenticated attackers with contributor or higher access can view arbitrary decrypted license keys.",
    "attack_vectors": "The vulnerability can be exploited by sending a POST request to the `wp_ajax_lmfwc_show_license_key` and `wp_ajax_lmfwc_show_all_license_keys` AJAX actions.",
    "attacker_capabilities": "The attacker needs to be an authenticated user with at least contributor role access to the WordPress admin dashboard. Additionally, they need to be able to obtain the nonce, which is available in the dashboard via the `license` JS variable."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.539 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.530 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.503 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.500 |
| 5 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.482 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.477 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.468 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.468 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.443 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-862: Missing Authorization

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-863: Incorrect Authorization

CWE-306: Missing Authentication for Critical Function

CWE-425: Direct Request ('Forced Browsing')

CWE-285: Improper Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-471: Modification of Assumed-Immutable Data (MAID)