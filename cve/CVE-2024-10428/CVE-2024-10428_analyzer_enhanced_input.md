## Vulnerability Description
A vulnerability was found in WAVLINK WN530H4, WN530HG4 and WN572HG3 up to 20221028. It has been rated as critical. This issue affects the function set_ipv6 of the file firewall.cgi. The manipulation of the argument dhcpGateway leads to **command injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** WAVLINK WN530H4 and WN530HG4 and WN572HG3
- **version:** up to 20221028
- **component:** firewall.cgi

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
The root cause is a command injection vulnerability within the `firewall.cgi` component of Wavlink network devices.

**Weaknesses/Vulnerabilities Present:**
- Command Injection: The vulnerability allows an attacker to inject and execute arbitrary system commands through the `firewall.cgi` component.
- Insufficient Input Sanitization: The application fails to properly sanitize user-supplied input before using it in system commands.

**Impact of Exploitation:**
- Arbitrary Code Execution: A successful exploit allows an attacker to execute arbitrary code on the affected device. This can lead to:
    - Full system compromise
    - Data exfiltration
    - Denial of service
    - Installation of backdoors
    - Network disruption

**Attack Vectors:**
- Network Access: An attacker needs network access to the device to exploit the vulnerability.
- Web Interface: The vulnerability is likely accessible through the web interface of the device.

**Required Attacker Capabilities/Position:**
- Authentication: The attacker needs to be authenticated to access the vulnerable component.
- Network access: The attacker needs to be on the same network or have access to the device web interface.

**Affected Devices:**
- Wavlink WN530H4
- Wavlink WN530HG4
- Wavlink WN572HG3

**Vulnerable Firmware versions:**
- WN530H4-WAVLINK_20220721
- WN530HG4-WAVLINK_20220809
- WN572HG3-WAVLINK_WO_20221028

The provided information is more specific than the placeholder CVE description, detailing the affected products and the specific attack vector (command injection in firewall.cgi).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.486 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.449 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.429 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.398 |
| 7 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.396 |
| 8 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.386 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.623 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-790: Improper Filtering of Special Elements

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-117: Improper Output Neutralization for Logs

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs