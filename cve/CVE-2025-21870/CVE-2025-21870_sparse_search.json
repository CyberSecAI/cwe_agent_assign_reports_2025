{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved ASoC SOF ipc4-topology Harden loops for looking up ALH copiers Other, non DAI copier widgets could have the same stream name (sname) as the ALH copier and in that case the copier->data is NULL, no alh_data is attached, which could lead to NULL pointer dereference. We could check for this NULL pointer in sof_ipc4_prepare_copier_module() and avoid the crash, but a similar loop in sof_ipc4_widget_setup_comp_dai() will miscalculate the ALH device count, causing broken audio. The correct fix is to harden the matching logic by making sure that the 1. widget is a DAI widget - so dai = w->private is valid 2. the dai (and thus the copier) is ALH copier",
  "keyphrases": {
    "weakness": [
      "NULL pointer dereference"
    ]
  },
  "timestamp": "2025-07-14 09:55:29",
  "cve_id": "CVE-2025-21870",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "476",
      "name": "NULL Pointer Dereference",
      "score": 603.3829437691904,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "824",
      "name": "Access of Uninitialized Pointer",
      "score": 557.7960790922939,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "252",
      "name": "Unchecked Return Value",
      "score": 546.4058177092204,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "617",
      "name": "Reachable Assertion",
      "score": 544.0484631589972,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "665",
      "name": "Improper Initialization",
      "score": 524.5784309991627,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 524.0295323229843,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "822",
      "name": "Untrusted Pointer Dereference",
      "score": 516.7270392287696,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "score": 511.85107118234913,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "908",
      "name": "Use of Uninitialized Resource",
      "score": 511.5977200714516,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 502.12781744199725,
      "search_source": "weakness:NULL pointer dereference"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 172.2757498019252,
      "search_source": "base_query"
    }
  ]
}