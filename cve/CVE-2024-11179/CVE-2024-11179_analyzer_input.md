# Vulnerability Information: CVE-2024-11179

## Vulnerability Description
The MStore API Create Native Android & iOS Apps On The Cloud plugin for WordPress is vulnerable to SQL Injection via the status_type parameter in all versions up to, and including, 4.15.7 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Subscriber-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** authenticated attackers
- **product:** MStore API Create Native Android & iOS Apps On The Cloud plugin for WordPress
- **version:** up to 4.15.7
- **component:** status_type parameter

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2024-11179:

**Root Cause:**

- The vulnerability is an SQL injection flaw caused by insufficient sanitization and validation of the `status_type` parameter within the `flutter_get_reviews` function.
- The code directly incorporates the unsanitized `status_type` parameter into an SQL query, allowing an attacker to inject arbitrary SQL code.

**Weaknesses/Vulnerabilities:**

- **SQL Injection:** The primary weakness is the direct insertion of user-supplied data into an SQL query without proper sanitization or parameterized queries.
- **Insufficient Input Validation:** The plugin does not validate that the `status_type` parameter is one of the expected values.
- **Lack of Prepared Statements:** The code uses `prepare` to prevent SQL injection, but not for the `status_filter`, as the `status_filter` is not treated as a parameter.

**Impact of Exploitation:**

- **Data Breach:** An attacker can exploit the SQL injection vulnerability to extract sensitive data from the database. This could include user credentials, customer information, and other confidential data.

**Attack Vectors:**

- **HTTP Request Parameter:** The attacker injects malicious SQL code via the `status_type` parameter in an HTTP request to the vulnerable `flutter_get_reviews` function.

**Required Attacker Capabilities/Position:**

- **Authentication:** The attacker needs to be authenticated with at least "Subscriber" level access to the WordPress site to exploit the vulnerability.
- **Network Access:** The attacker needs to be able to send HTTP requests to the WordPress site.

**Additional Details:**

-   The vulnerable code section is located within the `flutter_get_reviews` function in the file `vendor-admin-wcfm-helper.php`, specifically around line 833.
-   The fix, implemented in version 4.15.8, includes input validation for `status_type` and order parameters around line 825 of `vendor-admin-wcfm-helper.php`.

In summary, CVE-2024-11179 is a critical SQL injection vulnerability that allows attackers with minimal privileges to access sensitive information by manipulating the `status_type` parameter. The patch introduces input validation to prevent such exploitation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.598 |
| 3 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.547 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.543 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.541 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.531 |
| 7 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.529 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.528 |
| 9 | 922 | Insecure Storage of Sensitive Information | Class | Allowed-with-Review | dense | 0.497 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

