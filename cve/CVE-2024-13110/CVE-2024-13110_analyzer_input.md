# Vulnerability Information: CVE-2024-13110

## Vulnerability Description
A vulnerability classified as problematic has been found in Beijing Yunfan Internet Technology Yunfan Learning Examination System 1.9.2. Affected is an unknown function of the file src/main/java/com/yf/exam/modules/paper/controller/PaperController.java of the component Exam Answer Handler. The manipulation leads to information disclosure. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **impact:** information disclosure
- **product:** Beijing Yunfan Internet Technology Yunfan Learning Examination System
- **version:** 1.9.2
- **component:** Exam Answer Handler

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

The vulnerability stems from a lack of input validation or authorization in the `PaperController.java` file within the `yfexam-exam` application. Specifically, the application doesn't restrict the input ID when accessing exam results, which allows users to directly view the answers of any exam by manipulating the URL.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure Direct Object Reference (IDOR):** The application directly uses the exam ID provided in the URL to retrieve and display the exam results, without verifying if the user is authorized to view those results.
*   **Lack of Authorization:** There's no proper authorization check to ensure that only the user who took the exam can view the results during the answering process.

**Impact of Exploitation:**

*   **Cheating in Exams:** By directly accessing the exam result URL, a user can view all correct answers before or during the exam, enabling them to cheat and obtain a perfect score.
*   **Compromised Exam Integrity:** The vulnerability undermines the integrity of the exam process, making it unreliable.
*   **Potential for Unfair Advantage:** Users who exploit this vulnerability gain an unfair advantage over others.

**Attack Vectors:**

*   **Direct URL Manipulation:** The attacker can directly manipulate the exam ID in the URL (`http://192.168.0.106:8101/#/my/exam/result/{examId}`) to view results of any exam.

**Required Attacker Capabilities/Position:**

*   **Knowledge of Exam ID Format:** The attacker needs to understand how the exam IDs are generated or be able to guess/brute-force them to access arbitrary exam results.
*   **Access to the Application:** The attacker must have access to the exam application and be able to navigate to the exam interface and modify the URL.

**Additional Details:**

*   The vulnerable code is located in `src/main/java/com/yf/exam/modules/paper/controller/PaperController.java`.
*   The identified version with the vulnerability is `yfexam-exam` version `1.9.2`.
*   The attacker can view the answers during the answering process, not just after the exam is submitted.
*   The provided screenshots show that by manipulating the URL, it is possible to directly see the correct answers.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.700 |
| 2 | 129 | Improper Validation of Array Index | Variant | Allowed | alternate_terms | 0.700 |
| 3 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | alternate_terms | 0.700 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.145 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.139 |
| 6 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.130 |
| 7 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.123 |
| 8 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.120 |
| 9 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | dense | 0.550 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

