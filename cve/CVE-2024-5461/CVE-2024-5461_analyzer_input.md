# Vulnerability Information: CVE-2024-5461

## Vulnerability Description
Implementation of the Simple Network Management Protocol (SNMP) operating on the Brocade 6547 (FC5022) embedded switch blade, makes internal script calls to system.sh from within the SNMP binary. An authenticated attacker could perform **command or parameter injection** on SNMP operations that are only enabled on the Brocade 6547 (FC5022) embedded switch. This injection could allow the authenticated attacker to issue commands as Root.

### Vulnerability Description Key Phrases
- **weakness:** **command or parameter injection**
- **impact:** execute commands as Root
- **attacker:** authenticated attacker
- **product:** Brocade 6547 (FC5022) embedded switch

## CVE Reference Links Content Summary
## Analysis of CVE-2024-5461 Content

This content is **RELEVANT** to CVE-2024-5461. It provides detailed information about the vulnerability.

**Root cause of vulnerability:**

The vulnerability stems from the implementation of the Simple Network Management Protocol (SNMP) on the Brocade 6547 (FC5022) embedded switch blade. The SNMP implementation makes internal script calls to `system.sh` from within the SNMP binary.

**Weaknesses/vulnerabilities present:**

* **CWE-77:** Improper Neutralization of Special Elements used in a Command. This allows for command or parameter injection.

**Impact of exploitation:**

An authenticated attacker could perform command or parameter injection on SNMP operations. Successful exploitation allows the attacker to issue commands as Root.

**Attack vectors:**

* Exploitation occurs via unique embedded switch SNMP commands.
* Requires SNMP user account access.

**Required attacker capabilities/position:**

* Authenticated attacker with SNMP user account access.
* Ability to issue unique embedded switch SNMP commands.

**Mitigation or fix:**

* A solution is provided in Fabric OS 8.2.3e1\_pha patch release, which removes the vulnerable component from the code.

**Additional Details (more than official CVE description):**

* **Affected Products:** Brocade 6547 (FC5022) embedded switches running Brocade Fabric OS prior to 8.2.3e1\_pha firmware.
* **Products Not Affected:** All Brocade switches other than the Brocade 6547 running Brocade Fabric OS versions prior to 9.0, and all Brocade switches running Brocade Fabric OS v9.0 and later.
* **CVSS Score:** 8.6 CVSS:4.0/AV:A/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
* **Credit:** Pierre Barre reported the issue to Brocade.
* **Advisory ID:** BSA-2024-2597

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.700 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.321 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.321 |
| 5 | 1392 | Use of Default Credentials | Base | Allowed | sparse | 0.315 |
| 6 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.307 |
| 7 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.305 |
| 8 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.300 |
| 9 | 912 | Hidden Functionality | Class | Allowed-with-Review | dense | 0.502 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

