## Vulnerability Description
A vulnerability was found in WebAssembly wabt 1.0.36 and classified as critical. This issue affects the function wabtinterp(anonymous namespace)BinaryReaderInterpOnExport of the file wabt/src/interp/binary-reader-interp.cc of the component Malformed File Handler. The manipulation leads to heap-based buffer overflow. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. It is recommended to apply a patch to fix this issue.

### Vulnerability Description Key Phrases
- **component:** wabtinterp(anonymous namespace)BinaryReaderInterpOnExport, wabt/src/interp/binary-reader-interp.cc
- **weakness:** **heap-based buffer overflow, stack buffer overflow**
- **product:** WebAssembly wabt
- **version:** 1.0.36

## CVE Reference Links Content Summary
## Analysis of CVE-2025-2368 based on provided content

Based on the provided content, specifically the GitHub issue #2556, the following information can be extracted:

**Root cause of vulnerability:**

The vulnerability is a heap-based buffer overflow in the `wabt::interp::(anonymous namespace)::BinaryReaderInterp::OnExport` function. It occurs when processing malformed files, specifically when calling `FuncType::Clone()` within a switch statement. This leads to an out-of-bounds read.

**Weaknesses/vulnerabilities present:**

*   **Heap-based Buffer Overflow (CWE-122):** The core vulnerability is a heap buffer overflow.
*   **Insufficient bounds checking:** The `FuncType::Clone()` call doesn't properly validate the size or boundaries of the data being accessed, leading to the overflow.

**Impact of exploitation:**

*   **Application crash:** The out-of-bounds read can cause the application to crash.
*   **Potential for arbitrary code execution:** While not explicitly stated, heap buffer overflows can potentially be exploited for arbitrary code execution, depending on the surrounding memory layout and other factors.

**Attack vectors:**

*   **Malformed WASM files:** The vulnerability is triggered by processing specially crafted, malformed WebAssembly (WASM) files.

**Required attacker capabilities/position:**

*   **Ability to create/provide malicious WASM files:** An attacker needs to be able to create or provide a WASM file that triggers the vulnerability.
*   **Local or remote access:** Depending on how the `wabt` tools are used, the attacker may need local access to the system or the ability to deliver the malicious file remotely.

**Mitigation or fix:**

The provided content does not detail a specific fix. However, the issue description implies that proper bounds checking within the `FuncType::Clone()` function or the `OnExport` function is necessary to prevent the overflow.

**Additional Details (more than official CVE description):**

*   **Reproducibility:** The issue includes detailed steps to reproduce the vulnerability using a fuzzer (OSS-Fuzz) and a provided PoC.
*   **Affected version:** wabt v1.0.36 is identified as affected.
*   **Code location:** The vulnerable code is located in `wabt/src/interp/binary-reader-interp.cc` at line 693.
*   **Fuzzing context:** The vulnerability was discovered through fuzzing.
*   **AddressSanitizer report:** The report includes an AddressSanitizer (ASan) output, pinpointing the exact memory location and call stack involved in the overflow.
*   **Related Issue:** Issue #2537 discusses the intended use cases of the binary reader options and the potential risks of running broken modules in the interpreter.
*   **Pull Request:** Pull Request #2541 aims to make `ReadBinaryOptions` more strict across readers.
*   **CIFuzz impact:** The fix may break compatibility with CIFuzz, requiring coordination between repositories.

**CVE Relevance:**

The content directly relates to CVE-2025-2368 as it describes a heap-based buffer overflow in the wabt project, which is the subject of the CVE.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.492 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.466 |
| 5 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.458 |
| 6 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.450 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.449 |
| 8 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.433 |
| 9 | 194 | Unexpected Sign Extension | Variant | Allowed | dense | 0.600 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-125: Out-of-bounds Read

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-122: Heap-based Buffer Overflow

CWE-674: Uncontrolled Recursion

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-1241: Use of Predictable Algorithm in Random Number Generator

CWE-194: Unexpected Sign Extension

CWE-128: Wrap-around Error