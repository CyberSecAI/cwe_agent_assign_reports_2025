# Raw Retriever Results for CVE-2024-40927

# Raw Retriever Results for CVE-2024-40927
## Query
In the Linux kernel, the following vulnerability has been resolved xhci Handle TD clearing for multiple streams case When multiple streams are in use, multiple TDs might be in flight when an endpoint is stopped. We need to issue a Set TR Dequeue Pointer for each, to ensure everything is reset properly and the caches cleared. Change the logic so that any N>1 TDs found active for different streams are deferred until after the first one is processed, calling xhci_invalidate_cancelled_tds() again from xhci_handle_cmd_set_deq() to queue another command until we are done with all of them. Also change the error/should never happen paths to ensure we at least clear any affected TDs, even if we cant issue a command to clear the hardware cache, and complain loudly with an xhci_warn() if this ever happens. This problem case dates back to commit e9df17eb1408 (USB xhci Correct assumptions about number of rings per endpoint.) early on in the XHCI drivers life, when stream support was first added. It was then identified but not fixed nor made into a warning in commit 674f8438c121 (xhci split handling halted endpoints into two steps), which added a FIXME comment for the problem case (without materially changing the behavior as far as I can tell, though the new logic made the problem more obvious). Then later, in commit 94f339147fc3 (xhci Fix failure to give back some cached cancelled URBs.), it was acknowledged again. [Mathias commit 94f339147fc3 (xhci Fix failure to

## Keyphrases
- **rootcause**: 'multiple TDs might be in flight when an endpoint is stopped'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4295 | 0.4743 | 0.4452 | 0.4439 | 20 |
| Sparse | 317.4051 | 1057.1938 | 962.6037 | 1018.2791 | 11 |
| Graph | 1.4709 | 2.3998 | 1.7750 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 306 | Missing Authentication for Critical Function | base | 2.3998 | Allowed |
| 2 | 617 | Reachable Assertion | base | 2.3296 | Allowed |
| 3 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 4 | 193 | Off-by-one Error | base | 2.2100 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.8119 | Allowed |
| 6 | 170 | Improper Null Termination | base | 1.7680 | Allowed |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 8 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 9 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 11 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 12 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 13 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 15 | 662 | Improper Synchronization | class | 1.5795 | Discouraged |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 773 | Missing Reference to Active File Descriptor or Handle | Variant | 0.4743 | 0.4743 | Allowed |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4730 | 0.4730 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4626 | 0.4626 | Allowed-with-Review |
| 4 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4599 | 0.4599 | Allowed |
| 5 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4572 | 0.4572 | Allowed |
| 6 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4540 | 0.4540 | Allowed |
| 7 | 366 | Race Condition within a Thread | Base | 0.4502 | 0.4502 | Allowed |
| 8 | 122 | Heap-based Buffer Overflow | Variant | 0.4500 | 0.4500 | Allowed |
| 9 | 833 | Deadlock | Base | 0.4490 | 0.4490 | Allowed |
| 10 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4488 | 0.4488 | Allowed |
| 11 | 1261 | Improper Handling of Single Event Upsets | Base | 0.4390 | 0.4390 | Allowed |
| 12 | 606 | Unchecked Input for Loop Condition | Base | 0.4363 | 0.4363 | Allowed |
| 13 | 774 | Allocation of File Descriptors or Handles Without Limits or Throttling | Variant | 0.4361 | 0.4361 | Allowed |
| 14 | 121 | Stack-based Buffer Overflow | Variant | 0.4316 | 0.4316 | Allowed |
| 15 | 416 | Use After Free | Variant | 0.4315 | 0.4315 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | 1057.1938 | 1057.1938 | Allowed |
| 2 | 863 | Incorrect Authorization | 1055.5756 | 1055.5756 | Allowed-with-Review |
| 3 | 306 | Missing Authentication for Critical Function | 1033.4392 | 1033.4392 | Allowed |
| 4 | 617 | Reachable Assertion | 1033.2680 | 1033.2680 | Allowed |
| 5 | 1390 | Weak Authentication | 1030.9251 | 1030.9251 | Allowed-with-Review |
| 6 | 667 | Improper Locking | 1018.2791 | 1018.2791 | Allowed-with-Review |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1017.8214 | 1017.8214 | Allowed-with-Review |
| 8 | 407 | Inefficient Algorithmic Complexity | 1011.0389 | 1011.0389 | Allowed-with-Review |
| 9 | 201 | Insertion of Sensitive Information Into Sent Data | 1007.3202 | 1007.3202 | Allowed |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1006.3742 | 1006.3742 | Allowed |
| 11 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 317.4051 | 317.4051 | Allowed |
