# Vulnerability Information: CVE-2024-8072

## Vulnerability Description
Mage AI allows remote unauthenticated attackers to leak the terminal server command history of arbitrary users

### Vulnerability Description Key Phrases
- **impact:** leak terminal server command history
- **attacker:** remote unauthenticated attackers
- **product:** Mage AI

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:** The Mage AI application allows unauthenticated access to terminal server command history.

**Weaknesses/vulnerabilities present:**
*   **Information Leakage:** The primary vulnerability is the exposure of terminal command history to unauthorized users.
*   **Lack of Authentication/Authorization:**  The system fails to properly authenticate or authorize users attempting to access terminal history, leading to the infoleak.

**Impact of exploitation:**
*   **Information Disclosure:** An attacker can view the command history of arbitrary users. This can lead to the exposure of sensitive information like credentials, paths, or other commands containing secrets.
*   **Potential for Further Exploitation:**  Revealed commands might contain information that could aid in further attacks, such as discovering internal systems, API keys, or specific configurations.

**Attack vectors:**
*   **Network Access:**  The vulnerability is triggered by sending a specific WebSocket request to the `/websocket/terminal` endpoint.
*   **Unauthenticated Access:** The attacker does not need any prior authentication.

**Required attacker capabilities/position:**
*   **Network Connectivity:** The attacker needs to be able to send network requests to the server hosting the vulnerable Mage AI instance.
*   **No prior knowledge or credentials:** The vulnerability is exploitable without authentication.

**Additional notes:**
*   The provided Proof of Concept (PoC) gives the exact WebSocket endpoint format required to trigger the vulnerability, making it easily reproducible.
*   The lack of mitigations highlights the critical nature of the flaw and the need for immediate patching/fixes.
* The CVE description is a placeholder, and this document provides useful details.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 204 | Observable Response Discrepancy | Base | Allowed | sparse | 0.027 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.026 |
| 3 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.025 |
| 4 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.024 |
| 5 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.024 |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.024 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.024 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.024 |
| 9 | 250 | Execution with Unnecessary Privileges | Base | Allowed | dense | 0.482 |
| 10 | 499 | Serializable Class Containing Sensitive Data | Variant | Allowed | graph | 0.003 |

