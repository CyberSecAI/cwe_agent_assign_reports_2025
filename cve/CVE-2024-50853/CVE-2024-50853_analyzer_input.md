# Vulnerability Information: CVE-2024-50853

## Vulnerability Description
Tenda G3 v3.0 v15.11.0.20 was discovered to contain a **command injection** vulnerability via the formSetDebugCfg function.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Tenda G3
- **version:** v3.0 v15.11.0.20
- **component:** formSetDebugCfg function

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:** The vulnerability stems from the lack of input sanitization in the `formSetDebugCfg` function of the Tenda-G3v3.0 router's firmware. Specifically, the function directly uses values from user-supplied HTTP POST request parameters (`enable`, `level`, `module`) in a `sprintf` command which is then executed by `system()`.

**Weaknesses/Vulnerabilities:**
*   **Command Injection:** The primary vulnerability is command injection. Because the values for `enable`, `level`, and `module` are not filtered, an attacker can inject arbitrary shell commands within these parameters, which will be executed with the privileges of the webserver.

**Impact of Exploitation:**
*   **Arbitrary Command Execution:** A successful exploit allows the attacker to execute arbitrary commands on the router's operating system.
*   **Complete System Compromise:** The ability to execute arbitrary commands can lead to a full compromise of the router, potentially enabling attackers to:
    *   Gain root access to the device.
    *   Modify the router's configuration.
    *   Install malware.
    *   Use the router in botnet attacks.
    *   Exfiltrate sensitive information.

**Attack Vectors:**
*   **HTTP POST Request:** The attack vector is an HTTP POST request sent to the `/goform/setDebugCfg` URL.
*   **Manipulated Parameters:**  The parameters `enable`, `level`, and `module` within the POST request are used to inject the malicious commands.

**Required Attacker Capabilities/Position:**
*   **Network Access:** The attacker needs network access to the router's web interface. This typically means being on the same local network or having access to the router via a public IP if remote access is enabled
*   **Authentication:** The attacker must authenticate to the web interface before accessing the vulnerable URL. The exploit code shows the usage of base64 encoded credentials for the 'admin' user.

**Additional Details:**
*   The provided `exp.py` script demonstrates how to exploit the vulnerability, including login to the router and sending a malicious POST request to inject commands
*   The proof of concept injects `echo PWN!!! > /webroot/helpData.html` which will create a file on the web server accessible by the attacker.
*   The vulnerability is present in versions of Tenda-G3v3.0 firmware up to and including V15.11.0.20.

**Suggested Solutions (as mentioned in the content):**
*   **Input Filtering:** The primary recommendation is to implement proper filtering of the `enable`, `level`, and `module` parameters from the user's POST request to prevent injection attacks. This should include sanitizing or escaping shell metacharacters.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.143 |
| 4 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.119 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.113 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.108 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.108 |
| 8 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.107 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.536 |
| 10 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | graph | 0.002 |

