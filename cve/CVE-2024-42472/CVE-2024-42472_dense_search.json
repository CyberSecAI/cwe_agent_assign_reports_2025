{
  "retriever": "dense",
  "query": "Flatpak is a Linux application sandboxing and distribution framework. Prior to versions 1.14.0 and 1.15.10, a malicious or compromised Flatpak app using persistent directories could access and write files outside of what it would otherwise have access to, which is an attack on integrity and confidentiality. When `persistent=subdir` is used in the application permissions (represented as `--persist=subdir` in the command-line interface), that means that an application which otherwise doesnt have access to the real user home directory will see an empty home directory with a writeable subdirectory `subdir`. Behind the scenes, this directory is actually a bind mount and the data is stored in the per-application directory as `~/.var/app/$APPID/subdir`. This allows existing apps that are not aware of the per-application directory to still work as intended without general home directory access. However, the application does have write access to the application directory `~/.var/app/$APPID` where this directory is stored. If the source directory for the `persistent`/`--persist` option is replaced by a symlink, then the next time the application is started, the bind mount will follow the symlink and mount whatever it points to into the sandbox. Partial protection against this vulnerability can be provided by patching Flatpak using the patches in commits ceec2ffc and 98f79773. However, this leaves a race condition that could be exploited by two instances of a malicious app running i",
  "keyphrases": {
    "rootcause": [
      "race condition"
    ],
    "weakness": [
      "symlink following"
    ]
  },
  "timestamp": "2025-07-13 14:07:13",
  "cve_id": "CVE-2024-42472",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "277",
      "name": "Insecure Inherited Permissions",
      "type": "Variant",
      "score": 0.4527206476649227
    },
    {
      "cwe_id": "61",
      "name": "UNIX Symbolic Link (Symlink) Following",
      "type": "Compound",
      "score": 0.44531436780539324
    },
    {
      "cwe_id": "379",
      "name": "Creation of Temporary File in Directory with Insecure Permissions",
      "type": "Base",
      "score": 0.4437881100823469
    },
    {
      "cwe_id": "427",
      "name": "Uncontrolled Search Path Element",
      "type": "Base",
      "score": 0.43901977835277595
    },
    {
      "cwe_id": "59",
      "name": "Improper Link Resolution Before File Access ('Link Following')",
      "type": "Base",
      "score": 0.43085671100448864
    },
    {
      "cwe_id": "1386",
      "name": "Insecure Operation on Windows Junction / Mount Point",
      "type": "Base",
      "score": 0.4094306804974144
    },
    {
      "cwe_id": "378",
      "name": "Creation of Temporary File With Insecure Permissions",
      "type": "Base",
      "score": 0.4079137211007309
    },
    {
      "cwe_id": "184",
      "name": "Incomplete List of Disallowed Inputs",
      "type": "Base",
      "score": 0.40598516355802183
    },
    {
      "cwe_id": "22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "type": "Base",
      "score": 0.40564487343382344
    },
    {
      "cwe_id": "552",
      "name": "Files or Directories Accessible to External Parties",
      "type": "Base",
      "score": 0.40306460459808474
    },
    {
      "cwe_id": "24",
      "name": "Path Traversal: '../filedir'",
      "type": "Variant",
      "score": 0.3959796973535957
    },
    {
      "cwe_id": "36",
      "name": "Absolute Path Traversal",
      "type": "Base",
      "score": 0.39061131397365584
    },
    {
      "cwe_id": "73",
      "name": "External Control of File Name or Path",
      "type": "Base",
      "score": 0.38739879497686136
    },
    {
      "cwe_id": "26",
      "name": "Path Traversal: '/dir/../filename'",
      "type": "Variant",
      "score": 0.38680945750028506
    },
    {
      "cwe_id": "526",
      "name": "Cleartext Storage of Sensitive Information in an Environment Variable",
      "type": "Variant",
      "score": 0.38614711458784334
    },
    {
      "cwe_id": "732",
      "name": "Incorrect Permission Assignment for Critical Resource",
      "type": "Class",
      "score": 0.38461280838991113
    },
    {
      "cwe_id": "57",
      "name": "Path Equivalence: 'fakedir/../realdir/filename'",
      "type": "Variant",
      "score": 0.38294642110078847
    },
    {
      "cwe_id": "377",
      "name": "Insecure Temporary File",
      "type": "Class",
      "score": 0.3826086573159664
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "type": "Base",
      "score": 0.3809922152825468
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "type": "Base",
      "score": 0.37977172803177117
    }
  ]
}