# Vulnerability Information: CVE-2024-5530

## Vulnerability Description
The ShopLentor - WooCommerce Builder for Elementor & Gutenberg +12 Modules - All in One Solution (formerly WooLentor) plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugins WL Product Horizontal Filter widget in all versions up to, and including, 2.9.0 due to **insufficient input sanitization and output escaping on user supplied attributes**. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping on user supplied attributes**
- **weakness:** **cross-site scripting**
- **impact:** inject arbitrary web scripts
- **attacker:** authenticated attackers with contributor-level access and above
- **product:** ShopLentor - WooCommerce Builder for Elementor & Gutenberg +12 Modules - All in One Solution
- **version:** all versions up to and including 2.9.0
- **component:** WL Product Horizontal Filter widget

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-79

#### Top CWEs
- CWE-79 (Count: 75)
- CWE-80 (Count: 3)

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-5530

**Description:** The vulnerability is a Stored Cross-Site Scripting (XSS) flaw found in the "ShopLentor – WooCommerce Builder for Elementor & Gutenberg +12 Modules – All in One Solution (formerly WooLentor)" WordPress plugin, specifically affecting versions 2.9.0 and earlier.

**Root Cause of Vulnerability:**
- Insufficient input sanitization and output escaping on user-supplied attributes within the plugin's "WL: Product Horizontal Filter" widget.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):**  The plugin fails to properly sanitize user-provided data when configuring the "WL: Product Horizontal Filter" widget. This allows an attacker to inject malicious JavaScript code that is stored in the database and executed when a user views the affected page.

**Impact of Exploitation:**
- **Arbitrary Web Script Execution:** Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of a user's browser when they access a page containing the vulnerable widget.
- **Potential for Malicious Actions:** This can lead to various malicious activities, including but not limited to:
    - Stealing user session cookies.
    - Redirecting users to malicious websites.
    - Defacing websites.
    - Performing actions on behalf of the user.

**Attack Vectors:**
- **Plugin Widget Configuration:**  The attacker injects malicious code into the settings of the "WL: Product Horizontal Filter" widget through the WordPress admin interface.
- **User Interaction:** No direct user interaction is required to trigger the exploit. The malicious script executes when the page containing the widget is viewed.

**Required Attacker Capabilities/Position:**
- **Authenticated User:** The attacker needs to have at least "Contributor" level access to the WordPress admin panel to configure the plugin widget.
- **Access to WordPress Admin Panel:** The attacker needs to be able to access and modify settings in the WordPress admin interface.

**Additional Information:**

- The vulnerability was publicly published on June 10, 2024.
- The vulnerable code can be found in the file `wl_product_horizontal_filter.php` within the plugin.
- The vulnerability was patched in version 2.9.1 of the plugin.
- The fix involves sanitizing the input for the price range in the horizontal filter.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.598 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.589 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.529 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.511 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.468 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.463 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.440 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.435 |
| 9 | 91 | XML Injection (aka Blind XPath Injection) | Base | Allowed | dense | 0.498 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

