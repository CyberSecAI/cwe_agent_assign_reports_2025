## Vulnerability Description
Evmos is the Ethereum Virtual Machine (EVM) Hub on the Cosmos Network. This vulnerability allowed a user to create a validator using vested tokens to deposit the self-bond. This vulnerability is fixed in 18.0.0.

### Vulnerability Description Key Phrases
- **impact:** create a validator using vested tokens to deposit the self-bond
- **attacker:** user
- **product:** Evmos
- **version:** 18.0.0

## CVE Reference Links Content Summary
```json
{
  "related": true,
  "vulnerabilities": [
    {
      "root_cause": "Incorrect calculation of spendable balance when delegating vested tokens.",
      "weaknesses": [
        "The spendable balance was not correctly updated after delegating vested tokens.",
          "Missing checks in the Ethereum ante handler for clawback vesting accounts, allowing bypass of Cosmos ante handler checks.",
           "Lack of a check to prevent validator creation using vested tokens."
      ],
      "impact": "Clawback vesting accounts could prematurely access unvested tokens and create validators with unvested tokens.",
      "attack_vectors": [
        "Delegating vested tokens.",
        "Sending an Ethereum transaction targeting a precompile to interact with a Cosmos SDK module.",
        "Creating validator using vested tokens."
      ],
        "required_attacker_capabilities": "Requires a clawback vesting account. Attacker needs to perform delegation, send an Ethereum transaction to a precompile, or create a validator."
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.064 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.063 |
| 3 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.062 |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.062 |
| 5 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.061 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.061 |
| 7 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.060 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.060 |
| 9 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | Allowed | dense | 0.381 |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-400: Uncontrolled Resource Consumption

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-269: Improper Privilege Management

CWE-532: Insertion of Sensitive Information into Log File

CWE-347: Improper Verification of Cryptographic Signature

CWE-863: Incorrect Authorization

CWE-696: Incorrect Behavior Order

CWE-285: Improper Authorization

CWE-1274: Improper Access Control for Volatile Memory Containing Boot Code

CWE-789: Memory Allocation with Excessive Size Value