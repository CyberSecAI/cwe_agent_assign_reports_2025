{
  "cve_id": "CVE-2024-49381",
  "description": "Plenti, a static site generator, has an arbitrary file deletion vulnerability in versions prior to 0.7.2. The `/postLocal` endpoint is vulnerable to an **arbitrary file write deletion** when a plenti user serves their website. This issue may lead to information loss. Version 0.7.2 fixes the vulnerability.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "arbitrary file write deletion",
    "impact": [
      "arbitrary file deletion",
      "arbitrary file write",
      "information loss"
    ],
    "vector": "",
    "attacker": "plenti user",
    "product": "Plenti",
    "version": "prior to 0.7.2",
    "component": "/postLocal endpoint"
  },
  "reference_content": "Based on the provided information, here's an analysis of CVE-2024-49381:\n\n**CVE-2024-49381** is related to an arbitrary file deletion vulnerability found in Plenti.\n\n*   **Root Cause:** The vulnerability lies in the `/postLocal` endpoint within the `serve.go` file. Specifically, the code processes a \"delete\" action from a JSON payload without proper sanitization or checks on the file path.\n*   **Weaknesses/Vulnerabilities:**\n    *   **Arbitrary File Deletion:** The `os.Remove` function is used to delete files specified in the request, and it doesn't validate that the file path is within the intended project directory. It uses `filepath.Join(currentDir, change.File)` but since `change.File` can be set by the user, it can point to any file in the current directory or any sub-directories.\n*  **Impact of Exploitation:**\n    *   **Information Loss:** An attacker can delete any file on the server, which can lead to data loss, denial of service, and/or compromise of the application or server.\n*   **Attack Vectors:**\n    *   **Network:** The attack vector is through the `/postLocal` endpoint of the Plenti local server.\n    *   **JSON Payload:** The attacker crafts a malicious POST request with a JSON payload containing a \"delete\" action and a file path pointing to a file on the system.\n*   **Required Attacker Capabilities/Position:**\n    *   The attacker needs to be able to send HTTP POST requests to the vulnerable Plenti server and must have the ability to craft the JSON payload.\n    *   The server must be running the vulnerable version of Plenti\n    *   The attacker does not need any authentication to perform this action.\n\n**Additional Notes:**\n\n*   The provided information includes a code snippet that highlights the vulnerable section in the `serve.go` file.\n*   The vulnerability is fixed in version `v0.7.2` of Plenti.\n*   This CVE is associated with GHSL-2024-298, with GHSL-2024-297 being associated with the arbitrary file write vulnerability in the same endpoint (CVE-2024-49380).",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-73 | External Control of File Name or Path | 1.0 | Base | Allowed | Primary CWE. The product uses external input to construct a pathname that is then used to delete a file. |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.7 | Base | Allowed | Secondary CWE. The file path is not properly restricted, allowing deletion of files outside the intended directory. |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Allowed | Secondary CWE. No authentication is required to access the `/postLocal` endpoint. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is CWE-73, as the file path is externally controlled. CWE-22 is a child of CWE-73 and represents a more specific case of path traversal, where the external control allows access outside a restricted directory. CWE-306 is related, as the absence of authentication allows anyone to trigger the file deletion. These relationships help to understand the vulnerability chain and the level of specificity required for each CWE.\n\n```mermaid\ngraph TD\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n\n    cwe22 -->|CHILDOF| cwe73\n    cwe73 -->|CANPRECEDE| cwe59\n    cwe73 -->|CANPRECEDE| cwe434\n    cwe73 -->|CANPRECEDE| cwe41\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe73 primary\n    class cwe22,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **CWE-306: Missing Authentication for Critical Function**, allowing an attacker to access the `/postLocal` endpoint. Then, **CWE-73: External Control of File Name or Path** allows the attacker to specify the file path to be deleted. Finally, **CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')** allows the attacker to delete files outside the intended directory, leading to information loss.\n\n## Summary of Analysis\nThe initial analysis identified the **arbitrary file write deletion** vulnerability as the root cause. The retriever results suggested several CWEs, including CWE-23, CWE-22, CWE-59, and CWE-434. After reviewing the CWE specifications and considering the vulnerability details, CWE-73 was chosen as the primary CWE because it directly addresses the external control of the file path.\n\nThe evidence from the CVE Reference Links Content Summary supports this selection: \"Specifically, the code processes a 'delete' action from a JSON payload without proper sanitization or checks on the file path... It uses `filepath.Join(currentDir, change.File)` but since `change.File` can be set by the user, it can point to any file in the current directory or any sub-directories.\" This clearly demonstrates that the file path is controlled by external input.\n\nCWE-22 was considered as a secondary CWE because the external control of the file path allows traversal outside the intended directory. CWE-306 was also considered because there is no authentication required to access the vulnerable endpoint.\n\nThe selected CWEs are at the optimal level of specificity because they accurately represent the **weakness** and its contributing factors. CWE-73 captures the root cause, while CWE-22 and CWE-306 provide additional context.\n\nRelevant CWE Information:\n- CWE-73: External Control of File Name or Path\n- CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\n- CWE-306: Missing Authentication for Critical Function",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-73 | External Control of File Name or Path | 1.0 | Base | Allowed | Primary CWE. The product uses external input to construct a pathname that is then used to delete a file. |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.7 | Base | Allowed | Secondary CWE. The file path is not properly restricted, allowing deletion of files outside the intended directory. |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Allowed | Secondary CWE. No authentication is required to access the `/postLocal` endpoint. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is CWE-73, as the file path is externally controlled. CWE-22 is a child of CWE-73 and represents a more specific case of path traversal, where the external control allows access outside a restricted directory. CWE-306 is related, as the absence of authentication allows anyone to trigger the file deletion. These relationships help to understand the vulnerability chain and the level of specificity required for each CWE.\n\n```mermaid\ngraph TD\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n\n    cwe22 -->|CHILDOF| cwe73\n    cwe73 -->|CANPRECEDE| cwe59\n    cwe73 -->|CANPRECEDE| cwe434\n    cwe73 -->|CANPRECEDE| cwe41\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe73 primary\n    class cwe22,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **CWE-306: Missing Authentication for Critical Function**, allowing an attacker to access the `/postLocal` endpoint. Then, **CWE-73: External Control of File Name or Path** allows the attacker to specify the file path to be deleted. Finally, **CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')** allows the attacker to delete files outside the intended directory, leading to information loss.\n\n## Summary of Analysis\nThe initial analysis identified the **arbitrary file write deletion** vulnerability as the root cause. The retriever results suggested several CWEs, including CWE-23, CWE-22, CWE-59, and CWE-434. After reviewing the CWE specifications and considering the vulnerability details, CWE-73 was chosen as the primary CWE because it directly addresses the external control of the file path.\n\nThe evidence from the CVE Reference Links Content Summary supports this selection: \"Specifically, the code processes a 'delete' action from a JSON payload without proper sanitization or checks on the file path... It uses `filepath.Join(currentDir, change.File)` but since `change.File` can be set by the user, it can point to any file in the current directory or any sub-directories.\" This clearly demonstrates that the file path is controlled by external input.\n\nCWE-22 was considered as a secondary CWE because the external control of the file path allows traversal outside the intended directory. CWE-306 was also considered because there is no authentication required to access the vulnerable endpoint.\n\nThe selected CWEs are at the optimal level of specificity because they accurately represent the **weakness** and its contributing factors. CWE-73 captures the root cause, while CWE-22 and CWE-306 provide additional context.\n\nRelevant CWE Information:\n- CWE-73: External Control of File Name or Path\n- CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\n- CWE-306: Missing Authentication for Critical Function\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-22:**\n- 22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) - ROOT\n\n\n**Chain starting from CWE-59:**\n- 59 (Improper Link Resolution Before File Access ('Link Following')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "sparse"
      },
      "similarity": 258.4099415972057
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 250.67958879563275
    },
    {
      "metadata": {
        "doc_id": "59",
        "name": "Improper Link Resolution Before File Access ('Link Following')",
        "source": "sparse"
      },
      "similarity": 245.12673763039274
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 236.72555388857725
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse"
      },
      "similarity": 236.33858393410398
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 235.78585765561448
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 233.98555163780242
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 233.8455240277188
    },
    {
      "metadata": {
        "doc_id": "359",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
        "type": "Base",
        "original_content": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have the implicit consent of the person about whom the information is collected.",
        "keyphrase_source": "weakness:arbitrary file write deletion",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5134276105911697
          }
        }
      },
      "similarity": 0.5134276105911697
    },
    {
      "doc_id": "73",
      "text": "CWE-73: External Control of File Name or Path",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "type": "base",
        "original_content": "CWE-73: External Control of File Name or Path",
        "relationships": [
          {
            "source_id": "73",
            "target_id": "114",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "59",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "41",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "20",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "73",
            "target_id": "610",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "642",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "99",
            "target_id": "73",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "642",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "610",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "59",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "41",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "114",
            "target_id": "73",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "22"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "434",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "434"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "73",
                  "434",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "434"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-22",
      "CWE-59",
      "CWE-73",
      "CWE-306",
      "CWE-23",
      "CWE-434"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}