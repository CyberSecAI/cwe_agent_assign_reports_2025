# Vulnerability Information: CVE-2024-49381

## Vulnerability Description
Plenti, a static site generator, has an arbitrary file deletion vulnerability in versions prior to 0.7.2. The `/postLocal` endpoint is vulnerable to an **arbitrary file write deletion** when a plenti user serves their website. This issue may lead to information loss. Version 0.7.2 fixes the vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **arbitrary file write deletion**
- **impact:** arbitrary file deletion and arbitrary file write and information loss
- **attacker:** plenti user
- **product:** Plenti
- **version:** prior to 0.7.2
- **component:** /postLocal endpoint

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-49381:

**CVE-2024-49381** is related to an arbitrary file deletion vulnerability found in Plenti.

*   **Root Cause:** The vulnerability lies in the `/postLocal` endpoint within the `serve.go` file. Specifically, the code processes a "delete" action from a JSON payload without proper sanitization or checks on the file path.
*   **Weaknesses/Vulnerabilities:**
    *   **Arbitrary File Deletion:** The `os.Remove` function is used to delete files specified in the request, and it doesn't validate that the file path is within the intended project directory. It uses `filepath.Join(currentDir, change.File)` but since `change.File` can be set by the user, it can point to any file in the current directory or any sub-directories.
*  **Impact of Exploitation:**
    *   **Information Loss:** An attacker can delete any file on the server, which can lead to data loss, denial of service, and/or compromise of the application or server.
*   **Attack Vectors:**
    *   **Network:** The attack vector is through the `/postLocal` endpoint of the Plenti local server.
    *   **JSON Payload:** The attacker crafts a malicious POST request with a JSON payload containing a "delete" action and a file path pointing to a file on the system.
*   **Required Attacker Capabilities/Position:**
    *   The attacker needs to be able to send HTTP POST requests to the vulnerable Plenti server and must have the ability to craft the JSON payload.
    *   The server must be running the vulnerable version of Plenti
    *   The attacker does not need any authentication to perform this action.

**Additional Notes:**

*   The provided information includes a code snippet that highlights the vulnerable section in the `serve.go` file.
*   The vulnerability is fixed in version `v0.7.2` of Plenti.
*   This CVE is associated with GHSL-2024-298, with GHSL-2024-297 being associated with the arbitrary file write vulnerability in the same endpoint (CVE-2024-49380).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.258 |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.251 |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.245 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.237 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.236 |
| 6 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.236 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.234 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.234 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.513 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

