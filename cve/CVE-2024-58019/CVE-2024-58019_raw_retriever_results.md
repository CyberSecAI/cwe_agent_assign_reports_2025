# Raw Retriever Results for CVE-2024-58019

# Raw Retriever Results for CVE-2024-58019
## Query
In the Linux kernel, the following vulnerability has been resolved nvkm/gsp correctly advance the read pointer of GSP message queue A GSP event message consists three parts message header, RPC header, message body. GSP calculates the number of pages to write from the total size of a GSP message. This behavior can be observed from the movement of the write pointer. However, nvkm takes only the size of RPC header and message body as the message size when advancing the read pointer. When handling a two-page GSP message in the non rollback case, It wrongly takes the message body of the previous message as the message header of the next message. As the message length tends to be zero, in the calculation of size needs to be copied (0 - size of (message header)), the size needs to be copied will be 0xffffffxx. It also triggers a kernel panic due to a NULL pointer error. [ 547.614102] msg 00000f90 ff ff ff ff ff ff ff ff 40 d7 18 fb 8b 00 00 00 ........@....... [ 547.622533] msg 00000fa0 00 00 00 00 ff ff ff ff ff ff ff ff 00 00 00 00 ................ [ 547.630965] msg 00000fb0 ff ff ff ff ff ff ff ff 00 00 00 00 ff ff ff ff ................ [ 547.639397] msg 00000fc0 ff ff ff ff 00 00 00 00 ff ff ff ff ff ff ff ff ................ [ 547.647832] nvkm 0000c100.0 gsp peek msg rpc fn0 len0x0/0xffffffffffffffe0 [ 547.655225] nvkm 0000c100.0 gsp get msg rpc fn0 len0x0/0xffffffffffffffe0 [ 547.662532]

## Keyphrases
- **weakness**: 'NULL pointer error'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4200 | 0.4676 | 0.4398 | 0.4385 | 20 |
| Sparse | 888.5483 | 982.7220 | 924.0363 | 924.1195 | 10 |
| Graph | 1.5350 | 2.7998 | 1.9056 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 2.7998 | Allowed |
| 2 | 805 | Buffer Access with Incorrect Length Value | Base | 2.7986 | Allowed |
| 3 | 294 | Authentication Bypass by Capture-replay | base | 2.3998 | Allowed |
| 4 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 5 | 306 | Missing Authentication for Critical Function | base | 2.1190 | Allowed |
| 6 | 532 | Insertion of Sensitive Information into Log File | base | 2.1190 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | 1.8727 | Allowed |
| 8 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 1.8394 | Allowed |
| 9 | 129 | Improper Validation of Array Index | Variant | 1.7891 | Allowed |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 11 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 12 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 13 | 825 | Expired Pointer Dereference | base | 1.6848 | Allowed |
| 14 | 20 | Improper Input Validation | class | 1.6736 | Discouraged |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6430 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4676 | 0.4676 | Allowed |
| 2 | 126 | Buffer Over-read | Variant | 0.4619 | 0.4619 | Allowed |
| 3 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4590 | 0.4590 | Allowed |
| 4 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.4576 | 0.4576 | Allowed |
| 5 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4540 | 0.4540 | Allowed |
| 6 | 822 | Untrusted Pointer Dereference | Base | 0.4518 | 0.4518 | Allowed |
| 7 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4516 | 0.4516 | Allowed |
| 8 | 909 | Missing Initialization of Resource | Class | 0.4513 | 0.4513 | Allowed-with-Review |
| 9 | 122 | Heap-based Buffer Overflow | Variant | 0.4447 | 0.4447 | Allowed |
| 10 | 476 | NULL Pointer Dereference | Base | 0.4421 | 0.4421 | Allowed |
| 11 | 190 | Integer Overflow or Wraparound | Base | 0.4350 | 0.4350 | Allowed |
| 12 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4327 | 0.4327 | Allowed |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4286 | 0.4286 | Allowed-with-Review |
| 14 | 193 | Off-by-one Error | Base | 0.4262 | 0.4262 | Allowed |
| 15 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4252 | 0.4252 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | 982.7220 | 982.7220 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | 956.9938 | 956.9938 | Allowed |
| 3 | 158 | Improper Neutralization of Null Byte or NUL Character | 946.9344 | 946.9344 | Allowed |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | 931.3217 | 931.3217 | Allowed |
| 5 | 294 | Authentication Bypass by Capture-replay | 929.3183 | 929.3183 | Allowed |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | 918.9207 | 918.9207 | Allowed |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | 898.1530 | 898.1530 | Allowed-with-Review |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | 896.5680 | 896.5680 | Discouraged |
| 9 | 789 | Memory Allocation with Excessive Size Value | 890.8831 | 890.8831 | Allowed |
| 10 | 400 | Uncontrolled Resource Consumption | 888.5483 | 888.5483 | Discouraged |
