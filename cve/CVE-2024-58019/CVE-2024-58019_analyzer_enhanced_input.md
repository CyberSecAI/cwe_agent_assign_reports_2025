## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved nvkm/gsp correctly advance the read pointer of GSP message queue A GSP event message consists three parts message header, RPC header, message body. GSP calculates the number of pages to write from the total size of a GSP message. This behavior can be observed from the movement of the write pointer. However, nvkm takes only the size of RPC header and message body as the message size when advancing the read pointer. When handling a two-page GSP message in the non rollback case, It wrongly takes the message body of the previous message as the message header of the next message. As the message length tends to be zero, in the calculation of size needs to be copied (0 - size of (message header)), the size needs to be copied will be 0xffffffxx. It also triggers a kernel panic due to a **NULL pointer error**. [ 547.614102] msg 00000f90 ff ff ff ff ff ff ff ff 40 d7 18 fb 8b 00 00 00 ........@....... [ 547.622533] msg 00000fa0 00 00 00 00 ff ff ff ff ff ff ff ff 00 00 00 00 ................ [ 547.630965] msg 00000fb0 ff ff ff ff ff ff ff ff 00 00 00 00 ff ff ff ff ................ [ 547.639397] msg 00000fc0 ff ff ff ff 00 00 00 00 ff ff ff ff ff ff ff ff ................ [ 547.647832] nvkm 0000c100.0 gsp peek msg rpc fn0 len0x0/0xffffffffffffffe0 [ 547.655225] nvkm 0000c100.0 gsp get msg rpc fn0 len0x0/0xffffffffffffffe0 [ 547.662532]

### Vulnerability Description Key Phrases
- **weakness:** **NULL pointer error**
- **impact:** kernel panic
- **product:** Linux kernel
- **component:** nvkm/gsp

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.983 |
| 2 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.957 |
| 3 | 158 | Improper Neutralization of Null Byte or NUL Character | Variant | Allowed | sparse | 0.947 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.931 |
| 5 | 294 | Authentication Bypass by Capture-replay | Base | Allowed | sparse | 0.929 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.919 |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.898 |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.897 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.468 |
| 10 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-532: Insertion of Sensitive Information into Log File

CWE-306: Missing Authentication for Critical Function

CWE-158: Improper Neutralization of Null Byte or NUL Character

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-294: Authentication Bypass by Capture-replay

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input

CWE-130: Improper Handling of Length Parameter Inconsistency