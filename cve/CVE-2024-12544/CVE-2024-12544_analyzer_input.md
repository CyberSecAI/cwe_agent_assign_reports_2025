# Vulnerability Information: CVE-2024-12544

## Vulnerability Description
The SurveyJS Drag & Drop WordPress Form Builder to create, style and embed multiple forms of any complexity plugin for WordPress is vulnerable to arbitrary file deletion due to a **missing capability check** on the callback function of the SurveyJS_DeleteFile class in all versions up to, and including, 1.12.17. This makes it possible for authenticated attackers, with Subscriber-level access and above, to delete arbitrary files on the server, which can easily lead to remote code execution when the right file is deleted (such as wp-config.php). This function is still vulnerable to Cross-Site Request Forgery as of 1.12.20.

### Vulnerability Description Key Phrases
- **component:** callback function of the SurveyJS_DeleteFile class
- **rootcause:** **missing capability check**
- **weakness:** **cross-site scripting**
- **product:** SurveyJS Drag & Drop WordPress Form Builder
- **impact:** arbitrary file deletion, remote code execution
- **attacker:** authenticated attackers with Subscriber-level access and above
- **version:** all versions up to and including 1.12.17

## CVE Reference Links Content Summary
Based on the provided content, I will analyze it against the placeholder CVE description. Since no CVE description is provided, I will focus on identifying potential vulnerabilities based on the code changes.

**Analysis:**

The provided content details changesets to the `delete_file.php` file within the `surveyjs` plugin for WordPress.

* **Changeset 3214665:** This changeset adds a check to ensure that only administrators can delete files within the `/uploads/surveyjs` directory.  Specifically, it modifies line 18 to include `&& current_user_can( 'administrator' )`. Before this change, any user could potentially delete files in that directory if they knew the filename.

* **Changeset 3222216:** This changeset introduces a `sanitize_file_name()` function to sanitize the filename obtained from the `$_GET["name"]` parameter. This is likely to prevent path traversal vulnerabilities. The original code directly used the user-supplied filename without any validation.

**Vulnerability Information (Extracted):**

* **Root cause of vulnerability:**
    * **Changeset 3214665 (Before Fix):** Lack of authorization check allowed any user to potentially delete files within the `/uploads/surveyjs` directory.
    * **Changeset 3222216 (Before Fix):**  Direct use of user-supplied filename (`$_GET["name"]`) without sanitization could lead to path traversal vulnerabilities, allowing attackers to delete arbitrary files on the server.

* **Weaknesses/vulnerabilities present:**
    * **Authorization Bypass (Changeset 3214665):**  Before the fix, a missing authorization check.
    * **Path Traversal (Changeset 3222216):** Before the fix, the lack of input validation allowed for potential path traversal.

* **Impact of exploitation:**
    * **Changeset 3214665:** Unauthorized file deletion, potentially leading to denial of service or data loss.
    * **Changeset 3222216:** Arbitrary file deletion, potentially leading to complete system compromise.

* **Attack vectors:**
    * **Changeset 3214665:** An attacker could craft a request with a valid filename within `/uploads/surveyjs` and delete the file.
    * **Changeset 3222216:** An attacker could craft a request with a malicious filename containing path traversal characters (e.g., `../`) to delete files outside of the intended directory.

* **Required attacker capabilities/position:**
    * **Changeset 3214665:** Authenticated user (no specific privileges required before the fix).
    * **Changeset 3222216:** Unauthenticated user.

* **Mitigation or fix:**
    * **Changeset 3214665:** Added `&& current_user_can( 'administrator' )` to the conditional statement to restrict file deletion to administrators.
    * **Changeset 3222216:** Implemented `sanitize_file_name()` to sanitize the filename before use, preventing path traversal.

**Note:** The content provides more detail than a typical CVE description would, as it shows the specific code changes made to address the vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.757 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.695 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.645 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.628 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.608 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.603 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.599 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.596 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.458 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

