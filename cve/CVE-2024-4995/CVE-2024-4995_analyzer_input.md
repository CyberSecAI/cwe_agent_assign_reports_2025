# Vulnerability Information: CVE-2024-4995

## Vulnerability Description
Wapro ERP Desktop is **vulnerable to MS SQL protocol downgrade request** from a server side, what could lead to an unencrypted communication vulnerable to data interception and modification.This issue affects Wapro ERP Desktop versions before 9.00.0.

### Vulnerability Description Key Phrases
- **weakness:** **vulnerable to MS SQL protocol downgrade request**
- **impact:** unencrypted communication vulnerable to data interception and modification
- **product:** Wapro ERP Desktop
- **version:** versions before 9.00.0

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-4995:

**Root cause of vulnerability:**
The root cause is the lack of encryption of sensitive data during communication between the Wapro ERP Desktop client and the MS SQL server. The application client accepts a downgrade request from the server to use an unencrypted protocol.

**Weaknesses/vulnerabilities present:**
- **Missing Encryption of Sensitive Data (CWE-311):** The application allows communication using an unencrypted protocol, even if the client is configured for encryption.

**Impact of exploitation:**
- An attacker can intercept and modify the communication between the client and the server. This can lead to:
  - **Data Breaches:**  Sensitive data transmitted during the communication can be read by the attacker.
  - **Data Manipulation:**  The attacker can alter the data being transmitted.
  - **Loss of Integrity:**  The attacker can modify financial or other business-related information.
  - **Man-in-the-Middle (MitM) Attacks:**  An attacker can intercept, alter, or inject communications between the client and server.

**Attack vectors:**
- **Network-based attack:** An attacker positioned on the network between the Wapro ERP Desktop client and the MS SQL server can intercept the communication. This can be achieved through a man-in-the-middle attack.
- The attacker can send a downgrade request from a compromised server to force the client into using an insecure, unencrypted communication channel.

**Required attacker capabilities/position:**
- **Network access:** The attacker needs to be able to intercept network traffic between the client and the server, which can be achieved by being on the same network or having compromised a device on the network path.
- **Ability to intercept and modify network traffic:** The attacker must be capable of performing a man-in-the-middle attack to intercept and modify network communications, including sending protocol downgrade requests to the client.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 757 | Selection of Less-Secure Algorithm During Negotiation ('Algorithm Downgrade') | Base | Allowed | sparse | 0.218 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.205 |
| 3 | 603 | Use of Client-Side Authentication | Base | Allowed | sparse | 0.204 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.202 |
| 5 | 1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | sparse | 0.193 |
| 6 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.192 |
| 7 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.188 |
| 8 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.188 |
| 9 | 326 | Inadequate Encryption Strength | Class | Allowed-with-Review | dense | 0.542 |
| 10 | 456 | Missing Initialization of a Variable | Variant | Allowed | graph | 0.002 |

