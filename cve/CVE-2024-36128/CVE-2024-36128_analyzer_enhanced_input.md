## Vulnerability Description
Directus is a real-time API and App dashboard for managing SQL database content. Prior to 10.11.2, providing a non-numeric length value to the random string generation utility will create a **memory issue** breaking the capability to generate random strings platform wide. This creates a denial of service situation where logged in sessions can no longer be refreshed as sessions depend on the capability to generate a random session ID. This vulnerability is fixed in 10.11.2.

### Vulnerability Description Key Phrases
- **weakness:** **memory issue**
- **impact:** denial of service
- **vector:** non-numeric length value
- **product:** Directus
- **version:** Prior to 10.11.2
- **component:** random string generation utility

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from a flaw in the random string generation utility within Directus. Specifically, providing a non-numeric value as the 'length' parameter to the `/utils/random/string` endpoint causes an issue that prevents the generation of random strings, which are essential for session management.

**Weaknesses/Vulnerabilities:**
- **Lack of input validation:** The random string generation utility did not properly validate the input provided for the length parameter. It failed to handle non-numeric input, leading to a broken state.
- **Denial of Service (DoS):** By sending a malformed request with a non-numeric length parameter (e.g., `length=foo`), an attacker could trigger a state where the utility fails to produce random strings. This, in turn, breaks session refreshes and effectively locks users out of the application, causing a DoS condition.

**Impact of Exploitation:**
- **Denial of Service:** The primary impact is a denial of service. Because Directus uses the random string generator to create session IDs, the inability to generate random strings prevents users from refreshing their sessions. This leads to an inability to authenticate and access the application.
- **Unauthenticated DoS:** The attack can be carried out without authentication, making it easily exploitable by anyone with network access to the Directus instance.

**Attack Vectors:**
- **Network:** The attack is performed over the network by sending HTTP requests to the vulnerable endpoint.
- **Specifically:** Sending a `GET` request to `http://<directus-instance>/utils/random/string` with a non-numeric value for the `length` parameter (e.g., `?length=foo`).

**Required Attacker Capabilities/Position:**
- **Network access:** The attacker needs to have network connectivity to the vulnerable Directus instance.
- **No authentication required:** The attacker does not need to be authenticated to trigger the vulnerability.

**Additional Details from the Patch:**
- The fix implements validation using Joi to enforce that the length parameter must be an integer between 1 and 500.
- It also ensures that a minimum length of 1 is enforced.
- Error handling has been improved to report invalid queries and ignore unknown queries.
- The fix also updates the GraphQL service to have similar validation on the length parameter.

The provided content gives detailed steps for reproducing the vulnerability and also details the fix implemented, thus providing more insight than the official CVE description which only mentions a "PLACEHOLDER".

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.452 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.403 |
| 3 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.400 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.400 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.396 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.392 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.391 |
| 8 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | Allowed | sparse | 0.388 |
| 9 | 334 | Small Space of Random Values | Base | Allowed | dense | 0.559 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-330: Use of Insufficiently Random Values

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-1391: Use of Weak Credentials

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-502: Deserialization of Untrusted Data

CWE-863: Incorrect Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-337: Predictable Seed in Pseudo-Random Number Generator (PRNG)

CWE-334: Small Space of Random Values

CWE-804: Guessable CAPTCHA