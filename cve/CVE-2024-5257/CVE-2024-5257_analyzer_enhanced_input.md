## Vulnerability Description
An issue was discovered in GitLab CE/EE affecting all versions starting from 17.0 prior to 17.0.4 and from 17.1 prior to 17.1.2 where a Developer user with `admin_compliance_framework` custom role may have been able to modify the URL for a group namespace.

### Vulnerability Description Key Phrases
- **impact:** modify URL for group namespace
- **attacker:** Developer user with admin_compliance_framework custom role
- **product:** GitLab CE/EE
- **version:** all versions starting from 17.0 prior to 17.0.4 and from 17.1 prior to 17.1.2

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

The vulnerability stems from an incorrect permission assignment for custom roles in GitLab. Users with the `admin_compliance_framework` custom role, which is intended to manage compliance frameworks, are inadvertently granted the ability to make arbitrary changes to group settings via POST requests to the `/GROUP_PATH` endpoint. This indicates a flaw in how custom role permissions are evaluated or enforced for this specific API endpoint.

**Weaknesses/Vulnerabilities:**

*   **Incorrect Permission Assignment:** The primary weakness is that the `admin_compliance_framework` role has broader permissions than intended. It allows users to modify general group settings, which goes beyond its designated scope of managing compliance frameworks.
*   **Inadequate Input Validation:** The vulnerability suggests that there's a lack of proper authorization checks on the `/GROUP_PATH` endpoint, as a user with the `admin_compliance_framework` role can use a crafted POST request to modify group settings.
*   **CSRF Bypass:** While not explicitly stated, the need for a valid CSRF token implies the vulnerability might be more difficult to exploit, but the report shows that it is possible to bypass this protection by obtaining it.

**Impact of Exploitation:**

*   **Unauthorized Group Modification:** Attackers with the `admin_compliance_framework` role can modify crucial group settings, including the group path (URL), potentially leading to various security and availability issues.
*   **Potential for Further Attacks:** Changing the group path could disrupt existing integrations and potentially create further attack vectors, such as phishing attempts using the altered group URL.
*   **Availability Issues:** Modifying group settings could lead to service disruption or operational issues for the affected group and its users.

**Attack Vectors:**

*   **Network Request Manipulation:** The attack vector involves intercepting and modifying a legitimate request, using a POST request to the `/GROUP_PATH` endpoint with a modified body and CSRF token.
*   **Custom Role Abuse:** An attacker must be granted a custom role that includes the `admin_compliance_framework` permission.

**Required Attacker Capabilities/Position:**

*   **GitLab User Account:** The attacker must have a valid GitLab user account and be invited to a group with the custom role.
*   **`admin_compliance_framework` Role:** The attacker must have the `admin_compliance_framework` custom role, which has the base role of `Developer`.
*   **Network Access:** The attacker needs to be able to intercept and modify network requests.

**Additional Notes:**

*   The vulnerability is present on GitLab.com.
*   The provided Proof of Concept (POC) demonstrates changing the group path, which is just one example of what can be modified through this vulnerability.
*   The vulnerability can be reproduced following the step-by-step guide in the report, with additional resources such as screenshots and screen recordings included.
* The reporter explicitly highlights that the vulnerability allows access to the `POST /GROUP_PATH` endpoint, which should be restricted to more privileged roles.

This detailed report provides a clear understanding of the vulnerability, its cause, and how it can be exploited. It also emphasizes that users with the `admin_compliance_framework` role should not be able to modify general group settings.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.106 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.103 |
| 3 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.099 |
| 4 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.098 |
| 5 | 267 | Privilege Defined With Unsafe Actions | Base | Allowed | sparse | 0.096 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.092 |
| 7 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.092 |
| 8 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.092 |
| 9 | 842 | Placement of User into Incorrect Group | Base | Allowed | dense | 0.562 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-285: Improper Authorization

CWE-863: Incorrect Authorization

CWE-696: Incorrect Behavior Order

CWE-400: Uncontrolled Resource Consumption

CWE-267: Privilege Defined With Unsafe Actions

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-1286: Improper Validation of Syntactic Correctness of Input

CWE-266: Incorrect Privilege Assignment

CWE-842: Placement of User into Incorrect Group

CWE-410: Insufficient Resource Pool