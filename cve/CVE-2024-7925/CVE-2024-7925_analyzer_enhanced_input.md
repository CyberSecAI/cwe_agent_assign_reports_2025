## Vulnerability Description
A vulnerability was found in ZZCMS 2023. It has been rated as problematic. This issue affects some unknown processing of the file 3/E_bak5.1/upload/eginfo.php. The manipulation of the argument phome with the input ShowPHPInfo leads to information disclosure. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **impact:** information disclosure
- **vector:** manipulation of the argument phome with the input ShowPHPInfo
- **product:** ZZCMS
- **version:** 2023
- **component:** upload/eginfo.php

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
The vulnerability stems from the inclusion of the `phpinfo()` function in the `eginfo.php` file within the ZZCMS 2023 software.

**Weaknesses/vulnerabilities present:**
- **Information Disclosure:** The primary weakness is the presence of the `phpinfo()` function, which, when executed, outputs a large amount of sensitive system and PHP configuration information.
- **Lack of Access Control:** The vulnerability is triggered when accessing `/3/E_bak5.1/upload/eginfo.php` with the `phome=ShowPHPInfo` parameter via a GET request. It appears that the access is only restricted by requiring a user to be logged in, which is insufficient to prevent this type of information disclosure.

**Impact of exploitation:**
- **Sensitive Information Exposure:** The `phpinfo()` output reveals crucial details, including server paths, PHP version, loaded extensions, environment variables, and potentially database credentials and other sensitive data. This information can be used to gain a deeper understanding of the system and its configuration, which can be leveraged for further attacks.

**Attack vectors:**
- **HTTP GET request:** The attacker can trigger the vulnerability using a simple HTTP GET request to the vulnerable URL: `/3/E_bak5.1/upload/eginfo.php?phome=ShowPHPInfo`

**Required attacker capabilities/position:**
- **Authenticated User:** The attacker must be logged into the ZZCMS application to exploit the vulnerability.
- **Network Access:** The attacker needs network access to the vulnerable ZZCMS installation.

**Additional Details:**
- The vulnerability affects ZZCMS version 2023.
- The vulnerable file is located at `/3/E_bak5.1/upload/eginfo.php`
- The vulnerability is triggered by passing `phome=ShowPHPInfo` as a GET parameter.
- The provided proof-of-concept (PoC) demonstrates how to trigger the vulnerability using the specified URL and parameter.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | alternate_terms | 0.700 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.148 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.145 |
| 4 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.124 |
| 5 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.120 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.116 |
| 7 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.115 |
| 8 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.112 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.581 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-117: Improper Output Neutralization for Logs

CWE-705: Incorrect Control Flow Scoping

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-252: Unchecked Return Value

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-425: Direct Request ('Forced Browsing')