## Vulnerability Description
Pimcores Admin Classic Bundle provides a backend user interface for Pimcore. Navigating to `/admin/index/statistics` with a logged in Pimcore user exposes information about the Pimcore installation, PHP version, MYSQL version, installed bundles and all database tables and their row count in the system. This vulnerability is fixed in 1.5.2, 1.4.6, and 1.3.10.

### Vulnerability Description Key Phrases
- **product:** Pimcores Admin Classic Bundle
- **component:** /admin/index/statistics endpoint

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-41109:

**Root Cause of Vulnerability:**
- The `/admin/index/statistics` endpoint in pimcore/admin-ui-classic-bundle was accessible to any logged-in Pimcore user, and it disclosed sensitive system and database information. This was due to missing proper authorization checks before returning the statistics data.

**Weaknesses/Vulnerabilities Present:**
- **Information Disclosure:** The endpoint exposed detailed information about the Pimcore installation, including:
    - Pimcore version, major version, hash, and platform version.
    - PHP version.
    - MySQL/MariaDB version.
    - List of all installed bundles.
    - List of all database tables and their row counts.
- **Missing Authorization:** The vulnerability existed because the endpoint did not adequately check user permissions before disclosing the sensitive information. The initial check only prevented XmlHttpRequests, but not direct browser access by logged-in users.

**Impact of Exploitation:**
- **Confidentiality Breach:** An attacker who has valid Pimcore user credentials (even with low privileges) can gain access to the detailed system and database information, which can potentially aid in further attacks.
- **Increased Attack Surface:** The disclosed information can reveal potential vulnerabilities in the environment, increasing the attack surface for malicious actors.

**Attack Vectors:**
- **Network:** The vulnerability can be exploited over the network.
- **Direct HTTP Request:** A logged-in Pimcore user can navigate directly to the `/admin/index/statistics` endpoint using a web browser.

**Required Attacker Capabilities/Position:**
- **Pimcore User Credentials:** The attacker needs to have valid user credentials for the Pimcore system. Low privilege user accounts are sufficient to exploit the vulnerability.
- **Network Access:** The attacker needs to be able to make HTTP requests to the vulnerable endpoint.

**Additional Information:**
- The vulnerability is present in versions <=1.5.1 of `pimcore/admin-ui-classic-bundle` and also in `pimcore/ee-admin-ui-classic-bundle` with the versions mentioned above.
- The vulnerability is fixed in versions 1.5.2 (and corresponding versions of ee-admin-ui-classic-bundle)
- The fix implemented an authorization check to ensure that only admin users or users with specific permission can access the `/admin/index/statistics` endpoint.

This is a clear information disclosure vulnerability due to missing authorization checks, allowing logged in users to access sensitive system information.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 129 | Improper Validation of Array Index | Variant | Allowed | alternate_terms | 0.700 |
| 2 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.101 |
| 3 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.094 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.093 |
| 5 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.093 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.093 |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.092 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.092 |
| 9 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | dense | 0.440 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-129: Improper Validation of Array Index

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-863: Incorrect Authorization

CWE-1188: Initialization of a Resource with an Insecure Default

CWE-306: Missing Authentication for Critical Function

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-184: Incomplete List of Disallowed Inputs