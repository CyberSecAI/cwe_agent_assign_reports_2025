## Vulnerability Description
Graylog is a free and open log management platform. The reporting functionality in Graylog allows the creation and scheduling of reports which contain dashboard widgets displaying individual log messages or metrics aggregated from fields of multiple log messages. This functionality, as included in Graylog 6.1.0 & 6.1.1, is vulnerable to **information leakage** triggered by **multiple concurrent report rendering requests** from authorized users. When multiple report renderings are requested at the same start time, the headless browser instance used to render the PDF will be reused. Depending on the timing, either a check for the browser instance freshness hits, resulting in an error instead of the report being returned, or one of the concurrent report rendering requests wins and this report is returned for all report rendering requests that do not return an error. This might lead to one user getting the report of a different user, potentially leaking indexed log messages or aggregated data that this user normally has no access to. This problem is fixed in Graylog 6.1.2. There is no known workaround besides disabling the reporting functionality.

### Vulnerability Description Key Phrases
- **rootcause:** **multiple concurrent report rendering requests**
- **weakness:** **information leakage**
- **impact:** one user getting the report of a different user
- **attacker:** authorized users
- **product:** Graylog
- **version:** 6.1.0 & 6.1.1
- **component:** reporting functionality

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Concurrent PDF report rendering requests cause the reuse of a headless browser instance, which can lead to information leakage.
- **Weaknesses/vulnerabilities present**: Reusing a single headless browser instance for concurrent PDF report generation leads to data leakage between users. A race condition exists when checking the browser instance freshness.
- **Impact of exploitation**: One user may receive a report generated for another user, potentially exposing sensitive log messages or aggregated data they wouldn't normally have access to.
- **Attack vectors**: Exploitation requires sending multiple concurrent report rendering requests, as an authorized user, at the same start time.
- **Required attacker capabilities/position**: Attacker must be an authorized user within the Graylog environment capable of requesting reports.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.922 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.917 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.915 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.912 |
| 6 | 204 | Observable Response Discrepancy | Base | Allowed | sparse | 0.896 |
| 7 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.889 |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.884 |
| 9 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | dense | 0.482 |
| 10 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-306: Missing Authentication for Critical Function

CWE-204: Observable Response Discrepancy

CWE-667: Improper Locking

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-532: Insertion of Sensitive Information into Log File

CWE-209: Generation of Error Message Containing Sensitive Information