## Vulnerability Description
An issue was discovered in GitLab CE/EE affecting all versions starting from 12.0 prior to 16.11.5, starting from 17.0 prior to 17.0.3, and starting from 17.1 prior to 17.1.1, which allows for an attacker to cause a denial of service using a crafted OpenAPI file.

### Vulnerability Description Key Phrases
- **impact:** denial of service
- **vector:** crafted OpenAPI file
- **attacker:** attacker
- **product:** GitLab CE/EE
- **version:** all versions starting from 12.0 prior to 16.11.5, starting from 17.0 prior to 17.0.3, and starting from 17.1 prior to 17.1.1

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a poorly written regular expression (regex) used in `lib/gitlab/file_detector.rb` to identify specific file types, specifically OpenAPI/Swagger files.

**Weaknesses/Vulnerabilities:**

*   **Catastrophic Backtracking:** The regex `/[^/]*(openapi|swagger)[^/]*\.(yaml|yml|json)\z/` is vulnerable to catastrophic backtracking. This occurs when the regex engine tries numerous combinations of matches and backtracking, leading to excessive resource consumption and slow processing.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** By crafting a malicious filename that triggers catastrophic backtracking, an attacker can make the GitLab server unresponsive.
*   **Exhaustive Resource Consumption:** The attack causes high CPU usage, potentially impacting the performance of the entire GitLab instance.

**Attack Vectors:**

*   **Malicious Filenames:** The primary attack vector involves creating files with specific filenames designed to exploit the vulnerable regex.
*   **GraphQL Queries:**  The attacker triggers the regex evaluation by making GraphQL queries that request information about files with malicious names.
*   **Public Projects:** The attacker can potentially exploit this vulnerability without authentication on publicly accessible projects.

**Required Attacker Capabilities/Position:**

*   **GitLab User:** The attacker needs to be a GitLab user to create the malicious file within a project.
*   **Project Access:** The attacker needs to have access to a project where they can create a file with a malicious filename. This could be a public project.
*   **Ability to Send GraphQL Queries:** The attacker needs to be able to send GraphQL queries to the GitLab instance, as this is how the regex is triggered.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.131 |
| 2 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.125 |
| 3 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.121 |
| 4 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.119 |
| 5 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.119 |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.118 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.116 |
| 8 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.113 |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.543 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-400: Uncontrolled Resource Consumption

CWE-696: Incorrect Behavior Order

CWE-285: Improper Authorization

CWE-1286: Improper Validation of Syntactic Correctness of Input

CWE-1333: Inefficient Regular Expression Complexity

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-863: Incorrect Authorization

CWE-755: Improper Handling of Exceptional Conditions

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-410: Insufficient Resource Pool