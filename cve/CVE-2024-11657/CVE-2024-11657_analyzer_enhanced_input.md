## Vulnerability Description
A vulnerability, which was classified as critical, was found in EnGenius ENH1350EXT, ENS500-AC and ENS620EXT up to 20241118. Affected is an unknown function of the file /admin/network/diag_nslookup. The manipulation of the argument diag_nslookup leads to **command injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **vector:** manipulation of diag_nslookup argument
- **product:** EnGenius ENH1350EXT and ENS500-AC and ENS620EXT
- **version:** up to 20241118
- **component:** /admin/network/diag_nslookup

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

*   The vulnerability stems from the lack of input sanitization in the `diag_nslookup` interface of ENGENIUS routers. User-supplied input to `diag_nslookup` is directly passed to a system command execution function (`diag_command`) without any filtering or validation.

**Weaknesses/Vulnerabilities Present:**

*   **Command Injection:** The primary vulnerability is command injection. By inserting shell metacharacters (e.g., backticks `` ` ``) and commands into the `diag_nslookup` parameter, an attacker can execute arbitrary system commands on the router.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** Successful exploitation allows the attacker to execute arbitrary code with the privileges of the web server process.
*   **Full System Compromise:** This can lead to complete compromise of the router, including access to sensitive data, modification of system settings, and potential use of the router as part of a botnet.

**Attack Vectors:**

*   **Web Interface:** The attack is performed via the web interface of the router, specifically by making requests to the `/admin/network/diag_nslookup` endpoint.
*   **HTTP GET Request:** The provided proof-of-concept uses an HTTP GET request to inject the malicious command.

**Required Attacker Capabilities/Position:**

*   **Authentication:** The attacker needs to be authenticated to the router's administrative interface.
*   **Network Access:** The attacker must have network access to the router's web interface.

**Additional Information:**

*   **Affected Devices:** Multiple ENGENIUS router devices are affected, including ENH1350EXT, ENS500-AC, and ENS620EXT.
*  **Lack of Vendor Response:** The content mentions that the researchers attempted to contact the manufacturer, but there was no response.
*   **Lua code analysis**: The analysis also mentions the need for reverse engineering the Lua bytecode for further analysis, confirming the vulnerability is present within the router's firmware logic.

This content provides more details than a typical CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.516 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.485 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.419 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.410 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.401 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.399 |
| 9 | 912 | Hidden Functionality | Class | Allowed-with-Review | dense | 0.641 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-306: Missing Authentication for Critical Function

CWE-912: Hidden Functionality

CWE-184: Incomplete List of Disallowed Inputs