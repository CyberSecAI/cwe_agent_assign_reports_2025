## Vulnerability Description
Multiple buffer overflow vulnerabilities exist in the internet.cgi set_qos() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to stack-based buffer overflow. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.This vulnerability exists in the `cli_name` POST parameter.

### Vulnerability Description Key Phrases
- **component:** internet.cgi set_qos() functionality
- **vector:** specially crafted HTTP request
- **weakness:** **stack-based buffer overflow, buffer overflow**
- **product:** Wavlink AC3000
- **attacker:** authenticated attacker
- **version:** M33A8.V5030.210505

## CVE Reference Links Content Summary
## Analysis of CVE-2024-39768 Content

This content is **RELEVANT** to CVE-2024-39768. It provides a detailed vulnerability report from Talos Intelligence.

**Root cause of vulnerability:**

The vulnerabilities stem from insufficient input validation when handling HTTP POST requests to the `internet.cgi` script, specifically within the `set_qos()` function. The script uses `strcat` to concatenate user-supplied data (`cli_name`, `cli_mac`, `en_enable`) into a fixed-size buffer (`buf_0x424`) without checking the length of the input, leading to potential buffer overflows.

**Weaknesses/vulnerabilities present:**

*   **CWE-120 - Buffer Copy without Checking Size of Input (‘Classic Buffer Overflow’):**  The core vulnerability is a classic stack-based buffer overflow.
*   Multiple buffer overflow vulnerabilities exist in the `internet.cgi` script. Specifically in the `set_qos()` function.
*   Vulnerable parameters: `cli_name`, `cli_mac`, and `en_enable` POST parameters.

**Impact of exploitation:**

Successful exploitation allows an attacker to overwrite the return address of the function, leading to arbitrary code execution.

**Attack vectors:**

*   An attacker can send a specially crafted HTTP POST request to the `internet.cgi` script.
*   The attacker needs to be authenticated to the device (have a valid session cookie).
*   The vulnerable parameters are passed within the HTTP POST data.

**Required attacker capabilities/position:**

*   Network access to the Wavlink AC3000 router.
*   Authenticated access (valid session cookie) to the router's web interface.
*   Ability to craft and send malicious HTTP POST requests.

**Mitigation or fix:**

The report does not explicitly state a fix, but implies that proper input validation and bounds checking are required to prevent the buffer overflows. The vendor was contacted and is working on patches, but the product has been discontinued.

**Additional Details (more than official CVE description):**

*   **Affected Product:** Wavlink AC3000 M33A8.V5030.210505
*   **CVSSv3 Score:** 9.1 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)
*   **Detailed code snippets:** The report includes relevant code snippets from the `internet.cgi` script, showing the vulnerable `strcat` calls.
*   **Crash Information:** GDB crash information is provided, demonstrating the buffer overflow.
*   **Timeline:** The report details the timeline of vulnerability disclosure and vendor communication.
*   **Discovered by:** Lilith of Cisco Talos.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.360 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.326 |
| 6 | 195 | Signed to Unsigned Conversion Error | Variant | Allowed | sparse | 0.304 |
| 7 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.300 |
| 8 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.299 |
| 9 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | dense | 0.628 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-121: Stack-based Buffer Overflow

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-195: Signed to Unsigned Conversion Error

CWE-197: Numeric Truncation Error

CWE-134: Use of Externally-Controlled Format String

CWE-805: Buffer Access with Incorrect Length Value

CWE-128: Wrap-around Error