# Raw Retriever Results for CVE-2024-41000

# Raw Retriever Results for CVE-2024-41000
## Query
In the Linux kernel, the following vulnerability has been resolvedblock/ioctl prefer different overflow checkRunning syzkaller with the newly reintroduced signed integer overflowsanitizer shows this report[ 62.982337] ------------[ cut here ]------------[ 62.985692] cgroup Invalid name[ 62.986211] UBSAN signed-integer-overflow in ../block/ioctl.c3646[ 62.989370] 9pnet_fd p9_fd_create_tcp (7343) problem connecting socket to 127.0.0.1[ 62.992992] 9223372036854775807 + 4095 cannot be represented in type long long[ 62.997827] 9pnet_fd p9_fd_create_tcp (7345) problem connecting socket to 127.0.0.1[ 62.999369] random crng reseeded on system resumption[ 63.000634] GUP no longer grows the stack in syz-executor.2 (7353) 20002000-20003000 (20001000)[ 63.000668] CPU 0 PID 7353 Comm syz-executor.2 Not tainted 6.8.0-rc2-00035-gb3ef86b5a957 #1[ 63.000677] Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014[ 63.000682] Call Trace[ 63.000686] [ 63.000731] dump_stack_lvl+0x93/0xd0[ 63.000919] __get_user_pages+0x903/0xd30[ 63.001030] __gup_longterm_locked+0x153e/0x1ba0[ 63.001041] ? _raw_read_unlock_irqrestore+0x17/0x50[ 63.001072] ? try_get_folio+0x29c/0x2d0[ 63.001083] internal_get_user_pages_fast+0x1119/0x1530[ 63.001109] iov_iter_extract_pages+0x23b/0x580[ 63.001206] bio_iov_iter_get_pages+0x4de/0x1220[ 63.001235] iomap_dio_bio_iter+0x9b6/0x1410[ 63.001297] __iomap_dio_rw+0xab4/0x1810[ 63.001316] iomap_dio_rw+0x45/0xa0[ 63.001328] ext4_file_write_iter+0xdde/0x1390[ 63.001372] vfs_write+0x599/0xbd0[ 63.001394] ksys_write+0xc8/0x190[ 63.001403] do_syscall_64+0xd4/0x1b0[ 63.001421] ? arch_exit_to_user_mode_prepare+0x3a/0x60[ 63.001479] entry_SYSCALL_64_after_hwframe+0x6f/0x77[ 63.001535] RIP 00330x7f7fd3ebf539[ 63.001551] Code 28 00 00 00 75 05 48 83 c4 28 c3 e8 f1 14 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48[ 63.001562] RSP 002b00007f7fd32570c8 EFLAGS 00000246 ORIG_RAX 0000000000000001[ 63.001584] RAX ffffffffffffffda RBX 00007f7fd3ff3f80 RCX 00007f7fd3ebf539[ 63.001590] RDX 4db6d1e4f7e43360 RSI 0000000020000000 RDI 0000000000000004[ 63.001595] RBP 00007f7fd3f1e496 R08 0000000000000000 R09 0000000000000000[ 63.001599] R10 0000000000000000 R11 0000000000000246 R12 0000000000000000[ 63.001604] R13 0000000000000006 R14 00007f7fd3ff3f80 R15 00007ffd415ad2b8...[ 63.018142] ---[ end trace ]---Historically, the signed integer overflow sanitizer did not work in thekernel due to its interaction with `-fwrapv` but this has since beenchanged [1] in the newest version of Clang It was re-enabled in thekernel with Commit 557f8c582a9ba8ab (ubsan Reintroduce signed overflowsanitizer).Lets rework this overflow checking logic to not actually perform anoverflow during the check itself, thus avoiding the UBSAN splat.[1] https//github.com/llvm/llvm-project/pull/82432

## Keyphrases
- **rootcause**: 'Signed integer overflow during overflow check in block', 'ioctl.c'
- **weakness**: 'Incorrect overflow check logic leading to an actual overflow during the check itself.'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5383 | 0.6231 | 0.5646 | 0.5611 | 20 |
| Sparse | 729.0442 | 1114.4088 | 845.5446 | 828.5679 | 12 |
| Graph | 1.5597 | 2.4225 | 1.9163 | 1.7917 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 197 | Numeric Truncation Error | Base | 2.4225 | Allowed |
| 2 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 3 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 4 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 5 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2594 | Allowed-with-Review |
| 6 | 195 | Signed to Unsigned Conversion Error | variant | 2.2032 | Allowed |
| 7 | 288 | Authentication Bypass Using an Alternate Path or Channel | base | 2.1190 | Allowed |
| 8 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | base | 2.1190 | Allowed |
| 9 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 10 | 194 | Unexpected Sign Extension | Variant | 1.8153 | Allowed |
| 11 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 12 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 13 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 14 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 15 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | 0.6231 | 0.6231 | Allowed |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.6199 | 0.6199 | Allowed |
| 3 | 194 | Unexpected Sign Extension | Variant | 0.5989 | 0.5989 | Allowed |
| 4 | 909 | Missing Initialization of Resource | Class | 0.5816 | 0.5816 | Allowed-with-Review |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5797 | 0.5797 | Allowed-with-Review |
| 6 | 122 | Heap-based Buffer Overflow | Variant | 0.5788 | 0.5788 | Allowed |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5739 | 0.5739 | Allowed |
| 8 | 667 | Improper Locking | Class | 0.5732 | 0.5732 | Allowed-with-Review |
| 9 | 126 | Buffer Over-read | Variant | 0.5697 | 0.5697 | Allowed |
| 10 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5688 | 0.5688 | Allowed |
| 11 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5534 | 0.5534 | Discouraged |
| 12 | 197 | Numeric Truncation Error | Base | 0.5434 | 0.5434 | Allowed |
| 13 | 674 | Uncontrolled Recursion | Class | 0.5430 | 0.5430 | Allowed-with-Review |
| 14 | 416 | Use After Free | Variant | 0.5425 | 0.5425 | Allowed |
| 15 | 193 | Off-by-one Error | Base | 0.5424 | 0.5424 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 197 | Numeric Truncation Error | 1114.4088 | 1114.4088 | Allowed |
| 2 | 288 | Authentication Bypass Using an Alternate Path or Channel | 934.0036 | 934.0036 | Allowed |
| 3 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | 931.0897 | 931.0897 | Allowed |
| 4 | 190 | Integer Overflow or Wraparound | 863.1814 | 863.1814 | Allowed |
| 5 | 121 | Stack-based Buffer Overflow | 853.4474 | 853.4474 | Allowed |
| 6 | 400 | Uncontrolled Resource Consumption | 848.2797 | 848.2797 | Discouraged |
| 7 | 126 | Buffer Over-read | 808.8561 | 808.8561 | Allowed |
| 8 | 61 | UNIX Symbolic Link (Symlink) Following | 779.0361 | 779.0361 | Allowed |
| 9 | 287 | Improper Authentication | 777.9708 | 777.9708 | Discouraged |
| 10 | 195 | Signed to Unsigned Conversion Error | 772.5573 | 772.5573 | Allowed |
| 11 | 294 | Authentication Bypass by Capture-replay | 734.6606 | 734.6606 | Allowed |
| 12 | 122 | Heap-based Buffer Overflow | 729.0442 | 729.0442 | Allowed |
