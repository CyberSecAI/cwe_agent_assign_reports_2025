# Vulnerability Information: CVE-2025-24974

## Vulnerability Description
DataEase is an open source business intelligence and data visualization tool. Prior to version 2.10.6, authenticated users can **read and deserialize arbitrary files** through the background JDBC connection. The vulnerability has been fixed in v2.10.6. No known workarounds are available.

### Vulnerability Description Key Phrases
- **weakness:** **read and deserialize arbitrary files**
- **impact:** arbitrary file deserialization
- **attacker:** authenticated users
- **product:** DataEase
- **version:** prior to 2.10.6
- **component:** background JDBC connection

## CVE Reference Links Content Summary
## Analysis of CVE-2025-24974 based on provided content:

This content directly relates to CVE-2025-24974 and provides significantly more detail than a standard CVE description.

**Root cause of vulnerability:**

The vulnerability stems from insufficient validation of JDBC connection parameters in the `io.dataease.datasource.type.Mysql` class. Specifically, the code does not prevent the use of the `maxAllowedPacket` parameter, which can be exploited to read arbitrary files on the server.

**Weaknesses/vulnerabilities present:**

*   **Insufficient Input Validation:** The application fails to properly sanitize or validate user-supplied input (JDBC connection parameters).
*   **Deserialization of Untrusted Data:** The ability to control JDBC parameters allows for potential deserialization of untrusted data, leading to arbitrary file read.

**Impact of exploitation:**

An authenticated user can read arbitrary files on the DataEase server.

**Attack vectors:**

*   An attacker with authentication can modify the JDBC connection parameters to include `maxAllowedPacket`, triggering the file read vulnerability.
*   The provided video (2025-01-23.19-09-11.mov) demonstrates the exploitation steps.

**Required attacker capabilities/position:**

*   The attacker needs to be an authenticated user of the DataEase application.

**Mitigation or fix:**

*   Upgrade to version 2.10.6 or later, which includes a fix for this vulnerability.
*   The fix involves adding `maxAllowedPacket` to the list of `illegalParameters` to prevent its use in the JDBC connection string.

**Additional Details:**

*   The vulnerable code is located in `io.dataease.datasource.type.Mysql`.
*   The vulnerability affects versions <= 2.10.5.
*   The vulnerability was reported by @hack-umbrella.
*   The advisory provides contact information for reporting further issues (wei@fit2cloud.com) and opening an issue on the GitHub repository (<https://github.com/dataease/dataease>).
*   The CVE ID is CVE-2025-24974.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 125 | Out-of-bounds Read | Base | Allowed | alternate_terms | 0.700 |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.221 |
| 3 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.219 |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.215 |
| 5 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.211 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.211 |
| 7 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.208 |
| 8 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.207 |
| 9 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | dense | 0.436 |
| 10 | 41 | Improper Resolution of Path Equivalence | Base | Allowed | graph | 0.002 |

