# Vulnerability Information: CVE-2025-23394

## Vulnerability Description
A **UNIX Symbolic Link (Symlink) Following** vulnerability in openSUSE Tumbleweed cyrus-imapd allows escalation from cyrus to root.This issue affects openSUSE Tumbleweed cyrus-imapd before 3.8.4-2.1.

### Vulnerability Description Key Phrases
- **rootcause:** **UNIX Symbolic Link (Symlink) Following**
- **impact:** escalation from cyrus to root
- **product:** openSUSE Tumbleweed cyrus-imapd
- **version:** before 3.8.4-2.1

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
The cyrus-imapd service's daily-backup.sh script runs with root privileges.  The script operates in directories controlled by the unprivileged "cyrus" user, allowing for symlink manipulation.

Weaknesses/vulnerabilities present:
- Privilege escalation: The "cyrus" user can escalate privileges to root.
- Symlink vulnerability: The cyrus user can create symlinks within /var/lib/imap, which the backup script follows.

Impact of exploitation:
A compromised "cyrus" account can achieve full local privilege escalation.

Attack vectors:
An attacker with control of the "cyrus" account can exploit the symlink vulnerability.

Required attacker capabilities/position:
The attacker needs a compromised "cyrus" account.

Mitigation or fix:
The service should run with "cyrus" privileges from the beginning. The script should refuse to operate with full root privileges. Suggested fix:  [Service] Type=oneshot ExecStart=__LIBEXECDIR__/tools/daily-backup.sh User=cyrus Group=mail
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.382 |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.236 |
| 3 | 64 | Windows Shortcut Following (.LNK) | Variant | Allowed | sparse | 0.192 |
| 4 | 1393 | Use of Default Password | Base | Allowed | sparse | 0.186 |
| 5 | 62 | UNIX Hard Link | Variant | Allowed | sparse | 0.174 |
| 6 | 303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | sparse | 0.168 |
| 7 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.152 |
| 8 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.151 |
| 9 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | dense | 0.551 |
| 10 | 363 | Race Condition Enabling Link Following | Base | Allowed | graph | 0.002 |

