## Vulnerability Description
A vulnerability classified as critical has been found in Tenda AC6 15.03.05.16. Affected is the function GetParentControlInfo of the file /goform/GetParentControlInfo. The manipulation of the argument src/mac leads to **stack-based buffer overflow**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. Other parameters might be affected as well.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **vector:** manipulation of the argument src/mac
- **product:** Tenda AC6
- **version:** 15.03.05.16
- **component:** GetParentControlInfo of the file /goform/GetParentControlInfo

## CVE Reference Links Content Summary
## Analysis of CVE-2025-0349 related content

Based on the provided content, this relates to a buffer overflow vulnerability in the Tenda AC6 V15.03.05.16 firmware. Here's a breakdown of the information:

**Root cause of vulnerability:**

The vulnerability stems from the use of `strcpy` in the `GetParentControlInfo` function without proper bounds checking. `strcpy` copies a string from a source (`src`) to a destination buffer (`s + 2`) without verifying the size of the source string or ensuring it doesn't exceed the capacity of the destination buffer.

**Weaknesses/vulnerabilities present:**

*   **Buffer Overflow:** The core vulnerability is a buffer overflow due to unchecked string copying.
*   **Unsafe Function Usage:** The use of `strcpy` is inherently unsafe as it doesn't provide any protection against buffer overflows.
*   **Lack of Input Validation:** The size of the input string (`src`) obtained from `sub_2B7C4(a1, "mac", &unk_EA0EC)` is not validated before being copied.

**Impact of exploitation:**

The vulnerability allows for a buffer overflow, potentially leading to:

*   **Denial of Service (DoS):**  Overwriting critical data could crash the device.
*   **Remote Code Execution (RCE):**  A carefully crafted payload could potentially overwrite function return addresses or other critical data, allowing an attacker to execute arbitrary code on the device. (This is implied, but not explicitly stated in the provided content).

**Attack vectors:**

*   **Network:** The vulnerability is exploitable via network requests to the `http://<target_ip>/goform/GetParentControlInfo` endpoint.
*   **HTTP GET Request:** The exploit uses an HTTP GET request with a `mac` parameter to send the malicious payload.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the Tenda AC6 device.
*   **Understanding of the Vulnerability:** The attacker needs to understand the buffer overflow vulnerability and how to craft a payload to exploit it.
*   **Ability to Send HTTP Requests:** The attacker needs to be able to send crafted HTTP GET requests.

**Mitigation or fix:**

The content does not provide information about a specific fix. However, the following mitigations are implied:

*   **Replace `strcpy`:** Replace `strcpy` with a safer alternative like `strncpy` or `snprintf` that allows specifying the maximum number of bytes to copy.
*   **Input Validation:** Implement robust input validation to ensure that the size of the `src` string does not exceed the capacity of the destination buffer.
*   **Firmware Update:** Apply any security updates released by Tenda that address this vulnerability.

**PoC (Proof of Concept):**

The content includes a Python script demonstrating a proof-of-concept exploit. The script creates a payload of a large string ("A" repeated many times) and appends a specific value (`v11_value`). It then sends this payload as the `mac` parameter in an HTTP GET request to the vulnerable endpoint.

**More detail than official CVE description:**

Yes, the content provides significantly more detail than a typical CVE description. It includes:

*   Specific function name (`GetParentControlInfo`)
*   Detailed explanation of the root cause (use of `strcpy` and lack of bounds checking)
*   A PoC exploit script
*   Specific URL for exploitation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.450 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.415 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.393 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.383 |
| 7 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.383 |
| 8 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.370 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.638 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-121: Stack-based Buffer Overflow

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-125: Out-of-bounds Read

CWE-674: Uncontrolled Recursion

CWE-122: Heap-based Buffer Overflow

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-128: Wrap-around Error