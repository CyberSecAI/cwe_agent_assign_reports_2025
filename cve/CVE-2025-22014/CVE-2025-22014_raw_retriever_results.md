# Raw Retriever Results for CVE-2025-22014

# Raw Retriever Results for CVE-2025-22014
## Query
In the Linux kernel, the following vulnerability has been resolved soc qcom pdr Fix the potential deadlock When some client process A call pdr_add_lookup() to add the look up for the service and does schedule locator work, later a process B got a new server packet indicating locator is up and call pdr_locator_new_server() which eventually sets pdr->locator_init_complete to true which process A sees and takes list lock and queries domain list but it will timeout due to deadlock as the response will queued to the same qmi->wq and it is ordered workqueue and process B is not able to complete new server request work due to deadlock on list lock. Fix it by removing the unnecessary list iteration as the list iteration is already being done inside locator work, so avoid it here and just call schedule_work() here. Process A Process B process_scheduled_works() pdr_add_lookup() qmi_data_ready_work() process_scheduled_works() pdr_locator_new_server() pdr->locator_init_complete=true pdr_locator_work() mutex_lock(&pdr->list_lock) pdr_locate_service() mutex_lock(&pdr->list_lock) pdr_get_domain_list() pr_err(PDR %s get domain list txn wait failed %d\\n, req->service_name, ret) Timeout error log due to deadlock PDR tms/servreg get domain list txn wait failed -110 PDR service lookup for msm/adsp/sensor_pdtms/servreg failed -110 Thanks to Bjorn and Johan for letting me know that this commit also fixes an audio regression when using the in-kernel pd-mapper as that makes it easier to hit this race. [1]

## Keyphrases
- **weakness**: 'potential deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4606 | 0.5776 | 0.4952 | 0.4889 | 20 |
| Sparse | 804.8375 | 967.9270 | 853.2974 | 850.5278 | 10 |
| Graph | 1.4784 | 2.2100 | 1.7600 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 2 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 5 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 7 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 8 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 9 | 833 | Deadlock | Base | 1.7215 | Allowed |
| 10 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 11 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 12 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 13 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 15 | 476 | NULL Pointer Dereference | Base | 1.5320 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5776 | 0.5776 | Allowed |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5380 | 0.5380 | Allowed |
| 3 | 667 | Improper Locking | Class | 0.5368 | 0.5368 | Allowed-with-Review |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5270 | 0.5270 | Allowed-with-Review |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5175 | 0.5175 | Allowed |
| 6 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5060 | 0.5060 | Discouraged |
| 7 | 909 | Missing Initialization of Resource | Class | 0.5059 | 0.5059 | Allowed-with-Review |
| 8 | 413 | Improper Resource Locking | Base | 0.5025 | 0.5025 | Allowed |
| 9 | 400 | Uncontrolled Resource Consumption | Class | 0.4982 | 0.4982 | Discouraged |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4932 | 0.4932 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4847 | 0.4847 | Allowed |
| 12 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4775 | 0.4775 | Allowed |
| 13 | 121 | Stack-based Buffer Overflow | Variant | 0.4749 | 0.4749 | Allowed |
| 14 | 126 | Buffer Over-read | Variant | 0.4723 | 0.4723 | Allowed |
| 15 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4697 | 0.4697 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 967.9270 | 967.9270 | Allowed-with-Review |
| 2 | 833 | Deadlock | 903.1317 | 903.1317 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 863.3430 | 863.3430 | Allowed |
| 4 | 863 | Incorrect Authorization | 858.4543 | 858.4543 | Allowed-with-Review |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 853.2073 | 853.2073 | Allowed-with-Review |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | 847.8484 | 847.8484 | Allowed |
| 7 | 184 | Incomplete List of Disallowed Inputs | 817.3322 | 817.3322 | Allowed |
| 8 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 810.4040 | 810.4040 | Allowed |
| 9 | 909 | Missing Initialization of Resource | 806.4884 | 806.4884 | Allowed-with-Review |
| 10 | 401 | Missing Release of Memory after Effective Lifetime | 804.8375 | 804.8375 | Allowed |
