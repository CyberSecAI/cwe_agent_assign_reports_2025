{
  "query": "In the Linux kernel, the following vulnerability has been resolved netfilter nf_tables unconditionally flush pending work before notifier syzbot reports KASAN slab-uaf in nft_ctx_update include/net/netfilter/nf_tables.h1831 KASAN slab-uaf in nft_commit_release net/netfilter/nf_tables_api.c9530 KASAN slab-uaf int nf_tables_trans_destroy_work+0x152b/0x1750 net/netfilter/nf_tables_api.c9597 Read of size 2 at addr ffff88802b0051c4 by task kworker/11/45 [..] Workqueue events nf_tables_trans_destroy_work Call Trace nft_ctx_update include/net/netfilter/nf_tables.h1831 [inline] nft_commit_release net/netfilter/nf_tables_api.c9530 [inline] nf_tables_trans_destroy_work+0x152b/0x1750 net/netfilter/nf_tables_api.c9597 Problem is that the notifier does a conditional flush, but its possible that the table-to-be-removed is still referenced by transactions being processed by the worker, so we need to flush unconditionally. We could make the flush_work depend on whether we found a table to delete in nf-next to avoid the flush for most cases. AFAICS this problem is only exposed in nf-next, with commit e169285f8c56 (netfilter nf_tables do not store nft_ctx in transaction objects), with this commit applied there is an unconditional fetch of table->family which is whats triggering the above splat.",
  "count": 11,
  "results": [
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "abstraction": "Class",
      "score": 848.5859822721243,
      "original_score": 848.5859822721243,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "416",
      "name": "Use After Free",
      "abstraction": "Variant",
      "score": 800.0,
      "original_score": 800.0,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "675",
      "name": "Multiple Operations on Resource in Single-Operation Context",
      "abstraction": "Class",
      "score": 644.8181382283593,
      "original_score": 644.8181382283593,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "843",
      "name": "Access of Resource Using Incompatible Type ('Type Confusion')",
      "abstraction": "Base",
      "score": 614.3267178389706,
      "original_score": 614.3267178389706,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 612.3626823447034,
      "original_score": 612.3626823447034,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 610.187572813079,
      "original_score": 610.187572813079,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "abstraction": "Class",
      "score": 607.082442105403,
      "original_score": 607.082442105403,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "502",
      "name": "Deserialization of Untrusted Data",
      "abstraction": "Base",
      "score": 598.1292291615354,
      "original_score": 598.1292291615354,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "674",
      "name": "Uncontrolled Recursion",
      "abstraction": "Class",
      "score": 593.936748761406,
      "original_score": 593.936748761406,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 591.36951061607,
      "original_score": 591.36951061607,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "abstraction": "Base",
      "score": 590.3232931798839,
      "original_score": 590.3232931798839,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 590.3232931798839,
    "max": 848.5859822721243,
    "mean": 646.4656652110486,
    "median": 610.187572813079,
    "count": 11
  }
}