# Vulnerability Information: CVE-2025-2584

## Vulnerability Description
A vulnerability was found in WebAssembly wabt 1.0.36. It has been declared as critical. This vulnerability affects the function BinaryReaderInterpGetReturnCallDropKeepCount of the file wabt/src/interp/binary-reader-interp.cc. The manipulation leads to **heap-based buffer overflow**. The attack can be initiated remotely. The complexity of an attack is rather high. The exploitation appears to be difficult. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** WebAssembly wabt
- **version:** 1.0.36
- **component:** function BinaryReaderInterpGetReturnCallDropKeepCount of the file wabt/src/interp/binary-reader-interp.cc

## CVE Reference Links Content Summary
Here's an analysis of the provided content based on the guidelines:

**Content from github.com_6779b3ca_20250624_195244.html (stripped) and github.com_ce0421eb_20250624_195242.html (stripped):**

*   **Relates to CVE-2025-2584:**  Yes, the content describes a heap-based buffer overflow vulnerability.
*   **Root cause of vulnerability:** The vulnerability lies in the `wabt::interp::(anonymous namespace)::BinaryReaderInterp::GetReturnCallDropKeepCount` function where boundary checks are missing when processing files with certain formatting errors. This leads to read operations exceeding allocated memory. Specifically, the line `Index keep_count = static_cast<Index>(func_type.params.size()) + keep_extra;` is identified as the point of the heap-buffer-overflow.
*   **Weaknesses/vulnerabilities present:** Heap-based buffer overflow (CWE-122).
*   **Impact of exploitation:** Application crashes due to invalid memory access.
*   **Attack vectors:** Processing specially crafted WebAssembly files.
*   **Required attacker capabilities/position:** The attacker needs to be able to provide or cause the vulnerable software to process a malicious WebAssembly file.
*   **Mitigation or fix:** The provided content doesn't include a specific mitigation or fix. However, the nature of the vulnerability suggests that fixing this would involve implementing proper boundary checks within the vulnerable function.
*   **More detail than official CVE description:** The content provides significantly more detail than a typical CVE description, including the exact location of the vulnerability in the source code and steps to reproduce the issue with a fuzzer.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.444 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.439 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.427 |
| 6 | 704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | sparse | 0.409 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.409 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.406 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.617 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

