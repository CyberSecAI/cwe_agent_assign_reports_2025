## Vulnerability Description
A vulnerability, which was classified as critical, has been found in Guangzhou Huayi Intelligent Technology Jeewms up to 20241229. This issue affects the function saveOrUpdate of the file org/jeecgframework/web/cgform/controller/build/CgFormBuildController. java. The manipulation leads to sql injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 20250101 is able to address this issue. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **component:** org/jeecgframework/web/cgform/controller/build/CgFormBuildController.java
- **weakness:** **sql injection, SQL injection**
- **product:** Guangzhou Huayi Intelligent Technology Jeewms
- **version:** up to 20241229

## CVE Reference Links Content Summary
## Analysis of CVE-2025-0391 based on provided content

This content **IS RELATED** to CVE-2025-0391. It provides a detailed vulnerability report for JEEWMS, specifically outlining an SQL injection vulnerability. Here's a breakdown of the information extracted:

**Root cause of vulnerability:**

The vulnerability stems from insufficient input validation and sanitization of the `id` parameter in the `CgFormBuildController.do?saveOrUpdate` request. The code directly uses the `id` parameter in an SQL query without proper filtering, allowing for malicious SQL code injection.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection:** The primary vulnerability is a classic SQL injection flaw.
*   **Lack of Input Validation:** The code fails to validate or sanitize user-supplied input (the `id` parameter) before incorporating it into an SQL query.
*   **Direct SQL Construction:** The code constructs SQL queries by directly concatenating strings, making it susceptible to injection attacks.

**Impact of exploitation:**

Successful exploitation of this vulnerability could allow an attacker to:

*   **Read sensitive data:** Access unauthorized information from the database.
*   **Modify data:** Alter or delete data within the database.
*   **Execute arbitrary code:** Potentially gain control of the database server.

**Attack vectors:**

*   **HTTP Request Manipulation:** The attacker crafts a malicious HTTP request with a specially crafted `id` parameter.
*   **POC Example:** The provided Proof of Concept (POC) demonstrates the vulnerability using the following URL:
    ```
    http://localhost:8083/jeewms/cgFormBuildController.do?saveOrUpdate&bpm_status=&create_by=&create_date=&create_name=&id='and/**/updatexml(1,concat(0x7e,user(),0x7e),1)and'&sys_company_code=&sys_org_code=&tableName=wm_wendu&update_by=&update_date=&update_name=&wendu_bz=1&wendu_cjsj=2024-05-09+11%3A12%3A41&wendu_dd=1&wendu_zhi=1
    ```

**Required attacker capabilities/position:**

*   **Authenticated Access:** The POC shows the attacker needs to be logged in as a user (e.g., `admin/llg123`).
*   **Network Access:** The attacker needs network access to the JEEWMS application.
*   **Understanding of SQL Injection:** The attacker needs knowledge of SQL injection techniques to craft a malicious payload.

**Mitigation or fix:**

The report doesn't explicitly state a fix, but the following mitigations are implied:

*   **Parameterized Queries:** Use parameterized queries (prepared statements) to separate SQL code from user-supplied data.
*   **Input Validation:** Implement robust input validation to ensure that the `id` parameter conforms to expected data types and formats.
*   **Output Encoding:** Encode output to prevent malicious code from being interpreted as executable code.
*   **Least Privilege:** Ensure that the database user account used by the application has only the necessary privileges.

**Additional Details:**

*   **Vulnerable Product:** JEEWMS
*   **Vulnerable Version:** Before 2025.01.01
*   **Reported by:** Chaitin Security Research Lab
*   The report provides specific file paths and line numbers within the JEEWMS codebase where the vulnerability exists, aiding in remediation.
*   The report includes screenshots illustrating the code flow and the point of injection.

This content provides significantly more detail than a typical CVE description, offering a comprehensive analysis of the vulnerability, its root cause, and potential exploitation methods.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.502 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.428 |
| 4 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.420 |
| 5 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.410 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.397 |
| 7 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.397 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.391 |
| 9 | 564 | SQL Injection: Hibernate | Variant | Allowed | dense | 0.574 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-705: Incorrect Control Flow Scoping

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-564: SQL Injection: Hibernate

CWE-184: Incomplete List of Disallowed Inputs