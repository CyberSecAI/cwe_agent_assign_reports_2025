{
  "cve_id": "CVE-2024-45326",
  "description": "An **Improper Access Control** vulnerability [**CWE-284**] in FortiDeceptor version 6.0.0, version 5.3.3 and below, version 5.2.1 and below, version 5.1.0, version 5.0.0 may allow an authenticated attacker with none privileges to perform operations on the central management appliance via crafted requests.",
  "key_phrases": {
    "rootcause": "Improper Access Control",
    "weakness": "CWE-284",
    "impact": "perform operations on the central management appliance",
    "vector": "crafted requests",
    "attacker": "authenticated attacker with none privileges",
    "product": "FortiDeceptor",
    "version": [
      "version 6.0.0",
      "version 5.3.3 and below",
      "version 5.2.1 and below",
      "version 5.1.0",
      "version 5.0.0"
    ],
    "component": ""
  },
  "reference_content": "```text\n**Relevant Content from fortiguard.fortinet.com_35f2834c_20250624_120903.html:**\n\n*   **Vulnerability:** Improper Access Control vulnerability in FortiDeceptor.\n*   **Affected Component:** GUI\n*   **Impact:** Improper access control.\n*   **CVE ID:** CVE-2024-45326\n*   **Root Cause:** An Improper Access Control vulnerability [CWE-284]\n*   **Attack Vector:** May allow an authenticated attacker with none privileges to perform operations on the central management appliance via crafted requests.\n*   **Required Attacker Capabilities/Position:** Authenticated attacker with none privileges.\n*   **Affected Versions:**\n    *   FortiDeceptor 6.0 - 6.0.0\n    *   FortiDeceptor 5.3 - All versions\n    *   FortiDeceptor 5.2 - All versions\n    *   FortiDeceptor 5.1 - All versions\n    *   FortiDeceptor 5.0 - All versions\n*   **Mitigation:**\n    *   Upgrade to FortiDeceptor 6.0.1 or above.\n    *   Migrate to a fixed release.\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name                       | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :----------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-284 | Improper Access Control        | 1          | Pillar                | Primary                         | Allowed-with-Review              |\n| CWE-863 | Incorrect Authorization         | 0.7        | Class                 | Secondary                       | Allowed-with-Review              |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-284, which is a high-level category. The analysis considered the guidance to prefer more specific child CWEs if applicable. The relationship guidance suggests that if the root cause is an authentication issue, CWE-306 should be used. If the root cause is an authorization issue with flawed logic, then CWE-863 should be used. Given that the vulnerability description specifies \"Improper Access Control\" and the attacker is \"authenticated,\" it suggests the issue lies in authorization. CWE-863 is considered a secondary candidate because the authorization check is likely present, but flawed.\n\n```mermaid\ngraph TD\n    cwe284[\"CWE-284: Improper Access Control\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n\n    cwe863 -->|CHILDOF| cwe284\n    cwe285 -->|CHILDOF| cwe284\n    cwe306 -->|CHILDOF| cwe284\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe284 primary\n    class cwe863 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with **Improper Access Control** [**CWE-284**], which allows an authenticated attacker with no privileges to perform operations on the central management appliance via crafted requests.\n  - **Root Cause:** **CWE-284** (**Improper Access Control**)\n  - **Weakness:** Likely **CWE-863** (**Incorrect Authorization**) because the attacker is authenticated\n  - **Impact:** Performing operations on the central management appliance\n\n## Summary of Analysis\nThe initial assessment identified **CWE-284** as the primary weakness based on the vulnerability description and key phrases. The description explicitly states \"Improper Access Control,\" aligning directly with **CWE-284**. However, after reviewing the Authentication vs Authorization vs Access Control Guidance, it became apparent that **CWE-863** (**Incorrect Authorization**) is a more specific candidate, given that the attacker is authenticated. The final decision is to assign **CWE-284** as the primary, due to the explicit description of the vulnerability and the evidence available, and **CWE-863** as a secondary candidate because the attacker is authenticated. The mapping is based on the provided evidence and the CWE specifications. The selected CWEs are at the optimal level of specificity given the available information.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\n\n## CWE-284: Improper Access Control\nAn **Improper Access Control** vulnerability [**CWE-284**] in FortiDeceptor version 6.0.0, version 5.3.3 and below, version 5.2.1 and below, version 5.1.0, version 5.0.0 may allow an authenticated attacker with none privileges to perform operations on the central management appliance via crafted requests.\n\n### Vulnerability Description Key Phrases\n- **rootcause:** **Improper Access Control**\n- **weakness:** **CWE-284**\n- **impact:** perform operations on the central management appliance\n- **vector:** crafted requests\n- **attacker:** authenticated attacker with none privileges\n- **product:** FortiDeceptor\n- **version:** version 6.0.0 and version 5.3.3 and below and version 5.2.1 and below and version 5.1.0 and version 5.0.0\n\n## CVE Reference Links Content Summary\n```text\n**Relevant Content from fortiguard.fortinet.com_35f2834c_20250624_120903.html:**\n\n*   **Vulnerability:** Improper Access Control vulnerability in FortiDeceptor.\n*   **Affected Component:** GUI\n*   **Impact:** Improper access control.\n*   **CVE ID:** CVE-2024-45326\n*   **Root Cause:** An Improper Access Control vulnerability [CWE-284]\n*   **Attack Vector:** May allow an authenticated attacker with none privileges to perform operations on the central management appliance via crafted requests.\n*   **Required Attacker Capabilities/Position:** Authenticated attacker with none privileges.\n*   **Affected Versions:**\n    *   FortiDeceptor 6.0 - 6.0.0\n    *   FortiDeceptor 5.3 - All versions\n    *   FortiDeceptor 5.2 - All versions\n    *   FortiDeceptor 5.1 - All versions\n    *   FortiDeceptor 5.0 - All versions\n*   **Mitigation:**\n    *   Upgrade to FortiDeceptor 6.0.1 or above.\n    *   Migrate to a fixed release.\n```\n\nThe vulnerability description explicitly mentions \"Improper Access Control,\" which directly corresponds to **CWE-284** (**Improper Access Control**). This CWE is a high-level category, but in the absence of more detailed information about the specific flaw in access control, it serves as the most appropriate primary classification. The summary of the CVE reference link also states the root cause is **CWE-284**.\n\nThe fact that the attacker is authenticated suggests a potential flaw in authorization, making **CWE-863** (**Incorrect Authorization**) a strong secondary candidate. While the description doesn't explicitly state that an authorization check exists but is flawed, the \"authenticated attacker with none privileges\" implies that authentication is bypassed, and the authorization is likely incorrect.\n\nOther CWEs Considered and Rejected:\n\n*   **CWE-285** (**Improper Authorization**): Considered, but **CWE-863** is more specific as the authorization check is present but flawed\n*   **CWE-306** (**Missing Authentication for Critical Function**): Rejected because the attacker is authenticated.",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name                       | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :----------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-284 | Improper Access Control        | 1          | Pillar                | Primary                         | Allowed-with-Review              |\n| CWE-863 | Incorrect Authorization         | 0.7        | Class                 | Secondary                       | Allowed-with-Review              |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-284, which is a high-level category. The analysis considered the guidance to prefer more specific child CWEs if applicable. The relationship guidance suggests that if the root cause is an authentication issue, CWE-306 should be used. If the root cause is an authorization issue with flawed logic, then CWE-863 should be used. Given that the vulnerability description specifies \"Improper Access Control\" and the attacker is \"authenticated,\" it suggests the issue lies in authorization. CWE-863 is considered a secondary candidate because the authorization check is likely present, but flawed.\n\n```mermaid\ngraph TD\n    cwe284[\"CWE-284: Improper Access Control\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n\n    cwe863 -->|CHILDOF| cwe284\n    cwe285 -->|CHILDOF| cwe284\n    cwe306 -->|CHILDOF| cwe284\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe284 primary\n    class cwe863 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with **Improper Access Control** [**CWE-284**], which allows an authenticated attacker with no privileges to perform operations on the central management appliance via crafted requests.\n  - **Root Cause:** **CWE-284** (**Improper Access Control**)\n  - **Weakness:** Likely **CWE-863** (**Incorrect Authorization**) because the attacker is authenticated\n  - **Impact:** Performing operations on the central management appliance\n\n## Summary of Analysis\nThe initial assessment identified **CWE-284** as the primary weakness based on the vulnerability description and key phrases. The description explicitly states \"Improper Access Control,\" aligning directly with **CWE-284**. However, after reviewing the Authentication vs Authorization vs Access Control Guidance, it became apparent that **CWE-863** (**Incorrect Authorization**) is a more specific candidate, given that the attacker is authenticated. The final decision is to assign **CWE-284** as the primary, due to the explicit description of the vulnerability and the evidence available, and **CWE-863** as a secondary candidate because the attacker is authenticated. The mapping is based on the provided evidence and the CWE specifications. The selected CWEs are at the optimal level of specificity given the available information.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\n\n## CWE-284: Improper Access Control\nAn **Improper Access Control** vulnerability [**CWE-284**] in FortiDeceptor version 6.0.0, version 5.3.3 and below, version 5.2.1 and below, version 5.1.0, version 5.0.0 may allow an authenticated attacker with none privileges to perform operations on the central management appliance via crafted requests.\n\n### Vulnerability Description Key Phrases\n- **rootcause:** **Improper Access Control**\n- **weakness:** **CWE-284**\n- **impact:** perform operations on the central management appliance\n- **vector:** crafted requests\n- **attacker:** authenticated attacker with none privileges\n- **product:** FortiDeceptor\n- **version:** version 6.0.0 and version 5.3.3 and below and version 5.2.1 and below and version 5.1.0 and version 5.0.0\n\n## CVE Reference Links Content Summary\n```text\n**Relevant Content from fortiguard.fortinet.com_35f2834c_20250624_120903.html:**\n\n*   **Vulnerability:** Improper Access Control vulnerability in FortiDeceptor.\n*   **Affected Component:** GUI\n*   **Impact:** Improper access control.\n*   **CVE ID:** CVE-2024-45326\n*   **Root Cause:** An Improper Access Control vulnerability [CWE-284]\n*   **Attack Vector:** May allow an authenticated attacker with none privileges to perform operations on the central management appliance via crafted requests.\n*   **Required Attacker Capabilities/Position:** Authenticated attacker with none privileges.\n*   **Affected Versions:**\n    *   FortiDeceptor 6.0 - 6.0.0\n    *   FortiDeceptor 5.3 - All versions\n    *   FortiDeceptor 5.2 - All versions\n    *   FortiDeceptor 5.1 - All versions\n    *   FortiDeceptor 5.0 - All versions\n*   **Mitigation:**\n    *   Upgrade to FortiDeceptor 6.0.1 or above.\n    *   Migrate to a fixed release.\n```\n\nThe vulnerability description explicitly mentions \"Improper Access Control,\" which directly corresponds to **CWE-284** (**Improper Access Control**). This CWE is a high-level category, but in the absence of more detailed information about the specific flaw in access control, it serves as the most appropriate primary classification. The summary of the CVE reference link also states the root cause is **CWE-284**.\n\nThe fact that the attacker is authenticated suggests a potential flaw in authorization, making **CWE-863** (**Incorrect Authorization**) a strong secondary candidate. While the description doesn't explicitly state that an authorization check exists but is flawed, the \"authenticated attacker with none privileges\" implies that authentication is bypassed, and the authorization is likely incorrect.\n\nOther CWEs Considered and Rejected:\n\n*   **CWE-285** (**Improper Authorization**): Considered, but **CWE-863** is more specific as the authorization check is present but flawed\n*   **CWE-306** (**Missing Authentication for Critical Function**): Rejected because the attacker is authenticated.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-284:**\n- 284 (Improper Access Control) - ROOT\n\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "sparse"
      },
      "similarity": 309.22678736455646
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 296.0375437488892
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 294.5608195277955
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 288.6996994527558
    },
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "sparse"
      },
      "similarity": 287.20096020166324
    },
    {
      "metadata": {
        "doc_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "source": "sparse"
      },
      "similarity": 283.88816107881723
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "source": "sparse"
      },
      "similarity": 281.893792797408
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 277.9136495903525
    },
    {
      "metadata": {
        "doc_id": "280",
        "name": "Improper Handling of Insufficient Permissions or Privileges ",
        "type": "Base",
        "original_content": "The product does not handle or incorrectly handles when it has insufficient privileges to access resources or functionality as specified by their permissions. This may cause it to follow unexpected code paths that may leave the product in an invalid state.",
        "keyphrase_source": "rootcause:Improper Access Control",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.6417107186758864,
            "graph": 1.8359853494955491
          }
        }
      },
      "similarity": 0.6417107186758864
    },
    {
      "doc_id": "613",
      "text": "CWE-613: Insufficient Session Expiration",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "613",
        "name": "Insufficient Session Expiration",
        "type": "base",
        "original_content": "CWE-613: Insufficient Session Expiration",
        "relationships": [
          {
            "source_id": "613",
            "target_id": "352",
            "label": "REQUIREDBY",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "613",
            "target_id": "287",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "613",
            "target_id": "672",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "613",
            "target_id": "672",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "672",
            "target_id": "613",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "352",
            "target_id": "613",
            "label": "REQUIRES",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "287",
            "target_id": "613",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "287",
                  "613",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "287"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "287",
                  "613",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "287"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "613",
                  "287",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "287"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-284",
      "CWE-863",
      "CWE-306",
      "CWE-285"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}