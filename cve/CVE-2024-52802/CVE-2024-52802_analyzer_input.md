# Vulnerability Information: CVE-2024-52802

## Vulnerability Description
RIOT is an operating system for internet of things (IoT) devices. In version 2024.04 and prior, the function `_parse_advertise`, located in `/sys/net/application_layer/dhcpv6/client.c`, has **no minimum header length check** for `dhcpv6_opt_t` after processing `dhcpv6_msg_t`. This omission could lead to an **out-of-bound read**, causing system inconsistency. Additionally, the same lack of a header length check is present in the function `_preparse_advertise`, which is called by `_parse_advertise` before handling the request. As of time of publication, no known patched version exists.

### Vulnerability Description Key Phrases
- **rootcause:** **no minimum header length check**
- **weakness:** **out-of-bound read**
- **impact:** system inconsistency
- **product:** RIOT
- **version:** 2024.04 and prior
- **component:** _parse_advertise and _preparse_advertise

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability lies in the absence of minimum header length checks for `dhcpv6_opt_t` within the `_parse_advertise` and `_preparse_advertise` functions in `/sys/net/application_layer/dhcpv6/client.c` after processing a `dhcpv6_msg_t`.
- **Weaknesses/vulnerabilities present**:
    - Out-of-bounds read vulnerability due to lack of length validation on DHCPv6 options.
    - Insufficient input validation, specifically missing header length checks after `dhcpv6_msg_t` processing.
    - Use of potentially unsafe operations, like accessing `opt->type` without ensuring adequate remaining data.
- **Impact of exploitation**: An out-of-bounds read can lead to system instability and inconsistency. It can cause a denial of service or allow for further exploitation.
- **Attack vectors**: Network. The vulnerability can be triggered by sending crafted DHCPv6 messages.
- **Required attacker capabilities/position**: The attacker needs to be able to send a malicious DHCPv6 message to the vulnerable system. No special privileges are needed on the target system.

The provided content gives more details than the initial CVE description which was a placeholder.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.521 |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.471 |
| 3 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.461 |
| 4 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.448 |
| 5 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | sparse | 0.440 |
| 6 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.435 |
| 7 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.433 |
| 8 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.428 |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | dense | 0.473 |
| 10 | 170 | Improper Null Termination | Base | Allowed | graph | 0.003 |

