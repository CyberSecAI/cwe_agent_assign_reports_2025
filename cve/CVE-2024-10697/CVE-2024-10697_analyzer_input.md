# Vulnerability Information: CVE-2024-10697

## Vulnerability Description
A vulnerability has been found in Tenda AC6 15.03.05.19 and classified as critical. Affected by this vulnerability is the function formWriteFacMac of the file /goform/WriteFacMac of the component API Endpoint. The manipulation of the argument The leads to **command injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Tenda AC6
- **version:** 15.03.05.19
- **component:** /goform/WriteFacMac

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability stems from the `formWriteFacMac` function, which concatenates user-supplied input (specifically the `mac` parameter) directly into a system command without proper sanitization or validation.

**Weaknesses/Vulnerabilities:**
- **Command Injection:** The lack of input sanitization allows an attacker to inject arbitrary system commands by manipulating the `mac` parameter. The provided images show successful execution of commands like `touch /tmp/pwned`.
- **Unsafe String Concatenation:**  The code directly concatenates the attacker-controlled input into a shell command string.

**Impact of Exploitation:**
- **Remote Code Execution (RCE):** Successful exploitation allows the attacker to execute arbitrary system commands on the affected device.
- **Device Compromise:** This could lead to full device compromise, allowing the attacker to manipulate the device's settings, steal data, or use it for malicious purposes.

**Attack Vectors:**
- **Web Interface:** The vulnerability is exploited through the web interface of the device, likely through a GET request to an API endpoint called `WriteFacMac`.
- **`mac` parameter:** The attacker controls the `mac` parameter in the API request.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs network access to the device's web interface. This implies the attacker could be on the same local network as the device, or, if the web interface is exposed to the internet, they could be remote.
- **Understanding of API:** The attacker needs knowledge of the `WriteFacMac` API endpoint and its parameters.

**Additional Notes:**
- The provided information is more detailed than the typical CVE description. The specific vulnerable function name (`formWriteFacMac`), the vulnerable parameter (`mac`), and the vulnerable endpoint (`WriteFacMac`) are identified.
- The screenshots in the provided content shows a GET request, which further clarifies the attack vector.
- The command injection example given is `touch /tmp/pwned`, which indicates that any command can be executed through this injection.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.474 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.441 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.391 |
| 6 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.381 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.377 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.368 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.597 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

