# Vulnerability Information: CVE-2024-36679

## Vulnerability Description
In the module Module Live Chat Pro (All in One Messaging) (livechatpro) <=8.4.0, a guest can perform **PHP Code injection**. Due to a **predictable token**, the method `LcpsaveTranslations()` suffer of a white writer that can inject PHP code into a PHP file.

### Vulnerability Description Key Phrases
- **rootcause:** **predictable token**
- **weakness:** **PHP Code injection**
- **impact:** PHP code injection
- **attacker:** guest
- **product:** Module Live Chat Pro (All in One Messaging) (livechatpro)
- **version:** <=8.4.0
- **component:** LcpsaveTranslations() method

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

*   **Root Cause:** The vulnerability stems from a predictable token used in the `Lcp::saveTranslations()` method of the "Module Live Chat Pro (All in One Messaging)" module. This allows for a "white writer" (unspecified but likely referring to an attacker) to inject PHP code into a PHP file.
*   **Weaknesses/Vulnerabilities:**
    *   **Improper Control of Code Generation:** The core issue is that the module's code generation process does not properly validate or sanitize input, allowing for arbitrary PHP code to be injected. This is a classic case of CWE-94 (Improper Control of Generation of Code).
    *   **Predictable Token:** The use of a predictable token is the specific weakness that allows exploitation. This likely means the token is not sufficiently random or is derived from publicly known information, making it easy for an attacker to forge.
*   **Impact of Exploitation:**
    *   **Remote Code Execution (RCE):** Successful exploitation allows for arbitrary PHP code execution on the server, potentially leading to complete system takeover.
    *   **Data Manipulation/Removal:** Attackers could remove data from the PrestaShop installation or manipulate existing data.
    *   **Admin Access:** Attackers could gain administrative access to the PrestaShop instance.
*   **Attack Vectors:**
    *   **Network:** The attack vector is over the network.
*   **Required Attacker Capabilities/Position:**
    *   **No Privileges Required:** The vulnerability can be exploited without requiring any prior authentication or privileges on the system.
    *   **No User Interaction:** No user interaction is required for exploitation. The attack can be performed completely remotely and autonomously.

**Additional Details:**

*   The advisory indicates that the module's author refused to patch the vulnerability, suggesting a fundamental design flaw.
*   Although the advisory is based on a Proof of Concept (POC) for version 8.4.0, it warns that newer versions are also likely affected due to the continued use of a predictable token.
*   The provided CVSS score is 10.0, indicating a critical vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.264 |
| 2 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.260 |
| 3 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.259 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.255 |
| 5 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.253 |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.252 |
| 7 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.251 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.246 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.501 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

