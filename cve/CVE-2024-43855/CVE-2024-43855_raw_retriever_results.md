# Raw Retriever Results for CVE-2024-43855

# Raw Retriever Results for CVE-2024-43855
## Query
In the Linux kernel, the following vulnerability has been resolved md fix deadlock between mddev_suspend and flush bio Deadlock occurs when mddev is being suspended while some flush bio is in progress. It is a complex issue. T1. the first flush is at the ending stage, it clears mddev->flush_bio and tries to submit data, but is blocked because mddev is suspended by T4. T2. the second flush sets mddev->flush_bio, and attempts to queue md_submit_flush_data(), which is already running (T1) and wont execute again if on the same CPU as T1. T3. the third flush inc active_io and tries to flush, but is blocked because mddev->flush_bio is not NULL (set by T2). T4. mddev_suspend() is called and waits for active_io dec to 0 which is inc by T3. T1T2T3T4 (flush 1)(flush 2)(third 3)(suspend) md_submit_flush_data mddev->flush_bio = NULL . . md_flush_request . mddev->flush_bio = bio . queue submit_flushes . . . .md_handle_request . . active_io + 1 . . md_flush_request . . wait !mddev->flush_bio . . . .mddev_suspend . . wait !active_io . . . submit_flushes . queue_work md_submit_flush_data . //md_submit_flush_data is already running (T1) . md_handle_request wait resume The root issue is non-atomic inc/dec of active_io during flush process. active_io is dec before md_submit_flush_data is queued, and inc soon after md_submit_flush_data() run. md_flush_request active_io + 1 sub

## Keyphrases
- **rootcause**: 'non-atomic inc', 'dec of active_io during flush process'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3766 | 0.4752 | 0.3988 | 0.3934 | 20 |
| Sparse | 693.9824 | 820.4760 | 726.6521 | 713.9901 | 10 |
| Graph | 1.0062 | 3.0550 | 1.4948 | 1.4870 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 3.0550 | Allowed |
| 2 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 3 | 427 | Uncontrolled Search Path Element | base | 2.1190 | Allowed |
| 4 | 833 | Deadlock | Base | 1.6924 | Allowed |
| 5 | 413 | Improper Resource Locking | Base | 1.6660 | Allowed |
| 6 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 1.5809 | Allowed |
| 7 | 1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | Base | 1.5758 | Allowed |
| 8 | 426 | Untrusted Search Path | base | 1.5210 | Allowed |
| 9 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.5210 | Allowed |
| 10 | 1037 | Processor Optimization Removal or Modification of Security-critical Code | base | 1.5210 | Allowed |
| 11 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 1.4531 | Allowed |
| 12 | 412 | Unrestricted Externally Accessible Lock | base | 1.1466 | Allowed |
| 13 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.0584 | Allowed |
| 14 | 486 | Comparison of Classes by Name | variant | 1.0584 | Allowed |
| 15 | 667 | Improper Locking | Class | 1.0321 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.4752 | 0.4752 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.4158 | 0.4158 | Allowed-with-Review |
| 3 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 0.4138 | 0.4138 | Allowed |
| 4 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4108 | 0.4108 | Allowed |
| 5 | 413 | Improper Resource Locking | Base | 0.4102 | 0.4102 | Allowed |
| 6 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4064 | 0.4064 | Allowed |
| 7 | 909 | Missing Initialization of Resource | Class | 0.4062 | 0.4062 | Allowed-with-Review |
| 8 | 765 | Multiple Unlocks of a Critical Resource | Base | 0.4032 | 0.4032 | Allowed |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4009 | 0.4009 | Allowed |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.3980 | 0.3980 | Allowed-with-Review |
| 11 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.3887 | 0.3887 | Allowed |
| 12 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.3887 | 0.3887 | Allowed |
| 13 | 1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | Base | 0.3871 | 0.3871 | Allowed |
| 14 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | 0.3856 | 0.3856 | Allowed |
| 15 | 764 | Multiple Locks of a Critical Resource | Base | 0.3833 | 0.3833 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 820.4760 | 820.4760 | Allowed-with-Review |
| 2 | 1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | 758.3381 | 758.3381 | Allowed |
| 3 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 732.8655 | 732.8655 | Allowed |
| 4 | 427 | Uncontrolled Search Path Element | 716.8647 | 716.8647 | Allowed |
| 5 | 833 | Deadlock | 715.5138 | 715.5138 | Allowed |
| 6 | 364 | Signal Handler Race Condition | 712.4664 | 712.4664 | Allowed |
| 7 | 1390 | Weak Authentication | 708.7374 | 708.7374 | Allowed-with-Review |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | 703.7734 | 703.7734 | Allowed-with-Review |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | 703.5029 | 703.5029 | Allowed |
| 10 | 59 | Improper Link Resolution Before File Access ('Link Following') | 693.9824 | 693.9824 | Allowed |
