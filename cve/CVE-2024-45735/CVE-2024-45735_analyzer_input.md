# Vulnerability Information: CVE-2024-45735

## Vulnerability Description
In Splunk Enterprise versions below 9.2.3 and 9.1.6, and Splunk Secure Gateway versions on Splunk Cloud Platform versions below 3.4.259, 3.6.17, and 3.7.0, a low-privileged user that does not hold the admin or power Splunk roles can see App Key Value Store (KV Store) deployment configuration and public/private keys in the Splunk Secure Gateway App.

### Vulnerability Description Key Phrases
- **impact:** see App Key Value Store deployment configuration and public/private keys
- **attacker:** low-privileged user
- **product:** Splunk Enterprise and Splunk Secure Gateway App
- **version:** Splunk Enterprise below 9.2.3 and 9.1.6 and Splunk Secure Gateway on Splunk Cloud Platform below 3.4.259, 3.6.17, and 3.7.0

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   Improper Access Control: Low-privileged users, without "admin" or "power" roles in Splunk, can access sensitive information.

**Weaknesses/Vulnerabilities:**

*   **Insufficient Privilege Checks:** The Splunk Secure Gateway App lacks proper access controls, allowing low-privileged users to view sensitive data.
*   **Information Exposure:** The vulnerability exposes App Key Value Store (KV Store) deployment configurations and public/private keys.

**Impact of Exploitation:**

*   **Information Disclosure:** Attackers can potentially gain access to sensitive configuration data and cryptographic keys, leading to further attacks.
*   **Loss of Confidentiality:**  Exposure of private keys and configuration information can compromise the security of the Splunk environment.

**Attack Vectors:**

*   **Network Access:** The vulnerability is accessible over the network.
*   **Low-Privileged User Access:** Exploitation requires only a low-privileged user account.

**Required Attacker Capabilities/Position:**

*   **Splunk User Account:** The attacker needs a valid, low-privileged user account on the affected Splunk instance.
*   **Network Access:** The attacker must have network access to the Splunk instance.

**Additional Details:**

*   **Affected Components:** Splunk Enterprise and Splunk Secure Gateway App.
*   **Specific Information Exposed:** The vulnerability exposes "App Key Value Store (KV Store) deployment configuration and public/private keys".
*   **Detection:** Splunk provides a detection query that can be used to identify potential exploitation attempts.
*   **Mitigation:** Upgrade to the fixed versions, or if the functionality is not used, the app can be removed or disabled.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.123 |
| 2 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.117 |
| 3 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.117 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.114 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.114 |
| 6 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.110 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.109 |
| 8 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.109 |
| 9 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | dense | 0.415 |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | Allowed | graph | 0.002 |

