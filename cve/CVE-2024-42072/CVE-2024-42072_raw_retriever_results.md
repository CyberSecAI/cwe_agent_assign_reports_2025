# Raw Retriever Results for CVE-2024-42072

# Raw Retriever Results for CVE-2024-42072
## Query
In the Linux kernel, the following vulnerability has been resolved bpf Fix may_goto with negative offset. Zacs syzbot crafted a bpf prog that exposed two bugs in may_goto. The 1st bug is the way may_goto is patched. When offset is negative it should be patched differently. The 2nd bug is in the verifier when current state may_goto_depth is equal to visited state may_goto_depth it means there is an actual infinite loop. Its not correct to prune exploration of the program at this point. Note, that this check doesnt limit the program to only one may_goto insn, since 2nd and any further may_goto will increment may_goto_depth only in the queued state pushed for future exploration. The current state will have may_goto_depth == 0 regardless of number of may_goto insns and the verifier has to explore the program until bpf_exit.

## Keyphrases
- **rootcause**: 'incorrect use of negative offset in may_goto'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4707 | 0.5446 | 0.4909 | 0.4874 | 20 |
| Sparse | 204.7066 | 710.8986 | 587.6002 | 652.8691 | 12 |
| Graph | 1.5350 | 2.9286 | 1.9482 | 1.8040 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.9286 | Allowed |
| 2 | 129 | Improper Validation of Array Index | variant | 2.6784 | Allowed |
| 3 | 823 | Use of Out-of-range Pointer Offset | Base | 2.3180 | Allowed |
| 4 | 252 | Unchecked Return Value | Base | 2.2665 | Allowed |
| 5 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2594 | Allowed-with-Review |
| 6 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 7 | 787 | Out-of-bounds Write | base | 2.2100 | Allowed |
| 8 | 195 | Signed to Unsigned Conversion Error | variant | 2.0650 | Allowed |
| 9 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 10 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 1.8394 | Allowed |
| 11 | 197 | Numeric Truncation Error | Base | 1.7687 | Allowed |
| 12 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 13 | 825 | Expired Pointer Dereference | base | 1.6848 | Allowed |
| 14 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6611 | Allowed |
| 15 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 1.6046 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 823 | Use of Out-of-range Pointer Offset | Base | 0.5446 | 0.5446 | Allowed |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5289 | 0.5289 | Allowed |
| 3 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5140 | 0.5140 | Allowed |
| 4 | 126 | Buffer Over-read | Variant | 0.5034 | 0.5034 | Allowed |
| 5 | 252 | Unchecked Return Value | Base | 0.4973 | 0.4973 | Allowed |
| 6 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4966 | 0.4966 | Allowed |
| 7 | 909 | Missing Initialization of Resource | Class | 0.4943 | 0.4943 | Allowed-with-Review |
| 8 | 476 | NULL Pointer Dereference | Base | 0.4939 | 0.4939 | Allowed |
| 9 | 822 | Untrusted Pointer Dereference | Base | 0.4905 | 0.4905 | Allowed |
| 10 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4885 | 0.4885 | Allowed |
| 11 | 733 | Compiler Optimization Removal or Modification of Security-critical Code | Base | 0.4863 | 0.4863 | Allowed |
| 12 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4833 | 0.4833 | Allowed |
| 13 | 606 | Unchecked Input for Loop Condition | Base | 0.4794 | 0.4794 | Allowed |
| 14 | 667 | Improper Locking | Class | 0.4762 | 0.4762 | Allowed-with-Review |
| 15 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4760 | 0.4760 | Allowed-with-Review |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 197 | Numeric Truncation Error | 710.8986 | 710.8986 | Allowed |
| 2 | 823 | Use of Out-of-range Pointer Offset | 700.1697 | 700.1697 | Allowed |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | 666.8210 | 666.8210 | Allowed |
| 4 | 191 | Integer Underflow (Wrap or Wraparound) | 666.8092 | 666.8092 | Allowed |
| 5 | 1390 | Weak Authentication | 660.8806 | 660.8806 | Allowed-with-Review |
| 6 | 125 | Out-of-bounds Read | 656.4206 | 656.4206 | Allowed |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | 649.3176 | 649.3176 | Allowed |
| 8 | 863 | Incorrect Authorization | 648.9258 | 648.9258 | Allowed-with-Review |
| 9 | 787 | Out-of-bounds Write | 641.7448 | 641.7448 | Allowed |
| 10 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | 639.4743 | 639.4743 | Allowed |
| 11 | 789 | Memory Allocation with Excessive Size Value | 205.0337 | 205.0337 | Allowed |
| 12 | 674 | Uncontrolled Recursion | 204.7066 | 204.7066 | Allowed-with-Review |
