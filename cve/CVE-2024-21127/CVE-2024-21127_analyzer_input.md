# Vulnerability Information: CVE-2024-21127

## Vulnerability Description
Vulnerability in the MySQL Server product of Oracle MySQL (component Server DDL). Supported versions that are affected are 8.0.37 and prior and 8.4.0 and prior. Easily exploitable vulnerability allows high privileged attacker with network access via multiple protocols to compromise MySQL Server. Successful attacks of this vulnerability can result in unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of MySQL Server. CVSS 3.1 Base Score 4.9 (Availability impacts). CVSS Vector (CVSS3.1/AVN/ACL/PRH/UIN/SU/CN/IN/AH).

### Vulnerability Description Key Phrases
- **impact:** cause a hang or frequently repeatable crash and hang or frequently repeatable crash (complete DOS)
- **vector:** multiple protocols
- **attacker:** high privileged attacker with network access
- **product:** MySQL Server
- **version:** 8.0.37 and prior and 8.4.0 and prior
- **component:** Server DDL

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-NVD-noinfo

#### Top CWEs
- CWE-NVD-noinfo (Count: 1868)
- CWE-191 (Count: 2)

## CVE Reference Links Content Summary
The provided document is a Critical Patch Update Advisory from Oracle for July 2024. It includes a risk matrix for various products, outlining vulnerabilities addressed by the included patches. Here's the breakdown for **CVE-2024-21127**, as described within the document:

**1. Verification of CVE Relevance:**
The document directly mentions CVE-2024-21127 in the "Oracle MySQL Risk Matrix" section. Therefore, the content is relevant to this CVE.

**2. Vulnerability Details:**
   - **Root Cause:** The vulnerability lies within the "Server: DDL" component of the MySQL Server.
   - **Weakness:** The document indicates a "DDL" issue, implying a weakness in how Data Definition Language operations are handled.
   - **Impact:** The vulnerability has a CVSS base score of 4.9. It could lead to a loss of availability (High), but doesn't affect confidentiality or integrity.
   - **Attack Vector:** The attack vector is over the network.
   - **Attacker Capabilities:** An attacker needs to be on the network, but does not need credentials (No Authentication) to exploit the vulnerability. It requires a low level of attack complexity.

**3. Technical Details:**

   - **Component:** MySQL Server, specifically the "Server: DDL" component.
   - **Protocol:** MySQL Protocol.
   - **Remote Exploit without Auth.?** No (requires some level of access)
   - **CVSS v3.1 Risk:** Base Score: 4.9, Network, Low Attack Complexity, No Privs Required, No User Interaction, Unchanged Scope, Confidentiality None, Integrity None, Availability High

**4. Affected Versions:**

    - MySQL Server versions 8.0.37 and prior, 8.4.0 and prior.

**5. Additional Notes:**

   - The risk matrix indicates that the vulnerability affects "InnoDB" and "Server: DDL", "Server: FTS", "Server: Optimizer", "Server: Pluggable Auth", "Server: Security: Privileges" and "Server: Connection Handling" and not only DDL, which provides a better understanding of vulnerable areas of code.
   - It's a non-remotely exploitable without authentication issue meaning it cannot be exploited directly over the network without some access but still requires network access.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 173 | Improper Handling of Alternate Encoding | Variant | Allowed | sparse | 0.188 |
| 2 | 129 | Improper Validation of Array Index | Variant | Allowed | sparse | 0.173 |
| 3 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | sparse | 0.146 |
| 4 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.139 |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.134 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.133 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.133 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.132 |
| 9 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | dense | 0.548 |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | graph | 0.003 |

