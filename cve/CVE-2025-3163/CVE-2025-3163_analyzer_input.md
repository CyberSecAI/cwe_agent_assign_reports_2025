# Vulnerability Information: CVE-2025-3163

## Vulnerability Description
A vulnerability was found in InternLM LMDeploy up to 0.7.1. It has been declared as critical. Affected by this vulnerability is the function Open of the file lmdeploy/docs/en/conf.py. The manipulation leads to **code injection**. It is possible to launch the attack on the local host. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **code injection**
- **product:** InternLM LMDeploy
- **version:** up to 0.7.1
- **component:** lmdeploy/docs/en/conf.py

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3163 Content

The provided content **relates** to a potential vulnerability in the `lmdeploy` project. It details a code injection risk due to the unsafe use of `exec` and `compile` functions.

Here's a breakdown of the extracted information:

**Root cause of vulnerability:**

The vulnerability stems from the use of `exec(compile(f.read(), version_file, 'exec'))` to read and execute the contents of `version.py`. This allows arbitrary code execution if an attacker can modify the `version.py` file.

**Weaknesses/vulnerabilities present:**

*   **Unsafe use of `exec` and `compile`:**  These functions allow dynamic code execution, which is inherently risky if the input source is not trusted.
*   **Lack of input validation:** The code does not validate the contents of `version.py` before executing it.
*   **File Inclusion Vulnerability:** The code directly includes and executes a file, opening the door for malicious code injection.

**Impact of exploitation:**

An attacker could:

*   Delete files on the system.
*   Execute unauthorized system commands.
*   Steal sensitive information.

**Attack vectors:**

*   **File modification:** An attacker needs to be able to modify the `version.py` file.

**Required attacker capabilities/position:**

*   The attacker needs write access to the `version.py` file.

**Mitigation or fix:**

The report doesn't explicitly state a fix, but the implication is to avoid using `exec` and `compile` with untrusted input.  Alternatives include:

*   Parsing the `version.py` file and extracting the version information using safer methods.
*   Using a more secure configuration management system.
*   Implementing strict access controls to prevent unauthorized modification of the `version.py` file.

**Additional Details (more detail than official CVE description):**

The report provides specific examples of malicious code that could be injected into `version.py` to demonstrate the potential impact. It also specifies the affected code location (`lmdeploy/docs/en/conf.py` at line 20) and the commit range where the vulnerability exists. The report also states that the vulnerability exists in all versions of the project from Aug 21, 2023 to Jan 21, 2025.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.414 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.398 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.359 |
| 4 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.345 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.344 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.339 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.338 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.336 |
| 9 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | dense | 0.577 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |

