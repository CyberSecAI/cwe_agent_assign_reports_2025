## Vulnerability Description
A vulnerability classified as critical has been found in Guangzhou Tuchuang Computer Software Development Interlib Library Cluster Automation Management System up to 2.0.1. This affects an unknown part of the file /interlib/admin/SysLib?cmdACT=inputLIBCODE&mod=batchXSL&xsl=editLIBCODE.xsl&libcodes=&ROWID=. The manipulation of the argument sql leads to **sql injection**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** Guangzhou Tuchuang Computer Software Development Interlib Library Cluster Automation Management System
- **version:** up to 2.0.1
- **component:** /interlib/admin/SysLib?cmdACT=inputLIBCODE&mod=batchXSL&xsl=editLIBCODE.xsl&libcodes=&ROWID=

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-10946:

**Root Cause of Vulnerability:**

*   The root cause is the lack of proper input sanitization or validation within the `/interlib/admin/SysLib` module of the Interlib Library Cluster Automation Management System V2.0.1. Specifically, the application fails to filter or validate user-supplied SQL statements.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The primary vulnerability is SQL injection. The application directly incorporates user-supplied data into SQL queries without proper sanitization.

**Impact of Exploitation:**

*   **Unauthorized Data Access:** An attacker can exploit this vulnerability to execute arbitrary SQL queries against the database.
*   **Sensitive Information Disclosure:** Successful exploitation allows the attacker to retrieve sensitive information from the database, including but not limited to library configuration information and user data.
*   **Potential Data Manipulation:** While not explicitly stated in this source, SQL injection can potentially lead to data modification or deletion, depending on the database permissions and the attacker's payload.

**Attack Vectors:**

*   **HTTP GET Request:** The vulnerability is triggered via a specially crafted HTTP GET request to the `/interlib/admin/SysLib` endpoint.
*   **Malicious SQL Parameter:** The attacker injects malicious SQL code through the `sql` parameter in the GET request.

**Required Attacker Capabilities/Position:**

*   **Unauthenticated Access:** The vulnerability can be exploited by an unauthenticated attacker, meaning no prior login or special credentials are required to trigger it.
*   **Network Access:** The attacker requires network access to the server hosting the vulnerable application.
*   **Knowledge of the Target System:** Some knowledge of the application's URL structure and the parameter names is needed to craft the malicious request.

**Additional Details:**

*   The provided proof of concept (POC) shows how to inject SQL code into the `sql` parameter. The specific example retrieves data from multiple tables (`p_local`, `p_booktype`, `p_libpara`, `p_rctype`).

In summary, CVE-2024-10946 is a SQL injection vulnerability in the Interlib Library Cluster Automation Management System that allows unauthenticated remote attackers to extract sensitive information from the database via maliciously crafted HTTP requests.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.489 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.407 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.403 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.400 |
| 6 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.390 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.389 |
| 8 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.388 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.620 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-306: Missing Authentication for Critical Function

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-266: Incorrect Privilege Assignment

CWE-502: Deserialization of Untrusted Data

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-73: External Control of File Name or Path