# Vulnerability Information: CVE-2025-4253

## Vulnerability Description
A vulnerability was found in PCMan FTP Server 2.0.7. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the component HASH Command Handler. The manipulation leads to **buffer overflow**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** HASH Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-4253 Content

Based on the provided content, this relates to a vulnerability in PCMan FTP Server version 2.0.7.

**Root cause of vulnerability:**

The vulnerability is a remote buffer overflow in the `hash` command of PCMan FTP Server 2.0.7.

**Weaknesses/vulnerabilities present:**

*   **Buffer Overflow:** The `hash` command does not properly validate the length of the input, allowing an attacker to send a buffer larger than the allocated memory, overwriting adjacent memory regions.

**Impact of exploitation:**

Successful exploitation allows an attacker to potentially execute arbitrary code on the target system. The exploit author demonstrates achieving this by overwriting the instruction pointer (EIP) with the address of a JMP ESP instruction (0x74e32fd9).

**Attack vectors:**

*   **Remote:** The vulnerability is exploitable remotely via the FTP protocol.
*   **FTP `HASH` command:** The attacker sends a specially crafted string to the `hash` command.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the target FTP server on port 21.
*   **FTP Client:** The attacker needs an FTP client to connect to the server and send the malicious command.
*   **Knowledge of Offset:** The attacker needs to know the correct offset (2006 bytes in this case) to overwrite the EIP.

**Mitigation or fix:**

The content does not provide information about a specific fix. However, the vulnerability can be mitigated by:

*   **Input Validation:** Implementing proper input validation and bounds checking on the `hash` command to prevent buffer overflows.
*   **Update:** Updating to a patched version of PCMan FTP Server (if available).

**Additional Details:**

*   The exploit uses `msfvenom` to generate a shellcode payload.
*   The exploit author tested the vulnerability on Windows XP SP3.
*   The exploit uses a Perl script to automate the attack.
*   The exploit avoids using bad characters (\x00, \x0a, \x0d) in the payload.
*   The content provides more detail than a typical CVE description, including the exact offset, EIP address, and a working exploit script.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.395 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.373 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.333 |
| 7 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.320 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.319 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.579 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

