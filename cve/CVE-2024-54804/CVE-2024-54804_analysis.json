{
  "cve_id": "CVE-2024-54804",
  "description": "Netgear WNR854T 1.5.2 (North America) is vulnerable to **Command Injection**. An attacker can send a specially crafted request to post.cgi, updating the nvram parameter wan_hostname and forcing a reboot. This will result in command injection.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "Command Injection",
    "impact": "",
    "vector": "specially crafted request",
    "attacker": "",
    "product": "Netgear WNR854T",
    "version": "1.5.2",
    "component": "post.cgi"
  },
  "reference_content": "CVE-2024-54804\n\n**Root cause of vulnerability:**\nThe vulnerability is an authenticated command injection affecting the router\u2019s WAN hostname configuration. It exists within the sysinit binary (`/bin/sysinit`) which processes the `wan_hostname` NVRAM parameter during system initialization. The root cause is the absence of input validation or sanitization for the `wan_hostname` parameter when constructing a shell command.\n\n**Weaknesses/vulnerabilities present:**\n- Command Injection\n- Lack of input validation/sanitization\n\n**Impact of exploitation:**\n- Complete compromise of the router\n- Potential for malicious activities like modifying network settings or creating boot loops.\n\n**Attack vectors:**\n- Log into the web administration interface and modify the WAN hostname setting.\n- Send a specially crafted HTTP POST request to the router\u2019s `/post.cgi` endpoint.\n\n**Required attacker capabilities/position:**\n- Authentication to the router\u2019s administrative interface.\n\n**Mitigation or fix:**\nNot specified in the content.\n\n**Additional Details:**\nThe exploit payload format is `wan_hostname=;command_to_execute #`. The semicolon (`;`) terminates the original command, allowing injection of an arbitrary command, while the hash symbol (`#`) comments out any trailing portions of the original command string.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 1.0 | Base | Primary | Allowed |\n| CWE-1287 | Improper Validation of Specified Type of Input | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')**, which is a base-level CWE. CWE-78 is a child of CWE-77 (Class) and CWE-74 (Class) and CWE-138 (Class). **CWE-1287: Improper Validation of Specified Type of Input** is considered as a contributing factor since the **lack of input validation** leads to the command injection. It is a base level CWE.\n\n```mermaid\ngraph TD\n    cwe78[\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\n    cwe77[\"CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')\"]\n    cwe74[\"CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\"]\n    cwe138[\"CWE-138: Improper Neutralization of Special Elements\"]\n    cwe1287[\"CWE-1287: Improper Validation of Specified Type of Input\"]\n\n    cwe78 -->|CHILDOF| cwe77\n    cwe78 -->|CHILDOF| cwe74\n    cwe78 -->|CHILDOF| cwe138\n    cwe1287 -->|PEEROF| cwe78\n    \n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe78 primary\n    class cwe77,cwe74,cwe138, cwe1287 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with the **lack of input validation (CWE-1287)** on the `wan_hostname` parameter. This leads to **CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')**, where an attacker can inject arbitrary commands into the system by exploiting the absence of proper sanitization. The final impact is complete compromise of the router.\n\n## Summary of Analysis\nThe primary CWE is **CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')** because the **lack of input validation** on the `wan_hostname` parameter allows an attacker to inject and execute arbitrary commands. This is supported by the \"CVE Reference Links Content Summary\" which states \"The root cause is the absence of input validation or sanitization for the `wan_hostname` parameter when constructing a shell command.\"\n\n**CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')** was considered, but CWE-78 is more specific since the commands are OS commands. The retriever results listed CWE-77 with the highest score, however, the vulnerability description key phrases list \"Command Injection\" which is a general term. The CVE Reference Links Content Summary describes the vulnerability as affecting the router\u2019s WAN hostname configuration and affecting the sysinit binary, which suggests OS commands are being executed.\n\n**CWE-1287: Improper Validation of Specified Type of Input** was considered as a secondary CWE because the root cause includes the **lack of input validation**.\n\nThe selected CWEs are at the optimal level of specificity because CWE-78 is a Base level CWE, and accurately represents the vulnerability.\n\nRelevant CWE Information:\n- CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')\n- CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\n- CWE-1287: Improper Validation of Specified Type of Input",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 1.0 | Base | Primary | Allowed |\n| CWE-1287 | Improper Validation of Specified Type of Input | 0.7 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')**, which is a base-level CWE. CWE-78 is a child of CWE-77 (Class) and CWE-74 (Class) and CWE-138 (Class). **CWE-1287: Improper Validation of Specified Type of Input** is considered as a contributing factor since the **lack of input validation** leads to the command injection. It is a base level CWE.\n\n```mermaid\ngraph TD\n    cwe78[\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\n    cwe77[\"CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')\"]\n    cwe74[\"CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\"]\n    cwe138[\"CWE-138: Improper Neutralization of Special Elements\"]\n    cwe1287[\"CWE-1287: Improper Validation of Specified Type of Input\"]\n\n    cwe78 -->|CHILDOF| cwe77\n    cwe78 -->|CHILDOF| cwe74\n    cwe78 -->|CHILDOF| cwe138\n    cwe1287 -->|PEEROF| cwe78\n    \n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe78 primary\n    class cwe77,cwe74,cwe138, cwe1287 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with the **lack of input validation (CWE-1287)** on the `wan_hostname` parameter. This leads to **CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')**, where an attacker can inject arbitrary commands into the system by exploiting the absence of proper sanitization. The final impact is complete compromise of the router.\n\n## Summary of Analysis\nThe primary CWE is **CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')** because the **lack of input validation** on the `wan_hostname` parameter allows an attacker to inject and execute arbitrary commands. This is supported by the \"CVE Reference Links Content Summary\" which states \"The root cause is the absence of input validation or sanitization for the `wan_hostname` parameter when constructing a shell command.\"\n\n**CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')** was considered, but CWE-78 is more specific since the commands are OS commands. The retriever results listed CWE-77 with the highest score, however, the vulnerability description key phrases list \"Command Injection\" which is a general term. The CVE Reference Links Content Summary describes the vulnerability as affecting the router\u2019s WAN hostname configuration and affecting the sysinit binary, which suggests OS commands are being executed.\n\n**CWE-1287: Improper Validation of Specified Type of Input** was considered as a secondary CWE because the root cause includes the **lack of input validation**.\n\nThe selected CWEs are at the optimal level of specificity because CWE-78 is a Base level CWE, and accurately represents the vulnerability.\n\nRelevant CWE Information:\n- CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')\n- CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\n- CWE-1287: Improper Validation of Specified Type of Input\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-77:**\n- 77 (Improper Neutralization of Special Elements used in a Command ('Command Injection')) - ROOT\n\n\n**Chain starting from CWE-1287:**\n- 1287 (Improper Validation of Specified Type of Input) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "77",
        "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Command injection",
        "match_reason": "exact_match_whole_phrase"
      },
      "similarity": 1000.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: OS Command Injection",
        "match_reason": "phrase_in_term_whole_phrase"
      },
      "similarity": 700.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "1287",
        "name": "Improper Validation of Specified Type of Input",
        "source": "sparse"
      },
      "similarity": 252.07818418877747
    },
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "source": "sparse"
      },
      "similarity": 244.53647081325255
    },
    {
      "metadata": {
        "doc_id": "790",
        "name": "Improper Filtering of Special Elements",
        "source": "sparse"
      },
      "similarity": 235.5460547519791
    },
    {
      "metadata": {
        "doc_id": "74",
        "name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
        "source": "sparse"
      },
      "similarity": 235.2961969933698
    },
    {
      "metadata": {
        "doc_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "source": "sparse"
      },
      "similarity": 233.31075750851377
    },
    {
      "metadata": {
        "doc_id": "93",
        "name": "Improper Neutralization of CRLF Sequences ('CRLF Injection')",
        "source": "sparse"
      },
      "similarity": 227.69467890947757
    },
    {
      "metadata": {
        "doc_id": "121",
        "name": "Stack-based Buffer Overflow",
        "type": "Variant",
        "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).",
        "keyphrase_source": "weakness:Command Injection",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5594463048129391
          }
        }
      },
      "similarity": 0.5594463048129391
    },
    {
      "doc_id": "184",
      "text": "CWE-184: Incomplete List of Disallowed Inputs",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "184",
        "name": "Incomplete List of Disallowed Inputs",
        "type": "base",
        "original_content": "CWE-184: Incomplete List of Disallowed Inputs",
        "relationships": [
          {
            "source_id": "184",
            "target_id": "692",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "78",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "79",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "1023",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "693",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "86",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "78",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "693",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "STARTSWITH",
            "properties": {
              "view_id": "709"
            }
          },
          {
            "source_id": "625",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "186",
            "target_id": "184",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1023",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "78",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "78"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "78",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "78"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "184",
                  "78",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "78"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-77",
      "CWE-1287",
      "CWE-74",
      "CWE-138",
      "CWE-78"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}