# Vulnerability Information: CVE-2024-57999

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved powerpc/pseries/iommu **IOMMU incorrectly marks MMIO range in DDW** Power Hypervisor can possibily allocate MMIO window intersecting with Dynamic DMA Window (DDW) range, which is over 32-bit addressing. These MMIO pages needs to be marked as reserved so that IOMMU doesnt map DMA buffers in this range. The current code is not marking these pages correctly which is resulting in LPAR to OOPS while booting. The stack is at below BUG Unable to handle kernel data access on read at 0xc00800005cd40000 Faulting instruction address 0xc00000000005cdac Oops Kernel access of bad area, sig 11

### Vulnerability Description Key Phrases
- **rootcause:** **IOMMU incorrectly marks MMIO range in DDW**
- **impact:** LPAR to OOPS
- **product:** Linux kernel
- **component:** powerpc/pseries/iommu IOMMU

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | Allowed | sparse | 0.522 |
| 2 | 662 | Improper Synchronization | Class | Discouraged | sparse | 0.483 |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.468 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.461 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.458 |
| 6 | 194 | Unexpected Sign Extension | Variant | Allowed | sparse | 0.446 |
| 7 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.446 |
| 8 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | sparse | 0.443 |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | Allowed | dense | 0.642 |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | graph | 0.003 |

