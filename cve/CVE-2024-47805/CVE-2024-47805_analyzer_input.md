# Vulnerability Information: CVE-2024-47805

## Vulnerability Description
Jenkins Credentials Plugin 1380.va_435002fa_924 and earlier, except 1371.1373.v4eb_fa_b_7161e9, does not redact encrypted values of credentials using the `SecretBytes` type when accessing item `config.xml` via REST API or CLI.

### Vulnerability Description Key Phrases
- **impact:** redact encrypted values of credentials
- **vector:** accessing item config.xml
- **product:** Jenkins Credentials Plugin
- **version:** 1380.va_435002fa_924 and earlier
- **component:** REST API or CLI

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2024-47805:

**Root Cause of Vulnerability:**
The Credentials Plugin did not redact encrypted values of credentials using the `SecretBytes` type when accessing item `config.xml` via REST API or CLI.

**Weaknesses/Vulnerabilities Present:**
- Exposure of encrypted credentials: The plugin failed to properly redact encrypted `SecretBytes` values when accessed through the REST API or CLI, specifically when retrieving an item's `config.xml`.
- Lack of proper data sanitization or redaction: The plugin didn't sanitize or redact sensitive encrypted credential data before exposing it to users.

**Impact of Exploitation:**
- Information Disclosure: Attackers with Item/Extended Read permission can view the encrypted values of `SecretBytes` type credentials, such as certificate credentials or secret file credentials. This could lead to the compromise of the system/application protected by these credentials.

**Attack Vectors:**
- REST API access: By making API calls to retrieve the `config.xml` of an item.
- CLI access: By using the Jenkins CLI to retrieve the `config.xml` of an item.

**Required Attacker Capabilities/Position:**
- Must have Item/Extended Read permission within Jenkins.
- Must be able to access the Jenkins instance (network access).

**Affected plugin and versions:**
- `credentials` plugin versions up to and including 1380.va\_435002fa\_924, except 1371.1373.v4eb\_fa\_b\_7161e9.

**Fixed plugin version:**
- `credentials` plugin version 1381.v2c3a\_12074da\_b\_

**Additional notes:**
- The fix for this issue is only fully effective on Jenkins 2.479 and newer, or LTS 2.462.3 and newer. While the patched Credentials Plugin can be installed on older Jenkins versions, the encrypted values will not be redacted.
- This issue is similar to an older vulnerability (SECURITY-266) that affected inline secrets and some credential types.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.060 |
| 2 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.060 |
| 3 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.059 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.056 |
| 5 | 549 | Missing Password Field Masking | Base | Allowed | sparse | 0.052 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.051 |
| 7 | 257 | Storing Passwords in a Recoverable Format | Base | Allowed | sparse | 0.047 |
| 8 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | Allowed | sparse | 0.046 |
| 9 | 260 | Password in Configuration File | Base | Allowed | dense | 0.480 |
| 10 | 555 | J2EE Misconfiguration: Plaintext Password in Configuration File | Variant | Allowed | graph | 0.002 |

