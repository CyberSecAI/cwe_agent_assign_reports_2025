# Vulnerability Information: CVE-2024-52981

## Vulnerability Description
An issue was discovered in Elasticsearch, where a **large recursion** using the Well-KnownText formatted string with nested GeometryCollection objects could cause a stackoverflow.

### Vulnerability Description Key Phrases
- **rootcause:** **large recursion**
- **impact:** stack overflow
- **vector:** large recursion using Well-KnownText formatted string with nested GeometryCollection objects
- **product:** Elasticsearch

## CVE Reference Links Content Summary
Root cause of vulnerability:
A large recursion using the Well-KnownText formatted string with nested GeometryCollection objects could cause a stackoverflow.

Weaknesses/vulnerabilities present:
Uncontrolled Resource Consumption, Stackoverflow

Impact of exploitation:
High availability impact (CVSS v3.1: 4.9 (Medium) - CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H/CR:M/IR:M/AR:M)

Attack vectors:
Using Well-KnownText formatted strings with nested GeometryCollection objects.

Required attacker capabilities/position:
High privilege

Mitigation or fix:
Upgrade to version 7.17.24 or higher, or version 8.15.1 or higher.

This content provides more detail than the official CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.184 |
| 2 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.145 |
| 3 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.119 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.115 |
| 5 | 405 | Asymmetric Resource Consumption (Amplification) | Class | Allowed-with-Review | sparse | 0.114 |
| 6 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.111 |
| 7 | 697 | Incorrect Comparison | Pillar | Discouraged | sparse | 0.111 |
| 8 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.111 |
| 9 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | Allowed | dense | 0.462 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |

