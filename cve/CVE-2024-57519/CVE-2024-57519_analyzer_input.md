# Vulnerability Information: CVE-2024-57519

## Vulnerability Description
An issue in Open5GS v.2.7.2 allows a remote attacker to cause a denial of service via the ogs_dbi_auth_info function in lib/dbi/subscription.c file.

### Vulnerability Description Key Phrases
- **impact:** denial of service
- **attacker:** remote attacker
- **product:** Open5GS
- **version:** v.2.7.2
- **component:** ogs_dbi_auth_info function in lib/dbi/subscription.c file

## CVE Reference Links Content Summary
```
Root cause of vulnerability: The vulnerability is caused by the `ogs_dbi_auth_info` function in `lib/dbi/subscription.c` not properly validating the `supi_id` before using it. Specifically, the `ogs_id_get_value` function in `lib/proto/types.c` fails to extract the `supi_id` if the input `ueId` (e.g., "imsiMALFORMED") does not contain a hyphen. This leads to a crash due to an assertion failure.

Weaknesses/vulnerabilities present:
*   Improper Input Validation: The code does not adequately validate the format of the `ueId` (SUPI), leading to unexpected behavior when the format is incorrect.
*   Assertion Failure: The `ogs_dbi_auth_info` function contains an assertion (`ogs_assert(supi_id)`) that fails when `supi_id` is invalid, causing the UDR to crash.

Impact of exploitation: The impact of this vulnerability is a denial of service (DoS) condition. The UDR (User Data Repository) crashes, making it unavailable.

Attack vectors: The attack vector is sending a specially crafted HTTP request to the `/subscription-data` endpoint of the Nudr\_DataRepository API with a malformed `ueId` (SUPI) in the URL.

Required attacker capabilities/position:
*   Network access to the Open5GS core network.
*   Ability to send HTTP requests to the Nudr\_DataRepository API.
*   Knowledge of the API endpoint and the expected data format.

Mitigation or fix: The suggested remediation involves adding appropriate checks within the `ogs_dbi_auth_info` function to ensure that the `supi_id` variable contains a valid value before it is passed to the `ogs_assert(supi_id)` call. The provided patch in commit 08b9e7c addresses this issue by adding checks to validate the SUPI ID.
```

**More detail than the official CVE description:** The provided content gives detailed steps to reproduce the vulnerability, including code examples and log analysis, and suggests a specific fix. It also includes the root cause and attack vectors.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 415 | Double Free | Variant | Allowed | sparse | 0.053 |
| 2 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.053 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.052 |
| 4 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.052 |
| 5 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.051 |
| 6 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.051 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.050 |
| 8 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.050 |
| 9 | 306 | Missing Authentication for Critical Function | Base | Allowed | dense | 0.542 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |

