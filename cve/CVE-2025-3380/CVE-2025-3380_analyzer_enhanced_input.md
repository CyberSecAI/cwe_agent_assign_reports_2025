## Vulnerability Description
A vulnerability, which was classified as critical, has been found in PCMan FTP Server 2.0.7. Affected by this issue is some unknown functionality of the component FEAT Command Handler. The manipulation leads to **buffer overflow**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** FEAT Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3380 Content

This content **RELATES** to a vulnerability in PCMan FTP Server, specifically a remote buffer overflow in the `FEAT` command. It provides a detailed exploit script.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the handling of the `FEAT` command in PCMan FTP Server version 2.0.7. The server does not properly validate the length of the input provided with the `FEAT` command, allowing an attacker to send a payload larger than the allocated buffer.

**Weaknesses/vulnerabilities present:**

*   **Buffer Overflow:** The core vulnerability is a buffer overflow.
*   **Improper Input Validation:** Lack of proper input validation on the `FEAT` command.

**Impact of exploitation:**

Successful exploitation allows an attacker to overwrite the execution flow of the program, potentially leading to arbitrary code execution. The script demonstrates an attempt to redirect execution to a shellcode payload.

**Attack vectors:**

*   **Remote:** The vulnerability is remotely exploitable via the FTP protocol.
*   **Network:** Requires network connectivity to the target FTP server.
*   **`FEAT` Command:** The attack is launched by sending a specially crafted `FEAT` command to the server.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the target FTP server on port 21.
*   **Exploit Knowledge:** The attacker needs knowledge of buffer overflow exploitation techniques and the target architecture (x86 in this case).
*   **Shellcode:** The attacker needs to generate shellcode compatible with the target system.

**Mitigation or fix:**

The content does not explicitly mention a fix. However, the vulnerability can be mitigated by:

*   **Input Validation:** Implementing robust input validation on the `FEAT` command to limit the length of the input string.
*   **Buffer Overflow Protection:** Employing buffer overflow protection mechanisms such as stack canaries or Address Space Layout Randomization (ASLR).
*   **Software Update:** Updating to a patched version of PCMan FTP Server (if available).

**Additional Details (More than official CVE description):**

*   **Specific Version:** The exploit is tested against PCMan FTP Server version 2.0.7.
*   **Offset:** The exploit script uses an offset of 2006 bytes.
*   **EIP Override:** The script attempts to overwrite the EIP register with `0x74e32fd9` (JMP ESP).
*   **Shellcode:** The script includes shellcode generated using `msfvenom` to establish a reverse TCP shell.
*   **Bad Characters:** The shellcode is encoded to avoid bad characters (`\x00\x0a\x0d`).
*   **Exploit Script:** A complete Perl exploit script is provided, demonstrating the steps to connect to the server, authenticate, send the malicious `FEAT` command, and potentially execute shellcode.
*   **Tested OS:** Windows XP SP3.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.387 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.370 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.331 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.316 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.313 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.569 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-125: Out-of-bounds Read

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-121: Stack-based Buffer Overflow

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-128: Wrap-around Error