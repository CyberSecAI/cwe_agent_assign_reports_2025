# Vulnerability Information: CVE-2024-47566

## Vulnerability Description
A **improper limitation of a pathname to a restricted directory (path traversal)** [CWE-23] in Fortinet FortiRecorder version 7.2.0 through 7.2.1 and before 7.0.4 allows a privileged attacker to delete files from the underlying filesystem via crafted CLI requests.

### Vulnerability Description Key Phrases
- **rootcause:** **improper limitation of a pathname to a restricted directory (path traversal)**
- **impact:** delete files from the underlying filesystem
- **vector:** crafted CLI requests
- **attacker:** privileged attacker
- **product:** Fortinet FortiRecorder
- **version:** 7.2.0 through 7.2.1 and before 7.0.4

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
Multiple relative path traversal vulnerabilities [CWE-23] in FortiRecorder may allow a privileged attacker to delete files from the underlying filesystem via crafted CLI requests.

Weaknesses/vulnerabilities present:
- Path Traversal [CWE-23]

Impact of exploitation:
- Delete files from the underlying filesystem
- Execute unauthorized code or commands

Attack vectors:
- Crafted CLI requests

Required attacker capabilities/position:
- Privileged attacker

Mitigation or fix:
- Upgrade to FortiRecorder 7.2.2 or above (for FortiRecorder 7.2)
- Upgrade to FortiRecorder 7.0.5 or above (for FortiRecorder 7.0)
- Migrate to a fixed release (for FortiRecorder 6.4)

More detail than the official CVE description:
- Specifies the affected versions and the corresponding fixes.
- States the severity as Medium.
- Provides the CVSSv3 score as 4.8.
- States the impact as "Execute unauthorized code or commands".
- Specifies the component as "CLI".
- Mentions the IR number: FG-IR-24-401.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.437 |
| 3 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.350 |
| 4 | 24 | Path Traversal: '../filedir' | Variant | Allowed | sparse | 0.349 |
| 5 | 73 | External Control of File Name or Path | Base | Allowed | sparse | 0.348 |
| 6 | 29 | Path Traversal: '\..\filename' | Variant | Allowed | sparse | 0.343 |
| 7 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.333 |
| 8 | 25 | Path Traversal: '/../filedir' | Variant | Allowed | sparse | 0.332 |
| 9 | 28 | Path Traversal: '..\filedir' | Variant | Allowed | dense | 0.615 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.002 |

