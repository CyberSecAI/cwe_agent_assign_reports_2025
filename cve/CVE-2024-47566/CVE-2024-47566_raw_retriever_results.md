# Raw Retriever Results for CVE-2024-47566

# Raw Retriever Results for CVE-2024-47566
## Query
A improper limitation of a pathname to a restricted directory (path traversal) [CWE-23] in Fortinet FortiRecorder version 7.2.0 through 7.2.1 and before 7.0.4 allows a privileged attacker to delete files from the underlying filesystem via crafted CLI requests.

## Keyphrases
- **rootcause**: 'improper limitation of a pathname to a restricted directory (path traversal)'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5536 | 0.6205 | 0.5836 | 0.5825 | 20 |
| Sparse | 79.5138 | 800.0000 | 322.4013 | 332.5571 | 13 |
| Graph | 1.5552 | 2.8553 | 1.8444 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 73 | External Control of File Name or Path | Base | 2.8553 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.8354 | Allowed |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 2.2100 | Allowed |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | base | 2.2100 | Allowed |
| 5 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | base | 1.7680 | Allowed-with-Review |
| 8 | 23 | Relative Path Traversal | Base | 1.7251 | Allowed |
| 9 | 36 | Absolute Path Traversal | Base | 1.7166 | Allowed |
| 10 | 363 | Race Condition Enabling Link Following | base | 1.6848 | Allowed |
| 11 | 184 | Incomplete List of Disallowed Inputs | base | 1.6848 | Allowed |
| 12 | 183 | Permissive List of Allowed Inputs | base | 1.6848 | Allowed |
| 13 | 425 | Direct Request ('Forced Browsing') | base | 1.6848 | Allowed |
| 14 | 20 | Improper Input Validation | class | 1.6736 | Discouraged |
| 15 | 41 | Improper Resolution of Path Equivalence | Base | 1.5641 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 25 | Path Traversal: '/../filedir' | Variant | 0.6205 | 0.6205 | Allowed |
| 2 | 24 | Path Traversal: '../filedir' | Variant | 0.6164 | 0.6164 | Allowed |
| 3 | 28 | Path Traversal: '..\filedir' | Variant | 0.6150 | 0.6150 | Allowed |
| 4 | 31 | Path Traversal: 'dir\..\..\filename' | Variant | 0.6034 | 0.6034 | Allowed |
| 5 | 26 | Path Traversal: '/dir/../filename' | Variant | 0.6029 | 0.6029 | Allowed |
| 6 | 27 | Path Traversal: 'dir/../../filename' | Variant | 0.6023 | 0.6023 | Allowed |
| 7 | 29 | Path Traversal: '\..\filename' | Variant | 0.6000 | 0.6000 | Allowed |
| 8 | 280 | Improper Handling of Insufficient Permissions or Privileges  | Base | 0.5911 | 0.5911 | Allowed |
| 9 | 30 | Path Traversal: '\dir\..\filename' | Variant | 0.5886 | 0.5886 | Allowed |
| 10 | 39 | Path Traversal: 'C:dirname' | Variant | 0.5846 | 0.5846 | Allowed |
| 11 | 73 | External Control of File Name or Path | Base | 0.5804 | 0.5804 | Allowed |
| 12 | 57 | Path Equivalence: 'fakedir/../realdir/filename' | Variant | 0.5772 | 0.5772 | Allowed |
| 13 | 641 | Improper Restriction of Names for Files and Other Resources | Base | 0.5736 | 0.5736 | Allowed |
| 14 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | 0.5686 | 0.5686 | Allowed |
| 15 | 32 | Path Traversal: '...' (Triple Dot) | Variant | 0.5622 | 0.5622 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 800.0000 | 800.0000 | Allowed |
| 2 | 23 | Relative Path Traversal | 436.9811 | 436.9811 | Allowed |
| 3 | 36 | Absolute Path Traversal | 349.8359 | 349.8359 | Allowed |
| 4 | 24 | Path Traversal: '../filedir' | 349.0613 | 349.0613 | Allowed |
| 5 | 73 | External Control of File Name or Path | 348.0609 | 348.0609 | Allowed |
| 6 | 29 | Path Traversal: '\..\filename' | 343.2183 | 343.2183 | Allowed |
| 7 | 59 | Improper Link Resolution Before File Access ('Link Following') | 332.5571 | 332.5571 | Allowed |
| 8 | 25 | Path Traversal: '/../filedir' | 331.9355 | 331.9355 | Allowed |
| 9 | 27 | Path Traversal: 'dir/../../filename' | 328.4906 | 328.4906 | Allowed |
| 10 | 41 | Improper Resolution of Path Equivalence | 328.1961 | 328.1961 | Allowed |
| 11 | 269 | Improper Privilege Management | 82.5218 | 82.5218 | Discouraged |
| 12 | 668 | Exposure of Resource to Wrong Sphere | 80.8440 | 80.8440 | Discouraged |
| 13 | 20 | Improper Input Validation | 79.5138 | 79.5138 | Discouraged |
