{
  "cve_id": "CVE-2025-3438",
  "description": "The MStore API Create Native Android & iOS Apps On The Cloud plugin for WordPress is vulnerable to limited privilege escalation in all versions up to, and including, 4.17.4. This is due to a **lack of restriction of role when registering**. This makes it possible for unauthenticated attackers to to register with the wcfm_vendor role, which is a Store Vendor role in the WCFM Marketplace Multivendor Marketplace for WooCommerce plugin for WordPress. The vulnerability can only be exploited if the WCFM Marketplace Multivendor Marketplace for WooCommerce plugin is installed and activated. The vulnerability was partially patched in version 4.17.3.",
  "key_phrases": {
    "rootcause": "lack of restriction of role when registering",
    "weakness": "",
    "impact": "limited privilege escalation",
    "vector": "",
    "attacker": "unauthenticated attackers",
    "product": "MStore API Create Native Android & iOS Apps On The Cloud plugin for WordPress",
    "version": "up to and including 4.17.4",
    "component": ""
  },
  "reference_content": "```text\nUNRELATED\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-266 | Incorrect Privilege Assignment | 0.8 | Base | Allowed | Primary CWE: **Lack of restriction of role when registering** |\n| CWE-863 | Incorrect Authorization | 0.6 | Class | Allowed-with-Review | Secondary Candidate: The product performs an authorization check, but it does not correctly perform the check. |\n| CWE-285 | Improper Authorization | 0.4 | Class | Discouraged | Secondary Candidate: Authorization is incorrectly performed, but CWE-266 is a better fit. |\n| CWE-306 | Missing Authentication for Critical Function | 0.3 | Base | Allowed | Secondary Candidate: Registration does not require authentication |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship that influenced the decision was the parent-child relationship and privilege guidance.\nCWE-266 (Incorrect Privilege Assignment) is a base-level CWE that directly addresses the root cause of the vulnerability of **lack of restriction of role when registering**. While CWE-863 (Incorrect Authorization) and CWE-285 (Improper Authorization) were considered, they are class-level CWEs and less specific. CWE-306 (Missing Authentication for Critical Function) was considered because registration was open to unauthenticated users.\n\n```mermaid\ngraph TD\n    cwe266[\"CWE-266: Incorrect Privilege Assignment\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n\n    cwe266 -->|CHILDOF| cwe284\n    cwe863 -->|CHILDOF| cwe284\n    cwe285 -->|CHILDOF| cwe284\n    cwe306 -->|CHILDOF| cwe287\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe266 primary\n    class cwe863,cwe285,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **lack of restriction of role when registering** (CWE-266), which allows unauthenticated attackers to register as wcfm_vendors, ultimately leading to a limited privilege escalation.\n\n## Summary of Analysis\nThe primary focus of the analysis was on identifying the root cause of the vulnerability. The vulnerability description clearly states that the vulnerability is due to a **lack of restriction of role when registering**.\nThe vulnerability description states \"This is due to a **lack of restriction of role when registering**. This makes it possible for unauthenticated attackers to to register with the wcfm_vendor role\". This indicates that users are being assigned incorrect privileges during registration.\nThe selection of CWE-266 is based on the fact that it directly addresses the root cause of the issue. The privilege guidance clearly makes the distinction between privileges and permissions, and highlights CWE-266 as the correct mapping when a user is assigned the wrong role.\nCWE-266 is at the optimal level of specificity because it is a base-level CWE and directly addresses the vulnerability's root cause.\n\nRelevant CWE Information:\n\n*   **CWE-266: Incorrect Privilege Assignment:** The system assigns incorrect privileges to a user (e.g., admin instead of guest). The **lack of restriction of role when registering** directly fits this description.\n*   **CWE-863: Incorrect Authorization:** The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This is a more general case of an authorization failure but could be related.\n*   **CWE-285: Improper Authorization:** The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action. This is a more general case of an authorization failure but could be related.\n*   **CWE-306: Missing Authentication for Critical Function:** There is no authentication for registration.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-266 | Incorrect Privilege Assignment | 0.8 | Base | Allowed | Primary CWE: **Lack of restriction of role when registering** |\n| CWE-863 | Incorrect Authorization | 0.6 | Class | Allowed-with-Review | Secondary Candidate: The product performs an authorization check, but it does not correctly perform the check. |\n| CWE-285 | Improper Authorization | 0.4 | Class | Discouraged | Secondary Candidate: Authorization is incorrectly performed, but CWE-266 is a better fit. |\n| CWE-306 | Missing Authentication for Critical Function | 0.3 | Base | Allowed | Secondary Candidate: Registration does not require authentication |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship that influenced the decision was the parent-child relationship and privilege guidance.\nCWE-266 (Incorrect Privilege Assignment) is a base-level CWE that directly addresses the root cause of the vulnerability of **lack of restriction of role when registering**. While CWE-863 (Incorrect Authorization) and CWE-285 (Improper Authorization) were considered, they are class-level CWEs and less specific. CWE-306 (Missing Authentication for Critical Function) was considered because registration was open to unauthenticated users.\n\n```mermaid\ngraph TD\n    cwe266[\"CWE-266: Incorrect Privilege Assignment\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n\n    cwe266 -->|CHILDOF| cwe284\n    cwe863 -->|CHILDOF| cwe284\n    cwe285 -->|CHILDOF| cwe284\n    cwe306 -->|CHILDOF| cwe287\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe266 primary\n    class cwe863,cwe285,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **lack of restriction of role when registering** (CWE-266), which allows unauthenticated attackers to register as wcfm_vendors, ultimately leading to a limited privilege escalation.\n\n## Summary of Analysis\nThe primary focus of the analysis was on identifying the root cause of the vulnerability. The vulnerability description clearly states that the vulnerability is due to a **lack of restriction of role when registering**.\nThe vulnerability description states \"This is due to a **lack of restriction of role when registering**. This makes it possible for unauthenticated attackers to to register with the wcfm_vendor role\". This indicates that users are being assigned incorrect privileges during registration.\nThe selection of CWE-266 is based on the fact that it directly addresses the root cause of the issue. The privilege guidance clearly makes the distinction between privileges and permissions, and highlights CWE-266 as the correct mapping when a user is assigned the wrong role.\nCWE-266 is at the optimal level of specificity because it is a base-level CWE and directly addresses the vulnerability's root cause.\n\nRelevant CWE Information:\n\n*   **CWE-266: Incorrect Privilege Assignment:** The system assigns incorrect privileges to a user (e.g., admin instead of guest). The **lack of restriction of role when registering** directly fits this description.\n*   **CWE-863: Incorrect Authorization:** The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This is a more general case of an authorization failure but could be related.\n*   **CWE-285: Improper Authorization:** The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action. This is a more general case of an authorization failure but could be related.\n*   **CWE-306: Missing Authentication for Critical Function:** There is no authentication for registration.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-306:**\n- 306 (Missing Authentication for Critical Function) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 696.7728384636084
    },
    {
      "metadata": {
        "doc_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "source": "sparse"
      },
      "similarity": 690.716330816156
    },
    {
      "metadata": {
        "doc_id": "862",
        "name": "Missing Authorization",
        "source": "sparse"
      },
      "similarity": 684.9267197672772
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 672.813492551818
    },
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "sparse"
      },
      "similarity": 670.3309493746424
    },
    {
      "metadata": {
        "doc_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "source": "sparse"
      },
      "similarity": 657.9503538101959
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse"
      },
      "similarity": 641.2034125815726
    },
    {
      "metadata": {
        "doc_id": "502",
        "name": "Deserialization of Untrusted Data",
        "source": "sparse"
      },
      "similarity": 640.0446120593875
    },
    {
      "metadata": {
        "doc_id": "425",
        "name": "Direct Request ('Forced Browsing')",
        "type": "Base",
        "original_content": "The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.",
        "keyphrase_source": "rootcause:lack of restriction of role when registering",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.49609455152757587,
            "graph": 1.6955550599926528
          }
        }
      },
      "similarity": 0.49609455152757587
    },
    {
      "doc_id": "471",
      "text": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
      "score": 2.7196000000000002,
      "metadata": {
        "doc_id": "471",
        "name": "Modification of Assumed-Immutable Data (MAID)",
        "type": "base",
        "original_content": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
        "relationships": [
          {
            "source_id": "471",
            "target_id": "621",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "607",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "602",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "473",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "425",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "291",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1321",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1282",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "471",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "621",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "607",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "602",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "473",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "425",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "291",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1321",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1282",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.5599999999999999,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_up",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "425"
            },
            "abstraction_path_up": {
              "path": [
                [
                  "472",
                  "471",
                  "CHILDOF"
                ]
              ],
              "score": 0.5599999999999999,
              "type": "abstraction_path_up",
              "source": "472"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "425"
            }
          }
        },
        "abstraction_level": "base",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.7196000000000002
          }
        }
      },
      "similarity": 2.7196000000000002
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-306",
      "CWE-285",
      "CWE-284",
      "CWE-266"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}