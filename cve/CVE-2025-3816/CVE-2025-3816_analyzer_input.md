# Vulnerability Information: CVE-2025-3816

## Vulnerability Description
A vulnerability classified as critical was found in westboy CicadasCMS 2.0. This vulnerability affects unknown code of the file /system/schedule/save of the component Scheduled Task Handler. The manipulation leads to os command injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **component:** Scheduled Task Handler
- **weakness:** **command injection, os command injection**
- **product:** westboy CicadasCMS
- **version:** 2

## CVE Reference Links Content Summary
CVE-2025-3816: PLACEHOLDER - Implement CVE description retrieval

The provided content details a remote code execution (RCE) vulnerability in CicadasCms\_v2.0. Here's a breakdown of the information:

**Root cause of vulnerability:**

The vulnerability stems from the ability to manipulate scheduled tasks within the CicadasCms application. Specifically, by adding a scheduled task with a crafted `beanClass` and `methodName`, an attacker can execute arbitrary code. The vulnerability is exacerbated by the ability to clear the Spring application context, preventing normal function execution and potentially allowing for more control.

**Weaknesses/vulnerabilities present:**

*   **Remote Code Execution (RCE):** The core vulnerability allows for the execution of arbitrary code on the server.
*   **Insecure Deserialization (Potential):** While not explicitly stated, the use of `beanClass` and `methodName` suggests a potential for insecure deserialization if the application doesn't properly validate the input.
*   **Lack of Input Validation:** The application does not adequately validate the `beanClass` and `methodName` parameters when creating scheduled tasks.
*   **Spring Framework Vulnerability:** The ability to clear the Spring application context (`springContextHolder.clearHolder()`) is exploited to disrupt normal application behavior.

**Impact of exploitation:**

Successful exploitation allows an attacker to:

*   Execute arbitrary code on the server.
*   Potentially gain full control of the server.
*   Disrupt the normal operation of the application.
*   Potentially compromise sensitive data.

**Attack vectors:**

1.  **Scheduled Task Creation:** An attacker can create a new scheduled task via the "系统管理 -> 计划任务 -> 添加任务" (System Management -> Scheduled Tasks -> Add Task) interface.
2.  **Crafted Payload:** The attacker crafts a POST request to `/system/schedule/save` with specific parameters:
    *   `beanClass`:  Set to a class like `com.zhiliao.component.druid.DataSourceConfiguration`.
    *   `methodName`: Set to a method like `dataSource`.
    *   `springBean`: Set to `dataSourceConfiguration`.
3.  **Context Clearing:** A second scheduled task can be created to call `springContextHolder.clearHolder()`, effectively clearing the Spring application context.
4.  **Exploitation:** After adding the tasks, the attacker triggers the scheduled task, leading to code execution.

**Required attacker capabilities/position:**

*   **Authenticated Access:** The attacker needs to have the ability to create scheduled tasks, implying some level of authenticated access to the application.
*   **Network Access:** The attacker needs network access to the CicadasCms application.
*   **Understanding of Spring Framework:** Knowledge of the Spring Framework and its components (like `ApplicationContext`) is helpful for crafting the exploit.

**Mitigation or fix:**

*   **Input Validation:** Implement strict input validation for all parameters used in scheduled task creation, especially `beanClass` and `methodName`.  A whitelist of allowed classes and methods should be used.
*   **Blacklisting/Whitelisting:** Implement a blacklist or whitelist of allowed execution types for scheduled tasks.
*   **Least Privilege:** Ensure that the application runs with the least necessary privileges.
*   **Regular Security Audits:** Conduct regular security audits and penetration testing to identify and address vulnerabilities.

**More detail than official CVE description:**

Yes, the content provides significantly more detail than a typical CVE description. It includes specific examples of the HTTP request payload, screenshots of the vulnerable interface, and a detailed explanation of the attack steps. It also explains the impact of clearing the Spring application context.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 1.000 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.400 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.376 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.324 |
| 6 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.323 |
| 7 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.315 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.311 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.640 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |

