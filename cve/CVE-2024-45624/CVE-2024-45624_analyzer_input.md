# Vulnerability Information: CVE-2024-45624

## Vulnerability Description
Exposure of sensitive information due to **incompatible policies** issue exists in Pgpool-II. If a database user accesses a query cache, table data unauthorized for the user may be retrieved.

### Vulnerability Description Key Phrases
- **rootcause:** **incompatible policies**
- **impact:** Exposure of sensitive information
- **vector:** database user accesses query cache
- **product:** Pgpool-II

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability described:

**Root Cause of Vulnerability:**

- The vulnerability lies within the query cache feature of Pgpool-II. When enabled, the query cache can return cached results to users without properly checking if the user has the necessary privileges to access the underlying data, leading to information disclosure.

**Weaknesses/Vulnerabilities Present:**

- **Improper Access Control:** The query cache does not enforce proper access control checks, potentially allowing unauthorized users to read data they should not have access to. This is a classic case of broken access control, specifically relating to cached query results.
- **CWE-213 Information Exposure Through Cache:** The vulnerability is classified under CWE-213, which specifically refers to information exposure through a cache mechanism.

**Impact of Exploitation:**

- **Information Disclosure:** A database user could potentially access table data that is not authorized for that user by exploiting the query cache. This may include sensitive information the attacker should not have access to.

**Attack Vectors:**

- **Network:** The vulnerability can be exploited by any user with network access to the Pgpool-II instance and the database.
- **Query Cache Access:** The attack vector involves utilizing the query cache mechanism by executing queries that would result in the user gaining unauthorized access to cached results.

**Required Attacker Capabilities/Position:**

- **Database User Account:** The attacker needs to have a valid database user account that can connect to the Pgpool-II instance.
- **Ability to Execute Queries:** The attacker needs to be able to execute SQL queries that would potentially cause vulnerable data to be cached.

**Versions Affected:**
The following versions of Pgpool-II are vulnerable:
- 4.5.0 to 4.5.3
- 4.4.0 to 4.4.8
- 4.3.0 to 4.3.11
- 4.2.0 to 4.2.18
- 4.1.0 to 4.1.21
- All versions of 4.0 series
- All versions of 3.7 series
- All versions of 3.6 series
- All versions of 3.5 series
- All versions of 3.4 series
- All versions of 3.3 series
- All versions of 3.2 series

**Patched Versions:**
The vulnerability is resolved in these versions and later:
- 4.5.4
- 4.4.9
- 4.3.12
- 4.2.19
- 4.1.22

**Workarounds:**

- The primary workaround is to disable the query cache feature by setting `memory_cache_enabled = off`.

This analysis provides more detail than the basic CVE description, explaining the root cause, attack vectors, and impact.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 213 | Exposure of Sensitive Information Due to Incompatible Policies | Base | Allowed | sparse | 0.167 |
| 2 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.167 |
| 3 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | sparse | 0.157 |
| 4 | 459 | Incomplete Cleanup | Base | Allowed | sparse | 0.156 |
| 5 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.153 |
| 6 | 524 | Use of Cache Containing Sensitive Information | Base | Allowed | sparse | 0.153 |
| 7 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | Allowed | sparse | 0.151 |
| 8 | 1220 | Insufficient Granularity of Access Control | Base | Allowed | sparse | 0.151 |
| 9 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | dense | 0.558 |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | Allowed | graph | 0.003 |

