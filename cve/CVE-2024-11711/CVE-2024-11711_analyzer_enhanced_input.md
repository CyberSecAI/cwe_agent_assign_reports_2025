## Vulnerability Description
The WP Job Portal A Complete Recruitment System for Company or Job Board website plugin for WordPress is vulnerable to SQL Injection via the resumeid parameter in all versions up to, and including, 2.2.1 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** unauthenticated attackers
- **product:** WP Job Portal A Complete Recruitment System for Company or Job Board website plugin for WordPress
- **version:** up to and including 2.2.1
- **component:** resumeid parameter

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-11711

**Vulnerability:** Unauthenticated SQL Injection

**Affected Software:** WP Job Portal WordPress plugin, versions up to and including 2.2.1

**Root Cause:**
*   The plugin fails to properly sanitize and escape the `resumeid` parameter in the `getAllResumeFiles` function within `/modules/resume/model.php`.
*   The code directly concatenates user-supplied input into an SQL query without sufficient preparation.

**Weaknesses/Vulnerabilities:**
*   **SQL Injection:** The primary vulnerability is an SQL injection due to inadequate sanitization of the `resumeid` parameter, which is used in a database query to retrieve resume files.

**Impact of Exploitation:**
*   **Information Disclosure:** An attacker can inject malicious SQL code to extract sensitive information from the database, including user data and other confidential details.

**Attack Vectors:**
*   **Network:** The attack is performed over the network by sending a crafted HTTP request to a vulnerable endpoint that utilizes the `resumeid` parameter.
*   **Unauthenticated Access:** The vulnerability can be exploited by unauthenticated users, meaning that attackers do not need to have any existing credentials on the target system.

**Required Attacker Capabilities/Position:**
*   The attacker needs to be able to send HTTP requests to the vulnerable WordPress site.
*   No prior authentication or special privileges are needed.

**Technical Details:**

*   The vulnerable code snippet is located in the `resume_model.php` file, specifically in the `getAllResumeFiles()` function, where the `resumeid` parameter is used without proper sanitization.
*   The SQL query that is vulnerable to injection is constructed using string concatenation involving the `resumeid` parameter received via `WPJOBPORTALrequest::getVar('resumeid')`.
*   The Wordfence article specifically mentions that the issue is in all versions up to and including 2.2.1.
*   The patch introduced in version 2.2.3 included input validation with `is_numeric()` checks on various parameters and proper sanitization using `esc_sql()`, as detailed in the diff on `plugins.trac.wordpress.org`.

**Summary of Patch:**
The patch introduces input validation using `is_numeric()` before using user-provided parameters in SQL queries to prevent non-numeric input from causing SQL errors or enabling injection.

**Additional Notes:**

*   The provided GitHub Gist shows the vulnerable `resume_model.php` file.
*   The `plugins.trac.wordpress.org` link provides a detailed comparison between the vulnerable version (2.2.2) and the patched version (2.2.3), highlighting the changes that were made to address the injection.
*   The vulnerability is related to improper handling of user input, which allows for SQL injection.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.580 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.521 |
| 4 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.506 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.490 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.489 |
| 7 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.488 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.488 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.479 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-790: Improper Filtering of Special Elements

CWE-502: Deserialization of Untrusted Data

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-862: Missing Authorization

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-471: Modification of Assumed-Immutable Data (MAID)