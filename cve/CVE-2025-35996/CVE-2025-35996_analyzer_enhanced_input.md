## Vulnerability Description
KUNBUS PiCtory version 2.11.1 and earlier are vulnerable when an authenticated remote attacker crafts a special filename that can be stored by API endpoints. That filename is later transmitted to the client in order to show a list of configuration files. Due to a **missing escape or sanitization**, the filename could be executed as HTML script tag resulting in a cross-site-scripting attack.

### Vulnerability Description Key Phrases
- **component:** API endpoints
- **rootcause:** **missing escape or sanitization**
- **vector:** special filename
- **weakness:** **cross-site scripting, weakness**
- **product:** KUNBUS PiCtory
- **impact:** cross-site scripting
- **attacker:** authenticated remote attacker
- **version:** 2.11.1 and earlier

## CVE Reference Links Content Summary
UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | alternate_terms | 0.700 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.471 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.460 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.447 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.420 |
| 6 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.415 |
| 7 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.397 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.397 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.575 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-116: Improper Encoding or Escaping of Output

CWE-138: Improper Neutralization of Special Elements

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-862: Missing Authorization

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-494: Download of Code Without Integrity Check