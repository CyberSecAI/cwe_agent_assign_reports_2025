# Vulnerability Information: CVE-2024-13750

## Vulnerability Description
The Multilevel Referral Affiliate Plugin for WooCommerce plugin for WordPress is vulnerable to SQL Injection via the orderby parameter in all versions up to, and including, 2.27 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Subscriber-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database and append additional SQL queries
- **vector:** orderby parameter
- **attacker:** authenticated attackers
- **product:** Multilevel Referral Affiliate Plugin for WooCommerce
- **version:** up to and including 2.27

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-13750, as it contains source code for a WordPress plugin ("multilevel-referral-plugin-for-woocommerce") and the CVE description (PLACEHOLDER) would need to be retrieved to confirm the exact vulnerability. However, based on the code, potential vulnerabilities can be identified.

**Root cause of vulnerability:**

The code creates database tables using `dbDelta` without proper sanitization of table names or column definitions. This could potentially lead to SQL injection vulnerabilities if the plugin's configuration allows for user-controlled input to influence the table creation process.

**Weaknesses/vulnerabilities present:**

*   **Potential SQL Injection:** The code directly constructs SQL queries using string concatenation, particularly when creating tables (lines 23-25, 30-32) and in queries like line 115, 125, 138-157, 168, 263, 334, 347, 353, 365, 436, 444.  Lack of proper input sanitization and escaping could allow an attacker to inject malicious SQL code.
*   **Insecure Database Schema Definition:** The table creation logic (lines 23-37) doesn't appear to have robust input validation, potentially allowing for the creation of tables with unexpected or malicious schemas.
*   **Direct use of user input in SQL queries:** Several queries use variables directly in the SQL statement without proper sanitization.

**Impact of exploitation:**

*   **Data Breach:** An attacker could potentially gain access to sensitive data stored in the WordPress database, including user information, order details, and referral data.
*   **Database Modification:** An attacker could modify or delete data in the database, potentially disrupting the functionality of the plugin and the WordPress site.
*   **Remote Code Execution:** In some cases, SQL injection vulnerabilities can be exploited to execute arbitrary code on the server.

**Attack vectors:**

*   **Exploitation of plugin settings:** If the plugin allows administrators to configure database table names or column definitions, an attacker could inject malicious code through these settings.
*   **Exploitation of user input:** If the plugin processes user input without proper sanitization and uses it in SQL queries, an attacker could inject malicious code through user-supplied data.

**Required attacker capabilities/position:**

*   **Administrator access (potentially):**  Exploitation might require administrator access to the WordPress site to modify plugin settings.
*   **Ability to inject malicious input:** The attacker needs to be able to provide malicious input to the plugin, either through settings or user-supplied data.

**Mitigation or fix:**

*   **Use prepared statements:**  Replace direct SQL query construction with prepared statements and parameterized queries. This is the most effective way to prevent SQL injection vulnerabilities.
*   **Input sanitization and validation:**  Thoroughly sanitize and validate all user input before using it in SQL queries or database operations.
*   **Escaping:** Properly escape all user-supplied data before including it in SQL queries.
*   **Least privilege principle:**  Ensure that the database user account used by the plugin has only the necessary privileges to perform its functions.
*   **Regular security audits:**  Conduct regular security audits of the plugin's code to identify and address potential vulnerabilities.
*   **Update the plugin:** Keep the plugin updated to the latest version to benefit from security patches and bug fixes.



This analysis provides more detail than the official CVE description, as it examines the source code for potential vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.583 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.549 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.514 |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.511 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.501 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.500 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.499 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.500 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |

