# Vulnerability Information: CVE-2025-21695

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved platform/x86 dell-uart-backlight fix serdev race The dell_uart_bl_serdev_probe() function calls devm_serdev_device_open() before setting the client ops via serdev_device_set_client_ops(). This ordering can trigger a **NULL pointer dereference** in the serdev controllers receive_buf handler, as it assumes serdev->ops is valid when SERPORT_ACTIVE is set. This is similar to the issue fixed in commit 5e700b384ec1 (platform/chrome cros_ec_uart properly fix **race condition**) where devm_serdev_device_open() was called before fully initializing the device. Fix the race by ensuring client ops are set before enabling the port via devm_serdev_device_open(). Note, serdev_device_set_baudrate() and serdev_device_set_flow_control() calls should be after the devm_serdev_device_open() call.

### Vulnerability Description Key Phrases
- **rootcause:** **race condition**
- **weakness:** **NULL pointer dereference**
- **product:** Linux kernel
- **component:** dell_uart_bl_serdev_probe() function

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.515 |
| 3 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.515 |
| 4 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.513 |
| 5 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.504 |
| 6 | 415 | Double Free | Variant | Allowed | sparse | 0.491 |
| 7 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.481 |
| 8 | 824 | Access of Uninitialized Pointer | Base | Allowed | sparse | 0.464 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.543 |
| 10 | 609 | Double-Checked Locking | Base | Allowed | graph | 0.003 |

