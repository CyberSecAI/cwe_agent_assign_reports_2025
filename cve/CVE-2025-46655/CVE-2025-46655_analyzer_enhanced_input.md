## Vulnerability Description
CodiMD through 2.5.4 has a CSP-based protection mechanism against **XSS through uploaded SVG documents** containing JavaScript, but it can be bypassed in certain cases of different-origin file storage, such as AWS S3. NOTE it can be considered a user error if AWS is employed for hosting untrusted JavaScript content, but the selected architecture within AWS does not have components that are able to insert Content-Security-Policy headers.

### Vulnerability Description Key Phrases
- **weakness:** **XSS through uploaded SVG documents**
- **product:** CodiMD
- **version:** through 2.5.4

## CVE Reference Links Content Summary
## Analysis of CVE-2025-46655 based on provided content

The provided content details an **Insecure File Upload Vulnerability** in CodiMD (versions v2.5.4 - v2.2.1 and ≤v2.2.0), reported by ZAST.AI. This vulnerability allows attackers to upload malicious files, potentially leading to stored Cross-Site Scripting (XSS) attacks.

Here's a breakdown of the vulnerability details extracted from the content:

**Root cause of vulnerability:**

*   **High-Version (v2.5.4 - v2.2.1):**  The application uses the Formidable module for file uploads with `keepExtensions` set to true, preserving original file extensions. While `checkImageValid` attempts validation, SVG files are allowed, which are susceptible to XSS.  The application uploads files to a remote S3 server, bypassing CSP restrictions.
*   **Low-Version (≤ v2.2.0):**  Lack of file validation mechanisms. The code doesn't implement checks like `checkImageValid` to verify file legitimacy.

**Weaknesses/vulnerabilities present:**

*   Insecure file upload.
*   Insufficient input validation.
*   Allowing potentially dangerous file types (SVG in higher versions).
*   Bypass of Content Security Policy (CSP) due to remote file storage.

**Impact of exploitation:**

*   Stored Cross-Site Scripting (XSS).
*   Potential for attackers to execute malicious JavaScript code in the context of other users' sessions.

**Attack vectors:**

*   **High-Version:** Uploading a malicious SVG file.
*   **Low-Version:** Uploading any arbitrary file type (potentially including malicious scripts).
*   Exploitation involves uploading a file and then accessing it via its URL.

**Required attacker capabilities/position:**

*   Authenticated user (for the demonstrated exploit on the demo site).
*   Ability to upload files to the server.
*   Understanding of XSS vulnerabilities and how to craft malicious payloads.

**Mitigation or fix:**

The content does not explicitly state a fix, but implies the need for:

*   Stronger file validation to prevent the upload of dangerous file types.
*   Sanitization of uploaded files.
*   Review and strengthening of the CSP policy.
*   Consideration of where files are stored (same-origin vs. remote) and the implications for CSP.

**Additional Notes:**

*   The report details successful exploitation on the official demo site ([https://hedgedoc.org/history/](https://hedgedoc.org/history/)).
*   The CSP policy in lower versions attempts to mitigate XSS, but can be bypassed by uploading to a remote server.
*   The content provides more detail than a typical CVE description, including code snippets and proof-of-concept steps.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.348 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.336 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.318 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.317 |
| 6 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | sparse | 0.312 |
| 7 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.304 |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.301 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.564 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-918: Server-Side Request Forgery (SSRF)

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-116: Improper Encoding or Escaping of Output

CWE-138: Improper Neutralization of Special Elements

CWE-611: Improper Restriction of XML External Entity Reference

CWE-184: Incomplete List of Disallowed Inputs

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-73: External Control of File Name or Path