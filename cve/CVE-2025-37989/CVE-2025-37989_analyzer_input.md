# Vulnerability Information: CVE-2025-37989

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved net phy leds fix **memory leak** A network restart test on a router led to an out-of-memory condition, which was traced to a **memory leak** in the PHY LED trigger code. The root cause is **misuse of the devm API**. The registration function (phy_led_triggers_register) is called from phy_attach_direct, not phy_probe, and the unregister function (phy_led_triggers_unregister) is called from phy_detach, not phy_remove. This means the register and unregister functions can be called multiple times for the same PHY device, but devm-allocated memory is not freed until the driver is unbound. This also prevents kmemleak from detecting the leak, as the devm API internally stores the allocated pointer. Fix this by replacing devm_kzalloc/devm_kcalloc with standard kzalloc/kcalloc, and add the corresponding kfree calls in the unregister path.

### Vulnerability Description Key Phrases
- **rootcause:** **misuse of the devm API**
- **weakness:** **memory leak**
- **impact:** out-of-memory condition
- **product:** Linux kernel
- **component:** net phy leds trigger code

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.757 |
| 3 | 415 | Double Free | Variant | Allowed | sparse | 0.732 |
| 4 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.728 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.719 |
| 6 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.713 |
| 7 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.712 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.710 |
| 9 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | dense | 0.534 |
| 10 | 129 | Improper Validation of Array Index | Variant | Allowed | graph | 0.003 |

