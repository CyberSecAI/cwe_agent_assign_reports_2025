{
  "query": "An issue was discovered in the WEBrick toolkit through 1.8.1 for Ruby. It allows HTTP request smuggling by providing both a Content-Length header and a Transfer-Encoding header, e.g., GET /admin HTTP/1.1\\r\\n inside of a POST /user HTTP/1.1\\r\\n request. NOTE the suppliers position is Webrick should not be used in production.",
  "keyphrases": {
    "rootcause": [
      "allows HTTP request smuggling"
    ],
    "weakness": [
      "HTTP smuggling"
    ]
  },
  "timestamp": "2025-07-13T18:07:12.140307",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "93",
        "name": "Improper Neutralization of CRLF Sequences ('CRLF Injection')",
        "abstraction": "base",
        "score": 2.4699999999999998,
        "description": "CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "117",
        "name": "Improper Output Neutralization for Logs",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-117: Improper Output Neutralization for Logs...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "abstraction": "base",
        "score": 2.1189999999999998,
        "description": "CWE-1333: Inefficient Regular Expression Complexity...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "144",
        "name": "Improper Neutralization of Line Delimiters",
        "abstraction": "variant",
        "score": 1.91472,
        "description": "CWE-144: Improper Neutralization of Line Delimiters...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "145",
        "name": "Improper Neutralization of Section Delimiters",
        "abstraction": "variant",
        "score": 1.91472,
        "description": "CWE-145: Improper Neutralization of Section Delimiters...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "494",
        "name": "Download of Code Without Integrity Check",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-494: Download of Code Without Integrity Check...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "184",
        "name": "Incomplete List of Disallowed Inputs",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-184: Incomplete List of Disallowed Inputs...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "444",
        "name": "Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')",
        "abstraction": "Base",
        "score": 1.655154042707977,
        "description": "The product acts as an intermediary HTTP agent\n         (such as a proxy or firewall) in the data flow between two\n         entities such as a client and server, but it does not\n         interpret mal...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "113",
        "name": "Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')",
        "abstraction": "Variant",
        "score": 1.5051493007585979,
        "description": "The product receives data from an HTTP agent/component (e.g., web server, proxy, browser, etc.), but it does not neutralize or incorrectly neutralizes CR and LF characters before the data is included ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "abstraction": "base",
        "score": 1.3676000000000001,
        "description": "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "abstraction": "base",
        "score": 1.3676000000000001,
        "description": "CWE-434: Unrestricted Upload of File with Dangerous Type...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "abstraction": "class",
        "score": 1.3216,
        "description": "CWE-138: Improper Neutralization of Special Elements...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "464",
        "name": "Addition of Data Structure Sentinel",
        "abstraction": "base",
        "score": 1.1466,
        "description": "CWE-464: Addition of Data Structure Sentinel...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "147",
        "name": "Improper Neutralization of Input Terminators",
        "abstraction": "variant",
        "score": 1.0919999999999999,
        "description": "CWE-147: Improper Neutralization of Input Terminators...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "650",
        "name": "Trusting HTTP Permission Methods on the Server Side",
        "abstraction": "Variant",
        "score": 1.085117946309531,
        "description": "The server contains a protection mechanism that assumes that any URI that is accessed using HTTP GET will not cause a state change to the associated resource. This might allow attackers to bypass inte...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "140",
        "name": "Improper Neutralization of Delimiters",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-140: Improper Neutralization of Delimiters...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "164",
        "name": "Improper Neutralization of Internal Special Elements",
        "abstraction": "variant",
        "score": 0.9623999999999999,
        "description": "CWE-164: Improper Neutralization of Internal Special Elements...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "162",
        "name": "Improper Neutralization of Trailing Special Elements",
        "abstraction": "variant",
        "score": 0.9623999999999999,
        "description": "CWE-162: Improper Neutralization of Trailing Special Elements...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "160",
        "name": "Improper Neutralization of Leading Special Elements",
        "abstraction": "variant",
        "score": 0.9623999999999999,
        "description": "CWE-160: Improper Neutralization of Leading Special Elements...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "444",
        "name": "Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')",
        "abstraction": "Base",
        "score": 0.6330871352091987,
        "description": "The product acts as an intermediary HTTP agent\n         (such as a proxy or firewall) in the data flow between two\n         entities such as a client and server, but it does not\n         interpret mal...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "113",
        "name": "Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')",
        "abstraction": "Variant",
        "score": 0.4929493306415313,
        "description": "The product receives data from an HTTP agent/component (e.g., web server, proxy, browser, etc.), but it does not neutralize or incorrectly neutralizes CR and LF characters before the data is included ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "650",
        "name": "Trusting HTTP Permission Methods on the Server Side",
        "abstraction": "Variant",
        "score": 0.49263991966924914,
        "description": "The server contains a protection mechanism that assumes that any URI that is accessed using HTTP GET will not cause a state change to the associated resource. This might allow attackers to bypass inte...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "598",
        "name": "Use of GET Request Method With Sensitive Query Strings",
        "abstraction": "Variant",
        "score": 0.4717632500665303,
        "description": "The web application uses the HTTP GET method to process a request and includes sensitive information in the query string of that request....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "784",
        "name": "Reliance on Cookies without Validation and Integrity Checking in a Security Decision",
        "abstraction": "Variant",
        "score": 0.46935245787665475,
        "description": "The product uses a protection mechanism that relies on the existence or values of a cookie, but it does not properly ensure that the cookie is valid for the associated user....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "5",
        "name": "J2EE Misconfiguration: Data Transmission Without Encryption",
        "abstraction": "Variant",
        "score": 0.4675483666077236,
        "description": "Information sent over a network can be compromised while in transit. An attacker may be able to read or modify the contents if the data are sent in plaintext or are weakly encrypted....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "177",
        "name": "Improper Handling of URL Encoding (Hex Encoding)",
        "abstraction": "Variant",
        "score": 0.46662812437805773,
        "description": "The product does not properly handle when all or part of an input has been URL encoded....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "433",
        "name": "Unparsed Raw Web Content Delivery",
        "abstraction": "Variant",
        "score": 0.4634095727516595,
        "description": "The product stores raw content or supporting code under the web document root with an extension that is not specifically handled by the server....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "130",
        "name": "Improper Handling of Length Parameter Inconsistency",
        "abstraction": "Base",
        "score": 0.46208735048140637,
        "description": "The product parses a formatted message or structure, but it does not handle or incorrectly handles a length field that is inconsistent with the actual length of the associated data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "409",
        "name": "Improper Handling of Highly Compressed Data (Data Amplification)",
        "abstraction": "Base",
        "score": 0.4618827770974914,
        "description": "The product does not handle or incorrectly handles a compressed input with a very high compression ratio that produces a large output....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "551",
        "name": "Incorrect Behavior Order: Authorization Before Parsing and Canonicalization",
        "abstraction": "Base",
        "score": 0.4584748633851064,
        "description": "If a web server does not fully parse requested URLs before it examines them for authorization, it may be possible for an attacker to bypass authorization protection....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "644",
        "name": "Improper Neutralization of HTTP Headers for Scripting Syntax",
        "abstraction": "Variant",
        "score": 0.45003157051251,
        "description": "The product does not neutralize or incorrectly neutralizes web scripting syntax in HTTP headers that can be used by web browser components that can process raw headers, such as Flash....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "166",
        "name": "Improper Handling of Missing Special Element",
        "abstraction": "Base",
        "score": 0.43596123951684573,
        "description": "The product receives input from an upstream component, but it does not handle or incorrectly handles when an expected special element is missing....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "669",
        "name": "Incorrect Resource Transfer Between Spheres",
        "abstraction": "Class",
        "score": 0.43480700750205964,
        "description": "The product does not properly transfer a resource/behavior to another sphere, or improperly imports a resource/behavior from another sphere, in a manner that provides unintended control over that reso...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "97",
        "name": "Improper Neutralization of Server-Side Includes (SSI) Within a Web Page",
        "abstraction": "Variant",
        "score": 0.42797273141252146,
        "description": "The product generates a web page, but does not neutralize or incorrectly neutralizes user-controllable input that could be interpreted as a server-side include (SSI) directive....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1311",
        "name": "Improper Translation of Security Attributes by Fabric Bridge",
        "abstraction": "Base",
        "score": 0.42679067501852497,
        "description": "The bridge incorrectly translates security attributes from either trusted to untrusted or from untrusted to trusted when converting from one fabric protocol to another....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "915",
        "name": "Improperly Controlled Modification of Dynamically-Determined Object Attributes",
        "abstraction": "Base",
        "score": 0.42533100327527573,
        "description": "The product receives input from an upstream component that specifies multiple attributes, properties, or fields that are to be initialized or updated in an object, but it does not properly control whi...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "838",
        "name": "Inappropriate Encoding for Output Context",
        "abstraction": "Base",
        "score": 0.4237017924839733,
        "description": "The product uses or specifies an encoding when generating output to a downstream component, but the specified encoding is not the same as the encoding that is expected by the downstream component....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "939",
        "name": "Improper Authorization in Handler for Custom URL Scheme",
        "abstraction": "Base",
        "score": 0.4226708434954271,
        "description": "The product uses a handler for a custom URL scheme, but it does not properly restrict which actors can invoke the handler using the scheme....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "84",
        "name": "Improper Neutralization of Encoded URI Schemes in a Web Page",
        "abstraction": "Variant",
        "score": 0.42254166073910804,
        "description": "The web application improperly neutralizes user-controlled input for executable script disguised with URI encodings....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "444",
        "name": "Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')",
        "abstraction": "Base",
        "score": 1000.0,
        "description": "The product acts as an intermediary HTTP agent\n         (such as a proxy or firewall) in the data flow between two\n         entities such as a client and server, but it does not\n         interpret mal...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "93",
        "name": "Improper Neutralization of CRLF Sequences ('CRLF Injection')",
        "abstraction": "Base",
        "score": 352.3396950300764,
        "description": "The product uses CRLF (carriage return line feeds) as a special element, e.g. to separate lines or records, but it does not neutralize or incorrectly neutralizes CRLF sequences from inputs....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "113",
        "name": "Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')",
        "abstraction": "Variant",
        "score": 350.20901821584323,
        "description": "The product receives data from an HTTP agent/component (e.g., web server, proxy, browser, etc.), but it does not neutralize or incorrectly neutralizes CR and LF characters before the data is included ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "abstraction": "Class",
        "score": 349.2444358313565,
        "description": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when th...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "abstraction": "Base",
        "score": 329.35741220529246,
        "description": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "130",
        "name": "Improper Handling of Length Parameter Inconsistency",
        "abstraction": "Base",
        "score": 323.8772740711033,
        "description": "The product parses a formatted message or structure, but it does not handle or incorrectly handles a length field that is inconsistent with the actual length of the associated data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "abstraction": "Base",
        "score": 316.557094010982,
        "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neu...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "abstraction": "Base",
        "score": 311.1941662461442,
        "description": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "212",
        "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
        "abstraction": "Base",
        "score": 307.19633028400995,
        "description": "The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorize...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 305.1875770712355,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.42254166073910804,
      "max": 0.6330871352091987,
      "mean": 0.46048158360604274,
      "median": 0.4601788202412989,
      "count": 20
    },
    "sparse": {
      "min": 305.1875770712355,
      "max": 1000.0,
      "mean": 394.51630029660436,
      "median": 326.61734313819784,
      "count": 10
    },
    "graph": {
      "min": 0.9623999999999999,
      "max": 2.4699999999999998,
      "mean": 1.5362730644888052,
      "median": 1.4363746503792991,
      "count": 20
    }
  }
}