## Vulnerability Description
A vulnerability was found in Tosei Online Store Management System 4.02/4.03/4.04. It has been rated as critical. Affected by this issue is some unknown functionality of the file /cgi-bin/p1_ftpserver.php. The manipulation of the argument adr_txt leads to **command injection**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. NOTE The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Tosei Online Store Management System
- **version:** 4.02/4.03/4.04
- **component:** /cgi-bin/p1_ftpserver.php

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-7896.

**Root cause of vulnerability:**
The vulnerability is due to the improper handling of user-supplied input in the `adr_txt` parameter of the `/cgi-bin/p1_ftpserver.php` file. The application does not correctly neutralize special characters, allowing an attacker to inject arbitrary commands into the system.

**Weaknesses/vulnerabilities present:**
- Command Injection (CWE-77, potentially CWE-74 and CWE-707)

**Impact of exploitation:**
Successful exploitation of this vulnerability allows an attacker to execute arbitrary commands on the server, leading to:
- Confidentiality breach
- Integrity breach
- Availability breach

**Attack vectors:**
- The attack vector is remote.
- The attacker manipulates the `adr_txt` parameter in a request to `/cgi-bin/p1_ftpserver.php` with malicious commands.

**Required attacker capabilities/position:**
- The attacker must have network access to the vulnerable system.
- The attacker needs to send a crafted HTTP request to the vulnerable endpoint with the injected command.
- Authentication is required, the default username/password are known to be "contecfws01"

**Additional details:**
- The vulnerability affects Tosei Online Store Management System versions 4.02, 4.03, and 4.04.
- A proof-of-concept exploit is available.
- The vendor was contacted but did not respond.
- The vulnerability can be located using the google dork `inurl:cgi-bin/p1_ftpserver.php`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.532 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.492 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.416 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.414 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.407 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.395 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.619 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-306: Missing Authentication for Critical Function

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-790: Improper Filtering of Special Elements

CWE-494: Download of Code Without Integrity Check