## Vulnerability Description
nptd-rs is a tool for synchronizing your computers clock, implementing the NTP and NTS protocols. There is a **missing limit for accepted NTS-KE connections**. This allows an unauthenticated remote attacker to crash ntpd-rs when an NTS-KE server is configured. Non NTS-KE server configurations, such as the default ntpd-rs configuration, are unaffected. This vulnerability has been patched in version 1.1.3.

### Vulnerability Description Key Phrases
- **rootcause:** **missing limit for accepted NTS-KE connections**
- **impact:** crash ntpd-rs
- **attacker:** unauthenticated remote attacker
- **product:** ntpd-rs
- **version:** before 1.1.3
- **component:** NTS-KE server configuration

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Missing limit for accepted NTS-KE connections. When ntpd-rs is configured as an NTS server, it accepts TCP connections for the NTS-KE service. If the process has reached the file descriptor limit and tries to accept a new TCP connection, the accept() system call will return with the EMFILE error, causing ntpd-rs to abort.
- **Weaknesses/vulnerabilities present:** Resource exhaustion due to unlimited accepted NTS-KE connections. Specifically, the vulnerability is categorized as CWE-770: Allocation of Resources Without Limits or Throttling.
- **Impact of exploitation:** The ntpd-rs daemon can be made completely unavailable by crashing the service. If ntpd-rs is automatically restarted, an attacker can repeat the attack to prevent it from functioning properly. This affects only NTS-KE server configurations.
- **Attack vectors:** A remote attacker can open a large number of parallel TCP connections to the server to exhaust file descriptors and trigger a crash.
- **Required attacker capabilities/position:** The attacker needs to be able to send network traffic to the affected ntpd-rs server and open multiple TCP connections quickly enough to avoid the `key-exchange-timeout-ms` timeout. No authentication or user interaction is required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.361 |
| 2 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.330 |
| 3 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.321 |
| 4 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | Allowed-with-Review | sparse | 0.320 |
| 5 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.318 |
| 6 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.315 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.314 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.314 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.412 |
| 10 | 476 | NULL Pointer Dereference | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-319: Cleartext Transmission of Sensitive Information

CWE-754: Improper Check for Unusual or Exceptional Conditions

CWE-347: Improper Verification of Cryptographic Signature

CWE-617: Reachable Assertion

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-674: Uncontrolled Recursion

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-476: NULL Pointer Dereference