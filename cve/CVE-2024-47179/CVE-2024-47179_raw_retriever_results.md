# Raw Retriever Results for CVE-2024-47179

# Raw Retriever Results for CVE-2024-47179
## Query
RSSHub is an RSS network. Prior to commit 64e00e7, RSSHubs `docker-test-cont.yml` workflow is vulnerable to Artifact Poisoning, which could have lead to a full repository takeover. Downstream users of RSSHub are not vulnerable to this issue, and commit 64e00e7 fixed the underlying issue and made the repository no longer vulnerable. The `docker-test-cont.yml` workflow gets triggered when the `PR - Docker build test` workflow completes successfully. It then collects some information about the Pull Request that triggered the triggering workflow and set some labels depending on the PR body and sender. If the PR also contains a `routes` markdown block, it will set the `TEST_CONTINUE` environment variable to `true`. The workflow then downloads and extracts an artifact uploaded by the triggering workflow which is expected to contain a single `rsshub.tar.zst` file. However, prior to commit 64e00e7, it did not validate and the contents were extracted in the root of the workspace overriding any existing files. Since the contents of the artifact were not validated, it is possible for a malicious actor to send a Pull Request which uploads, not just the `rsshub.tar.zst` compressed docker image, but also a malicious `package.json` file with a script to run arbitrary code in the context of the privileged workflow. As of commit 64e00e7, this scenario has been addressed and the RSSHub repository is no longer vulnerable.

## Keyphrases
- **rootcause**: 'improper input validation'
- **weakness**: 'artifact poisoning'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4391 | 0.5149 | 0.4652 | 0.4657 | 20 |
| Sparse | 1029.5561 | 1191.4662 | 1126.7144 | 1115.5213 | 11 |
| Graph | 1.3600 | 2.8210 | 1.7229 | 1.6198 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 2.8210 | Allowed |
| 2 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 3 | 363 | Race Condition Enabling Link Following | base | 2.2100 | Allowed |
| 4 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 5 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 6 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 7 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 8 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 9 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 10 | 918 | Server-Side Request Forgery (SSRF) | Base | 1.6254 | Allowed |
| 11 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 1.6142 | Allowed |
| 12 | 129 | Improper Validation of Array Index | variant | 1.5552 | Allowed |
| 13 | 184 | Incomplete List of Disallowed Inputs | base | 1.5350 | Allowed |
| 14 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.5210 | Allowed |
| 15 | 1333 | Inefficient Regular Expression Complexity | Base | 1.4904 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1333 | Inefficient Regular Expression Complexity | Base | 0.5149 | 0.5149 | Allowed |
| 2 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5108 | 0.5108 | Allowed |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.4884 | 0.4884 | Allowed |
| 4 | 863 | Incorrect Authorization | Class | 0.4858 | 0.4858 | Allowed-with-Review |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4771 | 0.4771 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4760 | 0.4760 | Allowed |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.4758 | 0.4758 | Allowed |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 0.4727 | 0.4727 | Allowed |
| 9 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.4677 | 0.4677 | Allowed |
| 10 | 285 | Improper Authorization | Class | 0.4674 | 0.4674 | Discouraged |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.4639 | 0.4639 | Allowed |
| 12 | 1287 | Improper Validation of Specified Type of Input | Base | 0.4511 | 0.4511 | Allowed |
| 13 | 277 | Insecure Inherited Permissions | Variant | 0.4493 | 0.4493 | Allowed |
| 14 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.4469 | 0.4469 | Allowed |
| 15 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4462 | 0.4462 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 1191.4662 | 1191.4662 | Allowed |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | 1190.6511 | 1190.6511 | Allowed |
| 3 | 918 | Server-Side Request Forgery (SSRF) | 1154.7468 | 1154.7468 | Allowed |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | 1142.2015 | 1142.2015 | Allowed |
| 5 | 863 | Incorrect Authorization | 1127.7081 | 1127.7081 | Allowed-with-Review |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1115.5213 | 1115.5213 | Allowed |
| 7 | 285 | Improper Authorization | 1115.1265 | 1115.1265 | Discouraged |
| 8 | 347 | Improper Verification of Cryptographic Signature | 1112.9404 | 1112.9404 | Allowed |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 1107.5337 | 1107.5337 | Allowed |
| 10 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 1106.4063 | 1106.4063 | Allowed-with-Review |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | 1029.5561 | 1029.5561 | Allowed |
