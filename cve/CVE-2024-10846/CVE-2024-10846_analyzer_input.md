# Vulnerability Information: CVE-2024-10846

## Vulnerability Description
The compose-go library component in versions v2.10-v2.4.0 allows an authorized user who sends malicious YAML payloads to cause the compose-go to consume excessive amount of Memory and CPU cycles while parsing YAML, such as used by Docker Compose from versions v2.27.0 to v2.29.7 included

### Vulnerability Description Key Phrases
- **impact:** consume excessive amount of Memory and CPU cycles
- **vector:** malicious YAML payloads
- **attacker:** authorized user
- **product:** compose-go
- **version:** v2.10-v2.4.0

## CVE Reference Links Content Summary
## Analysis of CVE-2024-10846 based on provided content:

The content from github.com/compose-spec/compose-go relates to CVE-2024-10846. The content from security.netapp.com does not contain useful information.

Here's a breakdown of the vulnerability information extracted from the GitHub content:

**Root cause of vulnerability:**

Recursive loop in Compose file unmarshalling leads to excessive resource consumption.

**Weaknesses/vulnerabilities present:**

The `compose-go` library is vulnerable to excessive memory and CPU usage when parsing YAML files containing recursive loops.

**Impact of exploitation:**

An authorized user sending malicious YAML payloads can cause the `compose-go` library to consume excessive amounts of memory and CPU cycles. This impacts Docker Compose versions v2.27.0 to v2.29.7.

**Attack vectors:**

Malicious YAML payloads.

**Required attacker capabilities/position:**

Authorized user - the attacker needs to be able to send YAML payloads to the system. User interaction is required.

**Mitigation or fix:**

*   Upgrade to `compose-go` version `v2.4.1` or later.
*   Docker Compose versions after v2.29.7 are patched.

**CVSS v3 base metrics:**

*   Attack Vector: Local (AV:L)
*   Attack Complexity: Low (AC:L)
*   Privileges Required: Low (PR:L)
*   User Interaction: Required (UI:R)
*   Scope: Changed (S:C)
*   Confidentiality: None (C:N)
*   Integrity: None (I:N)
*   Availability: High (A:H)
*   CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:N/I:N/A:H

**CVE ID:** CVE-2024-10846

**Additional Details (more than official CVE description):**

*   The advisory credits several individuals for finding and remediating the issue.
*   References to related GitHub issues and commits are provided.
*   The severity is rated as Moderate with a CVSS score of 5.9/10.
*   No CWEs are listed.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.103 |
| 2 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.097 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.094 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.087 |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.084 |
| 6 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.083 |
| 7 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.083 |
| 8 | 834 | Excessive Iteration | Class | Discouraged | sparse | 0.083 |
| 9 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | dense | 0.506 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |

