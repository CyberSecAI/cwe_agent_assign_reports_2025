# Raw Retriever Results for CVE-2024-57849

# Raw Retriever Results for CVE-2024-57849
## Query
In the Linux kernel, the following vulnerability has been resolved s390/cpum_sf Handle CPU hotplug remove during sampling CPU hotplug remove handling triggers the following function call sequence CPUHP_AP_PERF_S390_SF_ONLINE --> s390_pmu_sf_offline_cpu() ... CPUHP_AP_PERF_ONLINE --> perf_event_exit_cpu() The s390 CPUMF sampling CPU hotplug handler invokes s390_pmu_sf_offline_cpu() +--> cpusf_pmu_setup() +--> setup_pmc_cpu() +--> deallocate_buffers() This function de-allocates all sampling data buffers (SDBs) allocated for that CPU at event initialization. It also clears the PMU_F_RESERVED bit. The CPU is gone and can not be sampled. With the event still being active on the removed CPU, the CPU event hotplug support in kernel performance subsystem triggers the following function calls on the removed CPU perf_event_exit_cpu() +--> perf_event_exit_cpu_context() +--> __perf_event_exit_context() +--> __perf_remove_from_context() +--> event_sched_out() +--> cpumsf_pmu_del() +--> cpumsf_pmu_stop() +--> hw_perf_event_update() to stop and remove the event. During removal of the event, the sampling device driver tries to read out the remaining samples from the sample data buffers (SDBs). But they have already been freed (and may have been re-assigned). This may lead to a use after free situation in which case the samples are most likely invalid. In the best case the memory has not been reassigned and still contains valid data. Remedy this situation and check if the CPU is still in reserved state (bit PMU_F_RESERVED set). In this case the SDBs have not been released an contain valid data. This is always the case when the event is removed (and no CPU hotplug off occured). If the PMU_F_RESERVED bit is not set, the SDB buffers are gone.

## Keyphrases
- **rootcause**: 'use after free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3809 | 0.4387 | 0.4014 | 0.3957 | 20 |
| Sparse | 348.9848 | 1193.0591 | 1028.0209 | 1070.6377 | 11 |
| Graph | 1.6690 | 3.2188 | 2.0842 | 2.1849 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 3.2188 | Allowed |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.4700 | Allowed |
| 3 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 4 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.3400 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.3296 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.2100 | Allowed |
| 7 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 8 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 9 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 10 | 789 | Memory Allocation with Excessive Size Value | variant | 2.1936 | Allowed |
| 11 | 368 | Context Switching Race Condition | base | 2.1762 | Allowed |
| 12 | 415 | Double Free | variant | 2.0400 | Allowed |
| 13 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 14 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.4387 | 0.4387 | Allowed |
| 2 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4376 | 0.4376 | Allowed |
| 3 | 1037 | Processor Optimization Removal or Modification of Security-critical Code | Base | 0.4319 | 0.4319 | Allowed |
| 4 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4253 | 0.4253 | Allowed |
| 5 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | 0.4164 | 0.4164 | Allowed |
| 6 | 909 | Missing Initialization of Resource | Class | 0.4131 | 0.4131 | Allowed-with-Review |
| 7 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4072 | 0.4072 | Allowed |
| 8 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4070 | 0.4070 | Allowed |
| 9 | 1301 | Insufficient or Incomplete Data Removal within Hardware Component | Base | 0.4022 | 0.4022 | Allowed |
| 10 | 590 | Free of Memory not on the Heap | Variant | 0.4003 | 0.4003 | Allowed |
| 11 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.3910 | 0.3910 | Allowed |
| 12 | 1423 | Exposure of Sensitive Information caused by Shared Microarchitectural Predictor State that Influences Transient Execution | Base | 0.3894 | 0.3894 | Allowed |
| 13 | 1351 | Improper Handling of Hardware Behavior in Exceptionally Cold Environments | Base | 0.3890 | 0.3890 | Allowed |
| 14 | 1261 | Improper Handling of Single Event Upsets | Base | 0.3863 | 0.3863 | Allowed |
| 15 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | 0.3843 | 0.3843 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 1193.0591 | 1193.0591 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1155.3825 | 1155.3825 | Allowed-with-Review |
| 3 | 364 | Signal Handler Race Condition | 1131.9270 | 1131.9270 | Allowed |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 1082.9465 | 1082.9465 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | 1080.6085 | 1080.6085 | Allowed |
| 6 | 667 | Improper Locking | 1070.6377 | 1070.6377 | Allowed-with-Review |
| 7 | 755 | Improper Handling of Exceptional Conditions | 1062.7010 | 1062.7010 | Discouraged |
| 8 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 1062.2293 | 1062.2293 | Discouraged |
| 9 | 400 | Uncontrolled Resource Consumption | 1060.3076 | 1060.3076 | Discouraged |
| 10 | 401 | Missing Release of Memory after Effective Lifetime | 1059.4460 | 1059.4460 | Allowed |
| 11 | 407 | Inefficient Algorithmic Complexity | 348.9848 | 348.9848 | Allowed-with-Review |
