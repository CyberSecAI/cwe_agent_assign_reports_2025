## Vulnerability Description
An **Insecure Direct Object Reference** (IDOR) in PTC ThingWorx v9.5.0 allows attackers to view sensitive information, including PII, regardless of access level.

### Vulnerability Description Key Phrases
- **rootcause:** **Insecure Direct Object Reference**
- **impact:** view sensitive information including PII
- **attacker:** attackers
- **product:** PTC ThingWorx
- **version:** v9.5.0

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-40395.

**Root cause of vulnerability:**
The root cause is an Authenticated Insecure Direct Object Reference (IDOR) vulnerability in PTC ThingWorx v9.5.0.

**Weaknesses/vulnerabilities present:**
- Authenticated Insecure Direct Object Reference (IDOR): The application allows an authenticated user to access resources they shouldn't have access to by directly manipulating parameters in the HTTP requests. Specifically, the "Organization name" parameter can be altered.

**Impact of exploitation:**
- Information Disclosure: Attackers can view sensitive information, including Personally Identifiable Information (PII), regarding vehicles, drivers, users, and other information belonging to different organizations within the system, regardless of their access level.

**Attack vectors:**
- The attack vector is by sending crafted HTTP requests to specific endpoints after obtaining valid credentials for PTC ThingWorx.
- The attack relies on manipulating the "Organization name" parameter in POST requests to the listed endpoints.

**Required attacker capabilities/position:**
- The attacker needs to have valid credentials to authenticate to the PTC ThingWorx application.
- The attacker needs to be able to craft HTTP requests and modify the "Organization name" parameter.

**Affected endpoints:**
- `POST /Thingworx/Things/PostgreSQLNew/Services/VehicleProfile_NewV5?`
- `POST /Thingworx/Things/PostgreSQL/Services/Driver_Pages_New_V3?`
- `POST /Thingworx/Things/UsersThing/Services/GetUsersByOrganizationMultiQ?`

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | alternate_terms | 1.000 |
| 2 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 3 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.129 |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.119 |
| 5 | 540 | Inclusion of Sensitive Information in Source Code | Base | Allowed | sparse | 0.118 |
| 6 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.116 |
| 7 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.114 |
| 8 | 41 | Improper Resolution of Path Equivalence | Base | Allowed | sparse | 0.110 |
| 9 | 922 | Insecure Storage of Sensitive Information | Class | Allowed-with-Review | dense | 0.553 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-425: Direct Request ('Forced Browsing')

CWE-532: Insertion of Sensitive Information into Log File

CWE-540: Inclusion of Sensitive Information in Source Code

CWE-341: Predictable from Observable State

CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)

CWE-41: Improper Resolution of Path Equivalence

CWE-922: Insecure Storage of Sensitive Information

CWE-73: External Control of File Name or Path