## Vulnerability Description
The v6.40 release of Rockwell Automation FactoryTalk Policy Manager CVE-2021-22681 https//www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1550.html and CVE-2022-1161 https//www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html by implementing CIP security and did not update to the versions of the software CVE-2022-1161 https//www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html and CVE-2022-1161. https//www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html

### Vulnerability Description Key Phrases
- **product:** Rockwell Automation FactoryTalk Policy Manager
- **version:** v6.40

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2024-6325:

**Root Cause of Vulnerability:**

- The root cause is the insecure storage of private keys by FactoryTalk Policy Manager v6.40. These keys, used for generating digital certificates and pre-shared keys, were stored with read and execute privileges for the Windows group 'Everyone'.

**Weaknesses/Vulnerabilities Present:**

-   **Improper Privilege Management (CWE-269):** Private keys were stored with overly permissive access control, allowing any user on the system to access them.
-   **Insecure Storage of Sensitive Data:** Private keys, which should be protected, were stored in a location accessible to a broad group of users.

**Impact of Exploitation:**

- **Impersonation of Resources:** A malicious user who obtains the private keys can impersonate legitimate resources on the secured network.
- **Exploitation of CVE-2022-1161:** For customers who mitigated CVE-2021-22681 and CVE-2022-1161 by implementing CIP security but did not update to remediated software versions, this vulnerability could enable exploitation of CVE-2022-1161.

**Attack Vectors:**

- **Local Access:** The attacker needs local access to the machine where FactoryTalk Policy Manager v6.40 is installed.

**Required Attacker Capabilities/Position:**

- **Local User:** The attacker must be a user with access to the local machine and the ability to read the file system.
- **No Special Privileges Required:** The vulnerability is exploitable by any local user due to the overly permissive access control.

**Summary of the vulnerability**
The vulnerability arises from the insecure storage of private keys used by FactoryTalk Policy Manager, where the keys are accessible to any local user, allowing a malicious user to impersonate resources on the network.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.129 |
| 2 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.126 |
| 3 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.122 |
| 4 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.121 |
| 5 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.117 |
| 6 | 552 | Files or Directories Accessible to External Parties | Base | Allowed | sparse | 0.111 |
| 7 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.110 |
| 8 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.110 |
| 9 | 303 | Incorrect Implementation of Authentication Algorithm | Base | Allowed | dense | 0.599 |
| 10 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-191: Integer Underflow (Wrap or Wraparound)

CWE-1188: Initialization of a Resource with an Insecure Default

CWE-130: Improper Handling of Length Parameter Inconsistency

CWE-552: Files or Directories Accessible to External Parties

CWE-122: Heap-based Buffer Overflow

CWE-1333: Inefficient Regular Expression Complexity

CWE-303: Incorrect Implementation of Authentication Algorithm

CWE-805: Buffer Access with Incorrect Length Value