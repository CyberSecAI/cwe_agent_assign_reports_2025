# Vulnerability Information: CVE-2024-8801

## Vulnerability Description
The Happy Addons for Elementor plugin for WordPress is vulnerable to **Sensitive Information Exposure** in all versions up to, and including, 3.12.2 via the Content Switcher widget. This makes it possible for authenticated attackers, with Contributor-level access and above, to extract sensitive data including private, draft, and pending Elementor templates.

### Vulnerability Description Key Phrases
- **weakness:** **Sensitive Information Exposure**
- **impact:** extract sensitive data including private, draft, and pending Elementor templates
- **attacker:** authenticated attackers
- **product:** Happy Addons for Elementor
- **version:** all versions up to and including 3.12.2
- **component:** Content Switcher widget

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-8801:

**1. Verification of CVE Relevance**

*   The provided content from Wordfence explicitly states that CVE-2024-8801 is related to the "Happy Addons for Elementor" plugin, specifically versions <= 3.12.2.
*   The vulnerability is described as an "Authenticated (Contributor+) Sensitive Information Exposure" via the Content Switcher widget. This matches the official CVE description placeholder's format.
*   The provided Trac changeset and code diffs show a code change within the `content-switcher/widget.php` file, confirming the identified vulnerable component.
*   The changelog within the Trac changeset indicates a "Security improvement for Content Switcher widget." and a version update to 3.12.3.
*   Therefore, the content is relevant to CVE-2024-8801.

**2. Vulnerability Details**

*   **Root Cause:** The vulnerability stems from the Content Switcher widget in the "Happy Addons for Elementor" plugin. It appears that the widget was not properly checking access permissions when displaying content from "saved sections," "saved containers," and "saved pages."
*   **Weaknesses/Vulnerabilities Present:** The core weakness is a lack of proper access control for content displayed by the Content Switcher widget, specifically when rendering content from saved Elementor templates. The widget is not checking if the user has the appropriate permission to view the content which is being displayed..
*   **Impact of Exploitation:** An attacker with Contributor-level access or higher can use the vulnerability to extract sensitive data, such as private, draft, and pending Elementor templates, which they should not have access to.
*   **Attack Vectors:**
    *   The vulnerability can be exploited remotely via a crafted request to a WordPress site using the vulnerable plugin.
    *   The attacker needs to be an authenticated user with at least contributor-level privileges.
*   **Required Attacker Capabilities/Position:**
    *   The attacker must have an account on the target WordPress site with Contributor-level access or higher.
    *   They do not need to be in a specific network position.
* **Additional Details:**
    * The fix addresses the lack of checks for post status (specifically requiring `publish` status) on Elementor templates.

**3. Technical Details and Descriptions**

*   **Vulnerable Code Location:** The vulnerability resides within the `happy-elementor-addons/trunk/widgets/content-switcher/widget.php` file.
*  **Code change:** The code diff highlights the addition of checks for the `publish` status of saved content within the Content Switcher widget before rendering it. This prevents unauthorized access to unpublished Elementor templates.
  ```diff
   } elseif ( $item['content_type'] == 'saved_section' ) {
  + } elseif ( $item['content_type'] == 'saved_section' && 'publish' == get_post_status( $item['saved_section'] ) ) {
        $item['saved_section'] = apply_filters('wpml_object_id', $item['saved_section'], 'elementor_library');
        echo ha_elementor()->frontend->get_builder_content_for_display( $item['saved_section'] );
   } elseif ( $item['content_type'] == 'saved_container' ) {
  + } elseif ( $item['content_type'] == 'saved_container' && 'publish' == get_post_status( $item['saved_container'] ) ) {
       $item['saved_container'] = apply_filters('wpml_object_id', $item['saved_container'], 'elementor_library');
        echo ha_elementor()->frontend->get_builder_content_for_display( $item['saved_container'] );
    } elseif ( $item['content_type'] == 'saved_page' ) {
  + } elseif ( $item['content_type'] == 'saved_page' && 'publish' == get_post_status( $item['saved_pages'] ) ) {
        $item['saved_pages'] = apply_filters('wpml_object_id', $item['saved_pages'], 'elementor_library');
        echo ha_elementor()->frontend->get_builder_content_for_display( $item['saved_pages'] );
    }
  ```
  These changes ensure that only published templates are rendered, mitigating the sensitive information exposure vulnerability.
* The Wordfence description is more descriptive than the original CVE placeholder, giving a detailed view of the vulnerability.

**4. Remediation**
    * The vulnerability is patched in version 3.12.3 of the plugin. Users should update to this version or any later patched release to mitigate the vulnerability.

**Conclusion**

The provided information confirms the vulnerability detailed in CVE-2024-8801. It is a sensitive information exposure vulnerability in the Happy Addons for Elementor plugin stemming from improper access controls within the Content Switcher widget. The vulnerability allows authenticated users with Contributor-level access or higher to view Elementor templates that are not meant for public view. The fix, implemented in version 3.12.3, adds checks for publish status.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.298 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.297 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.296 |
| 4 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.294 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.292 |
| 6 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.289 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.281 |
| 8 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.279 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.527 |
| 10 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | Allowed | graph | 0.003 |

