# Raw Retriever Results for CVE-2024-52291

# Raw Retriever Results for CVE-2024-52291
## Query
Craft is a content management system (CMS). A vulnerability in CraftCMS allows an attacker to bypass local file system validation by utilizing a double file// scheme (e.g., file//file////). This enables the attacker to specify sensitive folders as the file system, leading to potential file overwriting through malicious uploads, unauthorized access to sensitive files, and, under certain conditions, remote code execution (RCE) via Server-Side Template Injection (SSTI) payloads. Note that this will only work if you have an authenticated administrator account with allowAdminChanges enabled. This is fixed in 5.4.6 and 4.12.5.

## Keyphrases
- **rootcause**: 'double file', 'scheme'
- **weakness**: 'Server-Side Template Injection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5301 | 0.6158 | 0.5638 | 0.5615 | 20 |
| Sparse | 450.9369 | 1000.0000 | 510.5314 | 475.6432 | 14 |
| Graph | 1.5184 | 2.5829 | 1.7985 | 1.7354 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 2.5829 | Allowed |
| 2 | 183 | Permissive List of Allowed Inputs | base | 2.2100 | Allowed |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.2028 | Allowed |
| 4 | 613 | Insufficient Session Expiration | base | 2.0930 | Allowed |
| 5 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 2.0400 | Allowed |
| 6 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.9277 | Allowed |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | base | 1.8772 | Allowed-with-Review |
| 8 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 11 | 23 | Relative Path Traversal | Base | 1.7028 | Allowed |
| 12 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 1.7026 | Allowed |
| 13 | 494 | Download of Code Without Integrity Check | base | 1.6016 | Allowed |
| 14 | 73 | External Control of File Name or Path | Base | 1.5555 | Allowed |
| 15 | 184 | Incomplete List of Disallowed Inputs | Base | 1.5473 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 0.6158 | 0.6158 | Allowed |
| 2 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.6089 | 0.6089 | Allowed |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 0.6028 | 0.6028 | Allowed |
| 4 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | 0.5953 | 0.5953 | Allowed |
| 5 | 24 | Path Traversal: '../filedir' | Variant | 0.5911 | 0.5911 | Allowed |
| 6 | 552 | Files or Directories Accessible to External Parties | Base | 0.5816 | 0.5816 | Allowed |
| 7 | 425 | Direct Request ('Forced Browsing') | Base | 0.5792 | 0.5792 | Allowed |
| 8 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | 0.5696 | 0.5696 | Allowed |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.5652 | 0.5652 | Allowed |
| 10 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | 0.5650 | 0.5650 | Allowed |
| 11 | 36 | Absolute Path Traversal | Base | 0.5580 | 0.5580 | Allowed |
| 12 | 50 | Path Equivalence: '//multiple/leading/slash' | Variant | 0.5565 | 0.5565 | Allowed |
| 13 | 25 | Path Traversal: '/../filedir' | Variant | 0.5533 | 0.5533 | Allowed |
| 14 | 73 | External Control of File Name or Path | Base | 0.5377 | 0.5377 | Allowed |
| 15 | 178 | Improper Handling of Case Sensitivity | Base | 0.5369 | 0.5369 | Allowed |

## Sparse Retriever Results (14)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 1000.0000 | 1000.0000 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 495.8432 | 495.8432 | Allowed |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | 487.5171 | 487.5171 | Allowed |
| 4 | 285 | Improper Authorization | 481.0564 | 481.0564 | Discouraged |
| 5 | 23 | Relative Path Traversal | 477.0316 | 477.0316 | Allowed |
| 6 | 668 | Exposure of Resource to Wrong Sphere | 476.1893 | 476.1893 | Discouraged |
| 7 | 138 | Improper Neutralization of Special Elements | 475.8202 | 475.8202 | Discouraged |
| 8 | 287 | Improper Authentication | 475.4661 | 475.4661 | Discouraged |
| 9 | 863 | Incorrect Authorization | 474.6269 | 474.6269 | Allowed-with-Review |
| 10 | 306 | Missing Authentication for Critical Function | 474.0539 | 474.0539 | Allowed |
| 11 | 94 | Improper Control of Generation of Code ('Code Injection') | 473.0358 | 473.0358 | Allowed-with-Review |
| 12 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | 454.4095 | 454.4095 | Discouraged |
| 13 | 611 | Improper Restriction of XML External Entity Reference | 451.4526 | 451.4526 | Allowed |
| 14 | 918 | Server-Side Request Forgery (SSRF) | 450.9369 | 450.9369 | Allowed |
