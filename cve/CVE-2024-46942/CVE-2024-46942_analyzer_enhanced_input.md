## Vulnerability Description
In OpenDaylight Model-Driven Service Abstraction Layer (MD-SAL) through 13.0.1, a controller with a follower role can configure flow entries in an OpenDaylight clustering deployment.

### Vulnerability Description Key Phrases
- **impact:** configure flow entries
- **attacker:** controller with follower role
- **product:** OpenDaylight Model-Driven Service Abstraction Layer
- **version:** through 13.0.1

## CVE Reference Links Content Summary
Based on the provided document, here's the breakdown of the vulnerability:

**Root Cause of Vulnerability:**

- The vulnerability, named "Marionette," stems from manipulating OpenFlow link discovery packet forwarding. This is done to alter the network topology information which is crucial for Software Defined Networking (SDN).

**Weaknesses/Vulnerabilities Present:**

- **Topology Poisoning:** The core weakness is the ability to inject false topology information into the SDN controller's view of the network. This differs from typical attacks that involve data plane manipulation. The attack occurs at the control plane.
- **Control Plane Manipulation:** The attack leverages control privileges to alter the forwarding behavior of link discovery packets, a process typically managed by the controller.
- **Overlooked Attack Vector:** The research highlights an overlooked aspect of link discovery, which has been traditionally treated as trustworthy.
- **Globalized Attack:** Unlike existing, localized attacks, Marionette introduces a globalized topology poisoning attack that impacts the overall network view and controller behavior.

**Impact of Exploitation:**

- **Catastrophic Damage to Network Management and Security:** Altering the topology view can lead to severe disruptions in network management.
- **Incorrect Routing:** A poisoned topology can cause traffic to be routed incorrectly or to dead-end destinations.
- **Network Instability:** Incorrect view leads to instability and unpredictable behavior.
- **Bypass Security Measures:** The vulnerability overcomes state-of-the-art defenses against topology poisoning.
- **Long-lived and Stealthy Attack:** The vulnerability uses reinforcement learning to compute the poisoned topology, and injects flow entries to make the attack long-lived and difficult to detect.

**Attack Vectors:**

- **Control Plane Access:** The attack vector is the OpenFlow control plane. The attacker needs to have some level of control over the SDN controller, including the ability to insert flow entries into the switches.
- **Manipulating Link Discovery:** The attack is executed through the manipulation of link discovery packet forwarding. Specifically it alters how link discovery information is being processed and forwarded.

**Required Attacker Capabilities/Position:**

- **Control Plane Privileges:** An attacker requires some level of control plane privileges, specifically the ability to inject flow entries into the OpenFlow switches. This likely implies having some administrative or elevated access to the SDN controller.
- **Knowledge of OpenFlow:** The attacker needs in-depth knowledge of the OpenFlow protocol and how link discovery works.
- **Reinforcement Learning Expertise:** The attacker may use a reinforcement learning algorithm to optimize the attack strategy.

**Additional Notes:**

- The provided text specifically mentions that the vulnerability was ethically disclosed to OpenDaylight and assigned **CVE-2024-37018**. The document does not mention CVE-2024-46942.
- The attack named "Marionette" is a new topology poisoning technique, which distinguishes itself from traditional attacks by manipulating link discovery packets at the control plane rather than at the data plane.
- The attack was tested on five open-source controllers and nine OpenFlow-based discovery protocols.
- This vulnerability is considered to be a new class of topology poisoning that initiates on the control plane.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.039 |
| 2 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.039 |
| 3 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.038 |
| 4 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.038 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.038 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.038 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.038 |
| 8 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.037 |
| 9 | 1315 | Improper Setting of Bus Controlling Capability in Fabric End-point | Base | Allowed | dense | 0.304 |
| 10 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-863: Incorrect Authorization

CWE-306: Missing Authentication for Critical Function

CWE-290: Authentication Bypass by Spoofing

CWE-668: Exposure of Resource to Wrong Sphere

CWE-285: Improper Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-269: Improper Privilege Management

CWE-1315: Improper Setting of Bus Controlling Capability in Fabric End-point

CWE-942: Permissive Cross-domain Policy with Untrusted Domains