# Vulnerability Information: CVE-2024-21880

## Vulnerability Description
**Improper Neutralization of Special Elements used in a Command (Command Injection)** vulnerability via the url parameter of an authenticated enpoint in Enphase IQ Gateway (formerly known as Enphase) allows OS Command Injection.This issue affects Envoy 4.x <= 7.x

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Neutralization of Special Elements used in a Command (Command Injection)**
- **weakness:** **OS command injection**
- **attacker:** authenticated
- **product:** Enphase IQ Gateway
- **version:** Envoy 4.x <= 7.x
- **component:** url parameter of an endpoint

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-21880:

**Root cause of vulnerability:**
- Improper Neutralization of Special Elements used in a Command ('Command Injection'). The vulnerability is present in the handling of URL parameters in an authenticated endpoint.

**Weaknesses/vulnerabilities present:**
- OS Command Injection: The Enphase IQ Gateway fails to properly sanitize user-supplied data in a URL parameter, allowing an attacker to inject and execute arbitrary OS commands.

**Impact of exploitation:**
- An attacker can execute arbitrary OS commands on the Enphase IQ Gateway device. This could lead to a variety of malicious activities, including but not limited to:
    - Data exfiltration
    - Device compromise
    - Botnet inclusion
    - Disruption of service

**Attack vectors:**
- The vulnerability is triggered via a URL parameter in an authenticated endpoint. The attacker needs to send a crafted URL request to the affected device.

**Required attacker capabilities/position:**
- The attacker must be authenticated.
- The attacker must have network access to the Enphase IQ Gateway.
- The IQ Gateway needs to be modified to obtain a public IP address and connect to the public internet to be directly exploitable.

**Additional details:**
- The vulnerability affects Enphase IQ Gateway versions 4.x through 7.x
- The fix is available in version 8.2.4225 and newer.
- A workaround is to ensure the IQ Gateway is not exposed to the public internet and is behind a router.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 1.000 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.336 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.334 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.320 |
| 6 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.311 |
| 7 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | sparse | 0.310 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.304 |
| 9 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | dense | 0.595 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |

