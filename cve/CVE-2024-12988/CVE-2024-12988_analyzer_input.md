# Vulnerability Information: CVE-2024-12988

## Vulnerability Description
A vulnerability has been found in Netgear R6900P and R7000P 1.3.3.154 and classified as critical. Affected by this vulnerability is the function sub_16C4C of the component HTTP Header Handler. The manipulation of the argument Host leads to **buffer overflow**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. This vulnerability only affects products that are no longer supported by the maintainer.

### Vulnerability Description Key Phrases
- **component:** HTTP Header Handler
- **weakness:** **buffer overflow**
- **product:** ['Netgear R6900P', 'R7000P']
- **version:** 1.3.3.154

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability lies within the `sub_16C4C` function of the Netgear router firmware, specifically version 1.3.3.154.
- This function handles web requests.
- The `sscanf` function is used to parse the `Host` header of the HTTP request.
- The code fails to perform adequate length checking on the input provided within the Host header.

**Weaknesses/Vulnerabilities:**
- **Stack Buffer Overflow:** The primary weakness is a stack buffer overflow due to the unchecked use of `sscanf` on the `Host` header. The overflow overwrites the return address, allowing for control-flow hijacking and code execution.
- **Lack of Input Validation:** The absence of length validation on the `Host` header allows for arbitrarily large inputs, which leads to the overflow condition.

**Impact of Exploitation:**
- **Denial of Service (DoS):** The immediate impact of exploiting the overflow is a crash of the HTTP service, causing a denial of service.
- **Pre-Authentication Remote Code Execution (RCE):**  Further exploitation can lead to pre-authentication remote code execution, allowing an attacker to gain control of the device without authentication.

**Attack Vectors:**
- **HTTP Request Header Manipulation:** The attack vector involves crafting a malicious HTTP request with an overly long `Host` header.
- **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable router. This could be achieved via network access from the LAN or potentially from the WAN side if the router's web interface is exposed to the public internet.

**Required Attacker Capabilities/Position:**
- **Network Accessibility:** The attacker must have network access to the router (either from the local network or potentially the internet).
- **Ability to Craft HTTP Requests:** The attacker needs the ability to craft and send HTTP requests with a malicious "Host" header.

**Additional Details:**
- The exploit detailed in the provided content shows how sending an HTTP GET request with a specially crafted "Host" header, longer than 3356 bytes, can crash the router's HTTP service. The overflow overwrites the stack down to the stack bottom.
- The vulnerable routers identified are the Netgear AC1900 R6900P and R7000P models using firmware version 1.3.3.154.
- A Python PoC script is provided that demonstrates how to trigger the vulnerability by sending a crafted HTTP request.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.471 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.464 |
| 6 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.441 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.430 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.420 |
| 9 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | dense | 0.620 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

