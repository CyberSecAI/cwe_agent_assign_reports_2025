# Raw Retriever Results for CVE-2024-56159

# Raw Retriever Results for CVE-2024-56159
## Query
Astro is a web framework for content-driven websites. A bug in the build process allows any unauthenticated user to read parts of the server source code. During build, along with client assets such as css and font files, the sourcemap files **for the server code** are moved to a publicly-accessible folder. Any outside party can read them with an unauthorized HTTP GET request to the same server hosting the rest of the website. While some server files are hashed, making their access obscure, the files corresponding to the file system router (those in `src/pages`) are predictably named. For example. the sourcemap file for `src/pages/index.astro` gets named `dist/client/pages/index.astro.mjs.map`. This vulnerability is the root cause of issue #12703, which links to a simple stackblitz project demonstrating the vulnerability. Upon build, notice the contents of the `dist/client` (referred to as `config.build.client` in astro code) folder. All astro servers make the folder in question accessible to the public internet without any authentication. It contains `.map` files corresponding to the code that runs on the server. All **server-output** projects on Astro 5 versions **v5.0.3** through **v5.0.7**, that have **sourcemaps enabled**, either directly or through an add-on such as `sentry`, are affected. The fix for **server-output** projects was released in **astro@5.0.8**. Additionally, all **static-output** projects built using Astro 4 versions **4.16.17 or older**, or Astro 5 versions **5.0.8 or older**, that have **sourcemaps enabled** are also affected. The fix for **static-output** projects was released in **astro@5.0.9**, and backported to Astro v4 in **astro@4.16.18**. The immediate impact is limited to source code. Any secrets or environment variables are not exposed unless they are present verbatim in the source code. There is no immediate loss of integrity within the the vulnerable server. However, it is possible to subsequently discover another vulnerability via the revealed source code . There is no immediate impact to availability of the vulnerable server. However, the presence of an unsafe regular expression, for example, can quickly be exploited to subsequently compromise the availability. The fix for **server-output** projects was released in **astro@5.0.8**, and the fix for **static-output** projects was released in **astro@5.0.9** and backported to Astro v4 in **astro@4.16.18**. Users are advised to update immediately if they are using sourcemaps or an integration that enables sourcemaps.

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5392 | 0.5931 | 0.5556 | 0.5528 | 20 |
| Sparse | 645.5892 | 659.5016 | 653.8172 | 654.2656 | 10 |
| Graph | 1.5210 | 2.2100 | 1.8236 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 2 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 3 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 4 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 6 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.8069 | Allowed |
| 8 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 9 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 11 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 12 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.6968 | Allowed |
| 13 | 918 | Server-Side Request Forgery (SSRF) | Base | 1.6532 | Allowed |
| 14 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 1.6478 | Allowed |
| 15 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 1.6404 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5931 | 0.5931 | Allowed |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.5858 | 0.5858 | Allowed |
| 3 | 863 | Incorrect Authorization | Class | 0.5820 | 0.5820 | Allowed-with-Review |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5663 | 0.5663 | Allowed |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 0.5617 | 0.5617 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5612 | 0.5612 | Allowed |
| 7 | 502 | Deserialization of Untrusted Data | Base | 0.5569 | 0.5569 | Allowed |
| 8 | 1333 | Inefficient Regular Expression Complexity | Base | 0.5549 | 0.5549 | Allowed |
| 9 | 285 | Improper Authorization | Class | 0.5541 | 0.5541 | Discouraged |
| 10 | 346 | Origin Validation Error | Class | 0.5535 | 0.5535 | Allowed-with-Review |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.5520 | 0.5520 | Allowed |
| 12 | 116 | Improper Encoding or Escaping of Output | Class | 0.5492 | 0.5492 | Allowed-with-Review |
| 13 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.5472 | 0.5472 | Allowed-with-Review |
| 14 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5455 | 0.5455 | Allowed |
| 15 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | 0.5431 | 0.5431 | Discouraged |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 659.5016 | 659.5016 | Allowed-with-Review |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | 657.6570 | 657.6570 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 657.3350 | 657.3350 | Allowed |
| 4 | 306 | Missing Authentication for Critical Function | 655.7720 | 655.7720 | Allowed |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 655.3133 | 655.3133 | Allowed |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 653.2180 | 653.2180 | Allowed |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | 652.7542 | 652.7542 | Allowed-with-Review |
| 8 | 285 | Improper Authorization | 651.7473 | 651.7473 | Discouraged |
| 9 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 649.2848 | 649.2848 | Allowed |
| 10 | 732 | Incorrect Permission Assignment for Critical Resource | 645.5892 | 645.5892 | Allowed-with-Review |
