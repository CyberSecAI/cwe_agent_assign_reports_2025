# Vulnerability Information: CVE-2024-45736

## Vulnerability Description
In Splunk Enterprise versions below 9.3.1, 9.2.3, and 9.1.6 and Splunk Cloud Platform versions below 9.2.2403.107, 9.1.2312.204, and 9.1.2312.111, a low-privileged user that does not hold the admin or power Splunk roles could craft a search query with an improperly formatted INGEST_EVAL parameter as part of a [Field Transformation](https//docs.splunk.com/Documentation/Splunk/latest/Knowledge/Managefieldtransforms) which could crash the Splunk daemon (splunkd).

### Vulnerability Description Key Phrases
- **impact:** crash Splunk daemon
- **vector:** crafted search query with improperly formatted INGEST_EVAL parameter
- **attacker:** low-privileged user
- **product:** Splunk Enterprise, Splunk Cloud Platform
- **version:** below 9.3.1, 9.2.3, and 9.1.6 and below 9.2.2403.107, 9.1.2312.204, and 9.1.2312.111

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-45736:

**Root Cause of Vulnerability:**
An improperly formatted `INGEST_EVAL` parameter within a field transformation can cause the Splunk daemon (`splunkd`) to crash.

**Weaknesses/Vulnerabilities Present:**
- Improper input validation/handling of the `INGEST_EVAL` parameter in the field transformation process.
- Lack of sufficient safeguards against malformed parameters leading to a denial-of-service condition.

**Impact of Exploitation:**
- Denial of service (DoS) of the Splunk daemon (`splunkd`), leading to:
  - Disruption of Splunk operations
  - Potential data loss
  - Service downtime

**Attack Vectors:**
- Network-based: The attack can be triggered by crafting a malicious search query containing an improperly formatted `INGEST_EVAL` parameter.

**Required Attacker Capabilities/Position:**
- Low-privileged user: An attacker needs only low-privileged access to Splunk; they do not need "admin" or "power" roles.
- Ability to craft a search query with the malicious `INGEST_EVAL` parameter.

**Additional Details from Content:**
- The vulnerability is present in Splunk Enterprise versions below 9.3.1, 9.2.3, and 9.1.6 and Splunk Cloud Platform versions below 9.2.2403.107, 9.1.2312.204, and 9.1.2312.111.
- A detection for this vulnerability exists, named "Splunk Improperly Formatted Parameter Crashes splunkd".
- The vulnerability is rated as "Medium" severity with a CVSSv3.1 score of 6.5
- The vulnerability is categorized under CWE-400: Uncontrolled Resource Consumption.
- The exploit involves a specially crafted search query using "makeresults" and "ingestpreview*transforms*".
- The provided Splunk query uses the `Splunk_Audit.Search_Activity` data model to identify malicious searches.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.131 |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.115 |
| 3 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.115 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.114 |
| 5 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.114 |
| 6 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.113 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.113 |
| 8 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.110 |
| 9 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | Allowed | dense | 0.493 |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | graph | 0.003 |

