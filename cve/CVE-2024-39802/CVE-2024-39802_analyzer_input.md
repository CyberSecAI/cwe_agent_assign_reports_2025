# Vulnerability Information: CVE-2024-39802

## Vulnerability Description
Multiple buffer overflow vulnerabilities exist in the qos.cgi qos_settings() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to stack-based buffer overflow. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.A buffer overflow vulnerability exists in the `qos_dat` POST parameter.

### Vulnerability Description Key Phrases
- **component:** qos.cgi qos_settings() functionality
- **vector:** specially crafted HTTP request
- **weakness:** **['buffer overflow', 'stack-based buffer overflow']**
- **product:** Wavlink AC3000 M33A8
- **version:** V5030.210505

## CVE Reference Links Content Summary
## Analysis of CVE-2024-39802 based on provided content:

This content **is related** to CVE-2024-39802, and provides significantly more detail than the placeholder CVE description.

**Root cause of vulnerability:**

The vulnerabilities stem from buffer overflow issues in the `qos.cgi` script's `qos_settings()` function when handling HTTP POST requests. Specifically, the `qos_bandwidth`, `qos_dat`, and `sel_mode` parameters are copied into buffers without proper length checking.

**Weaknesses/vulnerabilities present:**

*   **CWE-120 - Buffer Copy without Checking Size of Input (‘Classic Buffer Overflow’):**  The core vulnerability is a classic buffer overflow.
*   Multiple buffer overflow vulnerabilities exist in the `qos.cgi` script.
*   Lack of input validation on POST parameters.

**Impact of exploitation:**

Successful exploitation leads to arbitrary code execution. An attacker can overwrite the return address of the function, gaining control of the device.

**Attack vectors:**

*   An attacker can send a specially crafted HTTP POST request to the `qos.cgi` script.
*   The attacker needs to be authenticated (have a valid session cookie) to access the `qos.cgi` script.
*   Network access to the Wavlink AC3000 router is required.

**Required attacker capabilities/position:**

*   Authenticated HTTP request capabilities.
*   Understanding of the `qos.cgi` script's parameters and buffer sizes.
*   Network access to the vulnerable device.

**Mitigation or fix:**

The report does not specify a fix, but implies that proper input validation and bounds checking are needed in the `qos.cgi` script to prevent the buffer overflows. The vendor was contacted and is working on patches, but the product has been discontinued.

**Specific CVE Details from the report:**

*   **CVE-2024-39801:**  Buffer overflow in the `qos_bandwidth` parameter.
*   **CVE-2024-39802:**  Buffer overflow in the `qos_dat` parameter.
*   **CVE-2024-39803:**  Buffer overflow in the `sel_mode` parameter.

**Confirmed Vulnerable Versions:**

*   Wavlink AC3000 M33A8.V5030.210505

**CVSSv3 Score:** 9.1 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.412 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.386 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.345 |
| 6 | 195 | Signed to Unsigned Conversion Error | Variant | Allowed | sparse | 0.332 |
| 7 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.325 |
| 8 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.322 |
| 9 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | dense | 0.605 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

