## Vulnerability Description
An issue in ifood Order Manager v3.35.5 Gestor de Peddios.exe allows attackers to execute arbitrary code via a **DLL hijacking** attack.

### Vulnerability Description Key Phrases
- **weakness:** **DLL hijacking**
- **impact:** execute arbitrary code
- **vector:** DLL hijacking attack
- **attacker:** attackers
- **product:** ifood Order Manager
- **version:** v3.35.5
- **component:** Gestor de Peddios.exe

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability described in the content:

**Root cause of vulnerability:**

*   The vulnerability is a DLL hijacking issue. The "ifood Order Manager 'Gestor de Peddios.exe'" application is susceptible to loading a malicious DLL due to an insecure DLL search path.

**Weaknesses/vulnerabilities present:**

*   **Insecure DLL search path:** The application searches for DLLs in locations that a low-privileged user can write to.
*   **DLL hijacking:** The application loads a malicious `d3d12.dll` instead of the legitimate one if present in a higher-priority directory on the search path.

**Impact of exploitation:**

*   **Arbitrary code execution:** The attacker can execute arbitrary code with the same privileges as the application (which is an administrator in the provided POC).
*   **Privilege escalation:** Because the application is run by an administrator, the attacker effectively escalates privileges.

**Attack vectors:**

*   **Local file system:** The attacker needs to place the malicious DLL on the local machine's file system where the application searches for DLLs before finding the legitimate one. In the example provided, the malicious DLL needs to be placed at `C:\Gestor de Peddios\d3d12.dll`.

**Required attacker capabilities/position:**

*   **Low-level user access:** The attacker needs the ability to write files to the target system (Windows host) and the specific directory used by the application to load DLL files.
*   **Ability to create and transfer malicious DLL:** The attacker needs to be able to create a malicious DLL, in this case using `msfvenom`, and transfer it to the target system.
*   **No need for admin rights before exploitation:** The attack works because the target application is run by an administrator.

**More Detail than CVE Description:**

* The provided content offers a specific example of how to exploit this vulnerability with the application `ifood Order Manager 'Gestor de Peddios.exe'`. It provides the exact malicious DLL name (`d3d12.dll`) and the vulnerable directory `C:\Gestor de Peddios`. It includes commands for creating the malicious DLL using msfvenom and details steps on how to achieve the attack. It gives a vendor URL, google drive link to the affected application, and a POC video URL.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.177 |
| 2 | 426 | Untrusted Search Path | Base | Allowed | sparse | 0.127 |
| 3 | 278 | Insecure Preserved Inherited Permissions | Variant | Allowed | sparse | 0.120 |
| 4 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.117 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.104 |
| 6 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.101 |
| 7 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.100 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.099 |
| 9 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | dense | 0.512 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-427: Uncontrolled Search Path Element

CWE-426: Untrusted Search Path

CWE-278: Insecure Preserved Inherited Permissions

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-20: Improper Input Validation

CWE-121: Stack-based Buffer Overflow

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')