## Vulnerability Description
A **buffer overflow** vulnerability exists in the FileX Internal RAM interface functionality of STMicroelectronics X-CUBE-AZRTOS-WL 2.0.0. A specially crafted set of network packets can lead to code execution. An attacker can send a sequence of requests to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **impact:** code execution
- **vector:** specially crafted set of network packets
- **product:** STMicroelectronics X-CUBE-AZRTOS-WL
- **version:** 2.0.0
- **component:** FileX Internal RAM interface functionality

## CVE Reference Links Content Summary
```
Root cause of vulnerability:
The root cause is a lack of validation when configuring the RAM disk driver, specifically in the `fx_media_format` function. The calculation of the destination buffer pointer in `fx_stm32_sram_driver` can result in writing outside the bounds of the allocated RAM disk buffer because the total sectors multiplied by the sector size exceeds the buffer's capacity.

Weaknesses/vulnerabilities present:
- CWE-119 - Improper Restriction of Operations within the Bounds of a Memory Buffer
- Buffer overflow in the FileX Internal RAM interface.

Impact of exploitation:
Code execution. A buffer overflow could overwrite a function pointer, leading to arbitrary code execution.

Attack vectors:
Sending a specially crafted set of network packets, specifically HTTP PUT requests, to trigger the vulnerability.

Required attacker capabilities/position:
An attacker needs to be able to send network packets to the affected system.

Mitigation or fix:
Developers should ensure that the product of total sectors and sector size is less than the size of the RAM disk memory buffer during initialization with the `fx_media_format` function. Specifically, `[2]`\*`[3]` < `sizeof([1])` in the provided code example.

Confirmed Vulnerable Versions:
- STMicroelectronics X-CUBE-AZRT-H7RS 1.0.0
- STMicroelectronics X-CUBE-AZRTOS-F7 1.1.0
- STMicroelectronics X-CUBE-AZRTOS-F4 1.1.0
- STMicroelectronics X-CUBE-AZRTOS-G0 1.1.0
- STMicroelectronics X-CUBE-AZRTOS-G4 2.0.0
- STMicroelectronics X-CUBE-AZRTOS-L4 2.0.0
- STMicroelectronics X-CUBE-AZRTOS-L5 2.0.0
- STMicroelectronics X-CUBE-AZRTOS-WB 2.0.0
- STMicroelectronics X-CUBE-AZRTOS-WL 2.0.0
- STMicroelectronics X-CUBE-AZRTOS-H7 3.3.0

CVSSv3 Score: 8.5 (CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H)
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.277 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.271 |
| 6 | 131 | Incorrect Calculation of Buffer Size | Base | Allowed | sparse | 0.270 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.266 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.266 |
| 9 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | dense | 0.593 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-122: Heap-based Buffer Overflow

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-131: Incorrect Calculation of Buffer Size

CWE-125: Out-of-bounds Read

CWE-121: Stack-based Buffer Overflow

CWE-805: Buffer Access with Incorrect Length Value

CWE-128: Wrap-around Error