## Vulnerability Description
Eclipse Jetty is a lightweight, highly scalable, Java-based web server and Servlet engine . It includes a utility class, HttpURI, for URI/URL parsing. The HttpURI class does **insufficient validation** on the authority segment of a URI. However the behaviour of HttpURI differs from the common browsers in how it handles a URI that would be considered invalid if fully validated against the RRC. Specifically HttpURI and the browser may differ on the value of the host extracted from an invalid URI and thus a combination of Jetty and a vulnerable browser may be vulnerable to a **open redirect attack** or to a SSRF attack if the URI is used after passing validation checks.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient validation**
- **weakness:** **open redirect attack**
- **impact:** SSRF attack
- **product:** Eclipse Jetty
- **component:** HttpURI class

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2024-6763:

**Root Cause:**

*   The `HttpURI` class in Eclipse Jetty performs insufficient validation on the authority segment of a URI. This leads to inconsistent parsing of the host component compared to common browsers.
*   The vulnerability stems from the difference in how `HttpURI` and browsers (like Chrome) handle invalid URIs, specifically those containing user info (e.g., `username:password@hostname:port`). `HttpURI` doesn't fail on these invalid URIs, but it may extract a different hostname compared to the browser. This difference can lead to security issues.

**Weaknesses/Vulnerabilities:**

*   **Inconsistent Host Parsing:** `HttpURI` can extract a different host from a malformed URI compared to browsers.
*   **Insufficient Input Validation:** `HttpURI` lacks proper validation of the authority part of the URI, particularly concerning user information, special characters, and the distinction between valid and invalid URIs.
*   The use of RFC3986 for URI parsing in `HttpURI` and a different spec (WhatWG) used in browsers contributes to the discrepancy.
*   The issue is not in the Jetty server or client directly, but in the `HttpURI` utility class itself when used by applications.

**Impact of Exploitation:**

*   **SSRF (Server-Side Request Forgery):** An attacker could potentially bypass host blocklists or other security measures implemented using `HttpURI` by crafting a malicious URI.
*   **URL Redirection:** Attackers can cause a user to be redirected to an unintended host, by exploiting the different parsing between the Jetty's `HttpURI` class and browser's URI parsing implementation.
*   **Bypass of Security Measures:** The vulnerability allows bypassing security mechanisms that rely on validating hostnames extracted by `HttpURI`, potentially leading to further attacks.

**Attack Vectors:**

*   **Malicious URI Input:** The primary attack vector is through a malformed URI supplied by an attacker. Examples include:
    *   `http://browser.check &@vulndetector.com/`
    *   `http://browser.check #@vulndetector.com/`
    *   `http://browser.check?@vulndetector.com/`
    *   `http://browser.check#@vulndetector.com/`
    *   `http://vulndetector.com\\/`
*   **302 Redirect Manipulation:** The vulnerability can be exploited through redirects where the browser interprets the malformed URL differently from Jetty.
*   **HTML Links:** Attackers can use malformed URIs in HTML links (`<a href="...">`) to trigger redirects.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to supply a malformed URI that is processed by an application using `HttpURI`.
*   The attacker doesn't require any specific user privileges.

**Additional Notes:**

*   The vulnerability exists in the `HttpURI` class when used as a utility within an application, and not directly within the Jetty server or client usage of the class.
*   The fix involves adding more strict validation to the URI authority, and eventually deprecating user info in URI per RFC9110.
*   The issue highlights the discrepancy between RFC3986 compliant parsers and WhatWG URL parsing implementations used in browsers.
*   The CVE affects Jetty versions from 7.0.0 to 12.0.11.
*   The vulnerability has a low severity score of 3.7.
*   This CVE is due to the differences in URI parsing between Jetty (RFC3986) and browsers (WhatWG).
*   The maintainers consider this a low severity issue as it requires an application to use HttpURI directly, and not the standard server/client functionality.
*   Jetty 9/10/11 are going EOL on Jan 1, 2025 and will not be backported with a fix unless commercial support contracts dictate so.
*   The current fix deprecates the use of user info in URLs in Jetty 12, in line with RFC 9110.

This information should provide a comprehensive understanding of the vulnerability described in the provided content.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 601 | URL Redirection to Untrusted Site ('Open Redirect') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.683 |
| 3 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | sparse | 0.651 |
| 4 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.641 |
| 5 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.632 |
| 6 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.629 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.627 |
| 8 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.626 |
| 9 | 106 | Struts: Plug-in Framework not in Use | Variant | Allowed | dense | 0.494 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-601: URL Redirection to Untrusted Site ('Open Redirect')

CWE-1333: Inefficient Regular Expression Complexity

CWE-611: Improper Restriction of XML External Entity Reference

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')

CWE-295: Improper Certificate Validation

CWE-918: Server-Side Request Forgery (SSRF)

CWE-23: Relative Path Traversal

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-106: Struts: Plug-in Framework not in Use

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')