# Vulnerability Information: CVE-2024-42903

## Vulnerability Description
A **Host header injection** vulnerability in the password reset function of LimeSurvey v.6.6.1+240806 and before allows attackers to send users a crafted password reset link that will direct victims to a malicious domain.

### Vulnerability Description Key Phrases
- **rootcause:** **Host header injection**
- **impact:** direct victims to malicious domain
- **vector:** crafted password reset link
- **attacker:** attackers
- **product:** LimeSurvey
- **version:** v.6.6.1+240806 and before
- **component:** password reset function

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-42903:

**Root cause of vulnerability:**
The vulnerability stems from the LimeSurvey application using the `Host` header from an HTTP request to construct password reset links. The application does not properly validate or sanitize the value provided in the `Host` header before using it to generate the password reset link.

**Weaknesses/vulnerabilities present:**
- **Host Header Injection:** The application is vulnerable to Host Header Injection due to the lack of validation or sanitization of the Host header.
- **Unvalidated Input:** The application uses an attacker-controlled value (the `Host` header) to generate a URL, which is a classic example of unvalidated input leading to an exploit.

**Impact of exploitation:**
- **Malicious password reset links:** An attacker can inject a malicious domain into the password reset link sent to the victim.
- **Credentials theft:** When a victim clicks on the crafted link, they might be redirected to a malicious website controlled by the attacker. This allows the attacker to steal the victim's password reset token.
- **Account takeover:** The stolen reset token can allow the attacker to reset the victim's password and gain unauthorized access to their account.

**Attack vectors:**
- **HTTP Request:** The attack vector is through an HTTP request to the password reset function of the application.
- **Manipulated Host Header:** The attacker needs to manipulate the `Host` header of the HTTP request to inject a malicious domain.

**Required attacker capabilities/position:**
- **Network access:** The attacker needs to be able to send HTTP requests to the vulnerable LimeSurvey application.
- **Knowledge of application:** The attacker needs to know that the application uses the Host header in generating the reset password link.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.278 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.210 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.210 |
| 4 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.209 |
| 5 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.204 |
| 6 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.204 |
| 7 | 601 | URL Redirection to Untrusted Site ('Open Redirect') | Base | Allowed | sparse | 0.204 |
| 8 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.202 |
| 9 | 620 | Unverified Password Change | Base | Allowed | dense | 0.481 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.002 |

