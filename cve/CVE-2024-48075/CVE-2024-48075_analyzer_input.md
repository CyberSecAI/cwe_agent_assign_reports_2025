# Vulnerability Information: CVE-2024-48075

## Vulnerability Description
A **Heap buffer overflow** in the server-site handshake implementation in Real Time Logic SharkSSL from 09/09/24 and earlier allows a remote attacker to trigger a Denial-of-Service via a malformed TLS Client Key Exchange message.

### Vulnerability Description Key Phrases
- **weakness:** **Heap buffer overflow**
- **impact:** Denial-of-Service
- **vector:** malformed TLS Client Key Exchange message
- **attacker:** remote attacker
- **product:** Real Time Logic SharkSSL
- **version:** 09/09/24 and earlier
- **component:** server-site handshake implementation

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-48075:

**Root cause of vulnerability:**
- The vulnerability is located in the TLSv1.2 server-side handshake implementation of the SharkSSL library when processing a fragmented TLS Client Key Exchange message.
- Specifically, the `SharkSslCon_decrypt` function manipulates a pointer (`registeredevent`) based on data within the received TLS Client Key Exchange message.

**Weaknesses/vulnerabilities present:**
- **Remote Buffer Overflow:** The code calculates an offset using a 16-bit integer (`backupdata`) derived from the attacker-controlled message data, and adds this offset to the `registeredevent` pointer. This can result in the pointer pointing to an address outside of allocated memory.
- **Unvalidated Pointer Arithmetic:** The value of `backupdata` is derived from the attacker-controlled TLS Client Key Exchange message, and this value is directly used to advance the `registeredevent` pointer without proper bounds checking.

**Impact of exploitation:**
- **Denial of Service (DoS):** By sending a crafted TLS Client Key Exchange message, an attacker can trigger the buffer overflow, causing a segmentation fault and terminating the SharkSSL TLS server process, preventing legitimate clients from connecting.
- **Potential Information Leak:**  The controlled manipulation of the `registeredevent` pointer could potentially be used to leak information from unallocated memory regions.
- **Potential Remote Code Execution:** With further exploitation, by utilizing write instructions to the manipulated pointer, it may be possible to achieve remote code execution

**Attack vectors:**
- Sending a specially crafted, fragmented TLS Client Key Exchange message to the vulnerable SharkSSL TLS server.

**Required attacker capabilities/position:**
- The attacker needs to be able to communicate with the vulnerable SharkSSL TLS server. This likely means the attacker needs to be on the network as the server.
- The attacker needs to have the ability to send TLS messages to the server.
- The attacker needs knowledge of the specific structure of TLS handshake messages to trigger the vulnerability by crafting the Client Key Exchange message with specific parameters.

**Additional Details:**
- The vulnerability was discovered using code-coverage based fuzzing with AddressSanitizer.
- The code snippets provided in the appendix show the exact lines where the pointer arithmetic and subsequent dereference occur. The vulnerability is triggered at `SharkSSL.c:21319`.
- The fix was introduced in commit 7045f6f254060640ff77eef2027f108fcc20e2f2. The fix adds checks to the code to prevent manipulating pointer `registeredevent` out of the intended memory region.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.268 |
| 4 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.257 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.248 |
| 6 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.241 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.238 |
| 8 | 131 | Incorrect Calculation of Buffer Size | Base | Allowed | sparse | 0.236 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.562 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

