{
  "cve_id": "CVE-2024-21166",
  "description": "Vulnerability in the MySQL Server product of Oracle MySQL (component InnoDB). Supported versions that are affected are 8.0.36 and prior and 8.3.0 and prior. Difficult to exploit vulnerability allows high privileged attacker with network access via multiple protocols to compromise MySQL Server. Successful attacks of this vulnerability can result in unauthorized creation, deletion or modification access to critical data or all MySQL Server accessible data and unauthorized ability to cause a hang or frequently repeatable crash (complete DOS) of MySQL Server. CVSS 3.1 Base Score 5.9 (Integrity and Availability impacts). CVSS Vector (CVSS3.1/AVN/ACH/PRH/UIN/SU/CN/IH/AH).",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": [
      "Availability",
      "DOS",
      "cause a hang or frequently repeatable crash",
      "deletion or modification access to critical data or all MySQL Server accessible data",
      "unauthorized creation"
    ],
    "vector": "multiple protocols",
    "attacker": "high privileged attacker with network access",
    "product": "MySQL Server",
    "version": "8.0.36 and prior and 8.3.0 and prior",
    "component": "InnoDB"
  },
  "reference_content": "```\n{\n  \"vulnerability_details\": [\n    {\n      \"cve_id\": \"CVE-2024-21166\",\n      \"products\": [\n        \"MySQL Server\"\n      ],\n       \"affected_versions\": [\n        \"8.0.36 and prior\",\n        \"8.3.0 and prior\"\n      ],\n      \"component\": \"InnoDB\",\n      \"attack_vector\": \"Network\",\n      \"attack_complexity\": \"Low\",\n      \"privileges_required\": \"High\",\n      \"user_interaction\": \"None\",\n      \"scope\": \"Unchanged\",\n      \"confidentiality_impact\": \"None\",\n      \"integrity_impact\": \"High\",\n      \"availability_impact\": \"High\",\n      \"base_score\": \"5.9\",\n       \"remote_exploit_without_auth\": \"No\",\n      \"details\": \"The vulnerability lies in the InnoDB component of MySQL Server. An attacker with network access and high privileges can exploit this vulnerability to cause a denial-of-service or data corruption.  This could potentially lead to a complete loss of the database service or compromised data. The attack vector is through the MySQL protocol.\"\n    }\n  ]\n}\n```",
  "similar_info": {
    "cwe_distribution": {
      "95": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 5
        },
        "total_samples": 5,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 5,
            "proportion": 1.0
          }
        ]
      },
      "90": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 5
        },
        "total_samples": 5,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 5,
            "proportion": 1.0
          }
        ]
      },
      "85": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 14
        },
        "total_samples": 14,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 14,
            "proportion": 1.0
          }
        ]
      },
      "80": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 230
        },
        "total_samples": 231,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 230,
            "proportion": 0.996
          },
          {
            "cwes": [],
            "frequency": 1,
            "proportion": 0.004
          }
        ]
      },
      "75": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 420,
          "CWE-20": 2
        },
        "total_samples": 427,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 420,
            "proportion": 0.984
          },
          {
            "cwes": [],
            "frequency": 5,
            "proportion": 0.012
          },
          {
            "cwes": [
              "CWE-20"
            ],
            "frequency": 2,
            "proportion": 0.005
          }
        ]
      },
      "70": {
        "cwe_counts": {
          "CWE-NVD-noinfo": 113,
          "CWE-191": 1
        },
        "total_samples": 115,
        "distribution": [
          {
            "cwes": [
              "CWE-NVD-noinfo"
            ],
            "frequency": 113,
            "proportion": 0.983
          },
          {
            "cwes": [
              "CWE-191"
            ],
            "frequency": 1,
            "proportion": 0.009
          },
          {
            "cwes": [],
            "frequency": 1,
            "proportion": 0.009
          }
        ]
      }
    },
    "cwe_consensus": "CWE-NVD-noinfo",
    "similarity_stats": {
      "thresholds": [
        95,
        90,
        85,
        80,
        75,
        70
      ],
      "total_samples_by_threshold": {
        "95": 5,
        "90": 5,
        "85": 14,
        "80": 231,
        "75": 427,
        "70": 115
      },
      "top_cwes_by_threshold": {
        "95": [
          [
            "CWE-NVD-noinfo",
            5
          ]
        ],
        "90": [
          [
            "CWE-NVD-noinfo",
            5
          ]
        ],
        "85": [
          [
            "CWE-NVD-noinfo",
            14
          ]
        ],
        "80": [
          [
            "CWE-NVD-noinfo",
            230
          ]
        ],
        "75": [
          [
            "CWE-NVD-noinfo",
            420
          ],
          [
            "CWE-20",
            2
          ]
        ],
        "70": [
          [
            "CWE-NVD-noinfo",
            113
          ],
          [
            "CWE-191",
            1
          ]
        ]
      }
    },
    "raw_matches": [
      {
        "similarity": 95,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 5,
        "frequency": 5,
        "proportion": 1.0
      },
      {
        "similarity": 90,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 5,
        "frequency": 5,
        "proportion": 1.0
      },
      {
        "similarity": 85,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 14,
        "frequency": 14,
        "proportion": 1.0
      },
      {
        "similarity": 80,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 231,
        "frequency": 230,
        "proportion": 0.996
      },
      {
        "similarity": 80,
        "cwes": [],
        "total": 231,
        "frequency": 1,
        "proportion": 0.004
      },
      {
        "similarity": 75,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 427,
        "frequency": 420,
        "proportion": 0.984
      },
      {
        "similarity": 75,
        "cwes": [],
        "total": 427,
        "frequency": 5,
        "proportion": 0.012
      },
      {
        "similarity": 75,
        "cwes": [
          "20"
        ],
        "total": 427,
        "frequency": 2,
        "proportion": 0.005
      },
      {
        "similarity": 70,
        "cwes": [
          "NVD-noinfo"
        ],
        "total": 115,
        "frequency": 113,
        "proportion": 0.983
      },
      {
        "similarity": 70,
        "cwes": [
          "191"
        ],
        "total": 115,
        "frequency": 1,
        "proportion": 0.009
      },
      {
        "similarity": 70,
        "cwes": [],
        "total": 115,
        "frequency": 1,
        "proportion": 0.009
      }
    ]
  },
  "similarity_summary": {
    "consensus_cwe": "CWE-NVD-noinfo",
    "top_cwes": [
      [
        "CWE-NVD-noinfo",
        787
      ],
      [
        "CWE-20",
        2
      ],
      [
        "CWE-191",
        1
      ]
    ],
    "confidence_levels": {
      "high": [],
      "medium": [],
      "low": []
    },
    "total_samples": 797
  },
  "analysis": "# Summary\n| CWE ID        | CWE Name                                                                           | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---------------|------------------------------------------------------------------------------------|------------|-----------------------|---------------------------------|-----------------------------------|\n| CWE-NVD-noinfo | NVD has not provided further information for this CVE, so it cannot be mapped to a CWE | 1.0        | N/A                   | Primary                         | Allowed                          |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** LOW\n\n## Relationship Analysis\nThere is no meaningful relationship analysis possible as CWE-NVD-noinfo indicates that the vulnerability details are insufficient to map to a specific CWE.\n\n```mermaid\ngraph TD\n    cweNVD[\"CWE-NVD-noinfo\"]\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    class cweNVD primary\n```\n\n## Vulnerability Chain\nDue to the lack of information, a vulnerability chain cannot be established. The primary issue is the absence of details.\n\n## Summary of Analysis\nThe primary and only applicable CWE is CWE-NVD-noinfo. This is due to the fact that the NVD has not provided enough information to map to a specific CWE. The provided description indicates a vulnerability in MySQL Server's InnoDB component that can lead to unauthorized data access, modification, deletion and denial of service, but lacks the specifics needed to pinpoint the root cause.\n\nThe retriever results and complete CWE specifications are therefore irrelevant, as there is no way to determine which of those CWEs might be applicable without further information. The decision is based entirely on the absence of sufficient vulnerability details.",
  "analysis_with_relationships": "# Summary\n| CWE ID        | CWE Name                                                                           | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---------------|------------------------------------------------------------------------------------|------------|-----------------------|---------------------------------|-----------------------------------|\n| CWE-NVD-noinfo | NVD has not provided further information for this CVE, so it cannot be mapped to a CWE | 1.0        | N/A                   | Primary                         | Allowed                          |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** LOW\n\n## Relationship Analysis\nThere is no meaningful relationship analysis possible as CWE-NVD-noinfo indicates that the vulnerability details are insufficient to map to a specific CWE.\n\n```mermaid\ngraph TD\n    cweNVD[\"CWE-NVD-noinfo\"]\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    class cweNVD primary\n```\n\n## Vulnerability Chain\nDue to the lack of information, a vulnerability chain cannot be established. The primary issue is the absence of details.\n\n## Summary of Analysis\nThe primary and only applicable CWE is CWE-NVD-noinfo. This is due to the fact that the NVD has not provided enough information to map to a specific CWE. The provided description indicates a vulnerability in MySQL Server's InnoDB component that can lead to unauthorized data access, modification, deletion and denial of service, but lacks the specifics needed to pinpoint the root cause.\n\nThe retriever results and complete CWE specifications are therefore irrelevant, as there is no way to determine which of those CWEs might be applicable without further information. The decision is based entirely on the absence of sufficient vulnerability details.",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "129",
        "name": "Improper Validation of Array Index",
        "source": "sparse"
      },
      "similarity": 204.73703143594724
    },
    {
      "metadata": {
        "doc_id": "173",
        "name": "Improper Handling of Alternate Encoding",
        "source": "sparse"
      },
      "similarity": 192.36869919519253
    },
    {
      "metadata": {
        "doc_id": "611",
        "name": "Improper Restriction of XML External Entity Reference",
        "source": "sparse"
      },
      "similarity": 170.12464063891866
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 164.8541205322408
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 160.58186566265834
    },
    {
      "metadata": {
        "doc_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "source": "sparse"
      },
      "similarity": 159.64839727207934
    },
    {
      "metadata": {
        "doc_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "source": "sparse"
      },
      "similarity": 159.27020344359238
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 159.20020696217108
    },
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5559137623678315
          }
        }
      },
      "similarity": 0.5559137623678315
    },
    {
      "doc_id": "73",
      "text": "CWE-73: External Control of File Name or Path",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "type": "base",
        "original_content": "CWE-73: External Control of File Name or Path",
        "relationships": [
          {
            "source_id": "73",
            "target_id": "114",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "59",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "41",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "20",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "73",
            "target_id": "610",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "642",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "99",
            "target_id": "73",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "642",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "610",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "59",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "41",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "114",
            "target_id": "73",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "22"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "22"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "73",
                  "22",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "22"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}