# Vulnerability Information: CVE-2024-6027

## Vulnerability Description
The Themify - WooCommerce Product Filter plugin for WordPress is vulnerable to **time-based SQL Injection** via the conditions parameter in all versions up to, and including, 1.4.9 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL Injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** unauthenticated attackers
- **product:** Themify - WooCommerce Product Filter
- **version:** up to and including 1.4.9
- **component:** conditions parameter

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability information related to CVE-2024-6027:

**1. Verification of CVE Relevance:**

- The provided Wordfence article explicitly mentions  **CVE-2024-6027** and its relation to the Themify - WooCommerce Product Filter plugin.
- The description provided by Wordfence aligns with the SQL injection vulnerability.
- The vulnerable versions, up to and including 1.4.9, are clearly stated, and a patched version 1.5.0 exists.
- There are references to the plugin's code, changelogs, and the specific commit that addresses the vulnerability.

**2. Extracted Vulnerability Details:**

*   **Root Cause:**
    *   The vulnerability stems from a lack of proper input sanitization (insufficient escaping) and insufficient SQL query preparation for the 'conditions' parameter. This parameter allows users to submit data which is directly used in a SQL query, making it susceptible to SQL injection.
*   **Weaknesses/Vulnerabilities:**
    *   **SQL Injection:** The primary weakness is a Time-Based SQL Injection vulnerability.
*   **Impact of Exploitation:**
    *   An unauthenticated attacker can exploit this vulnerability to execute arbitrary SQL queries on the WordPress database. This can lead to:
        *   **Sensitive Data Exposure:** Extraction of sensitive information from the database.
        *   **Data Modification:** Potential modification of data within the database.
        *   **Complete System Compromise:** Potentially taking control of the entire system.
*   **Attack Vectors:**
    *   The vulnerability is exposed via the `conditions` parameter. The exact method of injecting the payload is not detailed, but it's likely through an HTTP request targeting a page where the filter is used.
*   **Required Attacker Capabilities/Position:**
    *   **Unauthenticated Access:** The attacker does not require any authentication, making it easier for malicious actors to exploit the vulnerability.
    *   **Network Access:** Attacker requires network access to the targeted server hosting the vulnerable WordPress installation.

**3. Additional Notes and Details:**

*   **Time-Based SQL Injection:** The Wordfence description specifies the vulnerability as a time-based SQL Injection, which means that an attacker will likely have to use timing attacks (e.g. `SLEEP()` function in MySQL) to confirm if the SQL injection is working properly and to extract data.
*  **Patched Version**: The vulnerability is fixed in version `1.5.0`.
*   **Specific Code Location:** The Wordfence article provides a link to the specific line of code `(plugins.trac.wordpress.org/browser/themify-wc-product-filter/trunk/public/class-wpf-public.php#L604)` that was changed to address the issue.
* **Changelog:** The themify.org changelog confirms that version `1.5.0` fixes a security issue.
* **Affected versions:** The vulnerable versions are `<= 1.4.9`

**Summary:**

The provided content clearly identifies a critical SQL injection vulnerability (CVE-2024-6027) in the Themify â€“ WooCommerce Product Filter plugin. The vulnerability is due to insufficient sanitization of user input in the 'conditions' parameter, allowing unauthenticated attackers to inject malicious SQL queries. Successful exploitation could lead to sensitive data disclosure, data modification, and potentially full system compromise. The vulnerability is fixed in version 1.5.0, and users of affected versions are urged to upgrade immediately.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.545 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.499 |
| 4 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.484 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.482 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.470 |
| 7 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.470 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.465 |
| 9 | 91 | XML Injection (aka Blind XPath Injection) | Base | Allowed | dense | 0.500 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

