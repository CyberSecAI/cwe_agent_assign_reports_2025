{
  "cve_id": "CVE-2025-39381",
  "description": "**Cross-Site Request Forgery** (CSRF) vulnerability in Kiotviet KiotViet Sync allows Stored XSS. This issue affects KiotViet Sync from n/a through 1.8.4.",
  "key_phrases": {
    "component": "",
    "rootcause": "Cross-Site Request Forgery",
    "vector": "",
    "weakness": "Stored XSS, weakness",
    "product": "Kiotviet KiotViet Sync",
    "impact": "",
    "attacker": "",
    "version": "n/a through 1.8.4"
  },
  "reference_content": "The content relates to CVE-2025-39381.\n\n**Root cause of vulnerability:**\nCross Site Request Forgery (CSRF) vulnerability.\n\n**Weaknesses/vulnerabilities present:**\nCSRF - allows a malicious actor to force higher privileged users to execute unwanted actions under their current authentication.\n\n**Impact of exploitation:**\nA malicious actor can force higher privileged users to execute unwanted actions. The specific impact varies case by case.\n\n**Attack vectors:**\nCross-Site Request Forgery (CSRF) attack.\n\n**Required attacker capabilities/position:**\nUnauthenticated.\n\n**Mitigation or fix:**\nNo official fix available. Patchstack vPatching auto-mitigates the vulnerability.\n\n**Additional details (more than official CVE description):**\n- Affected Software: KiotViet Sync WordPress Plugin\n- Vulnerable versions: <= 1.8.5\n- CVSS score: 7.1 (Low severity)\n- OWASP Top 10: A1: Broken Access Control\n- PSID: d928602596e8\n- Reported by: Nguyen Xuan Chien\n- Published by Patchstack on April 20, 2025.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-352 | Cross-Site Request Forgery (CSRF) | 0.9 | Compound | Primary | Allowed |\n| CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 0.8 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-352 [Cross-Site Request Forgery (CSRF)]**, a compound weakness, that allows for **Stored XSS**, which is **CWE-79 [Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')]**. **CWE-352** can lead to **CWE-79** because if an attacker can forge requests, they might be able to inject malicious scripts that are then stored and executed by other users.\n\n```mermaid\ngraph TD\n    cwe352[\"CWE-352: Cross-Site Request Forgery (CSRF)\"]\n    cwe79[\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\n    \n    cwe352 -->|CANPRECEDE| cwe79\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe352 primary\n    class cwe79 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **CWE-352 [Cross-Site Request Forgery (CSRF)]**, which then leads to **CWE-79 [Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')]** due to the ability to inject and store malicious scripts.\n\n## Summary of Analysis\nThe analysis indicates that the primary vulnerability is **CWE-352 [Cross-Site Request Forgery (CSRF)]**, which enables a **Stored XSS** attack (**CWE-79 [Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')]**). The description clearly states \"**Cross-Site Request Forgery** (CSRF) vulnerability in Kiotviet KiotViet Sync allows **Stored XSS**.\" The CVE Reference Links Content Summary also confirms the **root cause** as \"**Cross Site Request Forgery (CSRF) vulnerability**\" and lists \"**CSRF - allows a malicious actor to force higher privileged users to execute unwanted actions under their current authentication**\" as a weakness. The high retriever score for **CWE-79** supports its inclusion as a secondary weakness, as the CSRF allows for the injection of malicious scripts.\n\nI considered other CWEs listed in the Retriever Results, such as **CWE-89 [Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')]**, **CWE-918 [Server-Side Request Forgery (SSRF)]**, and **CWE-601 [URL Redirection to Untrusted Site ('Open Redirect')]**, but these do not directly align with the provided vulnerability description, which specifically mentions CSRF leading to Stored XSS. **CWE-434 [Unrestricted Upload of File with Dangerous Type]** and others were also considered, but they are not relevant as the vulnerability is about forging requests and injecting scripts, not file uploads or redirections. The selected CWEs are at the optimal level of specificity, with **CWE-352** at the compound level representing the attack vector and **CWE-79** at the base level representing the resulting XSS.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-352 | Cross-Site Request Forgery (CSRF) | 0.9 | Compound | Primary | Allowed |\n| CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 0.8 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-352 [Cross-Site Request Forgery (CSRF)]**, a compound weakness, that allows for **Stored XSS**, which is **CWE-79 [Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')]**. **CWE-352** can lead to **CWE-79** because if an attacker can forge requests, they might be able to inject malicious scripts that are then stored and executed by other users.\n\n```mermaid\ngraph TD\n    cwe352[\"CWE-352: Cross-Site Request Forgery (CSRF)\"]\n    cwe79[\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\n    \n    cwe352 -->|CANPRECEDE| cwe79\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe352 primary\n    class cwe79 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **CWE-352 [Cross-Site Request Forgery (CSRF)]**, which then leads to **CWE-79 [Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')]** due to the ability to inject and store malicious scripts.\n\n## Summary of Analysis\nThe analysis indicates that the primary vulnerability is **CWE-352 [Cross-Site Request Forgery (CSRF)]**, which enables a **Stored XSS** attack (**CWE-79 [Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')]**). The description clearly states \"**Cross-Site Request Forgery** (CSRF) vulnerability in Kiotviet KiotViet Sync allows **Stored XSS**.\" The CVE Reference Links Content Summary also confirms the **root cause** as \"**Cross Site Request Forgery (CSRF) vulnerability**\" and lists \"**CSRF - allows a malicious actor to force higher privileged users to execute unwanted actions under their current authentication**\" as a weakness. The high retriever score for **CWE-79** supports its inclusion as a secondary weakness, as the CSRF allows for the injection of malicious scripts.\n\nI considered other CWEs listed in the Retriever Results, such as **CWE-89 [Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')]**, **CWE-918 [Server-Side Request Forgery (SSRF)]**, and **CWE-601 [URL Redirection to Untrusted Site ('Open Redirect')]**, but these do not directly align with the provided vulnerability description, which specifically mentions CSRF leading to Stored XSS. **CWE-434 [Unrestricted Upload of File with Dangerous Type]** and others were also considered, but they are not relevant as the vulnerability is about forging requests and injecting scripts, not file uploads or redirections. The selected CWEs are at the optimal level of specificity, with **CWE-352** at the compound level representing the attack vector and **CWE-79** at the base level representing the resulting XSS.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-89:**\n- 89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) - ROOT\n\n\n**Chain starting from CWE-601:**\n- 601 (URL Redirection to Untrusted Site ('Open Redirect')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: XSS",
        "match_reason": "term_in_phrase_compound_part_0"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "source": "sparse"
      },
      "similarity": 227.85894224160012
    },
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "source": "sparse"
      },
      "similarity": 190.4884659655057
    },
    {
      "metadata": {
        "doc_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "source": "sparse"
      },
      "similarity": 185.4481591160673
    },
    {
      "metadata": {
        "doc_id": "601",
        "name": "URL Redirection to Untrusted Site ('Open Redirect')",
        "source": "sparse"
      },
      "similarity": 170.11746068558574
    },
    {
      "metadata": {
        "doc_id": "1004",
        "name": "Sensitive Cookie Without 'HttpOnly' Flag",
        "source": "sparse"
      },
      "similarity": 166.0030248291721
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse"
      },
      "similarity": 164.88142441541373
    },
    {
      "metadata": {
        "doc_id": "80",
        "name": "Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)",
        "source": "sparse"
      },
      "similarity": 155.86543545397524
    },
    {
      "metadata": {
        "doc_id": "790",
        "name": "Improper Filtering of Special Elements",
        "type": "Class",
        "original_content": "The product receives data from an upstream component, but does not filter or incorrectly filters special elements before sending it to a downstream component.",
        "keyphrase_source": "weakness:weakness",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed-with-Review",
          "rationale": "This CWE entry is a Class and might have Base-level children that would be more appropriate",
          "comments": "Examine children of this entry to see if there is a better fit",
          "reasons": [
            "Abstraction"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5616320792851534
          }
        }
      },
      "similarity": 0.5616320792851534
    },
    {
      "doc_id": "184",
      "text": "CWE-184: Incomplete List of Disallowed Inputs",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "184",
        "name": "Incomplete List of Disallowed Inputs",
        "type": "base",
        "original_content": "CWE-184: Incomplete List of Disallowed Inputs",
        "relationships": [
          {
            "source_id": "184",
            "target_id": "692",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "78",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "79",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "1023",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "693",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "86",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "78",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "693",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "STARTSWITH",
            "properties": {
              "view_id": "709"
            }
          },
          {
            "source_id": "625",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "186",
            "target_id": "184",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1023",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "79"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "79"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "184",
                  "79",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "79"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-89",
      "CWE-601",
      "CWE-79",
      "CWE-352",
      "CWE-918",
      "CWE-434"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}