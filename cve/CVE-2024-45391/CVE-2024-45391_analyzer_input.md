# Vulnerability Information: CVE-2024-45391

## Vulnerability Description
Tina is an open-source content management system (CMS). Sites building with Tina CMSs command line interface (CLI) prior to version 1.6.2 that use a search token may be vulnerable to the search token being leaked via lock file (tina-lock.json). Administrators of Tina-enabled websites with search setup should rotate their key immediately. This issue has been patched in @tinacms/cli version 1.6.2. Upgrading and rotating the search token is required for the proper fix.

### Vulnerability Description Key Phrases
- **impact:** leakage of search token
- **product:** Tina CMS
- **version:** prior to version 1.6.2
- **component:** command line interface (CLI)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability related to CVE-2024-45391:

**Root Cause of Vulnerability:**

The vulnerability stems from the `@tinacms/cli` tool writing the search configuration, including the search indexer token, to the `tina-lock.json` file. This lock file is often committed to version control systems, inadvertently exposing the sensitive search token.

**Weaknesses/Vulnerabilities Present:**

*   **Information Exposure:** The primary weakness is the unintentional exposure of the search indexer token. This token should be treated as a secret, and its inclusion in a publicly accessible lock file constitutes a security risk.
*   **Inadequate Filtering:** The `@tinacms/cli` tool lacked proper filtering to exclude sensitive information from being written to the lock file.

**Impact of Exploitation:**

*   **Confidentiality Breach:** The leaked search token can be used by unauthorized parties to potentially gain access to sensitive data or resources associated with the search functionality.
*  **Unauthorized Access:**  An attacker could potentially use the exposed search token to perform unauthorized actions on the search index.

**Attack Vectors:**

*   **Network:** An attacker could obtain the search token by accessing the publicly available `tina-lock.json` file, typically through a version control repository. This is a network-based attack vector, as it is over the network where the attacker can retrieve the token.

**Required Attacker Capabilities/Position:**

*   **Access to the `tina-lock.json` file:** The attacker needs access to the `tina-lock.json` file, which could be achieved through public repository access.
*   **No special privileges or user interaction required:** The attacker does not need any special privileges or to interact with a user to retrieve the search token.

**Additional Details:**

*   The vulnerability was present in versions of `@tinacms/cli` prior to `1.6.2`.
*   The fix involves filtering the search configuration from the output written to `tina-lock.json`.
*  The fix was introduced in commit `110f1ce`.
*   The vulnerability is classified as high severity, with a CVSS score of 7.5.
*   The CVE identifier is CVE-2024-45391, and the related GitHub Security Advisory is GHSA-4qrm-9h4r-v2fx.
*   The vulnerability is related to CWE-200 (Information Exposure).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.137 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.129 |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.128 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.128 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.124 |
| 6 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.123 |
| 7 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.123 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.122 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.400 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |

