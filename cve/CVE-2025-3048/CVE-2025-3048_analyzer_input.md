# Vulnerability Information: CVE-2025-3048

## Vulnerability Description
After completing a build with AWS Serverless Application Model Command Line Interface (SAM CLI) which include symlinks, the content of those symlinks are copied to the cache of the local workspace as regular files or directories. As a result, a user who does not have access to those symlinks outside of the Docker container would now have access via the local workspace. Users should upgrade to version 1.134.0 and ensure any forked or derivative code is patched to incorporate the new fixes. After upgrading, users must re-build their applications using the sam build --use-container to update the symlinks.

### Vulnerability Description Key Phrases
- **weakness:** **symlinks copied to cache as regular files**
- **impact:** gain access to symlinks
- **attacker:** unauthorized user
- **product:** AWS Serverless Application Model Command Line Interface
- **version:** prior to 1.134.0

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3048 based on provided content:

The provided content details a path traversal vulnerability in AWS SAM CLI. Here's a breakdown of the relevant information:

**Root cause of vulnerability:**

The vulnerability occurs because, after a build with AWS SAM CLI that includes symlinks, the content of those symlinks is copied to the local workspace cache as regular files or directories. This allows a user without access to the original symlink targets outside the Docker container to access them through the local workspace.

**Weaknesses/vulnerabilities present:**

*   Path Traversal (CWE-22)
*   Improper handling of symlinks during the build process.

**Impact of exploitation:**

*   Potential access to content of linked files in the SAM CLI cache that the user would not normally have access to.
*   The issue is limited to the local workspace and does not affect AWS services, production environments, or cross-account resources.

**Attack vectors:**

*   Exploitation occurs during the `sam build --use-container` process when symlinks are present in the build files.

**Required attacker capabilities/position:**

*   The attacker needs to be a user who can execute the `sam build --use-container` command with files containing symlinks.
*   No special privileges are required.

**Mitigation or fix:**

*   Upgrade to AWS SAM CLI version 1.134.0 or newer.
*   After upgrading, rebuild applications using `sam build --use-container` to update the symlinks.

**Additional Details (more detail than official CVE description):**

*   The vulnerability affects versions <= AWS SAM CLI v1.133.0.
*   There is no recommended workaround; upgrading is the advised solution.
*   Credit is given to Kevin Backhouse of the GitHub Security Lab for discovering and reporting the vulnerability.
*   CVSS v3 score: 6.5 (Moderate)
*   CVSS vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N

The content provides a comprehensive description of the vulnerability, its impact, and how to mitigate it.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.606 |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.591 |
| 3 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.523 |
| 4 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.504 |
| 5 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.502 |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.501 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.492 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.490 |
| 9 | 277 | Insecure Inherited Permissions | Variant | Allowed | dense | 0.431 |
| 10 | 363 | Race Condition Enabling Link Following | Base | Allowed | graph | 0.002 |

