# Analysis Report for CVE-2024-45302

# Vulnerability Analysis Report: CVE-2024-45302

## Description

RestSharp is a Simple REST and HTTP API Client for .NET. The second argument to `RestRequest.AddHeader` (the header value) is vulnerable to **CRLF injection**. The same applies to `RestRequest.AddOrUpdateHeader` and `RestClient.AddDefaultHeader`. The way HTTP headers are added to a request is via the `HttpHeaders.TryAddWithoutValidation` method which does not check for CRLF characters in the header value. This means that any headers from a `RestSharp.RequestHeaders` object are added to the request in such a way that they are vulnerable to CRLF-injection. In general, CRLF-injection into a HTTP header (when using HTTP/1.1) means that one can inject additional HTTP headers or smuggle whole HTTP requests. If an application using the RestSharp library passes a user-controllable value through to a header, then that application becomes vulnerable to CRLF-injection. This is not necessarily a security issue for a command line application like the one above, but if such code were present in a web application then it becomes vulnerable to request splitting (as shown in the PoC) and thus Server Side Request Forgery. Strictly speaking this is a potential vulnerability in applications using RestSharp, not in RestSharp itself, but I would argue that at the very least there needs to be a warning about this behaviour in the RestSharp documentation. RestSharp has addressed this issue in version 112.0.0. All users are advised to upgrade. There are no known workarounds for this vulnerability.

## Vulnerability Description Key Phrases

- **Rootcause:** RestSharp's handling of header values
- **Weakness:** CRLF injection
- **Impact:** ['inject additional HTTP headers', 'smuggle whole HTTP requests', 'server-side request forgery']
- **Product:** RestSharp
- **Version:** prior to 112.0.0
- **Component:** ['RestRequest.AddHeader', 'RestRequest.AddOrUpdateHeader', 'RestClient.AddDefaultHeader']

## Analysis (with Relationship Data)

# Summary

| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 1.0 | Base | Primary | Allowed |
| CWE-113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 0.9 | Variant | Secondary Candidate | Allowed |
| CWE-444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | 0.7 | Base | Secondary Candidate | Allowed |

## Evidence and Confidence

*   **Confidence Score:** 0.9
*   **Evidence Strength:** HIGH

## Relationship Analysis

The primary CWE is CWE-93, which represents the fundamental **CRLF injection** issue. CWE-113 is a variant that is specific to HTTP headers, and CWE-444 represents the potential impact of exploiting the CRLF injection.

```mermaid
graph TD
    cwe93["CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')"]
    cwe113["CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')"]
    cwe444["CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')"]

    cwe113 -->|CHILDOF| cwe93
    cwe444 -->|CANFOLLOW| cwe93

    classDef primary fill:#f96,stroke:#333,stroke-width:2px
    classDef secondary fill:#69f,stroke:#333
    classDef tertiary fill:#9e9,stroke:#333

    class cwe93 primary
    class cwe113,cwe444 secondary
```

## Vulnerability Chain

The vulnerability chain starts with the **improper handling of header values** in RestSharp, leading to **CRLF injection**. This can then be exploited to achieve HTTP request smuggling or splitting, and potentially SSRF.

CWE-93 (Root Cause: **CRLF Injection**) -> CWE-113 (Specific Context: HTTP Headers) -> CWE-444 (Potential Impact: HTTP Request Smuggling)

## Summary of Analysis

The vulnerability in RestSharp allows for **CRLF injection** due to the `HttpHeaders.TryAddWithoutValidation` method **not sanitizing header values**. This can lead to HTTP request smuggling and other attacks.

The primary CWE is CWE-93, which captures the core issue of **improper neutralization of CRLF sequences**. CWE-113 is a more specific variant focusing on HTTP headers, while CWE-444 describes a potential consequence (HTTP request smuggling).

The evidence from the vulnerability description supports this classification:

*   "The second argument to `RestRequest.AddHeader` (the header value) is vulnerable to **CRLF injection**."
*   "The way HTTP headers are added to a request is via the `HttpHeaders.TryAddWithoutValidation` method which does not check for CRLF characters in the header value."
*   "In general, **CRLF-injection** into a HTTP header (when using HTTP/1.1) means that one can inject additional HTTP headers or smuggle whole HTTP requests."
*   "If an application using the RestSharp library passes a user-controllable value through to a header, then that application becomes vulnerable to **CRLF-injection**."

The retriever results also support this, with CWE-93 and CWE-113 being the top matches.

CWE-79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')) was considered, but it's not applicable because the vulnerability is not related to web page generation or XSS. CWE-78 (Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')) was not selected because the vulnerability is not related to OS command execution. CWE-1333 (Inefficient Regular Expression Complexity) was not selected because there is no indication in the description that regular expressions are involved. CWE-74 (Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')) was considered, but CWE-93 is a more specific and appropriate choice.


## CWE Relationship Analysis

Current CWEs represent these abstraction levels: .


### Vulnerability Chain Analysis

**Chain starting from CWE-93:**
- 93 (Improper Neutralization of CRLF Sequences ('CRLF Injection')) - ROOT


**Chain starting from CWE-444:**
- 444 (Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')) - ROOT



### CWE Relationship Diagram

```mermaid
graph TD
    classDef primary fill:#f96,stroke:#333,stroke-width:2px
    classDef secondary fill:#69f,stroke:#333
    classDef tertiary fill:#9e9,stroke:#333
```



*Report generated on 2025-07-13 16:16:41*
