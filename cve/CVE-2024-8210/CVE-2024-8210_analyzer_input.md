# Vulnerability Information: CVE-2024-8210

## Vulnerability Description
A vulnerability was found in D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04 up to 20240814. It has been classified as critical. This affects the function sprintf of the file /cgi-bin/hd_config.cgi. The manipulation of the argument f_mount leads to **command injection**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. NOTE This vulnerability only affects products that are no longer supported by the maintainer. NOTE Vendor was contacted early and confirmed that the product is end-of-life. It should be retired and replaced.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04
- **version:** up to 20240814
- **component:** /cgi-bin/hd_config.cgi

## CVE Reference Links Content Summary
The provided content does not directly relate to CVE-2024-8210. However, it discusses vulnerabilities (CVE-2024-3272 and CVE-2024-3273) and other security issues in D-Link NAS devices.

Specifically, the VulDB submission #397274 provides detailed information about a command injection vulnerability:

**Root Cause of Vulnerability:**
- The `cgi_FMT_R12R5_3rd_DiskMGR` function in `/cgi-bin/hd_config.cgi` is vulnerable to command injection.
- The `f_mount` variable from a POST request is used in a `sprintf` function which is then passed to a `system` command.

**Weaknesses/Vulnerabilities Present:**
- Command Injection. The vulnerability exists because user-controlled input (`f_mount`) is passed to a system command without sanitization.

**Impact of Exploitation:**
- Successful exploitation allows an attacker to execute arbitrary commands on the device.

**Attack Vectors:**
- Sending a crafted POST request to the vulnerable CGI script (`/cgi-bin/hd_config.cgi`) with malicious data in the `f_mount` parameter.

**Required Attacker Capabilities/Position:**
- An attacker needs to be able to send POST requests to the web interface of the affected devices. This likely requires network access to the device, although the exact network configuration (LAN, WAN, etc) is not specified in this content.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.730 |
| 4 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.691 |
| 5 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.667 |
| 6 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.664 |
| 7 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.661 |
| 8 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | Variant | Allowed | sparse | 0.653 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.659 |
| 10 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | Allowed | graph | 0.002 |

