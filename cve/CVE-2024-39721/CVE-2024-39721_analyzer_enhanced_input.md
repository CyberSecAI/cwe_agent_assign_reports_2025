## Vulnerability Description
An issue was discovered in Ollama before 0.1.34. The CreateModelHandler function uses os.Open to read a file until completion. The req.Path parameter is user-controlled and can be set to /dev/random, which is blocking, causing the goroutine to run infinitely (even after the HTTP request is aborted by the client).

### Vulnerability Description Key Phrases
- **impact:** infinite goroutine loop
- **vector:** user-controlled req.Path parameter
- **product:** Ollama
- **version:** before 0.1.34
- **component:** CreateModelHandler function

## CVE Reference Links Content Summary
```
{
  "CVE-2024-39721": {
    "description": "Ollama is vulnerable to a denial-of-service (DoS) attack through the CreateModel API route with a single HTTP request.",
    "root_cause": "The CreateModelHandler function uses os.Open to read a file until completion. When the req.Path parameter is set to /dev/random, which is a blocking device, the goroutine will run infinitely, even after the HTTP request is aborted, leading to extensive resource consumption.",
    "vulnerabilities": [
      "Denial of Service (DoS)",
      "Infinite loop"
    ],
    "impact": "Extensive resource consumption, leading to a denial of service. Repetitive calls to the vulnerable endpoint will rapidly cause the server to become unresponsive.",
    "attack_vectors": [
      "HTTP POST request to the /api/create endpoint",
      "Setting the `path` parameter to `/dev/random`"
    ],
    "required_capabilities": "Attacker can send HTTP POST requests to the server."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.095 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.095 |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.095 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.094 |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.093 |
| 6 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.093 |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.093 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.093 |
| 9 | 774 | Allocation of File Descriptors or Handles Without Limits or Throttling | Variant | Allowed | dense | 0.352 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-138: Improper Neutralization of Special Elements

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-863: Incorrect Authorization

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-319: Cleartext Transmission of Sensitive Information

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-774: Allocation of File Descriptors or Handles Without Limits or Throttling

CWE-434: Unrestricted Upload of File with Dangerous Type