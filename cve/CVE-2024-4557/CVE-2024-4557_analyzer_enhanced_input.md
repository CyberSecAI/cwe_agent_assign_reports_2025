## Vulnerability Description
Multiple Denial of Service (DoS) conditions has been discovered in GitLab CE/EE affecting all versions starting from 1.0 prior to 16.11.5, starting from 17.0 prior to 17.0.3, and starting from 17.1 prior to 17.1.1 which allowed an attacker to cause resource exhaustion via banzai pipeline.

### Vulnerability Description Key Phrases
- **impact:** Denial of Service (DoS)
- **vector:** banzai pipeline
- **attacker:** attacker
- **product:** GitLab CE/EE
- **version:** all versions starting from 1.0 prior to 16.11.5, starting from 17.0 prior to 17.0.3, and starting from 17.1 prior to 17.1.1

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-NVD-noinfo

#### Top CWEs
- CWE-NVD-noinfo (Count: 6)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability stems from how GitLab handles specially crafted table syntax within issue descriptions. When a table is created with rows that have a varying number of columns, the system automatically extends rows with too few columns. This extension process, when combined with a large table, results in a quadratic complexity issue during issue moves, leading to high CPU usage.
- **Weaknesses/vulnerabilities present**:
    - **Algorithmic Complexity Vulnerability**: The process of expanding table rows to a consistent number of columns during issue moves has a quadratic time complexity, making it vulnerable to denial-of-service attacks with a large table.
    - **Lack of Input Validation**: There is insufficient validation or sanitization of the table syntax in issue descriptions, allowing for the creation of tables that trigger this high CPU usage.
- **Impact of exploitation**:
    - **Denial of Service (DoS)**: Exploiting this vulnerability results in high CPU usage for 60 seconds, causing request timeouts and making the GitLab instance unavailable.
    - **Resource Exhaustion**: Multiple concurrent requests with the crafted input can exhaust server resources and disrupt the API/GraphQL endpoint.
- **Attack vectors**:
    - **Issue Description**: Attackers can inject the malicious table syntax into an issue description.
    - **Move Issue Functionality**: The vulnerability is triggered when an issue containing the malicious table is moved to another project using the "Move Selected" feature or the graphql endpoint `moveIssue`.
- **Required attacker capabilities/position**:
    - **Authenticated User**: An attacker must be an authenticated GitLab user with the ability to create and edit issues.
    - **Project Access**: The attacker needs to have access to at least one project where they can create an issue and another project to move the issue to.

The provided content gives more detail than a typical CVE description, including the steps to reproduce, the vulnerable code, and the specific attack vector. The report also includes the attacker's test environment details and a video demonstration of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.129 |
| 2 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.118 |
| 3 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.111 |
| 4 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.111 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.110 |
| 6 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.107 |
| 7 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.107 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.106 |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.547 |
| 10 | 390 | Detection of Error Condition Without Action | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-400: Uncontrolled Resource Consumption

CWE-696: Incorrect Behavior Order

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-1333: Inefficient Regular Expression Complexity

CWE-285: Improper Authorization

CWE-755: Improper Handling of Exceptional Conditions

CWE-1286: Improper Validation of Syntactic Correctness of Input

CWE-863: Incorrect Authorization

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-390: Detection of Error Condition Without Action