{
  "cve_id": "CVE-2025-29923",
  "description": "go-redis is the official Redis client library for the Go programming language. Prior to 9.5.5, 9.6.3, and 9.7.3, go-redis potentially responds out of order when `CLIENT SETINFO` times out during connection establishment. This can happen when the client is configured to transmit its identity, there are network connectivity issues, or the client was configured with aggressive timeouts. The problem occurs for multiple use cases. For sticky connections, you receive persistent out-of-order responses for the lifetime of the connection. All commands in the pipeline receive incorrect responses. When used with the default ConnPool once a connection is returned after use with ConnPool#Put the read buffer will be checked and the connection will be marked as bad due to the unread data. This means that at most one out-of-order response before the connection is discarded. This issue is fixed in 9.5.5, 9.6.3, and 9.7.3. You can prevent the vulnerability by setting the flag DisableIndentity to true when constructing the client instance.",
  "key_phrases": {
    "rootcause": "Network connectivity issues",
    "weakness": "Connection instability",
    "impact": "potentially responds out of order",
    "vector": "CLIENT SETINFO times out",
    "attacker": "",
    "product": "go-redis",
    "version": "prior to 9.5.5, 9.6.3, and 9.7.3",
    "component": ""
  },
  "reference_content": "```json\n{\n  \"cve_id\": \"CVE-2025-29923\",\n  \"extracted_information\": {\n    \"vulnerability\": [\n      {\n        \"root_cause\": \"The issue only occurs when the `CLIENT SETINFO` command times out during connection establishment.\",\n        \"weaknesses\": [\n          \"CWE-20\"\n        ],\n        \"impact\": \"The impact differs by use case:\\n* **Sticky connections**:  receive persistent out-of-order responses for the lifetime of the connection.\\n* **Pipelines**: All commands in the pipeline receive incorrect responses.\\n* **Default connection pool usage without pipelining**:  at most one out-of-order response before the connection is discarded.\",\n        \"attack_vectors\": [\n          \"The client is configured to transmit its identity.\",\n          \"Network connectivity issues\",\n          \"The client was configured with aggressive timeouts\"\n        ],\n        \"attack_capabilities\": \"No privileges required.\",\n        \"position\": \"Network\",\n        \"remediation\": \"You can prevent the vulnerability by setting the flag `DisableIndentity` to `true` when constructing the client instance.\",\n        \"additional_details\": \"Provides more detail than the official CVE description\"\n      }\n    ]\n  }\n}\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| **CWE-410** | **Insufficient Resource Pool** | 0.7 | Base | Primary | Allowed |\n| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.5 | Base | Secondary Candidate | Allowed |\n| CWE-20 | Improper Input Validation | 0.3 | Class | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE is CWE-410, which relates to insufficient resources. CWE-770, allocation of resources without limits, is a parent of CWE-1325 (Improperly Controlled Sequential Memory Allocation) and is a child of CWE-400 (Resource Exhaustion), suggesting a potential resource exhaustion issue. CWE-20 is a higher level class related to the weaknesses from the CVE Reference Links.\n\n```mermaid\ngraph TD\n    cwe410[\"CWE-410: Insufficient Resource Pool\"]\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe400[\"CWE-400: Resource Exhaustion\"]\n    cwe20[\"CWE-20: Improper Input Validation\"]\n    cwe1325[\"CWE-1325: Improperly Controlled Sequential Memory Allocation\"]\n    \n    cwe410 -->|CHILDOF| cwe664\n    cwe770 -->|CHILDOF| cwe400\n    cwe1325 -->|CHILDOF| cwe770\n    cwe410 -->|CANPRECEDE| cwe400\n    cwe1284 -->|CHILDOF| cwe20\n\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe410 primary\n    class cwe770,cwe20 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **network connectivity issues** or aggressive timeouts. This leads to `CLIENT SETINFO` timing out, resulting in out-of-order responses. With the default connection pool, this leads to the connection being discarded. For sticky connections and pipelines, this leads to persistent incorrect responses.\n\n## Summary of Analysis\nThe primary assessment is based on the vulnerability description and the CVE reference links content summary. The **rootcause** is network connectivity issues and aggressive timeouts, leading to `CLIENT SETINFO` timing out. This leads to out-of-order responses. The CVE reference links content summary confirms this. The vulnerability can be prevented by setting `DisableIndentity` to `true`.\n\nCWE-410 (Insufficient Resource Pool) is chosen as the primary CWE because the issue stems from a timing out issue which prevents the server from allocating resources correctly. The \"Insufficient Resource Pool\" is a better fit than any of the others.\n\nCWE-770 (Allocation of Resources Without Limits or Throttling) was considered because of the potential for resource exhaustion if the client retries the connection frequently, but it is not the main issue.\n\nCWE-20 (Improper Input Validation) was mentioned in the CVE Reference Links content summary. It is related because the `CLIENT SETINFO` command is timing out, leading to invalid state and out-of-order responses, but it's a less direct cause.\n\nThe selected CWEs are at the optimal level of specificity because CWE-410 addresses the timing issue preventing resource allocation. CWE-770 and CWE-20 are contributing factors or higher-level classifications.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| **CWE-410** | **Insufficient Resource Pool** | 0.7 | Base | Primary | Allowed |\n| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.5 | Base | Secondary Candidate | Allowed |\n| CWE-20 | Improper Input Validation | 0.3 | Class | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE is CWE-410, which relates to insufficient resources. CWE-770, allocation of resources without limits, is a parent of CWE-1325 (Improperly Controlled Sequential Memory Allocation) and is a child of CWE-400 (Resource Exhaustion), suggesting a potential resource exhaustion issue. CWE-20 is a higher level class related to the weaknesses from the CVE Reference Links.\n\n```mermaid\ngraph TD\n    cwe410[\"CWE-410: Insufficient Resource Pool\"]\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe400[\"CWE-400: Resource Exhaustion\"]\n    cwe20[\"CWE-20: Improper Input Validation\"]\n    cwe1325[\"CWE-1325: Improperly Controlled Sequential Memory Allocation\"]\n    \n    cwe410 -->|CHILDOF| cwe664\n    cwe770 -->|CHILDOF| cwe400\n    cwe1325 -->|CHILDOF| cwe770\n    cwe410 -->|CANPRECEDE| cwe400\n    cwe1284 -->|CHILDOF| cwe20\n\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe410 primary\n    class cwe770,cwe20 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **network connectivity issues** or aggressive timeouts. This leads to `CLIENT SETINFO` timing out, resulting in out-of-order responses. With the default connection pool, this leads to the connection being discarded. For sticky connections and pipelines, this leads to persistent incorrect responses.\n\n## Summary of Analysis\nThe primary assessment is based on the vulnerability description and the CVE reference links content summary. The **rootcause** is network connectivity issues and aggressive timeouts, leading to `CLIENT SETINFO` timing out. This leads to out-of-order responses. The CVE reference links content summary confirms this. The vulnerability can be prevented by setting `DisableIndentity` to `true`.\n\nCWE-410 (Insufficient Resource Pool) is chosen as the primary CWE because the issue stems from a timing out issue which prevents the server from allocating resources correctly. The \"Insufficient Resource Pool\" is a better fit than any of the others.\n\nCWE-770 (Allocation of Resources Without Limits or Throttling) was considered because of the potential for resource exhaustion if the client retries the connection frequently, but it is not the main issue.\n\nCWE-20 (Improper Input Validation) was mentioned in the CVE Reference Links content summary. It is related because the `CLIENT SETINFO` command is timing out, leading to invalid state and out-of-order responses, but it's a less direct cause.\n\nThe selected CWEs are at the optimal level of specificity because CWE-410 addresses the timing issue preventing resource allocation. CWE-770 and CWE-20 are contributing factors or higher-level classifications.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n**Chain starting from CWE-770:**\n- 770 (Allocation of Resources Without Limits or Throttling) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 955.8927671387216
    },
    {
      "metadata": {
        "doc_id": "125",
        "name": "Out-of-bounds Read",
        "source": "sparse"
      },
      "similarity": 922.9400467305269
    },
    {
      "metadata": {
        "doc_id": "190",
        "name": "Integer Overflow or Wraparound",
        "source": "sparse"
      },
      "similarity": 919.9923388286268
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse"
      },
      "similarity": 913.1756683347103
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 912.4871421300296
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 905.9750211123574
    },
    {
      "metadata": {
        "doc_id": "295",
        "name": "Improper Certificate Validation",
        "source": "sparse"
      },
      "similarity": 902.2254546301092
    },
    {
      "metadata": {
        "doc_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "source": "sparse"
      },
      "similarity": 896.0080952721996
    },
    {
      "metadata": {
        "doc_id": "410",
        "name": "Insufficient Resource Pool",
        "type": "Base",
        "original_content": "The product's resource pool is not large enough to handle peak demand, which allows an attacker to prevent others from accessing the resource by using a (relatively) large number of requests for resources.",
        "keyphrase_source": "rootcause:Network connectivity issues",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.3668063376936616,
            "graph": 1.9909344071686443
          }
        }
      },
      "similarity": 0.3668063376936616
    },
    {
      "doc_id": "789",
      "text": "CWE-789: Memory Allocation with Excessive Size Value",
      "score": 2.7336,
      "metadata": {
        "doc_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "type": "variant",
        "original_content": "CWE-789: Memory Allocation with Excessive Size Value",
        "relationships": [
          {
            "source_id": "789",
            "target_id": "129",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "1284",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "476",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "770",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "770",
            "target_id": "789",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "476",
            "target_id": "789",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1325",
            "target_id": "789",
            "label": "PEEROF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "129",
            "target_id": "789",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1284",
            "target_id": "789",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 0.7,
          "abstraction_path": 0.76,
          "sequence_path": 0.7200000000000001,
          "peer_group": 0.9
        },
        "abstraction_factor": 1.2,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "vulnerability_sequence_forward",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "1325",
                  "789",
                  "PEEROF"
                ]
              ],
              "score": 0.7,
              "type": "relationship_chain",
              "source": "1325"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "770",
                  "789",
                  "PARENTOF"
                ]
              ],
              "score": 0.76,
              "type": "abstraction_path_down",
              "source": "770"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "1325",
                  "476",
                  "CANPRECEDE"
                ],
                [
                  "476",
                  "789",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.7200000000000001,
              "type": "vulnerability_sequence_forward",
              "source": "1325"
            },
            "peer_relationship": {
              "path": [
                [
                  "1325",
                  "789",
                  "PEEROF"
                ]
              ],
              "score": 0.9,
              "type": "peer_relationship",
              "source": "1325"
            }
          }
        },
        "abstraction_level": "variant",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.7336
          }
        }
      },
      "similarity": 2.7336
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-400",
      "CWE-770",
      "CWE-410",
      "CWE-20",
      "CWE-1325"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}