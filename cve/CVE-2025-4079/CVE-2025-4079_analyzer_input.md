# Vulnerability Information: CVE-2025-4079

## Vulnerability Description
A vulnerability, which was classified as critical, was found in PCMan FTP Server up to 2.0.7. Affected is an unknown function of the component RENAME Command Handler. The manipulation leads to **buffer overflow**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** up to 2.0.7
- **component:** unknown function of the component RENAME Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-4079 Content

This content **RELATES** to a vulnerability in PCMan FTP Server, specifically a remote buffer overflow in the `RENAME` command. It provides a detailed exploit script.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the `RENAME` command handling of PCMan FTP Server version 2.0.7. The server does not properly validate the length of the input provided in the `RENAME` command, allowing an attacker to send a string longer than the allocated buffer.

**Weaknesses/vulnerabilities present:**

*   Buffer Overflow
*   Improper Input Validation

**Impact of exploitation:**

Successful exploitation allows the attacker to overwrite the execution flow of the program, potentially leading to arbitrary code execution on the target system. The exploit script aims to redirect execution to a shellcode payload.

**Attack vectors:**

*   Remote: The vulnerability can be exploited remotely via the FTP protocol.
*   Specifically, sending a crafted `RENAME` command to the FTP server.

**Required attacker capabilities/position:**

*   Network access to the target FTP server on port 21.
*   Ability to send crafted FTP commands.

**Mitigation or fix:**

The content does not provide information about a specific fix. However, the root cause suggests that proper input validation and buffer size checks in the `RENAME` command handling would mitigate the vulnerability. Updating to a patched version of PCMan FTP Server is recommended.

**Technical Details & Exploit Information:**

*   **Affected Software:** PCMan FTP Server 2.0.7
*   **Tested on:** Windows XP SP3 (Version 5.1 Build 2600)
*   **Offset:** 2004 bytes
*   **EIP overwrite:** `0x74e32fd9` (JMP ESP)
*   **Bad characters:** `\x00\x0a\x0d`
*   **Payload:** The script constructs a payload containing:
    *   A large string of 'A' characters to fill the buffer.
    *   The address of a `JMP ESP` instruction to redirect execution to the shellcode.
    *   NOP sled (`\x90`x20) to increase the chances of landing in the shellcode.
    *   Shellcode (generated using `msfvenom`) to establish a reverse TCP shell.
*   **Exploit Steps:**
    1.  Connect to the FTP server.
    2.  Authenticate as an anonymous user.
    3.  Send the crafted `RENAME` command containing the overflow payload.
    4.  Close the connection.

**Note:** This content provides more detail than a typical CVE description, including the specific offset, EIP address, and a complete exploit script.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.393 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.378 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.344 |
| 7 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.332 |
| 8 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.325 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.585 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

