# Raw Retriever Results for CVE-2025-46720

# Raw Retriever Results for CVE-2025-46720
## Query
Keystone is a content management system for Node.js. Prior to version 6.5.0, `{field}.isFilterable` access control can be bypassed in `update` and `delete` mutations by adding additional unique filters. These filters can be used as an oracle to probe the existence or value of otherwise unreadable fields. Specifically, when a mutation includes a `where` clause with multiple unique filters (e.g. `id` and `email`), Keystone will attempt to match records even if filtering by the latter fields would normally be rejected by `field.isFilterable` or `list.defaultIsFilterable`. This can allow malicious actors to infer the presence of a particular field value when a filter is successful in returning a result. This affects any project relying on the default or dynamic `isFilterable` behavior (at the list or field level) to prevent external users from using the filtering of fields as a discovery mechanism. While this access control is respected during `findMany` operations, it was not completely enforced during `update` and `delete` mutations when accepting more than one unique `where` values in filters. This has no impact on projects using `isFilterable false` or `defaultIsFilterable false` for sensitive fields, or for those who have otherwise omitted filtering by these fields from their GraphQL schema. This issue has been patched in `@keystone-6/core` version 6.5.0. To mitigate this issue in older versions where patching is not a viable pathway, set `isFilterable false` statically for relevant fields to prevent filtering by them earlier in the access control pipeline (that is, dont use functions) set `{field}.graphql.omit.read true` for relevant fields, which implicitly removes filtering by these fields from the GraphQL schema and/or deny `update` and `delete` operations for the relevant lists completely.

## Keyphrases
- **rootcause**: 'bypass Keystone access control by adding additional unique filters'
- **weakness**: 'access control bypass'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4128 | 0.4763 | 0.4425 | 0.4486 | 20 |
| Sparse | 1340.0275 | 1502.3254 | 1375.7548 | 1355.8510 | 10 |
| Graph | 1.5803 | 4.3290 | 1.9912 | 1.7262 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 4.3290 | Allowed |
| 2 | 184 | Incomplete List of Disallowed Inputs | Base | 2.7929 | Allowed |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | base | 2.2100 | Allowed |
| 4 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 5 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 2.2100 | Allowed |
| 6 | 86 | Improper Neutralization of Invalid Characters in Identifiers in Web Pages | variant | 2.0424 | Allowed |
| 7 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 8 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | base | 1.7680 | Allowed-with-Review |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.7556 | Allowed |
| 11 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.6968 | Allowed |
| 12 | 425 | Direct Request ('Forced Browsing') | base | 1.6848 | Allowed |
| 13 | 73 | External Control of File Name or Path | base | 1.6848 | Allowed |
| 14 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6748 | Allowed |
| 15 | 321 | Use of Hard-coded Cryptographic Key | variant | 1.6320 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.4763 | 0.4763 | Allowed |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4639 | 0.4639 | Allowed |
| 3 | 863 | Incorrect Authorization | Class | 0.4622 | 0.4622 | Allowed-with-Review |
| 4 | 791 | Incomplete Filtering of Special Elements | Base | 0.4617 | 0.4617 | Allowed |
| 5 | 184 | Incomplete List of Disallowed Inputs | Base | 0.4602 | 0.4602 | Allowed |
| 6 | 202 | Exposure of Sensitive Information Through Data Queries | Base | 0.4573 | 0.4573 | Allowed |
| 7 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | 0.4547 | 0.4547 | Allowed-with-Review |
| 8 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | 0.4536 | 0.4536 | Allowed |
| 9 | 566 | Authorization Bypass Through User-Controlled SQL Primary Key | Variant | 0.4532 | 0.4532 | Allowed |
| 10 | 277 | Insecure Inherited Permissions | Variant | 0.4517 | 0.4517 | Allowed |
| 11 | 795 | Only Filtering Special Elements at a Specified Location | Base | 0.4455 | 0.4455 | Allowed |
| 12 | 792 | Incomplete Filtering of One or More Instances of Special Elements | Variant | 0.4437 | 0.4437 | Allowed |
| 13 | 181 | Incorrect Behavior Order: Validate Before Filter | Variant | 0.4335 | 0.4335 | Allowed |
| 14 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.4254 | 0.4254 | Allowed |
| 15 | 183 | Permissive List of Allowed Inputs | Base | 0.4225 | 0.4225 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 1502.3254 | 1502.3254 | Allowed-with-Review |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1410.5202 | 1410.5202 | Allowed |
| 3 | 472 | External Control of Assumed-Immutable Web Parameter | 1381.6074 | 1381.6074 | Allowed |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | 1371.0456 | 1371.0456 | Allowed |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | 1362.3179 | 1362.3179 | Allowed |
| 6 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | 1349.3842 | 1349.3842 | Discouraged |
| 7 | 285 | Improper Authorization | 1347.9514 | 1347.9514 | Discouraged |
| 8 | 862 | Missing Authorization | 1346.4770 | 1346.4770 | Allowed-with-Review |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 1345.8912 | 1345.8912 | Allowed |
| 10 | 918 | Server-Side Request Forgery (SSRF) | 1340.0275 | 1340.0275 | Allowed |
