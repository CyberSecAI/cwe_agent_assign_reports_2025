{
  "query": "Keystone is a content management system for Node.js. Prior to version 6.5.0, `{field}.isFilterable` access control can be bypassed in `update` and `delete` mutations by adding additional unique filters. These filters can be used as an oracle to probe the existence or value of otherwise unreadable fields. Specifically, when a mutation includes a `where` clause with multiple unique filters (e.g. `id` and `email`), Keystone will attempt to match records even if filtering by the latter fields would normally be rejected by `field.isFilterable` or `list.defaultIsFilterable`. This can allow malicious actors to infer the presence of a particular field value when a filter is successful in returning a result. This affects any project relying on the default or dynamic `isFilterable` behavior (at the list or field level) to prevent external users from using the filtering of fields as a discovery mechanism. While this access control is respected during `findMany` operations, it was not completely enforced during `update` and `delete` mutations when accepting more than one unique `where` values in filters. This has no impact on projects using `isFilterable false` or `defaultIsFilterable false` for sensitive fields, or for those who have otherwise omitted filtering by these fields from their GraphQL schema. This issue has been patched in `@keystone-6/core` version 6.5.0. To mitigate this issue in older versions where patching is not a viable pathway, set `isFilterable false` statically for relevant fields to prevent filtering by them earlier in the access control pipeline (that is, dont use functions) set `{field}.graphql.omit.read true` for relevant fields, which implicitly removes filtering by these fields from the GraphQL schema and/or deny `update` and `delete` operations for the relevant lists completely.",
  "count": 20,
  "results": [
    {
      "cwe_id": "612",
      "name": "Improper Authorization of Index Containing Sensitive Information",
      "abstraction": "Base",
      "score": 0.4763293669906463,
      "original_score": 0.4763293669906463,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "abstraction": "Base",
      "score": 0.46391837288439647,
      "original_score": 0.46391837288439647,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "abstraction": "Class",
      "score": 0.46215806321969555,
      "original_score": 0.46215806321969555,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "791",
      "name": "Incomplete Filtering of Special Elements",
      "abstraction": "Base",
      "score": 0.4616678037283829,
      "original_score": 0.4616678037283829,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "184",
      "name": "Incomplete List of Disallowed Inputs",
      "abstraction": "Base",
      "score": 0.460178514042292,
      "original_score": 0.460178514042292,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "202",
      "name": "Exposure of Sensitive Information Through Data Queries",
      "abstraction": "Base",
      "score": 0.45733246842441877,
      "original_score": 0.45733246842441877,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "943",
      "name": "Improper Neutralization of Special Elements in Data Query Logic",
      "abstraction": "Class",
      "score": 0.45472567107330797,
      "original_score": 0.45472567107330797,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1321",
      "name": "Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')",
      "abstraction": "Variant",
      "score": 0.45363963784578354,
      "original_score": 0.45363963784578354,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "566",
      "name": "Authorization Bypass Through User-Controlled SQL Primary Key",
      "abstraction": "Variant",
      "score": 0.45318704003390076,
      "original_score": 0.45318704003390076,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "277",
      "name": "Insecure Inherited Permissions",
      "abstraction": "Variant",
      "score": 0.4517072224102297,
      "original_score": 0.4517072224102297,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "795",
      "name": "Only Filtering Special Elements at a Specified Location",
      "abstraction": "Base",
      "score": 0.4455492674634711,
      "original_score": 0.4455492674634711,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "792",
      "name": "Incomplete Filtering of One or More Instances of Special Elements",
      "abstraction": "Variant",
      "score": 0.443689550971039,
      "original_score": 0.443689550971039,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "181",
      "name": "Incorrect Behavior Order: Validate Before Filter",
      "abstraction": "Variant",
      "score": 0.43350342883261567,
      "original_score": 0.43350342883261567,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "abstraction": "Base",
      "score": 0.42542137291467624,
      "original_score": 0.42542137291467624,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "183",
      "name": "Permissive List of Allowed Inputs",
      "abstraction": "Base",
      "score": 0.42250597555267244,
      "original_score": 0.42250597555267244,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "794",
      "name": "Incomplete Filtering of Multiple Instances of Special Elements",
      "abstraction": "Variant",
      "score": 0.4214162539896878,
      "original_score": 0.4214162539896878,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "471",
      "name": "Modification of Assumed-Immutable Data (MAID)",
      "abstraction": "Base",
      "score": 0.4212403339994844,
      "original_score": 0.4212403339994844,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "359",
      "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      "abstraction": "Base",
      "score": 0.4150378543233676,
      "original_score": 0.4150378543233676,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "807",
      "name": "Reliance on Untrusted Inputs in a Security Decision",
      "abstraction": "Base",
      "score": 0.41427758029701645,
      "original_score": 0.41427758029701645,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "285",
      "name": "Improper Authorization",
      "abstraction": "Class",
      "score": 0.4128217970653354,
      "original_score": 0.4128217970653354,
      "mapping_usage": "Discouraged"
    }
  ],
  "statistics": {
    "min": 0.4128217970653354,
    "max": 0.4763293669906463,
    "mean": 0.442515378803121,
    "median": 0.4486282449368504,
    "count": 20
  }
}