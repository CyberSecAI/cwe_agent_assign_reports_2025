# Vulnerability Information: CVE-2024-12329

## Vulnerability Description
The Essential Real Estate plugin for WordPress is vulnerable to unauthorized access of data due to a **missing capability check** on several pages/post types in all versions up to, and including, 5.1.6. This makes it possible for authenticated attackers, with Contributor-level access and above, to access invoices and transaction logs

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **impact:** unauthorized access of data
- **attacker:** authenticated attackers with Contributor-level access and above
- **product:** Essential Real Estate plugin for WordPress
- **version:** up to and including 5.1.6

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-12329:

**Root Cause of Vulnerability:**
The vulnerability stems from a missing capability check on several pages and post types within the Essential Real Estate plugin. Specifically, it affects the "trans_log", "invoice", and "user_package" post types. This lack of authorization allows authenticated users, even with low-level access, to view sensitive information they should not have access to.

**Weaknesses/Vulnerabilities Present:**
- **Missing Authorization:** The primary weakness is the absence of proper authorization checks, meaning that the plugin does not verify if a user has the necessary permissions before allowing access to certain data.
- **Information Exposure:** The vulnerability leads to the exposure of sensitive information such as invoices and transaction logs.

**Impact of Exploitation:**
An attacker with Contributor-level access or higher can view sensitive information like invoices and transaction logs. This could lead to:
    - Exposure of financial data.
    - Potential business intelligence leaks
    - Privacy breaches.

**Attack Vectors:**
- The attack vector is through HTTP requests to specific pages or post types related to "trans\_log", "invoice", and "user\_package" post types within the WordPress plugin.

**Required Attacker Capabilities/Position:**
- The attacker must be an authenticated user with at least Contributor-level access to the WordPress site. This implies that the attacker needs an account on the WordPress site.

**Additional Notes**
- The vulnerability affects all versions of the Essential Real Estate plugin up to and including version 5.1.6.
- The vulnerability was addressed in version 5.1.7 by implementing proper capability checks.
- The changeset information shows the code changes made to add `'capability_type'` and to comment out the lines which contained the capability getters.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.402 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.384 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.377 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.353 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.350 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.347 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.323 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.319 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.531 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |

