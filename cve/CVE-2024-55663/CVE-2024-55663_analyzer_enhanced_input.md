## Vulnerability Description
XWiki Platform is a generic wiki platform. Starting in version 11.10.6 and prior to versions 13.10.5 and 14.3-rc-1, in `getdocument.vm` the ordering of the returned documents is defined from an **unsanitized request parameter** (request.sort) and can allow any user to inject HQL. Depending on the used database backend, the attacker may be able to not only obtain confidential information such as password hashes from the database, but also execute UPDATE/INSERT/DELETE queries. This has been patched in 13.10.5 and 14.3-rc-1. There is no known workaround, other than upgrading XWiki.

### Vulnerability Description Key Phrases
- **rootcause:** **unsanitized request parameter**
- **impact:** obtain confidential information and execute UPDATE/INSERT/DELETE queries
- **attacker:** any user
- **product:** XWiki Platform
- **version:** 11.10.6 to 13.10.5 and 14.3-rc-1
- **component:** getdocument.vm

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-55663

**Root Cause of Vulnerability:**
The vulnerability stems from the `getdocuments.vm` template in XWiki, where the ordering of returned documents is determined by an unsanitized request parameter (`request.sort`). This allows an attacker to inject Hibernate Query Language (HQL) through this parameter.

**Weaknesses/Vulnerabilities Present:**
- **HQL Injection:** The primary vulnerability is the ability to inject arbitrary HQL code due to the lack of sanitization of the `request.sort` parameter.
- **Unsanitized Input:** The `sort` parameter is directly used to construct the HQL query, creating the injection point.

**Impact of Exploitation:**
- **Information Disclosure:** Attackers can potentially extract sensitive information from the database, such as password hashes.
- **Data Manipulation:** Attackers may be able to perform `UPDATE`, `INSERT`, and `DELETE` queries, thereby modifying or corrupting data.
- **Potential for complete system compromise**: By breaking out of the HQL context, attackers might achieve more significant control over the underlying database system.

**Attack Vectors:**
- The attack vector is network-based.
- The vulnerability is triggered by sending a crafted request to the `getdocuments.vm` template with a malicious `sort` parameter.

**Required Attacker Capabilities/Position:**
- **No special privileges required:** The vulnerability can be exploited by any user, with no prior authentication needed.
- **No user interaction required**: The attack can be executed solely by the attacker.
- **Network access** An attacker needs network access to the vulnerable XWiki instance.

**Additional Details:**

*   The vulnerability is present in XWiki versions 6.3-milestone-2 and later, and was patched in versions 13.10.5 and 14.3-rc-1.
*   The fix involved adding a regex check to validate the `sort` parameter, preventing HQL injection.
*   The vulnerability is considered critical, as the impact includes high confidentiality, integrity, and availability risks.
* The fix is implemented in commit `673076e2e8b88a36cdeaf7007843aa9ca1a068a0`.
* The vulnerability is assigned CWE-116, which relates to improper encoding of output.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.670 |
| 2 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | sparse | 0.634 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.598 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.595 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.591 |
| 6 | 552 | Files or Directories Accessible to External Parties | Base | Allowed | sparse | 0.590 |
| 7 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.579 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.569 |
| 9 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | dense | 0.525 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-116: Improper Encoding or Escaping of Output

CWE-202: Exposure of Sensitive Information Through Data Queries

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-863: Incorrect Authorization

CWE-552: Files or Directories Accessible to External Parties

CWE-328: Use of Weak Hash

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-226: Sensitive Information in Resource Not Removed Before Reuse