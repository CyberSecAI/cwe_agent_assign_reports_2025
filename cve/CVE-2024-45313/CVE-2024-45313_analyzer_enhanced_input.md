## Vulnerability Description
Overleaf is a web-based collaborative LaTeX editor. When installing Server Pro using the Overleaf Toolkit from before 2024-07-17 or legacy docker-compose.yml from before 2024-08-28, the configuration for LaTeX compiles was insecure by default, requiring the administrator to enable the security features via a configuration setting (`SIBLING_CONTAINERS_ENABLED` in Toolkit, `SANDBOXED_COMPILES` in legacy docker-compose/custom deployments). If these security features are not enabled then users have access to the `sharelatex` container resources (filesystem, network, environment variables) when running compiles, leading to **multiple file access vulnerabilities**, either directly or via symlinks created during compiles. The setting has now been changed to be secure by default for new installs in the Toolkit and legacy docker-compose deployment. The Overleaf Toolkit has been updated to set `SIBLING_CONTAINERS_ENABLED=true` by default for new installs. It is recommended that any existing installations using the previous default setting migrate to using sibling containers. Existing installations can set `SIBLING_CONTAINERS_ENABLED=true` in `config/overleaf.rc` as a mitigation. In legacy docker-compose/custom deployments `SANDBOXED_COMPILES=true` should be used.

### Vulnerability Description Key Phrases
- **rootcause:** **insecure default configuration**
- **weakness:** **multiple file access vulnerabilities**
- **impact:** access to sharelatex container resources
- **product:** Overleaf
- **component:** Server Pro and LaTeX compiles

## CVE Reference Links Content Summary
```
{
  "CVE-2024-45313": {
    "related": true,
    "summary": "Insecure default setting for Server Pro installed via Overleaf toolkit before 2024-07-17 and docker-compose before 2024-08-28",
    "details": {
      "root_cause": "The default configuration for LaTeX compiles in Overleaf Server Pro installations prior to the specified dates was insecure. Specifically, the `SIBLING_CONTAINERS_ENABLED` setting in the Overleaf Toolkit and the `SANDBOXED_COMPILES` setting in legacy docker-compose deployments were not enabled by default.",
      "vulnerabilities": [
        "When these settings are not enabled, users have access to the `sharelatex` container resources (filesystem, network, environment variables) during compiles.",
        "This allows for multiple file access vulnerabilities either directly or via symlinks created during compiles.",
         "CWE-284: Improper Access Control",
         "CWE-1188: Insecure Default Configuration"
      ],
      "impact": "Users can access the `sharelatex` container resources (filesystem, network, environment variables) when running compiles leading to file access vulnerabilities.",
      "attack_vectors": [
        "Direct file access",
        "File access via symlinks created during compiles"
      ],
      "attacker_capabilities": "An attacker needs to be a user with the ability to run LaTeX compiles on an affected Overleaf instance with the insecure settings."
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.876 |
| 2 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.819 |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.796 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.785 |
| 5 | 277 | Insecure Inherited Permissions | Variant | Allowed | sparse | 0.784 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.766 |
| 7 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.762 |
| 8 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.754 |
| 9 | 552 | Files or Directories Accessible to External Parties | Base | Allowed | dense | 0.423 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1188: Initialization of a Resource with an Insecure Default

CWE-306: Missing Authentication for Critical Function

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-277: Insecure Inherited Permissions

CWE-863: Incorrect Authorization

CWE-918: Server-Side Request Forgery (SSRF)

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-552: Files or Directories Accessible to External Parties

CWE-226: Sensitive Information in Resource Not Removed Before Reuse