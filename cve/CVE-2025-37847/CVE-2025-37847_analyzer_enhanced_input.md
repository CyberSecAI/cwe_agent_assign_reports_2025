## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved accel/ivpu Fix **deadlock** in ivpu_ms_cleanup() Fix **deadlock** in ivpu_ms_cleanup() by preventing runtime resume after file_priv->ms_lock is acquired. During a failure in runtime resume, a cold boot is executed, which calls ivpu_ms_cleanup_all(). This function calls ivpu_ms_cleanup() that acquires file_priv->ms_lock and causes the **deadlock**.

### Vulnerability Description Key Phrases
- **rootcause:** **deadlock**
- **product:** Linux kernel
- **component:** accel/ivpu

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.358 |
| 2 | 833 | Deadlock | Base | Allowed | sparse | 0.345 |
| 3 | 663 | Use of a Non-reentrant Function in a Concurrent Context | Base | Allowed | sparse | 0.271 |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.236 |
| 5 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.235 |
| 6 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.234 |
| 7 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.234 |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.231 |
| 9 | 413 | Improper Resource Locking | Base | Allowed | dense | 0.486 |
| 10 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-667: Improper Locking

CWE-833: Deadlock

CWE-663: Use of a Non-reentrant Function in a Concurrent Context

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-835: Loop with Unreachable Exit Condition ('Infinite Loop')

CWE-203: Observable Discrepancy

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-413: Improper Resource Locking

CWE-1265: Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls