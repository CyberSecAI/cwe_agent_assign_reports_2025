## Vulnerability Description
A vulnerability, which was classified as critical, has been found in PHPGurukul Complaint Management System 1.0. Affected by this issue is some unknown functionality of the file /admin/subcategory.php. The manipulation of the argument category leads to **sql injection**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** PHPGurukul Complaint Management System
- **version:** 1
- **component:** /admin/subcategory.php

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

*   The root cause is a SQL injection vulnerability in the `/admin/subcategory.php` file of the "Complaint Management system" project.
*   The vulnerability arises because the application directly uses the `category` parameter in SQL queries without proper sanitization or validation.

**Weaknesses/Vulnerabilities:**

*   **SQL Injection:** The primary vulnerability is SQL injection. The application fails to sanitize user-supplied input (`category` parameter) before using it in a database query.

**Impact of Exploitation:**

*   **Unauthorized Database Access:** Attackers can gain unauthorized access to the database.
*   **Sensitive Data Leakage:** Attackers can extract sensitive data from the database.
*   **Data Tampering:** Attackers can modify or delete data in the database.
*   **Comprehensive System Control:** In severe cases, an attacker could potentially gain control over the system.
*   **Service Interruption:** Attackers could cause a denial of service by manipulating the database.

**Attack Vectors:**

*   **HTTP POST Request:** The attack vector is an HTTP POST request targeting the `/admin/subcategory.php` file.
*   **Malicious `category` Parameter:** The attacker injects malicious SQL code via the `category` parameter in the POST data.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker requires network access to the vulnerable application.
*   **No Authentication Required**: The vulnerability can be exploited without any login or authorization.

**Technical Details:**

*   **Vulnerable File:** `/admin/subcategory.php`
*   **Vulnerable Parameter:** `category` (POST)
*   **Payload Example:** `category=1' AND (SELECT 7153 FROM (SELECT(SLEEP(5)))whkQ) AND 'yguz'='yguz&subcategory=111&submit=`
*   **Exploitation Tool:** The provided content references the use of `sqlmap` for exploitation.

**Mitigation:**

*   **Prepared Statements:** Use prepared statements with parameter binding to separate SQL code from user input.
*   **Input Validation:** Implement strict validation and filtering of user input.
*   **Principle of Least Privilege:** Grant database users minimal necessary permissions.
*   **Regular Security Audits:** Conduct regular security audits to identify and fix vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.425 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.362 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.347 |
| 5 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.332 |
| 6 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.329 |
| 7 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.328 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.321 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.598 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-117: Improper Output Neutralization for Logs

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-306: Missing Authentication for Critical Function

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-73: External Control of File Name or Path