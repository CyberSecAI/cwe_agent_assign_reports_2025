{
  "cve_id": "CVE-2025-46820",
  "description": "phpgt/Dom provides access to modern DOM APIs. Versions of phpgt/Dom prior to 4.1.8 expose the GITHUB_TOKEN in the Dom workflow run artifact. The ci.yml workflow file uses actions/upload-artifact@v4 to upload the build artifact. This artifact is a zip of the current directory, which includes the automatically generated .git/config file containing the runs GITHUB_TOKEN. Seeing as the artifact can be downloaded prior to the end of the workflow, there is a few seconds where an attacker can extract the token from the artifact and use it with the GitHub API to push malicious code or rewrite release commits in your repository. Any downstream user of the repository may be affected, but the token should only be valid for the duration of the workflow run, limiting the time during which exploitation could occur. Version 4.1.8 fixes the issue.",
  "key_phrases": {
    "component": "Dom workflow run artifact",
    "rootcause": "",
    "vector": "",
    "weakness": "GITHUB_TOKEN exposure",
    "product": "phpgt/Dom",
    "impact": "['push malicious code', 'rewrite release commits']",
    "attacker": "",
    "version": "prior to 4.1.8"
  },
  "reference_content": "## Analysis of CVE-2025-46820 based on provided content\n\nThe provided content is directly related to CVE-2025-46820. It details a vulnerability in the phpgt/Dom project, specifically regarding the potential leakage of the `GITHUB_TOKEN` during workflow runs.\n\n**Root cause of vulnerability:**\n\nThe vulnerability stems from including the `.git/config` file (which contains the `GITHUB_TOKEN`) when archiving the build artifact using `actions/upload-artifact@v4`. This file is automatically generated by GitHub for workflow authentication.\n\n**Weaknesses/vulnerabilities present:**\n\n*   Insecure artifact creation: Archiving the entire working directory, including sensitive files like `.git/config`.\n*   Exposure of secrets: The `GITHUB_TOKEN` is a secret that, if compromised, can allow an attacker to perform actions on behalf of the repository owner.\n\n**Impact of exploitation:**\n\nAn attacker who gains access to the `GITHUB_TOKEN` can:\n\n*   Push malicious code to the repository.\n*   Rewrite release commits, potentially injecting backdoors into released software.\n\n**Attack vectors:**\n\n*   Monitoring workflow runs and downloading the artifact before it's cleaned up.\n*   Extracting the `GITHUB_TOKEN` from the `.git/config` file within the downloaded artifact.\n\n**Required attacker capabilities/position:**\n\n*   Ability to monitor GitHub workflow runs.\n*   Ability to download workflow artifacts.\n*   Basic understanding of the GitHub API and how to use the `GITHUB_TOKEN`.\n\n**Mitigation or fix:**\n\nThe commit message (205cddc) details the following fixes:\n\n*   Excluding the `.git` directory from the archived build artifact using `--exclude=\".git\"` in the `tar` command.\n*   Restricting token permissions.\n*   Deleting old artifacts that start with \"build-artifact\".\n*   Opening action permission only on the remove artifact job.\n*   Adding permissions to the workflow file to restrict access.\n\n**Additional Details (more than official CVE description):**\n\n*   The CVSS score is calculated as 7.1/10.\n*   CVSS v3 base metrics are provided: AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:H/A:H\n*   The vulnerability was reported by @jackhac and @nopcorn.\n*   The patched version is 4.1.8.\n*   The affected versions are <4.1.8.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-214 | Invocation of Process Using Visible Sensitive Information | 0.9 | Base | Allowed | Primary CWE: The root cause is the exposure of the GITHUB_TOKEN due to it being included in the artifact. |\n| CWE-201 | Insertion of Sensitive Information Into Sent Data | 0.7 | Base | Allowed | Secondary Candidate: The **GITHUB_TOKEN** is sent to the artifact which is transferred. |\n| CWE-538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | 0.7 | Base | Allowed | Secondary Candidate: The **GITHUB_TOKEN** is inserted into a file in a directory that is made externally accessible. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-214, which identifies the core issue of exposing sensitive information in a process. CWE-201 and CWE-538 are related in that they describe the sensitive information being sent or stored in an externally accessible location, leading to potential compromise. The abstraction levels are base, reflecting a detailed and specific mapping of the vulnerability.\n\n```mermaid\ngraph TD\n    cwe214[\"CWE-214: Invocation of Process Using Visible Sensitive Information\"]\n    cwe201[\"CWE-201: Insertion of Sensitive Information Into Sent Data\"]\n    cwe538[\"CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory\"]\n    \n    cwe201 -->|PEEROF| cwe538\n    cwe214 -->|CANPRECEDE| cwe201\n    cwe214 -->|CANPRECEDE| cwe538\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe214 primary\n    class cwe201,cwe538 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **GITHUB_TOKEN exposure** (CWE-214) due to the inclusion of the `.git/config` file in the artifact. This leads to the sensitive information being sent (CWE-201) and stored externally (CWE-538). The final impact is the potential for an attacker to push malicious code or rewrite release commits.\n\n## Summary of Analysis\nThe analysis identified the primary weakness as the **GITHUB_TOKEN exposure** in the Dom workflow run artifact. The assessment is based on the provided evidence, including the vulnerability description and CVE reference summary, which highlight the root cause and impact. The graph relationships show how the weaknesses are connected, with CWE-214 leading to CWE-201 and CWE-538. The selected CWEs are at the optimal level of specificity, accurately reflecting the vulnerability's characteristics.\n\nThe vulnerability description states, \"Versions of phpgt/Dom prior to 4.1.8 expose the GITHUB_TOKEN in the Dom workflow run artifact.\" This directly supports the selection of CWE-214 as the primary weakness. The description also mentions that the artifact is uploaded, suggesting the potential for external access, which is related to CWE-538.\n\nOther CWEs Considered:\n\n*   CWE-79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')): This CWE is not relevant because the vulnerability does not involve improper neutralization of input.\n*   CWE-59 (Improper Link Resolution Before File Access ('Link Following')): This CWE is not relevant because the vulnerability does not involve symbolic links or file access issues.\n*   CWE-434 (Unrestricted Upload of File with Dangerous Type): This CWE is not relevant because the vulnerability is not related to uploading dangerous file types.\n*   CWE-78 (Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')): This CWE is not relevant because the vulnerability does not involve OS command injection.",
  "analysis_with_relationships": "# Summary\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-214 | Invocation of Process Using Visible Sensitive Information | 0.9 | Base | Allowed | Primary CWE: The root cause is the exposure of the GITHUB_TOKEN due to it being included in the artifact. |\n| CWE-201 | Insertion of Sensitive Information Into Sent Data | 0.7 | Base | Allowed | Secondary Candidate: The **GITHUB_TOKEN** is sent to the artifact which is transferred. |\n| CWE-538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | 0.7 | Base | Allowed | Secondary Candidate: The **GITHUB_TOKEN** is inserted into a file in a directory that is made externally accessible. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-214, which identifies the core issue of exposing sensitive information in a process. CWE-201 and CWE-538 are related in that they describe the sensitive information being sent or stored in an externally accessible location, leading to potential compromise. The abstraction levels are base, reflecting a detailed and specific mapping of the vulnerability.\n\n```mermaid\ngraph TD\n    cwe214[\"CWE-214: Invocation of Process Using Visible Sensitive Information\"]\n    cwe201[\"CWE-201: Insertion of Sensitive Information Into Sent Data\"]\n    cwe538[\"CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory\"]\n    \n    cwe201 -->|PEEROF| cwe538\n    cwe214 -->|CANPRECEDE| cwe201\n    cwe214 -->|CANPRECEDE| cwe538\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe214 primary\n    class cwe201,cwe538 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **GITHUB_TOKEN exposure** (CWE-214) due to the inclusion of the `.git/config` file in the artifact. This leads to the sensitive information being sent (CWE-201) and stored externally (CWE-538). The final impact is the potential for an attacker to push malicious code or rewrite release commits.\n\n## Summary of Analysis\nThe analysis identified the primary weakness as the **GITHUB_TOKEN exposure** in the Dom workflow run artifact. The assessment is based on the provided evidence, including the vulnerability description and CVE reference summary, which highlight the root cause and impact. The graph relationships show how the weaknesses are connected, with CWE-214 leading to CWE-201 and CWE-538. The selected CWEs are at the optimal level of specificity, accurately reflecting the vulnerability's characteristics.\n\nThe vulnerability description states, \"Versions of phpgt/Dom prior to 4.1.8 expose the GITHUB_TOKEN in the Dom workflow run artifact.\" This directly supports the selection of CWE-214 as the primary weakness. The description also mentions that the artifact is uploaded, suggesting the potential for external access, which is related to CWE-538.\n\nOther CWEs Considered:\n\n*   CWE-79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')): This CWE is not relevant because the vulnerability does not involve improper neutralization of input.\n*   CWE-59 (Improper Link Resolution Before File Access ('Link Following')): This CWE is not relevant because the vulnerability does not involve symbolic links or file access issues.\n*   CWE-434 (Unrestricted Upload of File with Dangerous Type): This CWE is not relevant because the vulnerability is not related to uploading dangerous file types.\n*   CWE-78 (Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')): This CWE is not relevant because the vulnerability does not involve OS command injection.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-59:**\n- 59 (Improper Link Resolution Before File Access ('Link Following')) - ROOT\n\n\n**Chain starting from CWE-79:**\n- 79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 777.9822966990172
    },
    {
      "metadata": {
        "doc_id": "214",
        "name": "Invocation of Process Using Visible Sensitive Information",
        "source": "sparse"
      },
      "similarity": 760.9973537355735
    },
    {
      "metadata": {
        "doc_id": "59",
        "name": "Improper Link Resolution Before File Access ('Link Following')",
        "source": "sparse"
      },
      "similarity": 748.3798412828586
    },
    {
      "metadata": {
        "doc_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "source": "sparse"
      },
      "similarity": 723.352506644353
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 715.7628477582418
    },
    {
      "metadata": {
        "doc_id": "427",
        "name": "Uncontrolled Search Path Element",
        "source": "sparse"
      },
      "similarity": 712.8638684873564
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse"
      },
      "similarity": 710.5393457624964
    },
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "sparse"
      },
      "similarity": 709.7959932481979
    },
    {
      "metadata": {
        "doc_id": "88",
        "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
        "type": "Base",
        "original_content": "The product constructs a string for a command to be executed by a separate component\nin another control sphere, but it does not properly delimit the\nintended arguments, options, or switches within that command string.",
        "keyphrase_source": "weakness:GITHUB_TOKEN exposure",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.39850181154578324,
            "graph": 1.7401544608007122
          }
        }
      },
      "similarity": 0.39850181154578324
    },
    {
      "doc_id": "78",
      "text": "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
      "score": 2.4700000000000006,
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "type": "base",
        "original_content": "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "relationships": [
          {
            "source_id": "78",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "78",
            "target_id": "88",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "78",
            "target_id": "77",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1340"
            }
          },
          {
            "source_id": "78",
            "target_id": "77",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          },
          {
            "source_id": "78",
            "target_id": "74",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "78",
            "target_id": "77",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "77",
            "target_id": "78",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "74",
            "target_id": "78",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "184",
            "target_id": "78",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 0.8,
          "sequence_path": 0.8,
          "peer_group": 0.9
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ],
                [
                  "184",
                  "78",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.8,
              "type": "relationship_chain",
              "source": "79"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ],
                [
                  "184",
                  "78",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.8,
              "type": "vulnerability_sequence_forward",
              "source": "79"
            },
            "peer_relationship": {
              "path": [
                [
                  "78",
                  "88",
                  "CANALSOBE"
                ]
              ],
              "score": 0.9,
              "type": "peer_relationship",
              "source": "88"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.4700000000000006
          }
        }
      },
      "similarity": 2.4700000000000006
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-59",
      "CWE-79",
      "CWE-201",
      "CWE-538",
      "CWE-78",
      "CWE-214",
      "CWE-434"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}