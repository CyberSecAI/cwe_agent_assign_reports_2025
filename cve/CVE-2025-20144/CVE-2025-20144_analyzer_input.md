# Vulnerability Information: CVE-2025-20144

## Vulnerability Description
A **vulnerability** in the hybrid access control list (ACL) processing of IPv4 packets in Cisco IOS XR Software could allow an unauthenticated, remote attacker to bypass a configured ACL. This **vulnerability** is due to **incorrect handling of packets when a specific configuration of the hybrid ACL exists**. An attacker could exploit this **vulnerability** by attempting to send traffic through an affected device. A successful exploit could allow the attacker to bypass a configured ACL on the affected device. For more information, see the section of this advisory. Cisco has released software updates that address this **vulnerability**. There are workarounds that address this **vulnerability**.

### Vulnerability Description Key Phrases
- **rootcause:** **incorrect handling of packets when a specific configuration of the hybrid ACL exists**
- **weakness:** **vulnerability**
- **impact:** bypass a configured ACL
- **vector:** attempting to send traffic through an affected device
- **attacker:** unauthenticated remote attacker
- **product:** Cisco IOS XR Software
- **component:** hybrid access control list (ACL) processing of IPv4 packets

## CVE Reference Links Content Summary
```text
CVE-2025-20144
```
**Content from sec.cloudapps.cisco.com_8fe8e84a_20250624_200756.html:**

*   **Vulnerability:** A vulnerability in the hybrid access control list (ACL) processing of IPv4 packets in Cisco IOS XR Software could allow an unauthenticated, remote attacker to bypass a configured ACL. This vulnerability is due to incorrect handling of packets when a specific configuration of the hybrid ACL exists.
*   **Impact:** A successful exploit could allow the attacker to bypass a configured ACL on the affected device. The overall impact of exploitation is organization specific because it depends on the importance of the assets that the ACL was supposed to protect.
*   **Attack Vector:** The attacker could exploit this vulnerability by attempting to send traffic through an affected device.
*   **Affected Products:**
    *   IOS XR White box (IOSXRWBD)
    *   Network Convergence Series (NCS) 540 Series Routers
    *   NCS 560 Series Routers
    *   NCS 5500 Series
    *   NCS 5700 Series
*   **Determine if affected:**
    1.  Use the command `show running-config | include ipv4 access-group .* compress level 3`
        *   If output is returned, a hybrid IPv4 ACL is configured.
        *   If not configured, the device is not affected.
    2.  Examine the ACLs using the command `show access-list <Name of ACL>`.
        *   If the number of different source or destination network object groups is 32 or more, proceed to Step 3.
        *   If the number is less than 32, the ACL is not affected.
    3.  Examine the object groups using the command `show object-group network ipv4 <name of each network object-group>`. If the same IPv4 prefix, host, or range entry is found in 32 or more of the source network object groups or in 32 or more of the destination network object groups, then the ACL is affected by this vulnerability.
*   **Workaround:**
    *   Examine the object groups that make up the ACL. If the same IPv4 source or destination or both appear more than 31 times in object groups that comprise the ACL, remove access control entries until there are 31 or fewer entries of the same IPv4 address in both the source and destination entries.
*   **Fix:** Cisco has released software updates that address this vulnerability.
    *   7.11.2
    *   24.1 and later - Not affected.

**More detail than the official CVE description:** The content provides a more detailed description of the vulnerability, including how to determine if a device is affected and a workaround. The content also provides specific commands and steps to identify vulnerable configurations.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | alternate_terms | 0.700 |
| 2 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.718 |
| 3 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.711 |
| 4 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.710 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.688 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.685 |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.682 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.682 |
| 9 | 291 | Reliance on IP Address for Authentication | Variant | Allowed | dense | 0.543 |
| 10 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | Allowed | graph | 0.003 |


---

## CWE Classification Guidance

The following guidance has been automatically included because relevant keywords were detected in the vulnerability description:

### Authentication vs Authorization vs Access Control Guidance

## ===Guidance===

### Level Set – Authentication vs Authorization vs Access Control

**Authentication**:
Determines *who* the actor is (identity validation). This is typically the *first step* in access control.

* Example phrases: "user must log in", "lack of login check", "bypasses login"
* CWE relevance: authentication is usually mapped to CWE-306 or its children.

  * **CWE-306**: *Missing Authentication for Critical Function* – used when no identity validation is enforced for sensitive functionality (e.g., password reset, user deletion).

**Authorization**:
Determines *what* an authenticated actor is allowed to do. It decides access *after* identity is verified.

* Example phrases: "unauthorized access", "regular user can access admin panel", "role checks are missing"
* CWE relevance: use CWEs like 862, 863, 285 for authorization errors:

  * **CWE-862**: *Missing Authorization* – the application doesn't check whether the user is authorized at all.
  * **CWE-863**: *Incorrect Authorization* – the application checks authorization, but does it incorrectly (e.g., flawed logic).
  * **CWE-285**: *Improper Authorization* – general category for any flawed authorization logic or design.

**Access Control**:
A broader term that includes both authentication and authorization. Governs how resources are protected and who can access them under what conditions.

* CWE relevance:

  * **CWE-284**: *Improper Access Control* – top-level category used when access control failure exists but root cause is unclear.
  * This should be avoided **if** a more specific child CWE like 285, 862, 863, or 306 is appropriate.

---

## Mapping Discussion – Common Misclassification Patterns

### 1. **CWE-306 vs CWE-862**:

* **306** is about lack of **authentication** (e.g., *no login required at all*).
* **862** is about lack of **authorization** *after* authentication (e.g., *admin check missing*).
* ✅ Example CWE-306: *“An unauthenticated attacker can invoke the password reset API.”*
* ✅ Example CWE-862: *“An authenticated user without admin privileges can delete any user account.”*

### 2. **CWE-285 vs CWE-284**:

* **285** is specific to authorization flaws – it's a better choice than 284 **if** the issue involves *improper or missing role checks*.
* **284** should be reserved for general access control issues when it’s unclear whether the issue lies in authn or authz.

---

## Technical Impact vs Root Cause Clarification

**Phrase like "unauthorized access" is not enough.**

* If you **cannot determine whether identity was checked**, assume it’s **authorization** and consider 862 or 863.
* If you **know no login happened**, lean toward **authentication** → CWE-306.
* If the **access control policy is unclear or inconsistently enforced**, but it's not due to missing checks, consider **CWE-284**.

---

## Good Mapping Examples

* ✅ **CWE-306**: “The endpoint `/admin/deleteUser` does not require any authentication.”
* ✅ **CWE-862**: “Any logged-in user can change any other user's email without being an admin.”
* ✅ **CWE-863**: “An admin check exists but incorrectly grants access to non-admin users.”
* ✅ **CWE-285**: “Application uses a static role check that fails when roles change dynamically.”
* ✅ **CWE-284**: “Inconsistent enforcement of access rules across services with unclear policy source.”

---

## Summary – Quick LLM Rules of Thumb

| **Indicator**                                              | **Likely CWE** |
| ---------------------------------------------------------- | -------------- |
| No identity check (no login)                               | CWE-306        |
| No role/privilege check after login                        | CWE-862        |
| Role check is present but flawed                           | CWE-863        |
| General or ambiguous authorization failure                 | CWE-285        |
| High-level access control problem with no clear root cause | CWE-284        |


