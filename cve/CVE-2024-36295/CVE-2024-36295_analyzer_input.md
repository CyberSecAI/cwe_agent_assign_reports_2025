# Vulnerability Information: CVE-2024-36295

## Vulnerability Description
A **command execution vulnerability** exists in the qos.cgi qos_sta() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary command execution. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **command execution vulnerability**
- **impact:** arbitrary command execution and execute arbitrary command
- **vector:** specially crafted HTTP request
- **attacker:** authenticated attacker
- **product:** Wavlink AC3000 M33A8
- **version:** V5030.210505
- **component:** qos.cgi qos_sta() functionality

## CVE Reference Links Content Summary
## Analysis of CVE-2024-36295 based on provided content

The provided content **is relevant** to CVE-2024-36295. It's a Talos Vulnerability Report detailing a command injection vulnerability in Wavlink AC3000 routers. The report provides significantly more detail than a standard CVE description.

Here's a breakdown of the extracted information:

**Root cause of vulnerability:**

*   Improper neutralization of special elements in output used by a downstream component ('Injection') - CWE-74.
*   The `qos.cgi` script doesn't properly sanitize user-supplied input for the `time_control` parameter, allowing command injection.

**Weaknesses/vulnerabilities present:**

*   Command Injection
*   Lack of input validation in the `qos.cgi` script.
*   Writing user-controlled data to a file (`/vendor/time_control_sta_list`) that is later executed by other scripts.

**Impact of exploitation:**

*   Arbitrary command execution on the router.
*   Potential for complete system compromise.

**Attack vectors:**

*   An attacker can send a specially crafted HTTP POST request to the `qos.cgi` script with a malicious payload in the `time_control` parameter.
*   Requires authenticated access (session cookie) to the router's web interface.

**Required attacker capabilities/position:**

*   Authenticated access to the router's web interface (requires valid credentials or a session cookie).
*   Understanding of command injection techniques.
*   Network access to the router.

**Mitigation or fix:**

*   The report does not explicitly state a fix, but implies that proper input validation and sanitization in the `qos.cgi` script are necessary to prevent the vulnerability.
*   The vendor is working on patches, but the product has been discontinued.

**Additional Details:**

*   **Affected Product:** Wavlink AC3000 M33A8.V5030.210505
*   **CVSSv3 Score:** 9.1 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)
*   The vulnerability is triggered by setting `page=qos_sta` in an HTTP POST request.
*   The injected commands are written to `/vendor/time_control_sta_list` and executed by scripts like `sbin/sta_time_control.sh`.
*   The report details the specific functions and code locations involved in the vulnerability.
*   The report provides a timeline of vendor communication.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.280 |
| 2 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.265 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.264 |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.259 |
| 5 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.257 |
| 6 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.246 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.244 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.234 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.585 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

