# Vulnerability Information: CVE-2025-23166

## Vulnerability Description
The C++ method SignTraitsDeriveBits() may **incorrectly call ThrowException() based on user-supplied inputs** when executing in a background thread, crashing the Node.js process. Such cryptographic operations are commonly applied to untrusted inputs. Thus, this mechanism potentially allows an adversary to remotely crash a Node.js runtime.

### Vulnerability Description Key Phrases
- **rootcause:** **incorrectly call ThrowException() based on user-supplied inputs**
- **impact:** remotely crash a Node.js runtime
- **product:** Node.js
- **component:** C++ method SignTraitsDeriveBits()

## CVE Reference Links Content Summary
## CVE-2025-23166: Improper error handling in async cryptographic operations crashes process

**Root cause of vulnerability:**

The C++ method `SignTraits::DeriveBits()` may incorrectly call `ThrowException()` based on user-supplied inputs when executing in a background thread.

**Weaknesses/vulnerabilities present:**

Improper error handling in asynchronous cryptographic operations.

**Impact of exploitation:**

Remotely crashing the Node.js process.

**Attack vectors:**

Applying cryptographic operations to untrusted inputs.

**Required attacker capabilities/position:**

An adversary capable of providing untrusted inputs to cryptographic operations.

**Mitigation or fix:**

Updates are available for the 24.x, 23.x, 22.x, 20.x Node.js release lines.

**Additional details:**

*   Severity: High
*   Affected release lines: 20.x, 22.x, 23.x, 24.x
*   Reported by: @panva and @tniessen

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 807 | Reliance on Untrusted Inputs in a Security Decision | Base | Allowed | sparse | 0.297 |
| 2 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.260 |
| 3 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.250 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.247 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.244 |
| 6 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.237 |
| 7 | 183 | Permissive List of Allowed Inputs | Base | Allowed | sparse | 0.233 |
| 8 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.233 |
| 9 | 194 | Unexpected Sign Extension | Variant | Allowed | dense | 0.510 |
| 10 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | Allowed | graph | 0.002 |

