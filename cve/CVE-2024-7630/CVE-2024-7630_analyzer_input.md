# Vulnerability Information: CVE-2024-7630

## Vulnerability Description
The Relevanssi - A Better Search plugin for WordPress is vulnerable to Information Exposure in all versions up to, and including, 4.22.2 via the relevanssi_do_query() due to **insufficient limitations on the posts that are returned when searching**. This makes it possible for unauthenticated attackers to extract potentially sensitive information from password protected posts.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient limitations on the posts that are returned when searching**
- **impact:** Information Exposure
- **attacker:** unauthenticated attackers
- **product:** Relevanssi - A Better Search plugin for WordPress
- **version:** all versions up to and including 4.22.2
- **component:** relevanssi_do_query()

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-7630

**Root Cause of Vulnerability:**
- The vulnerability lies in the `relevanssi_do_query()` function of the Relevanssi plugin, specifically how it handles password-protected posts during search queries.
- The plugin does not sufficiently limit the posts returned in search results, allowing unauthorized access.

**Weaknesses/Vulnerabilities Present:**
- **Insufficient Access Control:** The core weakness is the lack of proper checks to prevent the exposure of password-protected post content to unauthenticated users. The plugin was returning information from password-protected posts in search results.

**Impact of Exploitation:**
- **Information Exposure:** Unauthenticated attackers can potentially extract sensitive information from password-protected posts by crafting specific search queries.

**Attack Vectors:**
- **Network-based:** Attackers can exploit this vulnerability remotely by sending crafted search queries to the affected WordPress site.
- **Unauthenticated Access:** No authentication is required to exploit the vulnerability.

**Required Attacker Capabilities/Position:**
- **Unauthenticated User:** The attacker does not need to have any user account on the target WordPress site.
- **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable website.

**Additional Details from the provided content:**

- The vulnerability affects all versions of the Relevanssi plugin up to and including 4.22.2.
- The vulnerability was patched in version 4.23.0.
- The fix involves adding a filter `relevanssi_show_password_protected` that allows controlling if password-protected posts are shown in the search results. By default, the filter prevents those posts from showing.
- The provided diff shows the code changes introduced in the fix, highlighting the addition of the password check.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.396 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.388 |
| 3 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.371 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.368 |
| 5 | 540 | Inclusion of Sensitive Information in Source Code | Base | Allowed | sparse | 0.368 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.365 |
| 7 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.361 |
| 8 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.360 |
| 9 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | dense | 0.549 |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | Allowed | graph | 0.002 |

