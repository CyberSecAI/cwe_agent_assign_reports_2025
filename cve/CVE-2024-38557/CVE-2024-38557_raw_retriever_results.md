# Raw Retriever Results for CVE-2024-38557

# Raw Retriever Results for CVE-2024-38557
## Query
In the Linux kernel, the following vulnerability has been resolved net/mlx5 Reload only IB representors upon lag disable/enable On lag disable, the bond IB device along with all of its representors are destroyed, and then the slaves representors get reloaded. In case the slave IB representor load fails, the eswitch error flow unloads all representors, including ethernet representors, where the netdevs get detached and removed from lag bond. Such flow is inaccurate as the lag driver is not responsible for loading/unloading ethernet representors. Furthermore, the flow described above begins by holding lag lock to prevent bond changes during disable flow. However, when reaching the ethernet representors detachment from lag, the lag lock is required again, triggering the following deadlock Call trace __switch_to+0xf4/0x148 __schedule+0x2c8/0x7d0 schedule+0x50/0xe0 schedule_preempt_disabled+0x18/0x28 __mutex_lock.isra.13+0x2b8/0x570 __mutex_lock_slowpath+0x1c/0x28 mutex_lock+0x4c/0x68 mlx5_lag_remove_netdev+0x3c/0x1a0 [mlx5_core] mlx5e_uplink_rep_disable+0x70/0xa0 [mlx5_core] mlx5e_detach_netdev+0x6c/0xb0 [mlx5_core] mlx5e_netdev_change_profile+0x44/0x138 [mlx5_core] mlx5e_netdev_attach_nic_profile+0x28/0x38 [mlx5_core] mlx5e_vport_rep_unload+0x184/0x1b8 [mlx5_core] mlx5_esw_offloads_rep_load+0xd8/0xe0 [mlx5_core] mlx5_eswitch_reload_reps+0x74/0xd0 [mlx5_core] mlx5_disable_lag+0x130/0x138 [mlx5_core] mlx5_lag_disable_change+0x6c/0x70 [mlx5_core] // hold ldev->lock mlx5_de

## Keyphrases
- **weakness**: 'deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4272 | 0.4789 | 0.4522 | 0.4535 | 20 |
| Sparse | 426.7876 | 488.4233 | 453.6523 | 452.2471 | 10 |
| Graph | 1.0062 | 2.2100 | 1.2835 | 1.0928 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 2 | 833 | Deadlock | Base | 1.6875 | Allowed |
| 3 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6111 | Allowed |
| 4 | 1331 | Improper Isolation of Shared Resources in Network On Chip (NoC) | Base | 1.6061 | Allowed |
| 5 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 1.6041 | Allowed |
| 6 | 1037 | Processor Optimization Removal or Modification of Security-critical Code | base | 1.5210 | Allowed |
| 7 | 410 | Insufficient Resource Pool | Base | 1.5195 | Allowed |
| 8 | 412 | Unrestricted Externally Accessible Lock | base | 1.3104 | Allowed |
| 9 | 129 | Improper Validation of Array Index | variant | 1.2864 | Allowed |
| 10 | 1189 | Improper Isolation of Shared Resources on System-on-a-Chip (SoC) | Base | 1.1019 | Allowed |
| 11 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 1.0837 | Allowed |
| 12 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 1.0464 | Allowed |
| 13 | 667 | Improper Locking | Class | 1.0383 | Allowed-with-Review |
| 14 | 920 | Improper Restriction of Power Consumption | base | 1.0062 | Allowed |
| 15 | 779 | Logging of Excessive Data | base | 1.0062 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4789 | 0.4789 | Allowed |
| 2 | 833 | Deadlock | Base | 0.4693 | 0.4693 | Allowed |
| 3 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4662 | 0.4662 | Allowed |
| 4 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4642 | 0.4642 | Allowed |
| 5 | 1331 | Improper Isolation of Shared Resources in Network On Chip (NoC) | Base | 0.4635 | 0.4635 | Allowed |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4621 | 0.4621 | Allowed |
| 7 | 413 | Improper Resource Locking | Base | 0.4595 | 0.4595 | Allowed |
| 8 | 1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | Base | 0.4583 | 0.4583 | Allowed |
| 9 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4578 | 0.4578 | Allowed |
| 10 | 1317 | Improper Access Control in Fabric Bridge | Base | 0.4535 | 0.4535 | Allowed |
| 11 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4534 | 0.4534 | Allowed |
| 12 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | 0.4534 | 0.4534 | Allowed |
| 13 | 696 | Incorrect Behavior Order | Class | 0.4509 | 0.4509 | Allowed-with-Review |
| 14 | 1318 | Missing Support for Security Features in On-chip Fabrics or Buses | Base | 0.4495 | 0.4495 | Allowed |
| 15 | 1311 | Improper Translation of Security Attributes by Fabric Bridge | Base | 0.4400 | 0.4400 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | 488.4233 | 488.4233 | Allowed |
| 2 | 667 | Improper Locking | 482.0670 | 482.0670 | Allowed-with-Review |
| 3 | 833 | Deadlock | 476.2965 | 476.2965 | Allowed |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | 471.4654 | 471.4654 | Allowed |
| 5 | 400 | Uncontrolled Resource Consumption | 452.9319 | 452.9319 | Discouraged |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | 451.5623 | 451.5623 | Allowed |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 429.8931 | 429.8931 | Allowed-with-Review |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 429.1501 | 429.1501 | Allowed |
| 9 | 863 | Incorrect Authorization | 427.9454 | 427.9454 | Allowed-with-Review |
| 10 | 306 | Missing Authentication for Critical Function | 426.7876 | 426.7876 | Allowed |
