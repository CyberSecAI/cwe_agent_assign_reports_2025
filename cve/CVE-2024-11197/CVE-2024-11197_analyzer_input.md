# Vulnerability Information: CVE-2024-11197

## Vulnerability Description
The Lock User Account plugin for WordPress is vulnerable to **user lock bypass** in all versions up to, and including, 1.0.5. This is due to permitting application password logins when user accounts are locked. This makes it possible for authenticated attackers, with existing application passwords, to interact with the vulnerable site via an API such as XML-RPC or REST despite their account being locked.

### Vulnerability Description Key Phrases
- **weakness:** **user lock bypass**
- **impact:** interact with vulnerable site despite locked account
- **vector:** application password logins
- **attacker:** authenticated attackers
- **product:** Lock User Account plugin for WordPress
- **version:** all versions up to and including 1.0.5

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-11197:

**Root Cause of Vulnerability:**

The vulnerability stems from the "Lock User Account" WordPress plugin failing to properly restrict access for locked user accounts when using application passwords. Specifically, the plugin allows application password logins to bypass the user lock mechanism.

**Weaknesses/Vulnerabilities Present:**

*   **Protection Mechanism Failure:** The plugin's intended user locking mechanism is bypassed due to the improper handling of application password logins.
*   **Insufficient Access Control:** The plugin does not properly prevent access to locked accounts when authenticated through application passwords.

**Impact of Exploitation:**

*   **Unauthorized Access:** Authenticated attackers with existing application passwords can interact with the vulnerable website, even if their accounts are locked. This bypass allows access to potentially sensitive resources and functionality.
*   **Data Modification:** The attacker may be able to modify data, depending on the permissions associated with the locked user's account.
*   **Loss of Functionality:** The ability to lock a user account is rendered ineffective for users with application passwords.

**Attack Vectors:**

*   **Network:** The vulnerability is exploited over the network using standard web protocols (e.g., HTTP, HTTPS).
*   **API access:** Specifically, attackers can leverage APIs such as XML-RPC or REST to bypass user locks, provided that the locked user account has application passwords setup.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs to have a user account on the vulnerable WordPress site.
*   **Existing Application Password:** The attacker needs to have an application password associated with their locked user account.
*   **Network Access:** Attacker needs network connectivity to send requests to the server.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.374 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.372 |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.372 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.367 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.359 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.357 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.353 |
| 8 | 620 | Unverified Password Change | Base | Allowed | sparse | 0.347 |
| 9 | 645 | Overly Restrictive Account Lockout Mechanism | Base | Allowed | dense | 0.511 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

