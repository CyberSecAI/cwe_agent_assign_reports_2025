# Raw Retriever Results for CVE-2024-53862

# Raw Retriever Results for CVE-2024-53862
## Query
Argo Workflows is an open source container-native workflow engine for orchestrating parallel jobs on Kubernetes. When using `--auth-mode=client`, Archived Workflows can be retrieved with a fake or spoofed token via the GET Workflow endpoint `/api/v1/workflows/{namespace}/{name}` or when using `--auth-mode=sso`, all Archived Workflows can be retrieved with a valid token via the GET Workflow endpoint `/api/v1/workflows/{namespace}/{name}`. No authentication is performed by the Server itself on `client` tokens. Authentication & authorization is instead delegated to the k8s API server. However, the Workflow Archive does not interact with k8s, and so any token that looks valid will be considered authenticated, even if it is not a k8s token or even if the token has no RBAC for Argo. To handle the lack of pass-through k8s authN/authZ, the Workflow Archive specifically does the equivalent of a `kubectl auth can-i` check for respective methods. In 3.5.7 and 3.5.8, the auth check was accidentally removed on the GET Workflow endpoints fallback to archived workflows on these lines, allowing archived workflows to be retrieved with a fake token. This vulnerability is fixed in 3.6.2 and 3.5.13.

## Keyphrases
- **rootcause**: 'auth check was accidentally removed'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3304 | 0.3863 | 0.3502 | 0.3478 | 20 |
| Sparse | 961.9678 | 1155.6897 | 1047.4806 | 1038.9512 | 10 |
| Graph | 1.0062 | 2.2100 | 1.2587 | 1.1690 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | Base | 1.6487 | Allowed |
| 3 | 915 | Improperly Controlled Modification of Dynamically-Determined Object Attributes | base | 1.5210 | Allowed |
| 4 | 502 | Deserialization of Untrusted Data | Base | 1.4465 | Allowed |
| 5 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 1.4328 | Allowed |
| 6 | 526 | Cleartext Storage of Sensitive Information in an Environment Variable | variant | 1.4040 | Allowed |
| 7 | 322 | Key Exchange without Entity Authentication | base | 1.3572 | Allowed |
| 8 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.2624 | Allowed |
| 9 | 257 | Storing Passwords in a Recoverable Format | base | 1.1794 | Allowed |
| 10 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | base | 1.1794 | Allowed |
| 11 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.1587 | Allowed |
| 12 | 321 | Use of Hard-coded Cryptographic Key | variant | 1.1587 | Allowed |
| 13 | 259 | Use of Hard-coded Password | variant | 1.1587 | Allowed |
| 14 | 1390 | Weak Authentication | Class | 1.0096 | Allowed-with-Review |
| 15 | 862 | Missing Authorization | Class | 1.0095 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | 0.3863 | 0.3863 | Allowed |
| 2 | 862 | Missing Authorization | Class | 0.3690 | 0.3690 | Allowed-with-Review |
| 3 | 306 | Missing Authentication for Critical Function | Base | 0.3690 | 0.3690 | Allowed |
| 4 | 863 | Incorrect Authorization | Class | 0.3680 | 0.3680 | Allowed-with-Review |
| 5 | 285 | Improper Authorization | Class | 0.3654 | 0.3654 | Discouraged |
| 6 | 1390 | Weak Authentication | Class | 0.3588 | 0.3588 | Allowed-with-Review |
| 7 | 287 | Improper Authentication | Class | 0.3584 | 0.3584 | Discouraged |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.3548 | 0.3548 | Allowed |
| 9 | 603 | Use of Client-Side Authentication | Base | 0.3545 | 0.3545 | Allowed |
| 10 | 289 | Authentication Bypass by Alternate Name | Base | 0.3538 | 0.3538 | Allowed |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.3417 | 0.3417 | Allowed |
| 12 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.3394 | 0.3394 | Allowed |
| 13 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.3384 | 0.3384 | Allowed |
| 14 | 290 | Authentication Bypass by Spoofing | Base | 0.3384 | 0.3384 | Allowed |
| 15 | 302 | Authentication Bypass by Assumed-Immutable Data | Base | 0.3377 | 0.3377 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 1155.6897 | 1155.6897 | Allowed-with-Review |
| 2 | 214 | Invocation of Process Using Visible Sensitive Information | 1136.7441 | 1136.7441 | Allowed |
| 3 | 287 | Improper Authentication | 1064.2743 | 1064.2743 | Discouraged |
| 4 | 1390 | Weak Authentication | 1057.1824 | 1057.1824 | Allowed-with-Review |
| 5 | 285 | Improper Authorization | 1045.2928 | 1045.2928 | Discouraged |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | 1032.6097 | 1032.6097 | Allowed |
| 7 | 306 | Missing Authentication for Critical Function | 1028.7412 | 1028.7412 | Allowed |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | 1022.4348 | 1022.4348 | Allowed |
| 9 | 295 | Improper Certificate Validation | 969.8697 | 969.8697 | Allowed |
| 10 | 668 | Exposure of Resource to Wrong Sphere | 961.9678 | 961.9678 | Discouraged |
