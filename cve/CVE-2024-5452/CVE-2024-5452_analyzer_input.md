# Vulnerability Information: CVE-2024-5452

## Vulnerability Description
A remote code execution (RCE) vulnerability exists in the lightning-ai/pytorch-lightning library version 2.2.1 due to **improper handling of deserialized user input** and mismanagement of dunder attributes by the `deepdiff` library. The library uses `deepdiff.Delta` objects to modify application state based on frontend actions. However, it is possible to bypass the intended restrictions on modifying dunder attributes, allowing an attacker to construct a serialized delta that passes the deserializer whitelist and contains dunder attributes. When processed, this can be exploited to access other modules, classes, and instances, leading to arbitrary attribute write and total RCE on any self-hosted pytorch-lightning application in its default configuration, as the delta endpoint is enabled by default.

### Vulnerability Description Key Phrases
- **rootcause:** **improper handling of deserialized user input**
- **impact:** remote code execution
- **product:** lightning-ai/pytorch-lightning library
- **version:** 2.2.1

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.699 |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.622 |
| 3 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.610 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.586 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.584 |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.582 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.580 |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.577 |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | dense | 0.578 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |

