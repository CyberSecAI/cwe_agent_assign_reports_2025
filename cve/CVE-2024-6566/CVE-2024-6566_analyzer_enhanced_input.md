## Vulnerability Description
The Aramex Shipping WooCommerce plugin for WordPress is vulnerable to Full Path Disclosure in all versions up to, and including, 1.1.21. This is due the plugin not preventing direct access to the composer-setup.php file which also has display_errors enabled. This makes it possible for unauthenticated attackers to retrieve the full path of the web application, which can be used to aid other attacks. The information displayed is not useful on its own, and requires another vulnerability to be present for damage to an affected website.

### Vulnerability Description Key Phrases
- **impact:** Full Path Disclosure
- **attacker:** unauthenticated attackers
- **product:** Aramex Shipping WooCommerce plugin
- **version:** all versions up to and including 1.1.21
- **component:** composer-setup.php file

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-6566:

**1. Verification of CVE Relevance:**

The provided content directly relates to CVE-2024-6566. The Wordfence article explicitly mentions "Aramex Shipping WooCommerce <= 1.1.21 - Unauthenticated Full Path Disclosure" and includes the CVE identifier. The description aligns with the vulnerability as a Full Path Disclosure due to direct access to the `composer-setup.php` file.

**2. Root Cause of Vulnerability:**

The root cause is the lack of access control on the `composer-setup.php` file within the Aramex Shipping WooCommerce plugin. This file, intended for internal use, is directly accessible to unauthenticated users and outputs errors with `display_errors` enabled. This reveals the full path of the web application.

**3. Weaknesses/Vulnerabilities Present:**

*   **Insecure Direct Object Reference:** The plugin fails to restrict direct access to the `composer-setup.php` file.
*   **Information Disclosure:**  The `composer-setup.php` file has `display_errors` enabled, which outputs the full file path when accessed directly.

**4. Impact of Exploitation:**

*   **Full Path Disclosure:** An attacker can obtain the full path of the web application's installation directory.
*   **Aid to Further Attacks:** The disclosed path can assist attackers in exploiting other vulnerabilities by providing precise location details for file system interactions.
*   The impact is considered low, as this information alone is not directly damaging, but it can greatly assist a targeted attack.

**5. Attack Vectors:**

*   **Direct URL Access:**  An attacker can access the vulnerable file (`composer-setup.php`) directly using its URL.
*   **Unauthenticated Access:** No authentication is required to exploit this vulnerability.

**6. Required Attacker Capabilities/Position:**

*   **No Special Privileges Required:** The attacker does not need any user account or privileges on the target system.
*   **Network Access:** The attacker needs network connectivity to reach the web application and request the vulnerable file.
*   **Knowledge of the vulnerable file:** The attacker needs to know the location of the `composer-setup.php` file within the plugin.

**Summary:**

CVE-2024-6566 is a Full Path Disclosure vulnerability in the Aramex Shipping WooCommerce plugin. By directly accessing the `composer-setup.php` file, an unauthenticated attacker can discover the server's full file path due to the file having `display_errors` enabled. This information, while not immediately damaging, can facilitate further attacks.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.182 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.180 |
| 3 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.178 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.178 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.178 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.175 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.174 |
| 8 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.173 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.547 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-862: Missing Authorization

CWE-1390: Weak Authentication

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-306: Missing Authentication for Critical Function

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-863: Incorrect Authorization

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-425: Direct Request ('Forced Browsing')

CWE-434: Unrestricted Upload of File with Dangerous Type