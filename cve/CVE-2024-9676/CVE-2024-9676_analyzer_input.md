# Vulnerability Information: CVE-2024-9676

## Vulnerability Description
A vulnerability was found in Podman, Buildah, and CRI-O. A **symlink traversal vulnerability** in the containers/storage library can cause Podman, Buildah, and CRI-O to hang and result in a denial of service via OOM kill when running a malicious image using an automatically assigned user namespace (`--userns=auto` in Podman and Buildah). The containers/storage library will read /etc/passwd inside the container, but does not properly validate if that file is a symlink, which can be used to cause the library to read an arbitrary file on the host.

### Vulnerability Description Key Phrases
- **rootcause:** **symlink traversal vulnerability**
- **impact:** hang and result in a denial of service via OOM kill
- **product:** Podman and Buildah and CRI-O
- **component:** containers/storage library

## CVE Reference Links Content Summary
Here's the information extracted from the provided content regarding CVE-2024-9676:

**Root cause of vulnerability:**
The vulnerability is caused by a symlink traversal issue within the `containers/storage` library. This library is used by Podman, Buildah, and CRI-O to handle container storage. The library reads `/etc/passwd` inside the container but does not validate if it is a symlink, which allows it to read an arbitrary file on the host.

**Weaknesses/vulnerabilities present:**
- Symlink traversal vulnerability.
- Improper input validation.

**Impact of exploitation:**
- Denial of service (DoS) by causing the affected processes to hang, potentially leading to an out-of-memory (OOM) kill. This can be triggered when a malicious container image uses a symlink for /etc/passwd, pointing to a FIFO on the host, and an automatically assigned user namespace.
- In some cases, a small risk of information disclosure might exist via error messages, though only potentially revealing file contents that the user already has access to.

**Attack vectors:**
- Exploitation can occur when running a malicious container image that contains a crafted symlink.
- Requires an automatically assigned user namespace (`--userns=auto`).

**Required attacker capabilities/position:**
- Attacker must be able to create and run a malicious container image.
- Needs to control container content.
- The attacker must use a user namespace which is assigned automatically.

**Additional Details**
- The vulnerability affects Red Hat OpenShift Container Platform, Red Hat Enterprise Linux and other container tools built with the vulnerable containers/storage library.
- The issue was resolved in multiple advisories by updating the affected packages.
- The vulnerability's severity is rated as "Important" in some advisories and "Moderate" in others, depending on context and affected product.
- The vulnerability can be exploited remotely, with low attack complexity.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.574 |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.529 |
| 3 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.517 |
| 4 | 833 | Deadlock | Base | Allowed | sparse | 0.511 |
| 5 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.508 |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.506 |
| 7 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.502 |
| 8 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.499 |
| 9 | 277 | Insecure Inherited Permissions | Variant | Allowed | dense | 0.601 |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | graph | 0.003 |

