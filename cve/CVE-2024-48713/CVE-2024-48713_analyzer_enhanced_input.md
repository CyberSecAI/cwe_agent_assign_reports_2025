## Vulnerability Description
In TP-Link TL-WDR7660 1.0, the wacWhitelistJsonToBin function handles the parameter string name without checking it, which can lead to **stack overflow** vulnerabilities.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **product:** TP-Link TL-WDR7660
- **version:** 1.0
- **component:** wacWhitelistJsonToBin function

## CVE Reference Links Content Summary
```text
Root cause of vulnerability: The `wacWhitelistJsonToBin` function does not perform proper bounds checking on the `name` parameter, leading to a stack buffer overflow.

Weaknesses/vulnerabilities present: Stack buffer overflow due to insufficient input validation on the size of the `name` parameter.

Impact of exploitation: The stack overflow can cause the router's server to crash, rendering the device unusable. Specifically, it results in the inability to connect wirelessly to the router and access the administrative interface.

Attack vectors: Sending a crafted HTTP POST request to the router's web interface, specifically targeting the `wlan_access` endpoint with an oversized `name` parameter within the `white_list` table.

Required attacker capabilities/position: The attacker needs to be able to send HTTP requests to the router's web interface. This typically means the attacker needs to be on the same network as the router, or have the ability to reach the router's IP address via a different network. Additionally, a valid session cookie is needed for the request.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.180 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.145 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.144 |
| 6 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.143 |
| 7 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.135 |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.134 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.523 |
| 10 | 134 | Use of Externally-Controlled Format String | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-121: Stack-based Buffer Overflow

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-125: Out-of-bounds Read

CWE-674: Uncontrolled Recursion

CWE-130: Improper Handling of Length Parameter Inconsistency

CWE-789: Memory Allocation with Excessive Size Value

CWE-790: Improper Filtering of Special Elements

CWE-134: Use of Externally-Controlled Format String