# Vulnerability Information: CVE-2024-8573

## Vulnerability Description
A vulnerability, which was classified as critical, was found in TOTOLINK AC1200 T8 and AC1200 T10 4.1.5cu.861_B20230220/4.1.8cu.5207. This affects the function setParentalRules of the file /cgi-bin/cstecgi.cgi. The manipulation of the argument desc leads to **buffer overflow**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** TOTOLINK AC1200 T8 and AC1200 T10
- **version:** 4.1.5cu.861_B20230220/4.1.8cu.5207
- **component:** /cgi-bin/cstecgi.cgi

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
- A buffer overflow vulnerability exists in the `setParentalRules` function of the TOTOLINK AC1200 T8 router firmware.

**Weaknesses/vulnerabilities present:**
- **Buffer Overflow:** The `strcpy` function is used to copy the `desc` parameter from a POST request into the `v6` variable without proper bounds checking. This allows an attacker to write beyond the allocated memory for the `v6` variable.

**Impact of exploitation:**
- **Denial of Service (DoS):** The vulnerability can lead to a denial-of-service condition, potentially crashing the device or making it unresponsive.

**Attack vectors:**
- **HTTP POST Request:** The vulnerability is triggered by sending a crafted POST request to the `/cgi-bin/cstecgi.cgi` endpoint with the `topicurl` set to `setParentalRules` and a long string in the `desc` parameter.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP POST requests to the vulnerable router's web interface. This could potentially be done from a device on the same local network or, if the router's web interface is exposed to the internet, from a remote location.

**Technical Details:**
- The vulnerable firmware version is `T8_Firmware V4.1.5cu.861_B20230220`.
- The `desc` parameter within the POST request is the user-controlled input that causes the buffer overflow when copied to `v6` variable via `strcpy`.
- The provided Proof of Concept (POC) demonstrates how to trigger the vulnerability using a Python script. The POC sends a POST request with a `desc` parameter consisting of 0x1000 'b' characters.

The provided information is more detailed than the standard CVE description placeholder.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.455 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.436 |
| 6 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.427 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.413 |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.413 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.695 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

