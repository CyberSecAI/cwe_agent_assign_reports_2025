# Vulnerability Information: CVE-2024-50378

## Vulnerability Description
Airflow versions before 2.10.3 have a vulnerability that allows authenticated users with audit log access to see sensitive values in audit logs which they should not see.When sensitive variables were set via airflow CLI, values of those variables appeared in the audit log and were stored unencrypted in the Airflow database. While this risk is limited to users with audit log access, it is recommended to upgrade to Airflow 2.10.3 or a later version, which addresses this issue. Users who previously used the CLI to set secret variables should manually delete entries with those variables from the log table.

### Vulnerability Description Key Phrases
- **weakness:** **information disclosure**
- **impact:** see sensitive values in audit logs
- **vector:** setting sensitive variables via airflow CLI
- **attacker:** authenticated users with audit log access
- **product:** Airflow
- **version:** before 2.10.3

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-50378:

**Root cause of vulnerability:**
- When sensitive variables were set via the Airflow CLI, their values were not masked and were included in the audit log and stored unencrypted in the Airflow database.

**Weaknesses/vulnerabilities present:**
- **Information Exposure:** Sensitive variable values were exposed in audit logs and stored unencrypted, violating the principle of least privilege and exposing potentially confidential data.
- **Lack of Input Sanitization/Masking:** The Airflow CLI did not properly mask or sanitize sensitive data before logging or storing it.
- **Insecure storage:** Sensitive data stored unencrypted in the database.

**Impact of exploitation:**
- Authenticated users with access to the audit log could view sensitive variable values they should not have access to.
- Exposure of potentially sensitive data, such as passwords, API keys, or other secrets.

**Attack vectors:**
- Attackers would need to have valid credentials and access to the Airflow audit logs.
- The vulnerability is triggered when sensitive variables are set via the Airflow CLI.

**Required attacker capabilities/position:**
- The attacker needs to be an authenticated user with access to the audit log.
- The attacker must be able to view the audit log, typically through the Airflow UI or database.

**Additional details:**
- The vulnerability was fixed in Airflow version 2.10.3.
- The fix involved masking the sensitive values in the audit logs.
- Users who previously used the CLI to set secret variables should manually delete entries with those variables from the log table.
- The fix was implemented in pull request #43123.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.662 |
| 3 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.552 |
| 4 | 277 | Insecure Inherited Permissions | Variant | Allowed | sparse | 0.549 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.528 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.525 |
| 7 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.522 |
| 8 | 526 | Cleartext Storage of Sensitive Information in an Environment Variable | Variant | Allowed | sparse | 0.511 |
| 9 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | dense | 0.464 |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | Allowed | graph | 0.002 |

