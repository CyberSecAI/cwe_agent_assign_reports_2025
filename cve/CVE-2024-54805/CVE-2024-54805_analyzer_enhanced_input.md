## Vulnerability Description
Netgear WNR854T 1.5.2 (North America) is vulnerable to **Command Injection**. An attacker can send a specially crafted request to post.cgi, updating the nvram parameter get_email. After which, they can visit the send_log.cgi endpoint which uses the parameter in a system call to achieve command execution.

### Vulnerability Description Key Phrases
- **weakness:** **Command Injection**
- **impact:** command execution
- **vector:** specially crafted request
- **attacker:** attacker
- **product:** Netgear WNR854T
- **version:** 1.5.2 (North America)
- **component:** post.cgi and send_log.cgi endpoint

## CVE Reference Links Content Summary
CVE-2024-54805

**Root cause of vulnerability:**
The vulnerability is a command injection within the router’s email notification functionality due to the lack of input validation or sanitization for the `email_address` parameter when constructing a shell command. Specifically, the vulnerability is exploitable through backtick (`) injection.

**Weaknesses/vulnerabilities present:**
- Command Injection
- Lack of Input Validation
- Improper Sanitization

**Impact of exploitation:**
Attackers with valid credentials can execute arbitrary system commands with root privileges. This can lead to network eavesdropping, credential harvesting, and lateral movement within the connected network.

**Attack vectors:**
- Authenticated access to the router’s administrative interface.
- Manipulation of the email address field in the email notification settings.
- Triggering the email functionality via the `/send_log.cgi` endpoint.

**Required attacker capabilities/position:**
- Authentication to the router’s administrative interface.

**Mitigation or fix:**
The content does not provide information on mitigation or fix.

**Additional Details:**
The vulnerability resides in the httpd binary (`/bin/httpd`) and involves the `nvram_get("email_address")` function call. The vulnerable code constructs a command string using `sprintf` with the format string `/bin/sendmail %s -f %s &`. The exploit payload uses backticks to inject arbitrary commands.

The content provides more detail than the official CVE description would likely contain, detailing the specific code locations and the mechanism of exploitation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.292 |
| 4 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.292 |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.291 |
| 6 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.283 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.282 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.280 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.547 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-790: Improper Filtering of Special Elements

CWE-1287: Improper Validation of Specified Type of Input

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-306: Missing Authentication for Critical Function

CWE-138: Improper Neutralization of Special Elements

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs