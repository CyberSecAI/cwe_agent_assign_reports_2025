# Vulnerability Information: CVE-2024-53386

## Vulnerability Description
Stage.js through 0.8.10 allows **DOM Clobbering** (with resultant XSS for untrusted input that contains HTML but does not directly contain JavaScript), because document.currentScript lookup can be shadowed by attacker-injected HTML elements.

### Vulnerability Description Key Phrases
- **weakness:** **DOM Clobbering**
- **impact:** XSS
- **product:** Stage.js
- **version:** through 0.8.10

## CVE Reference Links Content Summary
## Analysis of CVE-2024-53386 Content

Based on the provided content, this relates to a DOM Clobbering vulnerability in Stage.js, which can lead to XSS.

**Root cause of vulnerability:**

The Stage.js library uses `document.currentScript` within the `getScriptSrc` function to obtain the base URL for script resources. This implementation is vulnerable because `document.currentScript` can be shadowed by attacker-injected HTML elements with the `name="currentScript"` attribute.

**Weaknesses/vulnerabilities present:**

*   DOM Clobbering
*   Cross-Site Scripting (XSS)

**Impact of exploitation:**

An attacker can control the URL used for script loading, potentially loading scripts from an attackerâ€™s server.

**Attack vectors:**

*   Injecting an HTML element (e.g., an `img` tag) with the `name="currentScript"` attribute into a web page.

**Required attacker capabilities/position:**

*   Ability to inject arbitrary HTML into a web page (e.g., through a post, comment, or other user-supplied input).
*   Knowledge of the Stage.js library and its use of `document.currentScript`.

**Mitigation or fix:**

The provided content does not specify a fix, but it implies that sanitizing or avoiding the use of `document.currentScript` would be necessary.

**Additional Details (more than official CVE description):**

*   The content references similar vulnerabilities in other libraries (Webpack, Vite, layui) which might provide additional context.
*   A Proof of Concept (PoC) is provided, demonstrating how to load a malicious script from a controlled domain.
*   The vulnerable code snippet is provided.
*   References to research papers on DOM Clobbering are included.
*   The vulnerable version is identified as 0.8.10.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.211 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.200 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.174 |
| 4 | 112 | Missing XML Validation | Base | Allowed | sparse | 0.171 |
| 5 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.158 |
| 6 | 838 | Inappropriate Encoding for Output Context | Base | Allowed | sparse | 0.153 |
| 7 | 156 | Improper Neutralization of Whitespace | Variant | Allowed | sparse | 0.152 |
| 8 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.145 |
| 9 | 83 | Improper Neutralization of Script in Attributes in a Web Page | Variant | Allowed | dense | 0.600 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

