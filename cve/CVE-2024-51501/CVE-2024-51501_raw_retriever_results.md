# Raw Retriever Results for CVE-2024-51501

# Raw Retriever Results for CVE-2024-51501
## Query
Refit is an automatic type-safe REST library for .NET Core, Xamarin and .NET The various header-related Refit attributes (Header, HeaderCollection and Authorize) are vulnerable to CRLF injection. The way HTTP headers are added to a request is via the `HttpHeaders.TryAddWithoutValidation` method. This method does not check for CRLF characters in the header value. This means that any headers added to a refit request are vulnerable to CRLF-injection. In general, CRLF-injection into a HTTP header (when using HTTP/1.1) means that one can inject additional HTTP headers or smuggle whole HTTP requests. If an application using the Refit library passes a user-controllable value through to a header, then that application becomes vulnerable to CRLF-injection. This is not necessarily a security issue for a command line application like the one above, but if such code were present in a web application then it becomes vulnerable to request splitting (as shown in the PoC) and thus Server Side Request Forgery. Strictly speaking this is a potential vulnerability in applications using Refit and not in Refit itself. This issue has been addressed in release versions 7.2.22 and 8.0.0 and all users are advised to upgrade. There are no known workarounds for this vulnerability.

## Keyphrases
- **rootcause**: 'improper input sanitization'
- **weakness**: 'CRLF injection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4369 | 0.5991 | 0.4737 | 0.4637 | 20 |
| Sparse | 1028.0032 | 1375.0610 | 1170.0484 | 1131.4703 | 11 |
| Graph | 1.2543 | 2.8652 | 1.8039 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.8652 | Allowed |
| 2 | 41 | Improper Resolution of Path Equivalence | base | 2.4700 | Allowed |
| 3 | 117 | Improper Output Neutralization for Logs | base | 2.2100 | Allowed |
| 4 | 73 | External Control of File Name or Path | base | 2.1200 | Allowed |
| 5 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 2.0228 | Allowed |
| 6 | 144 | Improper Neutralization of Line Delimiters | variant | 1.9147 | Allowed |
| 7 | 145 | Improper Neutralization of Section Delimiters | variant | 1.9147 | Allowed |
| 8 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | 1.7698 | Allowed |
| 9 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 11 | 494 | Download of Code Without Integrity Check | base | 1.7680 | Allowed |
| 12 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 1.6909 | Allowed |
| 13 | 20 | Improper Input Validation | class | 1.6736 | Discouraged |
| 14 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.6016 | Allowed |
| 15 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 1.5395 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.5991 | 0.5991 | Allowed |
| 2 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.5130 | 0.5130 | Allowed |
| 3 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.5106 | 0.5106 | Allowed |
| 4 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | 0.4966 | 0.4966 | Allowed |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | 0.4964 | 0.4964 | Allowed-with-Review |
| 6 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4885 | 0.4885 | Allowed |
| 7 | 644 | Improper Neutralization of HTTP Headers for Scripting Syntax | Variant | 0.4859 | 0.4859 | Allowed |
| 8 | 293 | Using Referer Field for Authentication | Variant | 0.4847 | 0.4847 | Allowed |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 0.4816 | 0.4816 | Allowed |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.4731 | 0.4731 | Allowed-with-Review |
| 11 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | 0.4544 | 0.4544 | Discouraged |
| 12 | 470 | Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection') | Base | 0.4489 | 0.4489 | Allowed |
| 13 | 1333 | Inefficient Regular Expression Complexity | Base | 0.4483 | 0.4483 | Allowed |
| 14 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.4475 | 0.4475 | Allowed |
| 15 | 807 | Reliance on Untrusted Inputs in a Security Decision | Base | 0.4430 | 0.4430 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 1375.0610 | 1375.0610 | Allowed |
| 2 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 1370.9376 | 1370.9376 | Allowed |
| 3 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | 1183.9544 | 1183.9544 | Allowed |
| 4 | 138 | Improper Neutralization of Special Elements | 1177.8410 | 1177.8410 | Discouraged |
| 5 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | 1141.9179 | 1141.9179 | Discouraged |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1131.4703 | 1131.4703 | Allowed |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | 1124.9545 | 1124.9545 | Allowed |
| 8 | 1333 | Inefficient Regular Expression Complexity | 1119.6459 | 1119.6459 | Allowed |
| 9 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 1114.6126 | 1114.6126 | Allowed |
| 10 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 1102.1342 | 1102.1342 | Allowed |
| 11 | 502 | Deserialization of Untrusted Data | 1028.0032 | 1028.0032 | Allowed |
