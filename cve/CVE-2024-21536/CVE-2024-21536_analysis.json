{
  "cve_id": "CVE-2024-21536",
  "description": "Versions of the package http-proxy-middleware before 2.0.7, from 3.0.0 and before 3.0.3 are vulnerable to Denial of Service (DoS) due to an **UnhandledPromiseRejection error thrown by micromatch**. An attacker could kill the Node.js process and crash the server by making requests to certain paths.",
  "key_phrases": {
    "rootcause": "UnhandledPromiseRejection error thrown by micromatch",
    "weakness": "",
    "impact": [
      "Denial of Service (DoS)",
      "crash the server"
    ],
    "vector": "requests to certain paths",
    "attacker": "attacker",
    "product": "http-proxy-middleware",
    "version": [
      "['before 2.0.7'",
      "'from 3.0.0 and before 3.0.3']"
    ],
    "component": ""
  },
  "reference_content": "Based on the provided content, here's an analysis of CVE-2024-21536:\n\n**Root Cause of Vulnerability:**\n\nThe vulnerability stems from how `http-proxy-middleware` handles errors within its path filtering logic. Specifically, when a user makes requests to certain paths that cause `micromatch` (used internally for path matching) to throw a `TypeError` or when the `pathFilter` function throws an error, the `http-proxy-middleware` doesn't handle this error properly, leading to an `UnhandledPromiseRejection` that crashes the Node.js process.\n\n**Weaknesses/Vulnerabilities Present:**\n\n1.  **Unhandled Exception/Error:** The core issue is the lack of proper error handling when `micromatch` or the custom filter function fails. This causes the Node.js server to terminate abruptly.\n2.  **Incorrect Input Handling:** The vulnerability can be triggered by crafting specific URLs (like `localhost:3030//x@x`) that cause `micromatch` to throw a `TypeError`. It also occurs if the `pathFilter` function is omitted or throws an error.\n3.  **Path Matching Logic Flaw:**  `matchSingleStringPath` function is vulnerable in v1 and v2 of the package when `pathFilter` is excluded, which leads to a crash due to `TypeError: Cannot read properties of null (reading 'indexOf')`.\n\n**Impact of Exploitation:**\n\n*   **Denial of Service (DoS):** An attacker can crash the Node.js server, making the application unavailable to legitimate users. This is a classic DoS scenario.\n\n**Attack Vectors:**\n\n*   **Network Requests:** Attackers can trigger the vulnerability by sending specially crafted HTTP requests to the server.\n*   **Malformed URLs:** Specific URL structures (like those containing `//` and `@`) can trigger the vulnerability.\n*   **Custom `pathFilter` function:** If the `pathFilter` function throws an error, it will cause the server to crash\n\n**Required Attacker Capabilities/Position:**\n\n*   **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable server.\n*   **No Special Privileges:** No specific privileges or authentication is required to trigger the vulnerability.\n*   **Understanding of vulnerable request patterns:** The attacker needs to know the specific paths or request patterns (e.g. `localhost:3030//x@x`) that will trigger the vulnerability, or that they can cause the `pathFilter` to throw an error.\n\n**Additional Details:**\n\n*   **Affected Versions:** `http-proxy-middleware` versions `<2.0.7` and `>=3.0.0 <3.0.3` are vulnerable.\n*   **Patch:** The vulnerability is addressed in versions `2.0.7` and `3.0.3` and higher by adding error handling to the `pathFilter` and context matching logic.\n*   **Mitigation:** Upgrade to the patched versions of the library\n*   **CVSS Score:** Snyk has rated the vulnerability as HIGH, with a CVSS score of 8.7. This indicates the potential for significant impact to application availability.\n\nIn summary, CVE-2024-21536 in `http-proxy-middleware` is a denial-of-service vulnerability caused by improper error handling during path filtering, allowing an attacker to crash the server by sending specific HTTP requests.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-248 | Uncaught Exception | 0.9 | Base | Allowed | Primary CWE: The **UnhandledPromiseRejection error thrown by micromatch** is an uncaught exception that leads to the crash. |\n| CWE-755 | Improper Handling of Exceptional Conditions | 0.7 | Class | Discouraged | Secondary CWE: The `http-proxy-middleware` does not properly handle the exception thrown by micromatch. |\n| CWE-400 | Uncontrolled Resource Consumption | 0.5 | Class | Discouraged | Secondary CWE: The lack of error handling leads to a Denial of Service, which is a form of uncontrolled resource consumption. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship influencing the CWE selection is the parent-child relationship. CWE-248 (Uncaught Exception) is a Base level CWE and a more specific case of CWE-755 (Improper Handling of Exceptional Conditions), which is a Class level CWE. The vulnerability description clearly points to an uncaught exception, justifying the selection of CWE-248 as the primary weakness. The other important relationship is the CANPRECEDE relationship of CWE-248 to CWE-400 (Uncontrolled Resource Consumption), where the uncaught exception leads to a denial of service by crashing the node process.\n\n```mermaid\ngraph TD\n    cwe248[\"CWE-248: Uncaught Exception\"]\n    cwe755[\"CWE-755: Improper Handling of Exceptional Conditions\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe248 -->|CHILDOF| cwe755\n    cwe248 -->|CANPRECEDE| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe248 primary\n    class cwe755,cwe400 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **UnhandledPromiseRejection error thrown by micromatch** (CWE-248). This leads to the node process crashing. The crashing of the node process leads to a Denial of Service (DoS) (CWE-400).\n\nRoot Cause: **UnhandledPromiseRejection error thrown by micromatch** (CWE-248)\nImpact: Denial of Service (DoS) (CWE-400)\n\n## Summary of Analysis\nThe initial assessment identified CWE-248 as the primary weakness, which is an uncaught exception. The **Vulnerability Description Key Phrases** section highlights that the rootcause is the **UnhandledPromiseRejection error thrown by micromatch**. The **CVE Reference Links Content Summary** confirms that the `http-proxy-middleware` doesn't handle this error properly, leading to an `UnhandledPromiseRejection` that crashes the Node.js process. This directly supports the selection of CWE-248.\n\nThe graph relationships influenced the final selection by emphasizing the direct link between the uncaught exception and the denial of service. CWE-248 is at the optimal level of specificity because it accurately represents the **rootcause** of the vulnerability, which is the uncaught exception itself.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-346: Origin Validation Error\n**Abstraction Level**: Class\n**Similarity Score**: 0.72\n**Source**: dense\n\n**Description**:\nThe product does not properly verify that the source of data or communication is valid.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-617: Reachable Assertion\n**Abstraction Level**: Base\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nThe product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-184: Incomplete List of Disallowed Inputs\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are not allowed by policy or otherwise require other action to neutralize before additional processing takes place, but the list is incomplete.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-918: Server-Side Request Forgery (SSRF)\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-755: Improper Handling of Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product does not handle or incorrectly handles an exceptional condition.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-703: Improper Check or Handling of Exceptional Conditions\n**Abstraction Level**: Pillar\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is extremely high-level, a Pillar.\n\n## CWE-138: Improper Neutralization of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')\n**Abstraction Level**: Variant\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product receives data from an HTTP agent/component (e.g., web server, proxy, browser, etc.), but it does not neutralize or incorrectly neutralizes CR and LF characters before the data is included in outgoing HTTP headers.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\n**Abstraction Level**: Class\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.\n\n## CWE-1333: Inefficient Regular Expression Complexity\n**Abstraction Level**: Base\n**Similarity Score**: 1161.36\n**Source**: sparse\n\n**Description**:\nThe product uses a regular expression with an inefficient, possibly exponential",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-248 | Uncaught Exception | 0.9 | Base | Allowed | Primary CWE: The **UnhandledPromiseRejection error thrown by micromatch** is an uncaught exception that leads to the crash. |\n| CWE-755 | Improper Handling of Exceptional Conditions | 0.7 | Class | Discouraged | Secondary CWE: The `http-proxy-middleware` does not properly handle the exception thrown by micromatch. |\n| CWE-400 | Uncontrolled Resource Consumption | 0.5 | Class | Discouraged | Secondary CWE: The lack of error handling leads to a Denial of Service, which is a form of uncontrolled resource consumption. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship influencing the CWE selection is the parent-child relationship. CWE-248 (Uncaught Exception) is a Base level CWE and a more specific case of CWE-755 (Improper Handling of Exceptional Conditions), which is a Class level CWE. The vulnerability description clearly points to an uncaught exception, justifying the selection of CWE-248 as the primary weakness. The other important relationship is the CANPRECEDE relationship of CWE-248 to CWE-400 (Uncontrolled Resource Consumption), where the uncaught exception leads to a denial of service by crashing the node process.\n\n```mermaid\ngraph TD\n    cwe248[\"CWE-248: Uncaught Exception\"]\n    cwe755[\"CWE-755: Improper Handling of Exceptional Conditions\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe248 -->|CHILDOF| cwe755\n    cwe248 -->|CANPRECEDE| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe248 primary\n    class cwe755,cwe400 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **UnhandledPromiseRejection error thrown by micromatch** (CWE-248). This leads to the node process crashing. The crashing of the node process leads to a Denial of Service (DoS) (CWE-400).\n\nRoot Cause: **UnhandledPromiseRejection error thrown by micromatch** (CWE-248)\nImpact: Denial of Service (DoS) (CWE-400)\n\n## Summary of Analysis\nThe initial assessment identified CWE-248 as the primary weakness, which is an uncaught exception. The **Vulnerability Description Key Phrases** section highlights that the rootcause is the **UnhandledPromiseRejection error thrown by micromatch**. The **CVE Reference Links Content Summary** confirms that the `http-proxy-middleware` doesn't handle this error properly, leading to an `UnhandledPromiseRejection` that crashes the Node.js process. This directly supports the selection of CWE-248.\n\nThe graph relationships influenced the final selection by emphasizing the direct link between the uncaught exception and the denial of service. CWE-248 is at the optimal level of specificity because it accurately represents the **rootcause** of the vulnerability, which is the uncaught exception itself.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-346: Origin Validation Error\n**Abstraction Level**: Class\n**Similarity Score**: 0.72\n**Source**: dense\n\n**Description**:\nThe product does not properly verify that the source of data or communication is valid.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-617: Reachable Assertion\n**Abstraction Level**: Base\n**Similarity Score**: 0.71\n**Source**: dense\n\n**Description**:\nThe product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-184: Incomplete List of Disallowed Inputs\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are not allowed by policy or otherwise require other action to neutralize before additional processing takes place, but the list is incomplete.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-918: Server-Side Request Forgery (SSRF)\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-755: Improper Handling of Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product does not handle or incorrectly handles an exceptional condition.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer\n**Abstraction Level**: Base\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-703: Improper Check or Handling of Exceptional Conditions\n**Abstraction Level**: Pillar\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is extremely high-level, a Pillar.\n\n## CWE-138: Improper Neutralization of Special Elements\n**Abstraction Level**: Class\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')\n**Abstraction Level**: Variant\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product receives data from an HTTP agent/component (e.g., web server, proxy, browser, etc.), but it does not neutralize or incorrectly neutralizes CR and LF characters before the data is included in outgoing HTTP headers.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\n**Abstraction Level**: Class\n**Similarity Score**: 0.69\n**Source**: dense\n\n**Description**:\nThe product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.\n\n## CWE-1333: Inefficient Regular Expression Complexity\n**Abstraction Level**: Base\n**Similarity Score**: 1161.36\n**Source**: sparse\n\n**Description**:\nThe product uses a regular expression with an inefficient, possibly exponential\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n**Chain starting from CWE-346:**\n- 346 (Origin Validation Error) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "248",
        "name": "Uncaught Exception",
        "source": "sparse"
      },
      "similarity": 330.96376511940105
    },
    {
      "metadata": {
        "doc_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "source": "sparse"
      },
      "similarity": 316.43321320112796
    },
    {
      "metadata": {
        "doc_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "source": "sparse"
      },
      "similarity": 311.8923830751497
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse"
      },
      "similarity": 308.00821467686717
    },
    {
      "metadata": {
        "doc_id": "203",
        "name": "Observable Discrepancy",
        "source": "sparse"
      },
      "similarity": 304.8055104051498
    },
    {
      "metadata": {
        "doc_id": "755",
        "name": "Improper Handling of Exceptional Conditions",
        "source": "sparse"
      },
      "similarity": 300.4572078681219
    },
    {
      "metadata": {
        "doc_id": "20",
        "name": "Improper Input Validation",
        "source": "sparse"
      },
      "similarity": 296.85786227772576
    },
    {
      "metadata": {
        "doc_id": "431",
        "name": "Missing Handler",
        "source": "sparse"
      },
      "similarity": 295.24832888705777
    },
    {
      "metadata": {
        "doc_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "type": "Base",
        "original_content": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
        "keyphrase_source": "rootcause:UnhandledPromiseRejection error thrown by micromatch",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.48527362604329766,
            "graph": 1.6092081216214449
          }
        }
      },
      "similarity": 0.48527362604329766
    },
    {
      "doc_id": "22",
      "text": "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "score": 1.7680000000000005,
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "type": "base",
        "original_content": "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "relationships": [
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "36",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "23",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "20",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "172",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "668",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "706",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "22",
            "target_id": "706",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "706",
            "target_id": "22",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "668",
            "target_id": "22",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "36",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1340"
            }
          },
          {
            "source_id": "36",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          },
          {
            "source_id": "36",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "23",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1340"
            }
          },
          {
            "source_id": "23",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          },
          {
            "source_id": "23",
            "target_id": "22",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "172",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 0.8,
          "sequence_path": 0.8
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "770",
                  "20",
                  "CANFOLLOW"
                ],
                [
                  "20",
                  "22",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.8,
              "type": "relationship_chain",
              "source": "770"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "770",
                  "20",
                  "CANFOLLOW"
                ],
                [
                  "20",
                  "22",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.8,
              "type": "vulnerability_sequence_forward",
              "source": "770"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 1.7680000000000005
          }
        }
      },
      "similarity": 1.7680000000000005
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-400",
      "CWE-346",
      "CWE-113",
      "CWE-248",
      "CWE-74",
      "CWE-755",
      "CWE-918",
      "CWE-184",
      "CWE-617",
      "CWE-138",
      "CWE-703",
      "CWE-1333",
      "CWE-212"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}