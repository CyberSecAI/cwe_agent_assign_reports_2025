# Retrieval Query for CVE-2024-31228

# Vulnerability Description

    Redis is an open source, in-memory database that persists on disk. Authenticated users can trigger a denial-of-service by using specially crafted, long string match patterns on supported commands such as `KEYS`, `SCAN`, `PSUBSCRIBE`, `FUNCTION LIST`, `COMMAND LIST` and ACL definitions. Matching of extremely long patterns may result in **unbounded recursion**, leading to **stack overflow** and process crash. This problem has been fixed in Redis versions 6.2.16, 7.2.6, and 7.4.1. Users are advised to upgrade. There are no known workarounds for this vulnerability.

    # Keyphrase-Specific CWE Analysis
    This vulnerability contains multiple keyphrases that may map to different CWEs. 
    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.

    ## WEAKNESS: 'stack overflow'

Relevant CWEs for this WEAKNESS:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-125: Out-of-bounds Read (Score: 490.08)

The product reads data past the end, or before the beginning, of the intended buffer....

### 4. CWE-789: Memory Allocation with Excessive Size Value (Score: 489.39)

The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....

### 5. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 485.63)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

## WEAKNESS: 'unbounded recursion'

Relevant CWEs for this WEAKNESS:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-407: Inefficient Algorithmic Complexity (Score: 477.48)

An algorithm in a product has an inefficient worst-case computational complexity that may be detrimental to system performance and can be triggered by an attacker, typically using crafted manipulations that ensure that the worst case is being reached....

### 4. CWE-770: Allocation of Resources Without Limits or Throttling (Score: 462.92)

The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor....

### 5. CWE-1333: Inefficient Regular Expression Complexity (Score: 461.35)

The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....

## IMPACT: 'stack overflow and process crash'

Relevant CWEs for this IMPACT:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-125: Out-of-bounds Read (Score: 490.08)

The product reads data past the end, or before the beginning, of the intended buffer....

### 4. CWE-789: Memory Allocation with Excessive Size Value (Score: 489.39)

The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....

### 5. CWE-770: Allocation of Resources Without Limits or Throttling (Score: 462.92)

The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor....

## VECTOR: 'specially crafted'

Relevant CWEs for this VECTOR:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-125: Out-of-bounds Read (Score: 490.08)

The product reads data past the end, or before the beginning, of the intended buffer....

### 4. CWE-789: Memory Allocation with Excessive Size Value (Score: 489.39)

The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....

### 5. CWE-1333: Inefficient Regular Expression Complexity (Score: 461.35)

The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....

## VECTOR: 'long string match patterns on supported commands'

Relevant CWEs for this VECTOR:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 485.63)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 4. CWE-1333: Inefficient Regular Expression Complexity (Score: 461.35)

The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....

### 5. CWE-193: Off-by-one Error (Score: 179.32)

A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value....

## ATTACKER: 'Authenticated users'

Relevant CWEs for this ATTACKER:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-789: Memory Allocation with Excessive Size Value (Score: 489.39)

The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....

### 4. CWE-770: Allocation of Resources Without Limits or Throttling (Score: 462.92)

The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor....

### 5. CWE-1333: Inefficient Regular Expression Complexity (Score: 461.35)

The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....

## PRODUCT: 'Redis'

Relevant CWEs for this PRODUCT:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-125: Out-of-bounds Read (Score: 490.08)

The product reads data past the end, or before the beginning, of the intended buffer....

### 4. CWE-1333: Inefficient Regular Expression Complexity (Score: 461.35)

The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....

### 5. CWE-94: Improper Control of Generation of Code ('Code Injection') (Score: 159.66)

The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment....

## VERSION: 'prior to 6.2.16'

Relevant CWEs for this VERSION:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-789: Memory Allocation with Excessive Size Value (Score: 489.39)

The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....

### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 485.63)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 5. CWE-1333: Inefficient Regular Expression Complexity (Score: 461.35)

The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....

## VERSION: '7.2.6'

Relevant CWEs for this VERSION:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-789: Memory Allocation with Excessive Size Value (Score: 489.39)

The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....

### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 485.63)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 5. CWE-1333: Inefficient Regular Expression Complexity (Score: 461.35)

The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....

## VERSION: 'and 7.4.1'

Relevant CWEs for this VERSION:

### 1. CWE-674: Uncontrolled Recursion (Score: 547.41)

The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack....

### 2. CWE-190: Integer Overflow or Wraparound (Score: 521.01)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 3. CWE-125: Out-of-bounds Read (Score: 490.08)

The product reads data past the end, or before the beginning, of the intended buffer....

### 4. CWE-789: Memory Allocation with Excessive Size Value (Score: 489.39)

The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated....

### 5. CWE-1333: Inefficient Regular Expression Complexity (Score: 461.35)

The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles....


    # Analysis Instructions
    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.
    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.
    3. Provide a final determination of primary CWE(s) and any secondary CWEs.
    4. Format your response using the standard analysis template.

    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.
    