{
  "cve_id": "CVE-2024-31228",
  "description": "Redis is an open source, in-memory database that persists on disk. Authenticated users can trigger a denial-of-service by using specially crafted, long string match patterns on supported commands such as `KEYS`, `SCAN`, `PSUBSCRIBE`, `FUNCTION LIST`, `COMMAND LIST` and ACL definitions. Matching of extremely long patterns may result in **unbounded recursion**, leading to **stack overflow** and process crash. This problem has been fixed in Redis versions 6.2.16, 7.2.6, and 7.4.1. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
  "key_phrases": {
    "rootcause": "",
    "weakness": [
      "stack overflow",
      "unbounded recursion"
    ],
    "impact": "stack overflow and process crash",
    "vector": [
      "specially crafted",
      "long string match patterns on supported commands"
    ],
    "attacker": "Authenticated users",
    "product": "Redis",
    "version": [
      "prior to 6.2.16",
      "7.2.6",
      "and 7.4.1"
    ],
    "component": ""
  },
  "reference_content": "Based on the provided information, this content is related to CVE-2024-31228.\n\n**Root cause of vulnerability:**\nThe vulnerability stems from unbounded recursion in the `stringmatchlen_impl` function, which is used for glob-style pattern matching within Redis. Specially crafted, long string match patterns can cause excessive recursion.\n\n**Weaknesses/vulnerabilities present:**\n- Unbounded recursion in the `stringmatchlen_impl` function during pattern matching.\n- Inefficient handling of nested wildcard characters, leading to excessive stack usage.\n\n**Impact of exploitation:**\n- Denial of service (DoS) via stack overflow, causing the Redis process to crash.\n\n**Attack vectors:**\n- Authenticated users can trigger the vulnerability.\n- Exploitable through commands such as `KEYS`, `SCAN`, `PSUBSCRIBE`, `FUNCTION LIST`, `COMMAND LIST`, and ACL definitions which use pattern matching.\n\n**Required attacker capabilities/position:**\n- An attacker needs to be an authenticated user of the Redis server.\n- The attacker needs to be able to execute commands that utilize the vulnerable pattern matching functionality.\n\n**Additional Details:**\n- The issue affects all versions of Redis prior to the patched versions.\n- The fix implemented in the provided commit introduces a nesting limit to prevent excessive recursion.\n- The vulnerability is classified as moderate severity with a CVSS score of 5.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H).\n- The vulnerability is tracked under CWE-674 (Improper Handling of Recursive Calls)",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-674 | Uncontrolled Recursion | 1.0 | Base | Primary | Allowed |\n| CWE-400 | Uncontrolled Resource Consumption | 0.7 | Class | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-674, Uncontrolled Recursion, which directly aligns with the vulnerability's description of **unbounded recursion** leading to **stack overflow**. CWE-400, Uncontrolled Resource Consumption, is considered as a related weakness, since uncontrolled recursion directly leads to consumption of memory resources.\n\n```mermaid\ngraph TD\n    cwe674[\"CWE-674: Uncontrolled Recursion\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe674 -->|CHILDOF| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe674 primary\n    class cwe400 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **unbounded recursion** (CWE-674), triggered by specially crafted long string match patterns. This **uncontrolled recursion** leads to excessive resource consumption, specifically of the stack, resulting in a **stack overflow** and ultimately causing a process crash. The chain can be summarized as:\n\n1.  **Improper Input**: Specially crafted long string match patterns.\n2.  **Root Cause**: **Uncontrolled Recursion** (CWE-674).\n3.  **Resource Consumption**: Stack exhaustion.\n4.  **Impact**: **Stack Overflow** and process crash.\n\n## Summary of Analysis\nThe primary weakness is clearly the **uncontrolled recursion** (CWE-674). The vulnerability description explicitly states that matching of extremely long patterns results in **unbounded recursion**, which leads to a **stack overflow** and process crash. This aligns perfectly with CWE-674's description: \"The product does not properly control the amount of recursion that takes place, consuming excessive resources, such as allocated memory or the program stack.\"\n\nThe retriever results also strongly support CWE-674, with the highest score for multiple keyphrases.\n\nCWE-400 (Uncontrolled Resource Consumption) is considered because the **uncontrolled recursion** directly leads to excessive consumption of memory resources. While the primary impact is a stack overflow, the underlying issue is the lack of control over resource consumption, which aligns with CWE-400.\n\nOther CWEs were considered but not selected. CWE-789 (Memory Allocation with Excessive Size Value) and CWE-770 (Allocation of Resources Without Limits or Throttling) were considered but deemed less relevant because the vulnerability is more directly related to **uncontrolled recursion** rather than memory allocation issues. Similarly, CWE-1333 (Inefficient Regular Expression Complexity) was considered due to the mention of \"long string match patterns,\" but the core weakness is the lack of control over the recursion caused by these patterns, making CWE-674 a more precise fit.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-407: Inefficient Algorithmic Complexity\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nAn algorithm in a product has an inefficient worst-case computational complexity that may be detrimental to system performance and can be triggered by an attacker, typically using crafted manipulations that ensure that the worst case is being reached.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-824: Access of Uninitialized Pointer\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product accesses or uses a pointer that has not been initialized.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n## CWE-330: Use of Insufficiently Random Values\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-754: Improper Check for Unusual or Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-696: Incorrect Behavior Order\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-799: Improper Control of Interaction Frequency\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not properly limit the number or frequency of interactions that it has with an actor, such as the number of incoming requests.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.\n\n## CWE-703: Improper Check or Handling of Exceptional Conditions\n**Abstraction Level**: Pillar\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is extremely high-level, a Pillar.\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-190: Integer Overflow or Wraparound\n**Abstraction Level**: Base\n**Similarity Score**: 4536.04\n**Source**: sparse\n\n**Description**:\nThe product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-674 | Uncontrolled Recursion | 1.0 | Base | Primary | Allowed |\n| CWE-400 | Uncontrolled Resource Consumption | 0.7 | Class | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-674, Uncontrolled Recursion, which directly aligns with the vulnerability's description of **unbounded recursion** leading to **stack overflow**. CWE-400, Uncontrolled Resource Consumption, is considered as a related weakness, since uncontrolled recursion directly leads to consumption of memory resources.\n\n```mermaid\ngraph TD\n    cwe674[\"CWE-674: Uncontrolled Recursion\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe674 -->|CHILDOF| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe674 primary\n    class cwe400 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **unbounded recursion** (CWE-674), triggered by specially crafted long string match patterns. This **uncontrolled recursion** leads to excessive resource consumption, specifically of the stack, resulting in a **stack overflow** and ultimately causing a process crash. The chain can be summarized as:\n\n1.  **Improper Input**: Specially crafted long string match patterns.\n2.  **Root Cause**: **Uncontrolled Recursion** (CWE-674).\n3.  **Resource Consumption**: Stack exhaustion.\n4.  **Impact**: **Stack Overflow** and process crash.\n\n## Summary of Analysis\nThe primary weakness is clearly the **uncontrolled recursion** (CWE-674). The vulnerability description explicitly states that matching of extremely long patterns results in **unbounded recursion**, which leads to a **stack overflow** and process crash. This aligns perfectly with CWE-674's description: \"The product does not properly control the amount of recursion that takes place, consuming excessive resources, such as allocated memory or the program stack.\"\n\nThe retriever results also strongly support CWE-674, with the highest score for multiple keyphrases.\n\nCWE-400 (Uncontrolled Resource Consumption) is considered because the **uncontrolled recursion** directly leads to excessive consumption of memory resources. While the primary impact is a stack overflow, the underlying issue is the lack of control over resource consumption, which aligns with CWE-400.\n\nOther CWEs were considered but not selected. CWE-789 (Memory Allocation with Excessive Size Value) and CWE-770 (Allocation of Resources Without Limits or Throttling) were considered but deemed less relevant because the vulnerability is more directly related to **uncontrolled recursion** rather than memory allocation issues. Similarly, CWE-1333 (Inefficient Regular Expression Complexity) was considered due to the mention of \"long string match patterns,\" but the core weakness is the lack of control over the recursion caused by these patterns, making CWE-674 a more precise fit.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-407: Inefficient Algorithmic Complexity\n**Abstraction Level**: Class\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nAn algorithm in a product has an inefficient worst-case computational complexity that may be detrimental to system performance and can be triggered by an attacker, typically using crafted manipulations that ensure that the worst case is being reached.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-824: Access of Uninitialized Pointer\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product accesses or uses a pointer that has not been initialized.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n## CWE-330: Use of Insufficiently Random Values\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-754: Improper Check for Unusual or Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-696: Incorrect Behavior Order\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-799: Improper Control of Interaction Frequency\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not properly limit the number or frequency of interactions that it has with an actor, such as the number of incoming requests.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-74 is high-level and often misused when lower-level weaknesses are more appropriate.\n\n## CWE-703: Improper Check or Handling of Exceptional Conditions\n**Abstraction Level**: Pillar\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product does not properly anticipate or handle exceptional conditions that rarely occur during normal operation of the product.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is extremely high-level, a Pillar.\n\n## CWE-1391: Use of Weak Credentials\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-190: Integer Overflow or Wraparound\n**Abstraction Level**: Base\n**Similarity Score**: 4536.04\n**Source**: sparse\n\n**Description**:\nThe product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n**Chain starting from CWE-407:**\n- 407 (Inefficient Algorithmic Complexity) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "674",
        "name": "Uncontrolled Recursion",
        "source": "sparse",
        "original_content": "The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack.",
        "keyphrase_sources": [
          {
            "id": "weakness:stack overflow",
            "keyphrase": "stack overflow",
            "type": "weakness"
          },
          {
            "id": "weakness:unbounded recursion",
            "keyphrase": "unbounded recursion",
            "type": "weakness"
          },
          {
            "id": "impact:stack overflow and process crash",
            "keyphrase": "stack overflow and process crash",
            "type": "impact"
          },
          {
            "id": "vector:specially crafted",
            "keyphrase": "specially crafted",
            "type": "vector"
          },
          {
            "id": "vector:long string match patterns on supported commands",
            "keyphrase": "long string match patterns on supported commands",
            "type": "vector"
          },
          {
            "id": "attacker:Authenticated users",
            "keyphrase": "Authenticated users",
            "type": "attacker"
          },
          {
            "id": "product:Redis",
            "keyphrase": "Redis",
            "type": "product"
          },
          {
            "id": "version:prior to 6.2.16",
            "keyphrase": "prior to 6.2.16",
            "type": "version"
          },
          {
            "id": "version:7.2.6",
            "keyphrase": "7.2.6",
            "type": "version"
          },
          {
            "id": "version:and 7.4.1",
            "keyphrase": "and 7.4.1",
            "type": "version"
          }
        ]
      },
      "similarity": 547.4059720973111
    },
    {
      "metadata": {
        "doc_id": "190",
        "name": "Integer Overflow or Wraparound",
        "source": "sparse",
        "original_content": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
        "keyphrase_sources": [
          {
            "id": "weakness:stack overflow",
            "keyphrase": "stack overflow",
            "type": "weakness"
          },
          {
            "id": "weakness:unbounded recursion",
            "keyphrase": "unbounded recursion",
            "type": "weakness"
          },
          {
            "id": "impact:stack overflow and process crash",
            "keyphrase": "stack overflow and process crash",
            "type": "impact"
          },
          {
            "id": "vector:specially crafted",
            "keyphrase": "specially crafted",
            "type": "vector"
          },
          {
            "id": "vector:long string match patterns on supported commands",
            "keyphrase": "long string match patterns on supported commands",
            "type": "vector"
          },
          {
            "id": "attacker:Authenticated users",
            "keyphrase": "Authenticated users",
            "type": "attacker"
          },
          {
            "id": "product:Redis",
            "keyphrase": "Redis",
            "type": "product"
          },
          {
            "id": "version:prior to 6.2.16",
            "keyphrase": "prior to 6.2.16",
            "type": "version"
          },
          {
            "id": "version:7.2.6",
            "keyphrase": "7.2.6",
            "type": "version"
          },
          {
            "id": "version:and 7.4.1",
            "keyphrase": "and 7.4.1",
            "type": "version"
          }
        ]
      },
      "similarity": 521.0106517050202
    },
    {
      "metadata": {
        "doc_id": "125",
        "name": "Out-of-bounds Read",
        "source": "sparse",
        "original_content": "The product reads data past the end, or before the beginning, of the intended buffer.",
        "keyphrase_sources": [
          {
            "id": "weakness:stack overflow",
            "keyphrase": "stack overflow",
            "type": "weakness"
          },
          {
            "id": "impact:stack overflow and process crash",
            "keyphrase": "stack overflow and process crash",
            "type": "impact"
          },
          {
            "id": "vector:specially crafted",
            "keyphrase": "specially crafted",
            "type": "vector"
          },
          {
            "id": "product:Redis",
            "keyphrase": "Redis",
            "type": "product"
          },
          {
            "id": "version:and 7.4.1",
            "keyphrase": "and 7.4.1",
            "type": "version"
          }
        ]
      },
      "similarity": 490.0832418676668
    },
    {
      "metadata": {
        "doc_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "source": "sparse",
        "original_content": "The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated.",
        "keyphrase_sources": [
          {
            "id": "weakness:stack overflow",
            "keyphrase": "stack overflow",
            "type": "weakness"
          },
          {
            "id": "impact:stack overflow and process crash",
            "keyphrase": "stack overflow and process crash",
            "type": "impact"
          },
          {
            "id": "vector:specially crafted",
            "keyphrase": "specially crafted",
            "type": "vector"
          },
          {
            "id": "attacker:Authenticated users",
            "keyphrase": "Authenticated users",
            "type": "attacker"
          },
          {
            "id": "version:prior to 6.2.16",
            "keyphrase": "prior to 6.2.16",
            "type": "version"
          },
          {
            "id": "version:7.2.6",
            "keyphrase": "7.2.6",
            "type": "version"
          },
          {
            "id": "version:and 7.4.1",
            "keyphrase": "and 7.4.1",
            "type": "version"
          }
        ]
      },
      "similarity": 489.3905469346435
    },
    {
      "metadata": {
        "doc_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "source": "sparse",
        "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
        "keyphrase_sources": [
          {
            "id": "weakness:stack overflow",
            "keyphrase": "stack overflow",
            "type": "weakness"
          },
          {
            "id": "vector:long string match patterns on supported commands",
            "keyphrase": "long string match patterns on supported commands",
            "type": "vector"
          },
          {
            "id": "version:prior to 6.2.16",
            "keyphrase": "prior to 6.2.16",
            "type": "version"
          },
          {
            "id": "version:7.2.6",
            "keyphrase": "7.2.6",
            "type": "version"
          }
        ]
      },
      "similarity": 485.62793469915687
    },
    {
      "metadata": {
        "doc_id": "407",
        "name": "Inefficient Algorithmic Complexity",
        "source": "sparse",
        "original_content": "An algorithm in a product has an inefficient worst-case computational complexity that may be detrimental to system performance and can be triggered by an attacker, typically using crafted manipulations that ensure that the worst case is being reached.",
        "keyphrase_sources": [
          {
            "id": "weakness:unbounded recursion",
            "keyphrase": "unbounded recursion",
            "type": "weakness"
          }
        ]
      },
      "similarity": 477.48061193212794
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse",
        "original_content": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
        "keyphrase_sources": [
          {
            "id": "weakness:unbounded recursion",
            "keyphrase": "unbounded recursion",
            "type": "weakness"
          },
          {
            "id": "impact:stack overflow and process crash",
            "keyphrase": "stack overflow and process crash",
            "type": "impact"
          },
          {
            "id": "attacker:Authenticated users",
            "keyphrase": "Authenticated users",
            "type": "attacker"
          }
        ]
      },
      "similarity": 462.92229012057663
    },
    {
      "metadata": {
        "doc_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "source": "sparse",
        "original_content": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles.",
        "keyphrase_sources": [
          {
            "id": "weakness:unbounded recursion",
            "keyphrase": "unbounded recursion",
            "type": "weakness"
          },
          {
            "id": "vector:specially crafted",
            "keyphrase": "specially crafted",
            "type": "vector"
          },
          {
            "id": "vector:long string match patterns on supported commands",
            "keyphrase": "long string match patterns on supported commands",
            "type": "vector"
          },
          {
            "id": "attacker:Authenticated users",
            "keyphrase": "Authenticated users",
            "type": "attacker"
          },
          {
            "id": "product:Redis",
            "keyphrase": "Redis",
            "type": "product"
          },
          {
            "id": "version:prior to 6.2.16",
            "keyphrase": "prior to 6.2.16",
            "type": "version"
          },
          {
            "id": "version:7.2.6",
            "keyphrase": "7.2.6",
            "type": "version"
          },
          {
            "id": "version:and 7.4.1",
            "keyphrase": "and 7.4.1",
            "type": "version"
          }
        ]
      },
      "similarity": 461.34527200317035
    },
    {
      "metadata": {
        "doc_id": "193",
        "name": "Off-by-one Error",
        "source": "sparse",
        "original_content": "A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value.",
        "keyphrase_sources": [
          {
            "id": "vector:long string match patterns on supported commands",
            "keyphrase": "long string match patterns on supported commands",
            "type": "vector"
          }
        ]
      },
      "similarity": 179.32286057988014
    },
    {
      "metadata": {
        "doc_id": "94",
        "name": "Improper Control of Generation of Code ('Code Injection')",
        "source": "sparse",
        "original_content": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
        "keyphrase_sources": [
          {
            "id": "product:Redis",
            "keyphrase": "Redis",
            "type": "product"
          }
        ]
      },
      "similarity": 159.65712412327295
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-400",
      "CWE-407",
      "CWE-770",
      "CWE-330",
      "CWE-703",
      "CWE-799",
      "CWE-190",
      "CWE-674",
      "CWE-696",
      "CWE-74",
      "CWE-668",
      "CWE-1391",
      "CWE-824",
      "CWE-789",
      "CWE-1333",
      "CWE-754"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {
    "674": [
      {
        "id": "weakness:stack overflow",
        "keyphrase": "stack overflow",
        "type": "weakness"
      },
      {
        "id": "weakness:unbounded recursion",
        "keyphrase": "unbounded recursion",
        "type": "weakness"
      },
      {
        "id": "impact:stack overflow and process crash",
        "keyphrase": "stack overflow and process crash",
        "type": "impact"
      },
      {
        "id": "vector:specially crafted",
        "keyphrase": "specially crafted",
        "type": "vector"
      },
      {
        "id": "vector:long string match patterns on supported commands",
        "keyphrase": "long string match patterns on supported commands",
        "type": "vector"
      },
      {
        "id": "attacker:Authenticated users",
        "keyphrase": "Authenticated users",
        "type": "attacker"
      },
      {
        "id": "product:Redis",
        "keyphrase": "Redis",
        "type": "product"
      },
      {
        "id": "version:prior to 6.2.16",
        "keyphrase": "prior to 6.2.16",
        "type": "version"
      },
      {
        "id": "version:7.2.6",
        "keyphrase": "7.2.6",
        "type": "version"
      },
      {
        "id": "version:and 7.4.1",
        "keyphrase": "and 7.4.1",
        "type": "version"
      }
    ],
    "190": [
      {
        "id": "weakness:stack overflow",
        "keyphrase": "stack overflow",
        "type": "weakness"
      },
      {
        "id": "weakness:unbounded recursion",
        "keyphrase": "unbounded recursion",
        "type": "weakness"
      },
      {
        "id": "impact:stack overflow and process crash",
        "keyphrase": "stack overflow and process crash",
        "type": "impact"
      },
      {
        "id": "vector:specially crafted",
        "keyphrase": "specially crafted",
        "type": "vector"
      },
      {
        "id": "vector:long string match patterns on supported commands",
        "keyphrase": "long string match patterns on supported commands",
        "type": "vector"
      },
      {
        "id": "attacker:Authenticated users",
        "keyphrase": "Authenticated users",
        "type": "attacker"
      },
      {
        "id": "product:Redis",
        "keyphrase": "Redis",
        "type": "product"
      },
      {
        "id": "version:prior to 6.2.16",
        "keyphrase": "prior to 6.2.16",
        "type": "version"
      },
      {
        "id": "version:7.2.6",
        "keyphrase": "7.2.6",
        "type": "version"
      },
      {
        "id": "version:and 7.4.1",
        "keyphrase": "and 7.4.1",
        "type": "version"
      }
    ],
    "125": [
      {
        "id": "weakness:stack overflow",
        "keyphrase": "stack overflow",
        "type": "weakness"
      },
      {
        "id": "impact:stack overflow and process crash",
        "keyphrase": "stack overflow and process crash",
        "type": "impact"
      },
      {
        "id": "vector:specially crafted",
        "keyphrase": "specially crafted",
        "type": "vector"
      },
      {
        "id": "product:Redis",
        "keyphrase": "Redis",
        "type": "product"
      },
      {
        "id": "version:and 7.4.1",
        "keyphrase": "and 7.4.1",
        "type": "version"
      }
    ],
    "789": [
      {
        "id": "weakness:stack overflow",
        "keyphrase": "stack overflow",
        "type": "weakness"
      },
      {
        "id": "impact:stack overflow and process crash",
        "keyphrase": "stack overflow and process crash",
        "type": "impact"
      },
      {
        "id": "vector:specially crafted",
        "keyphrase": "specially crafted",
        "type": "vector"
      },
      {
        "id": "attacker:Authenticated users",
        "keyphrase": "Authenticated users",
        "type": "attacker"
      },
      {
        "id": "version:prior to 6.2.16",
        "keyphrase": "prior to 6.2.16",
        "type": "version"
      },
      {
        "id": "version:7.2.6",
        "keyphrase": "7.2.6",
        "type": "version"
      },
      {
        "id": "version:and 7.4.1",
        "keyphrase": "and 7.4.1",
        "type": "version"
      }
    ],
    "1284": [
      {
        "id": "weakness:stack overflow",
        "keyphrase": "stack overflow",
        "type": "weakness"
      },
      {
        "id": "vector:long string match patterns on supported commands",
        "keyphrase": "long string match patterns on supported commands",
        "type": "vector"
      },
      {
        "id": "version:prior to 6.2.16",
        "keyphrase": "prior to 6.2.16",
        "type": "version"
      },
      {
        "id": "version:7.2.6",
        "keyphrase": "7.2.6",
        "type": "version"
      }
    ],
    "407": [
      {
        "id": "weakness:unbounded recursion",
        "keyphrase": "unbounded recursion",
        "type": "weakness"
      }
    ],
    "770": [
      {
        "id": "weakness:unbounded recursion",
        "keyphrase": "unbounded recursion",
        "type": "weakness"
      },
      {
        "id": "impact:stack overflow and process crash",
        "keyphrase": "stack overflow and process crash",
        "type": "impact"
      },
      {
        "id": "attacker:Authenticated users",
        "keyphrase": "Authenticated users",
        "type": "attacker"
      }
    ],
    "1333": [
      {
        "id": "weakness:unbounded recursion",
        "keyphrase": "unbounded recursion",
        "type": "weakness"
      },
      {
        "id": "vector:specially crafted",
        "keyphrase": "specially crafted",
        "type": "vector"
      },
      {
        "id": "vector:long string match patterns on supported commands",
        "keyphrase": "long string match patterns on supported commands",
        "type": "vector"
      },
      {
        "id": "attacker:Authenticated users",
        "keyphrase": "Authenticated users",
        "type": "attacker"
      },
      {
        "id": "product:Redis",
        "keyphrase": "Redis",
        "type": "product"
      },
      {
        "id": "version:prior to 6.2.16",
        "keyphrase": "prior to 6.2.16",
        "type": "version"
      },
      {
        "id": "version:7.2.6",
        "keyphrase": "7.2.6",
        "type": "version"
      },
      {
        "id": "version:and 7.4.1",
        "keyphrase": "and 7.4.1",
        "type": "version"
      }
    ],
    "193": [
      {
        "id": "vector:long string match patterns on supported commands",
        "keyphrase": "long string match patterns on supported commands",
        "type": "vector"
      }
    ],
    "94": [
      {
        "id": "product:Redis",
        "keyphrase": "Redis",
        "type": "product"
      }
    ]
  }
}