## Vulnerability Description
A vulnerability was found in PCMan FTP Server up to 2.0.7. It has been classified as critical. Affected is an unknown function of the component PROMPT Command Handler. The manipulation leads to **buffer overflow**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** up to 2.0.7
- **component:** PROMPT Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-4158 Content

This content **RELATES** to a vulnerability in PCMan FTP Server, specifically a remote buffer overflow. It provides a detailed exploit script and analysis, going beyond the information typically found in a CVE description.

Here's a breakdown of the extracted information:

**Root cause of vulnerability:**

*   The vulnerability is a buffer overflow in the `PROMPT` command handling of PCMan FTP Server version 2.0.7. The server does not properly validate the length of the input provided to this command, allowing an attacker to overwrite memory regions.

**Weaknesses/vulnerabilities present:**

*   Buffer Overflow
*   Improper Input Validation

**Impact of exploitation:**

*   Remote code execution. The exploit aims to overwrite the instruction pointer (EIP) to point to a shellcode payload, allowing the attacker to execute arbitrary code on the target system.

**Attack vectors:**

*   Remote network connection via FTP (port 21).
*   Sending a crafted `PROMPT` command with a payload exceeding the buffer size.

**Required attacker capabilities/position:**

*   Network access to the target PCMan FTP Server.
*   Ability to send FTP commands.
*   Knowledge of the buffer overflow offset (2004 bytes) and the address of a suitable jump instruction (0x74e32fd9 - JMP ESP).
*   Ability to craft a shellcode payload compatible with the target architecture (x86 Windows).

**Mitigation or fix:**

*   The content does not explicitly mention a fix. However, the root cause indicates that proper input validation and buffer size checks in the `PROMPT` command handling would mitigate the vulnerability.  Upgrading to a patched version of PCMan FTP Server is the recommended solution.

**Additional Details:**

*   **Version Affected:** 2.0.7
*   **Tested on:** Windows XP SP3 (Build 2600)
*   **Exploit Script:** The provided Perl script demonstrates how to connect to the FTP server, authenticate anonymously, send the crafted `PROMPT` command, and trigger the buffer overflow.
*   **Shellcode:** The script includes a shellcode payload generated using `msfvenom` to establish a reverse TCP connection to a specified host and port (192.168.176.136:4444).
*   **Offset:** 2004 bytes
*   **EIP overwrite:** 0x74e32fd9 (JMP ESP)
*   **Bad Characters:** \x00\x0a\x0d
*   The script uses `IO::Socket::INET` for network communication.
*   The script includes NOP sled (`\x90`x20) to increase the reliability of the exploit.

This content provides a significantly more detailed technical analysis of the vulnerability and a working exploit than a standard CVE description would typically offer.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.398 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.382 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.345 |
| 7 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.339 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.332 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.575 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-125: Out-of-bounds Read

CWE-705: Incorrect Control Flow Scoping

CWE-121: Stack-based Buffer Overflow

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-128: Wrap-around Error