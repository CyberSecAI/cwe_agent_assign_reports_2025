# Vulnerability Information: CVE-2024-52919

## Vulnerability Description
Bitcoin Core before 22.0 has a CAddrMan nIdCount **integer overflow** and resultant assertion failure (and daemon exit) via a flood of addr messages.

### Vulnerability Description Key Phrases
- **weakness:** **integer overflow**
- **impact:** assertion failure and daemon exit
- **vector:** flood of addr messages
- **product:** Bitcoin Core
- **version:** before 22.0
- **component:** CAddrMan nIdCount

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": [
    {
      "cve": "CVE-2024-52919",
      "related_content": true,
       "source": "bitcoincore.org_aad6b00f_20250115_081831.html",
      "details": {
        "root_cause": "Integer overflow in the `nIdCount` field within the `CAddrMan` class.",
        "weaknesses": [
          "The 32-bit `nIdCount` field is incremented on every insertion into addrman, and is used as an identifier for new entries. It is vulnerable to an integer overflow attack if a large number of entries are added."
        ],
        "impact": "The overflow leads to an assertion crash, resulting in a denial of service.",
        "attack_vector": "Spamming 'addr' messages to the victim, causing them to insert numerous entries into their address manager.",
        "attacker_capabilities": "The attacker needs the ability to send network messages to the victim node."
      }
    },
    {
      "cve": "CVE-2024-52919",
      "related_content": true,
       "source": "en.bitcoin.it_d953b06a_20250115_081832.html",
      "details": {
        "root_cause": "Integer overflow in the `CAddrMan` component related to address management",
          "weaknesses": [
             "Integer overflow vulnerability in the `CAddrMan` component of Bitcoin Core."
          ],
         "impact": "Denial of service via a crash due to the integer overflow.",
         "attack_vector": "Exploited via a p2p spam attack, likely involving a large volume of crafted network messages.",
         "attacker_capabilities": "Requires the ability to send messages to a Bitcoin Core node."
      }
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 2 | 195 | Signed to Unsigned Conversion Error | Variant | Allowed | sparse | 0.141 |
| 3 | 681 | Incorrect Conversion between Numeric Types | Base | Allowed | sparse | 0.127 |
| 4 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.126 |
| 5 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.126 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.125 |
| 7 | 664 | Improper Control of a Resource Through its Lifetime | Pillar | Discouraged | sparse | 0.124 |
| 8 | 704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | sparse | 0.123 |
| 9 | 680 | Integer Overflow to Buffer Overflow | Compound | Discouraged | dense | 0.474 |
| 10 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | Allowed | graph | 0.002 |

