## Vulnerability Description
An unauthenticated remote attacker can use a malicious OPC UA client to send a crafted request to affected CODESYS products which can cause a DoS due to **incorrect calculation of buffer size**.

### Vulnerability Description Key Phrases
- **rootcause:** **incorrect calculation of buffer size**
- **impact:** DoS
- **vector:** crafted request
- **attacker:** unauthenticated remote attacker
- **product:** CODESYS products

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The CODESYS OPC UA stack incorrectly calculates the required buffer size for received requests/responses.

**Weakness/Vulnerability:**
-  Incorrect calculation of buffer size (CWE-131).

**Impact of Exploitation:**
-  A crash of the CODESYS runtime system during the subsequent initialization of the receive buffer with zero, leading to a denial-of-service (DoS).

**Attack Vectors:**
- A malicious OPC UA client sends a crafted request to a CODESYS product with an affected CODESYS OPC UA server.
- A CODESYS product with an affected CODESYS OPC UA client connects to a malicious OPC UA server.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send network traffic to the affected CODESYS device.
- The attacker does not need to be authenticated.

**Additional Notes:**
- The vulnerability affects both the CODESYS OPC UA Server and Client implementations.
- A mitigation is available by limiting the maximum array length of the OPC UA stack, however, the recommended fix is to upgrade to a patched version.
- The vulnerability was reported by ABB Schweiz AG and coordinated by CERT@VDE.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 131 | Incorrect Calculation of Buffer Size | Base | Allowed | sparse | 0.284 |
| 2 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.263 |
| 3 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.258 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.248 |
| 5 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | sparse | 0.244 |
| 6 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | sparse | 0.243 |
| 7 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.240 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.239 |
| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | dense | 0.561 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-131: Incorrect Calculation of Buffer Size

CWE-193: Off-by-one Error

CWE-190: Integer Overflow or Wraparound

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-805: Buffer Access with Incorrect Length Value

CWE-823: Use of Out-of-range Pointer Offset

CWE-126: Buffer Over-read

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-128: Wrap-around Error