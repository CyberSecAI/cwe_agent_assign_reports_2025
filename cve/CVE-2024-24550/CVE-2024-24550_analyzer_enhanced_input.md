## Vulnerability Description
A security vulnerability has been identified in Bludit, allowing attackers with knowledge of the API token to upload arbitrary files through the File API which leads to arbitrary code execution on the server. This vulnerability arises from **improper handling of file uploads**, enabling malicious actors to upload and execute PHP files.

### Vulnerability Description Key Phrases
- **rootcause:** **improper handling of file uploads**
- **impact:** arbitrary code execution
- **attacker:** attackers with knowledge of the API token
- **product:** Bludit

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-24550:

**Root cause of vulnerability:**

- The Bludit File API has an undocumented file upload feature that lacks proper file type checking (neither extension nor MIME type are verified).
-  Uploaded files are stored directly within the web root, making them accessible to anyone.

**Weaknesses/vulnerabilities present:**

- **Unrestricted File Upload:** The API allows uploading of arbitrary file types.
- **Lack of File Type Validation:** No checks are performed on the uploaded file's extension or MIME type.
- **Insecure Storage Location:** Uploaded files are placed directly under the web root.

**Impact of exploitation:**

- **Remote Code Execution (RCE):** An attacker can upload and execute malicious PHP code (e.g., a web shell).
- **Arbitrary Command Execution:**  After uploading a PHP web shell, an attacker (even unauthenticated users) can execute commands on the server.
- **Complete System Compromise:**  Successful exploitation could lead to a full compromise of the web server.

**Attack vectors:**

- **API Exploitation:** Attackers can exploit the undocumented File API upload feature.
- **Direct File Access:**  Uploaded files can be accessed directly through their URL since they are located under the web root.

**Required attacker capabilities/position:**

- **Knowledge of API Token:** The attacker needs to obtain a valid API token.
- **Network Access:** The attacker must be able to send HTTP requests to the Bludit server.
- **API Enabled**: The Bludit administrator must have enabled the API

**Additional Details:**

*   The vulnerability is present in the code committed about 4 years ago.
*   The exploit code provided shows how to obtain the UUID and upload a shell.php file which then allows for executing commands via a `cmd` parameter.
*   The vulnerability affects all versions of Bludit since 3.14.0.
*   The file upload feature is not documented, suggesting it may not be intended for public use.
*   The advisory recommends removing the file upload API or implementing an allowlist for allowed file types.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.323 |
| 2 | 799 | Improper Control of Interaction Frequency | Class | Allowed-with-Review | sparse | 0.313 |
| 3 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.308 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.299 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.298 |
| 6 | 24 | Path Traversal: '../filedir' | Variant | Allowed | sparse | 0.295 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.294 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.291 |
| 9 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | Allowed | dense | 0.591 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |



# Complete CWE Specifications

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-799: Improper Control of Interaction Frequency

CWE-425: Direct Request ('Forced Browsing')

CWE-23: Relative Path Traversal

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-24: Path Traversal: '../filedir'

CWE-306: Missing Authentication for Critical Function

CWE-863: Incorrect Authorization

CWE-646: Reliance on File Name or Extension of Externally-Supplied File

CWE-94: Improper Control of Generation of Code ('Code Injection')