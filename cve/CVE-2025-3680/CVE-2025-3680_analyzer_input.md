# Vulnerability Information: CVE-2025-3680

## Vulnerability Description
A vulnerability has been found in PCMan FTP Server 2.0.7 and classified as critical. Affected by this vulnerability is an unknown functionality of the component LANG Command Handler. The manipulation leads to **buffer overflow**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** LANG Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3680 Content

This content **RELATES** to a vulnerability in PCMan FTP Server, specifically a remote buffer overflow. It provides a detailed exploit script.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the `LANG` command handling of PCMan FTP Server version 2.0.7. The server does not properly validate the length of the input provided to the `LANG` command, allowing an attacker to send a string longer than the allocated buffer, overwriting adjacent memory regions.

**Weaknesses/vulnerabilities present:**

*   **Buffer Overflow:** The core vulnerability is a buffer overflow.
*   **Improper Input Validation:** The server fails to validate the size of the input to the `LANG` command.

**Impact of exploitation:**

Successful exploitation allows an attacker to overwrite the execution flow of the program, potentially leading to arbitrary code execution. The exploit script aims to redirect execution to a shellcode payload.

**Attack vectors:**

*   **Remote:** The vulnerability is exploitable remotely via the FTP protocol.
*   **Network:** Requires network connectivity to the target FTP server.
*   **Specific Command:** Exploitation is achieved by sending a crafted string to the `LANG` command.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the target FTP server on port 21.
*   **Exploit Knowledge:** The attacker needs knowledge of buffer overflow exploitation techniques and the target architecture.
*   **Shellcode:** The attacker needs to craft and embed shellcode into the exploit payload.

**Mitigation or fix:**

The content does not explicitly mention a fix. However, the vulnerability can be mitigated by:

*   **Input Validation:** Implementing proper input validation on the `LANG` command to limit the length of the accepted string.
*   **Buffer Overflow Protection:** Employing buffer overflow protection mechanisms such as stack canaries or Address Space Layout Randomization (ASLR).
*   **Software Update:** Updating to a patched version of PCMan FTP Server (if available).

**Additional Details (More than official CVE description):**

*   **Version Specificity:** The exploit is specifically designed for PCMan FTP Server version 2.0.7.
*   **Offset:** The exploit script uses an offset of 2006 bytes.
*   **EIP Override:** The exploit attempts to overwrite the EIP register with `0x74e32fd9` (JMP ESP).
*   **Shellcode:** The script includes shellcode generated using `msfvenom` to establish a reverse TCP shell.
*   **Bad Characters:** The shellcode is encoded to avoid bad characters (`\x00\x0a\x0d`).
*   **Exploit Script:** The provided Perl script demonstrates a complete exploit implementation, including connection establishment, authentication, and sending the malicious `LANG` command.
*   **Tested Environment:** The exploit was tested on Windows XP SP3.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.393 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.374 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.338 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.327 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.323 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.567 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

