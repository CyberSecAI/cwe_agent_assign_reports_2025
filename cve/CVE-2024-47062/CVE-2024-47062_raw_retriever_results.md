# Raw Retriever Results for CVE-2024-47062

# Raw Retriever Results for CVE-2024-47062
## Query
Navidrome is an open source web-based music collection server and streamer. Navidrome automatically adds parameters in the URL to SQL queries. This can be exploited to access information by adding parameters like `password=...` in the URL (ORM Leak). Furthermore, the names of the parameters are not properly escaped, leading to SQL Injections. Finally, the username is used in a `LIKE` statement, allowing people to log in with `%` instead of their username. When adding parameters to the URL, they are automatically included in an SQL `LIKE` statement (depending on the parameters name). This allows attackers to potentially retrieve arbitrary information. For example, attackers can use the following request to test whether some encrypted passwords start with `AAA`. This results in an SQL query like `password LIKE AAA%`, allowing attackers to slowly brute-force passwords. When adding parameters to the URL, they are automatically added to an SQL query. The names of the parameters are not properly escaped. This behavior can be used to inject arbitrary SQL code (SQL Injection). These vulnerabilities can be used to leak information and dump the contents of the database and have been addressed in release version 0.53.0. Users are advised to upgrade. There are no known workarounds for this vulnerability.

## Keyphrases
- **rootcause**: 'improper input escaping'
- **weakness**: 'SQL injection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5226 | 0.5752 | 0.5402 | 0.5410 | 20 |
| Sparse | 1012.0448 | 1240.9504 | 1106.9065 | 1092.2772 | 12 |
| Graph | 1.4994 | 2.8652 | 1.9782 | 1.9040 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 117 | Improper Output Neutralization for Logs | base | 2.8652 | Allowed |
| 2 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.6784 | Allowed |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | compound | 2.6308 | Allowed |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 2.4779 | Allowed |
| 5 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 6 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 7 | 613 | Insufficient Session Expiration | base | 2.0930 | Allowed |
| 8 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 2.0670 | Allowed |
| 9 | 456 | Missing Initialization of a Variable | variant | 2.0400 | Allowed |
| 10 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 2.0400 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 1.6748 | Allowed |
| 13 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 1.6683 | Allowed |
| 14 | 457 | Use of Uninitialized Variable | variant | 1.6320 | Allowed |
| 15 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.5752 | 0.5752 | Allowed |
| 2 | 790 | Improper Filtering of Special Elements | Class | 0.5615 | 0.5615 | Allowed-with-Review |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.5520 | 0.5520 | Allowed |
| 4 | 204 | Observable Response Discrepancy | Base | 0.5517 | 0.5517 | Allowed |
| 5 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.5475 | 0.5475 | Allowed |
| 6 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.5468 | 0.5468 | Allowed |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5458 | 0.5458 | Allowed |
| 8 | 306 | Missing Authentication for Critical Function | Base | 0.5429 | 0.5429 | Allowed |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.5428 | 0.5428 | Allowed |
| 10 | 346 | Origin Validation Error | Class | 0.5428 | 0.5428 | Allowed-with-Review |
| 11 | 209 | Generation of Error Message Containing Sensitive Information | Base | 0.5393 | 0.5393 | Allowed |
| 12 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.5355 | 0.5355 | Allowed |
| 13 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5330 | 0.5330 | Allowed |
| 14 | 425 | Direct Request ('Forced Browsing') | Base | 0.5320 | 0.5320 | Allowed |
| 15 | 294 | Authentication Bypass by Capture-replay | Base | 0.5289 | 0.5289 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 116 | Improper Encoding or Escaping of Output | 1240.9504 | 1240.9504 | Allowed-with-Review |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | 1202.6391 | 1202.6391 | Allowed |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | 1132.6780 | 1132.6780 | Allowed |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | 1123.4430 | 1123.4430 | Allowed |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1116.1136 | 1116.1136 | Allowed |
| 6 | 285 | Improper Authorization | 1092.5475 | 1092.5475 | Discouraged |
| 7 | 20 | Improper Input Validation | 1092.0069 | 1092.0069 | Discouraged |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | 1087.1133 | 1087.1133 | Allowed |
| 9 | 918 | Server-Side Request Forgery (SSRF) | 1085.7986 | 1085.7986 | Allowed |
| 10 | 138 | Improper Neutralization of Special Elements | 1081.6101 | 1081.6101 | Discouraged |
| 11 | 434 | Unrestricted Upload of File with Dangerous Type | 1015.9322 | 1015.9322 | Allowed |
| 12 | 209 | Generation of Error Message Containing Sensitive Information | 1012.0448 | 1012.0448 | Allowed |
