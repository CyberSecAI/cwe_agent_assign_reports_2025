# Vulnerability Information: CVE-2025-32080

## Vulnerability Description
Exposure of Sensitive Information to an Unauthorized Actor vulnerability in The Wikimedia Foundation Mediawiki - Mobile Frontend Extension allows Shared Resource Manipulation.This issue affects Mediawiki - Mobile Frontend Extension from 1.39 through 1.43.

### Vulnerability Description Key Phrases
- **impact:** Exposure of Sensitive Information to an Unauthorized Actor and Shared Resource Manipulation
- **product:** Mediawiki - Mobile Frontend Extension
- **version:** 1.39 through 1.43

## CVE Reference Links Content Summary
## CVE-2025-32080 Analysis

Based on the provided content from phabricator.wikimedia.org, this relates to CVE-2025-32080. The content details a cross-origin data leak vulnerability in MobileFrontend due to lazy-loaded images.

**Root cause of vulnerability:**

The vulnerability stems from the ability of users to construct `span` tags with the class `lazy-image-placeholder` and `data-src` attributes. These attributes, when processed, allow bypassing sanitization and making arbitrary GET requests, potentially leaking user information (like IP addresses or the current page).

**Weaknesses/vulnerabilities present:**

*   Insufficient sanitization of user-provided data used in lazy-loaded images.
*   Use of `data-src` attribute which is vulnerable to manipulation.

**Impact of exploitation:**

*   Leakage of user data (e.g., IP address, current page) to external resources.
*   Privacy violation.

**Attack vectors:**

*   An attacker can craft a malicious page or edit an existing page to include a `span` tag with a crafted `data-src` attribute.
*   When a user views the page, the browser will make a GET request to the attacker-controlled resource, potentially sending sensitive information.

**Required attacker capabilities/position:**

*   The attacker needs the ability to create or modify content on a MediaWiki site using MobileFrontend.

**Mitigation or fix:**

*   Replace `data-src` with `data-mw-src` (and similar for other attributes) as the MediaWiki sanitizer forbids attributes starting with `data-mw`.
*   Ensure compatibility with both `data-src` and `data-mw-src` during the transition to avoid breaking image display.
*   Consider implementing a Content Security Policy (CSP) as a longer-term solution.
*   Backporting the fix to older releases.

**Additional Details:**

*   The fix involved multiple patches applied to different release branches (REL1\_39, REL1\_40, REL1\_41, REL1\_42, REL1\_43, master, and wmf branches).
*   The fix was verified through test cases, including checking for the absence of `data-src` and `data-srcset` in the page source and ensuring no broken images appear in the editor preview.
*   The issue was initially discovered and reported in January/February 2025, with the fix deployed in late February 2025.
*   The task was marked as verified after successful deployment and testing.

The content provides more detail than the official CVE description would likely contain, including specific details about the patches, testing procedures, and deployment timeline.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.061 |
| 2 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.052 |
| 3 | 704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | sparse | 0.051 |
| 4 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.051 |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.050 |
| 6 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.049 |
| 7 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.048 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.047 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.559 |
| 10 | 499 | Serializable Class Containing Sensitive Data | Variant | Allowed | graph | 0.003 |

