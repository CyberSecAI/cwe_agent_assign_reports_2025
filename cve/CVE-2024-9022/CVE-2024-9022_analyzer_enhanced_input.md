## Vulnerability Description
The TS Poll - Survey, Versus Poll, Image Poll, Video Poll plugin for WordPress is vulnerable to SQL Injection via the orderby parameter in all versions up to, and including, 2.3.9 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Administrator-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** authenticated attackers with Administrator-level access
- **product:** TS Poll - Survey and Versus Poll and Image Poll and Video Poll plugin for WordPress
- **version:** up to and including 2.3.9
- **component:** orderby parameter

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**CVE ID:** CVE-2024-9022

**Root Cause of Vulnerability:**
The vulnerability is due to insufficient sanitization of the 'orderby' parameter in the TS Poll plugin for WordPress. This lack of proper input validation and sanitization allows for the injection of malicious SQL code into database queries.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The primary vulnerability is a SQL injection flaw. The 'orderby' parameter, which is intended for ordering query results, is not properly sanitized, allowing attackers to inject arbitrary SQL code.

**Impact of Exploitation:**
- **Data Breach:** Successful exploitation can lead to the disclosure of sensitive information stored in the WordPress database.
- **Data Manipulation:** Attackers could potentially modify or delete data within the database.
- **Privilege Escalation:** It might be possible to leverage SQL injection to gain unauthorized administrative access to the WordPress site.

**Attack Vectors:**
- **HTTP GET Request:** The attack vector is through a specially crafted HTTP GET request to the WordPress admin panel, manipulating the 'orderby' parameter.

**Required Attacker Capabilities/Position:**
- **Authentication:** The attacker needs to be authenticated as a WordPress administrator or higher-level user to exploit this vulnerability. This indicates that the vulnerability is accessible to a user within the WordPress admin panel.

**Additional Details:**

- The vulnerability affects versions of the TS Poll plugin up to and including version 2.4.0.
- The vulnerability was patched in version 2.4.1 of the plugin.
- Public exploits are available on sites like GitHub and Packet Storm.
- The vulnerable parameter is 'orderby' and it is passed via an HTTP GET request.

The provided information is more detailed than the basic CVE description, which was a placeholder. It gives a clear understanding of the vulnerability and how to exploit it.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.573 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.517 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.508 |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.505 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.502 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.498 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.491 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.458 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-863: Incorrect Authorization

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-502: Deserialization of Untrusted Data

CWE-790: Improper Filtering of Special Elements

CWE-138: Improper Neutralization of Special Elements

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')