## Vulnerability Description
A vulnerability in mintplex-labs/anything-llm prior to version 1.2.2 allows for Prisma injection. The issue exists in the API endpoint /embed/embedId/stream-chat where user-provided JSON is directly taken to the Prisma librarys where clause. An attacker can exploit this by providing a specially crafted JSON object, such as {sessionId{nota}}, causing Prisma to return all data from the table. This can lead to unauthorized access to all user queries in embedded chat mode.

### Vulnerability Description Key Phrases
- **impact:** unauthorized access
- **vector:** specially crafted JSON object
- **attacker:** attacker
- **product:** mintplex-labs/anything-llm
- **version:** prior to version 1.2.2
- **component:** /embed/embedId/stream-chat

## CVE Reference Links Content Summary
The content relates to a commit in the `anything-llm` project on GitHub. The commit message states "pre-validate sessionID type for embed chats". 

Here's a breakdown of the changes:

**Root cause of vulnerability:**
The code did not validate the type of the `sessionId` before using it, potentially leading to issues if an invalid session ID was provided.

**Weaknesses/vulnerabilities present:**
Lack of input validation for `sessionId`.

**Impact of exploitation:**
The impact isn't explicitly stated, but an invalid `sessionId` could lead to unexpected behavior, errors, or potentially security vulnerabilities if the session ID is used in security-sensitive operations.

**Attack vectors:**
Providing an invalid `sessionId` as part of a request.

**Required attacker capabilities/position:**
An attacker needs to be able to send requests to the application with a crafted `sessionId`. No authentication is required to exploit this.

**Mitigation or fix:**
The commit adds validation to ensure that the `sessionId` is a string and a valid UUID using the `uuid` library's `validate` function. If the `sessionId` is invalid, the server responds with a 404 error and an "Invalid session ID" message.

The content provides more detail than the official CVE description would likely contain, as it shows the specific code changes made to address the issue.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.141 |
| 2 | 183 | Permissive List of Allowed Inputs | Base | Allowed | sparse | 0.133 |
| 3 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.130 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.129 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.129 |
| 6 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.129 |
| 7 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.128 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.128 |
| 9 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | Allowed | dense | 0.525 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-347: Improper Verification of Cryptographic Signature

CWE-183: Permissive List of Allowed Inputs

CWE-502: Deserialization of Untrusted Data

CWE-306: Missing Authentication for Critical Function

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-918: Server-Side Request Forgery (SSRF)

CWE-1287: Improper Validation of Specified Type of Input

CWE-116: Improper Encoding or Escaping of Output

CWE-1427: Improper Neutralization of Input Used for LLM Prompting

CWE-425: Direct Request ('Forced Browsing')