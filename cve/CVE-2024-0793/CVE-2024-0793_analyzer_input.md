# Vulnerability Information: CVE-2024-0793

## Vulnerability Description
A flaw was found in kube-controller-manager. This issue occurs when the initial application of a HPA config YAML lacking a .spec.behavior.scaleUp block causes a denial of service due to KCM pods going into restart churn.

### Vulnerability Description Key Phrases
- **impact:** denial of service
- **vector:** HPA config YAML lacking a .spec.behavior.scaleUp block
- **product:** kube-controller-manager

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The Horizontal Pod Autoscaler (HPA) controller in Kubernetes versions prior to 1.27 could crash due to nil pointer dereferences when processing partially defined HPA behaviors. This occurs because the controller reads the HPA object as v2, where HPA behaviors are not optional, but v1 objects may not fully define the behavior fields. When converting from v1 to v2, the missing fields are not defaulted causing nil dereferences during processing.",
  "Weaknesses/vulnerabilities present": "Nil pointer dereference vulnerability in the HPA controller when handling partially filled HPA behavior specifications. Improper handling of optional behavior fields in v1 objects when converting them to v2, leading to nil dereferences.",
  "Impact of exploitation": "Exploitation leads to the `kube-controller-manager` crashing and entering `CrashLoopBackOff`. This effectively causes a denial-of-service by preventing the HPA controller from functioning, potentially impacting auto-scaling capabilities.",
  "Attack vectors": "A user can create or update a HorizontalPodAutoscaler manifest with a v1 API that defines some, but not all, of the HPA behavior fields (e.g., scaleDown but not scaleUp).",
  "Required attacker capabilities/position": "The attacker needs to be an authenticated user with the ability to create or modify HorizontalPodAutoscaler resources within the Kubernetes cluster."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.072 |
| 2 | 833 | Deadlock | Base | Allowed | sparse | 0.067 |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.065 |
| 4 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.064 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.064 |
| 6 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.062 |
| 7 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.062 |
| 8 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.061 |
| 9 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | dense | 0.454 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.003 |

