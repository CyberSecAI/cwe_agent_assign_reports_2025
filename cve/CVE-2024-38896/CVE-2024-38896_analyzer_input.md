# Vulnerability Information: CVE-2024-38896

## Vulnerability Description
WAVLINK WN551K1 found a **command injection** vulnerability through the start_hour parameter of /cgi-bin/nightled.cgi.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** WAVLINK WN551K1
- **component:** /cgi-bin/nightled.cgi

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability lies in the `nightled.cgi` script of the Wavlink WN551K1 router. Specifically, the `start_hour` parameter is vulnerable to command injection due to insufficient input sanitization. The provided data is copied to a buffer (v33) and executed without proper filtering.

**Weaknesses/Vulnerabilities:**
- Command Injection: The primary vulnerability is the ability to inject arbitrary commands into the system via the `start_hour` parameter.
- Lack of Input Sanitization: The script does not properly validate or sanitize the input received through the `start_hour` parameter before using it in a command execution.

**Impact of Exploitation:**
- Arbitrary Command Execution: An attacker can execute arbitrary system commands on the router.
- Full Control of the Device: Successful command injection can allow an attacker to gain complete control over the device, potentially leading to data exfiltration, malware installation, or denial of service.

**Attack Vectors:**
- HTTP POST Request: The attack is carried out by sending a crafted HTTP POST request to the `/cgi-bin/nightled.cgi` endpoint.
- Parameter Manipulation: The attacker injects malicious code into the `start_hour` parameter of the HTTP POST request.

**Required Attacker Capabilities/Position:**
- Network Access: The attacker needs to have network access to the router's web interface.
- No Authentication Required: The provided information does not suggest that authentication is needed for exploitation, although this could be further verified.

**Technical Details:**
- Vulnerable parameter: `start_hour`
- Vulnerable script: `/cgi-bin/nightled.cgi`
- Unfiltered copy to a buffer: Input is copied to the `v33` buffer without any filtering.

**PoC:**
```
POST /cgi-bin/nightled.cgi HTTP/1.1
Host: 42.2.134.152
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Upgrade-Insecure-Requests: 1

page=night_led&start_hour=;ls;
```

The PoC demonstrates that sending the `start_hour` parameter with the value `;ls;` results in the `ls` command being executed on the router.

This detailed breakdown confirms that the content is relevant to CVE-2024-38896 and provides a thorough understanding of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.155 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.108 |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.102 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.100 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.100 |
| 8 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.094 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.540 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |

