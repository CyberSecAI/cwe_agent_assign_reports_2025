# Vulnerability Information: CVE-2024-35423

## Vulnerability Description
vmir e8117 was discovered to contain a **heap buffer overflow** via the wasm_parse_section_functions function at /src/vmir_wasm_parser.c.

### Vulnerability Description Key Phrases
- **weakness:** **heap buffer overflow**
- **product:** vmir
- **version:** e8117
- **component:** wasm_parse_section_functions function at /src/vmir_wasm_parser.c

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
- A null pointer dereference occurs in the `wasm_parse_section_functions` function within `src/vmir_wasm_parser.c`. This happens when parsing a crafted WebAssembly (wasm) file, specifically when a section with type 65 is encountered. The code attempts to access a memory address that is NULL.

**Weaknesses/vulnerabilities present:**
- Null pointer dereference. The code does not properly handle a situation where a pointer becomes NULL during the parsing process.

**Impact of exploitation:**
- **Code execution:** The vulnerability can potentially lead to code execution if an attacker can control the crafted wasm file and trigger the dereference in a way that allows further exploitation.
- **Denial of service (DoS):** The null pointer dereference will cause the program to crash, resulting in a denial of service.

**Attack vectors:**
- A crafted wasm file. An attacker can create a malicious wasm file designed to trigger the null pointer dereference during parsing.

**Required attacker capabilities/position:**
- The attacker needs to be able to provide the crafted wasm file as input to the vulnerable application.

**Additional details:**
- The issue was found using AddressSanitizer (ASAN) which detected a SEGV (segmentation fault) during the execution.
- The specific commit affected is e81176b.
- The vulnerability was reported by Ziyi Guo.
- The vulnerability is located in `src/vmir_wasm_parser.c` at line 432 within the `wasm_parse_section_functions` function.
- The issue is referenced on github in the issue tracker under `andoma/vmir#18`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.180 |
| 4 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.146 |
| 5 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.144 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.142 |
| 7 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.139 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.136 |
| 9 | 680 | Integer Overflow to Buffer Overflow | Compound | Discouraged | dense | 0.546 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

