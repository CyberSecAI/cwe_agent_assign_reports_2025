## Vulnerability Description
GStreamer is a library for constructing graphs of media-handling components. An OOB-read vulnerability has been identified in the gst_avi_subtitle_parse_gab2_chunk function within gstavisubtitle.c. The function reads the name_length value directly from the input file without checking it properly. Then, the a condition, does not properly handle cases where name_length is greater than 0xFFFFFFFF - 17, causing an **integer overflow**. In such scenario, the function attempts to access memory beyond the buffer leading to an OOB-read. This vulnerability is fixed in 1.24.10.

### Vulnerability Description Key Phrases
- **weakness:** **integer overflow**
- **impact:** OOB-read
- **product:** GStreamer
- **version:** before 1.24.10
- **component:** gst_avi_subtitle_parse_gab2_chunk function within gstavisubtitle.c

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-47774

**Root Cause:**
- The vulnerability stems from an integer overflow vulnerability within the `gst_avi_subtitle_parse_gab2_chunk` function in `gstavisubtitle.c`.
- The `name_length` is read from the input file without proper validation, leading to potential integer overflow when used in subsequent size checks.

**Weaknesses/Vulnerabilities:**
- **Integer Overflow:** The code calculates the required buffer size (`17 + name_length`) without checking for potential overflow, especially when `name_length` is close to the maximum value for a 32-bit unsigned integer.
- **Out-of-Bounds Read:** The vulnerability allows for reading data beyond the allocated buffer size due to the overflowed size calculation and subsequent memory access attempts.

**Impact of Exploitation:**
- **Application Crash:** The out-of-bounds read can cause the application using the GStreamer library to crash.
- **Information Leak:** The vulnerability could also potentially lead to leaking memory contents, which could contain sensitive information.

**Attack Vectors:**
- **Malicious AVI File:** An attacker could craft a malicious AVI file containing a large `name_length` value to trigger the integer overflow and out-of-bounds read in the affected function.

**Required Attacker Capabilities/Position:**
- The attacker needs the ability to supply a crafted AVI file containing a specific value for the `name_length` field.

**Additional Notes:**

- The provided patch addresses the integer overflow issue by explicitly checking if the `name_length` value, when added to `17`, would result in a value greater than `G_MAXUINT32` before performing the buffer size comparison. This prevents out-of-bounds access by avoiding the overflow. The fix includes a similar check for the total length calculation as well (17 + name_length + file_length).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 2 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.522 |
| 3 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.448 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.447 |
| 5 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.445 |
| 6 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.428 |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.427 |
| 8 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | Allowed-with-Review | sparse | 0.423 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.550 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-190: Integer Overflow or Wraparound

CWE-125: Out-of-bounds Read

CWE-191: Integer Underflow (Wrap or Wraparound)

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-122: Heap-based Buffer Overflow

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-754: Improper Check for Unusual or Exceptional Conditions

CWE-126: Buffer Over-read

CWE-128: Wrap-around Error