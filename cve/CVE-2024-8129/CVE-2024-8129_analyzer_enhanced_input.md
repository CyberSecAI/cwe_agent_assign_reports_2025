## Vulnerability Description
A vulnerability, which was classified as critical, was found in D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04 up to 20240814. Affected is the function cgi_s3_modify of the file /cgi-bin/s3.cgi of the component HTTP POST Request Handler. The manipulation of the argument f_job_name leads to **command injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. NOTE This vulnerability only affects products that are no longer supported by the maintainer. NOTE Vendor was contacted early and confirmed that the product is end-of-life. It should be retired and replaced.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **vector:** manipulation of f_job_name argument
- **product:** D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04
- **version:** up to 20240814
- **component:** /cgi-bin/s3.cgi

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause of Vulnerability:**

*   The root cause is a command injection vulnerability in the `cgi_s3_modify` function within the `/cgi-bin/s3.cgi` file of D-Link NAS devices.

**Weaknesses/Vulnerabilities Present:**

*   **Command Injection:** The `f_job_name` variable, passed through a POST request, is used in a `popen` command without proper sanitization. The variable is assigned to `v10` using `snprintf` before being passed to popen.

**Impact of Exploitation:**

*   **Command Execution:** An attacker can execute arbitrary commands on the affected device by injecting malicious code into the `f_job_name` parameter.

**Attack Vectors:**

*   **HTTP POST Request:** The vulnerability is triggered through a crafted HTTP POST request to `/cgi-bin/s3.cgi`, specifically targeting the `cgi_s3_modify` function.
*   **`f_job_name` parameter:** The malicious payload is injected within the `f_job_name` parameter.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to send HTTP POST requests to the vulnerable device's web interface. The attacker must have network access to the device.

**Additional Notes:**

*   The vulnerability affects multiple D-Link NAS models including DNS-320, DNS-320L, DNS-321, DNS-323, DNS-325, and DNS-327L, and all firmware versions.
*   The affected devices are considered end-of-life (EOL) and no longer receive security updates.
*   D-Link recommends retiring and replacing these devices due to the risk.
*   The report originated from BuaaIOTTeam.
* The vulnerability is also tracked as VulDB entry 275700.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.761 |
| 4 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.711 |
| 5 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.694 |
| 6 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.693 |
| 7 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.683 |
| 8 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.676 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.655 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-346: Origin Validation Error

CWE-330: Use of Insufficiently Random Values

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-341: Predictable from Observable State

CWE-941: Incorrectly Specified Destination in a Communication Channel

CWE-790: Improper Filtering of Special Elements

CWE-322: Key Exchange without Entity Authentication