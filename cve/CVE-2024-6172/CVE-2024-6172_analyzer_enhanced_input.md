## Vulnerability Description
The Email Subscribers by Icegram Express - Email Marketing, Newsletters, Automation for WordPress & WooCommerce plugin for WordPress is vulnerable to time-based SQL Injection via the db parameter in all versions up to, and including, 5.7.25 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL injection**
- **impact:** extract sensitive information from the database and information disclosure
- **vector:** db parameter
- **attacker:** unauthenticated attackers
- **product:** Email Subscribers by Icegram Express - Email Marketing
- **version:** up to and including 5.7.25

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-89

#### Top CWEs
- CWE-89 (Count: 14)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2024-6172:

**Root Cause of Vulnerability:**

*   **Insufficient Input Sanitization:** The vulnerability stems from a lack of proper sanitization of user-supplied input in the `db` parameter.
*   **Inadequate SQL Query Preparation:** The existing SQL query was not sufficiently prepared, allowing for the injection of additional SQL queries.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection (SQLi):**  The primary vulnerability is a time-based SQL injection. This allows attackers to manipulate database queries by inserting arbitrary SQL code. Specifically, the vulnerability occurs in the `edit_list_contact_status` function within `class-es-db-contacts.php` during the unsubscription process.

**Impact of Exploitation:**

*   **Sensitive Data Exposure:** Attackers can exploit this vulnerability to extract sensitive information directly from the database.
*   **Potential for Data Modification:** While not explicitly stated, SQL injection vulnerabilities often also allow for data modification, insertion, or deletion.
*   **Complete compromise:** Unauthenticated SQL injection vulnerabilities could lead to complete compromise of a web application depending on the type of database user the web application uses.

**Attack Vectors:**

*   **Unauthenticated Remote Attack:** The vulnerability can be exploited by remote, unauthenticated attackers.
*   **HTTP Requests:** The attack is carried out by crafting malicious HTTP requests that include the vulnerable `db` parameter with injected SQL code.

**Required Attacker Capabilities/Position:**

*   **Network Access:** Attackers need network access to the affected server.
*   **No Authentication Needed:** No prior authentication or user privileges are required to exploit this vulnerability.
*   **Basic Web Knowledge:** The attacker needs knowledge about crafting HTTP requests.
*   **SQL knowledge:** Attacker requires knowledge of SQL in order to inject the query.

**Additional Notes:**

*   **Wordfence Detection:** The vulnerability was identified and reported by Wordfence.
*   **Patch Availability:** The vulnerability was fixed in version 5.7.26 of the plugin.
*   **CVE-2024-37252:** The content mentions that CVE-2024-37252 appears to be a duplicate of this issue.
*   **Affected Component:** The vulnerability is located within the `lite/includes/db/class-es-db-contacts.php` file of the plugin.

**Summary of Changes:**

The provided changeset highlights the following modifications made to address the vulnerability:

*   **`email-subscribers.php`:** The version number was updated to 5.7.26.
*    **`email-subscribers-admin.js`:** Updated the Javascript to load the preview in an iframe to prevent XSS.
*   **`class-es-db-contacts.php`:** The SQL query within the `edit_list_contact_status` function was modified to use placeholders when using `IN` clauses.

This information provides a comprehensive analysis of CVE-2024-6172 based on the provided content.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.586 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.533 |
| 4 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.530 |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.520 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.501 |
| 7 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.500 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.496 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.493 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-341: Predictable from Observable State

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-502: Deserialization of Untrusted Data

CWE-862: Missing Authorization

CWE-863: Incorrect Authorization

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-613: Insufficient Session Expiration