# Vulnerability Information: CVE-2025-31486

## Vulnerability Description
Vite is a frontend tooling framework for javascript. The contents of arbitrary files can be returned to the browser. By adding ?.svg with ?.wasm?init or with sec-fetch-dest script header, the server.fs.deny restriction was able to bypass. This bypass is only possible if the file is smaller than build.assetsInlineLimit (default 4kB) and when using Vite 6.0+. Only apps explicitly exposing the Vite dev server to the network (using --host or server.host config option) are affected. This vulnerability is fixed in 4.5.12, 5.4.17, 6.0.14, 6.1.4, and 6.2.5.

### Vulnerability Description Key Phrases
- **rootcause:** **The fs.deny restriction was able to bypass**
- **vector:** adding ?.svg with ?.wasm?init, sec-fetch-dest script header
- **product:** Vite
- **impact:** return contents of arbitrary files
- **version:** 6.0+

## CVE Reference Links Content Summary
## Analysis of CVE-2025-31486 based on provided content:

The provided content details a security vulnerability in Vite (versions >=6.2.0, <=6.2.4, >=6.1.0, <=6.1.3, >=6.0.0, <=6.0.13, >=5.0.0, <=5.4.16, and <=4.5.11) that allows arbitrary file content to be returned to the browser. This vulnerability is tracked as GHSA-xcj6-pq6g-qj4x and is assigned CVE-2025-31486.

**Root cause of vulnerability:**

*   The vulnerability stems from insufficient validation of file requests, specifically related to `.svg` files and relative paths.
*   For `.svg` files, the code at `packages/vite/src/node/plugins/asset.ts` incorrectly handles requests ending with `.svg`, allowing access to arbitrary files. This bypass is possible with `?.svg?.wasm?init` or `sec-fetch-dest: script` header.
*   The check for relative paths was performed before the ID normalization, enabling bypasses using paths like `../../`.

**Weaknesses/vulnerabilities present:**

*   **Path Traversal:** The relative path vulnerability allows an attacker to traverse the file system.
*   **Insecure Direct Object Reference (IDOR):** The `.svg` vulnerability allows access to files based on a potentially manipulated identifier.
*   **Insufficient Input Validation:** Lack of proper validation of file paths and extensions.

**Impact of exploitation:**

*   An attacker can read arbitrary files from the server, potentially exposing sensitive information (e.g., `/etc/passwd`).

**Attack vectors:**

*   Sending crafted HTTP requests to the Vite dev server with specific file paths (e.g., `http://127.0.0.1:5173/etc/passwd?.svg?.wasm?init` or `http://127.0.0.1:5173/@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&?raw`).
*   Exploitation requires the Vite dev server to be exposed to the network (using `--host` or `server.host` config option).

**Required attacker capabilities/position:**

*   Network access to the Vite dev server.
*   Ability to send crafted HTTP requests.
*   No authentication is required.

**Mitigation or fix:**

*   Upgrade to a patched version of Vite: >=6.2.5, >=6.1.4, >=6.0.14, >=5.4.17, or >=4.5.12.

**Additional details:**

*   The vulnerability is only exploitable if the requested file is smaller than the `build.assetsInlineLimit` (default: 4kB).
*   The provided content includes a Proof of Concept (PoC) demonstrating how to read the `/etc/passwd` file.
*   The vulnerability has been reported by multiple security researchers.
*   CVSS score: 5.3/10 (Moderate).

This analysis provides more detail than the official CVE description, as it includes specific code locations, PoC examples, and a detailed explanation of the root cause and attack vectors.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.550 |
| 2 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.544 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.544 |
| 4 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.543 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.541 |
| 6 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.534 |
| 7 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.531 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.529 |
| 9 | 830 | Inclusion of Web Functionality from an Untrusted Source | Variant | Allowed | dense | 0.433 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.002 |

