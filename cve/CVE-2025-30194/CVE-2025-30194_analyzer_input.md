# Vulnerability Information: CVE-2025-30194

## Vulnerability Description
When DNSdist is configured to provide DoH via the nghttp2 provider, an attacker can cause a denial of service by crafting a DoH exchange that triggers an **illegal memory access** (**double-free**) and crash of DNSdist, causing a denial of service. The remedy is upgrade to the patched 1.9.9 version. A workaround is to temporarily switch to the h2o provider until DNSdist has been upgraded to a fixed version. We would like to thank Charles Howes for bringing this issue to our attention.

### Vulnerability Description Key Phrases
- **component:** nghttp2 provider
- **rootcause:** **double-free**
- **vector:** crafting a DoH exchange
- **weakness:** **illegal memory access**
- **product:** DNSdist
- **impact:** crash, denial of service
- **attacker:** attacker
- **version:** pre 1.9.9

## CVE Reference Links Content Summary
Here's an analysis of the provided content related to CVE-2025-30194:

**Content from dnsdist.org_80dbcbfa_20250624_165629.html (text)**

*   **Root cause of vulnerability:** Crafting a DoH exchange triggers an illegal memory access (double-free).
*   **Weaknesses/vulnerabilities present:** Denial of service.
*   **Impact of exploitation:** Denial of service.
*   **Attack vectors:** An attacker crafts a malicious DoH exchange.
*   **Required attacker capabilities/position:** Remote, unauthenticated attacker.
*   **Mitigation or fix:** Upgrade to DNSdist 1.9.9 or later. A workaround is to temporarily switch to the h2o provider.
*   **More detail than the official CVE description:** Yes, this content provides a detailed explanation of the vulnerability including the specific version affected and workarounds.

**Content from www.openwall.com_3fb63079_20250624_165628.html (text)**

*   **UNRELATED**

**Content from www.vicarius.io_31ef3d5f_20250624_165630.html (text)**

*   **Relevant information:** The content mentions CVE-2025-30194 and provides a link.
*   **More detail than the official CVE description:** No, this content just mentions the CVE ID.

**Content from www.vicarius.io_a5d9c318_20250624_165632.html (text)**

*   **Relevant information:** The content mentions CVE-2025-30194 and provides a link.
*   **More detail than the official CVE description:** No, this content just mentions the CVE ID.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 415 | Double Free | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 908 | Use of Uninitialized Resource | Base | Allowed | sparse | 0.489 |
| 3 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.484 |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.474 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.468 |
| 6 | 457 | Use of Uninitialized Variable | Variant | Allowed | sparse | 0.465 |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.464 |
| 8 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.463 |
| 9 | 617 | Reachable Assertion | Base | Allowed | dense | 0.462 |
| 10 | 364 | Signal Handler Race Condition | Base | Allowed | graph | 0.003 |

