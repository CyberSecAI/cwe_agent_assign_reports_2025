## Vulnerability Description
wire-webapp is the web application for the open-source messaging service Wire. A **bug fix caused a regression** causing an issue with function to delete local data. Instructing the client to delete its local database on user logout does not result in deletion. This is the case for both temporary clients (marking the device as a public computer on login) and regular clients instructing the deletion of all personal information and conversations upon logout. Access to the machine is required to access the data. If encryption-at-rest is used, cryptographic material cant be exported. The underlying issue has been fixed with wire-webapp version 2025-05-14-production.0. In order to mitigate potential impact, the database must be manually deleted on devices where the option This is a public computer was used prior to log in or a log out with the request to delete local data with the affected versions has happened before.

### Vulnerability Description Key Phrases
- **rootcause:** **bug fix caused a regression**
- **impact:** delete local data does not result in deletion
- **product:** wire-webapp
- **version:** prior to 2025-05-14-production.0

## CVE Reference Links Content Summary
```text
CVE-2025-48066
```
```text
**Description:**
A recently added bug fix caused a regression causing an issue with function to delete local data.

**Impact:**
Instructing the client to delete its local database on user logout does not result in deletion. This is the case for both temporary clients (marking the device as a public computer on login) and regular clients instructing the deletion of all personal information and conversations upon logout. Access to the machine is required to access the data. If encryption-at-rest is used, cryptographic material can't be exported.

**Patches:**
The underlying issue has been fixed with wire-webapp version 2025-05-14-production.0

**Workarounds:**
In order to mitigate potential impact, the database must be manually deleted on devices
* where the option "This is a public computer" was used prior to log in or
* a log out with the request to delete local data with the affected versions has happened before.

**Severity:**
Moderate
CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.887 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.858 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.856 |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.831 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.824 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.823 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.821 |
| 8 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.818 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.403 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1390: Weak Authentication

CWE-863: Incorrect Authorization

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-285: Improper Authorization

CWE-287: Improper Authentication

CWE-321: Use of Hard-coded Cryptographic Key

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-73: External Control of File Name or Path