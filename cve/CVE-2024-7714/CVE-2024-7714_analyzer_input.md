# Vulnerability Information: CVE-2024-7714

## Vulnerability Description
The AI ChatBot with ChatGPT and Content Generator by AYS WordPress plugin before 2.1.0 lacks sufficient access controls allowing an unauthenticated user to disconnect the AI ChatBot with ChatGPT and Content Generator by AYS WordPress plugin before 2.1.0 from OpenAI, thereby disabling the AI ChatBot with ChatGPT and Content Generator by AYS WordPress plugin before 2.1.0. Multiple actions are accessible ays_chatgpt_disconnect, ays_chatgpt_connect, and ays_chatgpt_save_feedback

### Vulnerability Description Key Phrases
- **rootcause:** **lacking sufficient access controls**
- **impact:** disconnect from OpenAI, disable the plugin
- **vector:** unsanitized user input
- **attacker:** unauthenticated user
- **product:** AI ChatBot with ChatGPT and Content Generator by AYS WordPress plugin
- **version:** before 2.1.0
- **component:** multiple actions

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-7714.

**Root cause of vulnerability:**
The AI Assistant with ChatGPT by AYS plugin lacks sufficient access controls.

**Weaknesses/vulnerabilities present:**
- Unauthenticated AJAX calls are possible for several actions including:
    - `ays_chatgpt_disconnect`
    - `ays_chatgpt_connect`
    - `ays_chatgpt_save_feedback`
- Lack of proper access control allows unauthenticated users to disconnect the plugin from OpenAI.

**Impact of exploitation:**
- An unauthenticated attacker can disconnect the plugin from OpenAI, effectively disabling the plugin's functionality.
- An unauthenticated user can connect to the plugin and configure the OpenAI API settings.

**Attack vectors:**
- Sending a crafted HTTP request to the `/wp-admin/admin-ajax.php` endpoint with the specific `action` and `function` parameters.
- Example:
    - Disconnect: `https://example.com/wp-admin/admin-ajax.php?ays_chatgpt_assistant_id=1&action=ays_chatgpt_admin_ajax&function=ays_chatgpt_disconnect`
    - Configure: `curl -X POST --data 'ays_chatgpt_assistant_api_key=XXX&ays_chatgpt_assistant_id=1&rMethod=GET&request_type=models&action=ays_chatgpt_admin_ajax&function=ays_chatgpt_connect' 'https://example.com/wp-admin/admin-ajax.php'`

**Required attacker capabilities/position:**
- No authentication is required. The attacker needs only network access to the affected WordPress site.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.368 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.355 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.346 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.344 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.343 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.343 |
| 7 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.339 |
| 8 | 552 | Files or Directories Accessible to External Parties | Base | Allowed | sparse | 0.336 |
| 9 | 1426 | Improper Validation of Generative AI Output | Base | Discouraged | dense | 0.494 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

