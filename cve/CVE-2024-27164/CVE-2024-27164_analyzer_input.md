# Vulnerability Information: CVE-2024-27164

## Vulnerability Description
Toshiba printers contain **hardcoded credentials**. As for the affected products/models/versions, see the reference URL.

### Vulnerability Description Key Phrases
- **rootcause:** **hardcoded credentials**
- **product:** Toshiba printers

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-27164:

**1. Verification of CVE Relevance:**

   - The provided content directly mentions CVE-2024-27164 as a "Use of Hard-coded Password" vulnerability in Toshiba Tec and Oki Electric Industry MFPs. This aligns with the CVE's description, which involves hardcoded passwords within the device firmware.

**2. Extracted Vulnerability Information:**

*   **Root Cause of Vulnerability**: The root cause of CVE-2024-27164 is the presence of a hardcoded password within the MFP's software. Specifically, part of the authentication password between the multifunction device's internal programs is written directly into the program.

*   **Weaknesses/Vulnerabilities Present**:
    *   Use of hardcoded credentials/passwords. This is a fundamental security flaw where sensitive authentication information is directly embedded into the software.
     *  The telnetd service is configured with hardcoded credentials in `/encryption/al/network/config/telnet.conf` which is `PassWord=System` and `UserName=Admin`.
   *  The same hardcoded key `1048toshibatec` is used in multiple scripts to encrypt logs. 
   *  The same hardcoded key `1048toshibatec` is used to encrypt files, including core files.
    *   The `mod_contentwebserver.so` library has a vulnerability with a time-based blind XML External Entity (XXE) vulnerability. It also has a vulnerability to a XML External Entity (XXE).
    * The `/contentwebserver/upload` API is insecure.
    * The printers are using insecure default SNMP communities (`public` and `private`) allowing remote code execution as root.
    * Some python modules and libraries are world-writable and lead to remote code execution vulnerabilities.
    * The printers lack privileges separation, where most of the programs are running as root.
    *  A vulnerable script `/tmp/backtraceScript.sh` is executed as root when a program crashes.
    * Some of the python WSGI applications are configured with insecure .ini files which can be overwritten.
    *  The printers have an insecure PATH variable allowing a local user or remote attacker to replace legitimate programs with malicious ones.
    *  The printers contain an insecure `LD_PRELOAD` and an insecure `LD_LIBRARY_PATH`.
    * 106 programs are running as root with insecure permissions.
    * The `cissm` program is using an insecure XML configuration file.
    * A hardcoded root password is used in all devices
    * A session disclosure exists inside log files.
    * An insecure implementation of the web interface exposes a DOM-based XSS vulnerability.
    * An insecure implementation of the web interface leaks admin credentials.
    * The implementation of a chain of trust when installing a new application is broken due to a TOCTOU vulnerability.
   * Insecure file upload allows code execution.
   * Local file inclusion vulnerability in an API allows reading any files.
   * There is a lack of authentication in WebPanel.
   * Hardcoded credentials for WebDAV access are present.
   * The `sperl5.10.1-17` binary is vulnerable to a privilege escalation via PROCSUID.
   *  The core files are exposed with insecure permissions allowing access to sensitive data.
   *  The `/work/ci/tmp` directory is 777 allowing an attacker to overwrite files, such as the public key used for validating new applications.
  

*   **Impact of Exploitation**: An attacker with access to the affected device could steal the authentication password, potentially gaining unauthorized access to various functionalities. It is also possible for an attacker to gain a root shell on the device.

*   **Attack Vectors**:
    *   Direct access to the device's file system (if available, potentially through other vulnerabilities).
    *  If the telnet service is enabled, a remote attacker can gain shell access using the hardcoded credentials.
    *   Exploitation of other vulnerabilities within the MFP which permit access or modification of the software.

*   **Required Attacker Capabilities/Position**:
    *  An attacker needs access to the device's filesystem to view files or needs to use another vulnerability to access the filesystem.
    *  If the telnet service is running an attacker needs network access to the device.

**3. Additional Information:**

*   **Broader Context**: The provided content is part of a larger analysis of multiple vulnerabilities affecting Toshiba and Oki MFPs. It's important to note that CVE-2024-27164 is just one of many security flaws discovered in these devices. The provided documents include an advisory from Toshiba, a JPCERT vulnerability report, a vulnerability report from Pierre Kim and an affected product list from Toshiba. 
*   **Exploitation details:** The analysis by Pierre Kim provides extensive technical details on how to exploit the vulnerabilities, including the one associated with CVE-2024-27164.

*   **Multiple Vulnerabilities Combined**: The provided content demonstrates how a combination of vulnerabilities, such as insecure file permissions, and the hardcoded password could enable an attacker to achieve a complete compromise of the device, not just an authentication bypass. For example, the ability to overwrite files allows attackers to modify or inject malicious code, or to steal the admin password, and use it to log in to the TopAccess web interface.
*   **Affected Products:** The identified vulnerabilities affect at least 103 different models of Toshiba multi-function printers.
* **Patching:** The vulnerabilities were communicated to Toshiba in June 2023 and security patches were expected in May/June 2024.

In summary, CVE-2024-27164 identifies a serious flaw related to the use of a hardcoded password in Toshiba and Oki MFPs, which, when combined with other vulnerabilities, can lead to full compromise of the device.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.145 |
| 2 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.144 |
| 3 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.143 |
| 4 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.095 |
| 5 | 912 | Hidden Functionality | Class | Allowed-with-Review | sparse | 0.095 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.094 |
| 7 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.091 |
| 8 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.090 |
| 9 | 1392 | Use of Default Credentials | Base | Allowed | dense | 0.512 |
| 10 | 257 | Storing Passwords in a Recoverable Format | Base | Allowed | graph | 0.002 |

