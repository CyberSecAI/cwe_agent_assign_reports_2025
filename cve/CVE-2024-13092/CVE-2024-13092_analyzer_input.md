# Vulnerability Information: CVE-2024-13092

## Vulnerability Description
A vulnerability classified as critical was found in code-projects Job Recruitment 1.0. This vulnerability affects unknown code of the file /_parse/_call_job/search_ajax.php of the component Job Post Handler. The manipulation of the argument n leads to **sql injection**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** code-projects Job Recruitment
- **version:** 1
- **component:** Job Post Handler

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the identified SQL injection vulnerability:

**Root Cause:**
The root cause of the vulnerability is the lack of proper sanitization of user-supplied input before using it in an SQL query. Specifically, the value of the `$j1` parameter, obtained from the `$_REQUEST['n']`, is directly concatenated into a SQL query without any form of sanitization or escaping.

**Weaknesses/Vulnerabilities:**
*   **SQL Injection:** The primary vulnerability is SQL injection. This occurs because user-controlled data is directly inserted into an SQL query, allowing an attacker to modify the query's structure and execute arbitrary SQL commands.
*   **Lack of Input Sanitization:** The code fails to sanitize or validate the user-provided input, allowing malicious SQL syntax to be injected.

**Impact of Exploitation:**
*   **Information Disclosure:** An attacker can potentially access sensitive information stored in the database, such as user credentials, personal data, and other confidential information.
*   **Data Modification:** An attacker might be able to modify or delete data in the database.
*   **Denial of Service (DoS):** By injecting malicious SQL queries, an attacker can potentially disrupt the application's functionality, leading to a denial-of-service situation.
*   **Arbitrary Code Execution:** In some cases, SQL injection can be leveraged to execute arbitrary code on the database server or even the host server.

**Attack Vectors:**
*   **HTTP POST Request:** The vulnerability is exposed via a POST request to the `/parse/_call_job_search_ajax.php` endpoint.
*   **`n` Parameter:** The vulnerable parameter is `n`, which is assigned to the `$j1` variable in the PHP code. The attacker manipulates the value of this parameter to inject SQL code.

**Required Attacker Capabilities/Position:**
*   **Network Access:** The attacker needs to be able to send HTTP POST requests to the vulnerable server.
*   **Knowledge of Vulnerable Parameter:** The attacker needs to know the vulnerable parameter (`n`) and endpoint (`/_parse/_call_job_search_ajax.php`).
*   **SQL Injection Knowledge:** The attacker needs to have knowledge of SQL injection techniques to craft malicious SQL payloads.

**Technical Details:**

The vulnerability is located in the `/_parse/_call_job_search_ajax.php` file. The code takes the value from the request parameter `n`, assigns it to `$j1`, and then uses it in an SQL query without any sanitization.

The provided Proof of Concept (POC) demonstrates how an attacker can exploit this vulnerability:

```
POST /_parse/_call_job/search_ajax.php HTTP/1.1
Host: airecruitmentsystem
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 67
Origin: http://airecruitmentsystem
Connection: close
Referer: http://airecruitmentsystem/_parse/_all_edits.php
Cookie: PHPSESSID=etso55q58ionvmrvpetmaf8urt
Upgrade-Insecure-Requests: 1
Priority: u=0, i

n=2*
```

In this example, the attacker sets the value of `n` to `2*`, which, when directly included in the SQL query, can lead to unintended consequences and information disclosure (as seen in the result image). This is a basic example, and a skilled attacker could use more sophisticated SQL injection payloads to achieve more damaging results.

This content provides sufficient detail to understand the SQL injection vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.410 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.360 |
| 4 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.350 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.346 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.331 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.318 |
| 8 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.314 |
| 9 | 502 | Deserialization of Untrusted Data | Base | Allowed | dense | 0.542 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.003 |

