# Vulnerability Information: CVE-2025-1022

## Vulnerability Description
Versions of the package spatie/browsershot before 5.0.5 are vulnerable to Improper Input Validation in the setHtml function, invoked by Browsershothtml(), which can be bypassed by omitting the slashes in the file URI (e.g., file../../../../etc/passwd). This is due to **missing validations** of the user input that should be blocking file URI schemes (e.g., file// and file/) in the HTML content.

### Vulnerability Description Key Phrases
- **component:** Browsershothtml()
- **rootcause:** **Improper Input Validation, missing validations of the user input that should be blocking file URI schemes**
- **vector:** omitting slashes in file URI
- **weakness:** **missing validations**
- **product:** spatie/browsershot
- **version:** before 5.0.5

## CVE Reference Links Content Summary
CVE-2025-1022: Improper Input Validation in Browsershot

**Root cause of vulnerability:**

The `setHtml()` function in Browsershot < 5.0.5 does not properly validate user-supplied HTML content, specifically failing to adequately block file URI schemes (e.g., `file://`, `file:/`). An attacker can bypass this validation by omitting slashes in the file URI (e.g., `file:../../../../etc/passwd`).

**Weaknesses/vulnerabilities present:**

*   Improper Input Validation (CWE-20)

**Impact of exploitation:**

*   Arbitrary file read on the system running Browsershot.
*   Potential system directory listing.

**Attack vectors:**

*   An attacker can craft a malicious HTML document containing a file URI scheme to read arbitrary files on the server.
*   The vulnerability can be exploited through the `Browsershot::html()` function.

**Required attacker capabilities/position:**

*   The attacker needs to be able to supply HTML content to the `Browsershot::html()` function. No authentication is required.

**Mitigation or fix:**

*   Upgrade `spatie/browsershot` to version 5.0.5 or higher. The commit `bcfd608b264fab654bf78e199bdfbb03e9323eb7` and `e3273974506865a24fbb5b65b534d8d4b8dfbf72` address this issue.

**Additional details:**

*   The Snyk assessment recommends a high severity (8.8).
*   Proof-of-concept exploits are available.
*   The vulnerability has been assigned CVE-2025-1022.
*   The EPSS percentile is 0.12% (33rd percentile).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | sparse | 0.458 |
| 2 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.445 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.424 |
| 4 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.423 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.418 |
| 6 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.414 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.410 |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.408 |
| 9 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | dense | 0.566 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.002 |

