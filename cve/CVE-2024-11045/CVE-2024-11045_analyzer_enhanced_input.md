## Vulnerability Description
A **Cross-Site WebSocket Hijacking** (CSWSH) vulnerability in automatic1111/stable-diffusion-webui version 1.10.0 allows an attacker to clone a malicious server extension from a GitHub repository. The vulnerability arises from the **lack of proper validation on WebSocket connections** at ws//127.0.0.17860/queue/join, enabling unauthorized actions on the server. This can lead to unauthorized cloning of server extensions, execution of malicious scripts, data exfiltration, and potential denial of service (DoS).

### Vulnerability Description Key Phrases
- **component:** ws//127.0.0.17860/queue/join
- **rootcause:** **lack of proper validation on WebSocket connections**
- **weakness:** **Cross-Site WebSocket Hijacking**
- **product:** automatic1111/stable-diffusion-webui
- **impact:** data exfiltration, denial of service (DoS), execution of malicious scripts
- **attacker:** attacker
- **version:** 1.10.0

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1385 | Missing Origin Validation in WebSockets | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 620 | Unverified Password Change | Base | Allowed | sparse | 0.418 |
| 3 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.415 |
| 4 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.405 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.395 |
| 6 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.388 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.386 |
| 8 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.385 |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | dense | 0.600 |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-1385: Missing Origin Validation in WebSockets

CWE-620: Unverified Password Change

CWE-789: Memory Allocation with Excessive Size Value

CWE-20: Improper Input Validation

CWE-285: Improper Authorization

CWE-284: Improper Access Control

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-400: Uncontrolled Resource Consumption

CWE-918: Server-Side Request Forgery (SSRF)

CWE-770: Allocation of Resources Without Limits or Throttling