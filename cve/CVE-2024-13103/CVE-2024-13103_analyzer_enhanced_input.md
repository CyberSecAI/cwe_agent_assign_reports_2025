## Vulnerability Description
A vulnerability, which was classified as critical, has been found in D-Link DIR-816 A2 1.10CNB05_R1B011D88210. This issue affects some unknown processing of the file /goform/form2AddVrtsrv.cgi of the component Virtual Service Handler. The manipulation leads to **improper access controls**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access controls**
- **product:** D-Link DIR-816
- **version:** A2 1.10CNB05_R1B011D88210
- **component:** /goform/form2AddVrtsrv.cgi

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of the vulnerability:

**CVE ID:** CVE-2024-13103 (Based on the context it is the most likely CVE ID for this vulnerability)

**Root Cause of Vulnerability:**
The vulnerability stems from an improper access control in the web management interface of the D-Link DIR-816A2 router. Specifically, the `form2AddVrtsrv.cgi` endpoint is vulnerable.

**Weaknesses/Vulnerabilities Present:**
- **Missing Authentication/Authorization:** The primary issue is that the `goform` endpoint, when accessed with `form2AddVrtsrv.cgi` in the header, does not require authentication. This allows unauthenticated attackers to send requests to modify the virtual server settings.
- **Improper Access Control:** The web interface fails to enforce proper access control mechanisms, leading to the vulnerability.

**Impact of Exploitation:**
- An attacker can set the virtual server configurations on the vulnerable D-Link DIR-816A2 device. This can be used to redirect traffic to malicious servers, expose internal services to the internet, or cause other types of network disruptions.

**Attack Vectors:**
- The attack is performed by sending a specially crafted HTTP POST request to the `goform` endpoint.
- The `form2AddVrtsrv.cgi` value needs to be set in the header of the POST request.

**Required Attacker Capabilities/Position:**
- An attacker needs to be able to send HTTP requests to the device's web management interface. This typically requires network access to the router's local network.
- No authentication is required to exploit the vulnerability.

**Additional Notes:**
- The affected version is specifically identified as DIR-816A2 v1.10 and the firmware as DIR-816A2\_FWv1.10CNB05\_R1B011D88210.
- The provided content includes a Proof-of-Concept (POC) which demonstrates the ability to set virtual server configurations using the vulnerability.

The provided content offers more detail than a standard CVE description, including the specific firmware version and a proof of concept (screenshots).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.436 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.411 |
| 3 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.359 |
| 4 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.359 |
| 5 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.357 |
| 6 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.356 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.344 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.341 |
| 9 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | dense | 0.612 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-266: Incorrect Privilege Assignment

CWE-117: Improper Output Neutralization for Logs

CWE-306: Missing Authentication for Critical Function

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-184: Incomplete List of Disallowed Inputs