## Vulnerability Description
EndpointRequest.to() creates a matcher for null/** if the actuator endpoint, for which the EndpointRequest has been created, is disabled or not exposed. Your application may be affected by this if all the following conditions are met * You use Spring Security * EndpointRequest.to() has been used in a Spring Security chain configuration * The endpoint which EndpointRequest references is disabled or not exposed via web * Your application handles requests to /null and this path needs protection You are not affected if any of the following is true * You dont use Spring Security * You dont use EndpointRequest.to() * The endpoint which EndpointRequest.to() refers to is enabled and is exposed * Your application does not handle requests to /null or this path does not need protection

### Vulnerability Description Key Phrases
- **rootcause:** **improper null handling**
- **product:** Spring Security

## CVE Reference Links Content Summary
## CVE-2025-22235: Spring Boot EndpointRequest.to() creates wrong matcher if actuator endpoint is not exposed

**Root cause of vulnerability:**

`EndpointRequest.to()` creates a matcher for `null/**` if the actuator endpoint, for which the `EndpointRequest` has been created, is disabled or not exposed.

**Weaknesses/vulnerabilities present:**

Incorrect matcher creation in `EndpointRequest.to()` when the actuator endpoint is not exposed, leading to potential unintended access.

**Impact of exploitation:**

An attacker might be able to access unintended resources if the application handles requests to `/null` and this path needs protection.

**Attack vectors:**

An attacker could potentially exploit this vulnerability by sending requests to `/null` if the application is configured to handle them and lacks proper protection.

**Required attacker capabilities/position:**

No specific capabilities or position are required, as the vulnerability is triggered by the application's configuration.

**Mitigation or fix:**

*   Upgrade to the fixed versions:
    *   2.7.x -> 2.7.25 (Enterprise Support Only)
    *   3.1.x -> 3.1.16 (Enterprise Support Only)
    *   3.2.x -> 3.2.14 (Enterprise Support Only)
    *   3.3.x -> 3.3.11 (OSS)
    *   3.4.x -> 3.4.5 (OSS)
*   Ensure the endpoint referenced by `EndpointRequest.to()` is enabled and exposed via web.
*   Ensure the application does not handle requests to `/null` or that this path is properly protected.

**More detail than official CVE description:**

Yes, the content provides significantly more detail than a placeholder CVE description, including affected versions, specific mitigation steps, and a clear explanation of the root cause and impact. It also details conditions for being affected or not affected.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.735 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.708 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.707 |
| 4 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.689 |
| 5 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.682 |
| 6 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.673 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.672 |
| 8 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.669 |
| 9 | 395 | Use of NullPointerException Catch to Detect NULL Pointer Dereference | Base | Allowed | dense | 0.372 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-668: Exposure of Resource to Wrong Sphere

CWE-863: Incorrect Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-287: Improper Authentication

CWE-347: Improper Verification of Cryptographic Signature

CWE-23: Relative Path Traversal

CWE-917: Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')

CWE-395: Use of NullPointerException Catch to Detect NULL Pointer Dereference

CWE-322: Key Exchange without Entity Authentication