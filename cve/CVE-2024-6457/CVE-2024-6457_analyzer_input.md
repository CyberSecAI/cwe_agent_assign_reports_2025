# Vulnerability Information: CVE-2024-6457

## Vulnerability Description
The HUSKY - Products Filter Professional for WooCommerce plugin for WordPress is vulnerable to **time-based SQL Injection** via the woof_author parameter in all versions up to, and including, 1.3.6 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL Injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** unauthenticated attackers
- **product:** HUSKY - Products Filter Professional for WooCommerce plugin for WordPress
- **version:** up to and including 1.3.6
- **component:** woof_author parameter

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-6457

**Vulnerable Software:** HUSKY - Products Filter Professional for WooCommerce WordPress plugin, versions 1.3.6 and below.

**Root Cause:**
The vulnerability stems from insufficient sanitization and preparation of the `woof_author` parameter within an SQL query. The plugin uses user-supplied data from this parameter directly in a SQL query, without proper escaping.

**Weaknesses/Vulnerabilities:**
- **Time-Based SQL Injection:** The lack of proper sanitization allows an attacker to inject arbitrary SQL code, including time-based delays, into the query, which can be used to extract sensitive data.
- **Improper Neutralization of Special Elements:** User input is not properly sanitized before being used in an SQL query.

**Impact of Exploitation:**
- **Sensitive Data Exposure:** Successful exploitation allows attackers to extract sensitive information from the WordPress database.
- **Full Compromise:** Depending on the database user privileges, the attacker could potentially gain full access to the database.

**Attack Vectors:**
- **HTTP Request:** The vulnerability is triggered via the `woof_author` parameter in an HTTP request.

**Required Attacker Capabilities/Position:**
- **Unauthenticated Access:** The attacker does not need to be logged into the WordPress site.
- **Network Access:** The attacker needs to be able to send HTTP requests to the target WordPress site.

**Technical Details:**
- The vulnerability exists in the `woof_post_author_filter` function within the `ext/by_author/index.php` file of the plugin.
- Specifically, the code at line 99 of `ext/by_author/index.php` before the patch was vulnerable:
    ```php
    $where .= "post_author={$request['woof_author'][$i]}";
    ```
- The fix implemented in changeset 3116888, as seen on line 99, uses `$wpdb->prepare` to safely add the author to the query:
    ```php
    $where .= $wpdb->prepare("post_author=%d", $request['woof_author'][$i]);
    ```

**Additional Notes:**

- The Wordfence article provides a good description of the vulnerability.
- The Trac links provide context to the vulnerable code and the commit where the fix was implemented.
- The vulnerability is considered critical with a CVSS score of 9.8.

**Remediation:**
- Update the HUSKY - Products Filter Professional for WooCommerce plugin to version 1.3.6.1 or higher.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.552 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.506 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.490 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.483 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.482 |
| 7 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.473 |
| 8 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.470 |
| 9 | 564 | SQL Injection: Hibernate | Variant | Allowed | dense | 0.505 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

