{
  "cve_id": "CVE-2024-13452",
  "description": "The Contact Form by Supsystic plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 1.7.29. This is due to **missing or incorrect nonce validation** on a saveAsCopy function. This makes it possible for unauthenticated attackers to update settings and inject malicious web scripts via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.",
  "key_phrases": {
    "component": "saveAsCopy function",
    "rootcause": "missing or incorrect nonce validation",
    "vector": "forged request",
    "weakness": "['Cross-Site Request Forgery', 'cross-site request forgery']",
    "product": "Contact Form by Supsystic plugin for WordPress",
    "impact": "['update settings', 'inject malicious web scripts']",
    "attacker": "unauthenticated attackers",
    "version": "all versions up to and including 1.7.29"
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-352 | Cross-Site Request Forgery (CSRF) | 1.0 | Compound | Allowed | Primary CWE |\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.6 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-352, which is a compound weakness describing Cross-Site Request Forgery. The vulnerability description clearly indicates **missing or incorrect nonce validation**, which is a common root cause for CSRF. CWE-639, Authorization Bypass Through User-Controlled Key, is considered as a secondary CWE because the **missing or incorrect nonce validation** allows an attacker to bypass authorization checks.\n\n```mermaid\ngraph TD\n    cwe352[\"CWE-352: Cross-Site Request Forgery (CSRF)\"]\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    \n    cwe639 -->|CANPRECEDE| cwe352\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe352 primary\n    class cwe639 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing or incorrect nonce validation** (root cause) leading to Cross-Site Request Forgery, which then allows attackers to update settings and inject malicious web scripts.\n\nMissing/Incorrect Nonce Validation -> CSRF -> Update Settings/Inject Malicious Scripts\n\n## Summary of Analysis\nThe primary assessment is based on the vulnerability description, which states that there's **missing or incorrect nonce validation** leading to a Cross-Site Request Forgery. The evidence is strong as the description explicitly mentions the root cause and the resulting weakness. The graph relationship shows that CWE-639 (Authorization Bypass) can precede CWE-352 (CSRF), fitting the vulnerability's progression.\n\n\"This is due to **missing or incorrect nonce validation** on a saveAsCopy function. This makes it possible for unauthenticated attackers to update settings and inject malicious web scripts via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.\"\n\nCWE-352 is chosen because the core issue is the lack of proper CSRF protection (nonce validation). CWE-639, Authorization Bypass Through User-Controlled Key, is a secondary consideration because the lack of nonce validation effectively allows unauthorized actions by exploiting a forged request. The selected CWEs are at the optimal level of specificity, with CWE-352 being a compound weakness encompassing the overall vulnerability and CWE-639 as a contributing factor.\n\nThe retriever results list several other CWEs. CWE-79, Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), and CWE-89, Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'), are not directly applicable as the primary issue isn't related to input sanitization but rather the lack of request forgery protection. CWE-862, Missing Authorization, and CWE-863, Incorrect Authorization, are related to authorization issues, but CWE-639 is more specific in this context, as it involves user-controlled keys and authorization bypass. CWE-472, External Control of Assumed-Immutable Web Parameter, could be loosely related as the nonce is an externally controlled parameter, but the core problem lies in the **missing or incorrect nonce validation** rather than the external control itself.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-352 | Cross-Site Request Forgery (CSRF) | 1.0 | Compound | Allowed | Primary CWE |\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.6 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-352, which is a compound weakness describing Cross-Site Request Forgery. The vulnerability description clearly indicates **missing or incorrect nonce validation**, which is a common root cause for CSRF. CWE-639, Authorization Bypass Through User-Controlled Key, is considered as a secondary CWE because the **missing or incorrect nonce validation** allows an attacker to bypass authorization checks.\n\n```mermaid\ngraph TD\n    cwe352[\"CWE-352: Cross-Site Request Forgery (CSRF)\"]\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    \n    cwe639 -->|CANPRECEDE| cwe352\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe352 primary\n    class cwe639 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing or incorrect nonce validation** (root cause) leading to Cross-Site Request Forgery, which then allows attackers to update settings and inject malicious web scripts.\n\nMissing/Incorrect Nonce Validation -> CSRF -> Update Settings/Inject Malicious Scripts\n\n## Summary of Analysis\nThe primary assessment is based on the vulnerability description, which states that there's **missing or incorrect nonce validation** leading to a Cross-Site Request Forgery. The evidence is strong as the description explicitly mentions the root cause and the resulting weakness. The graph relationship shows that CWE-639 (Authorization Bypass) can precede CWE-352 (CSRF), fitting the vulnerability's progression.\n\n\"This is due to **missing or incorrect nonce validation** on a saveAsCopy function. This makes it possible for unauthenticated attackers to update settings and inject malicious web scripts via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.\"\n\nCWE-352 is chosen because the core issue is the lack of proper CSRF protection (nonce validation). CWE-639, Authorization Bypass Through User-Controlled Key, is a secondary consideration because the lack of nonce validation effectively allows unauthorized actions by exploiting a forged request. The selected CWEs are at the optimal level of specificity, with CWE-352 being a compound weakness encompassing the overall vulnerability and CWE-639 as a contributing factor.\n\nThe retriever results list several other CWEs. CWE-79, Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'), and CWE-89, Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'), are not directly applicable as the primary issue isn't related to input sanitization but rather the lack of request forgery protection. CWE-862, Missing Authorization, and CWE-863, Incorrect Authorization, are related to authorization issues, but CWE-639 is more specific in this context, as it involves user-controlled keys and authorization bypass. CWE-472, External Control of Assumed-Immutable Web Parameter, could be loosely related as the nonce is an externally controlled parameter, but the core problem lies in the **missing or incorrect nonce validation** rather than the external control itself.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-89:**\n- 89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) - ROOT\n\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "600",
        "name": "Uncaught Exception in Servlet ",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Missing Catch Block",
        "match_reason": "phrase_in_term_compound_part_0"
      },
      "similarity": 700.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "source": "sparse"
      },
      "similarity": 629.2871817141413
    },
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "source": "sparse"
      },
      "similarity": 476.90914243448833
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 472.9218296887286
    },
    {
      "metadata": {
        "doc_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "source": "sparse"
      },
      "similarity": 469.6713576530483
    },
    {
      "metadata": {
        "doc_id": "862",
        "name": "Missing Authorization",
        "source": "sparse"
      },
      "similarity": 467.5356627424728
    },
    {
      "metadata": {
        "doc_id": "116",
        "name": "Improper Encoding or Escaping of Output",
        "source": "sparse"
      },
      "similarity": 454.67628065034125
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 446.75010525595155
    },
    {
      "metadata": {
        "doc_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "type": "Base",
        "original_content": "The web application does not sufficiently verify inputs that are assumed to be immutable but are actually externally controllable, such as hidden form fields.",
        "keyphrase_source": "weakness:'cross-site request forgery']",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.4899288885984595,
            "graph": 2.050472527122376
          }
        }
      },
      "similarity": 0.4899288885984595
    },
    {
      "doc_id": "471",
      "text": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
      "score": 2.7196000000000002,
      "metadata": {
        "doc_id": "471",
        "name": "Modification of Assumed-Immutable Data (MAID)",
        "type": "base",
        "original_content": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
        "relationships": [
          {
            "source_id": "471",
            "target_id": "621",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "607",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "602",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "473",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "425",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "291",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1321",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1282",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "471",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "621",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "607",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "602",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "473",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "425",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "291",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1321",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1282",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.5599999999999999,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_up",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "425"
            },
            "abstraction_path_up": {
              "path": [
                [
                  "472",
                  "471",
                  "CHILDOF"
                ]
              ],
              "score": 0.5599999999999999,
              "type": "abstraction_path_up",
              "source": "472"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "425"
            }
          }
        },
        "abstraction_level": "base",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.7196000000000002
          }
        }
      },
      "similarity": 2.7196000000000002
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-89",
      "CWE-863",
      "CWE-862",
      "CWE-639",
      "CWE-79",
      "CWE-472",
      "CWE-352"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}