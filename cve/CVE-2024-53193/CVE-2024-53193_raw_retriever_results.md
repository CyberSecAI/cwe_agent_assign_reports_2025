# Raw Retriever Results for CVE-2024-53193

# Raw Retriever Results for CVE-2024-53193
## Query
In the Linux kernel, the following vulnerability has been resolved clk clk-loongson2 Fix memory corruption bug in struct loongson2_clk_provider Some heap space is allocated for the flexible structure `struct clk_hw_onecell_data` and its flexible-array member `hws` through the composite structure `struct loongson2_clk_provider` in function `loongson2_clk_probe()`, as shown below 289 struct loongson2_clk_provider *clp ... 296 for (p = data p->name p++) 297 clks_num++ 298 299 clp = devm_kzalloc(dev, struct_size(clp, clk_data.hws, clks_num), 300 GFP_KERNEL) Then some data is written into the flexible array 350 clp->clk_data.hws[p->id] = hw This corrupts `clk_lock`, which is the spinlock variable immediately following the `clk_data` member in `struct loongson2_clk_provider` struct loongson2_clk_provider { void __iomem *base struct device *dev struct clk_hw_onecell_data clk_data spinlock_t clk_lock /* protect access to DIV registers */ } The problem is that the flexible structure is currently placed in the middle of `struct loongson2_clk_provider` instead of at the end. Fix this by moving `struct clk_hw_onecell_data clk_data` to the end of `struct loongson2_clk_provider`. Also, add a code comment to help prevent this from happening again in case new members are added to the structure in the future. This change also fixes the following -Wflex-array-member-not-at-end warning drivers/clk/clk-loongson2.c3236 warning structure containing a flexible array member is not at the end of another structure [-Wflex-array-member-not-at-end]

## Keyphrases
- **weakness**: 'memory corruption'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4976 | 0.5516 | 0.5187 | 0.5191 | 20 |
| Sparse | 267.8201 | 1000.0000 | 773.7697 | 796.8505 | 11 |
| Graph | 1.5024 | 4.3290 | 2.0815 | 1.7312 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 252 | Unchecked Return Value | base | 4.3290 | Allowed |
| 2 | 787 | Out-of-bounds Write | base | 3.8870 | Allowed |
| 3 | 908 | Use of Uninitialized Resource | Base | 2.8163 | Allowed |
| 4 | 476 | NULL Pointer Dereference | Base | 2.8087 | Allowed |
| 5 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 6 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 125 | Out-of-bounds Read | Base | 2.1028 | Allowed |
| 8 | 123 | Write-what-where Condition | base | 2.0228 | Allowed |
| 9 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 10 | 909 | Missing Initialization of Resource | Class | 1.7580 | Allowed-with-Review |
| 11 | 413 | Improper Resource Locking | Base | 1.7044 | Allowed |
| 12 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6244 | Allowed |
| 13 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.6016 | Allowed-with-Review |
| 14 | 129 | Improper Validation of Array Index | Variant | 1.5696 | Allowed |
| 15 | 822 | Untrusted Pointer Dereference | Base | 1.5342 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 667 | Improper Locking | Class | 0.5516 | 0.5516 | Allowed-with-Review |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5502 | 0.5502 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5498 | 0.5498 | Allowed-with-Review |
| 4 | 413 | Improper Resource Locking | Base | 0.5309 | 0.5309 | Allowed |
| 5 | 908 | Use of Uninitialized Resource | Base | 0.5296 | 0.5296 | Allowed |
| 6 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5278 | 0.5278 | Allowed |
| 7 | 805 | Buffer Access with Incorrect Length Value | Base | 0.5259 | 0.5259 | Allowed |
| 8 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.5259 | 0.5259 | Allowed |
| 9 | 126 | Buffer Over-read | Variant | 0.5254 | 0.5254 | Allowed |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5227 | 0.5227 | Allowed-with-Review |
| 11 | 366 | Race Condition within a Thread | Base | 0.5154 | 0.5154 | Allowed |
| 12 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | Variant | 0.5067 | 0.5067 | Allowed |
| 13 | 1247 | Improper Protection Against Voltage and Clock Glitches | Base | 0.5057 | 0.5057 | Allowed |
| 14 | 415 | Double Free | Variant | 0.5035 | 0.5035 | Allowed |
| 15 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.5025 | 0.5025 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 787 | Out-of-bounds Write | 1000.0000 | 1000.0000 | Allowed |
| 2 | 909 | Missing Initialization of Resource | 915.0273 | 915.0273 | Allowed-with-Review |
| 3 | 125 | Out-of-bounds Read | 820.7032 | 820.7032 | Allowed |
| 4 | 252 | Unchecked Return Value | 804.5104 | 804.5104 | Allowed |
| 5 | 476 | NULL Pointer Dereference | 798.9145 | 798.9145 | Allowed |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | 796.8505 | 796.8505 | Allowed |
| 7 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 792.8373 | 792.8373 | Allowed |
| 8 | 674 | Uncontrolled Recursion | 783.7965 | 783.7965 | Allowed-with-Review |
| 9 | 190 | Integer Overflow or Wraparound | 765.6286 | 765.6286 | Allowed |
| 10 | 122 | Heap-based Buffer Overflow | 765.3787 | 765.3787 | Allowed |
| 11 | 824 | Access of Uninitialized Pointer | 267.8201 | 267.8201 | Allowed |
