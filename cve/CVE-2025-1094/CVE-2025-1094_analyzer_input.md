# Vulnerability Information: CVE-2025-1094

## Vulnerability Description
**Improper neutralization of quoting syntax** in PostgreSQL libpq functions PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), and PQescapeStringConn() allows a database input provider to achieve **SQL injection** in certain usage patterns. Specifically, **SQL injection** requires the application to use the function result to construct input to psql, the PostgreSQL interactive terminal. Similarly, improper neutralization of quoting syntax in PostgreSQL command line utility programs allows a source of command line arguments to achieve **SQL injection** when client_encoding is BIG5 and server_encoding is one of EUC_TW or MULE_INTERNAL. Versions before PostgreSQL 17.3, 16.7, 15.11, 14.16, and 13.19 are affected.

### Vulnerability Description Key Phrases
- **component:** libpq functions, command line utility programs
- **rootcause:** **Improper neutralization of quoting syntax**
- **weakness:** **SQL injection**
- **product:** PostgreSQL
- **impact:** SQL injection
- **version:** before 17.3, 16.7, 15.11, 14.16, and 13.19

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1094 based on provided content:

**Overall:** The provided content details a SQL injection vulnerability (CVE-2025-1094) in PostgreSQL, specifically related to improper neutralization of quoting syntax in certain functions. It also describes a regression introduced by the initial fix and a subsequent release to address it.

**1. Root cause of vulnerability:**

*   Improper neutralization of quoting syntax in PostgreSQL `libpq` functions (`PQescapeLiteral()`, `PQescapeIdentifier()`, `PQescapeString()`, and `PQescapeStringConn()`).
*   This allows a database input provider to achieve SQL injection under certain usage patterns.
*   Specifically, the vulnerability occurs when the application uses the function result to construct input to `psql`, the PostgreSQL interactive terminal.
*   Also affects command line utility programs when `client_encoding` is `BIG5` and `server_encoding` is `EUC_TW` or `MULE_INTERNAL`.

**2. Weaknesses/vulnerabilities present:**

*   SQL Injection
*   Improper Input Validation/Sanitization
*   Quoting issues

**3. Impact of exploitation:**

*   SQL injection, potentially allowing an attacker to execute arbitrary SQL commands.

**4. Attack vectors:**

*   Providing crafted input to PostgreSQL through applications using the vulnerable `libpq` functions.
*   Exploitation via the `psql` interactive terminal.
*   Exploitation via command line utility programs with specific encoding configurations.

**5. Required attacker capabilities/position:**

*   An attacker needs to be able to provide input to a PostgreSQL database through a vulnerable application or directly via `psql` or a command-line tool.

**6. Mitigation or fix:**

*   Upgrade to PostgreSQL versions 17.3, 16.7, 15.11, 14.16, or 13.19 (initial fix).
*   Upgrade to PostgreSQL versions 17.4, 16.8, 15.12, 14.17, or 13.20 (to address the regression introduced by the initial fix).

**Additional Details (more than official CVE description):**

*   The initial fix for CVE-2025-1094 introduced a regression where `PQescapeLiteral` and `PQescapeIdentifier` ignored their length parameter, potentially leading to buffer overflows. This regression was addressed in subsequent releases.
*   The vulnerability was reported by Stephen Fewer of Rapid7.
*   CVSS score: 8.1 (AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)
*   Details on SSL support and environment variables related to libpq are provided in the documentation links.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.511 |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.499 |
| 4 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.499 |
| 5 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.492 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.490 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.488 |
| 8 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.475 |
| 9 | 149 | Improper Neutralization of Quoting Syntax | Variant | Allowed | dense | 0.596 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |

