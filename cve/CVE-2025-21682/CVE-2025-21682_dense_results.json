{
  "query": "In the Linux kernel, the following vulnerability has been resolved eth bnxt always recalculate features after XDP clearing, fix null-deref Recalculate features when XDP is detached. Before # ip li set dev eth0 xdp obj xdp_dummy.bpf.o sec xdp # ip li set dev eth0 xdp off # ethtool -k eth0 | grep gro rx-gro-hw off [requested on] After # ip li set dev eth0 xdp obj xdp_dummy.bpf.o sec xdp # ip li set dev eth0 xdp off # ethtool -k eth0 | grep gro rx-gro-hw on The fact that HW-GRO doesnt get re-enabled automatically is just a minor annoyance. The real issue is that the features will randomly come back during another reconfiguration which just happens to invoke netdev_update_features(). The driver doesnt handle reconfiguring two things at a time very robustly. Starting with commit 98ba1d931f61 (bnxt_en Fix RSS logic in __bnxt_reserve_rings()) we only reconfigure the RSS hash table if the effective number of Rx rings has changed. If HW-GRO is enabled effective number of rings is 2x what user sees. So if we are in the bad state, with HW-GRO re-enablement pending after XDP off, and we lower the rings by / 2 - the HW-GRO rings doing 2x and the ethtool -L doing / 2 may cancel each other out, and the if (old_rx_rings != bp->hw_resc.resv_rx_rings && condition in __bnxt_reserve_rings() will be false. The RSS map wont get updated, and well crash with",
  "count": 20,
  "results": [
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "score": 0.48097297448709964,
      "original_score": 0.48097297448709964,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "score": 0.47287618454735947,
      "original_score": 0.47287618454735947,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 0.4579666403174187,
      "original_score": 0.4579666403174187,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "121",
      "name": "Stack-based Buffer Overflow",
      "abstraction": "Variant",
      "score": 0.45140639597401966,
      "original_score": 0.45140639597401966,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "abstraction": "Class",
      "score": 0.45096195223396796,
      "original_score": 0.45096195223396796,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "abstraction": "Base",
      "score": 0.450199362393226,
      "original_score": 0.450199362393226,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1315",
      "name": "Improper Setting of Bus Controlling Capability in Fabric End-point",
      "abstraction": "Base",
      "score": 0.45000636417817014,
      "original_score": 0.45000636417817014,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 0.44908709852535805,
      "original_score": 0.44908709852535805,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1256",
      "name": "Improper Restriction of Software Interfaces to Hardware Features",
      "abstraction": "Base",
      "score": 0.44751099132529804,
      "original_score": 0.44751099132529804,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 0.44116048155858456,
      "original_score": 0.44116048155858456,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "77",
      "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')",
      "abstraction": "Class",
      "score": 0.42741142732322124,
      "original_score": 0.42741142732322124,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "abstraction": "Class",
      "score": 0.4240274842075965,
      "original_score": 0.4240274842075965,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "755",
      "name": "Improper Handling of Exceptional Conditions",
      "abstraction": "Class",
      "score": 0.4229201588443638,
      "original_score": 0.4229201588443638,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "400",
      "name": "Uncontrolled Resource Consumption",
      "abstraction": "Class",
      "score": 0.4226465439043781,
      "original_score": 0.4226465439043781,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "126",
      "name": "Buffer Over-read",
      "abstraction": "Variant",
      "score": 0.42248856395106016,
      "original_score": 0.42248856395106016,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "abstraction": "Base",
      "score": 0.42149487023373966,
      "original_score": 0.42149487023373966,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "252",
      "name": "Unchecked Return Value",
      "abstraction": "Base",
      "score": 0.41970505270989894,
      "original_score": 0.41970505270989894,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "911",
      "name": "Improper Update of Reference Count",
      "abstraction": "Base",
      "score": 0.41954738706408734,
      "original_score": 0.41954738706408734,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1276",
      "name": "Hardware Child Block Incorrectly Connected to Parent System",
      "abstraction": "Base",
      "score": 0.4175827406662708,
      "original_score": 0.4175827406662708,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1317",
      "name": "Improper Access Control in Fabric Bridge",
      "abstraction": "Base",
      "score": 0.4151013704390309,
      "original_score": 0.4151013704390309,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.4151013704390309,
    "max": 0.48097297448709964,
    "mean": 0.4382537022442074,
    "median": 0.4342859544409029,
    "count": 20
  }
}