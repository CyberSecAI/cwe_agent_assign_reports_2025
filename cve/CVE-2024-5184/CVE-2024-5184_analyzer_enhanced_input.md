## Vulnerability Description
The EmailGPT service contains a **prompt injection** vulnerability. The service uses an API service that allows a malicious user to inject a direct prompt and take over the service logic. Attackers can exploit the issue by forcing the AI service to leak the standard hard-coded system prompts and/or execute unwanted prompts. When engaging with EmailGPT by submitting a malicious prompt that requests harmful information, the system will respond by providing the requested data. This vulnerability can be exploited by any individual with access to the service.

### Vulnerability Description Key Phrases
- **weakness:** **prompt injection**
- **impact:** take over the service logic
- **vector:** malicious prompt
- **attacker:** malicious user
- **product:** EmailGPT
- **component:** API service

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Vulnerability:** Prompt Injection

**Root Cause:** The EmailGPT service, which uses OpenAI's GPT models to assist users in writing emails within Gmail, allows direct prompt injection through its API. This is due to insufficient input sanitization or validation when processing user-provided prompts.

**Weaknesses:**
*   **Lack of Input Sanitization/Validation:** The service doesn't properly sanitize or validate user inputs, allowing attackers to inject malicious prompts.
*   **Direct Prompt Access:** The API allows direct access for users to inject prompts, instead of a more controlled and restricted input method.
*   **Insecure API Design:** The API design allows users to influence the underlying model's behavior directly through prompts.

**Impact of Exploitation:**
*   **Intellectual Property Leakage:** Attackers can potentially extract sensitive information, including hard-coded system prompts.
*   **Denial of Service (DoS):** Attackers can cause a denial of service by repeatedly requesting the AI provider's API, which can lead to resource exhaustion or high costs.
*   **Financial Loss:** Repeated requests to the AI provider's API, which are pay-per-use, can result in financial losses for the service owner.
*  **Execution of Unwanted Prompts:** Attackers can force the AI to perform actions or generate content not intended by the service.

**Attack Vectors:**
*   **API Exploitation:** Attackers can send specially crafted prompts to the EmailGPT API.

**Required Attacker Capabilities/Position:**
*   **Access to the Service:** The attacker needs to have access to the EmailGPT service, either through the Google Chrome extension or direct API interaction.

**Additional Notes:**
*   The advisory mentions that the CyRC contacted the developers multiple times but did not receive a response.
*   They recommend immediate removal of the application from networks due to the unresolved vulnerability.
* The affected software is EmailGPT "main" branch.
* The CVSS score is 6.5 (Medium) with a vector of CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, indicating the attack vector is adjacent.

This content provides more details than a typical CVE description, detailing the specific attack vector, impact, and affected software.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | Allowed | alternate_terms | 1.000 |
| 2 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.496 |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.461 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.447 |
| 5 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.446 |
| 6 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.438 |
| 7 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.437 |
| 8 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.435 |
| 9 | 1426 | Improper Validation of Generative AI Output | Base | Discouraged | dense | 0.498 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1427: Improper Neutralization of Input Used for LLM Prompting

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-427: Uncontrolled Search Path Element

CWE-259: Use of Hard-coded Password

CWE-20: Improper Input Validation

CWE-798: Use of Hard-coded Credentials

CWE-1426: Improper Validation of Generative AI Output

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')