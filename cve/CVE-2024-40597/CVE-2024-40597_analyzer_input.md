# Vulnerability Information: CVE-2024-40597

## Vulnerability Description
An issue was discovered in the CheckUser extension for MediaWiki through 1.42.1. It can expose suppressed information for log events. (The **log_deleted attribute is not respected**.)

### Vulnerability Description Key Phrases
- **rootcause:** **log_deleted attribute is not respected**
- **impact:** expose suppressed information for log events
- **product:** CheckUser extension for MediaWiki
- **version:** through 1.42.1

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-40597:

**Root cause of vulnerability:**
The CheckUser extension in MediaWiki did not store the log ID of logged actions. Consequently, when a log event was suppressed (oversighted) using revision deletion, CheckUser was unable to identify and hide that suppressed information. This led to CheckUsers who did not have oversight permissions being able to view suppressed log events via the Special:CheckUser interface.

**Weaknesses/vulnerabilities present:**
- Information Exposure: The primary vulnerability is the exposure of suppressed log event information to users (CheckUsers) who should not have access to it, violating privacy and oversight mechanisms.
- Inadequate access control: The vulnerability stemmed from insufficient integration with the revision deletion mechanism and the lack of checks for suppressed log events in the CheckUser extension.

**Impact of exploitation:**
- Unauthorized Information Disclosure: CheckUsers without oversight privileges could access information that was intentionally hidden using the revision deletion feature. This could expose sensitive data regarding user actions that were meant to be suppressed, potentially leading to privacy violations and reputational damage.

**Attack vectors:**
- The attack vector is through the Special:CheckUser interface. A CheckUser with insufficient permissions could use this interface to view suppressed log events associated with a user, IP address, or temporary user.

**Required attacker capabilities/position:**
- The attacker needs to have CheckUser permissions on the affected MediaWiki instance. No other special privileges are required; the vulnerability arises from the design of the CheckUser extension itself. The attacker does not need oversight permissions, which are specifically meant to prevent access to such suppressed information.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.209 |
| 2 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.183 |
| 3 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | sparse | 0.181 |
| 4 | 248 | Uncaught Exception | Base | Allowed | sparse | 0.179 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.171 |
| 6 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.167 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.163 |
| 8 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.161 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.512 |
| 10 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | graph | 0.002 |

