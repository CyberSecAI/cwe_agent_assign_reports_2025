{
  "retriever": "sparse",
  "query": "Envoy is a cloud-native, open source edge and service proxy. Prior to versions 1.30.4, 1.29.7, 1.28.5, and 1.27.7. Envoy references already freed memory when route hash policy is configured with cookie attributes. Note that this vulnerability has been fixed in the open as the effect would be immediately apparent if it was configured. Memory allocated for holding attribute values is freed after configuration was parsed. During request processing Envoy will attempt to copy content of de-allocated memory into request cookie header. This can lead to arbitrary content of Envoys memory to be sent to the upstream service or abnormal process termination. This vulnerability is fixed in Envoy versions v1.30.4, v1.29.7, v1.28.5, and v1.27.7. As a workaround, do not use cookie attributes in route action hash policy.",
  "keyphrases": {
    "rootcause": [
      "use after free"
    ]
  },
  "timestamp": "2025-07-13 11:12:24",
  "cve_id": "CVE-2024-39305",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "674",
      "name": "Uncontrolled Recursion",
      "score": 733.9098236285574,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "287",
      "name": "Improper Authentication",
      "score": 717.1083698133428,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "190",
      "name": "Integer Overflow or Wraparound",
      "score": 709.5923366511098,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 701.7041530635528,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "score": 681.4203413353333,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 681.2987598908057,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "1390",
      "name": "Weak Authentication",
      "score": 676.5202344838895,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "327",
      "name": "Use of a Broken or Risky Cryptographic Algorithm",
      "score": 675.0506349469614,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "79",
      "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "score": 669.6835734938138,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "400",
      "name": "Uncontrolled Resource Consumption",
      "score": 666.8370432468998,
      "search_source": "rootcause:use after free"
    },
    {
      "cwe_id": "138",
      "name": "Improper Neutralization of Special Elements",
      "score": 222.00260884337067,
      "search_source": "base_query"
    }
  ]
}