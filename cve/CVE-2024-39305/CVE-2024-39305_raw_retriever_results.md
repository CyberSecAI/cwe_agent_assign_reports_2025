# Raw Retriever Results for CVE-2024-39305

# Raw Retriever Results for CVE-2024-39305
## Query
Envoy is a cloud-native, open source edge and service proxy. Prior to versions 1.30.4, 1.29.7, 1.28.5, and 1.27.7. Envoy references already freed memory when route hash policy is configured with cookie attributes. Note that this vulnerability has been fixed in the open as the effect would be immediately apparent if it was configured. Memory allocated for holding attribute values is freed after configuration was parsed. During request processing Envoy will attempt to copy content of de-allocated memory into request cookie header. This can lead to arbitrary content of Envoys memory to be sent to the upstream service or abnormal process termination. This vulnerability is fixed in Envoy versions v1.30.4, v1.29.7, v1.28.5, and v1.27.7. As a workaround, do not use cookie attributes in route action hash policy.

## Keyphrases
- **rootcause**: 'use after free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4111 | 0.4708 | 0.4330 | 0.4295 | 20 |
| Sparse | 222.0026 | 733.9098 | 648.6480 | 681.2988 | 11 |
| Graph | 1.5210 | 2.9988 | 1.9316 | 1.8185 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 190 | Integer Overflow or Wraparound | base | 2.9988 | Allowed |
| 2 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 3 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.2100 | Allowed |
| 5 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | 2.0738 | Allowed |
| 8 | 129 | Improper Validation of Array Index | variant | 2.0400 | Allowed |
| 9 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 1.9458 | Allowed |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.8690 | Allowed |
| 11 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 12 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 13 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 14 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 15 | 193 | Off-by-one Error | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | 0.4708 | 0.4708 | Allowed |
| 2 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4546 | 0.4546 | Allowed |
| 3 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | 0.4538 | 0.4538 | Allowed |
| 4 | 1422 | Exposure of Sensitive Information caused by Incorrect Data Forwarding during Transient Execution | Base | 0.4532 | 0.4532 | Allowed |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4465 | 0.4465 | Allowed |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4465 | 0.4465 | Allowed |
| 7 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | Class | 0.4436 | 0.4436 | Allowed-with-Review |
| 8 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | 0.4426 | 0.4426 | Allowed |
| 9 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.4407 | 0.4407 | Allowed |
| 10 | 416 | Use After Free | Variant | 0.4301 | 0.4301 | Allowed |
| 11 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4290 | 0.4290 | Allowed |
| 12 | 565 | Reliance on Cookies without Validation and Integrity Checking | Base | 0.4277 | 0.4277 | Allowed |
| 13 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | 0.4232 | 0.4232 | Allowed |
| 14 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | 0.4166 | 0.4166 | Allowed |
| 15 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4160 | 0.4160 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 674 | Uncontrolled Recursion | 733.9098 | 733.9098 | Allowed-with-Review |
| 2 | 287 | Improper Authentication | 717.1084 | 717.1084 | Discouraged |
| 3 | 190 | Integer Overflow or Wraparound | 709.5923 | 709.5923 | Allowed |
| 4 | 863 | Incorrect Authorization | 701.7042 | 701.7042 | Allowed-with-Review |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | 681.4203 | 681.4203 | Allowed |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 681.2988 | 681.2988 | Allowed-with-Review |
| 7 | 1390 | Weak Authentication | 676.5202 | 676.5202 | Allowed-with-Review |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 675.0506 | 675.0506 | Allowed-with-Review |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 669.6836 | 669.6836 | Allowed |
| 10 | 400 | Uncontrolled Resource Consumption | 666.8370 | 666.8370 | Discouraged |
| 11 | 138 | Improper Neutralization of Special Elements | 222.0026 | 222.0026 | Discouraged |
