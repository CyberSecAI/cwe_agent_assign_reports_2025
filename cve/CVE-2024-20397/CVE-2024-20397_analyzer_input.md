# Vulnerability Information: CVE-2024-20397

## Vulnerability Description
A vulnerability in the bootloader of Cisco NX-OS Software could allow an unauthenticated attacker with physical access to an affected device, or an authenticated, local attacker with administrative credentials, to bypass NX-OS image signature verification. This vulnerability is due to **insecure bootloader settings**. An attacker could exploit this vulnerability by executing a series of bootloader commands. A successful exploit could allow the attacker to bypass NX-OS image signature verification and load unverified software.

### Vulnerability Description Key Phrases
- **rootcause:** **insecure bootloader settings**
- **impact:** bypass NX-OS image signature verification and load unverified software
- **vector:** executing a series of bootloader commands
- **attacker:** unauthenticated attacker with physical access and authenticated local attacker with administrative credentials
- **product:** Cisco NX-OS Software
- **component:** bootloader

## CVE Reference Links Content Summary
```
{
  "CVE-2024-20397": {
    "related_content": [
      {
        "source": "www.cisco.com_eb6a33b1_20250115_121920.html",
        "text": "This document discusses managing FPGA/EPLD/BIOS firmware on Cisco switches within the context of Cisco ACI. It explains that under normal conditions, the firmware is automatically updated through the APIC during a regular switch firmware upgrade. However, when a switch boots up using an ACI image outside of the APIC-initiated upgrade process, a firmware mismatch can occur. The document explains that since APIC release 5.2(1) and ACI switch release 15.2(1), ACI switches automatically upgrade the FPGA/EPLD/BIOS during bootup for leaf switches and box-type spine switches, along with the supervisor, linecard, and fabric modules in modular-type spine switches. The upgrade process involves comparing the BIOS and EPLD/FPGA versions and initiating an upgrade followed by power cycling the component if needed. It also mentions that system controllers do not get firmware upgrades during normal boot up sequence, and you would need to upgrade them through APICs."
      },
      {
        "source": "sec.cloudapps.cisco.com_d40ca4f4_20250115_121914.html",
        "text": "This document is a Cisco Security Advisory for CVE-2024-20397. It describes a vulnerability in the bootloader of Cisco NX-OS Software that could allow an unauthenticated attacker with physical access or an authenticated local attacker with administrative credentials to bypass NX-OS image signature verification. This vulnerability stems from insecure bootloader settings and can be exploited through a series of bootloader commands. A successful exploit allows an attacker to load unverified software. The advisory also indicates which products are affected (MDS 9000, Nexus 3000, 7000, 9000 series switches, and UCS 6400/6500 Fabric Interconnects), how to determine the NX-OS BIOS version, and states that there are no workarounds. A fix requires a BIOS update, which can be completed by upgrading NX-OS software or using specific SMUs for standalone devices. Fixed versions for specific devices and software releases are also included."
      },
      {
        "source": "sec.cloudapps.cisco.com_53341f93_20250115_121917.html",
        "text": "This document is Cisco's Security Vulnerability Policy. It outlines Cisco's approach to security vulnerabilities in its products, including incident response, reporting methods, and how security vulnerability information is communicated to customers.  It mentions Cisco's PSIRT is responsible for handling security incidents, and encourages individuals to report suspected issues via psirt@cisco.com or phone.  It also describes the use of CVSS and SIR ratings, various security publications like security advisories, event responses, and release note enclosures, along with the schedule for disclosing security advisories. It also touches upon security software updates and the Cisco bug bounty programs."
      },
      {
        "source": "www.cisco.com_2f9f34d7_20250115_121914.html",
        "text": "This document is a Cisco Intersight Managed Mode Configuration Guide, specifically focusing on managing firmware. It outlines how to upgrade firmware for various components in a Cisco UCS Domain through Cisco Intersight, including Fabric Interconnects and servers (B-Series and C-Series). It details the workflows for fabric and host firmware upgrades, and emphasizes the automatic firmware upgrades available for specific components, as well as guidelines for managing firmware when using RMA for Fabric Interconnects and servers. The document also includes information about using firmware policies for server upgrades."
      },
      {
        "source": "sec.cloudapps.cisco.com_a26a01cc_20250115_121916.html",
        "text": "This document is Cisco's Security Vulnerability Policy. It outlines Cisco's approach to security vulnerabilities in its products, including incident response, reporting methods, and how security vulnerability information is communicated to customers. It mentions Cisco's PSIRT is responsible for handling security incidents, and encourages individuals to report suspected issues via psirt@cisco.com or phone. It also describes the use of CVSS and SIR ratings, various security publications like security advisories, event responses, and release note enclosures, along with the schedule for disclosing security advisories. It also touches upon security software updates and the Cisco bug bounty programs."
      },
      {
        "source": "sec.cloudapps.cisco.com_541defda_20250115_185545.html",
        "text": "This document is a CSAF (Common Security Advisory Framework) file detailing the Cisco NX-OS Software Image Verification Bypass Vulnerability (CVE-2024-20397). It outlines the vulnerability summary, which involves bypassing NX-OS image signature verification through insecure bootloader settings, allowing attackers with physical access or local admin access to load unverified software. It also lists affected Cisco products (MDS, Nexus, and UCS Fabric Interconnect platforms that support secure boot), workarounds (none), and fixed software, including specific BIOS versions and corresponding NX-OS software releases or SMUs. The document also notes a thanks to a researcher for reporting the vulnerability."
      },
      {
          "source": "www.cisco.com_c8d6cf26_20250115_121923.html",
        "text": "This document is the Cisco Nexus 9000 Series NX-OS Software Upgrade and Downgrade Guide, Release 10.4(x). It contains information about software images, including details about  64-bit images supported on Cisco Nexus platforms. It also outlines guidelines for upgrading and downgrading the Cisco Nexus 9000 Series NX-OS software, touching upon ISSU, recommendations, prerequisites, upgrade paths, and how to manage upgrades in vPC topologies. The guide also provides software patch instructions."
      },
       {
        "source": "sec.cloudapps.cisco.com_a26a01cc_20250115_121916.html",
         "text": "This document is Cisco's Security Vulnerability Policy. It outlines Cisco's approach to security vulnerabilities in its products, including incident response, reporting methods, and how security vulnerability information is communicated to customers. It mentions Cisco's PSIRT is responsible for handling security incidents, and encourages individuals to report suspected issues via psirt@cisco.com or phone. It also describes the use of CVSS and SIR ratings, various security publications like security advisories, event responses, and release note enclosures, along with the schedule for disclosing security advisories. It also touches upon security software updates and the Cisco bug bounty programs."
      },
          {
        "source": "www.cisco.com_c8d6cf26_20250115_121923.html",
          "text":"This document provides guidelines for upgrading and downgrading Cisco Nexus 9000 Series NX-OS Software, Release 10.4(x). It includes information about Cisco NX-OS software images, ISSU (In Service Software Upgrade), and recommendations, prerequisites for upgrades and downgrades, upgrade paths, as well as instructions on how to perform upgrades via CLI and guidelines for vPC topologies. "
      },
         {
            "source": "www.cisco.com_1c1a8903_20250115_121914.html",
            "text": "This document is the Cisco Worldwide Support Contacts page. It provides phone numbers for Cisco TAC (Technical Assistance Center) support in various regions, and also provides links to additional resources like the support portal, product returns and replacement, and the Cisco community."
          },
          {
             "source": "www.cisco.com_3d92c17b_20250115_121911.html",
             "text": "This document is a Cisco end-of-sale and end-of-life announcement for the Cisco Nexus N9K-C92160YC-X. It includes information regarding the end-of-sale date, last ship date, end-of-life milestones, product part numbers affected, product migration options, and other details related to the lifecycle of the product."
           },
{
        "source": "sec.cloudapps.cisco.com_6bc878d7_20250115_121916.html",
        "text": "This document is Cisco's Security Vulnerability Policy. It outlines Cisco's approach to security vulnerabilities in its products, including incident response, reporting methods, and how security vulnerability information is communicated to customers.  It mentions Cisco's PSIRT is responsible for handling security incidents, and encourages individuals to report suspected issues via psirt@cisco.com or phone. It also describes the use of CVSS and SIR ratings, various security publications like security advisories, event responses, and release note enclosures, along with the schedule for disclosing security advisories. It also touches upon security software updates and the Cisco bug bounty programs."
      },
 {
         "source": "www.cisco.com_abe025ae_20250115_121914.html",
         "text": "This page is for My Notifications, a service that allows registered Cisco.com users to create custom subscriptions for Cisco products to receive email alerts or RSS feeds regarding Cisco Security Advisories, Field Notices, End of Sale and End of Support Announcements, software updates and bug information."
       },
    {
        "source": "www.cisco.com_d8503aba_20250115_121924.html",
        "text": "This page is a general Cisco Support & Downloads page with links to product support, software downloads, licensing, support tools, and various other help resources. It provides links to various support resources like open cases, software downloads, and links to Cisco communities."
      },
    {
        "source": "sec.cloudapps.cisco.com_cf985588_20250115_121922.html",
        "text": "This document is a listing of Cisco Security Advisories with the option to filter by product, severity and date, along with search functionality.  It mentions that Cisco security advisories are point in time documents and information should be considered up to date as of the last publication update."
      },
        {
        "source": "www.cisco.com_4b838abc_20250115_121913.html",
        "text": "This document is Cisco's customer contract experience page which explains how Cisco contracts work; covering general terms, supplemental terms, and offer descriptions. It provides additional resources related to Cisco services, buying programs, trust portal, and software transfer/re-use and portability policies along with other contracts-related information."
         },
      {
        "source": "www.cisco.com_32921cb8_20250115_121919.html",
          "text": "This document provides details on managing firmware through Cisco UCS Manager (UCSM). It covers downloading and managing firmware, firmware upgrades through auto install and firmware packages in service profiles, firmware automatic synchronization, and direct firmware upgrade at endpoints. The topics included in this section are download and manage firmware, firmware upgrades through auto install, firmware upgrades through firmware packages in service profiles, firmware automatic synchronization, and direct firmware upgrades at endpoints."
      },
       {
            "source": "bst.cloudapps.cisco.com_0d9c9001_20250115_121915.html",
            "text": "This is a page from Cisco's bug search tool, showing an error message and stating that cookies are required."
          },
{
            "source": "sec.cloudapps.cisco.com_7f67dae0_20250115_185544.html",
             "text": "This document provides a CVSS (Common Vulnerability Scoring System) calculator that allows users to compute the CVSS score based on various parameters such as Attack Vector, Attack Complexity, Privileges Required, User Interaction, Scope, Confidentiality, Integrity and Availability Impact."
           }
        ]
   ,
    "vulnerability_details": {
      "root_cause": "The vulnerability is due to insecure bootloader settings.",
      "weaknesses": [
        "Insecure bootloader settings",
        "Lack of proper image signature verification"
      ],
      "impact": "Bypassing NX-OS image signature verification, leading to the ability to load unverified software, potentially compromising the device.",
      "attack_vectors": [
        "Physical access to the device",
        "Local access with administrative credentials"
      ],
      "attacker_capabilities": "An attacker needs either physical access to the device or local administrative credentials, and an understanding of bootloader commands."
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.545 |
| 2 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.493 |
| 3 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.475 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.472 |
| 5 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.472 |
| 6 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.455 |
| 7 | 250 | Execution with Unnecessary Privileges | Base | Allowed | sparse | 0.453 |
| 8 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.451 |
| 9 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | Allowed | dense | 0.569 |
| 10 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | Allowed | graph | 0.002 |

