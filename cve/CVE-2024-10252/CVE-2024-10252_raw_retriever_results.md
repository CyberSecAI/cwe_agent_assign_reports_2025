# Raw Retriever Results for CVE-2024-10252

# Raw Retriever Results for CVE-2024-10252
## Query
A vulnerability in langgenius/dify versions <=v0.9.1 allows for code injection via internal SSRF requests in the Dify sandbox service. This vulnerability enables an attacker to execute arbitrary Python code with root privileges within the sandbox environment, potentially leading to the deletion of the entire sandbox service and causing irreversible damage.

## Keyphrases
- **weakness**: 'code injection via internal SSRF requests'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4548 | 0.5273 | 0.4811 | 0.4755 | 20 |
| Sparse | 84.6203 | 800.0000 | 279.8942 | 264.3857 | 12 |
| Graph | 1.3161 | 2.2568 | 1.7219 | 1.6320 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2568 | Allowed-with-Review |
| 2 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.2100 | Allowed |
| 4 | 611 | Improper Restriction of XML External Entity Reference | base | 2.1190 | Allowed |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 2.1063 | Allowed-with-Review |
| 6 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 2.0542 | Allowed |
| 7 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 8 | 73 | External Control of File Name or Path | Base | 1.6654 | Allowed |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | 1.6595 | Allowed |
| 10 | 473 | PHP External Variable Modification | variant | 1.6320 | Allowed |
| 11 | 456 | Missing Initialization of a Variable | variant | 1.6320 | Allowed |
| 12 | 184 | Incomplete List of Disallowed Inputs | Base | 1.5412 | Allowed |
| 13 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 1.5318 | Allowed |
| 14 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 1.5211 | Allowed |
| 15 | 1333 | Inefficient Regular Expression Complexity | Base | 1.4838 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.5273 | 0.5273 | Allowed-with-Review |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 0.5251 | 0.5251 | Allowed |
| 3 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5079 | 0.5079 | Allowed |
| 4 | 1333 | Inefficient Regular Expression Complexity | Base | 0.5066 | 0.5066 | Allowed |
| 5 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.5059 | 0.5059 | Allowed |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.4962 | 0.4962 | Allowed |
| 7 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.4941 | 0.4941 | Allowed |
| 8 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 0.4920 | 0.4920 | Allowed |
| 9 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.4898 | 0.4898 | Allowed |
| 10 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.4879 | 0.4879 | Allowed |
| 11 | 184 | Incomplete List of Disallowed Inputs | Base | 0.4631 | 0.4631 | Allowed |
| 12 | 506 | Embedded Malicious Code | Class | 0.4629 | 0.4629 | Allowed-with-Review |
| 13 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.4619 | 0.4619 | Allowed |
| 14 | 285 | Improper Authorization | Class | 0.4615 | 0.4615 | Discouraged |
| 15 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.4585 | 0.4585 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 918 | Server-Side Request Forgery (SSRF) | 800.0000 | 800.0000 | Allowed |
| 2 | 611 | Improper Restriction of XML External Entity Reference | 298.9951 | 298.9951 | Allowed |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | 267.0571 | 267.0571 | Allowed-with-Review |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 267.0369 | 267.0369 | Allowed |
| 5 | 20 | Improper Input Validation | 265.3285 | 265.3285 | Discouraged |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 264.8933 | 264.8933 | Allowed |
| 7 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 263.8780 | 263.8780 | Allowed-with-Review |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 258.5878 | 258.5878 | Allowed |
| 9 | 502 | Deserialization of Untrusted Data | 250.7224 | 250.7224 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | 250.5639 | 250.5639 | Allowed |
| 11 | 122 | Heap-based Buffer Overflow | 87.0464 | 87.0464 | Allowed |
| 12 | 284 | Improper Access Control | 84.6203 | 84.6203 | Discouraged |
