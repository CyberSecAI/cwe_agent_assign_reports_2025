# Raw Retriever Results for CVE-2025-21880

# Raw Retriever Results for CVE-2025-21880
## Query
In the Linux kernel, the following vulnerability has been resolved drm/xe/userptr fix EFAULT handling Currently we treat EFAULT from hmm_range_fault() as a non-fatal error when called from xe_vm_userptr_pin() with the idea that we want to avoid killing the entire vm and chucking an error, under the assumption that the user just did an unmap or something, and has no intention of actually touching that memory from the GPU. At this point we have already zapped the PTEs so any access should generate a page fault, and if the pin fails there also it will then become fatal. However it looks like its possible for the userptr vma to still be on the rebind list in preempt_rebind_work_func(), if we had to retry the pin again due to something happening in the caller before we did the rebind step, but in the meantime needing to re-validate the userptr and this time hitting the EFAULT. This explains an internal user report of hitting [ 191.738349] WARNING CPU 1 PID 157 at drivers/gpu/drm/xe/xe_res_cursor.h158 xe_pt_stage_bind.constprop.0+0x60a/0x6b0 [xe] [ 191.738551] Workqueue xe-ordered-wq preempt_rebind_work_func [xe] [ 191.738616] RIP 0010xe_pt_stage_bind.constprop.0+0x60a/0x6b0 [xe] [ 191.738690] Call Trace [ 191.738692] [ 191.738694] ? show_regs+0x69/0x80 [ 191.738698] ? __warn+0x93/0x1a0 [ 191.738703] ? xe_pt_stage_bind.constprop.0+0x60a/0x6b0 [xe] [ 191.738759] ? report_bug+0x18f/0x1a0 [ 191.738764] ? handle_bug+0x63/0xa0 [ 191.738767] ? exc_invalid_op+0x19/0x70 [ 191.738770] ? asm_exc_invalid_op+0x1b/0x20 [ 191.738777] ? xe_pt_stage_bind.constprop.0+0x60a/0x6b0 [xe] [ 191.738834] ? ret_from_fork_asm+0x1a/0x30 [ 191.738849] bind_op_prepare+0x105/0x7b0 [xe] [ 191.738906] ? dma_resv_reserve_fences+0x301/0x380 [ 191.738912] xe_pt_update_ops_prepare+0x28c/0x4b0 [xe] [ 191.738966] ? kmemleak_alloc+0x4b/0x80 [ 191.738973] ops_execute+0x188/0x9d0 [xe] [ 191.739036] xe_vm_rebind+0x4ce/0x5a0 [xe] [ 191.739098] ? trace_hardirqs_on+0x4d/0x60 [ 191.739112] preempt_rebind_work_func+0x76f/0xd00 [xe] Followed by NPD, when running some workload, since the sg was never actually populated but the vma is still marked for rebind when it should be skipped for this special EFAULT case. This is confirmed to fix the user report. v2 (MattB) - Move earlier. v3 (MattB) - Update the commit message to make it clear that this indeed fixes the issue. (cherry picked from commit 6b93cb98910c826c2e2004942f8b060311e43618)

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4734 | 0.5385 | 0.4930 | 0.4911 | 20 |
| Sparse | 355.3002 | 432.9884 | 369.9890 | 362.7396 | 10 |
| Graph | 1.6848 | 2.8652 | 2.1961 | 2.1436 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.7342 | Allowed |
| 3 | 123 | Write-what-where Condition | base | 2.7014 | Allowed |
| 4 | 456 | Missing Initialization of a Variable | variant | 2.6784 | Allowed |
| 5 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 2.6100 | Allowed |
| 6 | 457 | Use of Uninitialized Variable | variant | 2.4624 | Allowed |
| 7 | 134 | Use of Externally-Controlled Format String | base | 2.3400 | Allowed |
| 8 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 9 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 10 | 416 | Use After Free | Variant | 2.1683 | Allowed |
| 11 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.1190 | Allowed |
| 12 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 13 | 73 | External Control of File Name or Path | base | 2.0592 | Allowed |
| 14 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 2.0400 | Allowed |
| 15 | 129 | Improper Validation of Array Index | variant | 1.8394 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.5385 | 0.5385 | Allowed-with-Review |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5182 | 0.5182 | Allowed-with-Review |
| 3 | 667 | Improper Locking | Class | 0.5149 | 0.5149 | Allowed-with-Review |
| 4 | 416 | Use After Free | Variant | 0.5069 | 0.5069 | Allowed |
| 5 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5007 | 0.5007 | Allowed |
| 6 | 908 | Use of Uninitialized Resource | Base | 0.4965 | 0.4965 | Allowed |
| 7 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4962 | 0.4962 | Allowed |
| 8 | 190 | Integer Overflow or Wraparound | Base | 0.4962 | 0.4962 | Allowed |
| 9 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4934 | 0.4934 | Allowed |
| 10 | 787 | Out-of-bounds Write | Base | 0.4917 | 0.4917 | Allowed |
| 11 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4904 | 0.4904 | Allowed |
| 12 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4896 | 0.4896 | Allowed |
| 13 | 122 | Heap-based Buffer Overflow | Variant | 0.4868 | 0.4868 | Allowed |
| 14 | 366 | Race Condition within a Thread | Base | 0.4845 | 0.4845 | Allowed |
| 15 | 126 | Buffer Over-read | Variant | 0.4812 | 0.4812 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 191 | Integer Underflow (Wrap or Wraparound) | 432.9884 | 432.9884 | Allowed |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | 386.1631 | 386.1631 | Allowed |
| 3 | 457 | Use of Uninitialized Variable | 364.1019 | 364.1019 | Allowed |
| 4 | 668 | Exposure of Resource to Wrong Sphere | 362.9591 | 362.9591 | Discouraged |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 362.9028 | 362.9028 | Allowed |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | 362.5764 | 362.5764 | Allowed |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | 360.0424 | 360.0424 | Allowed |
| 8 | 346 | Origin Validation Error | 356.9488 | 356.9488 | Allowed-with-Review |
| 9 | 20 | Improper Input Validation | 355.9070 | 355.9070 | Discouraged |
| 10 | 863 | Incorrect Authorization | 355.3002 | 355.3002 | Allowed-with-Review |
