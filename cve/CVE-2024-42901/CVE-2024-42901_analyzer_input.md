# Vulnerability Information: CVE-2024-42901

## Vulnerability Description
A CSV injection vulnerability in Lime Survey v6.5.12 allows attackers to execute arbitrary code via uploading a crafted CSV file.

### Vulnerability Description Key Phrases
- **weakness:** **cross-site scripting**
- **impact:** execute arbitrary code
- **attacker:** attackers
- **product:** Lime Survey
- **version:** v6.5.12

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-42901:

**Root cause of vulnerability:**

The root cause is the lack of sanitization of the CSV file name during user import in LimeSurvey. The application fails to properly sanitize or encode the filename, allowing an attacker to inject malicious code within the filename.

**Weaknesses/vulnerabilities present:**

- **Stored XSS (Cross-Site Scripting):** The primary vulnerability is a stored XSS. By embedding malicious JavaScript code within the CSV filename, the attacker can have the code executed in the context of other users' browsers when they access the user management page where the file name is displayed.

**Impact of exploitation:**

- **Arbitrary code execution:** Successful exploitation could allow an attacker to execute arbitrary JavaScript code in the browsers of users who view the user management page. This could lead to a range of malicious actions, including:
    - Stealing cookies and session tokens, leading to account hijacking
    - Defacing web pages
    - Redirecting users to malicious sites
    - Performing actions on behalf of the victim user.
    - Data theft

**Attack vectors:**

- **CSV File Upload:** The attacker crafts a CSV file with a malicious filename, injecting a XSS payload within the filename.
- **User Management Page:** The XSS payload is triggered when users view the user management page.

**Required attacker capabilities/position:**

- **High privileges:** The attacker needs to have the necessary privileges to import users through the CSV file upload functionality in LimeSurvey.
- **Access to LimeSurvey**: The attacker needs to have access to the target LimeSurvey instance.

**Additional details:**
- The vulnerability was fixed in LimeSurvey.
- The provided PoC steps show how to trigger the vulnerability and included screenshots demonstrating the exploitation.
- The pull request ([LimeSurvey/LimeSurvey#3884](https://github.com/LimeSurvey/LimeSurvey/pull/3884)) shows the fix where the extension is removed from the alert result and control for empty CSV files is added.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | sparse | 0.156 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.144 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.142 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.136 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.127 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.121 |
| 7 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.121 |
| 8 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.120 |
| 9 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | dense | 0.543 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

