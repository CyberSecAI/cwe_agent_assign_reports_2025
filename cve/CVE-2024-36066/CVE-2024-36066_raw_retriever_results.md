# Raw Retriever Results for CVE-2024-36066

# Raw Retriever Results for CVE-2024-36066
## Query
The CMP CLI client in KeyFactor EJBCA before 8.3.1 has only 6 octets of salt, and is thus not compliant with the security requirements of RFC 4211, and might make man-in-the-middle attacks easier. CMP includes password-based MAC as one of the options for message integrity and authentication (the other option is certificate-based). RFC 4211 section 4.4 requires that password-based MAC parameters use a salt with a random value of at least 8 octets. This helps to inhibit dictionary attacks. Because the standalone CMP client originally was developed as test code, the salt was instead hardcoded and only 6 octets long.

## Keyphrases
- **rootcause**: 'only 6 octets of salt'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4566 | 0.5617 | 0.4856 | 0.4739 | 20 |
| Sparse | 163.7801 | 564.8592 | 471.4845 | 518.6314 | 12 |
| Graph | 0.9360 | 2.4700 | 1.3162 | 1.0062 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 303 | Incorrect Implementation of Authentication Algorithm | base | 2.4700 | Allowed |
| 2 | 290 | Authentication Bypass by Spoofing | base | 1.8018 | Allowed |
| 3 | 325 | Missing Cryptographic Step | Base | 1.7839 | Allowed |
| 4 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | 1.7057 | Allowed |
| 5 | 521 | Weak Password Requirements | Base | 1.6576 | Allowed |
| 6 | 759 | Use of a One-Way Hash without a Salt | Variant | 1.5352 | Allowed |
| 7 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | 1.5296 | Allowed |
| 8 | 358 | Improperly Implemented Security Check for Standard | base | 1.5210 | Allowed |
| 9 | 1390 | Weak Authentication | class | 1.4080 | Allowed-with-Review |
| 10 | 804 | Guessable CAPTCHA | base | 1.0062 | Allowed |
| 11 | 309 | Use of Password System for Primary Authentication | base | 1.0062 | Allowed |
| 12 | 307 | Improper Restriction of Excessive Authentication Attempts | base | 1.0062 | Allowed |
| 13 | 305 | Authentication Bypass by Primary Weakness | base | 1.0062 | Allowed |
| 14 | 301 | Reflection Attack in an Authentication Protocol | base | 1.0062 | Allowed |
| 15 | 294 | Authentication Bypass by Capture-replay | base | 1.0062 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 759 | Use of a One-Way Hash without a Salt | Variant | 0.5617 | 0.5617 | Allowed |
| 2 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | 0.5486 | 0.5486 | Allowed |
| 3 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | 0.5176 | 0.5176 | Allowed |
| 4 | 325 | Missing Cryptographic Step | Base | 0.5052 | 0.5052 | Allowed |
| 5 | 521 | Weak Password Requirements | Base | 0.5046 | 0.5046 | Allowed |
| 6 | 836 | Use of Password Hash Instead of Password for Authentication | Base | 0.5039 | 0.5039 | Allowed |
| 7 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 0.4986 | 0.4986 | Allowed |
| 8 | 300 | Channel Accessible by Non-Endpoint | Class | 0.4937 | 0.4937 | Discouraged |
| 9 | 1394 | Use of Default Cryptographic Key | Base | 0.4843 | 0.4843 | Allowed |
| 10 | 649 | Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking | Base | 0.4783 | 0.4783 | Allowed |
| 11 | 304 | Missing Critical Step in Authentication | Base | 0.4695 | 0.4695 | Allowed |
| 12 | 603 | Use of Client-Side Authentication | Base | 0.4644 | 0.4644 | Allowed |
| 13 | 555 | J2EE Misconfiguration: Plaintext Password in Configuration File | Variant | 0.4638 | 0.4638 | Allowed |
| 14 | 329 | Generation of Predictable IV with CBC Mode | Variant | 0.4622 | 0.4622 | Allowed |
| 15 | 328 | Use of Weak Hash | Base | 0.4618 | 0.4618 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 759 | Use of a One-Way Hash without a Salt | 564.8592 | 564.8592 | Allowed |
| 2 | 760 | Use of a One-Way Hash with a Predictable Salt | 561.9453 | 561.9453 | Allowed |
| 3 | 916 | Use of Password Hash With Insufficient Computational Effort | 546.7110 | 546.7110 | Allowed |
| 4 | 1390 | Weak Authentication | 544.4075 | 544.4075 | Allowed-with-Review |
| 5 | 303 | Incorrect Implementation of Authentication Algorithm | 532.8165 | 532.8165 | Allowed |
| 6 | 116 | Improper Encoding or Escaping of Output | 519.7041 | 519.7041 | Allowed-with-Review |
| 7 | 330 | Use of Insufficiently Random Values | 517.5587 | 517.5587 | Discouraged |
| 8 | 259 | Use of Hard-coded Password | 514.7686 | 514.7686 | Allowed |
| 9 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | 514.0362 | 514.0362 | Allowed |
| 10 | 328 | Use of Weak Hash | 511.6878 | 511.6878 | Allowed |
| 11 | 319 | Cleartext Transmission of Sensitive Information | 165.5391 | 165.5391 | Allowed |
| 12 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 163.7801 | 163.7801 | Allowed-with-Review |
