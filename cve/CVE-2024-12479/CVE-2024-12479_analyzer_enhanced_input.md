## Vulnerability Description
A vulnerability was found in cjbi wetech-cms 1.0/1.1/1.2 and classified as critical. This issue affects the function searchTopicByKeyword of the file wetech-cms-master\wetech-core\src\main\java\tech\wetech\cms\dao\TopicDao.java. The manipulation of the argument keyword leads to **sql injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** cjbi wetech-cms
- **version:** 1.0/1.1/1.2
- **component:** searchTopicByKeyword

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the SQL injection vulnerability:

**Root cause of vulnerability:**

The vulnerability stems from the lack of proper sanitization or parameterization of user-supplied input within the `TopicDao.java` file of the `wetech-cms` project. Specifically, the `keyword` parameter in the `/keyword/{id}` route is directly incorporated into an SQL query without adequate escaping or validation.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection:** The primary weakness is the direct inclusion of user-controlled data into an SQL query, which enables an attacker to manipulate the query's structure and logic.
*  **Lack of Input Validation:** The system fails to validate or sanitize the input received for the keyword parameter.

**Impact of exploitation:**

*   **Information Disclosure:** An attacker can extract sensitive database information, including database names, table names, and stored data. As shown in the example, the attacker was able to extract the database name.
*   **Potential for Data Modification or Deletion:** Depending on the database user privileges, an attacker could potentially modify or delete data. This is not demonstrated in the provided content, but is a typical risk of SQL injection.

**Attack vectors:**

*   **HTTP GET Request:** The vulnerability is triggered by sending a crafted GET request to the `/keyword/{id}` endpoint.
*   **Malicious Input:** The attacker injects malicious SQL code into the `keyword` parameter of the URL.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs to have network access to the target application to send HTTP requests.
*   **Understanding of SQL Syntax:** The attacker needs a basic understanding of SQL syntax to craft the injection payloads.
*   **Knowledge of the Application's API:** Knowledge of the vulnerable endpoint and its parameter is required.

**Technical Details:**

*   The vulnerability is demonstrated through a crafted SQL payload injected into the `keyword` parameter.
*   The provided python script automates the extraction of database name using blind SQL injection techniques by measuring the response lengths.
*   The vulnerable code resides in `wetech-cms-master\wetech-core\src\main\java\tech\wetech\cms\dao\TopicDao.java`

In summary, the provided content demonstrates a classic SQL injection vulnerability in `wetech-cms` due to unsanitized user input in SQL queries. It provides details on the attack vector, payload construction, and a python script to automate exploitation and data extraction.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.469 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.424 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.408 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.384 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.378 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.378 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.376 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.635 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-502: Deserialization of Untrusted Data

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-73: External Control of File Name or Path