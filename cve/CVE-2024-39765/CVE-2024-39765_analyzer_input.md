# Vulnerability Information: CVE-2024-39765

## Vulnerability Description
Multiple **OS command injection** vulnerabilities exist in the internet.cgi set_add_routing() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary command execution. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.A command injection vulnerability exists in the `custom_interface` POST parameter.

### Vulnerability Description Key Phrases
- **component:** internet.cgi set_add_routing() functionality
- **vector:** specially crafted HTTP request
- **weakness:** **OS command injection**
- **product:** Wavlink AC3000 M33A8
- **impact:** command execution, arbitrary command execution
- **version:** V5030.210505

## CVE Reference Links Content Summary
Root cause of vulnerability:
The Wavlink AC3000 router's `internet.cgi` script does not properly sanitize user-supplied input from HTTP POST requests before using it in system commands executed via `popen`. Specifically, the `netmask`, `gateway`, `dest`, `custom_interface`, `interface`, `hostnet`, and `comment` parameters are vulnerable.

Weaknesses/vulnerabilities present:
- Improper Neutralization of Special Elements used in a Command (‘Command Injection’) - CWE-77
- Lack of input validation/sanitization in the `internet.cgi` script.
- Use of `popen` with unsanitized input.

Impact of exploitation:
- Arbitrary command execution on the router.

Attack vectors:
- An attacker can send a crafted HTTP POST request to the `internet.cgi` script with malicious input in the vulnerable parameters.
- Requires network access to the device.
- Requires authentication (a valid session cookie).

Required attacker capabilities/position:
- Authenticated network access to the Wavlink AC3000 router (i.e., a valid session cookie).
- Knowledge of the vulnerable parameters and how to craft a malicious HTTP POST request.

Mitigation or fix:
- The report does not specify a fix, but implies that proper input validation and sanitization are required to prevent command injection. The vendor was contacted and is working on patches, but the product has been discontinued.

This content provides more detail than the official CVE description. It details the specific vulnerable parameters, the functions involved, and the exact locations in the code where the vulnerability exists. It also provides a timeline of vendor communication.



CVE-2024-39765 is one of several CVEs (CVE-2024-39762, CVE-2024-39763, CVE-2024-39764) reported in the same Talos vulnerability report.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.355 |
| 4 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.342 |
| 5 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.340 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.321 |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.308 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.307 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.627 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |

