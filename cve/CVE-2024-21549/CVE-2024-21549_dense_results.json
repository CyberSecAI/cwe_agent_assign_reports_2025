{
  "query": "Versions of the package spatie/browsershot before 5.0.3 are vulnerable to Improper Input Validation due to improper URL validation through the setUrl method. An attacker can exploit this vulnerability by utilizing view-sourcefile//, which allows for arbitrary file reading on a local file. **Note** This is a bypass of the fix for [CVE-2024-21544](https//security.snyk.io/vuln/SNYK-PHP-SPATIEBROWSERSHOT-8496745).",
  "count": 20,
  "results": [
    {
      "cwe_id": "79",
      "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "abstraction": "Base",
      "score": 0.5808108848877367,
      "original_score": 0.5808108848877367,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "80",
      "name": "Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)",
      "abstraction": "Variant",
      "score": 0.5784244534322623,
      "original_score": 0.5784244534322623,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "784",
      "name": "Reliance on Cookies without Validation and Integrity Checking in a Security Decision",
      "abstraction": "Variant",
      "score": 0.5655741750147357,
      "original_score": 0.5655741750147357,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "116",
      "name": "Improper Encoding or Escaping of Output",
      "abstraction": "Class",
      "score": 0.5641092216471483,
      "original_score": 0.5641092216471483,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "20",
      "name": "Improper Input Validation",
      "abstraction": "Class",
      "score": 0.5566756305768655,
      "original_score": 0.5566756305768655,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "525",
      "name": "Use of Web Browser Cache Containing Sensitive Information",
      "abstraction": "Variant",
      "score": 0.5560916611711331,
      "original_score": 0.5560916611711331,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "918",
      "name": "Server-Side Request Forgery (SSRF)",
      "abstraction": "Base",
      "score": 0.5513764884329733,
      "original_score": 0.5513764884329733,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "352",
      "name": "Cross-Site Request Forgery (CSRF)",
      "abstraction": "Compound",
      "score": 0.5505597787203483,
      "original_score": 0.5505597787203483,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "78",
      "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
      "abstraction": "Base",
      "score": 0.544415794812352,
      "original_score": 0.544415794812352,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "184",
      "name": "Incomplete List of Disallowed Inputs",
      "abstraction": "Base",
      "score": 0.5441260087609743,
      "original_score": 0.5441260087609743,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "84",
      "name": "Improper Neutralization of Encoded URI Schemes in a Web Page",
      "abstraction": "Variant",
      "score": 0.5389049892309792,
      "original_score": 0.5389049892309792,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "451",
      "name": "User Interface (UI) Misrepresentation of Critical Information",
      "abstraction": "Class",
      "score": 0.5367707409200242,
      "original_score": 0.5367707409200242,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1004",
      "name": "Sensitive Cookie Without 'HttpOnly' Flag",
      "abstraction": "Variant",
      "score": 0.5345017612099486,
      "original_score": 0.5345017612099486,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "346",
      "name": "Origin Validation Error",
      "abstraction": "Class",
      "score": 0.5342021753832535,
      "original_score": 0.5342021753832535,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "177",
      "name": "Improper Handling of URL Encoding (Hex Encoding)",
      "abstraction": "Variant",
      "score": 0.5323123787765212,
      "original_score": 0.5323123787765212,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "790",
      "name": "Improper Filtering of Special Elements",
      "abstraction": "Class",
      "score": 0.532285935547033,
      "original_score": 0.532285935547033,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1336",
      "name": "Improper Neutralization of Special Elements Used in a Template Engine",
      "abstraction": "Base",
      "score": 0.5319768076136091,
      "original_score": 0.5319768076136091,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "565",
      "name": "Reliance on Cookies without Validation and Integrity Checking",
      "abstraction": "Base",
      "score": 0.5315666527731513,
      "original_score": 0.5315666527731513,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1385",
      "name": "Missing Origin Validation in WebSockets",
      "abstraction": "Variant",
      "score": 0.5313014007196939,
      "original_score": 0.5313014007196939,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "95",
      "name": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "abstraction": "Variant",
      "score": 0.5304785918052743,
      "original_score": 0.5304785918052743,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.5304785918052743,
    "max": 0.5808108848877367,
    "mean": 0.5463232765718009,
    "median": 0.5415154989959767,
    "count": 20
  }
}