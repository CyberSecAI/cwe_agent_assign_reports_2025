# Vulnerability Information: CVE-2024-4902

## Vulnerability Description
The Tutor LMS - eLearning and online course solution plugin for WordPress is vulnerable to **time-based SQL Injection** via the course_id parameter in all versions up to, and including, 2.7.1 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with admin access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL Injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers
- **product:** Tutor LMS - eLearning and online course solution plugin for WordPress
- **version:** all versions up to and including 2.7.1
- **component:** course_id parameter

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-89

#### Top CWEs
- CWE-89 (Count: 19)

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-4902:

**1. Verification of CVE Relevance**
   - The provided content from Wordfence directly references **CVE-2024-4902** and describes a SQL injection vulnerability in the Tutor LMS plugin.
   - The description matches the stated vulnerability: a time-based SQL Injection via the `course_id` parameter due to insufficient escaping and query preparation.

**2. Root Cause of Vulnerability**
   - The root cause is the **lack of proper sanitization and escaping** of the `course_id` parameter when constructing SQL queries. This allows an attacker to inject malicious SQL code into the query.
   - The vulnerability lies within the pluginâ€™s `classes/Utils.php` file in a function that performs a database query.

**3. Weaknesses/Vulnerabilities Present**
   - **SQL Injection:** The primary vulnerability is SQL injection, specifically time-based.
   - **Insufficient Input Sanitization:** The plugin does not sufficiently sanitize or escape the user-supplied `course_id` parameter before using it in a SQL query.
   - **Lack of Prepared Statements:** The use of direct string concatenation to build SQL queries rather than prepared statements allows the injected SQL code to be executed.

**4. Impact of Exploitation**
   - **Information Disclosure:** Successful exploitation of this vulnerability can allow attackers to gain access to sensitive information from the database.
  - **Data Manipulation:** The attacker could possibly modify data within the database or delete it.
   - **Full system compromise:** In severe cases, an attacker may achieve full control over the database and the affected system.

**5. Attack Vectors**
   - **Attack Vector:** The vulnerability is exploitable remotely via a web request that includes a malformed `course_id` parameter.
   - **Attack Location:** The attack occurs in the `classes/Utils.php` file, where the vulnerable SQL query is executed.

**6. Required Attacker Capabilities/Position**
   - **Authentication:** An attacker needs to be an authenticated user with Administrator or a higher-level access rights.
   - **Technical Skill:** Some technical knowledge is required to craft the malformed SQL injection query effectively.

**Additional Details Beyond the CVE Description**
- The content from `plugins.trac.wordpress.org` provides specific code changes made to the `Utils.php` file in the Tutor LMS plugin to address the vulnerability (commit: 3098465)
- Wordfence's analysis indicates that the vulnerability is time-based SQL injection and affects all versions of Tutor LMS up to and including 2.7.1, and that CVE-2024-37256 is likely a duplicate of this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.577 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.528 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.515 |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.510 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.506 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.506 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.503 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.502 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

