# Vulnerability Information: CVE-2024-50377

## Vulnerability Description
A CWE-798 Use of Hard-coded Credentials was discovered affecting the following devices manufactured by Advantech EKI-6333AC-2G (<= 1.6.3), EKI-6333AC-2GD (<= v1.6.3) and EKI-6333AC-1GPO (<= v1.2.1). The vulnerability is associated to the backup configuration functionality that by default encrypts the archives using a static password.

### Vulnerability Description Key Phrases
- **rootcause:** **hard-coded credentials**
- **impact:** backup configuration functionality uses static password
- **product:** Advantech EKI-6333AC-2G and EKI-6333AC-2GD and EKI-6333AC-1GPO
- **version:** <= 1.6.3 and <= v1.6.3 and <= v1.2.1
- **component:** backup configuration functionality

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from the use of a hardcoded encryption key within the backup configuration functionality of the affected Advantech devices.

**Weaknesses/Vulnerabilities:**
- **CWE-798 "Use of Hard-coded Credentials":** The devices utilize a static, hardcoded password to encrypt backup configurations, making it easily discoverable.

**Impact of Exploitation:**
- An attacker who discovers the hardcoded key can create malicious backup configurations.
- These crafted malicious backup files can then be restored onto the affected devices.
- Successful restoration of a malicious backup could lead to complete compromise of the device, allowing an attacker to execute arbitrary commands, disrupt operations, or gain further access to the network.

**Attack Vectors:**
- An attacker with access to the device's backup functionality can exploit this vulnerability. This could involve local access or potentially remote access depending on the device's network configuration.

**Required Attacker Capabilities/Position:**
- The attacker needs to have privileged access (High Privilege - PR:H) to the device, as well as user interaction (User interaction required - UI:R). This means they would need existing access to the device's management interface in order to initiate the backup restore with a malicious file.
- The attacker needs knowledge of the hardcoded password, which is the core of this vulnerability.
- The attacker needs the capability to craft and deploy a malicious backup file.

**CVSS Score:**
- 6.5 (CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H) indicating a medium severity vulnerability.
    - AV:L (Local) - The attack vector is local.
    - AC:L (Low) - The attack complexity is low.
    - PR:H (High) - High privileges are required to exploit.
    - UI:R (Required) - User interaction is required.
    - S:U (Unchanged) - Scope is Unchanged.
    - C:H (High) - Confidentiality Impact is High.
    - I:H (High) - Integrity Impact is High.
    - A:H (High) - Availability Impact is High.

**Affected Devices/Versions:**
- EKI-6333AC-2G (<= v1.6.3)
- EKI-6333AC-2GD (<= v1.6.3)
- EKI-6333AC-1GPO (<= v1.2.1)

**Solution:**
- Update the affected devices to the following firmware versions:
    - EKI-6333AC-2G: v1.6.5
    - EKI-6333AC-2GD: v1.6.5
    - EKI-6333AC-1GPO: v1.2.2

This information is more detailed than a placeholder description and provides a clear explanation of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.380 |
| 2 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.374 |
| 3 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.369 |
| 4 | 912 | Hidden Functionality | Class | Allowed-with-Review | sparse | 0.315 |
| 5 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.301 |
| 6 | 1392 | Use of Default Credentials | Base | Allowed | sparse | 0.267 |
| 7 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.255 |
| 8 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.255 |
| 9 | 1393 | Use of Default Password | Base | Allowed | dense | 0.649 |
| 10 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | graph | 0.002 |

