## Vulnerability Description
The Related Posts, Inline Related Posts, Contextual Related Posts, Related Content By PickPlugins plugin for WordPress is vulnerable to **Sensitive Information Exposure** in all versions up to, and including, 2.0.58 via the wp_ajax_nopriv_related_post_ajax_get_post_ids AJAX action. This makes it possible for unauthenticated attackers to extract sensitive data including titles of posts in draft status.

### Vulnerability Description Key Phrases
- **weakness:** **Sensitive Information Exposure**
- **impact:** extract sensitive data including titles of posts in draft status
- **attacker:** unauthenticated attackers
- **product:** Related Posts and Inline Related Posts and Contextual Related Posts and Related Content By PickPlugins plugin for WordPress
- **version:** all versions up to and including 2.0.58
- **component:** wp_ajax_nopriv_related_post_ajax_get_post_ids AJAX action

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-10937

**Root Cause of Vulnerability:**
The vulnerability stems from improper access control in the `related_post_ajax_get_post_ids` AJAX action. This action was accessible to unauthenticated users due to the use of `wp_ajax_nopriv_`.

**Weaknesses/Vulnerabilities Present:**
- **Improper Access Control:** The AJAX action `related_post_ajax_get_post_ids` lacked proper authentication checks, making it accessible to unauthenticated users.
- **Sensitive Information Exposure:** The vulnerable function allowed retrieval of data, including titles of posts, even if the posts were in draft status.

**Impact of Exploitation:**
- **Information Disclosure:** An attacker could retrieve sensitive information about unpublished content, specifically the titles of draft posts. This could reveal information that was intended to be kept private.

**Attack Vectors:**
- **Network:** The vulnerability is accessible remotely over the network.
- **Unauthenticated Access:**  An attacker does not need to be logged in or have any specific user privileges to exploit the vulnerability.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send a request to the vulnerable AJAX endpoint (`wp_ajax_nopriv_related_post_ajax_get_post_ids`). No other special capabilities are required.

**Additional details:**
- The vulnerability was fixed by removing the `wp_ajax_nopriv_` action hook for `related_post_ajax_get_post_ids`, effectively restricting access to authenticated users with the 'manage_options' capability.
- The affected plugin is "Related Posts, Inline Related Posts, Contextual Related Posts, Related Content By PickPlugins" versions up to and including 2.0.58
- The vulnerability was patched in version 2.0.59

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.311 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.308 |
| 3 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.305 |
| 4 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.300 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.287 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.279 |
| 7 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.276 |
| 8 | 24 | Path Traversal: '../filedir' | Variant | Allowed | sparse | 0.275 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.522 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-863: Incorrect Authorization

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-862: Missing Authorization

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-285: Improper Authorization

CWE-266: Incorrect Privilege Assignment

CWE-24: Path Traversal: '../filedir'

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type