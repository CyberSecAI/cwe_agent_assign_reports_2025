# Vulnerability Information: CVE-2024-46868

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved firmware qcom uefisecapp Fix **deadlock** in qcuefi_acquire() **If the __qcuefi pointer is not set, then in the original code, we would hold onto the lock**. That means that if we tried to set it later, then it would cause a **deadlock**. Drop the lock on the error path. Thats what all the callers are expecting.

### Vulnerability Description Key Phrases
- **rootcause:** **If the __qcuefi pointer is not set, then in the original code, we would hold onto the lock**
- **weakness:** **deadlock**
- **product:** Linux kernel
- **component:** qcom uefisecapp

## CVE Reference Links Content Summary
The provided content relates to a fix for a deadlock vulnerability in the Qualcomm UEFI Secure Application driver within the Linux kernel.

- **Root cause of vulnerability:** The `qcuefi_acquire` function would hold the `__qcuefi_lock` even when the `__qcuefi` pointer was not set. This could lead to a deadlock if another part of the code tried to set the `__qcuefi` pointer while the lock was held.
- **Weaknesses/vulnerabilities present:** Deadlock due to improper lock handling
- **Impact of exploitation:** System deadlock
- **Attack vectors:** An attacker would need to trigger the code path where `qcuefi_acquire` is called before `__qcuefi` is initialized, and then trigger the code path that would initialize `__qcuefi` to cause the deadlock
- **Required attacker capabilities/position:** The attacker would need to have a specific driver/module load sequence or specific sequence of actions that call the affected function.

The fix addresses the deadlock by releasing the lock when `__qcuefi` is not set, preventing the deadlock from occurring.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.427 |
| 2 | 833 | Deadlock | Base | Allowed | sparse | 0.407 |
| 3 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.368 |
| 4 | 194 | Unexpected Sign Extension | Variant | Allowed | sparse | 0.368 |
| 5 | 415 | Double Free | Variant | Allowed | sparse | 0.364 |
| 6 | 824 | Access of Uninitialized Pointer | Base | Allowed | sparse | 0.362 |
| 7 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.359 |
| 8 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.357 |
| 9 | 413 | Improper Resource Locking | Base | Allowed | dense | 0.545 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |

