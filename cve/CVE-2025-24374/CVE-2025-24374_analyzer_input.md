# Vulnerability Information: CVE-2025-24374

## Vulnerability Description
Twig is a template language for PHP. When using the ?? operator, **output escaping was missing** for the expression on the left side of the operator. This vulnerability is fixed in 3.19.0.

### Vulnerability Description Key Phrases
- **weakness:** **output escaping was missing**
- **product:** Twig
- **version:** before 3.19.0

## CVE Reference Links Content Summary
CVE-2025-24374

**Root cause of vulnerability:**
The vulnerability is caused by missing output escaping when using the null coalesce operator (`??`) in Twig. Specifically, the expression on the left side of the operator was not being properly escaped.

**Weaknesses/vulnerabilities present:**
- Missing output escaping.
- Potential for Cross-Site Scripting (XSS) if the left-hand side of the `??` operator contains user-controlled data.

**Impact of exploitation:**
- Allows for potential XSS attacks.

**Attack vectors:**
- An attacker can inject malicious code into the left-hand side of the `??` operator, which will then be rendered without proper escaping.

**Required attacker capabilities/position:**
- The attacker needs to be able to control the data that is used in the left-hand side of the `??` operator within a Twig template.

**Mitigation or fix:**
- Upgrade to Twig version 3.19.0 or later, which includes the fix for this vulnerability.
- The commit `38576b1` addresses the issue.

**Additional details:**
- CVSS score: 4.3/10
- Attack Vector: Network
- Attack Complexity: Low
- Privileges Required: None
- User Interaction: Required
- CWE: CWE-74
- Affected versions: >=3.16.0,<3.19.0
- Patched versions: 3.19.0
- The content provides more detail than the official CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.242 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.241 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.224 |
| 4 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.218 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.213 |
| 6 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.210 |
| 7 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.203 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.199 |
| 9 | 597 | Use of Wrong Operator in String Comparison | Variant | Allowed | dense | 0.455 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |

