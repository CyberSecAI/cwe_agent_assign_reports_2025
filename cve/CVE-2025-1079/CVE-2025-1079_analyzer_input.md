# Vulnerability Information: CVE-2025-1079

## Vulnerability Description
Client RCE on macOS and Linux via **improper symbolic link resolution** in Google Web Designers preview feature

### Vulnerability Description Key Phrases
- **rootcause:** **improper symbolic link resolution**
- **impact:** RCE
- **product:** Google Web Designers
- **component:** preview feature

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1079 Content

Here's an analysis of the provided content, focusing on details relevant to CVE-2025-1079, as described in the initial prompt. The content is highly relevant and provides significantly more detail than a typical CVE description.

**Root cause of vulnerability:**

The vulnerability stems from improper symbolic link resolution before file access ("Link Following" - CWE-59). Specifically, Google Web Designer reuses an existing `gwd_preview_<parent directory name>` directory if it exists, instead of creating a new one during the ad preview process. This allows an attacker to plant symbolic links within that pre-existing directory, which the application indiscriminately follows when copying files.

**Weaknesses/vulnerabilities present:**

*   **Improper Symbolic Link Handling:** The core weakness is the failure to properly sanitize or validate symbolic links before following them during file copy operations.
*   **Predictable Directory Naming:** The use of a predictable naming scheme for the preview directory (`gwd_preview_<parent directory name>`) allows attackers to pre-create the directory and populate it with malicious links.
*   **Lack of Directory Creation:** The application doesn't create missing target directories when following symlinks, limiting exploitation options but not preventing it.

**Impact of exploitation:**

Successful exploitation allows an attacker to achieve client-side remote code execution (RCE) on the victim's computer. This could lead to:

*   Account takeovers
*   PII theft
*   Malware installation (infostealers, ransomware, etc.)
*   Potential for privilege escalation.

**Attack vectors:**

1.  **Malicious Ad Package:** The attacker crafts a malicious ad source package (ZIP file) containing:
    *   Payload files (e.g., macOS launch agent, Linux URL handler configuration).
    *   A `gwd_preview_<parent directory name>` directory populated with symbolic links pointing to the payload files.
2.  **Social Engineering:** The attacker tricks the victim into downloading and extracting the malicious ZIP package.
3.  **Application Interaction:** The victim opens the extracted ad in Google Web Designer and clicks the "Preview" button.
4.  **Exploitation:** Google Web Designer copies files into the attacker-controlled `gwd_preview_<parent directory name>` directory, following the symbolic links and overwriting or creating files on the victim's system, ultimately executing the payload.

**Required attacker capabilities/position:**

*   Ability to create a malicious ad package with crafted symbolic links.
*   Ability to distribute the malicious package to victims (e.g., through malvertising).
*   Understanding of the target operating system's file system structure and symbolic link behavior.
*   Social engineering skills to convince victims to download and open the malicious ad.

**Mitigation or fix:**

The vulnerability was fixed in Google Web Designer version 16.2.0.0128 (released February 28, 2025). The fix likely involves:

*   Properly validating and sanitizing symbolic links before following them.
*   Creating a new, unique preview directory each time the preview feature is used, instead of reusing an existing one.

**Additional Notes:**

*   The vulnerability primarily affects macOS and Linux. Exploitation on Windows is unlikely due to default Windows security policies restricting symbolic link creation.
*   The article details a proof-of-concept (PoC) demonstrating the vulnerability, including specific payload examples for macOS and Linux.
*   The author received a $11,250 reward from Google's Vulnerability Reward Program for this finding.
*   The content provides a detailed timeline of the vulnerability disclosure and patching process.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.139 |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.133 |
| 3 | 64 | Windows Shortcut Following (.LNK) | Variant | Allowed | sparse | 0.129 |
| 4 | 62 | UNIX Hard Link | Variant | Allowed | sparse | 0.105 |
| 5 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | Allowed | sparse | 0.095 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.094 |
| 7 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | sparse | 0.087 |
| 8 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.086 |
| 9 | 65 | Windows Hard Link | Variant | Allowed | dense | 0.496 |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | Base | Allowed | graph | 0.002 |

