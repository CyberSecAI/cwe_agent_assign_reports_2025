## Vulnerability Description
The ElementsKit Elementor addons plugin for WordPress is vulnerable to Information Exposure in all versions up to, and including, 3.2.0 due to a **missing capability checks** on ekit_widgetarea_content function. This makes it possible for unauthenticated attackers to view any item created in Elementor, such as posts, pages and templates including drafts, pending and private items.

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability checks**
- **impact:** view any item created in Elementor
- **attacker:** unauthenticated attackers
- **product:** ElementsKit Elementor addons plugin for WordPress
- **version:** up to and including 3.2.0
- **component:** ekit_widgetarea_content function

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-6455:

**Root Cause of Vulnerability:**
The vulnerability stems from a missing capability check in the `ekit_widgetarea_content` function within the ElementsKit Elementor addons plugin. This allows unauthenticated users to trigger the function and access content that should be restricted.

**Weaknesses/Vulnerabilities Present:**
- **Insecure Direct Object Reference:** The lack of proper access control on the `ekit_widgetarea_content` function allows unauthorized access to content associated with specific post IDs.
- **Information Exposure:** The primary vulnerability is the exposure of sensitive information to unauthorized actors.

**Impact of Exploitation:**
- **Exposure of Sensitive Data:**  Unauthenticated attackers can view any item created using Elementor, including posts, pages, and templates, regardless of their status (drafts, pending, or private).
- **Potential for Further Attacks:**  Exposure of internal content can potentially be leveraged to gain insights into the website structure and logic, aiding in subsequent attacks.

**Attack Vectors:**
- **Unauthenticated Access:** The vulnerability can be exploited by any user, including those who are not logged in or registered to the WordPress site.
- **Direct Request:** The attacker can directly trigger the `ekit_widgetarea_content` function by making a specific AJAX request.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to have network access to the target WordPress website.
- **No Prior Knowledge/Privileges:** No authentication or prior access to the WordPress site is needed to exploit the vulnerability. The attacker does not need any special privileges to trigger the vulnerable function.

**Additional Details:**
- The vulnerability affects all versions of the ElementsKit Elementor addons plugin up to and including version 3.2.0.
- The vulnerable function `ekit_widgetarea_content` is located in `modules/controls/widget-area-utils.php`
- The issue is resolved in version 3.2.1 of the plugin.
- Wordfence has detected attacks targeting this vulnerability.
- The function `ekit_widgetarea_content` retrieves content based on the `post_id` parameter passed in the request.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.404 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.375 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.372 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.337 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.321 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.318 |
| 7 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.317 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.316 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.491 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-862: Missing Authorization

CWE-863: Incorrect Authorization

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-285: Improper Authorization

CWE-306: Missing Authentication for Critical Function

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-284: Improper Access Control

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-471: Modification of Assumed-Immutable Data (MAID)