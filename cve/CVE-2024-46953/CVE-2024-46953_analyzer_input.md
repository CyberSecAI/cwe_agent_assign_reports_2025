# Vulnerability Information: CVE-2024-46953

# Vulnerability Description

    An issue was discovered in base/gsdevice.c in Artifex Ghostscript before 10.04.0. An **integer overflow** when parsing the filename format string (for the output filename) results in **path truncation**, and possible **path traversal** and code execution.

    # Keyphrase-Specific CWE Analysis
    This vulnerability contains multiple keyphrases that may map to different CWEs. 
    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.

    ## WEAKNESS: 'integer overflow'

Relevant CWEs for this WEAKNESS:

### 1. CWE-190: Integer Overflow or Wraparound (Score: 262.23)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 2. CWE-681: Incorrect Conversion between Numeric Types (Score: 249.84)

When converting from one data type to another, such as long to integer, data can be omitted or translated in a way that produces unexpected values. If the resulting values are used in a sensitive context, then dangerous behaviors may occur....

### 3. CWE-197: Numeric Truncation Error (Score: 248.53)

Truncation errors occur when a primitive is cast to a primitive of a smaller size and data is lost in the conversion....

### 4. CWE-122: Heap-based Buffer Overflow (Score: 238.55)

A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....

### 5. CWE-191: Integer Underflow (Wrap or Wraparound) (Score: 238.22)

The product subtracts one value from another, such that the result is less than the minimum allowable integer value, which produces a value that is not equal to the correct result....

## PRODUCT: 'Artifex Ghostscript'

Relevant CWEs for this PRODUCT:

### 1. CWE-190: Integer Overflow or Wraparound (Score: 262.23)

The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to st...

### 2. CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') (Score: 251.33)

The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location th...

### 3. CWE-122: Heap-based Buffer Overflow (Score: 238.55)

A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....

### 4. CWE-125: Out-of-bounds Read (Score: 69.65)

The product reads data past the end, or before the beginning, of the intended buffer....

### 5. CWE-787: Out-of-bounds Write (Score: 68.55)

The product writes data past the end, or before the beginning, of the intended buffer....

## WEAKNESS: 'path traversal'

Relevant CWEs for this WEAKNESS:

### 1. CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') (Score: 251.33)

The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location th...

### 2. CWE-36: Absolute Path Traversal (Score: 241.99)

The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize absolute path sequences such as "/abs/path" that can resolve to a location that is outside of that directory....

### 3. CWE-23: Relative Path Traversal (Score: 232.76)

The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as ".." that can resolve to a location that is outside of that directory....

### 4. CWE-41: Improper Resolution of Path Equivalence (Score: 232.51)

The product is vulnerable to file system contents disclosure through path equivalence. Path equivalence involves the use of special characters in file and directory names. The associated manipulations are intended to generate multiple names for the same object....

### 5. CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') (Score: 224.42)

The PHP application receives input from an upstream component, but it does not restrict or incorrectly restricts the input before its usage in "require," "include," or similar functions....

## WEAKNESS: 'path truncation'

Relevant CWEs for this WEAKNESS:

### 1. CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') (Score: 251.33)

The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location th...

### 2. CWE-681: Incorrect Conversion between Numeric Types (Score: 249.84)

When converting from one data type to another, such as long to integer, data can be omitted or translated in a way that produces unexpected values. If the resulting values are used in a sensitive context, then dangerous behaviors may occur....

### 3. CWE-197: Numeric Truncation Error (Score: 248.53)

Truncation errors occur when a primitive is cast to a primitive of a smaller size and data is lost in the conversion....

### 4. CWE-36: Absolute Path Traversal (Score: 241.99)

The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize absolute path sequences such as "/abs/path" that can resolve to a location that is outside of that directory....

### 5. CWE-451: User Interface (UI) Misrepresentation of Critical Information (Score: 225.38)

The user interface (UI) does not properly represent critical information to the user, allowing the information - or its source - to be obscured or spoofed. This is often a component in phishing attacks....

## IMPACT: 'path traversal and code execution'

Relevant CWEs for this IMPACT:

### 1. CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') (Score: 251.33)

The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location th...

### 2. CWE-36: Absolute Path Traversal (Score: 241.99)

The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize absolute path sequences such as "/abs/path" that can resolve to a location that is outside of that directory....

### 3. CWE-23: Relative Path Traversal (Score: 232.76)

The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as ".." that can resolve to a location that is outside of that directory....

### 4. CWE-41: Improper Resolution of Path Equivalence (Score: 232.51)

The product is vulnerable to file system contents disclosure through path equivalence. Path equivalence involves the use of special characters in file and directory names. The associated manipulations are intended to generate multiple names for the same object....

### 5. CWE-59: Improper Link Resolution Before File Access ('Link Following') (Score: 88.57)

The product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource....

## VERSION: 'before 10.04.0'

Relevant CWEs for this VERSION:

### 1. CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') (Score: 251.33)

The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location th...

### 2. CWE-36: Absolute Path Traversal (Score: 241.99)

The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize absolute path sequences such as "/abs/path" that can resolve to a location that is outside of that directory....

### 3. CWE-122: Heap-based Buffer Overflow (Score: 238.55)

A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....

### 4. CWE-20: Improper Input Validation (Score: 76.96)

The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly....

### 5. CWE-125: Out-of-bounds Read (Score: 69.65)

The product reads data past the end, or before the beginning, of the intended buffer....

## COMPONENT: 'base/gsdevice.c'

Relevant CWEs for this COMPONENT:

### 1. CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') (Score: 251.33)

The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location th...

### 2. CWE-197: Numeric Truncation Error (Score: 248.53)

Truncation errors occur when a primitive is cast to a primitive of a smaller size and data is lost in the conversion....

### 3. CWE-122: Heap-based Buffer Overflow (Score: 238.55)

A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....

### 4. CWE-170: Improper Null Termination (Score: 76.13)

The product does not terminate or incorrectly terminates a string or array with a null character or equivalent terminator....

### 5. CWE-125: Out-of-bounds Read (Score: 69.65)

The product reads data past the end, or before the beginning, of the intended buffer....


    # Analysis Instructions
    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.
    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.
    3. Provide a final determination of primary CWE(s) and any secondary CWEs.
    4. Format your response using the standard analysis template.

    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.
    