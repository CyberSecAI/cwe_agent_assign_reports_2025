## Vulnerability Description
A vulnerability has been found in HDF5 up to 1.14.6 and classified as problematic. This vulnerability affects the function H5MM_realloc of the file src/H5MM.c. The manipulation of the argument mem leads to **double free**. The attack needs to be approached locally. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **double free**
- **vector:** manipulation of mem argument
- **product:** HDF5
- **version:** up to 1.14.6
- **component:** H5MM_realloc function in src/H5MM.c

## CVE Reference Links Content Summary
## Analysis of CVE-2025-2925 Content

Based on the provided content, this relates to a double-free vulnerability in the HDF5 library.

**Root cause of vulnerability:**

The root cause is that `H5MM_realloc` does not set the memory pointer to NULL after freeing the memory when `size` is 0.  Subsequently, `H5MM_xfree` is called on the same pointer, leading to a double-free.  `H5MM_xfree` also does not set the pointer to NULL after freeing.

**Weaknesses/vulnerabilities present:**

*   **CWE-415: Double Free:** The core vulnerability is a double-free condition.
*   Improper memory management: Failing to nullify pointers after freeing memory.

**Impact of exploitation:**

*   Application crash: The double-free leads to a segmentation fault, causing the application to crash.

**Attack vectors:**

*   Processing specially crafted HDF5 files: The vulnerability is triggered when processing certain files. A proof-of-concept (PoC) file (`H5MM_xfree-df.zip`) is provided.
*   Fuzzing: The vulnerability was discovered through fuzzing.

**Required attacker capabilities/position:**

*   Ability to provide a malicious HDF5 file to the application.
*   No specific privileges are required beyond the ability to run the application and process the file.

**Mitigation or fix:**

The issue description implies the fix involves setting the memory pointer to NULL after freeing it in both `H5MM_realloc` and `H5MM_xfree`.

**Additional Details (more than official CVE description):**

*   Specific code locations are identified: `src/H5MM.c` lines 201 and 87.
*   Detailed ASan report is provided, pinpointing the exact location of the double-free and the allocation/free sequence.
*   Build instructions for reproducing the issue with AddressSanitizer are provided.
*   The issue is labeled as a "Blocker" for the Release 2.0.0 milestone, indicating its severity.
*   The vulnerability was discovered through fuzzing using the `h5_extended_fuzzer.c` harness.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.369 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.361 |
| 3 | 415 | Double Free | Variant | Allowed | sparse | 0.352 |
| 4 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.344 |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.333 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.323 |
| 7 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.321 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.319 |
| 9 | 122 | Heap-based Buffer Overflow | Variant | Allowed | dense | 0.535 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-415: Double Free

CWE-1241: Use of Predictable Algorithm in Random Number Generator

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-364: Signal Handler Race Condition

CWE-674: Uncontrolled Recursion

CWE-122: Heap-based Buffer Overflow

CWE-123: Write-what-where Condition