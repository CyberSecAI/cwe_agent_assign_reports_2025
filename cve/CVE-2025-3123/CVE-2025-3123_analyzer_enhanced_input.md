## Vulnerability Description
A vulnerability, which was classified as critical, has been found in WonderCMS 3.5.0. Affected by this issue is the function installUpdateModuleAction of the component Theme Installation/Plugin Installation. The manipulation leads to unrestricted upload. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The real existence of this vulnerability is still doubted at the moment. The vendor explains, that [t]he philosophy has always been, admin [...] bear responsibility to not install themes/plugins from untrusted sources.

### Vulnerability Description Key Phrases
- **impact:** unrestricted upload
- **product:** WonderCMS
- **version:** 3.5.0
- **component:** installUpdateModuleAction of the component Theme Installation/Plugin Installation

## CVE Reference Links Content Summary
**CVE: CVE-2025-3123**

**RELATION TO CVE:** RELATED

**Vulnerability Overview:**

A remote code execution (RCE) vulnerability exists in WonderCMS version 3.5.0, located in the theme and plugin installation/update functionality. Attackers can execute arbitrary code on the target server by providing a malicious ZIP file.

**Vulnerability Details:**

*   **Root cause:** The `installUpdateModuleAction()` function downloads a ZIP file from a user-provided URL and extracts it to the server directory without adequate validation of the contents of the ZIP file.
*   **Weaknesses/vulnerabilities present:** Lack of input validation on ZIP file contents during theme/plugin installation/update.
*   **Impact of exploitation:** Remote code execution on the target server.
*   **Attack vectors:** Providing a malicious ZIP file containing a PHP web shell through the theme/plugin installation process.
*   **Required attacker capabilities/position:** An attacker needs to be able to provide a URL to a malicious ZIP file and have administrator privileges to install themes/plugins in WonderCMS.
*   **Mitigation or fix:**
    *   Implement strict file type validation.
    *   Perform security scans on the contents of ZIP files.
    *   Restrict the types and permissions of files extracted.
    *   Use secure temporary directories for extraction, validating before moving to the final location.
    *   Implement Content Security Policy (CSP) to limit execution.

**Exploitation Steps (as described in the content):**

1.  Prepare a malicious ZIP file (`malicious_theme.zip`) containing a PHP web shell (`theme.php`) and a module configuration file (`wcms-modules.json`).
2.  Deploy the ZIP file to a publicly accessible URL (e.g., `http://attacker.com/malicious_theme.zip`).
3.  Create and host a malicious module configuration file (`wcms-modules.json`) at a publicly accessible URL (e.g., `http://attacker.com/wcms-modules.json`).
4.  Log in to WonderCMS as an administrator.
5.  Navigate to Settings -> Themes and add a custom theme using the URL of the malicious module configuration file.
6.  Install the "Malicious Theme" from the theme list.
7.  Access the web shell at `/themes/malicious_theme/theme.php` to execute commands (e.g., `http://target.com/themes/malicious_theme/theme.php?cmd=id`).

**Impact Scope:**

*   WonderCMS 3.5.0 and possibly earlier versions.
*   All instances of WonderCMS using the default installation.

**Note:** The provided content offers significantly more detail than a typical CVE description, including a complete exploitation guide.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.177 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.175 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.163 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.162 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.155 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.153 |
| 7 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.152 |
| 8 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.152 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.604 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-306: Missing Authentication for Critical Function

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-285: Improper Authorization

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-1391: Use of Weak Credentials

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-425: Direct Request ('Forced Browsing')