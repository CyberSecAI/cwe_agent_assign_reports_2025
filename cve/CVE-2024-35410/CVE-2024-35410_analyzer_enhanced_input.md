## Vulnerability Description
wac commit 385e1 was discovered to contain a **heap overflow** via the interpret function at /wac-asan/wa.c. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted wasm file.

### Vulnerability Description Key Phrases
- **weakness:** **heap overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted wasm file
- **attacker:** attackers
- **product:** wac
- **version:** commit 385e1
- **component:** interpret function at /wac-asan/wa.c

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-35410.

**Root cause of vulnerability:**
The root cause is a heap overflow in the `interpret` function of the `wac` project, specifically within the `wa.c` file. This occurs when processing a crafted WebAssembly (wasm) file.

**Weaknesses/vulnerabilities present:**
Multiple heap buffer overflow vulnerabilities exist in the `interpret` function at different locations in the code (lines 993, 860, 1380, 706, 925, 832, 1168 and 947 of wa.c). These are triggered when parsing specifically crafted wasm files.

**Impact of exploitation:**
Successful exploitation of these vulnerabilities can lead to a denial of service (DoS). The vulnerability can also lead to code execution, though that's not explicitly detailed.

**Attack vectors:**
The attack vector is a crafted wasm file. The vulnerability is triggered when the `wace` executable is used to process the malicious wasm file.

**Required attacker capabilities/position:**
The attacker needs to be able to provide a crafted wasm file to the vulnerable `wac` application for processing. This implies a remote attack vector. The attacker does not need to be authenticated.

**Additional details:**
- The vulnerable code is found in the `wac` project, specifically commit `385e13ca840100f70d05781f45209da82fb6c45c`.
- The vulnerability is located in the `interpret` function of `wa.c`.
- The issue was discovered by Ziyi Guo, and reported by haruki3hhh on GitHub.
- The ASAN reports provide specific locations and details of the overflows, including the addresses, read/write sizes, and call stacks.
- PoC files to trigger the vulnerability are also provided through links.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 2 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.244 |
| 3 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.216 |
| 4 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.213 |
| 5 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.212 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.203 |
| 7 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.201 |
| 8 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.197 |
| 9 | 194 | Unexpected Sign Extension | Variant | Allowed | dense | 0.604 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-190: Integer Overflow or Wraparound

CWE-122: Heap-based Buffer Overflow

CWE-125: Out-of-bounds Read

CWE-674: Uncontrolled Recursion

CWE-193: Off-by-one Error

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-126: Buffer Over-read

CWE-476: NULL Pointer Dereference

CWE-194: Unexpected Sign Extension

CWE-128: Wrap-around Error