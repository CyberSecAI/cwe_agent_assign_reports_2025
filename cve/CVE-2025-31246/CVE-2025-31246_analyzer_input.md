# Vulnerability Information: CVE-2025-31246

## Vulnerability Description
The issue was addressed with improved memory handling. This issue is fixed in macOS Sequoia 15.5, macOS Sonoma 14.7.6. Connecting to a malicious AFP server may corrupt kernel memory.

### Vulnerability Description Key Phrases
- **vector:** Connecting to a malicious AFP server
- **product:** macOS Sequoia, macOS Sonoma
- **impact:** corrupt kernel memory
- **version:** 15.5, 14.7.6

## CVE Reference Links Content Summary
## CVE-2025-31246 Analysis

The provided content **relates** to CVE-2025-31246. Here's the extracted information:

**Root cause of vulnerability:** Not explicitly stated, but related to memory handling within `afpfs`.

**Weaknesses/vulnerabilities present:** Corruption of kernel memory when connecting to a malicious AFP server.

**Impact of exploitation:** Kernel memory corruption.

**Attack vectors:** Connecting to a malicious AFP server.

**Required attacker capabilities/position:** Ability to control or create a malicious AFP server.

**Mitigation or fix:** Improved memory handling.

**Additional Details (more than official CVE description):**

*   The vulnerability is present in both macOS Sequoia 15.5 and macOS Sonoma 14.7.6.
*   The vulnerability was reported by Joseph Ravichandran (@0xjprx) of MIT CSAIL.
*   A related vulnerability (CVE-2025-31240 and CVE-2025-31237) exists in `afpfs` where mounting a maliciously crafted AFP network share can lead to system termination.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.080 |
| 2 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | sparse | 0.072 |
| 3 | 665 | Improper Initialization | Class | Discouraged | sparse | 0.071 |
| 4 | 415 | Double Free | Variant | Allowed | sparse | 0.070 |
| 5 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.063 |
| 6 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.063 |
| 7 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.060 |
| 8 | 1263 | Improper Physical Access Control | Class | Allowed-with-Review | sparse | 0.059 |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | dense | 0.496 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.003 |

