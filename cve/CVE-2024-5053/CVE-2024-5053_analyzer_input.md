# Vulnerability Information: CVE-2024-5053

## Vulnerability Description
The Contact Form Plugin by Fluent Forms for Quiz, Survey, and Drag & Drop WP Form Builder plugin for WordPress is vulnerable to unauthorized Malichimp API key update due to an **insufficient capability check** on the verifyRequest function in all versions up to, and including, 5.1.18. This makes it possible for Form Managers with a Subscriber-level access and above to modify the Mailchimp API key used for integration. At the same time, missing Mailchimp API key validation allows the redirect of the integration requests to the attacker-controlled server.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient capability check**
- **impact:** unauthorized Malichimp API key update
- **attacker:** Form Managers with Subscriber-level access and above
- **product:** Contact Form Plugin by Fluent Forms for Quiz, Survey, and Drag & Drop WP Form Builder
- **version:** up to and including 5.1.18
- **component:** verifyRequest function

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from a missing authorization check in the `verifyRequest` function of the Contact Form Plugin by Fluent Forms. This function is responsible for verifying if a user has the necessary permissions to perform certain actions, specifically modifying the Mailchimp API key used for integration.

**Weaknesses/Vulnerabilities Present:**
*   **Insufficient Capability Check:** The `verifyRequest` function in `FormPolicy.php` lacks a proper capability check, allowing users with Subscriber-level access (or higher) to modify the Mailchimp API key.
*   **Missing API Key Validation:** There is a lack of validation for the Mailchimp API key, allowing the integration requests to be redirected to an attacker-controlled server.

**Impact of Exploitation:**
*   An attacker with subscriber level or higher access can modify the Mailchimp API key.
*   The attacker can redirect integration requests to a server they control.
*  This could lead to a variety of attacks, including data theft, phishing, and spam campaigns.

**Attack Vectors:**
*   The attacker must be an authenticated user with at least subscriber level access.
*   The attacker exploits the missing authorization check in the `verifyRequest` function.
*   The attacker then can modify the Mailchimp API key and potentially redirect API calls to their own server.

**Required Attacker Capabilities/Position:**
*   The attacker needs to have a WordPress user account with "Subscriber" level access or higher.
*   The attacker needs to be able to access the WordPress admin panel.

**Additional Notes:**

* The vulnerability exists in all versions of the plugin up to and including 5.1.18.
* The vulnerability is patched in version 5.1.19 and later.
* The Wordfence article provides more detail than the original CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.586 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.583 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.573 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.533 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.533 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.527 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.512 |
| 8 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.503 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.437 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

