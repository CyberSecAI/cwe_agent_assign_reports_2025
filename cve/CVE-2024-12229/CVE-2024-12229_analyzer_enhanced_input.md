## Vulnerability Description
A vulnerability classified as critical was found in PHPGurukul Complaint Management System 1.0. Affected by this vulnerability is an unknown functionality of the file /admin/complaint-search.php. The manipulation of the argument search leads to **sql injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **vector:** manipulation of search argument
- **product:** PHPGurukul Complaint Management System
- **version:** 1
- **component:** /admin/complaint-search.php

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the identified SQL injection vulnerability:

**Root Cause:**

*   The vulnerability stems from the lack of proper sanitization or validation of user-supplied input within the `/admin/complaint-search.php` file. Specifically, the `search` parameter is directly incorporated into SQL queries without any form of escaping or parameterization, enabling SQL injection.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The primary vulnerability is SQL injection, where an attacker can inject malicious SQL code through the `search` parameter.

**Impact of Exploitation:**

*   **Unauthorized Database Access:** Attackers can gain access to the database without proper authorization.
*   **Sensitive Data Leakage:** Sensitive information stored in the database could be exposed.
*   **Data Tampering:** Attackers could modify or delete data within the database.
*   **Comprehensive System Control:** Depending on the database user's permissions, attackers could potentially gain full control over the system.
*   **Service Interruption:** Attackers can potentially disrupt the service by manipulating database operations.

**Attack Vectors:**

*   The attack vector is through the `search` parameter in a POST request to `/admin/complaint-search.php`.

**Required Attacker Capabilities/Position:**

*   The attacker doesn't need any login or authorization to exploit this vulnerability, making it highly accessible. They only need to be able to send HTTP POST requests to the vulnerable endpoint with crafted `search` parameter.
*   The attacker needs knowledge of SQL to craft the malicious payloads.

**Additional Details from the Content:**

*   **Affected Product:** Complaint Management system V1.0
*   **Vulnerable File:** `/admin/complaint-search.php`
*   **Vulnerable Parameter:** `search` (POST parameter)
*  The content provides specific sqlmap payloads and examples for exploitation demonstrating different types of SQL injection: boolean-based blind, error-based, time-based blind, and UNION query.
*   The content also suggests mitigation strategies:
    *   Use prepared statements and parameter binding.
    *   Implement strict input validation and filtering.
    *   Minimize database user permissions.
    *   Regularly conduct security audits.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.421 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.361 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.338 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.326 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.325 |
| 7 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.321 |
| 8 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.316 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.594 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-117: Improper Output Neutralization for Logs

CWE-705: Incorrect Control Flow Scoping

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-73: External Control of File Name or Path