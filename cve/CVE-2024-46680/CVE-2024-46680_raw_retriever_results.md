# Raw Retriever Results for CVE-2024-46680

# Raw Retriever Results for CVE-2024-46680
## Query
In the Linux kernel, the following vulnerability has been resolvedBluetooth btnxpuart Fix random crash seen while removing driverThis fixes the random kernel crash seen while removing the driver, whenrunning the load/unload test over multiple iterations.1) modprobe btnxpuart2) hciconfig hci0 reset3) hciconfig (check hci0 interface up with valid BD address)4) modprobe -r btnxpuartRepeat steps 1 to 4The ps_wakeup() call in btnxpuart_close() schedules the psdata->work(),which gets scheduled after module is removed, causing a kernel crash.This hidden issue got highlighted after enabling Power Save by defaultin 4183a7be7700 (Bluetooth btnxpuart Enable Power Save feature onstartup)The new ps_cleanup() deasserts UART break immediately while closingserdev device, cancels any scheduled ps_work and destroys the ps_lockmutex.[ 85.884604] Unable to handle kernel paging request at virtual address ffffd4a61638f258[ 85.884624] Mem abort info[ 85.884625] ESR = 0x0000000086000007[ 85.884628] EC = 0x21 IABT (current EL), IL = 32 bits[ 85.884633] SET = 0, FnV = 0[ 85.884636] EA = 0, S1PTW = 0[ 85.884638] FSC = 0x07 level 3 translation fault[ 85.884642] swapper pgtable 4k pages, 48-bit VAs, pgdp=0000000041dd0000[ 85.884646] [ffffd4a61638f258] pgd=1000000095fff003, p4d=1000000095fff003, pud=100000004823d003, pmd=100000004823e003, pte=0000000000000000[ 85.884662] Internal error Oops 0000000086000007

## Keyphrases
- **rootcause**: 'ps_wakeup() call in btnxpuart_close() schedules psdata->work() after module is removed'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4899 | 0.5505 | 0.5153 | 0.5134 | 20 |
| Sparse | 145.2349 | 534.1474 | 474.2004 | 510.9470 | 11 |
| Graph | 1.6100 | 2.4232 | 1.9880 | 2.0795 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 123 | Write-what-where Condition | base | 2.4232 | Allowed |
| 2 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 3 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 4 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 5 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 6 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 7 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 8 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 9 | 134 | Use of Externally-Controlled Format String | base | 2.1902 | Allowed |
| 10 | 288 | Authentication Bypass Using an Alternate Path or Channel | base | 2.1190 | Allowed |
| 11 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 2.0400 | Allowed |
| 12 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 13 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 14 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 15 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5505 | 0.5505 | Allowed-with-Review |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5400 | 0.5400 | Allowed |
| 3 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5345 | 0.5345 | Allowed |
| 4 | 909 | Missing Initialization of Resource | Class | 0.5292 | 0.5292 | Allowed-with-Review |
| 5 | 126 | Buffer Over-read | Variant | 0.5258 | 0.5258 | Allowed |
| 6 | 667 | Improper Locking | Class | 0.5222 | 0.5222 | Allowed-with-Review |
| 7 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5204 | 0.5204 | Discouraged |
| 8 | 416 | Use After Free | Variant | 0.5168 | 0.5168 | Allowed |
| 9 | 787 | Out-of-bounds Write | Base | 0.5153 | 0.5153 | Allowed |
| 10 | 122 | Heap-based Buffer Overflow | Variant | 0.5140 | 0.5140 | Allowed |
| 11 | 121 | Stack-based Buffer Overflow | Variant | 0.5128 | 0.5128 | Allowed |
| 12 | 190 | Integer Overflow or Wraparound | Base | 0.5118 | 0.5118 | Allowed |
| 13 | 908 | Use of Uninitialized Resource | Base | 0.5102 | 0.5102 | Allowed |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5064 | 0.5064 | Allowed |
| 15 | 833 | Deadlock | Base | 0.5056 | 0.5056 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 288 | Authentication Bypass Using an Alternate Path or Channel | 534.1474 | 534.1474 | Allowed |
| 2 | 668 | Exposure of Resource to Wrong Sphere | 530.9090 | 530.9090 | Discouraged |
| 3 | 787 | Out-of-bounds Write | 529.5548 | 529.5548 | Allowed |
| 4 | 401 | Missing Release of Memory after Effective Lifetime | 516.0360 | 516.0360 | Allowed |
| 5 | 667 | Improper Locking | 513.7217 | 513.7217 | Allowed-with-Review |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 510.9470 | 510.9470 | Allowed-with-Review |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | 508.8995 | 508.8995 | Allowed |
| 8 | 330 | Use of Insufficiently Random Values | 483.5480 | 483.5480 | Discouraged |
| 9 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 472.2121 | 472.2121 | Allowed |
| 10 | 20 | Improper Input Validation | 470.9937 | 470.9937 | Discouraged |
| 11 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | 145.2349 | 145.2349 | Allowed |
