## Vulnerability Description
Directus is a real-time API and App dashboard for managing SQL database content. Starting in version 9.12.0 and prior to version 11.5.0, when a Flow with the Webhook trigger and the Data of Last Operation response body encounters a ValidationError thrown by a failed condition operation, the API response includes sensitive data. This includes environmental variables, sensitive API keys, user accountability information, and operational data. This issue poses a significant security risk, as any unintended exposure of this data could lead to potential misuse. Version 11.5.0 fixes the issue.

### Vulnerability Description Key Phrases
- **impact:** exposure of sensitive data
- **product:** Directus
- **version:** 9.12.0 to 11.5.0
- **component:** Flow with the Webhook trigger

## CVE Reference Links Content Summary
## Analysis of CVE-2025-30353 Content

This content is **RELEVANT** to CVE-2025-30353 and provides more detail than the placeholder description.

**Root cause of vulnerability:**

A Flow in Directus, configured with a Webhook trigger and "Data of Last Operation" response body, exposes sensitive data when a ValidationError is thrown by a failed condition operation.

**Weaknesses/vulnerabilities present:**

* **CWE-200:** Information Exposure - Sensitive data (environmental variables, API keys, user accountability information, operational data) is unintentionally disclosed in API responses.

**Impact of exploitation:**

Exposure of sensitive data could lead to potential misuse, including unauthorized access to systems, data breaches, and compromise of user accounts. Specifically, the exposed data includes:
* Environmental variables (`$env`)
* Authorization headers
* User details under `$accountability` (role, user, etc.)
* Operational logs (`current_payments`, `$last`)

**Attack vectors:**

* Triggering a Directus Flow with a Webhook trigger and "Data of Last Operation" response body.
* Creating a condition within the Flow that is designed to fail.
* Sending input data that causes the condition to fail, resulting in a ValidationError.
* The vulnerability is exploitable over the network (CVSS v3 base metrics: AV:N).

**Required attacker capabilities/position:**

* No privileges are required (CVSS v3 base metrics: PR:N).
* No user interaction is required (CVSS v3 base metrics: UI:N).
* An attacker can be remote (CVSS v3 base metrics: AV:N).

**Mitigation or fix:**

The advisory states that the vulnerability is patched in version 11.5.0. The fix involves ensuring that API responses in the event of a ValidationError do not include sensitive information, only relevant error messages and details.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.167 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.160 |
| 3 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.157 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.152 |
| 5 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.152 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.149 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.148 |
| 8 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.148 |
| 9 | 540 | Inclusion of Sensitive Information in Source Code | Base | Allowed | dense | 0.390 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-532: Insertion of Sensitive Information into Log File

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-1390: Weak Authentication

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-863: Incorrect Authorization

CWE-306: Missing Authentication for Critical Function

CWE-918: Server-Side Request Forgery (SSRF)

CWE-540: Inclusion of Sensitive Information in Source Code

CWE-184: Incomplete List of Disallowed Inputs