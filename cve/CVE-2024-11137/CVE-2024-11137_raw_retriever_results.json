{
  "query": "An Insecure Direct Object Reference (IDOR) vulnerability exists in the `PATCH /v1/runs/id/score` endpoint of lunary-ai/lunary version 1.6.0. This vulnerability allows an attacker to update the score data of any run by manipulating the id parameter in the request URL, which corresponds to the `runId_score` in the database. The endpoint does not sufficiently validate whether the authenticated user has permission to modify the specified runId, enabling an attacker with a valid account to modify other users runId scores by specifying different id values. This issue was fixed in version 1.6.1.",
  "keyphrases": {
    "rootcause": [
      "insecure direct object reference"
    ]
  },
  "timestamp": "2025-07-13T01:02:21.022125",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "base",
        "score": 2.3295999999999997,
        "description": "CWE-306: Missing Authentication for Critical Function...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 1.6904321043035333,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "abstraction": "Base",
        "score": 1.6029796899513846,
        "description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected d...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 1.6026342714412583,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "73",
        "name": "External Control of File Name or Path",
        "abstraction": "base",
        "score": 1.521,
        "description": "CWE-73: External Control of File Name or Path...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "90",
        "name": "Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')",
        "abstraction": "Base",
        "score": 1.4791171711621027,
        "description": "The product constructs all or part of an LDAP query using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modi...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "862",
        "name": "Missing Authorization",
        "abstraction": "class",
        "score": 1.3648,
        "description": "CWE-862: Missing Authorization...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "322",
        "name": "Key Exchange without Entity Authentication",
        "abstraction": "base",
        "score": 1.3572000000000002,
        "description": "CWE-322: Key Exchange without Entity Authentication...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "425",
        "name": "Direct Request ('Forced Browsing')",
        "abstraction": "base",
        "score": 1.3572000000000002,
        "description": "CWE-425: Direct Request ('Forced Browsing')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1299",
        "name": "Missing Protection Mechanism for Alternate Hardware Interface",
        "abstraction": "base",
        "score": 1.1793600000000002,
        "description": "CWE-1299: Missing Protection Mechanism for Alternate Hardware Interface...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 1.039858338562158,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "804",
        "name": "Guessable CAPTCHA",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-804: Guessable CAPTCHA...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "551",
        "name": "Incorrect Behavior Order: Authorization Before Parsing and Canonicalization",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-551: Incorrect Behavior Order: Authorization Before Parsing and Canonicalization...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1244",
        "name": "Internal Asset Exposed to Unsafe Debug Access Level or State",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1244: Internal Asset Exposed to Unsafe Debug Access Level or State...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "288",
        "name": "Authentication Bypass Using an Alternate Path or Channel",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-288: Authentication Bypass Using an Alternate Path or Channel...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "939",
        "name": "Improper Authorization in Handler for Custom URL Scheme",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-939: Improper Authorization in Handler for Custom URL Scheme...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1314",
        "name": "Missing Write Protection for Parametric Data Values",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1314: Missing Write Protection for Parametric Data Values...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "914",
        "name": "Improper Control of Dynamically-Identified Variables",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-914: Improper Control of Dynamically-Identified Variables...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "694",
        "name": "Use of Multiple Resources with Duplicate Identifier",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-694: Use of Multiple Resources with Duplicate Identifier...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "641",
        "name": "Improper Restriction of Names for Files and Other Resources",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-641: Improper Restriction of Names for Files and Other Resources...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 0.48306706052428317,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "abstraction": "Base",
        "score": 0.47730147480647994,
        "description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected d...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "90",
        "name": "Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')",
        "abstraction": "Base",
        "score": 0.4771073503230853,
        "description": "The product constructs all or part of an LDAP query using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modi...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 0.4723593810983049,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 0.4618218981420331,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "277",
        "name": "Insecure Inherited Permissions",
        "abstraction": "Variant",
        "score": 0.4593253127445883,
        "description": "A product defines a set of insecure permissions that are inherited by objects that are created by the program....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "214",
        "name": "Invocation of Process Using Visible Sensitive Information",
        "abstraction": "Base",
        "score": 0.4588240744265189,
        "description": "A process is invoked with sensitive command-line arguments, environment variables, or other elements that can be seen by other processes on the operating system....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "267",
        "name": "Privilege Defined With Unsafe Actions",
        "abstraction": "Base",
        "score": 0.4547883708782339,
        "description": "A particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "359",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
        "abstraction": "Base",
        "score": 0.45431143129031526,
        "description": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have t...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "943",
        "name": "Improper Neutralization of Special Elements in Data Query Logic",
        "abstraction": "Class",
        "score": 0.4541980318656292,
        "description": "The product generates a query intended to access or manipulate data in a data store such as a database, but it does not neutralize or incorrectly neutralizes special elements that can modify the inten...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "204",
        "name": "Observable Response Discrepancy",
        "abstraction": "Base",
        "score": 0.44241345192615034,
        "description": "The product provides different responses to incoming requests in a way that reveals internal state information to an unauthorized actor outside of the intended control sphere....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "abstraction": "Base",
        "score": 0.4420570112252246,
        "description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "922",
        "name": "Insecure Storage of Sensitive Information",
        "abstraction": "Class",
        "score": 0.43727387287238606,
        "description": "The product stores sensitive information without properly limiting read or write access by unauthorized actors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "abstraction": "Base",
        "score": 0.4369824889715893,
        "description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could mod...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "379",
        "name": "Creation of Temporary File in Directory with Insecure Permissions",
        "abstraction": "Base",
        "score": 0.43336546247889474,
        "description": "The product creates a temporary file in a directory whose permissions allow unintended actors to determine the file's existence or otherwise access that file....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "abstraction": "Base",
        "score": 0.4317923985567154,
        "description": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "abstraction": "Base",
        "score": 0.431707690696789,
        "description": "The web application does not sufficiently verify inputs that are assumed to be immutable but are actually externally controllable, such as hidden form fields....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1188",
        "name": "Initialization of a Resource with an Insecure Default",
        "abstraction": "Base",
        "score": 0.43055848203792424,
        "description": "The product initializes or sets a resource with a default that is intended to be changed by the administrator, but the default is not secure....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 0.4300465251546802,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "abstraction": "Base",
        "score": 0.42906925114280275,
        "description": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can ca...",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 1000.0,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "99",
        "name": "Improper Control of Resource Identifiers ('Resource Injection')",
        "abstraction": "Class",
        "score": 1000.0,
        "description": "The product receives input from an upstream component, but it does not restrict or incorrectly restricts the input before it is used as an identifier for a resource that may be outside the intended sp...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 545.9863371827377,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 541.9714518947665,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "862",
        "name": "Missing Authorization",
        "abstraction": "Class",
        "score": 538.3619798357897,
        "description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 526.5430080208705,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "668",
        "name": "Exposure of Resource to Wrong Sphere",
        "abstraction": "Class",
        "score": 523.6741884140744,
        "description": "The product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "abstraction": "Class",
        "score": 521.876972330502,
        "description": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "abstraction": "Class",
        "score": 520.7512162819453,
        "description": "The product uses a broken or risky cryptographic algorithm or protocol....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "abstraction": "Base",
        "score": 518.2000661798031,
        "description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "269",
        "name": "Improper Privilege Management",
        "abstraction": "Class",
        "score": 169.44933222176087,
        "description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor....",
        "mapping_usage": "Discouraged"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.42906925114280275,
      "max": 0.48306706052428317,
      "mean": 0.4499185510581314,
      "median": 0.4483057418958898,
      "count": 20
    },
    "sparse": {
      "min": 169.44933222176087,
      "max": 1000.0,
      "mean": 582.4376865783863,
      "median": 526.5430080208705,
      "count": 11
    },
    "graph": {
      "min": 1.0062,
      "max": 2.3295999999999997,
      "mean": 1.278999078771022,
      "median": 1.1096091692810792,
      "count": 20
    }
  }
}