# Vulnerability Information: CVE-2024-6168

## Vulnerability Description
The Just Custom Fields plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 3.3.2. This is due to **missing or incorrect nonce validation** on several AJAX function. This makes it possible for unauthenticated attackers to invoke this functionality intended for admin users via a forged request granted they can trick a site administrator into performing an action such as clicking on a link. This enables subscribers to manage field groups, change visibility of items among other things.

### Vulnerability Description Key Phrases
- **rootcause:** **missing or incorrect nonce validation**
- **weakness:** **cross-site request forgery**
- **impact:** manage field groups, change visibility of items
- **attacker:** unauthenticated attackers
- **product:** Just Custom Fields plugin for WordPress
- **version:** all versions up to and including 3.3.2
- **component:** several AJAX functions

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
- The vulnerability stems from missing or incorrect nonce validation on several AJAX functions within the Just Custom Fields WordPress plugin.

**Weaknesses/Vulnerabilities Present:**
- **Cross-Site Request Forgery (CSRF):** The primary vulnerability is CSRF, which allows an attacker to perform actions on behalf of a logged-in user without their knowledge or consent. This is due to the absence of proper nonce checks on AJAX calls.

**Impact of Exploitation:**
- An unauthenticated attacker can trick a site administrator into performing actions, such as clicking a malicious link.
- This enables attackers (even subscribers) to:
  - Manage field groups
  - Change the visibility of items
  - Potentially other admin-level actions

**Attack Vectors:**
- **Social Engineering:** The attacker must rely on social engineering to trick an administrator into performing an action, such as clicking on a malicious link, which would initiate the forged request.
- **Forged HTTP Requests:** The attacker crafts a malicious HTTP request that exploits the missing nonce validation to perform unauthorized actions through AJAX calls.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to craft malicious links or find other means to trick a logged-in administrator into triggering a forged request to the vulnerable website.
- The attacker does not need to be authenticated on the target site, but requires a logged-in administrator to execute the forged request.
- The attacker needs to know the structure of vulnerable AJAX actions that the plugin uses

**Additional Notes:**
- The plugin has been closed on WordPress.org due to the security issue.
- No patch is available. It's recommended to remove the plugin and find an alternative.
- The vulnerability affects all versions of the plugin up to and including 3.3.2.
- The Wordfence analysis provides more details than the official CVE description regarding the attack vector and impact.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 600 | Uncaught Exception in Servlet  | Variant | Allowed | alternate_terms | 0.700 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.675 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.545 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.534 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.517 |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.516 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.514 |
| 8 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.508 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.485 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

