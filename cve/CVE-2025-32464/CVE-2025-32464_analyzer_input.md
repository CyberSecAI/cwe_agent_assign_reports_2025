# Vulnerability Information: CVE-2025-32464

## Vulnerability Description
HAProxy 2.2 through 3.1.6, in certain uncommon configurations, has a sample_conv_regsub **heap-based buffer overflow** because of **mishandling of the replacement of multiple short patterns with a longer one**.

### Vulnerability Description Key Phrases
- **rootcause:** **mishandling of the replacement of multiple short patterns with a longer one**
- **weakness:** **heap-based buffer overflow**
- **product:** HAProxy
- **version:** 2.2 through 3.1.6
- **component:** sample_conv_regsub

## CVE Reference Links Content Summary
## Analysis of CVE-2025-32464 based on provided content:

The provided content contains information related to CVE-2025-32464. Specifically, the `lists.debian.org` content and the `github.com` commit message detail the vulnerability.

**Root cause of vulnerability:**

The vulnerability is a heap buffer overflow in the `sample_conv_regsub()` function of HAProxy. The issue arises because the length check for replacements during regular expression substitutions is performed on the replaced pattern instead of the temporary buffer used to carry the new string. This allows multiple replacements to potentially overflow the temporary buffer if replacements are larger than the remaining space.

**Weaknesses/vulnerabilities present:**

*   Heap buffer overflow
*   Incorrect length checking in `sample_conv_regsub()`

**Impact of exploitation:**

The vulnerability could lead to a heap buffer overflow, potentially allowing for denial of service or, in some scenarios, potentially code execution. The impact is considered medium because the replacement pattern is static and not user-controlled.

**Attack vectors:**

The attack vector involves crafting a configuration that replaces multiple short patterns with larger ones in a request. While unlikely, it's possible to trigger the overflow if the combined size of the replacements exceeds the temporary buffer's capacity.

**Required attacker capabilities/position:**

An attacker would need to be able to configure HAProxy with a malicious configuration.

**Mitigation or fix:**

The vulnerability has been fixed in HAProxy version 2.2.9-2+deb11u7 for Debian 11 bullseye. Upgrading to this version or later is recommended. The fix involves checking the length against the "trash" buffer instead of the "output" buffer.

**More detail than official CVE description:**

Yes, the provided content, particularly the commit message, provides significantly more detail than a typical CVE description. It explains the root cause, the specific function involved, the nature of the length check error, and the fix implemented. It also provides context regarding the bug's introduction and the contributors who identified and resolved it.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.238 |
| 4 | 681 | Incorrect Conversion between Numeric Types | Base | Allowed | sparse | 0.238 |
| 5 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.229 |
| 6 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.229 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.225 |
| 8 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.222 |
| 9 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | dense | 0.489 |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | graph | 0.003 |

