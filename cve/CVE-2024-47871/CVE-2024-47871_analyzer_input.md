# Vulnerability Information: CVE-2024-47871

## Vulnerability Description
Gradio is an open-source Python package designed for quick prototyping. This vulnerability involves ****insecure communication**** between the FRP (Fast Reverse Proxy) client and server when Gradios `share=True` option is used. HTTPS is not enforced on the connection, allowing attackers to intercept and read files uploaded to the Gradio server, as well as modify responses or data sent between the client and server. This impacts users who are sharing Gradio demos publicly over the internet using `share=True` without proper encryption, exposing sensitive data to potential eavesdroppers. Users are advised to upgrade to `gradio>=5` to address this issue. As a workaround, users can avoid using `share=True` in production environments and instead host their Gradio applications on servers with HTTPS enabled to ensure secure communication.

### Vulnerability Description Key Phrases
- **weakness:** **insecure communication**
- **impact:** intercept and read files uploaded to the Gradio server and modify responses or data sent between the client and server
- **attacker:** attackers
- **product:** Gradio
- **version:** before 5
- **component:** share=True option

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Insecure communication between the FRP client and server in Gradio when the `share=True` option is used. HTTPS is not enforced, leading to unencrypted communication.
- **Weaknesses/vulnerabilities present**: Lack of HTTPS enforcement for communication between the FRP client and server, allowing for interception of data.
- **Impact of exploitation**: Attackers can intercept and read files uploaded to the Gradio server, as well as modify responses or data sent between the client and server. This can expose sensitive data from files and potentially manipulate application behavior.
- **Attack vectors**: Man-in-the-middle attacks by intercepting the unencrypted communication between the Gradio client and server.
- **Required attacker capabilities/position**: Attackers need to be in a position to intercept network traffic between the FRP client and server. This typically involves being on the same network or having control over a network hop between the client and server.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.605 |
| 2 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.587 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.572 |
| 4 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.562 |
| 5 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.561 |
| 6 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.560 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.552 |
| 8 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.550 |
| 9 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | dense | 0.511 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.003 |

