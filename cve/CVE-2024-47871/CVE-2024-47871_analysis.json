{
  "cve_id": "CVE-2024-47871",
  "description": "Gradio is an open-source Python package designed for quick prototyping. This vulnerability involves ****insecure communication**** between the FRP (Fast Reverse Proxy) client and server when Gradios `share=True` option is used. HTTPS is not enforced on the connection, allowing attackers to intercept and read files uploaded to the Gradio server, as well as modify responses or data sent between the client and server. This impacts users who are sharing Gradio demos publicly over the internet using `share=True` without proper encryption, exposing sensitive data to potential eavesdroppers. Users are advised to upgrade to `gradio>=5` to address this issue. As a workaround, users can avoid using `share=True` in production environments and instead host their Gradio applications on servers with HTTPS enabled to ensure secure communication.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "insecure communication",
    "impact": [
      "intercept and read files uploaded to the Gradio server",
      "modify responses or data sent between the client and server"
    ],
    "vector": "",
    "attacker": "attackers",
    "product": "Gradio",
    "version": "before 5",
    "component": "share=True option"
  },
  "reference_content": "- **Root cause of vulnerability**: Insecure communication between the FRP client and server in Gradio when the `share=True` option is used. HTTPS is not enforced, leading to unencrypted communication.\n- **Weaknesses/vulnerabilities present**: Lack of HTTPS enforcement for communication between the FRP client and server, allowing for interception of data.\n- **Impact of exploitation**: Attackers can intercept and read files uploaded to the Gradio server, as well as modify responses or data sent between the client and server. This can expose sensitive data from files and potentially manipulate application behavior.\n- **Attack vectors**: Man-in-the-middle attacks by intercepting the unencrypted communication between the Gradio client and server.\n- **Required attacker capabilities/position**: Attackers need to be in a position to intercept network traffic between the FRP client and server. This typically involves being on the same network or having control over a network hop between the client and server.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-319 | Cleartext Transmission of Sensitive Information | 0.9 | Base | Allowed | Primary CWE |\n| CWE-201 | Insertion of Sensitive Information Into Sent Data | 0.7 | Base | Allowed | Secondary Candidate |\n| CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 0.6 | Class | Allowed-with-Review | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-319, which describes the root cause of transmitting sensitive information in cleartext. CWE-201 is a related CWE that can occur when sensitive data is inserted into sent data. CWE-923 is a higher-level class that describes improper restriction of communication channels, and the cleartext transmission can be seen as a specific instance of this.\n\n```mermaid\ngraph TD\n    cwe319[\"CWE-319: Cleartext Transmission of Sensitive Information\"]\n    cwe201[\"CWE-201: Insertion of Sensitive Information Into Sent Data\"]\n    cwe923[\"CWE-923: Improper Restriction of Communication Channel to Intended Endpoints\"]\n    \n    cwe319 -->|CHILDOF| cwe923\n    cwe201 -->|CANFOLLOW| cwe319\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe319 primary\n    class cwe201,cwe923 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **insecure communication** due to the lack of HTTPS enforcement (CWE-319). This leads to the potential **insertion of sensitive information** into transmitted data (CWE-201), which can be intercepted by attackers. The root cause is the **lack of encryption**, and the impact is the exposure of sensitive data and potential modification of data in transit.\n\n## Summary of Analysis\nThe primary weakness is **insecure communication** which stems from the **lack of HTTPS enforcement**. This aligns directly with CWE-319 (Cleartext Transmission of Sensitive Information). The vulnerability description states, \"HTTPS is not enforced on the connection, allowing attackers to intercept and read files uploaded to the Gradio server, as well as modify responses or data sent between the client and server.\" This provides strong evidence for CWE-319.\n\nCWE-201 (Insertion of Sensitive Information Into Sent Data) is a plausible secondary CWE because the intercepted data could include sensitive information. However, the primary issue is the cleartext transmission itself.\n\nCWE-923 (Improper Restriction of Communication Channel to Intended Endpoints) is a more general class of weakness, and while it could apply, CWE-319 is a more specific and accurate representation of the root cause.\n\nThe selected CWEs are at the optimal level of specificity, with CWE-319 being a Base-level CWE that directly addresses the vulnerability's root cause.\n\nCWEs considered but not used:\n\n*   CWE-346 (Origin Validation Error): Not applicable because the issue is not related to origin validation.\n*   CWE-212 (Improper Removal of Sensitive Information Before Storage or Transfer): Not applicable because the sensitive information is not being improperly stored or transferred in the context of this vulnerability, but rather transmitted in cleartext.\n*   CWE-295 (Improper Certificate Validation): Not applicable as the issue is the absence of HTTPS, not the validation of certificates.\n*   CWE-941 (Incorrectly Specified Destination in a Communication Channel): Not applicable because the destination is not incorrectly specified, but the channel is insecure.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-319 | Cleartext Transmission of Sensitive Information | 0.9 | Base | Allowed | Primary CWE |\n| CWE-201 | Insertion of Sensitive Information Into Sent Data | 0.7 | Base | Allowed | Secondary Candidate |\n| CWE-923 | Improper Restriction of Communication Channel to Intended Endpoints | 0.6 | Class | Allowed-with-Review | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-319, which describes the root cause of transmitting sensitive information in cleartext. CWE-201 is a related CWE that can occur when sensitive data is inserted into sent data. CWE-923 is a higher-level class that describes improper restriction of communication channels, and the cleartext transmission can be seen as a specific instance of this.\n\n```mermaid\ngraph TD\n    cwe319[\"CWE-319: Cleartext Transmission of Sensitive Information\"]\n    cwe201[\"CWE-201: Insertion of Sensitive Information Into Sent Data\"]\n    cwe923[\"CWE-923: Improper Restriction of Communication Channel to Intended Endpoints\"]\n    \n    cwe319 -->|CHILDOF| cwe923\n    cwe201 -->|CANFOLLOW| cwe319\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe319 primary\n    class cwe201,cwe923 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **insecure communication** due to the lack of HTTPS enforcement (CWE-319). This leads to the potential **insertion of sensitive information** into transmitted data (CWE-201), which can be intercepted by attackers. The root cause is the **lack of encryption**, and the impact is the exposure of sensitive data and potential modification of data in transit.\n\n## Summary of Analysis\nThe primary weakness is **insecure communication** which stems from the **lack of HTTPS enforcement**. This aligns directly with CWE-319 (Cleartext Transmission of Sensitive Information). The vulnerability description states, \"HTTPS is not enforced on the connection, allowing attackers to intercept and read files uploaded to the Gradio server, as well as modify responses or data sent between the client and server.\" This provides strong evidence for CWE-319.\n\nCWE-201 (Insertion of Sensitive Information Into Sent Data) is a plausible secondary CWE because the intercepted data could include sensitive information. However, the primary issue is the cleartext transmission itself.\n\nCWE-923 (Improper Restriction of Communication Channel to Intended Endpoints) is a more general class of weakness, and while it could apply, CWE-319 is a more specific and accurate representation of the root cause.\n\nThe selected CWEs are at the optimal level of specificity, with CWE-319 being a Base-level CWE that directly addresses the vulnerability's root cause.\n\nCWEs considered but not used:\n\n*   CWE-346 (Origin Validation Error): Not applicable because the issue is not related to origin validation.\n*   CWE-212 (Improper Removal of Sensitive Information Before Storage or Transfer): Not applicable because the sensitive information is not being improperly stored or transferred in the context of this vulnerability, but rather transmitted in cleartext.\n*   CWE-295 (Improper Certificate Validation): Not applicable as the issue is the absence of HTTPS, not the validation of certificates.\n*   CWE-941 (Incorrectly Specified Destination in a Communication Channel): Not applicable because the destination is not incorrectly specified, but the channel is insecure.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-295:**\n- 295 (Improper Certificate Validation) - ROOT\n\n\n**Chain starting from CWE-346:**\n- 346 (Origin Validation Error) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 604.8201310174478
    },
    {
      "metadata": {
        "doc_id": "319",
        "name": "Cleartext Transmission of Sensitive Information",
        "source": "sparse"
      },
      "similarity": 587.166770174735
    },
    {
      "metadata": {
        "doc_id": "346",
        "name": "Origin Validation Error",
        "source": "sparse"
      },
      "similarity": 572.2449882382533
    },
    {
      "metadata": {
        "doc_id": "212",
        "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
        "source": "sparse"
      },
      "similarity": 561.8075509940791
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 561.2540180500006
    },
    {
      "metadata": {
        "doc_id": "295",
        "name": "Improper Certificate Validation",
        "source": "sparse"
      },
      "similarity": 560.1953499230585
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 551.9586039625314
    },
    {
      "metadata": {
        "doc_id": "88",
        "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
        "source": "sparse"
      },
      "similarity": 549.6909583423769
    },
    {
      "metadata": {
        "doc_id": "941",
        "name": "Incorrectly Specified Destination in a Communication Channel",
        "type": "Base",
        "original_content": "The product creates a communication channel to initiate an outgoing request to an actor, but it does not correctly specify the intended destination for that actor.",
        "keyphrase_source": "weakness:insecure communication",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5112460843151485,
            "graph": 1.7083489883445502
          }
        }
      },
      "similarity": 0.5112460843151485
    },
    {
      "doc_id": "226",
      "text": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
      "score": 2.8651999999999997,
      "metadata": {
        "doc_id": "226",
        "name": "Sensitive Information in Resource Not Removed Before Reuse",
        "type": "base",
        "original_content": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
        "relationships": [
          {
            "source_id": "226",
            "target_id": "244",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1342",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1301",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1272",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1239",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "201",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "212",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "459",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "459",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "244",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "212",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "201",
            "target_id": "226",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1301",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1272",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.7200000000000001,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "201"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "212",
                  "226",
                  "PARENTOF"
                ]
              ],
              "score": 0.7200000000000001,
              "type": "abstraction_path_down",
              "source": "212"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "201"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "226",
                  "201",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "201"
            }
          }
        },
        "abstraction_level": "base",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.8651999999999997
          }
        }
      },
      "similarity": 2.8651999999999997
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-295",
      "CWE-346",
      "CWE-319",
      "CWE-201",
      "CWE-923",
      "CWE-941",
      "CWE-212"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}