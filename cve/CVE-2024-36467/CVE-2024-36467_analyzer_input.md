# Vulnerability Information: CVE-2024-36467

## Vulnerability Description
An authenticated user with API access (e.g. user with default User role), more specifically a user with access to the user.update API endpoint is enough to be able to add themselves to any group (e.g. Zabbix Administrators), except to groups that are disabled or having restricted GUI access.

### Vulnerability Description Key Phrases
- **impact:** add themselves to any group
- **attacker:** authenticated user with API access

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-36467:

**Root Cause of Vulnerability:**
The vulnerability stems from missing authorization checks in the Zabbix API, specifically within the `user.update` endpoint.

**Weaknesses/Vulnerabilities Present:**
- **Insufficient Authorization:** The core issue is the lack of proper authorization checks when using the `user.update` API endpoint. This allows users to modify their group memberships without proper validation of their privileges.
- **Privilege Escalation:** The absence of authorization allows users to elevate their privileges by adding themselves to more powerful groups (e.g., "Zabbix Administrators").

**Impact of Exploitation:**
- **Privilege Escalation:**  A regular authenticated user (with API access, including the `user.update` endpoint), like one having the default "User" role can escalate their privileges to gain administrative access, by adding themselves to higher privilege groups like Zabbix Administrators.
- **Unauthorized Access:**  Successful exploitation grants an attacker unauthorized access to administrative functions and system-wide control.

**Attack Vectors:**
- **API Access:** An attacker needs to have API access and the ability to call the `user.update` API endpoint.
- **Authentication:** The attacker needs to be an authenticated user.

**Required Attacker Capabilities/Position:**
- **Authenticated User:**  The attacker must be a valid, authenticated Zabbix user with API access to call the `user.update` endpoint. The default User role is sufficient.
- **API Access:** The attacker must have the ability to interact with the Zabbix API.

**Additional Information:**
- The vulnerability affects multiple Zabbix versions.
- The fix is implemented in the release candidate versions 5.0.43rc1, 6.0.33rc1, 6.4.18rc1 and 7.0.2rc1
- Groups with restricted GUI access or being disabled are not vulnerable.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 267 | Privilege Defined With Unsafe Actions | Base | Allowed | sparse | 0.106 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.105 |
| 3 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.099 |
| 4 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.099 |
| 5 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.098 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.097 |
| 7 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.095 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.092 |
| 9 | 842 | Placement of User into Incorrect Group | Base | Allowed | dense | 0.417 |
| 10 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | graph | 0.003 |

