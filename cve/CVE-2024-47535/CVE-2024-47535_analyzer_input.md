# Vulnerability Information: CVE-2024-47535

## Vulnerability Description
Netty is an asynchronous event-driven network application framework for rapid development of maintainable high performance protocol servers & clients. An **unsafe reading of environment file** could potentially cause a denial of service in Netty. When loaded on an Windows application, Netty attempts to load a file that does not exist. If an attacker creates such a large file, the Netty application crashes. This vulnerability is fixed in 4.1.115.

### Vulnerability Description Key Phrases
- **weakness:** **unsafe reading of environment file**
- **impact:** denial of service
- **attacker:** attacker
- **product:** Netty
- **version:** before 4.1.115

## CVE Reference Links Content Summary
```json
{
  "vulnerability_information": {
    "root_cause": "Netty attempts to load specific files (`/etc/os-release`, `/usr/lib/os-release`, and `/proc/sys/net/core/somaxconn`) on Windows systems, even though these files are not relevant to the Windows environment. If an attacker creates a large file at these locations, the application attempts to load the entire file into memory, potentially causing an Out-of-Memory Error (OOME).",
    "weaknesses": [
      "Unsafe reading of environment files without proper OS verification.",
      "Lack of input validation/size limits when reading files during startup.",
       "Attempting to read Linux specific files on a Windows OS"
    ],
    "impact": "Denial of Service (DoS). The Netty application crashes due to an Out-of-Memory Error (OOME) when it tries to load a large, attacker-controlled file into memory.",
    "attack_vectors": [
      "Local file system access. An attacker needs to have a user account on the system where the Netty application is running."
    ],
    "required_attacker_capabilities": [
      "Ability to create files on the local file system.",
      "A user account with low privileges to create directories and files."
    ],
    "additional_details": "The vulnerability is triggered due to Netty's attempt to read files typically found on Linux systems (e.g., `/etc/os-release`) even when running on Windows. The `normalizeOs()` function does not prevent the code from attempting to read these files on a Windows OS. The fix was to implement a `BoundedInputStream` to limit the amount of data read from the files. The vulnerability can be exploited by creating a file larger than 1GB in the expected path on the Windows filesystem and then starting the vulnerable Netty application."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 378 | Creation of Temporary File With Insecure Permissions | Base | Allowed | sparse | 0.573 |
| 2 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.372 |
| 3 | 611 | Improper Restriction of XML External Entity Reference | Base | Allowed | sparse | 0.354 |
| 4 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | Allowed | sparse | 0.348 |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.344 |
| 6 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.341 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.340 |
| 8 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.337 |
| 9 | 246 | J2EE Bad Practices: Direct Use of Sockets | Variant | Allowed | dense | 0.457 |
| 10 | 390 | Detection of Error Condition Without Action | Base | Allowed | graph | 0.002 |

