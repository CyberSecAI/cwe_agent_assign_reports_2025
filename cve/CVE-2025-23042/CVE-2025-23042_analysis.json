{
  "cve_id": "CVE-2025-23042",
  "description": "Gradio is an open-source Python package that allows quick building of demos and web application for machine learning models, API, or any arbitrary Python function. Gradios Access Control List (ACL) for file paths can be bypassed by altering the letter case of a blocked file or directory path. This vulnerability arises due to the lack of case normalization in the file path validation logic. On case-insensitive file systems, such as those used by Windows and macOS, this flaw enables attackers to circumvent security restrictions and access sensitive files that should be protected. This issue can lead to unauthorized data access, exposing sensitive information and undermining the integrity of Gradios security model. Given Gradios popularity for building web applications, particularly in machine learning and AI, this vulnerability may pose a substantial threat if exploited in production environments. This issue has been addressed in release version 5.6.0. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
  "key_phrases": {
    "component": "",
    "rootcause": "lack of case normalization, case normalization in the file path validation logic",
    "vector": "altering the letter case of a blocked file or directory path",
    "weakness": "",
    "product": "Gradio",
    "impact": "['Access Control List (ACL) bypass', 'unauthorized data access', 'access sensitive files', 'expose sensitive information', 'undermine the integrity of Gradios security model']",
    "attacker": "",
    "version": ""
  },
  "reference_content": "## CVE-2025-23042 - Gradio Blocked Path ACL Bypass Vulnerability\n\n**Root cause of vulnerability:**\n\nThe vulnerability arises from a lack of case normalization in the file path validation logic within Gradio's Access Control List (ACL) for file paths. The `is_allowed_file` function and its reliance on `is_in_or_equal` do not handle case variations in paths on case-insensitive file systems.\n\n**Weaknesses/vulnerabilities present:**\n\n*   Case-insensitive file path handling.\n*   ACL bypass due to case alteration.\n\n**Impact of exploitation:**\n\n*   Unauthorized Access: Sensitive files or directories specified in `blocked_paths` can be accessed by attackers.\n*   Data Exposure: Critical files, such as configuration files or user data, may be leaked.\n*   Security Breach: This can lead to broader application or system compromise if sensitive files contain credentials or API keys.\n\n**Attack vectors:**\n\n*   Accessing sensitive files using a case-altered path via HTTP requests (e.g., `http://127.0.0.1:PORT/gradio_api/file=resources/adMin/credential.txt`).\n\n**Required attacker capabilities/position:**\n\n*   An attacker needs to be able to construct and send HTTP requests to the Gradio application.\n*   Knowledge of the blocked paths and the ability to manipulate the case of the path in the request.\n*   The application must be deployed on a case-insensitive file system (Windows, macOS).\n\n**Mitigation or fix:**\n\n1.  **Normalize Path Case**: Convert both the requested path and the blocked paths to a consistent case (e.g., lowercase) before evaluating them against the ACL.\n2.  **Update Documentation**: Warn developers about potential risks when deploying Gradio on case-insensitive file systems.\n3.  **Release Security Patches**: Release an updated version of Gradio with the fixed logic.\n\n**Affected versions:**\n\n< 5.6.0\n\n**CVE ID:** CVE-2025-23042\n\n**More detail than official CVE description:** The content provides a detailed root cause analysis, a proof of concept, and specific remediation recommendations, offering more information than a typical CVE description. It also includes the vulnerable code snippet.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-178 | Improper Handling of Case Sensitivity | 0.9 | Base | Allowed | Primary CWE. The **root cause** is the **lack of case normalization** in the file path validation logic. |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.6 | Base | Allowed | Secondary candidate. This is a potential impact due to the **lack of case normalization**. |\n| CWE-668 | Exposure of Resource to Wrong Sphere | 0.5 | Class | Discouraged | Secondary candidate. The case insensitivity leads to exposure. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is CWE-178, Improper Handling of Case Sensitivity. This can lead to CWE-22, Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), because the **lack of case normalization** allows an attacker to bypass intended restrictions on file paths. CWE-668, Exposure of Resource to Wrong Sphere, is a broader category that could apply, but CWE-22 is more specific to the path traversal aspect of the vulnerability, making it a better fit as a secondary CWE.\n\n```mermaid\ngraph TD\n    cwe178[\"CWE-178: Improper Handling of Case Sensitivity\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n    cwe668[\"CWE-668: Exposure of Resource to Wrong Sphere\"]\n\n    cwe22 -->|CANFOLLOW| cwe178\n    cwe22 -->|CHILDOF| cwe706[\"CWE-706: Use of Incorrectly-Resolved Name or Reference\"]\n    cwe178 -->|CANPRECEDE| cwe22\n    cwe22 --> cwe668\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe178 primary\n    class cwe22,cwe668 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with CWE-178, Improper Handling of Case Sensitivity, as the **root cause**. This **lack of case normalization** leads to CWE-22, Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), as attackers can use case variations to bypass path restrictions. This can ultimately result in CWE-668, Exposure of Resource to Wrong Sphere, where sensitive resources are exposed to unauthorized users.\n\n## Summary of Analysis\nThe analysis is primarily based on the provided evidence, particularly the \"Vulnerability Description Key Phrases\" and the \"CVE Reference Links Content Summary,\" which explicitly mention the **lack of case normalization** as the **root cause** of the vulnerability.\n\nThe graph relationships highlight how CWE-178 can directly lead to CWE-22. The selection of CWE-178 as the primary CWE is justified because it represents the most fundamental flaw: the **failure to handle case sensitivity properly**. CWE-22 is a natural consequence of this flaw, as it allows attackers to bypass path restrictions. The level of specificity is optimal because CWE-178 directly addresses the **root cause**, while CWE-22 describes the immediate impact of that flaw.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-178: Improper Handling of Case Sensitivity\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly account for differences in case sensitivity when accessing or determining the properties of a resource, leading to inconsistent results.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Why it was selected:** This CWE perfectly matches the **root cause** of the vulnerability, which is the **lack of case normalization** in the file path validation logic.\n\n## CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\n**Abstraction Level**: Base\n**Similarity Score**: 1812.97\n**Source**: sparse\n\n**Description**:\nThe product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Why it was selected:** Because it is the most direct result of the **lack of case normalization**\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n**Why it was considered but not used as the primary CWE:** While the vulnerability does lead to the exposure of resources to the wrong sphere, CWE-178 and CWE-22 are more specific and directly related to the **root cause** and immediate impact.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-178 | Improper Handling of Case Sensitivity | 0.9 | Base | Allowed | Primary CWE. The **root cause** is the **lack of case normalization** in the file path validation logic. |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.6 | Base | Allowed | Secondary candidate. This is a potential impact due to the **lack of case normalization**. |\n| CWE-668 | Exposure of Resource to Wrong Sphere | 0.5 | Class | Discouraged | Secondary candidate. The case insensitivity leads to exposure. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is CWE-178, Improper Handling of Case Sensitivity. This can lead to CWE-22, Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), because the **lack of case normalization** allows an attacker to bypass intended restrictions on file paths. CWE-668, Exposure of Resource to Wrong Sphere, is a broader category that could apply, but CWE-22 is more specific to the path traversal aspect of the vulnerability, making it a better fit as a secondary CWE.\n\n```mermaid\ngraph TD\n    cwe178[\"CWE-178: Improper Handling of Case Sensitivity\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n    cwe668[\"CWE-668: Exposure of Resource to Wrong Sphere\"]\n\n    cwe22 -->|CANFOLLOW| cwe178\n    cwe22 -->|CHILDOF| cwe706[\"CWE-706: Use of Incorrectly-Resolved Name or Reference\"]\n    cwe178 -->|CANPRECEDE| cwe22\n    cwe22 --> cwe668\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe178 primary\n    class cwe22,cwe668 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with CWE-178, Improper Handling of Case Sensitivity, as the **root cause**. This **lack of case normalization** leads to CWE-22, Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), as attackers can use case variations to bypass path restrictions. This can ultimately result in CWE-668, Exposure of Resource to Wrong Sphere, where sensitive resources are exposed to unauthorized users.\n\n## Summary of Analysis\nThe analysis is primarily based on the provided evidence, particularly the \"Vulnerability Description Key Phrases\" and the \"CVE Reference Links Content Summary,\" which explicitly mention the **lack of case normalization** as the **root cause** of the vulnerability.\n\nThe graph relationships highlight how CWE-178 can directly lead to CWE-22. The selection of CWE-178 as the primary CWE is justified because it represents the most fundamental flaw: the **failure to handle case sensitivity properly**. CWE-22 is a natural consequence of this flaw, as it allows attackers to bypass path restrictions. The level of specificity is optimal because CWE-178 directly addresses the **root cause**, while CWE-22 describes the immediate impact of that flaw.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-178: Improper Handling of Case Sensitivity\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly account for differences in case sensitivity when accessing or determining the properties of a resource, leading to inconsistent results.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Why it was selected:** This CWE perfectly matches the **root cause** of the vulnerability, which is the **lack of case normalization** in the file path validation logic.\n\n## CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\n**Abstraction Level**: Base\n**Similarity Score**: 1812.97\n**Source**: sparse\n\n**Description**:\nThe product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Why it was selected:** Because it is the most direct result of the **lack of case normalization**\n\n## CWE-668: Exposure of Resource to Wrong Sphere\n**Abstraction Level**: Class\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-668 is high-level and is often misused as a catch-all when lower-level CWE IDs might be applicable. It is sometimes used for low-information vulnerability reports [REF-1287]. It is a level-1 Class (i.e., a child of a Pillar). It is not useful for trend analysis.\n\n**Why it was considered but not used as the primary CWE:** While the vulnerability does lead to the exposure of resources to the wrong sphere, CWE-178 and CWE-22 are more specific and directly related to the **root cause** and immediate impact.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-706:**\n- 706 (Use of Incorrectly-Resolved Name or Reference) - ROOT\n\n\n**Chain starting from CWE-178:**\n- 178 (Improper Handling of Case Sensitivity) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 889.031676277629
    },
    {
      "metadata": {
        "doc_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "source": "sparse"
      },
      "similarity": 860.0007602871116
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 842.9331462700551
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 837.6788659537212
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 834.5450703779394
    },
    {
      "metadata": {
        "doc_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "source": "sparse"
      },
      "similarity": 811.9506776139649
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 809.6333092662074
    },
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "sparse"
      },
      "similarity": 809.0605227356268
    },
    {
      "metadata": {
        "doc_id": "178",
        "name": "Improper Handling of Case Sensitivity",
        "type": "Base",
        "original_content": "The product does not properly account for differences in case sensitivity when accessing or determining the properties of a resource, leading to inconsistent results.",
        "keyphrase_source": "rootcause:case normalization in the file path validation logic",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.45845776708947567,
            "graph": 1.634867359286686
          }
        }
      },
      "similarity": 0.45845776708947567
    },
    {
      "doc_id": "289",
      "text": "CWE-289: Authentication Bypass by Alternate Name",
      "score": 2.73416,
      "metadata": {
        "doc_id": "289",
        "name": "Authentication Bypass by Alternate Name",
        "type": "base",
        "original_content": "CWE-289: Authentication Bypass by Alternate Name",
        "relationships": [
          {
            "source_id": "289",
            "target_id": "52",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "289",
            "target_id": "46",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "289",
            "target_id": "178",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "289",
            "target_id": "173",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "289",
            "target_id": "1390",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "52",
            "target_id": "289",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "46",
            "target_id": "289",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "178",
            "target_id": "289",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "173",
            "target_id": "289",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1390",
            "target_id": "289",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.5760000000000002,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "178",
                  "289",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "178"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "287",
                  "1390",
                  "PARENTOF"
                ],
                [
                  "1390",
                  "289",
                  "PARENTOF"
                ]
              ],
              "score": 0.5760000000000002,
              "type": "abstraction_path_down",
              "source": "287"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "178",
                  "289",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "178"
            }
          }
        },
        "abstraction_level": "base",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.73416
          }
        }
      },
      "similarity": 2.73416
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-706",
      "CWE-178",
      "CWE-668",
      "CWE-22"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}