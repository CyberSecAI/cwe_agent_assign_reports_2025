## Vulnerability Description
nimiq/core-rs-albatross is a Rust implementation of the Nimiq Proof-of-Stake protocol based on the Albatross consensus algorithm. The `nimiq-network-libp2p` subcrate of nimiq/core-rs-albatross is vulnerable to a Denial of Service (DoS) attack due to **uncontrolled memory allocation**. Specifically, the implementation of the `Discovery` network message handling allocates a buffer based on a length value provided by the peer, without enforcing an upper bound. Since this length is a `u32`, a peer can trigger allocations of up to 4 GB, potentially leading to memory exhaustion and node crashes. As Discovery messages are regularly exchanged for peer discovery, this vulnerability can be exploited repeatedly. The patch for this vulnerability is formally released as part of v1.1.0. The patch implements a limit to the discovery message size of 1 MB and also resizes the message buffer size incrementally as the data is read. No known workarounds are available.

### Vulnerability Description Key Phrases
- **rootcause:** **uncontrolled memory allocation**
- **impact:** Denial of Service (DoS)
- **product:** nimiq-network-libp2p subcrate of nimiq/core-rs-albatross
- **component:** Discovery network message handling

## CVE Reference Links Content Summary
## Analysis of CVE-2025-47270 based on provided content:

The provided content **is relevant** to CVE-2025-47270. It details a vulnerability in the `nimiq-network-libp2p` subcrate of the Nimiq PoS client implementation. Here's a breakdown of the information:

**Root cause of vulnerability:**

*   Uncontrolled memory allocation when handling `Discovery` network messages. The implementation allocates a buffer based on a length value provided by the peer without an upper bound.

**Weaknesses/vulnerabilities present:**

*   Denial of Service (DoS) due to excessive memory consumption.
*   Specifically, a peer can trigger allocations of up to 4 GB, potentially leading to memory exhaustion and node crashes.

**Impact of exploitation:**

*   Memory exhaustion leading to node crashes.
*   Denial of Service.

**Attack vectors:**

*   A malicious peer sending `Discovery` messages with a large length value.
*   Exploitation is possible because Discovery messages are regularly exchanged.

**Required attacker capabilities/position:**

*   An attacker needs to be a peer in the Nimiq network.
*   No specific privileges are required.

**Mitigation or fix:**

*   The patch (pull request #3384) limits the discovery message size to 1 MB.
*   The patch also resizes the message buffer incrementally as data is read.
*   The fix is included in release v1.1.0.

**Additional details (more than official CVE description):**

*   CVSS score: 7.5 (High)
*   CVSS vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
*   CWE ID: CWE-400 (Uncontrolled Resource Consumption)
*   Credits to the vulnerability finders: @pl4smaN and @jsdanielh.
*   Details of the pull request that fixed the issue (#3384) and the commit hash (566935f).
*   Information about the affected package (cargo, nimiq-network-libp2p).
*   Affected and patched versions are specified (<v1.1.0 and >=v1.1.0 respectively).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 1.029 |
| 2 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.982 |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.935 |
| 4 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.882 |
| 5 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.869 |
| 6 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.865 |
| 7 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.851 |
| 8 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | sparse | 0.844 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.473 |
| 10 | 390 | Detection of Error Condition Without Action | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-789: Memory Allocation with Excessive Size Value

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-400: Uncontrolled Resource Consumption

CWE-190: Integer Overflow or Wraparound

CWE-193: Off-by-one Error

CWE-1325: Improperly Controlled Sequential Memory Allocation

CWE-126: Buffer Over-read

CWE-390: Detection of Error Condition Without Action