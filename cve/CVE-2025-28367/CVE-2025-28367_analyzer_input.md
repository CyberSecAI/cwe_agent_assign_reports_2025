# Vulnerability Information: CVE-2025-28367

## Vulnerability Description
mojoPortal <=2.9.0.1 is vulnerable to **Directory Traversal** via BetterImageGallery API Controller - ImageHandler Action. An attacker can exploit this vulnerability to access the Web.Config file and obtain the MachineKey.

### Vulnerability Description Key Phrases
- **weakness:** **Directory Traversal**
- **impact:** access Web.Config file
- **attacker:** attacker
- **product:** mojoPortal
- **version:** <=2.9.0.1
- **component:** BetterImageGallery API Controller - ImageHandler Action

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
A directory traversal vulnerability leading to ViewState deserialization was identified in mojoPortal CMS.

Weaknesses/vulnerabilities present:
- Directory traversal
- ViewState deserialization

Impact of exploitation:
- Remote code execution (RCE) on the hosting web server.

Attack vectors:
- The attacker can download the `Web.config` file to extract the `machineKey` value, then send a malicious ViewState payload to a vulnerable endpoint to execute arbitrary commands within the context of the IIS worker process.
- `GET /api/BetterImageGallery/imagehandler?path=../../../../Web.Config HTTP/1.1`
- `POST /Services/PayPalIPNHandler.aspx HTTP/1.1`

Required attacker capabilities/position:
- Unauthenticated attacker.

Mitigation or fix:
- This issue was addressed in commit [8f8ce6a](https://github.com/i7MEDIA/mojoportal/commit/8f8ce6af5c9dcc26b676692fcb4615ae38b2f157?ref=0xlanks.me), however the applied fix has not been validated.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.217 |
| 3 | 73 | External Control of File Name or Path | Base | Allowed | sparse | 0.198 |
| 4 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.190 |
| 5 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.178 |
| 6 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.177 |
| 7 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.176 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.175 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.542 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.003 |

