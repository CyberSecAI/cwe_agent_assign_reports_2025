# Vulnerability Information: CVE-2024-47868

## Vulnerability Description
Gradio is an open-source Python package designed for quick prototyping. This is a ****data validation vulnerability**** affecting several Gradio components, which allows arbitrary file leaks through the post-processing step. Attackers can exploit these components by crafting requests that bypass expected input constraints. This issue could lead to sensitive files being exposed to unauthorized users, especially when combined with other vulnerabilities, such as issue TOB-GRADIO-15. The components most at risk are those that return or handle file data. Vulnerable Components 1. **String to FileData** DownloadButton, Audio, ImageEditor, Video, Model3D, File, UploadButton. 2. **Complex data to FileData** Chatbot, MultimodalTextbox. 3. **Direct file read in preprocess** Code. 4. **Dictionary converted to FileData** ParamViewer, Dataset. Exploit Scenarios 1. A developer creates a Dropdown list that passes values to a DownloadButton. An attacker bypasses the allowed inputs, sends an arbitrary file path (like `/etc/passwd`), and downloads sensitive files. 2. An attacker crafts a malicious payload in a ParamViewer component, leaking sensitive files from a server through the arbitrary file leak. This issue has been resolved in `gradio>5.0`. Upgrading to the latest version will mitigate this vulnerability. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **data validation vulnerability**
- **impact:** arbitrary file leaks
- **vector:** crafting requests that bypass expected input constraints
- **attacker:** attackers
- **product:** Gradio
- **version:** <5.0
- **component:** DownloadButton and Audio and ImageEditor and Video and Model3D and File and UploadButton and Chatbot and MultimodalTextbox and Code and ParamViewer and Dataset

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The vulnerability stems from a lack of proper data validation in the post-processing steps of several Gradio components. These components handle file data, and the lack of validation allows attackers to bypass intended input constraints.",
  "Weaknesses/vulnerabilities present": [
    "Data validation vulnerability",
    "Arbitrary file leaks due to insufficient input sanitization during file handling in post-processing steps"
  ],
  "Impact of exploitation": "Exploitation can lead to the exposure of sensitive files to unauthorized users. This can be particularly severe if combined with other vulnerabilities.",
  "Attack vectors": "Attackers can craft malicious requests that bypass expected input constraints, injecting arbitrary file paths into components that process file data. Examples include providing file paths like `/etc/passwd` to a `DownloadButton` through manipulated inputs, or providing similar filepaths through other affected components to trigger file leaks.",
  "Required attacker capabilities/position": "The attacker needs to be able to send requests to the vulnerable application with crafted payloads that specify arbitrary file paths. This typically involves interacting with user-facing components of the application."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.841 |
| 2 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.838 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.830 |
| 4 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.829 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.823 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.820 |
| 7 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.812 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.812 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.578 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |

