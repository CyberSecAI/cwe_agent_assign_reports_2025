## Vulnerability Description
WeGIA is an open source Web Manager for Institutions with a focus on Portuguese language users. A SQL Injection vulnerability was discovered in the WeGIA application, `historico_paciente.php` endpoint. This vulnerability could allow an attacker to execute arbitrary SQL queries, allowing unauthorized access to sensitive information. This issue has been addressed in version 3.2.14 and all users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **SQL injection vulnerability**
- **impact:** execute arbitrary SQL queries, unauthorized access to sensitive information
- **attacker:** attacker
- **product:** WeGIA application
- **version:** before version 3.2.14
- **component:** historico_paciente.php endpoint

## CVE Reference Links Content Summary
CVE-2025-26617 is related to the content. Here's the extracted information:

**Root cause of vulnerability:**
Lack of validation of user input for the `id_fichamedica` parameter in the `historico_paciente.php` endpoint.

**Weaknesses/vulnerabilities present:**
SQL Injection (CWE-89, CWE-284)

**Impact of exploitation:**
- Retrieving sensitive data
- Denial of Service (DoS) attack (dropping SQL tables)
- Potential for arbitrary file upload

**Attack vectors:**
- Network-based exploitation via GET request to `http://localhost/html/saude/historico_paciente.php?id_fichamedica=[payload]`
- Exploitation possible even without being logged in due to improper execution termination after session validation.

**Required attacker capabilities/position:**
- No privileges required
- No user interaction required
- Network access

**Mitigation or fix:**
- Patched versions: 3.2.14
- Input validation and sanitization of the `id_fichamedica` parameter is required.

**PoC:**
`curl -X GET "http://localhost/html/saude/historico_paciente.php?id_fichamedica=999+AND+(SELECT+299+FROM+(SELECT(SLEEP(5)))a)"`

**Severity:**
Critical (CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H)

**Affected versions:**
<=3.2.11

**CVE ID:**
CVE-2025-26617

**Note:** This content provides more detail than the official CVE description, including the vulnerable code snippet, a Proof of Concept (PoC), and a detailed CVSS v4 analysis.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.388 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.381 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.381 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.373 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.370 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.366 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.364 |
| 9 | 564 | SQL Injection: Hibernate | Variant | Allowed | dense | 0.507 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-502: Deserialization of Untrusted Data

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-116: Improper Encoding or Escaping of Output

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-863: Incorrect Authorization

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-564: SQL Injection: Hibernate

CWE-434: Unrestricted Upload of File with Dangerous Type