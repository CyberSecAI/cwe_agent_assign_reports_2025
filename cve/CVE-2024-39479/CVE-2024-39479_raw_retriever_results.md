# Raw Retriever Results for CVE-2024-39479

# Raw Retriever Results for CVE-2024-39479
## Query
In the Linux kernel, the following vulnerability has been resolved drm/i915/hwmon Get rid of devm When both hwmon and hwmon drvdata (on which hwmon depends) are device managed resources, the expectation, on device unbind, is that hwmon will be released before drvdata. However, in i915 there are two separate code paths, which both release either drvdata or hwmon and either can be released before the other. These code paths (for device unbind) are as follows (see also the bug referenced below) Call Trace release_nodes+0x11/0x70 devres_release_group+0xb2/0x110 component_unbind_all+0x8d/0xa0 component_del+0xa5/0x140 intel_pxp_tee_component_fini+0x29/0x40 [i915] intel_pxp_fini+0x33/0x80 [i915] i915_driver_remove+0x4c/0x120 [i915] i915_pci_remove+0x19/0x30 [i915] pci_device_remove+0x32/0xa0 device_release_driver_internal+0x19c/0x200 unbind_store+0x9c/0xb0 and Call Trace release_nodes+0x11/0x70 devres_release_all+0x8a/0xc0 device_unbind_cleanup+0x9/0x70 device_release_driver_internal+0x1c1/0x200 unbind_store+0x9c/0xb0 This means that in i915, if use devm, we cannot gurantee that hwmon will always be released before drvdata. Which means that we have a uaf if hwmon sysfs is accessed when drvdata has been released but hwmon hasnt. The only way out of this seems to be do get rid of devm_ and release/free everything explicitly during device unbind. v2 Change commit message and other minor code changes v3 Cleanup from i915_hwmon_register on error (Armin Wolf) v4 Eliminate

## Keyphrases
- **weakness**: 'Use-After-Free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4018 | 0.4775 | 0.4320 | 0.4300 | 20 |
| Sparse | 626.4402 | 1000.0000 | 683.7049 | 652.2204 | 11 |
| Graph | 1.3676 | 3.3720 | 2.0712 | 2.1563 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 415 | Double Free | variant | 3.3720 | Allowed |
| 2 | 123 | Write-what-where Condition | base | 2.9120 | Allowed |
| 3 | 908 | Use of Uninitialized Resource | Base | 2.7990 | Allowed |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 2.2880 | Allowed |
| 5 | 364 | Signal Handler Race Condition | base | 2.2100 | Allowed |
| 6 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 8 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 9 | 416 | Use After Free | Variant | 2.2054 | Allowed |
| 10 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |
| 11 | 203 | Observable Discrepancy | base | 2.1190 | Allowed |
| 12 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 13 | 909 | Missing Initialization of Resource | Class | 1.7330 | Allowed-with-Review |
| 14 | 134 | Use of Externally-Controlled Format String | base | 1.6848 | Allowed |
| 15 | 170 | Improper Null Termination | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.4775 | 0.4775 | Allowed-with-Review |
| 2 | 908 | Use of Uninitialized Resource | Base | 0.4715 | 0.4715 | Allowed |
| 3 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4575 | 0.4575 | Allowed |
| 4 | 667 | Improper Locking | Class | 0.4562 | 0.4562 | Allowed-with-Review |
| 5 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4513 | 0.4513 | Allowed |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4512 | 0.4512 | Allowed-with-Review |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4470 | 0.4470 | Allowed |
| 8 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4469 | 0.4469 | Allowed |
| 9 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 0.4444 | 0.4444 | Allowed |
| 10 | 413 | Improper Resource Locking | Base | 0.4430 | 0.4430 | Allowed |
| 11 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4170 | 0.4170 | Allowed |
| 12 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4166 | 0.4166 | Allowed |
| 13 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4166 | 0.4166 | Discouraged |
| 14 | 833 | Deadlock | Base | 0.4127 | 0.4127 | Allowed |
| 15 | 416 | Use After Free | Variant | 0.4099 | 0.4099 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 416 | Use After Free | 1000.0000 | 1000.0000 | Allowed |
| 2 | 401 | Missing Release of Memory after Effective Lifetime | 680.3689 | 680.3689 | Allowed |
| 3 | 61 | UNIX Symbolic Link (Symlink) Following | 664.9870 | 664.9870 | Allowed |
| 4 | 203 | Observable Discrepancy | 662.6971 | 662.6971 | Allowed |
| 5 | 415 | Double Free | 659.5424 | 659.5424 | Allowed |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 652.2204 | 652.2204 | Allowed-with-Review |
| 7 | 347 | Improper Verification of Cryptographic Signature | 651.7671 | 651.7671 | Allowed |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | 646.1674 | 646.1674 | Allowed |
| 9 | 863 | Incorrect Authorization | 644.2864 | 644.2864 | Allowed-with-Review |
| 10 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 632.2770 | 632.2770 | Allowed |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | 626.4402 | 626.4402 | Allowed |
