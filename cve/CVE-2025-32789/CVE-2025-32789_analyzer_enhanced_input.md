## Vulnerability Description
EspoCRM is an Open Source Customer Relationship Management software. Prior to version 9.0.7, users can be sorted by their password hash. This flaw allows an attacker to make assumptions about the hash values of other users stored in the password column of the user table, based on the results of the sorted list of users. Although unlikely, if an attacker knows the hash value of their password, they can change the password and repeat the sorting until the other users password hash is fully revealed. This issue is patched in version 9.0.7.

### Vulnerability Description Key Phrases
- **product:** EspoCRM
- **impact:** sort users by password hash, change other users' passwords
- **attacker:** attacker
- **version:** prior to 9.0.7

## CVE Reference Links Content Summary
## Analysis of CVE-2025-32789 based on provided content:

The provided content details a security vulnerability in EspoCRM, specifically related to sorting users by their password hash. This directly relates to CVE-2025-32789 as indicated by the "CVE ID" section within the advisory. The content provides significantly more detail than a typical CVE description.

**Root cause of vulnerability:**

The vulnerability stems from allowing users to be sorted by their password hash in the user management functionality. This allows an attacker to infer information about other users' password hashes by observing the sort order.

**Weaknesses/vulnerabilities present:**

*   **Insecure Sorting:** The ability to sort users by the `password` field.
*   **Information Leakage:**  The sorting mechanism leaks information about the relative order of password hashes.

**Impact of exploitation:**

*   **Potential Password Cracking:** While the Bcrypt hashing algorithm with salts makes direct password recovery difficult, the sorted order provides clues that could aid in cracking attempts.
*   **Account Takeover:**  If an attacker can determine enough information about a victim's password hash, they could potentially crack it and gain access to the account.
*   **Sensitive Information Disclosure:** Although the advisory states that only the password column is directly affected, it notes the potential for future expansion of the `user` table to include other sensitive data.

**Attack vectors:**

*   An attacker with a regular or admin user account can exploit this vulnerability.
*   The attack is performed through the user sorting functionality within the EspoCRM interface.

**Required attacker capabilities/position:**

*   The attacker needs to have a valid user account (regular or admin).
*   The attacker needs to be able to access the user management interface.
*   The attacker needs to understand the implications of sorting by password hash.

**Mitigation or fix:**

*   The vulnerability was patched in version 9.0.7 of EspoCRM.
*   The fix likely involves disabling sorting by the `password` field or implementing stricter access controls to prevent unauthorized sorting.
*   The code changes include disabling order functionality and preventing order by the password field. Specifically, changes were made to `application/Espo/Core/Select/Order/Applier.php` and `application/Espo/Resources/metadata/entityDefs/User.json`.
*   A new constant `PASSWORD` was added to `application/Espo/Core/ORM/Type/FieldType.php`.

**Additional Notes:**

*   The advisory explicitly states that the use of Bcrypt with salts mitigates the severity of the vulnerability, as it prevents the attacker from knowing the exact hash value of their own password.
*   The advisory also notes that attempts to obtain other sensitive information (like API keys) were unsuccessful due to access restrictions.
*   The provided screenshots demonstrate the vulnerability and the SQL query confirms the sorting by the password column.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.189 |
| 2 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.188 |
| 3 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | sparse | 0.186 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.183 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.182 |
| 6 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.182 |
| 7 | 1392 | Use of Default Credentials | Base | Allowed | sparse | 0.181 |
| 8 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.181 |
| 9 | 620 | Unverified Password Change | Base | Allowed | dense | 0.493 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-522: Insufficiently Protected Credentials

CWE-328: Use of Weak Hash

CWE-916: Use of Password Hash With Insufficient Computational Effort

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-863: Incorrect Authorization

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-1392: Use of Default Credentials

CWE-287: Improper Authentication

CWE-620: Unverified Password Change

CWE-226: Sensitive Information in Resource Not Removed Before Reuse