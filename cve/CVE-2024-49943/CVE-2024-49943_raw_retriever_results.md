# Raw Retriever Results for CVE-2024-49943

# Raw Retriever Results for CVE-2024-49943
## Query
In the Linux kernel, the following vulnerability has been resolved drm/xe/guc_submit add missing locking in wedged_fini Any non-wedged queue can have a zero refcount here and can be running concurrently with an async queue destroy, therefore dereferencing the queue ptr to check wedge status after the lookup can trigger UAF if queue is not wedged. Fix this by keeping the submission_state lock held around the check to postpone the free and make the check safe, before dropping again around the put() to avoid the deadlock. (cherry picked from commit d28af0b6b9580b9f90c265a7da0315b0ad20bbfd)

## Keyphrases
- **rootcause**: 'missing locking'
- **weakness**: 'use-after-free'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4725 | 0.5652 | 0.5062 | 0.5001 | 20 |
| Sparse | 137.2971 | 1000.0000 | 453.8980 | 422.2890 | 15 |
| Graph | 1.5552 | 2.8652 | 1.8741 | 1.6999 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 2 | 123 | Write-what-where Condition | base | 2.7014 | Allowed |
| 3 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 5 | 416 | Use After Free | Variant | 2.1560 | Allowed |
| 6 | 606 | Unchecked Input for Loop Condition | Base | 1.9294 | Allowed |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | base | 1.8106 | Allowed |
| 8 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7577 | Allowed-with-Review |
| 9 | 833 | Deadlock | Base | 1.7268 | Allowed |
| 10 | 413 | Improper Resource Locking | Base | 1.7151 | Allowed |
| 11 | 134 | Use of Externally-Controlled Format String | base | 1.6848 | Allowed |
| 12 | 170 | Improper Null Termination | base | 1.6848 | Allowed |
| 13 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 14 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 1.6848 | Allowed |
| 15 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 667 | Improper Locking | Class | 0.5652 | 0.5652 | Allowed-with-Review |
| 2 | 833 | Deadlock | Base | 0.5588 | 0.5588 | Allowed |
| 3 | 413 | Improper Resource Locking | Base | 0.5347 | 0.5347 | Allowed |
| 4 | 606 | Unchecked Input for Loop Condition | Base | 0.5344 | 0.5344 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5329 | 0.5329 | Allowed-with-Review |
| 6 | 366 | Race Condition within a Thread | Base | 0.5325 | 0.5325 | Allowed |
| 7 | 911 | Improper Update of Reference Count | Base | 0.5263 | 0.5263 | Allowed |
| 8 | 909 | Missing Initialization of Resource | Class | 0.5230 | 0.5230 | Allowed-with-Review |
| 9 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.5160 | 0.5160 | Allowed |
| 10 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5111 | 0.5111 | Allowed |
| 11 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4891 | 0.4891 | Allowed |
| 12 | 416 | Use After Free | Variant | 0.4816 | 0.4816 | Allowed |
| 13 | 476 | NULL Pointer Dereference | Base | 0.4813 | 0.4813 | Allowed |
| 14 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4803 | 0.4803 | Allowed |
| 15 | 832 | Unlock of a Resource that is not Locked | Base | 0.4795 | 0.4795 | Allowed |

## Sparse Retriever Results (15)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 416 | Use After Free | 1000.0000 | 1000.0000 | Allowed |
| 2 | 667 | Improper Locking | 497.4537 | 497.4537 | Allowed-with-Review |
| 3 | 833 | Deadlock | 486.4321 | 486.4321 | Allowed |
| 4 | 606 | Unchecked Input for Loop Condition | 458.3190 | 458.3190 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 454.7063 | 454.7063 | Allowed-with-Review |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | 450.3480 | 450.3480 | Allowed |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | 446.5932 | 446.5932 | Allowed |
| 8 | 190 | Integer Overflow or Wraparound | 422.2890 | 422.2890 | Allowed |
| 9 | 476 | NULL Pointer Dereference | 420.6504 | 420.6504 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | 412.5193 | 412.5193 | Allowed |
| 11 | 863 | Incorrect Authorization | 412.1419 | 412.1419 | Allowed-with-Review |
| 12 | 415 | Double Free | 406.4991 | 406.4991 | Allowed |
| 13 | 911 | Improper Update of Reference Count | 404.8915 | 404.8915 | Allowed |
| 14 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 398.3288 | 398.3288 | Allowed |
| 15 | 789 | Memory Allocation with Excessive Size Value | 137.2971 | 137.2971 | Allowed |
