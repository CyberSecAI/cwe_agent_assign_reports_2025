## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved KVM arm64 Tear down vGIC on failed vCPU creation If kvm_arch_vcpu_create() fails to share the vCPU page with the hypervisor, we propagate the error back to the ioctl but leave the vGIC vCPU data initialised. Note only does this leak the corresponding memory when the vCPU is destroyed but it can also lead to **use-after-free** if the redistributor device handling tries to walk into the vCPU. Add the missing cleanup to kvm_arch_vcpu_create(), ensuring that the vGIC vCPU structures are destroyed on error.

### Vulnerability Description Key Phrases
- **component:** KVM arm64
- **rootcause:** **use-after-free**
- **product:** Linux kernel
- **impact:** memory leak, use-after-free

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 416 | Use After Free | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.482 |
| 3 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.471 |
| 4 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.468 |
| 5 | 415 | Double Free | Variant | Allowed | sparse | 0.465 |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.461 |
| 7 | 911 | Improper Update of Reference Count | Base | Allowed | sparse | 0.459 |
| 8 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.435 |
| 9 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | Allowed | dense | 0.483 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-416: Use After Free

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-909: Missing Initialization of Resource

CWE-415: Double Free

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-911: Improper Update of Reference Count

CWE-667: Improper Locking

CWE-1342: Information Exposure through Microarchitectural State after Transient Execution

CWE-123: Write-what-where Condition