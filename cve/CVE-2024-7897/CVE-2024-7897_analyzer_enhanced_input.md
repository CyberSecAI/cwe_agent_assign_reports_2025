## Vulnerability Description
A vulnerability classified as critical has been found in Tosei Online Store Management System 4.02/4.03/4.04. This affects an unknown part of the file /cgi-bin/tosei_kikai.php. The manipulation of the argument kikaibangou leads to **command injection**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. NOTE The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Tosei Online Store Management System
- **version:** 4.02/4.03/4.04
- **component:** /cgi-bin/tosei_kikai.php

## CVE Reference Links Content Summary
The provided content describes a code injection vulnerability in Tosei Corporation's TOSEI online store management system (aka TOSEIネット店舗管理システム) versions 4.02, 4.03, and 4.04.

- **Root cause of vulnerability:** The vulnerability is a command injection flaw in the `tosei_kikai.php` file, allowing attackers to bypass internal restrictions.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability.
- **Impact of exploitation:** Authenticated attackers can execute arbitrary commands on the server.
- **Attack vectors:** The vulnerability can be exploited remotely through the `tosei_kikai.php` file.
- **Required attacker capabilities/position:** The attacker needs to be authenticated to exploit this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.528 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.482 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.405 |
| 6 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.402 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.400 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.395 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.601 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-306: Missing Authentication for Critical Function

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-790: Improper Filtering of Special Elements

CWE-494: Download of Code Without Integrity Check