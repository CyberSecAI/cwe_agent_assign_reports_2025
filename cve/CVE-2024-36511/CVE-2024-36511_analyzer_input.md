# Vulnerability Information: CVE-2024-36511

## Vulnerability Description
An **improperly implemented security check for standard vulnerability [CWE-358]** in FortiADC Web Application Firewall (WAF) 7.4.0 through 7.4.4, 7.2 all versions, 7.1 all versions, 7.0 all versions, 6.2 all versions, 6.1 all versions, 6.0 all versions when cookie security policy is enabled may allow an attacker, under specific conditions, to retrieve the initial encrypted and signed cookie protected by the feature

### Vulnerability Description Key Phrases
- **rootcause:** **improperly implemented security check for standard vulnerability [CWE-358]**
- **impact:** retrieve the initial encrypted and signed cookie
- **attacker:** attacker
- **product:** FortiADC Web Application Firewall (WAF)
- **version:** 7.4.0 through 7.4.4, 7.2 all versions, 7.1 all versions, 7.0 all versions, 6.2 all versions, 6.1 all versions, 6.0 all versions
- **component:** cookie security policy

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** An improperly implemented security check for CWE-358 in FortiADC Web Application Firewall (WAF) when the cookie security policy is enabled.
- **Weaknesses/vulnerabilities present:** Cookie security policy bypass, specifically the retrieval of an initial encrypted and signed cookie.
- **Impact of exploitation:** Information disclosure, specifically the ability for an attacker to retrieve the initial encrypted and signed cookie.
- **Attack vectors:** The vulnerability is in the FortiADC Web Application Firewall (WAF) when cookie security policy is enabled. Attackers exploit a bypass in the security check for standard vulnerability CWE-358.
- **Required attacker capabilities/position:** An attacker needs to be in a position to send requests that would normally be processed by the WAF with the cookie security policy enabled, and trigger the bypass. The attacker does not need any special privileges or access to the system.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.389 |
| 2 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.389 |
| 3 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.383 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.374 |
| 5 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.370 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.370 |
| 7 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.365 |
| 8 | 358 | Improperly Implemented Security Check for Standard | Base | Allowed | sparse | 0.355 |
| 9 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | Allowed | dense | 0.669 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

