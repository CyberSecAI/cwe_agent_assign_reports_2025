{
  "cve_id": "CVE-2024-36511",
  "description": "An **improperly implemented security check for standard vulnerability [CWE-358]** in FortiADC Web Application Firewall (WAF) 7.4.0 through 7.4.4, 7.2 all versions, 7.1 all versions, 7.0 all versions, 6.2 all versions, 6.1 all versions, 6.0 all versions when cookie security policy is enabled may allow an attacker, under specific conditions, to retrieve the initial encrypted and signed cookie protected by the feature",
  "key_phrases": {
    "rootcause": "improperly implemented security check for standard vulnerability [CWE-358]",
    "weakness": "",
    "impact": "retrieve the initial encrypted and signed cookie",
    "vector": "",
    "attacker": "attacker",
    "product": "FortiADC Web Application Firewall (WAF)",
    "version": "7.4.0 through 7.4.4, 7.2 all versions, 7.1 all versions, 7.0 all versions, 6.2 all versions, 6.1 all versions, 6.0 all versions",
    "component": "cookie security policy"
  },
  "reference_content": "- **Root cause of vulnerability:** An improperly implemented security check for CWE-358 in FortiADC Web Application Firewall (WAF) when the cookie security policy is enabled.\n- **Weaknesses/vulnerabilities present:** Cookie security policy bypass, specifically the retrieval of an initial encrypted and signed cookie.\n- **Impact of exploitation:** Information disclosure, specifically the ability for an attacker to retrieve the initial encrypted and signed cookie.\n- **Attack vectors:** The vulnerability is in the FortiADC Web Application Firewall (WAF) when cookie security policy is enabled. Attackers exploit a bypass in the security check for standard vulnerability CWE-358.\n- **Required attacker capabilities/position:** An attacker needs to be in a position to send requests that would normally be processed by the WAF with the cookie security policy enabled, and trigger the bypass. The attacker does not need any special privileges or access to the system.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-358 | Improperly Implemented Security Check for Standard | 1.0 | Base | Allowed | Primary CWE. The vulnerability description explicitly states this CWE as the root cause. |\n| CWE-784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | 0.7 | Variant | Allowed | Secondary CWE. The vulnerability allows an attacker to retrieve the initial encrypted and signed cookie, indicating a reliance on cookies without proper validation. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-358, which indicates a problem with the implementation of a security check according to a standard. CWE-784 is a variant that addresses a reliance on cookies without validation in a security decision, which is a more specific case related to the cookie security policy. CWE-358 is a base CWE which is child of CWE-573 (Missing Essential Operational Practices). CWE-784 is a variant CWE which is child of CWE-807 (Reliance on Untrusted Inputs in a Security Decision) and CWE-565 (Reliance on Cookies without Validation and Integrity Checking).\n\n```mermaid\ngraph TD\n    cwe358[\"CWE-358: Improperly Implemented Security Check for Standard\"]\n    cwe784[\"CWE-784: Reliance on Cookies without Validation and Integrity Checking in a Security Decision\"]\n    cwe573[\"CWE-573: Missing Essential Operational Practices\"]\n    cwe807[\"CWE-807: Reliance on Untrusted Inputs in a Security Decision\"]\n    cwe565[\"CWE-565: Reliance on Cookies without Validation and Integrity Checking\"]\n    \n    cwe358 -->|CHILDOF| cwe573\n    cwe784 -->|CHILDOF| cwe807\n    cwe784 -->|CHILDOF| cwe565\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe358 primary\n    class cwe784 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with an **improperly implemented security check [CWE-358]** in the FortiADC Web Application Firewall (WAF). This leads to a bypass of the cookie security policy, allowing an attacker to retrieve the initial encrypted and signed cookie. This can be seen as a reliance on cookies without proper validation and integrity checking **[CWE-784]**. The retrieval of the cookie is the impact, allowing potential further attacks depending on the contents and usage of the cookie.\n\n## Summary of Analysis\nThe primary assessment is based on the explicit statement in the vulnerability description that the root cause is an **improperly implemented security check for standard vulnerability [CWE-358]**. The CVE Reference Links Content Summary section reinforces this by stating: \"Root cause of vulnerability: An improperly implemented security check for CWE-358 in FortiADC Web Application Firewall (WAF) when the cookie security policy is enabled.\" The weakness allows retrieval of signed cookies. Therefore, CWE-784 is included to map to the cookie aspect of the vulnerability.\n\nThe relationship graph influenced the selection by showing how CWE-358 and CWE-784 are related to broader categories of weaknesses.\n\nThe selected CWEs are at the optimal level of specificity because CWE-358 directly addresses the root cause, while CWE-784 specifies the type of data affected by the vulnerability (cookies) and how the security is bypassed (validation and integrity checking).\n\nRelevant CWE Information:\n*   **CWE-358:** Directly stated as the root cause.\n*   **CWE-784:** Captures the aspect of cookie reliance without validation.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-358 | Improperly Implemented Security Check for Standard | 1.0 | Base | Allowed | Primary CWE. The vulnerability description explicitly states this CWE as the root cause. |\n| CWE-784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | 0.7 | Variant | Allowed | Secondary CWE. The vulnerability allows an attacker to retrieve the initial encrypted and signed cookie, indicating a reliance on cookies without proper validation. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-358, which indicates a problem with the implementation of a security check according to a standard. CWE-784 is a variant that addresses a reliance on cookies without validation in a security decision, which is a more specific case related to the cookie security policy. CWE-358 is a base CWE which is child of CWE-573 (Missing Essential Operational Practices). CWE-784 is a variant CWE which is child of CWE-807 (Reliance on Untrusted Inputs in a Security Decision) and CWE-565 (Reliance on Cookies without Validation and Integrity Checking).\n\n```mermaid\ngraph TD\n    cwe358[\"CWE-358: Improperly Implemented Security Check for Standard\"]\n    cwe784[\"CWE-784: Reliance on Cookies without Validation and Integrity Checking in a Security Decision\"]\n    cwe573[\"CWE-573: Missing Essential Operational Practices\"]\n    cwe807[\"CWE-807: Reliance on Untrusted Inputs in a Security Decision\"]\n    cwe565[\"CWE-565: Reliance on Cookies without Validation and Integrity Checking\"]\n    \n    cwe358 -->|CHILDOF| cwe573\n    cwe784 -->|CHILDOF| cwe807\n    cwe784 -->|CHILDOF| cwe565\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe358 primary\n    class cwe784 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with an **improperly implemented security check [CWE-358]** in the FortiADC Web Application Firewall (WAF). This leads to a bypass of the cookie security policy, allowing an attacker to retrieve the initial encrypted and signed cookie. This can be seen as a reliance on cookies without proper validation and integrity checking **[CWE-784]**. The retrieval of the cookie is the impact, allowing potential further attacks depending on the contents and usage of the cookie.\n\n## Summary of Analysis\nThe primary assessment is based on the explicit statement in the vulnerability description that the root cause is an **improperly implemented security check for standard vulnerability [CWE-358]**. The CVE Reference Links Content Summary section reinforces this by stating: \"Root cause of vulnerability: An improperly implemented security check for CWE-358 in FortiADC Web Application Firewall (WAF) when the cookie security policy is enabled.\" The weakness allows retrieval of signed cookies. Therefore, CWE-784 is included to map to the cookie aspect of the vulnerability.\n\nThe relationship graph influenced the selection by showing how CWE-358 and CWE-784 are related to broader categories of weaknesses.\n\nThe selected CWEs are at the optimal level of specificity because CWE-358 directly addresses the root cause, while CWE-784 specifies the type of data affected by the vulnerability (cookies) and how the security is bypassed (validation and integrity checking).\n\nRelevant CWE Information:\n*   **CWE-358:** Directly stated as the root cause.\n*   **CWE-784:** Captures the aspect of cookie reliance without validation.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-565:**\n- 565 (Reliance on Cookies without Validation and Integrity Checking) - ROOT\n\n\n**Chain starting from CWE-784:**\n- 784 (Reliance on Cookies without Validation and Integrity Checking in a Security Decision) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "source": "sparse"
      },
      "similarity": 389.47256911064665
    },
    {
      "metadata": {
        "doc_id": "522",
        "name": "Insufficiently Protected Credentials",
        "source": "sparse"
      },
      "similarity": 388.8970098432515
    },
    {
      "metadata": {
        "doc_id": "668",
        "name": "Exposure of Resource to Wrong Sphere",
        "source": "sparse"
      },
      "similarity": 383.4146087880729
    },
    {
      "metadata": {
        "doc_id": "1390",
        "name": "Weak Authentication",
        "source": "sparse"
      },
      "similarity": 374.43996041490425
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 370.4563595200689
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 369.94506370428576
    },
    {
      "metadata": {
        "doc_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "source": "sparse"
      },
      "similarity": 365.2698065895821
    },
    {
      "metadata": {
        "doc_id": "358",
        "name": "Improperly Implemented Security Check for Standard",
        "source": "sparse"
      },
      "similarity": 355.08953902735993
    },
    {
      "metadata": {
        "doc_id": "784",
        "name": "Reliance on Cookies without Validation and Integrity Checking in a Security Decision",
        "type": "Variant",
        "original_content": "The product uses a protection mechanism that relies on the existence or values of a cookie, but it does not properly ensure that the cookie is valid for the associated user.",
        "keyphrase_source": "rootcause:improperly implemented security check for standard vulnerability [CWE-358]",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.6693122582117477,
            "graph": 1.574470668580751
          }
        }
      },
      "similarity": 0.6693122582117477
    },
    {
      "doc_id": "613",
      "text": "CWE-613: Insufficient Session Expiration",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "613",
        "name": "Insufficient Session Expiration",
        "type": "base",
        "original_content": "CWE-613: Insufficient Session Expiration",
        "relationships": [
          {
            "source_id": "613",
            "target_id": "352",
            "label": "REQUIREDBY",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "613",
            "target_id": "287",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "613",
            "target_id": "672",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "613",
            "target_id": "672",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "672",
            "target_id": "613",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "352",
            "target_id": "613",
            "label": "REQUIRES",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "287",
            "target_id": "613",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "287",
                  "613",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "287"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "287",
                  "613",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "287"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "613",
                  "287",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "287"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-565",
      "CWE-784",
      "CWE-573",
      "CWE-358",
      "CWE-807"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}