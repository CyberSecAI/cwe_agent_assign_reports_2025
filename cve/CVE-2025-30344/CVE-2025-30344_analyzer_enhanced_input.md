## Vulnerability Description
An issue was discovered in OpenSlides before 4.2.5. During login at the /system/auth/login/ endpoint, the systems response times differ depending on whether a user exists in the system. The timing discrepancy stems from the **omitted hashing of the password** (e.g., more than 100 milliseconds).

### Vulnerability Description Key Phrases
- **rootcause:** **omitted hashing of the password**
- **impact:** timing discrepancy
- **product:** OpenSlides
- **version:** before 4.2.5
- **component:** /system/auth/login/

## CVE Reference Links Content Summary
```
**Severity Rating:** Medium
**Vector:** XSS
**CVE:** CVE-2025-30342
**CWE:** 80 - Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)
**CVSS Score:** 5.5
**CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
**Fix:** <https://github.com/OpenSlides/openslides-backend/pull/2903/>

**Analysis:** When submitting descriptions such as Moderator Notes or Agenda Topics to the system, an editor is shown that allows to format the submitted text. This allows to insert various HTML tags, such as `a href`. When trying to insert a `<script>` tag, it gets properly encoded when reflected. But adding attributes to links is possible, which allows the injection of JavaScript by the `onmouseover` tag and others. When a user moves the mouse over such a prepared link, JavaScript will be executed in that userâs session.

**Impact of exploitation:** When a user moves the mouse over such a prepared link, JavaScript will be executed in that userâs session.

**Attack vector:** The XSS can be triggered by authenticated users.

**Required attacker capabilities/position:** Authenticated user.

**Proof of Concept:**
```
POST /system/action/handle_request HTTP/2
Host: localhost:8000
Cookie: refreshId=bearer%20ey...
Content-Length: 256
Sec-Ch-Ua-Platform: "Linux"
Accept-Language: en-US,en;q=0.9
Sec-Ch-Ua: "Chromium";v="133", "Not(A:Brand";v="99"
Authentication: bearer ey...
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Accept: application/json, text/plain, */*
Content-Type: application/json
Ngsw-Bypass: true
Origin: https://localhost:8000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://localhost:8000/1/agenda/topics/1
Accept-Encoding: gzip, deflate, br
Priority: u=1, i

[{"action":"topic.update","data":[{"id":1,"text":"<p>Link with XSS<a target=\"_self\" rel=\"noopener noreferrer nofollow\" href=\"http://www.x41-dsec.de\" onmouseover=\"alert(1
)\">XXXXXXX</a>X</p>","title":"X41 Summer BBQ","attachment_mediafile_ids":[]}]}]
```
```
**Severity Rating:** Medium
**Vector:** Timing Sidechannel
**CVE:** CVE-2025-3034
**CWE:** 208: Observable Timing Discrepancy
**CVSS Score:** 5.3
**CVSS Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
**Fix:** <https://github.com/OpenSlides/openslides-auth-service/pull/686/>

**Analysis:** During login at the endpoint `/system/auth/login/` the systemâs response times differ depending on whether a user exists in the system. The timing discrepancy stems from the omitted hashing of the password. On the tested system, that discrepancy was 15ms for a non-existing user to 200ms for an existing user.

**Root cause of vulnerability:** The timing discrepancy stems from the omitted hashing of the password.

**Weaknesses/vulnerabilities present:** Timing Sidechannel.

**Impact of exploitation:** The timing discrepancy stems from the omitted hashing of the password.

**Required attacker capabilities/position:** The attacker does not need any specific capabilities.

**Proof of Concept:**
As seen in `openslides-auth-service/auth/src/api/services/user-service.ts`, the user password is not hashed and checked when `isExisting()` fails.
```
**Severity Rating:** Low
**Vector:** HTML Injection
**CVE:** CVE-2025-30345
**CWE:** 79 - Improper Neutralization of Input During Web Page Generation
**CVSS Score:** 3.5
**CVSS Vector:** CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N
**Fix:** <https://github.com/OpenSlides/openslides-client/pull/4774/>

**Analysis:** When creating new chats via the `chat_group.create` action, the user is able to specify the name for the chat. Some HTML tags such as `script` are filtered, whereas others are not. In most cases, the HTML entities will be encoded properly, but not when deleting chats or deleting messages in these chats. This allows attackers to mess with the layout of the rendered website.

**Impact of exploitation:** This allows attackers to mess with the layout of the rendered website.

**Proof of Concept:**
Inserting a HTML bold tag in the chat name causes part of the message in the confirmation dialog to be rendered bold.
```
**Severity Rating:** Low
**Vector:** Directory Traversal
**CVE:** CVE-2025-30343
**CWE:** 23 - Relative Path Traversal
**CVSS Score:** 2.6
**CVSS Vector:** CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:L/A:N
**Fix:** <https://github.com/OpenSlides/openslides-client/pull/4775/>

**Analysis:** Files can be uploaded to OpenSlides meetings and organized in folders. The interface allows users to download a ZIP archive that contains all files in a folder and its subfolders. If an attacker specifies the title of a file or folder as a relative or absolute path (e.g. `../../../etc/passwd`), the ZIP archive generated for download will convert that title into a path. Depending on the extraction tool used by the user, this might overwrite files locally outside of the choosen directory.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.314 |
| 2 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.310 |
| 3 | 204 | Observable Response Discrepancy | Base | Allowed | sparse | 0.305 |
| 4 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.286 |
| 5 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | sparse | 0.283 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.277 |
| 7 | 836 | Use of Password Hash Instead of Password for Authentication | Base | Allowed | sparse | 0.265 |
| 8 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.262 |
| 9 | 549 | Missing Password Field Masking | Base | Allowed | dense | 0.455 |
| 10 | 385 | Covert Timing Channel | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-208: Observable Timing Discrepancy

CWE-328: Use of Weak Hash

CWE-204: Observable Response Discrepancy

CWE-203: Observable Discrepancy

CWE-916: Use of Password Hash With Insufficient Computational Effort

CWE-1390: Weak Authentication

CWE-836: Use of Password Hash Instead of Password for Authentication

CWE-259: Use of Hard-coded Password

CWE-549: Missing Password Field Masking

CWE-385: Covert Timing Channel