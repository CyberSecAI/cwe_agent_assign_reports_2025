# Vulnerability Information: CVE-2024-37364

## Vulnerability Description
Ariane Allegro Scenario Player through 2024-03-05, when Ariane Duo kiosk mode is used, allows physically proximate attackers to obtain sensitive information (such as hotel invoice content with PII), and potentially create unauthorized room keys, by entering a guest-search quote character and then accessing the underlying Windows OS.

### Vulnerability Description Key Phrases
- **impact:** obtain sensitive information and create unauthorized room keys
- **vector:** entering a guest-search quote character and then accessing the underlying Windows OS
- **attacker:** physically proximate attackers
- **product:** Ariane Allegro Scenario Player
- **version:** through 2024-03-05
- **component:** Ariane Duo kiosk mode

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-37364:

**Root Cause of Vulnerability:**

The root cause is a software flaw in the Ariane Allegro Scenario Player, a kiosk application used in hotel check-in terminals. Specifically, the application crashes when a single quote character (') is entered into the guest name search field. This crash allows the user to break out of the kiosk mode and access the underlying Windows desktop.

**Weaknesses/Vulnerabilities Present:**

*   **Input Validation Failure:** The application fails to properly handle single quote characters in the guest name input, leading to a crash.
*   **Insufficient Error Handling:** The application's crash is not gracefully handled, leading to a termination and exposing the underlying OS instead of restarting the application or displaying an error message within the kiosk environment.
*   **Inadequate Kiosk Mode Security:** The kiosk mode implementation is insufficient to prevent users from accessing the underlying operating system when the application crashes.

**Impact of Exploitation:**

*   **Kiosk Mode Bypass:** An attacker can bypass the kiosk application and gain access to the Windows desktop.
*   **Access to Sensitive Data:** With access to the desktop, attackers can potentially access personally identifiable information (PII), reservation details, and invoice files stored on the terminal.
*   **Network Access:** The attacker could use the compromised terminal to access the hotel network, potentially leading to further attacks.
*   **Physical Security Compromise:** The attacker could potentially manipulate the system to create room keys for unauthorized access.

**Attack Vectors:**

*   **Physical Access:** The attacker needs physical access to the hotel check-in terminal.
*   **Malicious Input:** The attack is triggered by entering a single quote character (') in the guest name search field.

**Required Attacker Capabilities/Position:**

*   **Physical Presence:** The attacker must be physically present at the check-in terminal.
*   **Basic Interaction:** The attacker needs to interact with the terminal by using the search functionality and understanding that a crash is induced by a single quote character in the guest name field.
*   **Minimal Technical Knowledge:** No advanced technical skills are required to trigger the initial crash and gain access to the Windows desktop. However, knowledge of common Windows attack vectors would be needed to further exploit the situation after gaining access to the desktop.

**Additional Notes:**

*   The vulnerability exists in older versions of the Ariane Allegro Scenario Player, according to the vendor.
*   The vendor, Ariane Systems, initially downplayed the severity of the issue, claiming that no PII or exploitable data could be retrieved, which was later disputed by the researchers due to accessible invoice files on the terminal.
*   The lack of a clear security contact at Ariane Systems made the initial reporting of the vulnerability difficult.
*  The comments on Hacker News suggest that input sanitization and proper error handling were likely not part of the development process.
*  Some comments indicate that the use of a full Windows desktop for kiosk applications is inherently insecure.

This information is more detailed than the official CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1007 | Insufficient Visual Distinction of Homoglyphs Presented to User | Base | Allowed | alternate_terms | 0.700 |
| 2 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | alternate_terms | 0.700 |
| 3 | 1022 | Use of Web Link to Untrusted Target with window.opener Access | Variant | Allowed | alternate_terms | 0.700 |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.065 |
| 5 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.063 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.061 |
| 7 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.060 |
| 8 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.060 |
| 9 | 256 | Plaintext Storage of a Password | Base | Allowed | dense | 0.413 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

