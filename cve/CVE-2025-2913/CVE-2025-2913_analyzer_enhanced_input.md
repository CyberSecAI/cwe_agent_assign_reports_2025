## Vulnerability Description
A vulnerability was found in HDF5 up to 1.14.6. It has been rated as problematic. Affected by this issue is the function H5FL__blk_gc_list of the file src/H5FL.c. The manipulation of the argument H5FL_blk_head_t leads to **use after free**. An attack has to be approached locally. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **use after free**
- **product:** HDF5
- **version:** up to 1.14.6
- **component:** H5FL__blk_gc_list of the file src/H5FL.c

## CVE Reference Links Content Summary
## Analysis of CVE-2025-2913 Content

Based on the provided content, this relates to a vulnerability in HDF5. The CVE description is missing, but the content provides detailed information about a security issue.

**Root cause of vulnerability:**

The vulnerability arises because the `H5FL\_\_blk_gc_list` function in `src/H5FL.c` does not verify if the lists in multiple chunks point to the same block address. This leads to duplicated addresses that have already been freed.

**Weaknesses/vulnerabilities present:**

*   **CWE-416: Use After Free:** The core vulnerability is a heap-use-after-free condition. A memory block is freed, and then the code attempts to access it again.

**Impact of exploitation:**

*   **Application Crash:** The use-after-free leads to an out-of-bounds read and a potential application crash.
*   **Potential for further exploitation:** While not explicitly stated, use-after-free vulnerabilities can potentially be exploited for more severe consequences, such as arbitrary code execution, depending on the memory layout and how the freed memory is reallocated.

**Attack vectors:**

*   Processing specially crafted HDF5 files. The provided PoC demonstrates this by creating a file that triggers the vulnerability when opened and processed.

**Required attacker capabilities/position:**

*   The attacker needs to be able to provide a malicious HDF5 file to the vulnerable application. This could involve file upload capabilities, network access, or physical access to storage.

**Mitigation or fix:**

*   The issue requires a fix in the `H5FL\_\_blk_gc_list` function to properly check for duplicated block addresses before attempting to access freed memory. The issue is labeled as a "Blocker" for the 2.0.0 release, indicating a high priority for fixing.

**Additional Details (more than official CVE description):**

*   **Affected Version:** hdf5 v1.14.6
*   **Reproducibility:** A PoC is provided, including build instructions and a sample file to trigger the vulnerability.
*   **Debugging Information:** The content includes AddressSanitizer (ASan) output, pinpointing the exact location of the vulnerability and the memory operations involved.
*   **Code Snippet:** The vulnerable code section within `H5FL__blk_gc_list` is provided.
*   **Labels:** The issue is labeled with "Security", "Component - C Library", "HDFG-internal", "Priority - 0. Blocker", and "Type - Security".

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.392 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.376 |
| 3 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.346 |
| 4 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.344 |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.343 |
| 6 | 415 | Double Free | Variant | Allowed | sparse | 0.339 |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.338 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.337 |
| 9 | 122 | Heap-based Buffer Overflow | Variant | Allowed | dense | 0.565 |
| 10 | 364 | Signal Handler Race Condition | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-252: Unchecked Return Value

CWE-1241: Use of Predictable Algorithm in Random Number Generator

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-415: Double Free

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-122: Heap-based Buffer Overflow

CWE-364: Signal Handler Race Condition