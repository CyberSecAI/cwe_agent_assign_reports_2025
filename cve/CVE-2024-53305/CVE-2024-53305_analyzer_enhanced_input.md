## Vulnerability Description
An issue in the component /models/config.py of Whoogle search v0.9.0 allows attackers to execute arbitrary code via supplying a crafted search query.

### Vulnerability Description Key Phrases
- **component:** /models/config.py
- **vector:** crafted search query
- **product:** Whoogle search
- **impact:** arbitrary code execution, execute arbitrary code
- **attacker:** attackers
- **version:** v0.9.0

## CVE Reference Links Content Summary
Based on the provided content, this relates to **CVE-2024-53305**. The content provides more detail than the official CVE description.

**Root cause of vulnerability:**

The vulnerability stems from insecure deserialization of data using `pickle` in the `whoogle-search` application, specifically within the `config.py` file.

**Weaknesses/vulnerabilities present:**

*   Insecure deserialization: Using `pickle.loads` to deserialize data received from user input (preferences) is inherently dangerous, as it allows arbitrary code execution.
*   Lack of input validation: The application doesn't properly validate or sanitize the data being deserialized.

**Impact of exploitation:**

Successful exploitation leads to Remote Code Execution (RCE) on the server running the `whoogle-search` application.

**Attack vectors:**

*   The attack vector involves sending a malicious payload through the `preferences` parameter in a search request. The payload is base64 encoded, brotli compressed, and then URL encoded.
*   Specifically, the exploit targets the `app/models/config.py#L265` line, which is where the insecure pickle deserialization occurs.

**Required attacker capabilities/position:**

*   An attacker needs to be able to send HTTP requests to the `whoogle-search` instance. No authentication is required.
*   The attacker needs to craft a malicious pickle payload.

**Mitigation or fix:**

*   The vulnerability was patched in commit [223f00c3c0533423114f99b30c561278bc0b42ba](https://github.com/benbusby/whoogle-search/commit/223f00c3c0533423114f99b30c561278bc0b42ba) by replacing `pickle` with `json` for configuration encoding. This eliminates the risk of arbitrary code execution through deserialization.

**Payload details:**

The provided code snippet includes a Python script (`whoogle.py`) that demonstrates how to construct and send the malicious payload. It defines a class `P` with a `__reduce__` method that executes an arbitrary shell command (`python3 -c '...'`) when deserialized. The payload is then encoded and sent as the value of the `preferences` parameter in a GET request.

**Additional notes:**

*   The content explicitly states that the provided code is an exploit for the RCE vulnerability.
*   The exploit targets a specific server (`[SERVER]`) and port (`[IP]`, `[PORT]`).
*   The exploit uses brotli compression and base64 encoding to obfuscate the payload.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.049 |
| 2 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.045 |
| 3 | 426 | Untrusted Search Path | Base | Allowed | sparse | 0.043 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.043 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.043 |
| 6 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.041 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.041 |
| 8 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.040 |
| 9 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | dense | 0.474 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-427: Uncontrolled Search Path Element

CWE-426: Untrusted Search Path

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-918: Server-Side Request Forgery (SSRF)

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-917: Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')

CWE-202: Exposure of Sensitive Information Through Data Queries

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')