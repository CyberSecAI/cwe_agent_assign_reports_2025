## Vulnerability Description
It was discovered by Elastic engineering that when elasticsearch-certutil CLI tool is used with the csr option in order to create a new Certificate Signing Requests, the associated private key that is generated is stored on disk unencrypted even if the --pass parameter is passed in the command invocation.

### Vulnerability Description Key Phrases
- **impact:** private key stored unencrypted
- **product:** elasticsearch-certutil

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The `elasticsearch-certutil` CLI tool, when used with the `csr` option to create Certificate Signing Requests, generates and stores the associated private key on disk without encryption, even when a passphrase is provided using the `--pass` parameter.
- **Weaknesses/vulnerabilities present:** Private key is stored unencrypted on disk.
- **Impact of exploitation:** An attacker with access to the server can obtain the unencrypted private key, potentially leading to unauthorized access, data breaches, or other security compromises.
- **Attack vectors:** Local access to the server where the `elasticsearch-certutil` tool was used to generate a Certificate Signing Request.
- **Required attacker capabilities/position:** Requires local access with high privileges to the server where the tool was executed and the private key is stored. The CVSS score also notes that a high privileged user is required to conduct the attack.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | sparse | 0.097 |
| 2 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.096 |
| 3 | 214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | sparse | 0.096 |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.092 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.092 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.092 |
| 7 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.091 |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.090 |
| 9 | 1394 | Use of Default Cryptographic Key | Base | Allowed | dense | 0.426 |
| 10 | 523 | Unprotected Transport of Credentials | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-312: Cleartext Storage of Sensitive Information

CWE-522: Insufficiently Protected Credentials

CWE-214: Invocation of Process Using Visible Sensitive Information

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-863: Incorrect Authorization

CWE-138: Improper Neutralization of Special Elements

CWE-295: Improper Certificate Validation

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-1394: Use of Default Cryptographic Key

CWE-523: Unprotected Transport of Credentials