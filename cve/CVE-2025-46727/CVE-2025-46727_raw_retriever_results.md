# Raw Retriever Results for CVE-2025-46727

# Raw Retriever Results for CVE-2025-46727
## Query
Rack is a modular Ruby web server interface. Prior to versions 2.2.14, 3.0.16, and 3.1.14, `RackQueryParser` parses query strings and `application/x-www-form-urlencoded` bodies into Ruby data structures without imposing any limit on the number of parameters, allowing attackers to send requests with extremely large numbers of parameters. The vulnerability arises because `RackQueryParser` iterates over each `&`-separated key-value pair and adds it to a Hash without enforcing an upper bound on the total number of parameters. This allows an attacker to send a single request containing hundreds of thousands (or more) of parameters, which consumes excessive memory and CPU during parsing. An attacker can trigger denial of service by sending specifically crafted HTTP requests, which can cause memory exhaustion or pin CPU resources, stalling or crashing the Rack server. This results in full service disruption until the affected worker is restarted. Versions 2.2.14, 3.0.16, and 3.1.14 fix the issue. Some other mitigations are available. One may use middleware to enforce a maximum query string size or parameter count, or employ a reverse proxy (such as Nginx) to limit request sizes and reject oversized query strings or bodies. Limiting request body sizes and query string lengths at the web server or CDN level is an effective mitigation.

## Keyphrases
- **weakness**: 'parsing query strings', 'bodies without limit on the number of parameters'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4436 | 0.5162 | 0.4797 | 0.4768 | 20 |
| Sparse | 902.2824 | 1106.0143 | 1001.9307 | 986.8110 | 11 |
| Graph | 1.3010 | 2.9270 | 1.7953 | 1.6792 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 789 | Memory Allocation with Excessive Size Value | Variant | 2.9270 | Allowed |
| 2 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 2.8488 | Allowed |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.7836 | Allowed |
| 4 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 5 | 129 | Improper Validation of Array Index | variant | 2.0400 | Allowed |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 7 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 8 | 823 | Use of Out-of-range Pointer Offset | base | 1.7680 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | 1.6958 | Allowed |
| 10 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 11 | 20 | Improper Input Validation | class | 1.6736 | Discouraged |
| 12 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | 1.6556 | Allowed |
| 13 | 1333 | Inefficient Regular Expression Complexity | Base | 1.6041 | Allowed |
| 14 | 410 | Insufficient Resource Pool | Base | 1.5402 | Allowed |
| 15 | 125 | Out-of-bounds Read | base | 1.3676 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5162 | 0.5162 | Allowed |
| 2 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | 0.5130 | 0.5130 | Allowed |
| 3 | 1333 | Inefficient Regular Expression Complexity | Base | 0.5101 | 0.5101 | Allowed |
| 4 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.5100 | 0.5100 | Allowed |
| 5 | 598 | Use of GET Request Method With Sensitive Query Strings | Variant | 0.5011 | 0.5011 | Allowed |
| 6 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.4997 | 0.4997 | Allowed |
| 7 | 410 | Insufficient Resource Pool | Base | 0.4995 | 0.4995 | Allowed |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4985 | 0.4985 | Allowed |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4919 | 0.4919 | Allowed |
| 10 | 130 | Improper Handling of Length Parameter Inconsistency | Base | 0.4845 | 0.4845 | Allowed |
| 11 | 674 | Uncontrolled Recursion | Class | 0.4691 | 0.4691 | Allowed-with-Review |
| 12 | 407 | Inefficient Algorithmic Complexity | Class | 0.4629 | 0.4629 | Allowed-with-Review |
| 13 | 234 | Failure to Handle Missing Parameter | Variant | 0.4623 | 0.4623 | Discouraged |
| 14 | 400 | Uncontrolled Resource Consumption | Class | 0.4607 | 0.4607 | Discouraged |
| 15 | 307 | Improper Restriction of Excessive Authentication Attempts | Base | 0.4598 | 0.4598 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | 1106.0143 | 1106.0143 | Allowed |
| 2 | 400 | Uncontrolled Resource Consumption | 1076.6826 | 1076.6826 | Discouraged |
| 3 | 1333 | Inefficient Regular Expression Complexity | 1056.7055 | 1056.7055 | Allowed |
| 4 | 789 | Memory Allocation with Excessive Size Value | 1045.6719 | 1045.6719 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 1044.5838 | 1044.5838 | Allowed |
| 6 | 20 | Improper Input Validation | 986.8110 | 986.8110 | Discouraged |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | 980.3485 | 980.3485 | Allowed |
| 8 | 190 | Integer Overflow or Wraparound | 946.5916 | 946.5916 | Allowed |
| 9 | 863 | Incorrect Authorization | 938.6370 | 938.6370 | Allowed-with-Review |
| 10 | 306 | Missing Authentication for Critical Function | 936.9088 | 936.9088 | Allowed |
| 11 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | 902.2824 | 902.2824 | Allowed |
