## Vulnerability Description
Tenda FH451 v1.0.0.9 has a **command injection** vulnerability in the formexeCommand function i

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Tenda FH451
- **version:** v1.0.0.9
- **component:** formexeCommand function

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The root cause is the lack of sanitization or proper input validation of the `cmdinput` parameter in the `formexeCommand` function. The user-provided input is directly assigned to a `cmd_buf` variable. This variable is then passed to the `doSystemCmd` function. This allows for the execution of arbitrary system commands due to the user-controlled input not being sanitized.

**Weaknesses/Vulnerabilities:**

*   **Command Injection:** The primary vulnerability is a command injection flaw. The application directly incorporates user-provided data into a system command without proper sanitization.
*   **Lack of Input Validation:** The code fails to validate or sanitize the `cmdinput` parameter before using it in the `doSystemCmd` function, which is used to execute the command.

**Impact of Exploitation:**

*   **Arbitrary Command Execution:** A successful exploit allows an attacker to execute arbitrary system commands on the target device with the privileges of the process running the vulnerable service.
*   **Full System Compromise:** An attacker could potentially gain full control of the device, install malware, steal data, or disrupt services.

**Attack Vectors:**

*   **HTTP POST Request:** The attack vector is through sending a crafted HTTP POST request to the `/goform/exeCommand` endpoint.
*   **`cmdinput` Parameter:** The malicious command is injected through the `cmdinput` parameter in the POST request data.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the Tenda FH451 router's web interface. This could be through the local network, or, if the router's web interface is exposed to the internet, remotely.
*   **HTTP Request Skills:**  The attacker needs to be able to construct and send HTTP POST requests.
*   **Knowledge of Vulnerable Endpoint:** The attacker needs to know the vulnerable endpoint (`/goform/exeCommand`) and the parameter name (`cmdinput`).

**Additional Notes:**

*   The provided POC demonstrates how to inject the `ls` command, which lists the files and directories of the current working directory, but any other commands could be executed through this vulnerability.
*   The affected firmware version is Tenda FH451 V1.0.0.9.
*   The `doSystemCmd` function takes the `cmd_buf` variable as input and passes the string directly to the system's command execution mechanism.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.103 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.099 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.096 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.094 |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.093 |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.092 |
| 9 | 134 | Use of Externally-Controlled Format String | Base | Allowed | dense | 0.527 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-790: Improper Filtering of Special Elements

CWE-121: Stack-based Buffer Overflow

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-138: Improper Neutralization of Special Elements

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-134: Use of Externally-Controlled Format String

CWE-123: Write-what-where Condition