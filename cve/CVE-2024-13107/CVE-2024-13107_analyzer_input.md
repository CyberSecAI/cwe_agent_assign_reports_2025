# Vulnerability Information: CVE-2024-13107

## Vulnerability Description
A vulnerability was found in D-Link DIR-816 A2 1.10CNB05_R1B011D88210. It has been classified as critical. This affects an unknown part of the file /goform/form2LocalAclEditcfg.cgi of the component ACL Handler. The manipulation leads to **improper access controls**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access controls**
- **product:** D-Link DIR-816 A2
- **version:** 1.10CNB05_R1B011D88210
- **component:** ACL Handler

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

*   The root cause is an **improper access control vulnerability** within the D-Link DIR-816A2 router's web management interface. Specifically, the `form2LocalAclEditcfg.cgi` handler is accessible without requiring authentication.

**Weaknesses/vulnerabilities present:**

*   **Unauthenticated access:** The `form2LocalAclEditcfg.cgi` endpoint, which manages the local access control list (ACL), does not require authentication. This allows unauthorized users to send requests to this endpoint.
*   **Lack of authorization checks:** The device fails to properly verify the user's permissions before allowing them to modify the local access control list.
*   **CGI Endpoint Exposure:** The `goform` endpoint along with the `form2LocalAclEditcfg.cgi` handler are directly exposed.

**Impact of exploitation:**

*   An attacker can **modify the device's local access control list (ACL)**. This can lead to several consequences including but not limited to:
    *   **Denial of service (DoS):** By blocking legitimate traffic.
    *   **Network access manipulation:** Allowing or denying access to specific devices or services within the network.
    *   **Potential for further compromise:**  Changing the access list could be a stepping stone for more significant attacks.

**Attack vectors:**

*   **HTTP POST Request:** The vulnerability is exploited by sending a specially crafted, unauthenticated HTTP POST request to the `goform` endpoint.
*   **`form2LocalAclEditcfg.cgi` header:** The `form2LocalAclEditcfg.cgi` header must be included in the POST request to target the vulnerable functionality.

**Required attacker capabilities/position:**

*   **Network proximity:** The attacker needs to be on the same network as the vulnerable router or have network access to it.
*   **HTTP Communication:** The attacker needs the ability to send HTTP POST requests.
*   **No authentication required:** The attacker does not require any credentials to exploit the vulnerability, as it is an unauthenticated access issue.

**Additional details from the provided content:**

*   **Affected firmware version:** DIR-816A2\_FWv1.10CNB05\_R1B011D88210.
*   **Proof of Concept (POC):** The GitHub document includes screenshots demonstrating the exploitation process, highlighting the vulnerable POST request and the configuration change.
*   **Vulnerable endpoint:** The `goform` endpoint handling `form2LocalAclEditcfg.cgi` requests.

This content provides more specific details than the CVE description which is a placeholder.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.455 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.425 |
| 3 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.376 |
| 4 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.375 |
| 5 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.369 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.366 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.358 |
| 8 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.356 |
| 9 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | dense | 0.622 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

