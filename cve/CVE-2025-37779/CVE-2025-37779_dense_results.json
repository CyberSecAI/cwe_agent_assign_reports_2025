{
  "query": "In the Linux kernel, the following vulnerability has been resolved lib/iov_iter fix to increase non slab folio refcount When testing EROFS file-backed mount over v9fs on qemu, I encountered a folio UAF issue. The page sanity check reports the following call trace. The root cause is that pages in bvec are coalesced across a folio bounary. The refcount of all non-slab folios should be increased to ensure p9_releas_pages can put them correctly. BUG Bad page state in process md5sum pfn18300 page refcount0 mapcount0 mapping00000000d5ad8e4e index0x60 pfn0x18300 head order0 mapcount0 entire_mapcount0 nr_pages_mapped0 pincount0 aopsz_erofs_aops ino30b0f dentry name(?)GoogleExtServicesCn.apk flags 0x100000000000041(locked|head|node=0|zone=1) raw 0100000000000041 dead000000000100 dead000000000122 ffff888014b13bd0 raw 0000000000000060 0000000000000020 00000000ffffffff 0000000000000000 head 0100000000000041 dead000000000100 dead000000000122 ffff888014b13bd0 head 0000000000000060 0000000000000020 00000000ffffffff 0000000000000000 head 0100000000000000 0000000000000000 ffffffffffffffff 0000000000000000 head 0000000000000010 0000000000000000 00000000ffffffff 0000000000000000 page dumped because PAGE_FLAGS_CHECK_AT_FREE flag(s) set Call Trace dump_stack_lvl+0x53/0x70 bad_page+0xd4/0x220 __free_pages_ok+0x76d/0xf30 __folio_put+0x230/0x320 p9_release_pages+0x179/0x1f0 p9_virtio_zc_request+0xa2a/0x1230 p9_client_zc_rpc.constprop.0+0x247/0x700 p9_client_read_once+0x34d/0x810 p9_client_read+0xf3/0x150 v9fs_issue_read+0x111/0x360 netfs_unbuffered_read_iter_locked+0x927/0x1390 netfs_unbuffered_read_iter+0xa2/0xe0 vfs_iocb_iter_read+0x2c7/0x460 erofs_fileio_rq_submit+0x46b/0x5b0 z_erofs_runqueue+0x1203/0x21e0 z_erofs_readahead+0x579/0x8b0 read_pages+0x19f/0xa70 page_cache_ra_order+0x4ad/0xb80 filemap_readahead.isra.0+0xe7/0x150 filemap_get_pages+0x7aa/0x1890 filemap_read+0x320/0xc80 vfs_read+0x6c6/0xa30 ksys_read+0xf9/0x1c0 do_syscall_64+0x9e/0x1a0 entry_SYSCALL_64_after_hwframe+0x71/0x79",
  "count": 20,
  "results": [
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "abstraction": "Class",
      "score": 0.5429495411285347,
      "original_score": 0.5429495411285347,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 0.5257997531588507,
      "original_score": 0.5257997531588507,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 0.5241068498579031,
      "original_score": 0.5241068498579031,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "score": 0.5132661670409344,
      "original_score": 0.5132661670409344,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "911",
      "name": "Improper Update of Reference Count",
      "abstraction": "Base",
      "score": 0.508763515738551,
      "original_score": 0.508763515738551,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "416",
      "name": "Use After Free",
      "abstraction": "Variant",
      "score": 0.49888902132122326,
      "original_score": 0.49888902132122326,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "908",
      "name": "Use of Uninitialized Resource",
      "abstraction": "Base",
      "score": 0.49610238148411934,
      "original_score": 0.49610238148411934,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "126",
      "name": "Buffer Over-read",
      "abstraction": "Variant",
      "score": 0.4956952851788057,
      "original_score": 0.4956952851788057,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "abstraction": "Base",
      "score": 0.49530607814070127,
      "original_score": 0.49530607814070127,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "190",
      "name": "Integer Overflow or Wraparound",
      "abstraction": "Base",
      "score": 0.4916239365600804,
      "original_score": 0.4916239365600804,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "abstraction": "Base",
      "score": 0.48577737948931343,
      "original_score": 0.48577737948931343,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "abstraction": "Base",
      "score": 0.48467188574383957,
      "original_score": 0.48467188574383957,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "404",
      "name": "Improper Resource Shutdown or Release",
      "abstraction": "Class",
      "score": 0.4841704071721709,
      "original_score": 0.4841704071721709,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "763",
      "name": "Release of Invalid Pointer or Reference",
      "abstraction": "Base",
      "score": 0.48348831117305213,
      "original_score": 0.48348831117305213,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "122",
      "name": "Heap-based Buffer Overflow",
      "abstraction": "Variant",
      "score": 0.48253952095364483,
      "original_score": 0.48253952095364483,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "abstraction": "Base",
      "score": 0.4820285651308721,
      "original_score": 0.4820285651308721,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "131",
      "name": "Incorrect Calculation of Buffer Size",
      "abstraction": "Base",
      "score": 0.48184630576843557,
      "original_score": 0.48184630576843557,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1342",
      "name": "Information Exposure through Microarchitectural State after Transient Execution",
      "abstraction": "Base",
      "score": 0.4785628325741554,
      "original_score": 0.4785628325741554,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "score": 0.4772280371963109,
      "original_score": 0.4772280371963109,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 0.47541131478444787,
      "original_score": 0.47541131478444787,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.47541131478444787,
    "max": 0.5429495411285347,
    "mean": 0.49541135447979734,
    "median": 0.4887006580246969,
    "count": 20
  }
}