# Raw Retriever Results for CVE-2025-22086

# Raw Retriever Results for CVE-2025-22086
## Query
In the Linux kernel, the following vulnerability has been resolved RDMA/mlx5 Fix mlx5_poll_one() cur_qp update flow When cur_qp isnt NULL, in order to avoid fetching the QP from the radix tree again we check if the next cqe QP is identical to the one we already have. The bug however is that we are checking if the QP is identical by checking the QP number inside the CQE against the QP number inside the mlx5_ib_qp, but thats wrong since the QP number from the CQE is from FW so it should be matched against mlx5_core_qp which is our FW QP number. Otherwise we could use the wrong QP when handling a CQE which could cause the kernel trace below. This issue is mainly noticeable over QPs 0 & 1, since for now they are the only QPs in our driver whereas the QP number inside mlx5_ib_qp doesnt match the QP number inside mlx5_core_qp.

## Keyphrases
- **weakness**: 'QP number mismatch'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4559 | 0.5312 | 0.4786 | 0.4762 | 20 |
| Sparse | 209.0696 | 703.9621 | 577.7393 | 599.3261 | 11 |
| Graph | 1.5324 | 2.8210 | 2.0269 | 2.1083 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 125 | Out-of-bounds Read | base | 2.8210 | Allowed |
| 2 | 476 | NULL Pointer Dereference | Base | 2.5364 | Allowed |
| 3 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 4 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 5 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 6 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 7 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 8 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 9 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 10 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | base | 2.1190 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.0976 | Allowed |
| 12 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 13 | 787 | Out-of-bounds Write | base | 1.7680 | Allowed |
| 14 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 15 | 826 | Premature Release of Resource During Expected Lifetime | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5312 | 0.5312 | Allowed |
| 2 | 413 | Improper Resource Locking | Base | 0.5080 | 0.5080 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5002 | 0.5002 | Allowed-with-Review |
| 4 | 696 | Incorrect Behavior Order | Class | 0.4944 | 0.4944 | Allowed-with-Review |
| 5 | 911 | Improper Update of Reference Count | Base | 0.4912 | 0.4912 | Allowed |
| 6 | 606 | Unchecked Input for Loop Condition | Base | 0.4902 | 0.4902 | Allowed |
| 7 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4896 | 0.4896 | Allowed |
| 8 | 822 | Untrusted Pointer Dereference | Base | 0.4886 | 0.4886 | Allowed |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4883 | 0.4883 | Allowed |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4873 | 0.4873 | Allowed-with-Review |
| 11 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4651 | 0.4651 | Allowed |
| 12 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4638 | 0.4638 | Allowed |
| 13 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4617 | 0.4617 | Allowed |
| 14 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4604 | 0.4604 | Allowed |
| 15 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4598 | 0.4598 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 703.9621 | 703.9621 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | 648.9216 | 648.9216 | Allowed |
| 3 | 476 | NULL Pointer Dereference | 615.9973 | 615.9973 | Allowed |
| 4 | 125 | Out-of-bounds Read | 610.0122 | 610.0122 | Allowed |
| 5 | 130 | Improper Handling of Length Parameter Inconsistency | 600.8313 | 600.8313 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | 599.3261 | 599.3261 | Allowed |
| 7 | 863 | Incorrect Authorization | 599.0712 | 599.0712 | Allowed-with-Review |
| 8 | 824 | Access of Uninitialized Pointer | 592.8891 | 592.8891 | Allowed |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 588.3919 | 588.3919 | Allowed |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | 586.6597 | 586.6597 | Allowed |
| 11 | 1333 | Inefficient Regular Expression Complexity | 209.0696 | 209.0696 | Allowed |
