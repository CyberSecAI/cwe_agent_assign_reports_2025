## Vulnerability Description
Exposure of Sensitive Information to an Unauthorized Actor vulnerability in Wikimedia Foundation MediaWiki. This vulnerability is associated with program files includes/logging/LogPager.Php. This issue affects MediaWiki before 1.39.12, 1.42.6, 1.43.1.

### Vulnerability Description Key Phrases
- **impact:** Exposure of Sensitive Information to an Unauthorized Actor
- **product:** MediaWiki
- **version:** before 1.39.12, 1.42.6, 1.43.1
- **component:** program files includes/logging/LogPager.Php

## CVE Reference Links Content Summary
## CVE-2025-32698 Analysis

This content is **RELEVANT** to CVE-2025-32698. It provides detailed information about the vulnerability, its root cause, and the fix.

**Root cause of vulnerability:**

The vulnerability stems from an incorrect condition in `LogPager.php` within the `enforceActionRestrictions()` and `enforcePerformerRestrictions()` functions. Specifically, the code incorrectly compares the result of a bitwise AND operation against `LogPage::SUPPRESSED_USER` instead of `LogPage::SUPPRESSED_ACTION` (and vice versa in the other function). This allows users with `deletedhistory` rights (but *not* suppression rights) to view suppressed log entries.

**Weaknesses/vulnerabilities present:**

*   **Incorrect Access Control:**  The flawed logic in the restriction enforcement functions allows unauthorized access to suppressed log data.
*   **Logic Error:** A simple comparison error in the bitwise AND operation leads to the vulnerability.

**Impact of exploitation:**

Exploitation allows users with `deletedhistory` rights to view suppressed usernames or page titles in log entries, revealing information that should be hidden from them. While not a severe issue in practice (requiring knowledge or brute-forcing of suppressed data), it represents an information leak.

**Attack vectors:**

*   An attacker with `deletedhistory` rights can navigate to Special:Log and view suppressed log entries.
*   The attacker needs to know or guess a suppressed username or page title to confirm the leak.

**Required attacker capabilities/position:**

*   The attacker must have a user account with `deletedhistory` rights within the MediaWiki installation.

**Mitigation or fix:**

The fix involves swapping `LogPage::SUPPRESSED_USER` and `LogPage::SUPPRESSED_ACTION` in the incorrect comparison within the `enforceActionRestrictions()` and `enforcePerformerRestrictions()` functions of `LogPager.php`.  The patch is available as:

*   [F58387290: 0001-SECURITY-Fix-log-entry-search-revealing-suppressed-d.patch](https://phab.wmfusercontent.org/file/download/b3c5o5ndb6rglq6jev6j/PHID-FILE-3k6t3aunnxwps47ufx4g/0001-SECURITY-Fix-log-entry-search-revealing-suppressed-d.patch)

The patch has been merged into the following branches:

*   `master`
*   `REL1_39`
*   `REL1_42`
*   `REL1_43`

**Additional Details (more than official CVE description):**

*   The issue was introduced in commit [60aa90500668](https://gerrit.wikimedia.org/r/60aa90500668) and related to a previous security fix (T188145).
*   The vulnerability affects MediaWiki versions since 1.31.
*   The fix has been deployed as of February 24, 2025.
*   The task was made public on April 21, 2025, following the security release announcement.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.064 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.063 |
| 3 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.059 |
| 4 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.057 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.055 |
| 6 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.054 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.054 |
| 8 | 497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | Base | Allowed | sparse | 0.054 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.554 |
| 10 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-532: Insertion of Sensitive Information into Log File

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-863: Incorrect Authorization

CWE-918: Server-Side Request Forgery (SSRF)

CWE-306: Missing Authentication for Critical Function

CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-202: Exposure of Sensitive Information Through Data Queries