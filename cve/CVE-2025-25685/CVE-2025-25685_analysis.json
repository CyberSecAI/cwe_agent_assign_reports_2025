{
  "cve_id": "CVE-2025-25685",
  "description": "An issue was discovered in GL-INet Beryl AX GL-MT3000 v4.7.0. Attackers are able to download arbitrary files from the devices file system via adding symbolic links on an external drive used as a samba share.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "download arbitrary files",
    "vector": "adding symbolic links on samba share",
    "attacker": "Attackers",
    "product": "GL-INet Beryl AX GL-MT3000",
    "version": "v4.7.0",
    "component": ""
  },
  "reference_content": "## Analysis of CVE-2025-25685 Content\n\nThis content **relates** to CVE-2025-25685. It provides more detail than the official CVE description (which is currently a placeholder).\n\n**Root cause of vulnerability:**\n\nThe vulnerability stems from the lack of validation when handling symlinks within the Samba share accessed through the GL-MT300 router's mobile app.\n\n**Weaknesses/vulnerabilities present:**\n\n*   **Arbitrary File Read:** The ability to read arbitrary files on the router by leveraging symlinks.\n*   **Unvalidated Input:** The router doesn't properly sanitize or validate file paths when accessed via the Samba share.\n\n**Impact of exploitation:**\n\nAn attacker can read sensitive files from the router, such as `/etc/passwd`, potentially gaining access to user credentials and other system information.\n\n**Attack vectors:**\n\n1.  Create a directory on an ext4 USB device.\n2.  Create a symbolic link within that directory pointing to a sensitive file (e.g., `/etc/passwd`).\n3.  Plug the USB device into the router.\n4.  Create a Samba share for the directory on the router's admin panel.\n5.  Access the Samba share via the GL-MT300 mobile app and save the symbolic link file to a mobile device.\n6.  Use `adb shell` (Android Debug Bridge) to access the file on the mobile device, which resolves the symlink and reveals the contents of the target file on the router.\n\n**Required attacker capabilities/position:**\n\n*   Physical access to the router to plug in the USB device.\n*   Access to the router's admin panel to create the Samba share.\n*   Access to the GL-MT300 mobile app.\n*   Android device with USB debugging enabled and `adb` access from a computer.\n*   Knowledge of Linux commands (e.g., `ln -s`, `find`, `cat`).\n\n**Mitigation or fix:**\n\nThe article does not explicitly state a fix, but implies that proper validation of file paths and handling of symlinks within the Samba share is required. The author notes that adding `\"unix extensions = yes\"` and `\"wide links = yes\"` to the router\u2019s `smb.conf` would *enable* symlink creation, which is undesirable.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.9 | Base | Allowed | Primary CWE. The **improper link resolution** is the root cause.|\n| CWE-73 | External Control of File Name or Path | 0.7 | Base | Allowed | Secondary CWE. The filename is influenced by the attacker. |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.6 | Base | Allowed | Secondary CWE. The symlink can resolve outside the restricted directory. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is the **improper link resolution** which allows an attacker to access unintended resources. CWE-59 is the root cause. CWE-73 and CWE-22 are related as they involve external control of file paths and path traversal respectively. They are secondary issues contributing to the exploitability of the main weakness. The abstraction levels are all Base, providing good specificity.\n\n```mermaid\ngraph TD\n    cwe59[\"CWE-59: Improper Link Resolution Before File Access ('Link Following')\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n    \n    cwe73 -->|CANFOLLOW| cwe59\n    cwe22 -->|CANFOLLOW| cwe59\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe59 primary\n    class cwe73,cwe22 secondary\n```\n\n## Vulnerability Chain\n1.  Attacker controlled input (filename/path via symlink)\n2.  **Improper Link Resolution** (CWE-59)\n3.  Access to arbitrary files\n\nThe root cause is the **improper link resolution**.\n\n## Summary of Analysis\nThe analysis is based on the CVE description and referenced content summary. The core issue is the lack of validation when handling symlinks, leading to arbitrary file access. The selection of CWE-59 as the primary weakness is based on the fact that the router does not properly prevent the filename from identifying a link that resolves to an unintended resource. This is directly supported by the \"Weaknesses/vulnerabilities present\" section in the CVE Reference Links Content Summary: \"*Arbitrary File Read: The ability to read arbitrary files on the router by leveraging symlinks.*\" and \"*Unvalidated Input: The router doesn't properly sanitize or validate file paths when accessed via the Samba share.*\"\n\nCWE-73 is a secondary CWE because the attacker can control the filename or path by creating the symbolic link with a specific target. The `External Control of File Name or Path` allows the attacker to influence the file system operations.\nCWE-22 is added as another secondary CWE, as the symbolic link can lead to accessing files outside of the intended restricted directory. The `Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')` occurs when the symlink resolves to a location outside the intended directory.\n\nOther CWEs Considered:\n\n*   CWE-61 (UNIX Symbolic Link (Symlink) Following): While related, CWE-61 is a compound weakness. CWE-59 is more specific to the **improper link resolution**.\n*   CWE-23 (Relative Path Traversal): This is similar to CWE-22, but less specific as the vulnerability isn't necessarily about relative paths.\n*   CWE-78 (Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')): This is not relevant as the vulnerability doesn't involve OS command injection.\n*   CWE-425 (Direct Request ('Forced Browsing')): Not relevant as the vulnerability doesn't involve bypassing authorization to access restricted URLs.",
  "analysis_with_relationships": "# Summary\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.9 | Base | Allowed | Primary CWE. The **improper link resolution** is the root cause.|\n| CWE-73 | External Control of File Name or Path | 0.7 | Base | Allowed | Secondary CWE. The filename is influenced by the attacker. |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.6 | Base | Allowed | Secondary CWE. The symlink can resolve outside the restricted directory. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is the **improper link resolution** which allows an attacker to access unintended resources. CWE-59 is the root cause. CWE-73 and CWE-22 are related as they involve external control of file paths and path traversal respectively. They are secondary issues contributing to the exploitability of the main weakness. The abstraction levels are all Base, providing good specificity.\n\n```mermaid\ngraph TD\n    cwe59[\"CWE-59: Improper Link Resolution Before File Access ('Link Following')\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\n    \n    cwe73 -->|CANFOLLOW| cwe59\n    cwe22 -->|CANFOLLOW| cwe59\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe59 primary\n    class cwe73,cwe22 secondary\n```\n\n## Vulnerability Chain\n1.  Attacker controlled input (filename/path via symlink)\n2.  **Improper Link Resolution** (CWE-59)\n3.  Access to arbitrary files\n\nThe root cause is the **improper link resolution**.\n\n## Summary of Analysis\nThe analysis is based on the CVE description and referenced content summary. The core issue is the lack of validation when handling symlinks, leading to arbitrary file access. The selection of CWE-59 as the primary weakness is based on the fact that the router does not properly prevent the filename from identifying a link that resolves to an unintended resource. This is directly supported by the \"Weaknesses/vulnerabilities present\" section in the CVE Reference Links Content Summary: \"*Arbitrary File Read: The ability to read arbitrary files on the router by leveraging symlinks.*\" and \"*Unvalidated Input: The router doesn't properly sanitize or validate file paths when accessed via the Samba share.*\"\n\nCWE-73 is a secondary CWE because the attacker can control the filename or path by creating the symbolic link with a specific target. The `External Control of File Name or Path` allows the attacker to influence the file system operations.\nCWE-22 is added as another secondary CWE, as the symbolic link can lead to accessing files outside of the intended restricted directory. The `Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')` occurs when the symlink resolves to a location outside the intended directory.\n\nOther CWEs Considered:\n\n*   CWE-61 (UNIX Symbolic Link (Symlink) Following): While related, CWE-61 is a compound weakness. CWE-59 is more specific to the **improper link resolution**.\n*   CWE-23 (Relative Path Traversal): This is similar to CWE-22, but less specific as the vulnerability isn't necessarily about relative paths.\n*   CWE-78 (Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')): This is not relevant as the vulnerability doesn't involve OS command injection.\n*   CWE-425 (Direct Request ('Forced Browsing')): Not relevant as the vulnerability doesn't involve bypassing authorization to access restricted URLs.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-22:**\n- 22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) - ROOT\n\n\n**Chain starting from CWE-59:**\n- 59 (Improper Link Resolution Before File Access ('Link Following')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "source": "sparse"
      },
      "similarity": 72.84850391762308
    },
    {
      "metadata": {
        "doc_id": "59",
        "name": "Improper Link Resolution Before File Access ('Link Following')",
        "source": "sparse"
      },
      "similarity": 66.32535207872587
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 59.92113538736435
    },
    {
      "metadata": {
        "doc_id": "138",
        "name": "Improper Neutralization of Special Elements",
        "source": "sparse"
      },
      "similarity": 57.530674956300324
    },
    {
      "metadata": {
        "doc_id": "345",
        "name": "Insufficient Verification of Data Authenticity",
        "source": "sparse"
      },
      "similarity": 57.33994944997743
    },
    {
      "metadata": {
        "doc_id": "259",
        "name": "Use of Hard-coded Password",
        "source": "sparse"
      },
      "similarity": 57.0547841727859
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "source": "sparse"
      },
      "similarity": 56.6206777403646
    },
    {
      "metadata": {
        "doc_id": "94",
        "name": "Improper Control of Generation of Code ('Code Injection')",
        "source": "sparse"
      },
      "similarity": 55.7670930998742
    },
    {
      "metadata": {
        "doc_id": "121",
        "name": "Stack-based Buffer Overflow",
        "type": "Variant",
        "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5955417022935636
          }
        }
      },
      "similarity": 0.5955417022935636
    },
    {
      "doc_id": "184",
      "text": "CWE-184: Incomplete List of Disallowed Inputs",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "184",
        "name": "Incomplete List of Disallowed Inputs",
        "type": "base",
        "original_content": "CWE-184: Incomplete List of Disallowed Inputs",
        "relationships": [
          {
            "source_id": "184",
            "target_id": "692",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "78",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "79",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "1023",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "693",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "86",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "78",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "693",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "STARTSWITH",
            "properties": {
              "view_id": "709"
            }
          },
          {
            "source_id": "625",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "186",
            "target_id": "184",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1023",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "78",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "78"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "78",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "78"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "184",
                  "78",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "78"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-22",
      "CWE-59",
      "CWE-73",
      "CWE-78",
      "CWE-425",
      "CWE-23",
      "CWE-61"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}