# Vulnerability Information: CVE-2024-52593

## Vulnerability Description
Misskey is an open source, federated social media platform.In affected versions **missing validation** in `NoteCreateService.insertNote`, `ApPersonService.createPerson`, and `ApPersonService.updatePerson` allows an attacker to control the target of any origin links (such as the view on remote instance banner). Any HTTPS URL can be set, even if it belongs to a different domain than the note / user. Vulnerable Misskey instances will use the unverified URL for several clickable links, allowing an attacker to conduct phishing or other attacks against remote users. This issue has been addressed in version 2024.11.0-alpha.3. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **missing validation**
- **impact:** control the target of any origin links and phishing
- **vector:** HTTPS URL
- **attacker:** attacker
- **product:** Misskey
- **version:** before 2024.11.0-alpha.3
- **component:** ApPersonService.createPerson and ApPersonService.updatePerson and NoteCreateService.insertNote

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "Missing validation in `NoteCreateService.insertNote`, `ApPersonService.createPerson`, and `ApPersonService.updatePerson`",
  "Weaknesses/vulnerabilities present": "The application fails to validate the provided 'origin' URLs, allowing an attacker to set arbitrary links.",
  "Impact of exploitation": "An attacker can set arbitrary 'origin' links, leading to phishing or other attacks against remote users, because vulnerable Misskey instances will use these unverified URLs for clickable links.",
  "Attack vectors": "The attack is network-based.",
  "Required attacker capabilities/position": "No special privileges are needed. The attacker needs to manipulate the 'origin' link data."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.547 |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.545 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.533 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.530 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.524 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.523 |
| 7 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.522 |
| 8 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.517 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.510 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

