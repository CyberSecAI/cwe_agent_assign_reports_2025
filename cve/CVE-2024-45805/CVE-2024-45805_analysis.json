{
  "cve_id": "CVE-2024-45805",
  "description": "OpenCTI is an open-source cyber threat intelligence platform. Before 6.3.0, general users can access information that can only be accessed by users with access privileges to admin and support information (SETTINGS_SUPPORT). This is due to **inadequate access control** for support information (http///storage/get/support/UUID/UUID.zip), and that the UUID is available to general users using an attached query (logs query). This vulnerability is fixed in 6.3.0.",
  "key_phrases": {
    "rootcause": "inadequate access control",
    "weakness": "",
    "impact": "access information that can only be accessed by users with access privileges to admin and support information",
    "vector": "",
    "attacker": "general users",
    "product": "OpenCTI",
    "version": "before 6.3.0",
    "component": ""
  },
  "reference_content": "Based on the provided content, here's a breakdown of the vulnerability:\n\n**Root Cause:** Inadequate access control for support information. General users can access support package files intended for administrators due to a lack of proper authorization checks.\n\n**Weaknesses/Vulnerabilities:**\n*   **CWE-200 (Information Exposure):** The vulnerability allows unauthorized access to sensitive information contained within the support package.\n*  **CWE-285 (Improper Authorization):** The system fails to enforce proper access controls, allowing general users to access resources intended for administrators.\n\n**Impact of Exploitation:**\n*   An attacker with general user privileges can access sensitive information, including software and OS version details, as well as error details, that is normally restricted to administrators.\n*   This information can be used to further reconnaissance and potentially aid in more advanced attacks.\n\n**Attack Vectors:**\n1.  **Log in as a general user.** The attacker must have a valid user account with general user privileges.\n2.  **Use the logs query.** The attacker uses a specific query to find the location of the support package file.\n3.  **Access the support package file.** The attacker accesses the support package file directly via the identified URL.\n\n**Required Attacker Capabilities/Position:**\n*   The attacker needs a general user account on the OpenCTI platform.\n*   The attacker needs to be able to interact with the system through the web interface to send a specific log query to obtain the path to the support file.\n*   The attacker must have basic knowledge of the system to retrieve the package using the logs query.\n\n**Additional Details:**\n*   The vulnerability is present in OpenCTI versions 6.2.18 and earlier.\n*   The vulnerability is patched in version 6.3.0.\n*   The support package file is located at `http://<opencti_domain>/storage/get/support/UUID/UUID.zip`. The UUID is exposed via the logs query.\n*   The CVSS score is 4.3, with a vector of `CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N`",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name                                                                   | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :------------------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-862   | Missing Authorization                                                      | 0.9        | Base                  | Primary                         | Allowed                         |\n| CWE-200   | Exposure of Sensitive Information to an Unauthorized Actor                 | 0.7        | Class                 | Secondary                       | Discouraged                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-862, which represents the **missing authorization** check that allows general users to access sensitive information. CWE-200 is a consequence of the **missing authorization**, where sensitive information is exposed due to the lack of proper access controls. CWE-862 is a base level CWE and a child of CWE-285 and CWE-863 which are more general classes of authorization issues.\n\n```mermaid\ngraph TD\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    \n    cwe862 -->|CHILDOF| cwe285\n    cwe862 -->|CHILDOF| cwe863\n    cwe200 -- CANFOLLOW --> cwe862\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe862 primary\n    class cwe200 secondary\n    class cwe285,cwe863 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **missing authorization** (CWE-862), which leads to the exposure of sensitive information (CWE-200). The root cause is the **inadequate access control** for support information, allowing general users to access data intended for administrators.\n\n## Summary of Analysis\nThe vulnerability is primarily due to **inadequate access control**, specifically the **missing authorization** check for support information. General users can access sensitive information (software and OS version details, error details) because the system fails to verify their authorization to access the support package files.\n\nThe initial assessment considered several CWEs, including CWE-639, CWE-863, CWE-201, CWE-306, and CWE-285. However, based on the provided evidence and the CWE specifications, CWE-862 and CWE-200 were deemed the most appropriate.\n\n*   CWE-862 (Missing Authorization) accurately reflects the root cause of the vulnerability, where the system completely lacks an authorization check for accessing support information. The \"Vulnerability Description Key Phrases\" clearly states \"**inadequate access control**\". The CVE Reference Links Content Summary states \"General users can access support package files intended for administrators due to a **lack of proper authorization checks**.\"\n*   CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) is a consequence of the **missing authorization**, as the lack of access control leads to the exposure of sensitive information to general users. The CVE Reference Links Content Summary indicates that \"**The vulnerability allows unauthorized access to sensitive information contained within the support package**\".\n\nOther CWEs were considered but ultimately rejected:\n\n*   CWE-639 (Authorization Bypass Through User-Controlled Key): This CWE is not applicable because the vulnerability does not involve bypassing authorization through user-controlled keys.\n*   CWE-863 (Incorrect Authorization): This CWE is not applicable because there is no authorization check performed, rather it is missing.\n*   CWE-306 (Missing Authentication for Critical Function): This CWE is not applicable because the issue is with authorization, not authentication. The vulnerability description does not indicate any missing authentication checks.\n*   CWE-285 (Improper Authorization): This CWE is a general category for authorization failures, but CWE-862 is more specific and accurately reflects the root cause of the vulnerability.\n\nThe final selection of CWE-862 and CWE-200 provides a clear and accurate representation of the vulnerability, capturing both the root cause and the resulting impact. The CWEs are at the optimal level of specificity, with CWE-862 being a Base-level CWE and CWE-200 being a Class-level CWE.",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name                                                                   | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :------------------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-862   | Missing Authorization                                                      | 0.9        | Base                  | Primary                         | Allowed                         |\n| CWE-200   | Exposure of Sensitive Information to an Unauthorized Actor                 | 0.7        | Class                 | Secondary                       | Discouraged                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-862, which represents the **missing authorization** check that allows general users to access sensitive information. CWE-200 is a consequence of the **missing authorization**, where sensitive information is exposed due to the lack of proper access controls. CWE-862 is a base level CWE and a child of CWE-285 and CWE-863 which are more general classes of authorization issues.\n\n```mermaid\ngraph TD\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    \n    cwe862 -->|CHILDOF| cwe285\n    cwe862 -->|CHILDOF| cwe863\n    cwe200 -- CANFOLLOW --> cwe862\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe862 primary\n    class cwe200 secondary\n    class cwe285,cwe863 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **missing authorization** (CWE-862), which leads to the exposure of sensitive information (CWE-200). The root cause is the **inadequate access control** for support information, allowing general users to access data intended for administrators.\n\n## Summary of Analysis\nThe vulnerability is primarily due to **inadequate access control**, specifically the **missing authorization** check for support information. General users can access sensitive information (software and OS version details, error details) because the system fails to verify their authorization to access the support package files.\n\nThe initial assessment considered several CWEs, including CWE-639, CWE-863, CWE-201, CWE-306, and CWE-285. However, based on the provided evidence and the CWE specifications, CWE-862 and CWE-200 were deemed the most appropriate.\n\n*   CWE-862 (Missing Authorization) accurately reflects the root cause of the vulnerability, where the system completely lacks an authorization check for accessing support information. The \"Vulnerability Description Key Phrases\" clearly states \"**inadequate access control**\". The CVE Reference Links Content Summary states \"General users can access support package files intended for administrators due to a **lack of proper authorization checks**.\"\n*   CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) is a consequence of the **missing authorization**, as the lack of access control leads to the exposure of sensitive information to general users. The CVE Reference Links Content Summary indicates that \"**The vulnerability allows unauthorized access to sensitive information contained within the support package**\".\n\nOther CWEs were considered but ultimately rejected:\n\n*   CWE-639 (Authorization Bypass Through User-Controlled Key): This CWE is not applicable because the vulnerability does not involve bypassing authorization through user-controlled keys.\n*   CWE-863 (Incorrect Authorization): This CWE is not applicable because there is no authorization check performed, rather it is missing.\n*   CWE-306 (Missing Authentication for Critical Function): This CWE is not applicable because the issue is with authorization, not authentication. The vulnerability description does not indicate any missing authentication checks.\n*   CWE-285 (Improper Authorization): This CWE is a general category for authorization failures, but CWE-862 is more specific and accurately reflects the root cause of the vulnerability.\n\nThe final selection of CWE-862 and CWE-200 provides a clear and accurate representation of the vulnerability, capturing both the root cause and the resulting impact. The CWEs are at the optimal level of specificity, with CWE-862 being a Base-level CWE and CWE-200 being a Class-level CWE.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-862:**\n- 862 (Missing Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 445.6306458564075
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 437.71359311122694
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 429.7637565869893
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 412.12883004275307
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 408.58830889728983
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 405.2080972740591
    },
    {
      "metadata": {
        "doc_id": "532",
        "name": "Insertion of Sensitive Information into Log File",
        "source": "sparse"
      },
      "similarity": 404.2589815811773
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 403.6605147141943
    },
    {
      "metadata": {
        "doc_id": "1188",
        "name": "Initialization of a Resource with an Insecure Default",
        "type": "Base",
        "original_content": "The product initializes or sets a resource with a default that is intended to be changed by the administrator, but the default is not secure.",
        "keyphrase_source": "rootcause:inadequate access control",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5298251148012728,
            "graph": 1.5003297105364324
          }
        }
      },
      "similarity": 0.5298251148012728
    },
    {
      "doc_id": "226",
      "text": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "226",
        "name": "Sensitive Information in Resource Not Removed Before Reuse",
        "type": "base",
        "original_content": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
        "relationships": [
          {
            "source_id": "226",
            "target_id": "244",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1342",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1301",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1272",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1239",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "201",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "212",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "459",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "459",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "244",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "212",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "201",
            "target_id": "226",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1301",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1272",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "201"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "201"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "226",
                  "201",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "201"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-862",
      "CWE-639",
      "CWE-306",
      "CWE-201",
      "CWE-285",
      "CWE-200"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}