## Vulnerability Description
In the module Help Desk - Customer Support Management System (helpdesk) up to version 2.4.0 from FME Modules for PrestaShop, a customer can upload .php files. Methods `HelpdeskHelpdeskModuleFrontControllersubmitTicket()` and `HelpdeskHelpdeskModuleFrontControllerreplyTicket()` **allow upload of .php files** on a predictable path for connected customers.

### Vulnerability Description Key Phrases
- **rootcause:** **allow upload of .php files**
- **attacker:** connected customers
- **product:** FME Modules for PrestaShop
- **version:** up to version 2.4.0
- **component:** Help Desk - Customer Support Management System (helpdesk)

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: Unrestricted file upload of .php files through the `HelpdeskHelpdeskModuleFrontController::submitTicket()` and `HelpdeskHelpdeskModuleFrontController::replyTicket()` methods within the "Help Desk - Customer Support Management System" module for PrestaShop.
- **Weaknesses/vulnerabilities present**:
    - CWE-434: Unrestricted Upload of File with Dangerous Type.
    - CWE-94: Improper Control of Generation of Code ('Code Injection') due to the ability to upload and execute PHP code.
- **Impact of exploitation**:
    - Critical vulnerability leading to potential remote code execution on the server.
    - Attackers can gain admin access, remove data, or steal data from the associated PrestaShop installation.
- **Attack vectors**:
    - Network-based attack.
    - Exploitation is done through the PrestaShop front controller, where the module controller's path can be concealed. The attacker can use the POST request to upload a malicious PHP file without revealing the exploit in conventional frontend logs.
- **Required attacker capabilities/position**:
    - Low privilege: Requires a valid customer account on the PrestaShop platform.
    - Low attack complexity.
    - No user interaction needed.
    - Network access to the application.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.293 |
| 2 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.266 |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.259 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.251 |
| 5 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.250 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.242 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.239 |
| 8 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.237 |
| 9 | 616 | Incomplete Identification of Uploaded File Variables (PHP) | Variant | Allowed | dense | 0.354 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-23: Relative Path Traversal

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-425: Direct Request ('Forced Browsing')

CWE-306: Missing Authentication for Critical Function

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-616: Incomplete Identification of Uploaded File Variables (PHP)

CWE-471: Modification of Assumed-Immutable Data (MAID)