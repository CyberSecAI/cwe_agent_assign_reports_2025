# Raw Retriever Results for CVE-2025-1391

# Raw Retriever Results for CVE-2025-1391
## Query
A flaw was found in the Keycloak organization feature, which allows the incorrect assignment of an organization to a user if their username or email matches the organizations domain pattern. This issue occurs at the mapper level, leading to misrepresentation in tokens. If an application relies on these claims for authorization, it may incorrectly assume a user belongs to an organization they are not a member of, potentially granting unauthorized access or privileges.

## Keyphrases
- **rootcause**: 'incorrect assignment of organization to user if their username', 'email matches the organizations domain pattern'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4791 | 0.5554 | 0.4986 | 0.4975 | 20 |
| Sparse | 437.5963 | 495.0540 | 455.5141 | 449.4429 | 11 |
| Graph | 1.2262 | 2.2100 | 1.6113 | 1.5757 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 2 | 178 | Improper Handling of Case Sensitivity | base | 2.2100 | Allowed |
| 3 | 52 | Path Equivalence: '/multiple/trailing/slash//' | variant | 2.0400 | Allowed |
| 4 | 46 | Path Equivalence: 'filename ' (Trailing Space) | variant | 2.0400 | Allowed |
| 5 | 173 | Improper Handling of Alternate Encoding | variant | 2.0400 | Allowed |
| 6 | 842 | Placement of User into Incorrect Group | Base | 1.7285 | Allowed |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.7170 | Allowed |
| 8 | 289 | Authentication Bypass by Alternate Name | Base | 1.6722 | Allowed |
| 9 | 433 | Unparsed Raw Web Content Delivery | variant | 1.6320 | Allowed |
| 10 | 708 | Incorrect Ownership Assignment | Base | 1.6304 | Allowed |
| 11 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.5210 | Allowed |
| 12 | 863 | Incorrect Authorization | class | 1.4080 | Allowed-with-Review |
| 13 | 285 | Improper Authorization | class | 1.4080 | Discouraged |
| 14 | 287 | Improper Authentication | class | 1.3648 | Discouraged |
| 15 | 430 | Deployment of Wrong Handler | base | 1.3010 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 842 | Placement of User into Incorrect Group | Base | 0.5554 | 0.5554 | Allowed |
| 2 | 286 | Incorrect User Management | Class | 0.5334 | 0.5334 | Allowed-with-Review |
| 3 | 708 | Incorrect Ownership Assignment | Base | 0.5152 | 0.5152 | Allowed |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5140 | 0.5140 | Allowed |
| 5 | 289 | Authentication Bypass by Alternate Name | Base | 0.5099 | 0.5099 | Allowed |
| 6 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.5055 | 0.5055 | Allowed |
| 7 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | 0.5038 | 0.5038 | Allowed |
| 8 | 266 | Incorrect Privilege Assignment | Base | 0.4995 | 0.4995 | Allowed |
| 9 | 488 | Exposure of Data Element to Wrong Session | Base | 0.4986 | 0.4986 | Allowed |
| 10 | 939 | Improper Authorization in Handler for Custom URL Scheme | Base | 0.4984 | 0.4984 | Allowed |
| 11 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4965 | 0.4965 | Allowed |
| 12 | 1270 | Generation of Incorrect Security Tokens | Base | 0.4878 | 0.4878 | Allowed |
| 13 | 296 | Improper Following of a Certificate's Chain of Trust | Base | 0.4866 | 0.4866 | Allowed |
| 14 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4837 | 0.4837 | Allowed |
| 15 | 706 | Use of Incorrectly-Resolved Name or Reference | Class | 0.4821 | 0.4821 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 495.0540 | 495.0540 | Allowed-with-Review |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | 473.9883 | 473.9883 | Allowed |
| 3 | 610 | Externally Controlled Reference to a Resource in Another Sphere | 468.2218 | 468.2218 | Discouraged |
| 4 | 285 | Improper Authorization | 464.8260 | 464.8260 | Discouraged |
| 5 | 287 | Improper Authentication | 452.0594 | 452.0594 | Discouraged |
| 6 | 1220 | Insufficient Granularity of Access Control | 449.4429 | 449.4429 | Allowed |
| 7 | 1390 | Weak Authentication | 444.7705 | 444.7705 | Allowed-with-Review |
| 8 | 183 | Permissive List of Allowed Inputs | 444.3061 | 444.3061 | Allowed |
| 9 | 201 | Insertion of Sensitive Information Into Sent Data | 440.2668 | 440.2668 | Allowed |
| 10 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 440.1233 | 440.1233 | Allowed-with-Review |
| 11 | 267 | Privilege Defined With Unsafe Actions | 437.5963 | 437.5963 | Allowed |
