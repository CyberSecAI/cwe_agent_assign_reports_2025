## Vulnerability Description
kube-audit-rest is a simple logger of mutation/creation requests to the k8s api. If the full-elastic-stack example vector configuration was used for a real cluster, the previous values of kubernetes secrets would have been disclosed in the audit messages. This vulnerability is fixed in 1.0.16.

### Vulnerability Description Key Phrases
- **impact:** disclose the previous values of kubernetes secrets
- **vector:** full-elastic-stack example vector configuration
- **product:** kube-audit-rest

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on information relevant to CVE-2025-24884:

**Content from github.com_7686da36_20250624_202317.html (stripped)**

*   **Description:** The content describes a vulnerability where secret values could be disclosed in audit logs.
*   **Root cause of vulnerability:** The "full-elastic-stack" example vector configuration was used for a real cluster, the previous values of kubernetes secrets would have been disclosed in the audit messages.
*   **Impact of exploitation:** If the "full-elastic-stack" example vector configuration was used for a real cluster, the previous values of kubernetes secrets would have been disclosed in the audit messages.
*   **Weaknesses/vulnerabilities present:**
    *   CWE-200: Information Exposure
    *   CWE-212: Exposed Secret
    *   CWE-532: Information Exposure Through Log Files
*   **Affected versions:** <1.0.16
*   **Patched versions:** 1.0.17
*   **Workarounds:** Replace the original code snippet provided with the corrected code snippet in the content.
*   **Mitigation or fix:** The example has been updated to fix this in commit [9df8886](https://github.com/RichardoC/kube-audit-rest/commit/9df8886b4819409f566233adc7c3b7a43a4096ba)

**Content from github.com_9fe928b8_20250624_202316.html (stripped)**

*   This content is a commit that fixes the vulnerability described in the first content.
*   **Description:** Corrects an example redaction for secrets. The previous configuration would only redact the data field in the configmap, but not the copy in the "kubectl.kubernetes.io/last-applied-configuration" annotation.
*   **Root cause of vulnerability:** The original configuration only redacted the secret data, but not the data stored in the annotation "kubectl.kubernetes.io/last-applied-configuration".
*   **Impact of exploitation:** This could lead to secrets being disclosed in the audit messages.
*   **Mitigation or fix:** The commit provides the fix to redact the annotation to prevent secrets from being disclosed.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.103 |
| 2 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.096 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.093 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.091 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.086 |
| 6 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.086 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.085 |
| 8 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.084 |
| 9 | 778 | Insufficient Logging | Base | Allowed | dense | 0.390 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-532: Insertion of Sensitive Information into Log File

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-306: Missing Authentication for Critical Function

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-863: Incorrect Authorization

CWE-696: Incorrect Behavior Order

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-319: Cleartext Transmission of Sensitive Information

CWE-778: Insufficient Logging

CWE-322: Key Exchange without Entity Authentication