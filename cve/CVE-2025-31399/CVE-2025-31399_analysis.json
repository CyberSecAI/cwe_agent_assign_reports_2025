{
  "cve_id": "CVE-2025-31399",
  "description": "Cross-Site Request Forgery (CSRF) vulnerability in Chandan Garg CG Scroll To Top allows Stored **XSS**. This issue affects CG Scroll To Top from n/a through 3.5.",
  "key_phrases": {
    "rootcause": "lack of CSRF protection",
    "weakness": [
      "Cross-Site Scripting",
      "XSS"
    ],
    "impact": "",
    "vector": "",
    "attacker": "",
    "product": "Chandan Garg CG Scroll To Top",
    "version": "n/a through 3.5",
    "component": ""
  },
  "reference_content": "Root cause of vulnerability:\nCross Site Request Forgery (CSRF) vulnerability.\n\nWeaknesses/vulnerabilities present:\nCSRF allows a malicious actor to force higher privileged users to execute unwanted actions under their current authentication.\n\nImpact of exploitation:\nA malicious actor can force higher privileged users to execute unwanted actions. The specific impact varies case by case.\n\nAttack vectors:\nNot specified in the content.\n\nRequired attacker capabilities/position:\nUnauthenticated.\n\nMitigation or fix:\nNo official fix available. Patchstack vPatching can auto-mitigate the vulnerability.\n\nAdditional details:\n- CVSS score: 7.1 (Low severity)\n- OWASP Top 10: A5: Broken Access Control\n- Vulnerable versions: <= 3.5\n- Plugin: CG Scroll To Top\n- Reported by: johska\n- Published by Patchstack: 09 April 2025",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-352 | Cross-Site Request Forgery (CSRF) | 1.0 | Compound | Allowed | Primary CWE: **lack of CSRF protection** |\n| CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1.0 | Base | Allowed | Secondary CWE: Stored **XSS** |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe analysis focuses on two primary weaknesses: **lack of CSRF protection** (CWE-352) and Stored **XSS** (CWE-79). CWE-352 is a compound weakness, representing the **failure** to verify the legitimacy of requests. CWE-79 is a base-level weakness that arises from **improper neutralization** of user-controllable input. There is no explicit parent-child relationship between these two, but they can exist in a chain where **lack of CSRF protection** allows an attacker to inject malicious scripts, leading to **XSS**.\n\n```mermaid\ngraph TD\n    cwe352[\"CWE-352: Cross-Site Request Forgery (CSRF)\"]\n    cwe79[\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\n    cwe80[\"CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)\"]\n\n    cwe79 -->|CANFOLLOW| cwe352\n    cwe80 -->|CHILDOF| cwe79\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe352 primary\n    class cwe79 secondary\n```\n\n## Vulnerability Chain\n1.  **Root Cause:** **Lack of CSRF protection** (CWE-352) allows unauthorized requests.\n2.  **Weakness:** Improper Neutralization of Input (CWE-79) in the application.\n3.  **Impact:** Stored **XSS** vulnerability exploitable due to the ability to inject malicious scripts.\n\n## Summary of Analysis\nThe primary root cause is the **lack of CSRF protection**, which is evident from the vulnerability description. This allows attackers to inject malicious scripts into the application, leading to a Stored **XSS** vulnerability. The evidence clearly supports mapping the root cause to CWE-352, and the resulting weakness to CWE-79. The retriever scores and mapping guidance both support these selections. The selected CWEs are at the optimal level of specificity, with CWE-352 being a compound weakness and CWE-79 being a base-level weakness.\n\n**CWE-352: Cross-Site Request Forgery (CSRF)** is the primary CWE because the vulnerability description specifically mentions a **lack of CSRF protection**. The description of CWE-352, \"The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request,\" directly aligns with this vulnerability.\n\n**CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')** is a secondary CWE because the vulnerability leads to Stored **XSS**. The description of CWE-79, \"The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users,\" aligns with this vulnerability because the application **fails** to properly sanitize input, leading to the ability to inject malicious scripts.\n\nCWEs Considered but Not Used:\n\n*   CWE-434: Unrestricted Upload of File with Dangerous Type - This CWE was considered but not used because the vulnerability description does not mention anything about file uploads.\n*   CWE-116: Improper Encoding or Escaping of Output - This CWE was considered but not used because while related to **XSS**, CWE-79 is a more direct and specific match for the **improper neutralization** of input.\n*   CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) - While related to **XSS**, CWE-79 is a more general category, and it is preferred because the provided text does not explicitly state that the vulnerability involves script-related HTML tags.\n*   CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') - This CWE was considered but is not related to the **XSS** or **CSRF** vulnerabilities described.\n*   CWE-611: Improper Restriction of XML External Entity Reference - This CWE was considered but is not related to the **XSS** or **CSRF** vulnerabilities described.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-352 | Cross-Site Request Forgery (CSRF) | 1.0 | Compound | Allowed | Primary CWE: **lack of CSRF protection** |\n| CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1.0 | Base | Allowed | Secondary CWE: Stored **XSS** |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 1.0\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe analysis focuses on two primary weaknesses: **lack of CSRF protection** (CWE-352) and Stored **XSS** (CWE-79). CWE-352 is a compound weakness, representing the **failure** to verify the legitimacy of requests. CWE-79 is a base-level weakness that arises from **improper neutralization** of user-controllable input. There is no explicit parent-child relationship between these two, but they can exist in a chain where **lack of CSRF protection** allows an attacker to inject malicious scripts, leading to **XSS**.\n\n```mermaid\ngraph TD\n    cwe352[\"CWE-352: Cross-Site Request Forgery (CSRF)\"]\n    cwe79[\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\n    cwe80[\"CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)\"]\n\n    cwe79 -->|CANFOLLOW| cwe352\n    cwe80 -->|CHILDOF| cwe79\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe352 primary\n    class cwe79 secondary\n```\n\n## Vulnerability Chain\n1.  **Root Cause:** **Lack of CSRF protection** (CWE-352) allows unauthorized requests.\n2.  **Weakness:** Improper Neutralization of Input (CWE-79) in the application.\n3.  **Impact:** Stored **XSS** vulnerability exploitable due to the ability to inject malicious scripts.\n\n## Summary of Analysis\nThe primary root cause is the **lack of CSRF protection**, which is evident from the vulnerability description. This allows attackers to inject malicious scripts into the application, leading to a Stored **XSS** vulnerability. The evidence clearly supports mapping the root cause to CWE-352, and the resulting weakness to CWE-79. The retriever scores and mapping guidance both support these selections. The selected CWEs are at the optimal level of specificity, with CWE-352 being a compound weakness and CWE-79 being a base-level weakness.\n\n**CWE-352: Cross-Site Request Forgery (CSRF)** is the primary CWE because the vulnerability description specifically mentions a **lack of CSRF protection**. The description of CWE-352, \"The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request,\" directly aligns with this vulnerability.\n\n**CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')** is a secondary CWE because the vulnerability leads to Stored **XSS**. The description of CWE-79, \"The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users,\" aligns with this vulnerability because the application **fails** to properly sanitize input, leading to the ability to inject malicious scripts.\n\nCWEs Considered but Not Used:\n\n*   CWE-434: Unrestricted Upload of File with Dangerous Type - This CWE was considered but not used because the vulnerability description does not mention anything about file uploads.\n*   CWE-116: Improper Encoding or Escaping of Output - This CWE was considered but not used because while related to **XSS**, CWE-79 is a more direct and specific match for the **improper neutralization** of input.\n*   CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) - While related to **XSS**, CWE-79 is a more general category, and it is preferred because the provided text does not explicitly state that the vulnerability involves script-related HTML tags.\n*   CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') - This CWE was considered but is not related to the **XSS** or **CSRF** vulnerabilities described.\n*   CWE-611: Improper Restriction of XML External Entity Reference - This CWE was considered but is not related to the **XSS** or **CSRF** vulnerabilities described.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-611:**\n- 611 (Improper Restriction of XML External Entity Reference) - ROOT\n\n\n**Chain starting from CWE-116:**\n- 116 (Improper Encoding or Escaping of Output) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "source": "sparse",
        "original_content": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
        "keyphrase_sources": [
          {
            "id": "rootcause:lack of CSRF protection",
            "keyphrase": "lack of CSRF protection",
            "type": "rootcause"
          },
          {
            "id": "weakness:Cross-Site Scripting",
            "keyphrase": "Cross-Site Scripting",
            "type": "weakness"
          },
          {
            "id": "weakness:XSS",
            "keyphrase": "XSS",
            "type": "weakness"
          },
          {
            "id": "product:Chandan Garg CG Scroll To Top",
            "keyphrase": "Chandan Garg CG Scroll To Top",
            "type": "product"
          },
          {
            "id": "version:n/a through 3.5",
            "keyphrase": "n/a through 3.5",
            "type": "version"
          }
        ]
      },
      "similarity": 316.0067962775897
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse",
        "original_content": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
        "keyphrase_sources": [
          {
            "id": "rootcause:lack of CSRF protection",
            "keyphrase": "lack of CSRF protection",
            "type": "rootcause"
          },
          {
            "id": "version:n/a through 3.5",
            "keyphrase": "n/a through 3.5",
            "type": "version"
          }
        ]
      },
      "similarity": 227.1322135453874
    },
    {
      "metadata": {
        "doc_id": "116",
        "name": "Improper Encoding or Escaping of Output",
        "source": "sparse",
        "original_content": "The product prepares a structured message for communication with another component, but encoding or escaping of the data is either missing or done incorrectly. As a result, the intended structure of the message is not preserved.",
        "keyphrase_sources": [
          {
            "id": "rootcause:lack of CSRF protection",
            "keyphrase": "lack of CSRF protection",
            "type": "rootcause"
          },
          {
            "id": "weakness:Cross-Site Scripting",
            "keyphrase": "Cross-Site Scripting",
            "type": "weakness"
          },
          {
            "id": "weakness:XSS",
            "keyphrase": "XSS",
            "type": "weakness"
          },
          {
            "id": "product:Chandan Garg CG Scroll To Top",
            "keyphrase": "Chandan Garg CG Scroll To Top",
            "type": "product"
          }
        ]
      },
      "similarity": 224.59156572449848
    },
    {
      "metadata": {
        "doc_id": "80",
        "name": "Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)",
        "source": "sparse",
        "original_content": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special characters such as \"<\", \">\", and \"&\" that could be interpreted as web-scripting elements when they are sent to a downstream component that processes web pages.",
        "keyphrase_sources": [
          {
            "id": "weakness:Cross-Site Scripting",
            "keyphrase": "Cross-Site Scripting",
            "type": "weakness"
          }
        ]
      },
      "similarity": 217.4729039106975
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse",
        "original_content": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
        "keyphrase_sources": [
          {
            "id": "rootcause:lack of CSRF protection",
            "keyphrase": "lack of CSRF protection",
            "type": "rootcause"
          },
          {
            "id": "weakness:Cross-Site Scripting",
            "keyphrase": "Cross-Site Scripting",
            "type": "weakness"
          },
          {
            "id": "weakness:XSS",
            "keyphrase": "XSS",
            "type": "weakness"
          },
          {
            "id": "product:Chandan Garg CG Scroll To Top",
            "keyphrase": "Chandan Garg CG Scroll To Top",
            "type": "product"
          },
          {
            "id": "version:n/a through 3.5",
            "keyphrase": "n/a through 3.5",
            "type": "version"
          }
        ]
      },
      "similarity": 213.5290433984859
    },
    {
      "metadata": {
        "doc_id": "1004",
        "name": "Sensitive Cookie Without 'HttpOnly' Flag",
        "source": "sparse",
        "original_content": "The product uses a cookie to store sensitive information, but the cookie is not marked with the HttpOnly flag.",
        "keyphrase_sources": [
          {
            "id": "rootcause:lack of CSRF protection",
            "keyphrase": "lack of CSRF protection",
            "type": "rootcause"
          },
          {
            "id": "weakness:Cross-Site Scripting",
            "keyphrase": "Cross-Site Scripting",
            "type": "weakness"
          },
          {
            "id": "weakness:XSS",
            "keyphrase": "XSS",
            "type": "weakness"
          }
        ]
      },
      "similarity": 205.93727124441548
    },
    {
      "metadata": {
        "doc_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "source": "sparse",
        "original_content": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
        "keyphrase_sources": [
          {
            "id": "weakness:XSS",
            "keyphrase": "XSS",
            "type": "weakness"
          }
        ]
      },
      "similarity": 163.750366822664
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse",
        "original_content": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
        "keyphrase_sources": [
          {
            "id": "version:n/a through 3.5",
            "keyphrase": "n/a through 3.5",
            "type": "version"
          }
        ]
      },
      "similarity": 68.83897229867003
    },
    {
      "metadata": {
        "doc_id": "611",
        "name": "Improper Restriction of XML External Entity Reference",
        "source": "sparse",
        "original_content": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.",
        "keyphrase_sources": [
          {
            "id": "version:n/a through 3.5",
            "keyphrase": "n/a through 3.5",
            "type": "version"
          }
        ]
      },
      "similarity": 68.72314712289672
    },
    {
      "metadata": {
        "doc_id": "259",
        "name": "Use of Hard-coded Password",
        "source": "sparse",
        "original_content": "The product contains a hard-coded password, which it uses for its own inbound authentication or for outbound communication to external components.",
        "keyphrase_sources": [
          {
            "id": "product:Chandan Garg CG Scroll To Top",
            "keyphrase": "Chandan Garg CG Scroll To Top",
            "type": "product"
          }
        ]
      },
      "similarity": 64.85920201704103
    },
    {
      "metadata": {
        "doc_id": "24",
        "name": "Path Traversal: '../filedir'",
        "source": "sparse",
        "original_content": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize \"../\" sequences that can resolve to a location that is outside of that directory.",
        "keyphrase_sources": [
          {
            "id": "product:Chandan Garg CG Scroll To Top",
            "keyphrase": "Chandan Garg CG Scroll To Top",
            "type": "product"
          }
        ]
      },
      "similarity": 64.81177866554567
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-611",
      "CWE-116",
      "CWE-80",
      "CWE-22",
      "CWE-79",
      "CWE-352",
      "CWE-434"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {
    "352": [
      {
        "id": "rootcause:lack of CSRF protection",
        "keyphrase": "lack of CSRF protection",
        "type": "rootcause"
      },
      {
        "id": "weakness:Cross-Site Scripting",
        "keyphrase": "Cross-Site Scripting",
        "type": "weakness"
      },
      {
        "id": "weakness:XSS",
        "keyphrase": "XSS",
        "type": "weakness"
      },
      {
        "id": "product:Chandan Garg CG Scroll To Top",
        "keyphrase": "Chandan Garg CG Scroll To Top",
        "type": "product"
      },
      {
        "id": "version:n/a through 3.5",
        "keyphrase": "n/a through 3.5",
        "type": "version"
      }
    ],
    "434": [
      {
        "id": "rootcause:lack of CSRF protection",
        "keyphrase": "lack of CSRF protection",
        "type": "rootcause"
      },
      {
        "id": "version:n/a through 3.5",
        "keyphrase": "n/a through 3.5",
        "type": "version"
      }
    ],
    "116": [
      {
        "id": "rootcause:lack of CSRF protection",
        "keyphrase": "lack of CSRF protection",
        "type": "rootcause"
      },
      {
        "id": "weakness:Cross-Site Scripting",
        "keyphrase": "Cross-Site Scripting",
        "type": "weakness"
      },
      {
        "id": "weakness:XSS",
        "keyphrase": "XSS",
        "type": "weakness"
      },
      {
        "id": "product:Chandan Garg CG Scroll To Top",
        "keyphrase": "Chandan Garg CG Scroll To Top",
        "type": "product"
      }
    ],
    "79": [
      {
        "id": "rootcause:lack of CSRF protection",
        "keyphrase": "lack of CSRF protection",
        "type": "rootcause"
      },
      {
        "id": "weakness:Cross-Site Scripting",
        "keyphrase": "Cross-Site Scripting",
        "type": "weakness"
      },
      {
        "id": "weakness:XSS",
        "keyphrase": "XSS",
        "type": "weakness"
      },
      {
        "id": "product:Chandan Garg CG Scroll To Top",
        "keyphrase": "Chandan Garg CG Scroll To Top",
        "type": "product"
      },
      {
        "id": "version:n/a through 3.5",
        "keyphrase": "n/a through 3.5",
        "type": "version"
      }
    ],
    "1004": [
      {
        "id": "rootcause:lack of CSRF protection",
        "keyphrase": "lack of CSRF protection",
        "type": "rootcause"
      },
      {
        "id": "weakness:Cross-Site Scripting",
        "keyphrase": "Cross-Site Scripting",
        "type": "weakness"
      },
      {
        "id": "weakness:XSS",
        "keyphrase": "XSS",
        "type": "weakness"
      }
    ],
    "80": [
      {
        "id": "weakness:Cross-Site Scripting",
        "keyphrase": "Cross-Site Scripting",
        "type": "weakness"
      }
    ],
    "918": [
      {
        "id": "weakness:XSS",
        "keyphrase": "XSS",
        "type": "weakness"
      }
    ],
    "259": [
      {
        "id": "product:Chandan Garg CG Scroll To Top",
        "keyphrase": "Chandan Garg CG Scroll To Top",
        "type": "product"
      }
    ],
    "24": [
      {
        "id": "product:Chandan Garg CG Scroll To Top",
        "keyphrase": "Chandan Garg CG Scroll To Top",
        "type": "product"
      }
    ],
    "22": [
      {
        "id": "version:n/a through 3.5",
        "keyphrase": "n/a through 3.5",
        "type": "version"
      }
    ],
    "611": [
      {
        "id": "version:n/a through 3.5",
        "keyphrase": "n/a through 3.5",
        "type": "version"
      }
    ]
  }
}