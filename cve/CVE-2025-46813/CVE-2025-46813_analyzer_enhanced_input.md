## Vulnerability Description
Discourse is an open-source community platform. A data leak vulnerability affects sites deployed between commits 10df7fdee060d44accdee7679d66d778d1136510 and 82d84af6b0efbd9fa2aeec3e91ce7be1a768511b. On login-required sites, the leak meant that some content on the sites homepage could be visible to unauthenticated users. Only login-required sites that got deployed during this timeframe are affected, roughly between April 30 2025 noon EDT and May 2 2025, noon EDT. Sites on the stable branch are unaffected. Private content on an instances homepage could be visible to unauthenticated users on login-required sites. Versions of 3.5.0.beta4 after commit 82d84af6b0efbd9fa2aeec3e91ce7be1a768511b are not vulnerable to the issue. No workarounds are available. Sites must upgrade to a non-vulnerable version of Discourse.

### Vulnerability Description Key Phrases
- **impact:** data leak
- **attacker:** unauthenticated users
- **product:** Discourse
- **version:** 10df7fdee060d44accdee7679d66d778d1136510 to 82d84af6b0efbd9fa2aeec3e91ce7be1a768511b

## CVE Reference Links Content Summary
```
- Root cause of vulnerability: The vulnerability was introduced by commits [10df7fd](https://github.com/discourse/discourse/commit/10df7fdee060d44accdee7679d66d778d1136510) and reverted by commit [82d84af](https://github.com/discourse/discourse/commit/82d84af6b0efbd9fa2aeec3e91ce7be1a768511b).
- Weaknesses/vulnerabilities present: A data leak, where some content on the site's homepage could be visible to unauthenticated users on login-required sites.
- Impact of exploitation: Private content on an instance's homepage could be visible to unauthenticated users on login-required sites.
- Attack vectors: The vulnerability affects login-required sites.
- Required attacker capabilities/position: The attacker does not require any privileges to exploit the vulnerability.
- Mitigation or fix: Sites must upgrade to an unimpacted version of Discourse.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.199 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.197 |
| 3 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.194 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.182 |
| 5 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | Allowed | sparse | 0.181 |
| 6 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.180 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.178 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.175 |
| 9 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | Allowed | dense | 0.547 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1390: Weak Authentication

CWE-863: Incorrect Authorization

CWE-525: Use of Web Browser Cache Containing Sensitive Information

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory

CWE-226: Sensitive Information in Resource Not Removed Before Reuse