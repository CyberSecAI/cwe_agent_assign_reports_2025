## Vulnerability Description
OneDev is a Git server with CI/CD, kanban, and packages. A vulnerability in versions prior to 11.0.9 allows unauthenticated users to read arbitrary files accessible by the OneDev server process. This issue has been fixed in version 11.0.9.

### Vulnerability Description Key Phrases
- **impact:** read arbitrary files
- **attacker:** unauthenticated users
- **product:** OneDev
- **version:** prior to 11.0.9

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-45309:

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient path sanitization within several file access endpoints of the OneDev application. Specifically, the application fails to properly validate user-supplied path segments in URLs. This allows an attacker to bypass intended access restrictions and potentially read arbitrary files on the server.

**Weaknesses/Vulnerabilities Present:**
- **Path Traversal:** The core weakness is a path traversal vulnerability. The application doesn't adequately prevent the use of ".." sequences or other directory traversal techniques in URL parameters to access files outside of the intended scope.
- **Lack of Input Validation:** The application fails to validate or sanitize the input received through URL parameters, leading to the vulnerability.

**Impact of Exploitation:**
- **Arbitrary File Read:** An attacker can read any file accessible to the OneDev server process. This can include configuration files, source code, database credentials, and other sensitive information.
- **Confidentiality Breach:** Exposure of sensitive data can lead to a significant breach of confidentiality and potentially allow further exploitation or compromise of the system.

**Attack Vectors:**
- The vulnerability is exploited via crafted HTTP requests.
- Attackers manipulate URL parameters to include directory traversal sequences, such as `..`, in the file paths.

**Required Attacker Capabilities/Position:**
- **Unauthenticated Access:** The vulnerability can be exploited by unauthenticated users.
- **Network Access:** The attacker needs network access to the OneDev server.

**More detail than the official CVE description:**
- The provided content gives a detailed description of the vulnerability, its impact and affected versions
- It includes the specific code changes to address the vulnerability which provides precise technical details, including the locations of the vulnerabilities within the Java source code and how the fixes were implemented (adding checks for ".." in path segments).
- It names the analyst who reported the vulnerability.
- It lists the affected components like `ProjectBlobPage.java`, `BuildReportPage.java`, `CommitDetailPage.java`, `ArtifactResource.java`, `RawBlobResource.java`, `SiteFileResource.java`, `HtmlReportDownloadResource.java`, `HtmlReportPage.java`, `MarkdownReportDownloadResource.java`, and `MarkdownReportPage.java`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.078 |
| 2 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.077 |
| 3 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.075 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.075 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.075 |
| 6 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.075 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.074 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.073 |
| 9 | 863 | Incorrect Authorization | Class | Allowed-with-Review | dense | 0.550 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-502: Deserialization of Untrusted Data

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-23: Relative Path Traversal

CWE-427: Uncontrolled Search Path Element

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-863: Incorrect Authorization

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')