# Vulnerability Information: CVE-2024-7464

## Vulnerability Description
A vulnerability, which was classified as critical, has been found in TOTOLINK CP900 6.3c.566. This issue affects the function setTelnetCfg of the component Telnet Service. The manipulation of the argument telnet_enabled leads to **command injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The identifier VDB-273557 was assigned to this vulnerability. NOTE The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** TOTOLINK CP900
- **version:** 6.3c.566
- **component:** Telnet Service

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
The `setTelnetCfg` function in the TOTOLINK CP900 V6.3c.566 firmware is vulnerable to command injection.

**Weaknesses/vulnerabilities present:**
- The `telnet_enabled` parameter from a POST request is directly used without proper sanitization within the `setTelnetCfg` function.
- The user-controlled input is used in the execution of a system command.

**Impact of exploitation:**
- An attacker can inject arbitrary commands into the system by manipulating the `telnet_enabled` parameter.
- This could lead to full control over the device, data exfiltration, denial of service, or further network compromise.

**Attack vectors:**
- The vulnerability is triggered via an HTTP POST request to the `cgi-bin/cstecgi.cgi` endpoint.
- The attacker needs to include the `telnet_enabled` parameter with malicious payload in the POST request.

**Required attacker capabilities/position:**
- The attacker needs to have network access to the device.
- Knowledge of the device's CGI endpoint (`cgi-bin/cstecgi.cgi`) and the `telnet_enabled` parameter is necessary.
- The attacker also needs to have a valid `SESSION_ID` cookie.

**Additional Notes:**

- The provided Proof of Concept (POC) demonstrates how to trigger the command injection using a simple POST request with a manipulated `telnet_enabled` parameter.
- The vulnerability is present in the TOTOLINK CP900 V6.3c.566 firmware.
- The `setTelnetCfg` function is responsible for handling the telnet configuration of the device, and its logic is flawed allowing command injection.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.549 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.517 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.432 |
| 6 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.429 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.418 |
| 8 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.414 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.643 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

