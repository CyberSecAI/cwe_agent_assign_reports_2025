# Vulnerability Information: CVE-2025-21908

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved NFS fix nfs_release_folio() to not deadlock via kcompactd writeback Add PF_KCOMPACTD flag and current_is_kcompactd() helper to check for it so nfs_release_folio() can skip calling nfs_wb_folio() from kcompactd. Otherwise NFS can deadlock waiting for kcompactd enduced writeback which recurses back to NFS (which triggers writeback to NFSD via NFS loopback mount on the same host, NFSD blocks waiting for XFSs call to __filemap_get_folio) 6070.550357] INFO task kcompactd058 blocked for more than 4435 seconds. {--- [58] kcompactd0 [] folio_wait_bit+0xe8/0x200 [] folio_wait_writeback+0x2b/0x80 [] nfs_wb_folio+0x80/0x1b0 [nfs] [] nfs_release_folio+0x68/0x130 [nfs] [] split_huge_page_to_list_to_order+0x362/0x840 [] migrate_pages_batch+0x43d/0xb90 [] migrate_pages_sync+0x9a/0x240 [] migrate_pages+0x93c/0x9f0 [] compact_zone+0x8e2/0x1030 [] compact_node+0xdb/0x120 [] kcompactd+0x121/0x2e0 [] kthread+0xcf/0x100 [] ret_from_fork+0x31/0x40 [] ret_from_fork_asm+0x1a/0x30 ---} [akpm@linux-foundation.org fix build]

### Vulnerability Description Key Phrases
- **impact:** deadlock
- **vector:** NFS loopback mount
- **attacker:** kcompactd
- **product:** Linux kernel
- **component:** NFS fix nfs_release_folio()

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.124 |
| 2 | 833 | Deadlock | Base | Allowed | sparse | 0.124 |
| 3 | 392 | Missing Report of Error Condition | Base | Allowed | sparse | 0.118 |
| 4 | 62 | UNIX Hard Link | Variant | Allowed | sparse | 0.112 |
| 5 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.112 |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.107 |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.107 |
| 8 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.106 |
| 9 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | dense | 0.497 |
| 10 | 390 | Detection of Error Condition Without Action | Base | Allowed | graph | 0.002 |

