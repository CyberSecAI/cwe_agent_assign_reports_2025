# Vulnerability Information: CVE-2025-29907

## Vulnerability Description
jsPDF is a library to generate PDFs in JavaScript. Prior to 3.0.1, **user control of the first argument of the addImage method** results in CPU utilization and denial of service. If given the possibility to pass unsanitised image urls to the addImage method, a user can provide a harmful data-url that results in high CPU utilization and denial of service. Other affected methods are html and addSvgAsImage. The vulnerability was fixed in jsPDF 3.0.1.

### Vulnerability Description Key Phrases
- **component:** addImage method
- **vector:** provide a harmful data-url
- **weakness:** **user control of the first argument of the addImage method**
- **product:** jsPDF
- **impact:** CPU utilization, denial of service
- **version:** prior to 3.0.1

## CVE Reference Links Content Summary
```
- Root cause of vulnerability:
  - User control of the first argument of the `addImage` method results in CPU utilization and denial of service.  A harmful data-url can be provided, leading to high CPU utilization.

- Weaknesses/vulnerabilities present:
  - ReDoS (Regular Expression Denial of Service) vulnerability.
  - CWE-400: Uncontrolled Resource Consumption

- Impact of exploitation:
  - Denial of Service

- Attack vectors:
  - Passing unsanitized image urls to the `addImage` method.
  - Other affected methods: `html`, `addSvgAsImage`.

- Required attacker capabilities/position:
  - User access to provide a malicious data-url.

- Mitigation or fix:
  - Upgrade to jsPDF@>=3.0.1
  - Sanitize image urls before passing it to the `addImage` method or one of the other affected methods.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.491 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.451 |
| 3 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.448 |
| 4 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.440 |
| 5 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.437 |
| 6 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | Allowed-with-Review | sparse | 0.437 |
| 7 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.434 |
| 8 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.433 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.423 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.002 |

