{
  "method": "sparse_weakness_1",
  "query": "In the Linux kernel, the following vulnerability has been resolved ext4 do not create EA inode under buffer lock ext4_xattr_set_entry() creates new EA inodes while holding buffer lock on the external xattr block. This is problematic as it nests all the allocation locking (which acquires locks on other buffers) under the buffer lock. This can even deadlock when the filesystem is corrupted and e.g. quota file is setup to contain xattr block as data block. Move the allocation of EA inode out of ext4_xattr_set_entry() into the callers.",
  "keyphrases": {
    "weakness": "improper locking"
  },
  "timestamp": "2025-07-13T12:45:07.885227",
  "results_count": 10,
  "results_summary": [
    {
      "doc_id": "667",
      "name": "Improper Locking",
      "score": 442.3525665706043
    },
    {
      "doc_id": "833",
      "name": "Deadlock",
      "score": 427.31467793490754
    },
    {
      "doc_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 389.8118350876958
    },
    {
      "doc_id": "190",
      "name": "Integer Overflow or Wraparound",
      "score": 388.2680295055102
    },
    {
      "doc_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 372.02440482089804
    }
  ]
}