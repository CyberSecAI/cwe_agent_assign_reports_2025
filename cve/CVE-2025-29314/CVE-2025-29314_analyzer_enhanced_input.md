## Vulnerability Description
Insecure Shiro cookie configurations in OpenDaylight Service Function Chaining (SFC) Subproject SFC Sodium-SR4 and below allow attackers to access sensitive information via a man-in-the-middle attack.

### Vulnerability Description Key Phrases
- **rootcause:** **insecure Shiro cookie configurations**
- **impact:** access sensitive information
- **vector:** man-in-the-middle attack
- **attacker:** attackers
- **product:** OpenDaylight Service Function Chaining (SFC) Subproject SFC Sodium
- **version:** SR4 and below

## CVE Reference Links Content Summary
The content describes a session hijacking vulnerability in the OpenDaylight SFC module due to insecure cookie configurations and session fixation, allowing attackers to bypass authentication and manipulate SFC resources.

Here's a breakdown:

*   **Root cause of vulnerability:**
    *   Disabled Secure/HttpOnly cookie flags.
    *   Session fixation flaws.
*   **Weaknesses/vulnerabilities present:**
    *   Insecure session ID transmission over HTTP due to the missing Secure flag.
    *   Client-side session ID exposure because of the missing HttpOnly attribute.
    *   Session fixation: Shiro does not regenerate session IDs after login.
*   **Impact of exploitation:**
    *   Session hijacking, allowing attackers to impersonate legitimate users.
    *   Privilege escalation: A user-role account can perform admin-level actions.
    *   Service disruption: Configurations can be removed, breaking the RSP path and blocking traffic forwarding.
*   **Attack vectors:**
    *   Man-in-the-middle (MITM) attacks to intercept session IDs transmitted over HTTP.
    *   Exploiting the lack of HttpOnly to steal session IDs via client-side code execution.
    *   Exploiting session fixation by forcing victims to use a predefined session ID.
*   **Required attacker capabilities/position:**
    *   Network access to intercept traffic (e.g., via ARP spoofing, rogue Wi-Fi).
    *   Ability to construct and send malicious HTTP requests with a stolen or forged session ID.
*   **Mitigation or fix:**
    *   Enabling Secure and HttpOnly flags for session cookies.
    *   Regenerating session IDs after successful authentication.
    *   Implementing more robust authorization mechanisms beyond session ID validation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.153 |
| 2 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | sparse | 0.147 |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.146 |
| 4 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.144 |
| 5 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.143 |
| 6 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | sparse | 0.142 |
| 7 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.142 |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.141 |
| 9 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | Allowed | dense | 0.510 |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-522: Insufficiently Protected Credentials

CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-1188: Initialization of a Resource with an Insecure Default

CWE-319: Cleartext Transmission of Sensitive Information

CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag

CWE-321: Use of Hard-coded Cryptographic Key

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-784: Reliance on Cookies without Validation and Integrity Checking in a Security Decision

CWE-386: Symbolic Name not Mapping to Correct Object