{
  "cve_id": "CVE-2025-0217",
  "description": "BeyondTrust Privileged Remote Access (PRA) versions prior to 25.1 are vulnerable to a local authentication bypass. A local authenticated attacker can view the connection details of a ShellJump session that was initiated with external tools, allowing unauthorized access to connected sessions.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "view the connection details of a ShellJump session",
    "vector": "",
    "attacker": "local authenticated attacker",
    "product": "BeyondTrust Privileged Remote Access (PRA)",
    "version": "prior to 25.1",
    "component": ""
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.75 | Base | Allowed | Primary CWE. The authorization is bypassed when a local authenticated attacker views the connection details of a ShellJump session using external tools. |\n| CWE-284 | Improper Access Control | 0.5 | Pillar | Discouraged | Secondary Candidate. Because the root cause is authorization bypass, and because a more specific CWE is available, this general CWE is not the best choice. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.70\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship that influenced the decision was the hierarchical structure with CWE-639 being a more specific form of access control issue than the higher level CWE-284. There are also other authorization related CWEs to consider.\n\n```mermaid\ngraph TD\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n\n    cwe639 -->|CHILDOF| cwe863\n    cwe863 -->|CHILDOF| cwe285\n    cwe285 -->|CHILDOF| cwe284\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe639 primary\n    class cwe284,cwe863,cwe285 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain involves a **WEAKNESS** in the authorization mechanism, allowing an attacker to bypass intended restrictions and gain unauthorized access to sensitive information.\n  - The root cause is the authorization bypass through a user-controlled key.\n  - The impact is unauthorized access to connection details of a ShellJump session.\n\n## Summary of Analysis\nThe analysis focused on identifying the root cause of the vulnerability, which is the authorization bypass. The description explicitly mentions that a local authenticated attacker can view connection details of a ShellJump session that was initiated with external tools. This indicates that the attacker is bypassing authorization checks to access sensitive information.\n\nThe selection of CWE-639 is based on the following:\n  - The vulnerability involves an authorization bypass, aligning with the core concept of CWE-639.\n  - The attacker is using external tools to view connection details, suggesting a manipulation of the key value identifying the data.\n  - CWE-639 is a Base level CWE, providing a specific and accurate representation of the weakness.\n\nThe retriever results also support the selection of authorization-related CWEs, such as CWE-863 and CWE-285, but CWE-639 is a more precise match for the vulnerability description.\n\nThe decision is based on the evidence that the authorization mechanism is being bypassed to access sensitive information. The description states: \"A local authenticated attacker can view the connection details of a ShellJump session that was initiated with external tools, allowing unauthorized access to connected sessions.\" This clearly indicates that the attacker is circumventing the intended authorization controls. The abstraction level of CWE-639 (Base) is optimal because it provides a specific representation of the authorization bypass.\n\nI considered other CWEs like CWE-284, CWE-863, CWE-285, and CWE-306, but they were not as fitting as CWE-639:\n  - CWE-284 (Improper Access Control) is too general and doesn't capture the specific nature of the authorization bypass.\n  - CWE-863 (Incorrect Authorization) and CWE-285 (Improper Authorization) are related to authorization issues, but they don't specifically address the manipulation of key values to bypass authorization.\n  - CWE-306 (Missing Authentication for Critical Function) is not applicable because the attacker is authenticated.\n  - CWE-532 (Insertion of Sensitive Information into Log File) is not relevant as the vulnerability is not about logging sensitive information.\n  - CWE-287 (Improper Authentication) is not relevant as the attacker is authenticated.\n\nRelevant CWE Information:\n\n## CWE-639: Authorization Bypass Through User-Controlled Key\n**Abstraction Level**: Base\n**Similarity Score**: 1183.42\n**Source**: sparse\n\n**Description**:\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.75 | Base | Allowed | Primary CWE. The authorization is bypassed when a local authenticated attacker views the connection details of a ShellJump session using external tools. |\n| CWE-284 | Improper Access Control | 0.5 | Pillar | Discouraged | Secondary Candidate. Because the root cause is authorization bypass, and because a more specific CWE is available, this general CWE is not the best choice. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.70\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship that influenced the decision was the hierarchical structure with CWE-639 being a more specific form of access control issue than the higher level CWE-284. There are also other authorization related CWEs to consider.\n\n```mermaid\ngraph TD\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n\n    cwe639 -->|CHILDOF| cwe863\n    cwe863 -->|CHILDOF| cwe285\n    cwe285 -->|CHILDOF| cwe284\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe639 primary\n    class cwe284,cwe863,cwe285 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain involves a **WEAKNESS** in the authorization mechanism, allowing an attacker to bypass intended restrictions and gain unauthorized access to sensitive information.\n  - The root cause is the authorization bypass through a user-controlled key.\n  - The impact is unauthorized access to connection details of a ShellJump session.\n\n## Summary of Analysis\nThe analysis focused on identifying the root cause of the vulnerability, which is the authorization bypass. The description explicitly mentions that a local authenticated attacker can view connection details of a ShellJump session that was initiated with external tools. This indicates that the attacker is bypassing authorization checks to access sensitive information.\n\nThe selection of CWE-639 is based on the following:\n  - The vulnerability involves an authorization bypass, aligning with the core concept of CWE-639.\n  - The attacker is using external tools to view connection details, suggesting a manipulation of the key value identifying the data.\n  - CWE-639 is a Base level CWE, providing a specific and accurate representation of the weakness.\n\nThe retriever results also support the selection of authorization-related CWEs, such as CWE-863 and CWE-285, but CWE-639 is a more precise match for the vulnerability description.\n\nThe decision is based on the evidence that the authorization mechanism is being bypassed to access sensitive information. The description states: \"A local authenticated attacker can view the connection details of a ShellJump session that was initiated with external tools, allowing unauthorized access to connected sessions.\" This clearly indicates that the attacker is circumventing the intended authorization controls. The abstraction level of CWE-639 (Base) is optimal because it provides a specific representation of the authorization bypass.\n\nI considered other CWEs like CWE-284, CWE-863, CWE-285, and CWE-306, but they were not as fitting as CWE-639:\n  - CWE-284 (Improper Access Control) is too general and doesn't capture the specific nature of the authorization bypass.\n  - CWE-863 (Incorrect Authorization) and CWE-285 (Improper Authorization) are related to authorization issues, but they don't specifically address the manipulation of key values to bypass authorization.\n  - CWE-306 (Missing Authentication for Critical Function) is not applicable because the attacker is authenticated.\n  - CWE-532 (Insertion of Sensitive Information into Log File) is not relevant as the vulnerability is not about logging sensitive information.\n  - CWE-287 (Improper Authentication) is not relevant as the attacker is authenticated.\n\nRelevant CWE Information:\n\n## CWE-639: Authorization Bypass Through User-Controlled Key\n**Abstraction Level**: Base\n**Similarity Score**: 1183.42\n**Source**: sparse\n\n**Description**:\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-639:**\n- 639 (Authorization Bypass Through User-Controlled Key) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "532",
        "name": "Insertion of Sensitive Information into Log File",
        "source": "sparse"
      },
      "similarity": 86.97501481655296
    },
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "sparse"
      },
      "similarity": 83.60287072638195
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 81.97033308784185
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 80.5977540489008
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 80.44849596192036
    },
    {
      "metadata": {
        "doc_id": "256",
        "name": "Plaintext Storage of a Password",
        "source": "sparse"
      },
      "similarity": 79.38729308235052
    },
    {
      "metadata": {
        "doc_id": "425",
        "name": "Direct Request ('Forced Browsing')",
        "source": "sparse"
      },
      "similarity": 79.0870003862199
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 78.7876560726126
    },
    {
      "metadata": {
        "doc_id": "250",
        "name": "Execution with Unnecessary Privileges",
        "type": "Base",
        "original_content": "The product performs an operation at a privilege level that is higher than the minimum level required, which creates new weaknesses or amplifies the consequences of other weaknesses.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5146407471966395,
            "graph": 1.7187559387816302
          }
        }
      },
      "similarity": 0.5146407471966395
    },
    {
      "doc_id": "613",
      "text": "CWE-613: Insufficient Session Expiration",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "613",
        "name": "Insufficient Session Expiration",
        "type": "base",
        "original_content": "CWE-613: Insufficient Session Expiration",
        "relationships": [
          {
            "source_id": "613",
            "target_id": "352",
            "label": "REQUIREDBY",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "613",
            "target_id": "287",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "613",
            "target_id": "672",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "613",
            "target_id": "672",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "672",
            "target_id": "613",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "352",
            "target_id": "613",
            "label": "REQUIRES",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "287",
            "target_id": "613",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "287",
                  "613",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "287"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "287",
                  "613",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "287"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "613",
                  "287",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "287"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-639",
      "CWE-306",
      "CWE-285",
      "CWE-284",
      "CWE-287",
      "CWE-532"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}