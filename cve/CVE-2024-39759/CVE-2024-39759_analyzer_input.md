# Vulnerability Information: CVE-2024-39759

## Vulnerability Description
Multiple OS command injection vulnerabilities exist in the login.cgi set_sys_init() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary code execution. An attacker can make an unauthenticated HTTP request to trigger these vulnerabilities.A **command injection vulnerability** exists within the `restart_hour_value` POST parameter.

### Vulnerability Description Key Phrases
- **weakness:** **command injection vulnerability**
- **impact:** arbitrary code execution
- **vector:** specially crafted HTTP request
- **product:** Wavlink AC3000
- **version:** M33A8.V5030.210505
- **component:** login.cgi set_sys_init() functionality

## CVE Reference Links Content Summary
## Analysis of CVE-2024-39759 Content

This content is directly related to CVE-2024-39759 and provides significantly more detail than a standard CVE description.

**Root cause of vulnerability:**

The `login.cgi` binary lacks authentication checks, and improperly handles user-supplied input in the `set_sys_init()` function when processing the `restart_hour_value`, `restart_min_value`, and `restart_week_value` POST parameters. This allows for command injection.

**Weaknesses/vulnerabilities present:**

*   **CWE-77 - Improper Neutralization of Special Elements used in a Command (‘Command Injection’):** The vulnerability stems from insufficient input validation and sanitization, leading to arbitrary command execution.
*   Lack of authentication checks in `login.cgi`.
*   Unsafe use of `sprintf` and `snprintf` with user-controlled data.

**Impact of exploitation:**

Successful exploitation leads to arbitrary code execution on the Wavlink AC3000 router.

**Attack vectors:**

*   An unauthenticated attacker can send a specially crafted HTTP POST request to the `login.cgi` endpoint.
*   Specifically, manipulating the `restart_hour_value`, `restart_min_value`, or `restart_week_value` parameters allows injection of commands into a crontab entry.

**Required attacker capabilities/position:**

*   Network access to the Wavlink AC3000 router.
*   No authentication is required.
*   Understanding of HTTP POST requests and crontab syntax.

**Mitigation or fix:**

The report does not specify a fix, but implies that proper input validation and sanitization within the `login.cgi` script, particularly when handling the `set_sys_init()` function and its associated parameters, are necessary to mitigate the vulnerability. The vendor was contacted, and is working on patches.

**Additional Details:**

*   **Affected Product:** Wavlink AC3000 M33A8.V5030.210505
*   **CVSSv3 Score:** 10.0 (Critical)
*   The vulnerability allows injecting commands into the `SCH_Reboot` nvram item, which is then used to create a crontab entry for the `adm2860` user.
*   The report details the code flow and specific functions involved in the vulnerability.
*   The report provides a timeline of vendor communication.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.348 |
| 3 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.344 |
| 4 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.333 |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.323 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.294 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.294 |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.292 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.619 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

