## Vulnerability Description
A vulnerability, which was classified as problematic, has been found in Cosmote Greece Whats Up App 4.47.3 on Android. This issue affects some unknown processing of the file gr/desquared/kmmsharedmodule/db/RealmDB.java of the component Realm Database Handler. The manipulation of the argument defaultRealmKey leads to use of default cryptographic key. Local access is required to approach this attack. The complexity of an attack is rather high. The exploitation is known to be difficult. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **rootcause:** **manipulation of defaultRealmKey argument**
- **impact:** use default cryptographic key
- **product:** Cosmote Greece Whats Up App
- **version:** 4.47.3
- **component:** Realm Database Handler

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-10748.

**Root cause of vulnerability:**
The application embeds a hardcoded encryption key (`defaultRealmKey`) within the source code file `gr/desquared/kmmsharedmodule/db/RealmDB.java`. This key is used to encrypt the Realm database file named `defaultKMMV4.realm.enc`.

**Weaknesses/vulnerabilities present:**
- Hardcoded encryption key within the application's source code.
- Use of the same encryption key across all installations of the application.
- Insecure storage of the encryption key within the application's APK.

**Impact of exploitation:**
- Unauthorized access to confidential user information, including sensitive personal data and credit card details by decrypting the database.
- Violation of data protection regulations like GDPR, HIPAA, etc.

**Attack vectors:**
- Reverse engineering and decompiling the application's APK file to extract the hardcoded encryption key.
- Gaining access to the device or a backup of the application's data to decrypt the database contents.

**Required attacker capabilities/position:**
- Ability to obtain and decompile the application's APK file.
- Ability to access the application's encrypted database file either directly from the device or via a backup.
- Basic understanding of encryption and decryption techniques.

The content provides more technical details than the official CVE description, including:
- The specific location of the hardcoded key within the source code (`RealmDB.java`).
- The exact hardcoded key value.
- Code snippets for decrypting the database using the hardcoded key, both in Java and in a Realm Studio.
- Recommendations for secure encryption key management, including using Android Keystore, generating unique keys per device, and using KDFs.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.580 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.550 |
| 3 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.503 |
| 4 | 704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | sparse | 0.501 |
| 5 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.500 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.494 |
| 7 | 927 | Use of Implicit Intent for Sensitive Communication | Variant | Allowed | sparse | 0.490 |
| 8 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.476 |
| 9 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | dense | 0.562 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-208: Observable Timing Discrepancy

CWE-704: Incorrect Type Conversion or Cast

CWE-203: Observable Discrepancy

CWE-125: Out-of-bounds Read

CWE-927: Use of Implicit Intent for Sensitive Communication

CWE-341: Predictable from Observable State

CWE-321: Use of Hard-coded Cryptographic Key

CWE-184: Incomplete List of Disallowed Inputs