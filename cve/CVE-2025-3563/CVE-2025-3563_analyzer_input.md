# Vulnerability Information: CVE-2025-3563

## Vulnerability Description
A vulnerability was found in WuzhiCMS 4.1. It has been rated as critical. Affected by this issue is the function Set of the file /index.php?m=attachment&f=index&_su=wuzhicms&v=set&submit=1 of the component Setting Handler. The manipulation of the argument Setting leads to **code injection**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **code injection**
- **product:** WuzhiCMS
- **version:** 4.1
- **component:** Setting Handler

## CVE Reference Links Content Summary
The content relates to a vulnerability in WuzhiCMS 4.1, specifically a command execution vulnerability in the `set_cache` function. This is a more detailed description than a placeholder CVE description.

Here's the extracted information:

**Root cause of vulnerability:**

Insufficient input filtering and validation of the `setting` parameter in the `set_cache` function. The parameter's content is directly written to a file without proper sanitization.

**Weaknesses/vulnerabilities present:**

*   File upload vulnerability (leading to arbitrary code execution)
*   Lack of input validation
*   Unsafe direct file writing

**Impact of exploitation:**

*   Arbitrary code execution on the server.
*   Ability to create or overwrite files on the server.

**Attack vectors:**

*   HTTP GET request to `/index.php?m=attachment&f=index&_su=wuzhicms&v=set&submit=1&setting=%3C?php%20echo%20phpinfo()?%3E` (requires execution twice).
*   Requires administrator privileges.

**Required attacker capabilities/position:**

*   Administrator privileges.
*   Ability to send HTTP requests to the target server.

**Mitigation or fix:**

The content does not provide specific mitigation or fix details, only that the vulnerability exists due to insufficient filtering and validation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.519 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.513 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.436 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.424 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.423 |
| 6 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.422 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.417 |
| 8 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.415 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.647 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |

