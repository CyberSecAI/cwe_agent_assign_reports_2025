## Vulnerability Description
FastCGI fcgi2 (aka fcgi) 2.x through 2.4.4 has an **integer overflow** (and resultant heap-based buffer overflow) via crafted nameLen or valueLen values in data to the IPC socket. This occurs in ReadParams in fcgiapp.c.

### Vulnerability Description Key Phrases
- **component:** ReadParams in fcgiapp.c
- **rootcause:** **integer overflow**
- **vector:** crafted nameLen or valueLen values
- **weakness:** **integer overflow, heap-based buffer overflow**
- **product:** FastCGI fcgi2 (aka fcgi)
- **version:** 2.x through 2.4.4

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
- An integer overflow in the ReadParams function due to improper handling of nameLen and valueLen values, which are read from the input data.
- This leads to a heap-based buffer overflow.

Weaknesses/vulnerabilities present:
- Integer overflow (CWE-190)
- Heap-based buffer overflow

Impact of exploitation:
- Remote Code Execution (RCE)

Attack vectors:
- Sending crafted data to the IPC socket.
- The vulnerability can be triggered through a web server that uses the FastCGI library.
- The FastCGI socket is exposed.

Required attacker capabilities/position:
- The attacker needs to send crafted data to the FastCGI socket.
- The attacker might need another vulnerability (SSRF) to be able to access the socket.

Mitigation or fix:
- Update to version 2.4.5 of the FastCGI library or higher.
- Limiting potential remote access to the FastCGI socket by declaring it as a UNIX socket.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 2 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.267 |
| 4 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.249 |
| 5 | 681 | Incorrect Conversion between Numeric Types | Base | Allowed | sparse | 0.248 |
| 6 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.242 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.239 |
| 8 | 195 | Signed to Unsigned Conversion Error | Variant | Allowed | sparse | 0.236 |
| 9 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | dense | 0.574 |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | graph | 0.003 |



# Complete CWE Specifications

CWE-190: Integer Overflow or Wraparound

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-122: Heap-based Buffer Overflow

CWE-193: Off-by-one Error

CWE-681: Incorrect Conversion between Numeric Types

CWE-197: Numeric Truncation Error

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-195: Signed to Unsigned Conversion Error

CWE-130: Improper Handling of Length Parameter Inconsistency

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')