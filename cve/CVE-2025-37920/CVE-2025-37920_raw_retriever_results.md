# Raw Retriever Results for CVE-2025-37920

# Raw Retriever Results for CVE-2025-37920
## Query
In the Linux kernel, the following vulnerability has been resolved xsk Fix race condition in AF_XDP generic RX path Move rx_lock from xsk_socket to xsk_buff_pool. Fix synchronization for shared umem mode in generic RX path where multiple sockets share single xsk_buff_pool. RX queue is exclusive to xsk_socket, while FILL queue can be shared between multiple sockets. This could result in race condition where two CPU cores access RX path of two different sockets sharing the same umem. Protect both queues by acquiring spinlock in shared xsk_buff_pool. Lock contention may be minimized in the future by some per-thread FQ buffering. Its safe and necessary to move spin_lock_bh(rx_lock) after xsk_rcv_check() * xs->pool and spinlock_init is synchronized by xsk_bind() -> xsk_is_bound() memory barriers. * xsk_rcv_check() may return true at the moment of xsk_release() or xsk_unbind_dev(), however this will not cause any data races or race conditions. xsk_unbind_dev() removes xdp socket from all maps and waits for completion of all outstanding rx operations. Packets in RX path will either complete safely or drop.

## Keyphrases
- **rootcause**: 'race condition'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4137 | 0.5151 | 0.4431 | 0.4439 | 20 |
| Sparse | 599.0969 | 1000.0000 | 703.7833 | 682.7470 | 10 |
| Graph | 1.6848 | 2.8652 | 1.9687 | 1.9586 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 2 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 3 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 4 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 5 | 368 | Context Switching Race Condition | base | 2.1762 | Allowed |
| 6 | 364 | Signal Handler Race Condition | Base | 2.1280 | Allowed |
| 7 | 479 | Signal Handler Use of a Non-reentrant Function | variant | 2.0659 | Allowed |
| 8 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 9 | 415 | Double Free | variant | 2.0400 | Allowed |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 2.0197 | Allowed |
| 11 | 606 | Unchecked Input for Loop Condition | Base | 1.8976 | Allowed |
| 12 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7486 | Allowed-with-Review |
| 14 | 662 | Improper Synchronization | Class | 1.7154 | Discouraged |
| 15 | 366 | Race Condition within a Thread | Base | 1.6896 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5151 | 0.5151 | Allowed-with-Review |
| 2 | 366 | Race Condition within a Thread | Base | 0.4889 | 0.4889 | Allowed |
| 3 | 667 | Improper Locking | Class | 0.4634 | 0.4634 | Allowed-with-Review |
| 4 | 364 | Signal Handler Race Condition | Base | 0.4623 | 0.4623 | Allowed |
| 5 | 606 | Unchecked Input for Loop Condition | Base | 0.4590 | 0.4590 | Allowed |
| 6 | 909 | Missing Initialization of Resource | Class | 0.4548 | 0.4548 | Allowed-with-Review |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4514 | 0.4514 | Allowed |
| 8 | 833 | Deadlock | Base | 0.4505 | 0.4505 | Allowed |
| 9 | 413 | Improper Resource Locking | Base | 0.4473 | 0.4473 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4461 | 0.4461 | Allowed |
| 11 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4417 | 0.4417 | Allowed |
| 12 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4370 | 0.4370 | Allowed |
| 13 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4226 | 0.4226 | Allowed |
| 14 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4222 | 0.4222 | Discouraged |
| 15 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4208 | 0.4208 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 662 | Improper Synchronization | 840.0247 | 840.0247 | Discouraged |
| 3 | 667 | Improper Locking | 716.6701 | 716.6701 | Allowed-with-Review |
| 4 | 364 | Signal Handler Race Condition | 707.3859 | 707.3859 | Allowed |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 698.7451 | 698.7451 | Allowed |
| 6 | 789 | Memory Allocation with Excessive Size Value | 666.7489 | 666.7489 | Allowed |
| 7 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 605.3926 | 605.3926 | Allowed |
| 8 | 400 | Uncontrolled Resource Consumption | 602.7851 | 602.7851 | Discouraged |
| 9 | 1251 | Mirrored Regions with Different Values | 600.9834 | 600.9834 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | 599.0969 | 599.0969 | Allowed |
