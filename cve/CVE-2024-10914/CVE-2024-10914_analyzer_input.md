# Vulnerability Information: CVE-2024-10914

## Vulnerability Description
A vulnerability was found in D-Link DNS-320, DNS-320LW, DNS-325 and DNS-340L up to 20241028. It has been declared as critical. Affected by this vulnerability is the function cgi_user_add of the file /cgi-bin/account_mgr.cgi?cmd=cgi_user_add. The manipulation of the argument name leads to **os command injection**. The attack can be launched remotely. The complexity of an attack is rather high. The exploitation appears to be difficult. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **os command injection**
- **vector:** manipulation of the argument name
- **product:** D-Link DNS-320 and DNS-320LW and DNS-325 and DNS-340L
- **version:** up to 20241028
- **component:** /cgi-bin/account_mgr.cgi?cmd=cgi_user_add

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-78

#### Top CWEs
- CWE-78 (Count: 6)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability described:

**Root Cause of Vulnerability:**
- The vulnerability lies in the `cgi_user_add` command within D-Link NAS devices. The `name` parameter of this command is not properly sanitized.

**Weaknesses/Vulnerabilities Present:**
- **Command Injection:** The lack of proper sanitization allows an attacker to inject arbitrary shell commands via the `name` parameter. This is achieved by crafting a specific HTTP GET request.

**Impact of Exploitation:**
- **Arbitrary Command Execution:** Successful exploitation allows an attacker to execute shell commands on the affected device. This could lead to a variety of malicious activities, including data theft, malware installation, or complete device takeover.

**Attack Vectors:**
- **HTTP GET Requests:** The vulnerability can be triggered by sending specially crafted HTTP GET requests to the device's web interface.
- **Unauthenticated Access:** The exploit does not require authentication, making it accessible to any attacker who can reach the vulnerable device's web interface.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable device. This could be achieved via local network access or from the public internet if the device's management interface is exposed.
- **Basic Knowledge of HTTP Requests:** The attacker needs to be able to construct the malicious HTTP GET request.

**Technical Details:**
- A sample exploit is provided as a curl request:
   `curl "http://[Target-IP]/cgi-bin/account_mgr.cgi cmd=cgi_user_add&name=%27;<INJECTED_SHELL_COMMAND>;%27"`
- This request shows how the `name` parameter is used to inject shell commands within single quotes.

**Additional Information:**
- The vulnerability affects multiple D-Link NAS models, specifically: DNS-320, DNS-320LW, DNS-325, and DNS-340L.
-  The vendor, D-Link, has stated they will not issue a patch for this vulnerability due to the products being end-of-life, advising users to retire the vulnerable devices.
- If retirement is not immediately possible, D-Link advises to isolate the devices from the public internet or implement stricter access control.
-  A large number of vulnerable devices (over 60,000) have been identified exposed to the internet, highlighting the broad attack surface.
- This vulnerability is similar to a previous one (CVE-2024-3273) affecting the same D-Link NAS devices.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.534 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.510 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.448 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.445 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.442 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.440 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.627 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

