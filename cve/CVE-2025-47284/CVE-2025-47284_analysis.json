{
  "cve_id": "CVE-2025-47284",
  "description": "Gardener implements the automated management and operation of Kubernetes clusters as a service. A security vulnerability was discovered in the `gardenlet` component of Gardener prior to versions 1.116.4, 1.117.5, 1.118.2, and 1.119.0. It could allow a user with administrative privileges for a Gardener project to obtain control over the seed cluster(s) where their shoot clusters are managed. This CVE affects all Gardener installations where gardener/gardener-extension-provider-gcp is in use. Versions 1.116.4, 1.117.5, 1.118.2, and 1.119.0 fix the issue.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "obtain control over the seed cluster(s) where their shoot clusters are managed",
    "vector": "",
    "attacker": "user with administrative privileges for a Gardener project",
    "product": "Gardener",
    "version": "prior to versions 1.116.4, 1.117.5, 1.118.2, and 1.119.0",
    "component": "gardenlet component"
  },
  "reference_content": "## Analysis of CVE-2025-47284 Content\n\nThis content **IS RELATED** to CVE-2025-47284. It provides detailed information about the vulnerability.\n\n**Root cause of vulnerability:**\n\nMetadata injection for a project secret can lead to privilege escalation.\n\n**Weaknesses/vulnerabilities present:**\n\n* CWE-150: Improperly Handled Special Elements in Input Data\n\n**Impact of exploitation:**\n\nA user with administrative privileges for a Gardener project can obtain control over the seed cluster(s) where their shoot clusters are managed. This results in High impact to Confidentiality, Integrity, and Availability.\n\n**Attack vectors:**\n\nNetwork (AV:N)\n\n**Required attacker capabilities/position:**\n\n* Low privileges required (PR:L) - Attacker needs administrative privileges for a Gardener project.\n* No user interaction required (UI:N)\n\n**Mitigation or fix:**\n\nUpdate to a fixed version:\n* >= v1.116.4\n* >= v1.117.5\n* >= v1.118.2\n* >= v1.119.0\n\n**Additional Details (more than official CVE description):**\n\n*   **Affected Components:** `gardener/gardener` (`gardenlet`)\n*   **Affected versions:** < v1.116.4, < v1.117.5, < v1.118.2, < v1.119.0\n*   **CVSS Score:** 9.9 (Critical) - CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H\n*   **Specific condition:** Affects Gardener installations where `https://github.com/gardener/gardener-extension-provider-gcp` is in use.\n*   **Credits:** Lists the individuals who contributed to the remediation and coordination of the vulnerability.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-267 | Privilege Defined With Unsafe Actions | 0.8 | Base | Allowed | Primary CWE. The vulnerability allows a user with administrative privileges to perform actions that were not intended, leading to control over the seed cluster(s). |\n| CWE-150 | Improperly Handled Special Elements in Input Data | 0.6 | Base | Allowed | Secondary CWE. The CVE Reference Link mentions that this CWE is present in the vulnerability. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE, CWE-267, is a Base level CWE, which is a preferred level of abstraction. The retriever results list several Class level CWEs like CWE-863, CWE-285, and CWE-269. These were not selected as the evidence is more specific and better aligns with the base CWE. There are no significant parent-child relationships to influence the primary selection. There is a secondary CWE, CWE-150, which is a Base level CWE.\n\n```mermaid\ngraph TD\n    cwe267[\"CWE-267: Privilege Defined With Unsafe Actions\"]\n    cwe150[\"CWE-150: Improperly Handled Special Elements in Input Data\"]\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe267 primary\n    class cwe150 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with metadata injection leading to privilege escalation due to **CWE-267 Privilege Defined With Unsafe Actions**. This leads to the impact of a user with administrative privileges gaining control over the seed cluster. The CVE Reference Link mentions that **CWE-150 Improperly Handled Special Elements in Input Data** is also present.\n\n## Summary of Analysis\nThe initial assessment considered several CWEs from the Retriever Results, especially those related to authorization and privileges. However, the evidence from the vulnerability description and CVE reference links pointed towards **CWE-267 Privilege Defined With Unsafe Actions** as the most accurate primary mapping. This is because the vulnerability allows a user with administrative privileges to perform actions that were not intended, leading to control over the seed cluster(s). The inclusion of **CWE-150 Improperly Handled Special Elements in Input Data** from the CVE Reference Link adds another aspect to the analysis.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-267: Privilege Defined With Unsafe Actions\n**Abstraction Level**: Base\n**Similarity Score**: 0.81\n**Source**: dense\n\n**Description**:\nA particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-267 | Privilege Defined With Unsafe Actions | 0.8 | Base | Allowed | Primary CWE. The vulnerability allows a user with administrative privileges to perform actions that were not intended, leading to control over the seed cluster(s). |\n| CWE-150 | Improperly Handled Special Elements in Input Data | 0.6 | Base | Allowed | Secondary CWE. The CVE Reference Link mentions that this CWE is present in the vulnerability. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE, CWE-267, is a Base level CWE, which is a preferred level of abstraction. The retriever results list several Class level CWEs like CWE-863, CWE-285, and CWE-269. These were not selected as the evidence is more specific and better aligns with the base CWE. There are no significant parent-child relationships to influence the primary selection. There is a secondary CWE, CWE-150, which is a Base level CWE.\n\n```mermaid\ngraph TD\n    cwe267[\"CWE-267: Privilege Defined With Unsafe Actions\"]\n    cwe150[\"CWE-150: Improperly Handled Special Elements in Input Data\"]\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe267 primary\n    class cwe150 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with metadata injection leading to privilege escalation due to **CWE-267 Privilege Defined With Unsafe Actions**. This leads to the impact of a user with administrative privileges gaining control over the seed cluster. The CVE Reference Link mentions that **CWE-150 Improperly Handled Special Elements in Input Data** is also present.\n\n## Summary of Analysis\nThe initial assessment considered several CWEs from the Retriever Results, especially those related to authorization and privileges. However, the evidence from the vulnerability description and CVE reference links pointed towards **CWE-267 Privilege Defined With Unsafe Actions** as the most accurate primary mapping. This is because the vulnerability allows a user with administrative privileges to perform actions that were not intended, leading to control over the seed cluster(s). The inclusion of **CWE-150 Improperly Handled Special Elements in Input Data** from the CVE Reference Link adds another aspect to the analysis.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-267: Privilege Defined With Unsafe Actions\n**Abstraction Level**: Base\n**Similarity Score**: 0.81\n**Source**: dense\n\n**Description**:\nA particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-150:**\n- 150 (Improper Neutralization of Escape, Meta, or Control Sequences) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "532",
        "name": "Insertion of Sensitive Information into Log File",
        "source": "sparse"
      },
      "similarity": 149.50826703639692
    },
    {
      "metadata": {
        "doc_id": "259",
        "name": "Use of Hard-coded Password",
        "source": "sparse"
      },
      "similarity": 147.91345315539718
    },
    {
      "metadata": {
        "doc_id": "319",
        "name": "Cleartext Transmission of Sensitive Information",
        "source": "sparse"
      },
      "similarity": 146.42173793607083
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 145.45000562380045
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 144.13364796839912
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 144.1241461388978
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 144.11781090941756
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 143.9880806514719
    },
    {
      "metadata": {
        "doc_id": "267",
        "name": "Privilege Defined With Unsafe Actions",
        "type": "Base",
        "original_content": "A particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.48896684135252577,
            "graph": 1.6157911937642568
          }
        }
      },
      "similarity": 0.48896684135252577
    },
    {
      "doc_id": "472",
      "text": "CWE-472: External Control of Assumed-Immutable Web Parameter",
      "score": 1.7680000000000005,
      "metadata": {
        "doc_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "type": "base",
        "original_content": "CWE-472: External Control of Assumed-Immutable Web Parameter",
        "relationships": [
          {
            "source_id": "472",
            "target_id": "656",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "384",
            "label": "REQUIREDBY",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "642",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "656",
            "target_id": "472",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "642",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "384",
            "target_id": "472",
            "label": "REQUIRES",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 0.8,
          "sequence_path": 0.8
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "259",
                  "656",
                  "CANFOLLOW"
                ],
                [
                  "656",
                  "472",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.8,
              "type": "relationship_chain",
              "source": "259"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "259",
                  "656",
                  "CANFOLLOW"
                ],
                [
                  "656",
                  "472",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.8,
              "type": "vulnerability_sequence_forward",
              "source": "259"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 1.7680000000000005
          }
        }
      },
      "similarity": 1.7680000000000005
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-150",
      "CWE-269",
      "CWE-285",
      "CWE-267"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}