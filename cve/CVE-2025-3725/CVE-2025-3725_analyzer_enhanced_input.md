## Vulnerability Description
A vulnerability was found in PCMan FTP Server 2.0.7. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the component MIC Command Handler. The manipulation leads to **buffer overflow**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** MIC Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3725 Content

This content **RELATES** to a vulnerability in PCMan FTP Server. It details a remote buffer overflow in the `MIC` command of version 2.0.7.

Here's a breakdown of the extracted information:

**Root cause of vulnerability:**
A buffer overflow exists in the handling of the `MIC` command. The vulnerability is triggered by sending a large payload to the `MIC` command, exceeding the buffer's capacity.

**Weaknesses/vulnerabilities present:**
- Buffer Overflow
- Improper Input Validation

**Impact of exploitation:**
The exploit aims to overwrite the instruction pointer (EIP) to gain control of the execution flow, potentially leading to arbitrary code execution. The provided code attempts to execute a reverse shell.

**Attack vectors:**
- Remote: The vulnerability is exploitable remotely via the FTP protocol.
- Specifically, sending a crafted `MIC` command.

**Required attacker capabilities/position:**
- Network access to the target FTP server.
- Ability to send FTP commands.
- Knowledge of the buffer overflow offset (2007 bytes) and a suitable jump address (0x74e32fd9 - JMP ESP).
- Ability to craft a payload (shellcode) compatible with the target architecture (x86 Windows).

**Mitigation or fix:**
The content does not provide information about a specific fix. However, mitigation would involve:
- Implementing proper input validation for the `MIC` command.
- Using safe string handling functions to prevent buffer overflows.
- Updating to a patched version of PCMan FTP Server (if available).

**Additional Details (more than official CVE description):**

- **Version Affected:** 2.0.7
- **Tested on:** Windows XP SP3 (Build 2600)
- **Exploit Details:** The exploit uses a Perl script to connect to the FTP server, send the `MIC` command with a crafted payload, and attempts to trigger the buffer overflow.
- **Payload:** The script includes shellcode designed to establish a reverse TCP connection to `192.168.176.136` on port `4444`.
- **Offset and EIP:** The exploit calculates an offset of 2007 bytes and uses the address `0x74e32fd9` (JMP ESP) to redirect execution to the shellcode.
- **Bad Characters:** The exploit avoids using null bytes (`\x00`), line feeds (`\x0a`), and carriage returns (`\x0d`) in the payload.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.388 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.371 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.333 |
| 7 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.320 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.319 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.585 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-125: Out-of-bounds Read

CWE-121: Stack-based Buffer Overflow

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-128: Wrap-around Error