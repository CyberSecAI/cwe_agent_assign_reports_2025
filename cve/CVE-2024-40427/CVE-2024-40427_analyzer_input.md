# Vulnerability Information: CVE-2024-40427

## Vulnerability Description
**Stack Buffer Overflow** in PX4-Autopilot v1.14.3, which allows attackers to execute commands to exploit this vulnerability and cause the program to refuse to execute

### Vulnerability Description Key Phrases
- **weakness:** **Stack Buffer Overflow**
- **product:** PX4-Autopilot
- **impact:** execute commands, program to refuse to execute
- **attacker:** attackers
- **version:** v1.14.3

## CVE Reference Links Content Summary
## Analysis of CVE-2024-40427 related content

The provided content details a stack-buffer overflow vulnerability in the PX4 Autopilot project, specifically within the `mavlink_receiver.cpp` file. This vulnerability is identified as GHSA-55wq-2hgm-75m4.

**1. Root cause of vulnerability:**

The root cause is a lack of bounds checking on the `serial_control_mavlink.count` variable when writing data to the `serial_control_mavlink.data` buffer. Specifically, the code doesn't verify that `serial_control_mavlink.count` is less than or equal to the size of the `serial_control_mavlink.data` buffer before performing the write operation.

**2. Weaknesses/vulnerabilities present:**

*   **Stack-based buffer overflow:** The vulnerability allows an attacker to write beyond the allocated buffer on the stack, potentially overwriting adjacent memory regions.
*   **Lack of input validation:** The code fails to validate the size of the incoming data (`serial_control_mavlink.count`) before copying it into the buffer.

**3. Impact of exploitation:**

*   **Denial of Service (DoS):** The overflow can cause the program to crash, leading to a denial of service.
*   **Unexpected drone behavior:**  The vulnerability could potentially lead to unpredictable drone behavior if the overflow overwrites critical data on the stack.

**4. Attack vectors:**

*   **Remote MAVLINK message:** An attacker can exploit the vulnerability by sending a specially crafted MAVLINK message (specifically `MAVLINK_MSG_ID_SERIAL_CONTROL`) to the drone.
*   **Network access:** Requires network access to send the MAVLINK message.

**5. Required attacker capabilities/position:**

*   **Network access:** The attacker needs network connectivity to the drone.
*   **MAVLINK protocol knowledge:** The attacker needs to understand the MAVLINK protocol to craft a valid message with a malicious payload.
*   **Low privileges:** The CVSS score indicates low privileges are required.
*   **User interaction:** The CVSS score indicates user interaction is required.

**6. Mitigation or fix:**

The commit `e03e026` (mentioned in the first content snippet) fixes the vulnerability by adding a check to ensure that `serial_control_mavlink.count` does not exceed the size of the `serial_control_mavlink.data` buffer before the write operation. The corrected code is:

```c++
if (serial_control_mavlink.count > 0 && serial_control_mavlink.count <= sizeof(serial_control_mavlink.data)) {
```

**Additional Notes:**

*   The content provides more detail than a typical CVE description, including a detailed explanation of the vulnerability, the root cause, the impact, and a PoC (Proof of Concept) exploit.
*   The provided CVSS score is 7.8 (High).
*   The vulnerability was reported by zhangteng0526.
*   The PoC exploit is available at [https://github.com/zhangteng0526/px4_stack-over-flow](url).
*   No CVE ID is currently assigned.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.223 |
| 4 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.195 |
| 5 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.192 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.192 |
| 7 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.190 |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.189 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.567 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

