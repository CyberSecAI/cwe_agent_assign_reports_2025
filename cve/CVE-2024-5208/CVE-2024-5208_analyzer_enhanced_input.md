## Vulnerability Description
An **uncontrolled resource consumption** vulnerability exists in the `upload-link` endpoint of mintplex-labs/anything-llm. This vulnerability allows attackers to cause a denial of service (DOS) by shutting down the server through sending invalid upload requests. Specifically, the server can be made to shut down by sending an empty body with a Content-Length 0 header or by sending a body with arbitrary content, such as asdasdasd, with a Content-Length 9 header. The vulnerability is reproducible by users with at least a Manager role, sending a crafted request to any workspace. This issue indicates that a previous fix was not effective in mitigating the vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **uncontrolled resource consumption**
- **impact:** denial of service (DOS) and resource consumption
- **vector:** crafted upload requests
- **attacker:** attackers
- **product:** mintplex-labs/anything-llm
- **component:** upload-link endpoint

## CVE Reference Links Content Summary
Based on the provided content, it appears that the commit `e2439c6d4c3cfdacd96cd1b7b92d1f89c3cc8459` in the `anything-llm` repository involves changes to the `server/endpoints/workspaces.js` file. Specifically, it removes an exception handler for the patch endpoint related to file and link uploads.

**Root cause of vulnerability:**
The commit removes a `try...catch` block surrounding the code that processes document uploads and link uploads. This means that if an error occurs during the processing of a document or link, the application will no longer catch the error and handle it gracefully, potentially leading to an unhandled exception and application crash.

**Weaknesses/vulnerabilities present:**
- Lack of proper error handling for file and link processing.

**Impact of exploitation:**
- Denial of Service (DoS): If an error occurs, the application may crash due to the unhandled exception, leading to service unavailability.

**Attack vectors:**
- Malicious or corrupted file uploads.
- Malicious links that trigger errors during processing.

**Required attacker capabilities/position:**
- The attacker needs to be able to upload files or provide links to the application, and these inputs should be able to trigger an error during the processing step. This could be an authenticated user with the appropriate permissions.

This commit introduces a vulnerability by removing exception handling and exposing the application to unhandled errors.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.615 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.600 |
| 3 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.588 |
| 4 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.579 |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.571 |
| 6 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | Allowed | sparse | 0.546 |
| 7 | 772 | Missing Release of Resource after Effective Lifetime | Base | Allowed | sparse | 0.543 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.538 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.570 |
| 10 | 476 | NULL Pointer Dereference | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-400: Uncontrolled Resource Consumption

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-789: Memory Allocation with Excessive Size Value

CWE-1333: Inefficient Regular Expression Complexity

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')

CWE-772: Missing Release of Resource after Effective Lifetime

CWE-674: Uncontrolled Recursion

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-476: NULL Pointer Dereference