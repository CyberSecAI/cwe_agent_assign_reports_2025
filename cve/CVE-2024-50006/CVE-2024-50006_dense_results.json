{
  "query": "In the Linux kernel, the following vulnerability has been resolved ext4 fix i_data_sem unlock order in ext4_ind_migrate() Fuzzing reports a possible deadlock in jbd2_log_wait_commit. This issue is triggered when an EXT4_IOC_MIGRATE ioctl is set to require synchronous updates because the file descriptor is opened with O_SYNC. This can lead to the jbd2_journal_stop() function calling jbd2_might_wait_for_commit(), potentially causing a deadlock if the EXT4_IOC_MIGRATE call races with a write(2) system call. This problem only arises when CONFIG_PROVE_LOCKING is enabled. In this case, the jbd2_might_wait_for_commit macro locks jbd2_handle in the jbd2_journal_stop function while i_data_sem is locked. This triggers lockdep because the jbd2_journal_start function might also lock the same jbd2_handle simultaneously. Found by Linux Verification Center (linuxtesting.org) with syzkaller. Rule add",
  "count": 20,
  "results": [
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "abstraction": "Base",
      "score": 0.5260622196061314,
      "original_score": 0.5260622196061314,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 0.5045078223257098,
      "original_score": 0.5045078223257098,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "abstraction": "Base",
      "score": 0.4887799256698441,
      "original_score": 0.4887799256698441,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 0.48838156536089644,
      "original_score": 0.48838156536089644,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "score": 0.47105322312115666,
      "original_score": 0.47105322312115666,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1264",
      "name": "Hardware Logic with Insecure De-Synchronization between Control and Data Channels",
      "abstraction": "Base",
      "score": 0.46289274964215643,
      "original_score": 0.46289274964215643,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "591",
      "name": "Sensitive Data Storage in Improperly Locked Memory",
      "abstraction": "Variant",
      "score": 0.46031993736872995,
      "original_score": 0.46031993736872995,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "abstraction": "Class",
      "score": 0.45897964983415085,
      "original_score": 0.45897964983415085,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "775",
      "name": "Missing Release of File Descriptor or Handle after Effective Lifetime",
      "abstraction": "Variant",
      "score": 0.4579071501298593,
      "original_score": 0.4579071501298593,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "832",
      "name": "Unlock of a Resource that is not Locked",
      "abstraction": "Base",
      "score": 0.45631417144494574,
      "original_score": 0.45631417144494574,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1342",
      "name": "Information Exposure through Microarchitectural State after Transient Execution",
      "abstraction": "Base",
      "score": 0.4530103173287323,
      "original_score": 0.4530103173287323,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "190",
      "name": "Integer Overflow or Wraparound",
      "abstraction": "Base",
      "score": 0.4492168230124287,
      "original_score": 0.4492168230124287,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "782",
      "name": "Exposed IOCTL with Insufficient Access Control",
      "abstraction": "Variant",
      "score": 0.4374717600325378,
      "original_score": 0.4374717600325378,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1250",
      "name": "Improper Preservation of Consistency Between Independent Representations of Shared State",
      "abstraction": "Base",
      "score": 0.4371748187957608,
      "original_score": 0.4371748187957608,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1421",
      "name": "Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution",
      "abstraction": "Base",
      "score": 0.43457462251610585,
      "original_score": 0.43457462251610585,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1260",
      "name": "Improper Handling of Overlap Between Protected Memory Ranges",
      "abstraction": "Base",
      "score": 0.4337780231133064,
      "original_score": 0.4337780231133064,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 0.43366408705270376,
      "original_score": 0.43366408705270376,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "908",
      "name": "Use of Uninitialized Resource",
      "abstraction": "Base",
      "score": 0.432211765690687,
      "original_score": 0.432211765690687,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "abstraction": "Class",
      "score": 0.43182635066093356,
      "original_score": 0.43182635066093356,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "abstraction": "Base",
      "score": 0.43011848007589865,
      "original_score": 0.43011848007589865,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.43011848007589865,
    "max": 0.5260622196061314,
    "mean": 0.45741227313913385,
    "median": 0.454662244386839,
    "count": 20
  }
}