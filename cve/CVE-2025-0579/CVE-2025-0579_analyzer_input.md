# Vulnerability Information: CVE-2025-0579

## Vulnerability Description
A vulnerability was found in Shiprocket Module 3/4 on OpenCart. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the file /index.php?route=extension/shiprocket/module/restapi of the component REST API Module. The manipulation of the argument x-username leads to **sql injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** OpenCart
- **component:** REST API Module

## CVE Reference Links Content Summary
```
*   **Root cause of vulnerability**: The ShipRocket OpenCart Rest API module has multiple SQL Injection (SQLi) vulnerabilities due to improper sanitization of user-supplied input before constructing SQL queries.
*   **Weaknesses/vulnerabilities present**:
    *   SQL Injection (SQLi)
    *   CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
    *   CAPEC-66: SQL Injection
    *   CAPEC-7: Blind SQL Injection
*   **Impact of exploitation**:
    *   Unauthenticated attacker can access any and all content stored in the database.
    *   Compromise the site by exfiltrating admin session details/credentials.
    *   Exfiltration of Personally Identifiable Information (PII) and/or payment details.
*   **Attack vectors**:
    *   Sending a malicious payload in a custom HTTP header (e.g., `x-key`, `x-username`, `x-public`).
    *   Exploiting the `filters[sort]` GET parameter when `action=getProducts`.
    *   Exploiting any key/value passed in the `filters` GET parameter in the v3 version of the module, especially in methods like `action=getOrders&filters[order_id]=foo`.
*   **Required attacker capabilities/position**: No authentication is required for the most serious vulnerability.
*   **Mitigation or fix**: Modules must validate all unsafe input appropriately before being used to assemble SQL queries. Either the value is cast to a numeric format, or the database driver's escape method is used.
*   **More detail than official CVE description**: Yes, the content provides specific details about vulnerable versions, attack vectors, and mitigation strategies. It also includes steps to reproduce the vulnerability with example payloads. It details the affected versions of the module, specific HTTP headers and GET parameters that are vulnerable. It also details the exploitation using the sqlmap tool
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.545 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.466 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.449 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.449 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.426 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.425 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.424 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.539 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

