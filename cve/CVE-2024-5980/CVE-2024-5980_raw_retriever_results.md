# Raw Retriever Results for CVE-2024-5980

# Raw Retriever Results for CVE-2024-5980
## Query
A vulnerability in the /v1/runs API endpoint of lightning-ai/pytorch-lightning v2.2.4 allows attackers to exploit path traversal when extracting tar.gz files. When the LightningApp is running with the plugin_server, attackers can deploy malicious tar.gz plugins that embed arbitrary files with path traversal vulnerabilities. This can result in arbitrary files being written to any directory in the victims local file system, potentially leading to remote code execution.

## Keyphrases
- **weakness**: 'path traversal'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4864 | 0.5564 | 0.5088 | 0.5036 | 20 |
| Sparse | 113.8620 | 1000.0000 | 400.4360 | 349.2368 | 11 |
| Graph | 1.3676 | 4.3290 | 2.0729 | 1.7439 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 4.3290 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.8318 | Allowed |
| 3 | 73 | External Control of File Name or Path | Base | 2.8242 | Allowed |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 2.8224 | Allowed |
| 5 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.4936 | Allowed |
| 6 | 183 | Permissive List of Allowed Inputs | base | 2.2100 | Allowed |
| 7 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 8 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 9 | 363 | Race Condition Enabling Link Following | base | 2.2100 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 11 | 36 | Absolute Path Traversal | Base | 1.7198 | Allowed |
| 12 | 23 | Relative Path Traversal | Base | 1.7044 | Allowed |
| 13 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 1.5805 | Allowed-with-Review |
| 14 | 473 | PHP External Variable Modification | variant | 1.5552 | Allowed |
| 15 | 456 | Missing Initialization of a Variable | variant | 1.5552 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 36 | Absolute Path Traversal | Base | 0.5564 | 0.5564 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5469 | 0.5469 | Allowed |
| 3 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 0.5346 | 0.5346 | Allowed |
| 4 | 24 | Path Traversal: '../filedir' | Variant | 0.5333 | 0.5333 | Allowed |
| 5 | 427 | Uncontrolled Search Path Element | Base | 0.5219 | 0.5219 | Allowed |
| 6 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.5210 | 0.5210 | Allowed |
| 7 | 25 | Path Traversal: '/../filedir' | Variant | 0.5163 | 0.5163 | Allowed |
| 8 | 862 | Missing Authorization | Class | 0.5071 | 0.5071 | Allowed-with-Review |
| 9 | 306 | Missing Authentication for Critical Function | Base | 0.5057 | 0.5057 | Allowed |
| 10 | 23 | Relative Path Traversal | Base | 0.5051 | 0.5051 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5021 | 0.5021 | Allowed |
| 12 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.4988 | 0.4988 | Allowed |
| 13 | 532 | Insertion of Sensitive Information into Log File | Base | 0.4965 | 0.4965 | Allowed |
| 14 | 502 | Deserialization of Untrusted Data | Base | 0.4961 | 0.4961 | Allowed |
| 15 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.4913 | 0.4913 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 1000.0000 | 1000.0000 | Allowed |
| 2 | 23 | Relative Path Traversal | 457.6303 | 457.6303 | Allowed |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | 433.9947 | 433.9947 | Allowed |
| 4 | 73 | External Control of File Name or Path | 360.8042 | 360.8042 | Allowed |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | 353.4965 | 353.4965 | Allowed |
| 6 | 61 | UNIX Symbolic Link (Symlink) Following | 349.2368 | 349.2368 | Allowed |
| 7 | 36 | Absolute Path Traversal | 345.8098 | 345.8098 | Allowed |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | 332.0566 | 332.0566 | Allowed-with-Review |
| 9 | 668 | Exposure of Resource to Wrong Sphere | 331.7390 | 331.7390 | Discouraged |
| 10 | 427 | Uncontrolled Search Path Element | 326.1657 | 326.1657 | Allowed |
| 11 | 306 | Missing Authentication for Critical Function | 113.8620 | 113.8620 | Allowed |
