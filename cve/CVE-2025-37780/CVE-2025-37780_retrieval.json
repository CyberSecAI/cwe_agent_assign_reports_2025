{
  "vulnerability_info": "VulnerabilityInfo(cve_id='CVE-2025-37780', description='In the Linux kernel, the following vulnerability has been resolved isofs Prevent the use of too small fid syzbot reported a **slab-out-of-bounds Read** in isofs_fh_to_parent. [1] The handle_bytes value passed in by the reproducing program is equal to 12. In handle_to_path(), only 12 bytes of memory are allocated for the structure file_handle->f_handle member, which causes an **out-of-bounds access** when accessing the member parent_block of the structure isofs_fid in isofs, because accessing parent_block requires at least 16 bytes of f_handle. Here, fh_len is used to indirectly confirm that the value of handle_bytes is greater than 3 before accessing parent_block. [1] BUG KASAN slab-out-of-bounds in isofs_fh_to_parent+0x1b8/0x210 fs/isofs/export.c183 Read of size 4 at addr ffff0000cc030d94 by task syz-executor215/6466 CPU 1 UID 0 PID 6466 Comm syz-executor215 Not tainted 6.14.0-rc7-syzkaller-ga2392f333575 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 02/12/2025 Call trace show_stack+0x2c/0x3c arch/arm64/kernel/stacktrace.c466 (C) __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0xe4/0x150 lib/dump_stack.c120 print_address_description mm/kasan/report.c408 [inline] print_report+0x198/0x550 mm/kasan/report.c521 kasan_report+0xd8/0x138 mm/kasan/report.c634 __asan_report_load4_noabort+0x20/0x2c mm/kasan/report_generic.c380 isofs_fh_to_parent+0x1b8/0x210 fs/isofs/export.c183 exportfs_decode_fh_raw+0x2dc/0x608 fs/exportfs/expfs.c523 do_handle_to_path+0xa0/0x198 fs/fhandle.c257 handle_to_path fs/fhandle.c385 [inline] do_handle_open+0x8cc/0xb8c fs/fhandle.c403 __do_sys_open_by_handle_at fs/fhandle.c443 [inline] __se_sys_open_by_handle_at fs/fhandle.c434 [inline] __arm64_sys_open_by_handle_at+0x80/0x94 fs/fhandle.c434 __invoke_syscall arch/arm64/kernel/syscall.c35 [inline] invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c49 el0_svc_common+0x130/0x23c arch/arm64/kernel/syscall.c132 do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c151 el0_svc+0x54/0x168 arch/arm64/kernel/entry-common.c744 el0t_64_sync_handler+0x84/0x108 arch/arm64/kernel/entry-common.c762 el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S600 Allocated by task 6466 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x40/0x78 mm/kasan/common.c68 kasan_save_alloc_info+0x40/0x50 mm/kasan/generic.c562 poison_kmalloc_redzone mm/kasan/common.c377 [inline] __kasan_kmalloc+0xac/0xc4 mm/kasan/common.c394 kasan_kmalloc include/linux/kasan.h260 [inline] __do_kmalloc_node mm/slub.c4294 [inline] __kmalloc_noprof+0x32c/0x54c mm/slub.c4306 kmalloc_noprof include/linux/slab.h905 [inline] handle_to_path fs/fhandle.c357 [inline] do_handle_open+0x5a4/0xb8c fs/fhandle.c403 __do_sys_open_by_handle_at fs/fhandle.c443 [inline] __se_sys_open_by_handle_at fs/fhandle.c434 [inline] __arm64_sys_open_by_handle_at+0x80/0x94 fs/fhandle.c434 __invoke_syscall arch/arm64/kernel/syscall.c35 [inline] invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c49 el0_svc_common+0x130/0x23c arch/arm64/kernel/syscall.c132 do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c151 el0_svc+0x54/0x168 arch/arm64/kernel/entry-common.c744 el0t_64_sync_handler+0x84/0x108 arch/arm64/kernel/entry-common.c762 el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S600', key_phrases={'rootcause': '', 'weakness': ['slab-out-of-bounds Read', 'out-of-bounds access'], 'impact': '', 'vector': '', 'attacker': 'syzbot', 'product': 'Linux kernel', 'version': '6.14.0-rc7-syzkaller-ga2392f333575', 'component': 'isofs'}, reference_content=None, similar_info={'cwe_distribution': {}, 'cwe_consensus': '', 'similarity_stats': {'thresholds': [], 'total_samples_by_threshold': {}, 'top_cwes_by_threshold': {}}}, similarity_summary=SimilarityInsight(consensus_cwe='', top_cwes=[], confidence_levels={}, total_samples=0), analysis='', analysis_with_relationships='', criticism='', resolution='', relevant_cwes=[{'metadata': {'doc_id': '667', 'name': 'Improper Locking', 'source': 'sparse', 'original_content': 'The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors.', 'keyphrase_sources': [{'id': 'weakness:slab-out-of-bounds Read', 'keyphrase': 'slab-out-of-bounds Read', 'type': 'weakness'}, {'id': 'weakness:out-of-bounds access', 'keyphrase': 'out-of-bounds access', 'type': 'weakness'}, {'id': 'attacker:syzbot', 'keyphrase': 'syzbot', 'type': 'attacker'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'version:6.14.0-rc7-syzkaller-ga2392f333575', 'keyphrase': '6.14.0-rc7-syzkaller-ga2392f333575', 'type': 'version'}, {'id': 'component:isofs', 'keyphrase': 'isofs', 'type': 'component'}]}, 'similarity': np.float64(1028.0487850630077)}, {'metadata': {'doc_id': '367', 'name': 'Time-of-check Time-of-use (TOCTOU) Race Condition', 'source': 'sparse', 'original_content': \"The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.\", 'keyphrase_sources': [{'id': 'weakness:slab-out-of-bounds Read', 'keyphrase': 'slab-out-of-bounds Read', 'type': 'weakness'}, {'id': 'weakness:out-of-bounds access', 'keyphrase': 'out-of-bounds access', 'type': 'weakness'}, {'id': 'attacker:syzbot', 'keyphrase': 'syzbot', 'type': 'attacker'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'version:6.14.0-rc7-syzkaller-ga2392f333575', 'keyphrase': '6.14.0-rc7-syzkaller-ga2392f333575', 'type': 'version'}, {'id': 'component:isofs', 'keyphrase': 'isofs', 'type': 'component'}]}, 'similarity': np.float64(1019.9193177098617)}, {'metadata': {'doc_id': '125', 'name': 'Out-of-bounds Read', 'source': 'sparse', 'original_content': 'The product reads data past the end, or before the beginning, of the intended buffer.', 'keyphrase_sources': [{'id': 'weakness:slab-out-of-bounds Read', 'keyphrase': 'slab-out-of-bounds Read', 'type': 'weakness'}, {'id': 'weakness:out-of-bounds access', 'keyphrase': 'out-of-bounds access', 'type': 'weakness'}, {'id': 'attacker:syzbot', 'keyphrase': 'syzbot', 'type': 'attacker'}, {'id': 'component:isofs', 'keyphrase': 'isofs', 'type': 'component'}]}, 'similarity': np.float64(992.446315047396)}, {'metadata': {'doc_id': '733', 'name': 'Compiler Optimization Removal or Modification of Security-critical Code', 'source': 'sparse', 'original_content': 'The developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified.', 'keyphrase_sources': [{'id': 'weakness:slab-out-of-bounds Read', 'keyphrase': 'slab-out-of-bounds Read', 'type': 'weakness'}, {'id': 'weakness:out-of-bounds access', 'keyphrase': 'out-of-bounds access', 'type': 'weakness'}, {'id': 'attacker:syzbot', 'keyphrase': 'syzbot', 'type': 'attacker'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'version:6.14.0-rc7-syzkaller-ga2392f333575', 'keyphrase': '6.14.0-rc7-syzkaller-ga2392f333575', 'type': 'version'}, {'id': 'component:isofs', 'keyphrase': 'isofs', 'type': 'component'}]}, 'similarity': np.float64(983.921359675361)}, {'metadata': {'doc_id': '787', 'name': 'Out-of-bounds Write', 'source': 'sparse', 'original_content': 'The product writes data past the end, or before the beginning, of the intended buffer.', 'keyphrase_sources': [{'id': 'weakness:slab-out-of-bounds Read', 'keyphrase': 'slab-out-of-bounds Read', 'type': 'weakness'}, {'id': 'weakness:out-of-bounds access', 'keyphrase': 'out-of-bounds access', 'type': 'weakness'}, {'id': 'version:6.14.0-rc7-syzkaller-ga2392f333575', 'keyphrase': '6.14.0-rc7-syzkaller-ga2392f333575', 'type': 'version'}]}, 'similarity': np.float64(969.4399260963331)}, {'metadata': {'doc_id': '392', 'name': 'Missing Report of Error Condition', 'source': 'sparse', 'original_content': 'The product encounters an error but does not provide a status code or return value to indicate that an error has occurred.', 'keyphrase_sources': [{'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}]}, 'similarity': np.float64(335.5083122304753)}, {'metadata': {'doc_id': '393', 'name': 'Return of Wrong Status Code', 'source': 'sparse', 'original_content': 'A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.', 'keyphrase_sources': [{'id': 'attacker:syzbot', 'keyphrase': 'syzbot', 'type': 'attacker'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'version:6.14.0-rc7-syzkaller-ga2392f333575', 'keyphrase': '6.14.0-rc7-syzkaller-ga2392f333575', 'type': 'version'}, {'id': 'component:isofs', 'keyphrase': 'isofs', 'type': 'component'}]}, 'similarity': np.float64(332.37670653371003)}], identified_cwes={'analyzer': [], 'critic_additional': []})",
  "retrieval_results": {
    "has_multiple_keyphrases": true,
    "keyphrase_cwe_sets": {
      "weakness:slab-out-of-bounds Read": {
        "keyphrase": "slab-out-of-bounds Read",
        "type": "weakness",
        "cwes": [
          {
            "metadata": {
              "doc_id": "667",
              "name": "Improper Locking",
              "source": "sparse",
              "original_content": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors.",
              "keyphrase_sources": [
                {
                  "id": "weakness:slab-out-of-bounds Read",
                  "keyphrase": "slab-out-of-bounds Read",
                  "type": "weakness"
                },
                {
                  "id": "weakness:out-of-bounds access",
                  "keyphrase": "out-of-bounds access",
                  "type": "weakness"
                },
                {
                  "id": "attacker:syzbot",
                  "keyphrase": "syzbot",
                  "type": "attacker"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
                  "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
                  "type": "version"
                },
                {
                  "id": "component:isofs",
                  "keyphrase": "isofs",
                  "type": "component"
                }
              ]
            },
            "similarity": 1028.0487850630077
          },
          {
            "metadata": {
              "doc_id": "367",
              "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
              "source": "sparse",
              "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.",
              "keyphrase_sources": [
                {
                  "id": "weakness:slab-out-of-bounds Read",
                  "keyphrase": "slab-out-of-bounds Read",
                  "type": "weakness"
                },
                {
                  "id": "weakness:out-of-bounds access",
                  "keyphrase": "out-of-bounds access",
                  "type": "weakness"
                },
                {
                  "id": "attacker:syzbot",
                  "keyphrase": "syzbot",
                  "type": "attacker"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
                  "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
                  "type": "version"
                },
                {
                  "id": "component:isofs",
                  "keyphrase": "isofs",
                  "type": "component"
                }
              ]
            },
            "similarity": 1019.9193177098617
          },
          {
            "metadata": {
              "doc_id": "125",
              "name": "Out-of-bounds Read",
              "source": "sparse",
              "original_content": "The product reads data past the end, or before the beginning, of the intended buffer.",
              "keyphrase_sources": [
                {
                  "id": "weakness:slab-out-of-bounds Read",
                  "keyphrase": "slab-out-of-bounds Read",
                  "type": "weakness"
                },
                {
                  "id": "weakness:out-of-bounds access",
                  "keyphrase": "out-of-bounds access",
                  "type": "weakness"
                },
                {
                  "id": "attacker:syzbot",
                  "keyphrase": "syzbot",
                  "type": "attacker"
                },
                {
                  "id": "component:isofs",
                  "keyphrase": "isofs",
                  "type": "component"
                }
              ]
            },
            "similarity": 992.446315047396
          },
          {
            "metadata": {
              "doc_id": "733",
              "name": "Compiler Optimization Removal or Modification of Security-critical Code",
              "source": "sparse",
              "original_content": "The developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified.",
              "keyphrase_sources": [
                {
                  "id": "weakness:slab-out-of-bounds Read",
                  "keyphrase": "slab-out-of-bounds Read",
                  "type": "weakness"
                },
                {
                  "id": "weakness:out-of-bounds access",
                  "keyphrase": "out-of-bounds access",
                  "type": "weakness"
                },
                {
                  "id": "attacker:syzbot",
                  "keyphrase": "syzbot",
                  "type": "attacker"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
                  "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
                  "type": "version"
                },
                {
                  "id": "component:isofs",
                  "keyphrase": "isofs",
                  "type": "component"
                }
              ]
            },
            "similarity": 983.921359675361
          },
          {
            "metadata": {
              "doc_id": "787",
              "name": "Out-of-bounds Write",
              "source": "sparse",
              "original_content": "The product writes data past the end, or before the beginning, of the intended buffer.",
              "keyphrase_sources": [
                {
                  "id": "weakness:slab-out-of-bounds Read",
                  "keyphrase": "slab-out-of-bounds Read",
                  "type": "weakness"
                },
                {
                  "id": "weakness:out-of-bounds access",
                  "keyphrase": "out-of-bounds access",
                  "type": "weakness"
                },
                {
                  "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
                  "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
                  "type": "version"
                }
              ]
            },
            "similarity": 969.4399260963331
          }
        ]
      },
      "weakness:out-of-bounds access": {
        "keyphrase": "out-of-bounds access",
        "type": "weakness",
        "cwes": [
          {
            "metadata": {
              "doc_id": "667",
              "name": "Improper Locking",
              "source": "sparse",
              "original_content": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors."
            },
            "similarity": 1033.019897912181
          },
          {
            "metadata": {
              "doc_id": "367",
              "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
              "source": "sparse",
              "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state."
            },
            "similarity": 1029.4068116320047
          },
          {
            "metadata": {
              "doc_id": "125",
              "name": "Out-of-bounds Read",
              "source": "sparse",
              "original_content": "The product reads data past the end, or before the beginning, of the intended buffer."
            },
            "similarity": 993.8002089915398
          },
          {
            "metadata": {
              "doc_id": "733",
              "name": "Compiler Optimization Removal or Modification of Security-critical Code",
              "source": "sparse",
              "original_content": "The developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified."
            },
            "similarity": 983.921359675361
          },
          {
            "metadata": {
              "doc_id": "787",
              "name": "Out-of-bounds Write",
              "source": "sparse",
              "original_content": "The product writes data past the end, or before the beginning, of the intended buffer."
            },
            "similarity": 976.9145771374723
          }
        ]
      },
      "attacker:syzbot": {
        "keyphrase": "syzbot",
        "type": "attacker",
        "cwes": [
          {
            "metadata": {
              "doc_id": "667",
              "name": "Improper Locking",
              "source": "sparse",
              "original_content": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors."
            },
            "similarity": 348.890209154933
          },
          {
            "metadata": {
              "doc_id": "367",
              "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
              "source": "sparse",
              "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state."
            },
            "similarity": 348.66259778377906
          },
          {
            "metadata": {
              "doc_id": "393",
              "name": "Return of Wrong Status Code",
              "source": "sparse",
              "original_content": "A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",
              "keyphrase_sources": [
                {
                  "id": "attacker:syzbot",
                  "keyphrase": "syzbot",
                  "type": "attacker"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
                  "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
                  "type": "version"
                },
                {
                  "id": "component:isofs",
                  "keyphrase": "isofs",
                  "type": "component"
                }
              ]
            },
            "similarity": 332.37670653371003
          },
          {
            "metadata": {
              "doc_id": "733",
              "name": "Compiler Optimization Removal or Modification of Security-critical Code",
              "source": "sparse",
              "original_content": "The developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified."
            },
            "similarity": 331.81989531554257
          },
          {
            "metadata": {
              "doc_id": "125",
              "name": "Out-of-bounds Read",
              "source": "sparse",
              "original_content": "The product reads data past the end, or before the beginning, of the intended buffer."
            },
            "similarity": 323.2128734831502
          }
        ]
      },
      "product:Linux kernel": {
        "keyphrase": "Linux kernel",
        "type": "product",
        "cwes": [
          {
            "metadata": {
              "doc_id": "667",
              "name": "Improper Locking",
              "source": "sparse",
              "original_content": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors."
            },
            "similarity": 363.21090529765627
          },
          {
            "metadata": {
              "doc_id": "367",
              "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
              "source": "sparse",
              "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state."
            },
            "similarity": 361.01039184183827
          },
          {
            "metadata": {
              "doc_id": "733",
              "name": "Compiler Optimization Removal or Modification of Security-critical Code",
              "source": "sparse",
              "original_content": "The developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified."
            },
            "similarity": 345.0195754354596
          },
          {
            "metadata": {
              "doc_id": "393",
              "name": "Return of Wrong Status Code",
              "source": "sparse",
              "original_content": "A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result."
            },
            "similarity": 344.1719753329294
          },
          {
            "metadata": {
              "doc_id": "392",
              "name": "Missing Report of Error Condition",
              "source": "sparse",
              "original_content": "The product encounters an error but does not provide a status code or return value to indicate that an error has occurred.",
              "keyphrase_sources": [
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                }
              ]
            },
            "similarity": 335.5083122304753
          }
        ]
      },
      "version:6.14.0-rc7-syzkaller-ga2392f333575": {
        "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
        "type": "version",
        "cwes": [
          {
            "metadata": {
              "doc_id": "367",
              "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
              "source": "sparse",
              "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state."
            },
            "similarity": 356.4743338685167
          },
          {
            "metadata": {
              "doc_id": "667",
              "name": "Improper Locking",
              "source": "sparse",
              "original_content": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors."
            },
            "similarity": 355.5188078404194
          },
          {
            "metadata": {
              "doc_id": "393",
              "name": "Return of Wrong Status Code",
              "source": "sparse",
              "original_content": "A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result."
            },
            "similarity": 333.7187922867879
          },
          {
            "metadata": {
              "doc_id": "733",
              "name": "Compiler Optimization Removal or Modification of Security-critical Code",
              "source": "sparse",
              "original_content": "The developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified."
            },
            "similarity": 331.81989531554257
          },
          {
            "metadata": {
              "doc_id": "787",
              "name": "Out-of-bounds Write",
              "source": "sparse",
              "original_content": "The product writes data past the end, or before the beginning, of the intended buffer."
            },
            "similarity": 330.5716090536362
          }
        ]
      },
      "component:isofs": {
        "keyphrase": "isofs",
        "type": "component",
        "cwes": [
          {
            "metadata": {
              "doc_id": "667",
              "name": "Improper Locking",
              "source": "sparse",
              "original_content": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors."
            },
            "similarity": 348.890209154933
          },
          {
            "metadata": {
              "doc_id": "367",
              "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
              "source": "sparse",
              "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state."
            },
            "similarity": 348.66259778377906
          },
          {
            "metadata": {
              "doc_id": "393",
              "name": "Return of Wrong Status Code",
              "source": "sparse",
              "original_content": "A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result."
            },
            "similarity": 332.37670653371003
          },
          {
            "metadata": {
              "doc_id": "733",
              "name": "Compiler Optimization Removal or Modification of Security-critical Code",
              "source": "sparse",
              "original_content": "The developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified."
            },
            "similarity": 331.81989531554257
          },
          {
            "metadata": {
              "doc_id": "125",
              "name": "Out-of-bounds Read",
              "source": "sparse",
              "original_content": "The product reads data past the end, or before the beginning, of the intended buffer."
            },
            "similarity": 323.2128734831502
          }
        ]
      }
    },
    "keyphrase_mapping": {
      "667": [
        {
          "id": "weakness:slab-out-of-bounds Read",
          "keyphrase": "slab-out-of-bounds Read",
          "type": "weakness"
        },
        {
          "id": "weakness:out-of-bounds access",
          "keyphrase": "out-of-bounds access",
          "type": "weakness"
        },
        {
          "id": "attacker:syzbot",
          "keyphrase": "syzbot",
          "type": "attacker"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
          "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
          "type": "version"
        },
        {
          "id": "component:isofs",
          "keyphrase": "isofs",
          "type": "component"
        }
      ],
      "367": [
        {
          "id": "weakness:slab-out-of-bounds Read",
          "keyphrase": "slab-out-of-bounds Read",
          "type": "weakness"
        },
        {
          "id": "weakness:out-of-bounds access",
          "keyphrase": "out-of-bounds access",
          "type": "weakness"
        },
        {
          "id": "attacker:syzbot",
          "keyphrase": "syzbot",
          "type": "attacker"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
          "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
          "type": "version"
        },
        {
          "id": "component:isofs",
          "keyphrase": "isofs",
          "type": "component"
        }
      ],
      "125": [
        {
          "id": "weakness:slab-out-of-bounds Read",
          "keyphrase": "slab-out-of-bounds Read",
          "type": "weakness"
        },
        {
          "id": "weakness:out-of-bounds access",
          "keyphrase": "out-of-bounds access",
          "type": "weakness"
        },
        {
          "id": "attacker:syzbot",
          "keyphrase": "syzbot",
          "type": "attacker"
        },
        {
          "id": "component:isofs",
          "keyphrase": "isofs",
          "type": "component"
        }
      ],
      "733": [
        {
          "id": "weakness:slab-out-of-bounds Read",
          "keyphrase": "slab-out-of-bounds Read",
          "type": "weakness"
        },
        {
          "id": "weakness:out-of-bounds access",
          "keyphrase": "out-of-bounds access",
          "type": "weakness"
        },
        {
          "id": "attacker:syzbot",
          "keyphrase": "syzbot",
          "type": "attacker"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
          "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
          "type": "version"
        },
        {
          "id": "component:isofs",
          "keyphrase": "isofs",
          "type": "component"
        }
      ],
      "787": [
        {
          "id": "weakness:slab-out-of-bounds Read",
          "keyphrase": "slab-out-of-bounds Read",
          "type": "weakness"
        },
        {
          "id": "weakness:out-of-bounds access",
          "keyphrase": "out-of-bounds access",
          "type": "weakness"
        },
        {
          "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
          "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
          "type": "version"
        }
      ],
      "393": [
        {
          "id": "attacker:syzbot",
          "keyphrase": "syzbot",
          "type": "attacker"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
          "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
          "type": "version"
        },
        {
          "id": "component:isofs",
          "keyphrase": "isofs",
          "type": "component"
        }
      ],
      "392": [
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        }
      ]
    },
    "relevant_cwes": [
      {
        "metadata": {
          "doc_id": "667",
          "name": "Improper Locking",
          "source": "sparse",
          "original_content": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors.",
          "keyphrase_sources": [
            {
              "id": "weakness:slab-out-of-bounds Read",
              "keyphrase": "slab-out-of-bounds Read",
              "type": "weakness"
            },
            {
              "id": "weakness:out-of-bounds access",
              "keyphrase": "out-of-bounds access",
              "type": "weakness"
            },
            {
              "id": "attacker:syzbot",
              "keyphrase": "syzbot",
              "type": "attacker"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
              "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
              "type": "version"
            },
            {
              "id": "component:isofs",
              "keyphrase": "isofs",
              "type": "component"
            }
          ]
        },
        "similarity": 1028.0487850630077
      },
      {
        "metadata": {
          "doc_id": "367",
          "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
          "source": "sparse",
          "original_content": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.",
          "keyphrase_sources": [
            {
              "id": "weakness:slab-out-of-bounds Read",
              "keyphrase": "slab-out-of-bounds Read",
              "type": "weakness"
            },
            {
              "id": "weakness:out-of-bounds access",
              "keyphrase": "out-of-bounds access",
              "type": "weakness"
            },
            {
              "id": "attacker:syzbot",
              "keyphrase": "syzbot",
              "type": "attacker"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
              "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
              "type": "version"
            },
            {
              "id": "component:isofs",
              "keyphrase": "isofs",
              "type": "component"
            }
          ]
        },
        "similarity": 1019.9193177098617
      },
      {
        "metadata": {
          "doc_id": "125",
          "name": "Out-of-bounds Read",
          "source": "sparse",
          "original_content": "The product reads data past the end, or before the beginning, of the intended buffer.",
          "keyphrase_sources": [
            {
              "id": "weakness:slab-out-of-bounds Read",
              "keyphrase": "slab-out-of-bounds Read",
              "type": "weakness"
            },
            {
              "id": "weakness:out-of-bounds access",
              "keyphrase": "out-of-bounds access",
              "type": "weakness"
            },
            {
              "id": "attacker:syzbot",
              "keyphrase": "syzbot",
              "type": "attacker"
            },
            {
              "id": "component:isofs",
              "keyphrase": "isofs",
              "type": "component"
            }
          ]
        },
        "similarity": 992.446315047396
      },
      {
        "metadata": {
          "doc_id": "733",
          "name": "Compiler Optimization Removal or Modification of Security-critical Code",
          "source": "sparse",
          "original_content": "The developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified.",
          "keyphrase_sources": [
            {
              "id": "weakness:slab-out-of-bounds Read",
              "keyphrase": "slab-out-of-bounds Read",
              "type": "weakness"
            },
            {
              "id": "weakness:out-of-bounds access",
              "keyphrase": "out-of-bounds access",
              "type": "weakness"
            },
            {
              "id": "attacker:syzbot",
              "keyphrase": "syzbot",
              "type": "attacker"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
              "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
              "type": "version"
            },
            {
              "id": "component:isofs",
              "keyphrase": "isofs",
              "type": "component"
            }
          ]
        },
        "similarity": 983.921359675361
      },
      {
        "metadata": {
          "doc_id": "787",
          "name": "Out-of-bounds Write",
          "source": "sparse",
          "original_content": "The product writes data past the end, or before the beginning, of the intended buffer.",
          "keyphrase_sources": [
            {
              "id": "weakness:slab-out-of-bounds Read",
              "keyphrase": "slab-out-of-bounds Read",
              "type": "weakness"
            },
            {
              "id": "weakness:out-of-bounds access",
              "keyphrase": "out-of-bounds access",
              "type": "weakness"
            },
            {
              "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
              "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
              "type": "version"
            }
          ]
        },
        "similarity": 969.4399260963331
      },
      {
        "metadata": {
          "doc_id": "392",
          "name": "Missing Report of Error Condition",
          "source": "sparse",
          "original_content": "The product encounters an error but does not provide a status code or return value to indicate that an error has occurred.",
          "keyphrase_sources": [
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            }
          ]
        },
        "similarity": 335.5083122304753
      },
      {
        "metadata": {
          "doc_id": "393",
          "name": "Return of Wrong Status Code",
          "source": "sparse",
          "original_content": "A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",
          "keyphrase_sources": [
            {
              "id": "attacker:syzbot",
              "keyphrase": "syzbot",
              "type": "attacker"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "version:6.14.0-rc7-syzkaller-ga2392f333575",
              "keyphrase": "6.14.0-rc7-syzkaller-ga2392f333575",
              "type": "version"
            },
            {
              "id": "component:isofs",
              "keyphrase": "isofs",
              "type": "component"
            }
          ]
        },
        "similarity": 332.37670653371003
      }
    ],
    "enhanced_query": "# Vulnerability Description\n\n    In the Linux kernel, the following vulnerability has been resolved isofs Prevent the use of too small fid syzbot reported a **slab-out-of-bounds Read** in isofs_fh_to_parent. [1] The handle_bytes value passed in by the reproducing program is equal to 12. In handle_to_path(), only 12 bytes of memory are allocated for the structure file_handle->f_handle member, which causes an **out-of-bounds access** when accessing the member parent_block of the structure isofs_fid in isofs, because accessing parent_block requires at least 16 bytes of f_handle. Here, fh_len is used to indirectly confirm that the value of handle_bytes is greater than 3 before accessing parent_block. [1] BUG KASAN slab-out-of-bounds in isofs_fh_to_parent+0x1b8/0x210 fs/isofs/export.c183 Read of size 4 at addr ffff0000cc030d94 by task syz-executor215/6466 CPU 1 UID 0 PID 6466 Comm syz-executor215 Not tainted 6.14.0-rc7-syzkaller-ga2392f333575 #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 02/12/2025 Call trace show_stack+0x2c/0x3c arch/arm64/kernel/stacktrace.c466 (C) __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0xe4/0x150 lib/dump_stack.c120 print_address_description mm/kasan/report.c408 [inline] print_report+0x198/0x550 mm/kasan/report.c521 kasan_report+0xd8/0x138 mm/kasan/report.c634 __asan_report_load4_noabort+0x20/0x2c mm/kasan/report_generic.c380 isofs_fh_to_parent+0x1b8/0x210 fs/isofs/export.c183 exportfs_decode_fh_raw+0x2dc/0x608 fs/exportfs/expfs.c523 do_handle_to_path+0xa0/0x198 fs/fhandle.c257 handle_to_path fs/fhandle.c385 [inline] do_handle_open+0x8cc/0xb8c fs/fhandle.c403 __do_sys_open_by_handle_at fs/fhandle.c443 [inline] __se_sys_open_by_handle_at fs/fhandle.c434 [inline] __arm64_sys_open_by_handle_at+0x80/0x94 fs/fhandle.c434 __invoke_syscall arch/arm64/kernel/syscall.c35 [inline] invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c49 el0_svc_common+0x130/0x23c arch/arm64/kernel/syscall.c132 do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c151 el0_svc+0x54/0x168 arch/arm64/kernel/entry-common.c744 el0t_64_sync_handler+0x84/0x108 arch/arm64/kernel/entry-common.c762 el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S600 Allocated by task 6466 kasan_save_stack mm/kasan/common.c47 [inline] kasan_save_track+0x40/0x78 mm/kasan/common.c68 kasan_save_alloc_info+0x40/0x50 mm/kasan/generic.c562 poison_kmalloc_redzone mm/kasan/common.c377 [inline] __kasan_kmalloc+0xac/0xc4 mm/kasan/common.c394 kasan_kmalloc include/linux/kasan.h260 [inline] __do_kmalloc_node mm/slub.c4294 [inline] __kmalloc_noprof+0x32c/0x54c mm/slub.c4306 kmalloc_noprof include/linux/slab.h905 [inline] handle_to_path fs/fhandle.c357 [inline] do_handle_open+0x5a4/0xb8c fs/fhandle.c403 __do_sys_open_by_handle_at fs/fhandle.c443 [inline] __se_sys_open_by_handle_at fs/fhandle.c434 [inline] __arm64_sys_open_by_handle_at+0x80/0x94 fs/fhandle.c434 __invoke_syscall arch/arm64/kernel/syscall.c35 [inline] invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c49 el0_svc_common+0x130/0x23c arch/arm64/kernel/syscall.c132 do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c151 el0_svc+0x54/0x168 arch/arm64/kernel/entry-common.c744 el0t_64_sync_handler+0x84/0x108 arch/arm64/kernel/entry-common.c762 el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S600\n\n    # Keyphrase-Specific CWE Analysis\n    This vulnerability contains multiple keyphrases that may map to different CWEs. \n    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.\n\n    ## WEAKNESS: 'slab-out-of-bounds Read'\n\nRelevant CWEs for this WEAKNESS:\n\n### 1. CWE-667: Improper Locking (Score: 1028.05)\n\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....\n\n### 2. CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition (Score: 1019.92)\n\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state....\n\n### 3. CWE-125: Out-of-bounds Read (Score: 992.45)\n\nThe product reads data past the end, or before the beginning, of the intended buffer....\n\n### 4. CWE-733: Compiler Optimization Removal or Modification of Security-critical Code (Score: 983.92)\n\nThe developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified....\n\n### 5. CWE-787: Out-of-bounds Write (Score: 969.44)\n\nThe product writes data past the end, or before the beginning, of the intended buffer....\n\n## WEAKNESS: 'out-of-bounds access'\n\nRelevant CWEs for this WEAKNESS:\n\n### 1. CWE-667: Improper Locking (Score: 1028.05)\n\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....\n\n### 2. CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition (Score: 1019.92)\n\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state....\n\n### 3. CWE-125: Out-of-bounds Read (Score: 992.45)\n\nThe product reads data past the end, or before the beginning, of the intended buffer....\n\n### 4. CWE-733: Compiler Optimization Removal or Modification of Security-critical Code (Score: 983.92)\n\nThe developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified....\n\n### 5. CWE-787: Out-of-bounds Write (Score: 969.44)\n\nThe product writes data past the end, or before the beginning, of the intended buffer....\n\n## ATTACKER: 'syzbot'\n\nRelevant CWEs for this ATTACKER:\n\n### 1. CWE-667: Improper Locking (Score: 1028.05)\n\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....\n\n### 2. CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition (Score: 1019.92)\n\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state....\n\n### 3. CWE-125: Out-of-bounds Read (Score: 992.45)\n\nThe product reads data past the end, or before the beginning, of the intended buffer....\n\n### 4. CWE-733: Compiler Optimization Removal or Modification of Security-critical Code (Score: 983.92)\n\nThe developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified....\n\n### 5. CWE-393: Return of Wrong Status Code (Score: 332.38)\n\nA function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result....\n\n## PRODUCT: 'Linux kernel'\n\nRelevant CWEs for this PRODUCT:\n\n### 1. CWE-667: Improper Locking (Score: 1028.05)\n\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....\n\n### 2. CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition (Score: 1019.92)\n\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state....\n\n### 3. CWE-733: Compiler Optimization Removal or Modification of Security-critical Code (Score: 983.92)\n\nThe developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified....\n\n### 4. CWE-392: Missing Report of Error Condition (Score: 335.51)\n\nThe product encounters an error but does not provide a status code or return value to indicate that an error has occurred....\n\n### 5. CWE-393: Return of Wrong Status Code (Score: 332.38)\n\nA function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result....\n\n## VERSION: '6.14.0-rc7-syzkaller-ga2392f333575'\n\nRelevant CWEs for this VERSION:\n\n### 1. CWE-667: Improper Locking (Score: 1028.05)\n\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....\n\n### 2. CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition (Score: 1019.92)\n\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state....\n\n### 3. CWE-733: Compiler Optimization Removal or Modification of Security-critical Code (Score: 983.92)\n\nThe developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified....\n\n### 4. CWE-787: Out-of-bounds Write (Score: 969.44)\n\nThe product writes data past the end, or before the beginning, of the intended buffer....\n\n### 5. CWE-393: Return of Wrong Status Code (Score: 332.38)\n\nA function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result....\n\n## COMPONENT: 'isofs'\n\nRelevant CWEs for this COMPONENT:\n\n### 1. CWE-667: Improper Locking (Score: 1028.05)\n\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....\n\n### 2. CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition (Score: 1019.92)\n\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state....\n\n### 3. CWE-125: Out-of-bounds Read (Score: 992.45)\n\nThe product reads data past the end, or before the beginning, of the intended buffer....\n\n### 4. CWE-733: Compiler Optimization Removal or Modification of Security-critical Code (Score: 983.92)\n\nThe developer builds a security-critical protection mechanism into the software, but the compiler optimizes the program such that the mechanism is removed or modified....\n\n### 5. CWE-393: Return of Wrong Status Code (Score: 332.38)\n\nA function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result....\n\n\n    # Analysis Instructions\n    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.\n    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.\n    3. Provide a final determination of primary CWE(s) and any secondary CWEs.\n    4. Format your response using the standard analysis template.\n\n    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.\n    "
  },
  "retrieval_time": 2.52131986618042
}