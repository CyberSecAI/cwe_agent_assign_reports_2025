## Vulnerability Description
Nextcloud Server is a self hosted personal cloud system. In Nextcloud Server prior to 29.0.13, 30.0.7, and 31.0.1 and Nextcloud Enterprise Server prior to 26.0.13.13, 27.1.11.13, 28.0.14.4, 29.0.13, 30.0.7, and 31.0.1, an attacker on a multi-user system may read temporary files from Nextcloud running with a different user account, or run a **symlink attack**. Nextcloud Server versions 29.0.13, 30.0.7, and 31.0.1 and Nextcloud Enterprise Server 26.0.13.13, 27.1.11.13, 28.0.14.4, 29.0.13, 30.0.7, and 31.0.1 fix the issue. No known workarounds are available.

### Vulnerability Description Key Phrases
- **weakness:** **symlink attack**
- **product:** Nextcloud Server, Nextcloud Enterprise Server
- **impact:** read temporary files from Nextcloud
- **attacker:** attacker

## CVE Reference Links Content Summary
```
Root cause of vulnerability:
An attacker on a multi-user system may read temporary files from Nextcloud running with a different user account, or run a symlink attack.

Weaknesses/vulnerabilities present:
Insecure temporary file creation, race with write access and permission

Impact of exploitation:
An attacker on a multi-user system may read temporary files from Nextcloud running with a different user account, or run a symlink attack.

Attack vectors:
Not specified in the content.

Required attacker capabilities/position:
An attacker on a multi-user system.

Mitigation or fix:
It is recommended that the Nextcloud Server is upgraded to 29.0.13, 30.0.7 or 31.0.1
It is recommended that the Nextcloud Enterprise Server is upgraded to 26.0.13.13, 27.1.11.13, 28.0.14.4, 29.0.13, 30.0.7 or 31.0.1
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 64 | Windows Shortcut Following (.LNK) | Variant | Allowed | alternate_terms | 0.800 |
| 2 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.612 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.611 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.606 |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.592 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.571 |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.570 |
| 8 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.570 |
| 9 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | dense | 0.500 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-64: Windows Shortcut Following (.LNK)

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-23: Relative Path Traversal

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-1390: Weak Authentication

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-400: Uncontrolled Resource Consumption

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-117: Improper Output Neutralization for Logs