# Vulnerability Information: CVE-2024-41119

## Vulnerability Description
streamlit-geospatial is a streamlit multipage app for geospatial applications. Prior to commit c4f81d9616d40c60584e36abb15300853a66e489, the `vis_params` variable on line 80 in `8__Raster_Data_Visualization.py` takes user input, which is later used in the `eval()` function on line 86, leading to remote code execution. Commit c4f81d9616d40c60584e36abb15300853a66e489 fixes this issue.

### Vulnerability Description Key Phrases
- **rootcause:** **improper input validation**
- **impact:** remote code execution
- **product:** streamlit-geospatial
- **version:** prior to commit c4f81d9616d40c60584e36abb15300853a66e489
- **component:** vis_params variable in 8__Raster_Data_Visualization.py

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-41119:

**CVE-2024-41119:** Remote code execution in `pages/8_ðŸœï¸_Raster_Data_Visualization.py`

*   **Root cause of vulnerability:** The application uses the `eval()` function on user-provided input (`vis_params`) within the `pages/8_ðŸœï¸_Raster_Data_Visualization.py` file without proper sanitization.
*   **Weaknesses/vulnerabilities present:** Unsanitized user input is directly passed to the `eval()` function, allowing arbitrary code execution.
*   **Impact of exploitation:** An attacker can achieve remote code execution on the server hosting the streamlit-geospatial application, allowing them to potentially take full control of the system.
*   **Attack vectors:** A remote attacker can send a malicious string through the `Enter visualization parameters` text area, which is then evaluated using the `eval()` function.
*   **Required attacker capabilities/position:** The attacker needs to be able to access the `pages/8_ðŸœï¸_Raster_Data_Visualization.py` page and input a malicious string into the `Enter visualization parameters` text area.

The provided information includes the following additional details:

*   **Vulnerable code:** The `vis_params` variable on [line 80](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/8_%F0%9F%8F%9C%EF%B8%8F_Raster_Data_Visualization.py#L80) in `8_ðŸœï¸_Raster_Data_Visualization.py` takes user input, which is later used in the `eval()` function on [line 86](https://github.com/opengeos/streamlit-geospatial/blob/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/8_%F0%9F%8F%9C%EF%B8%8F_Raster_Data_Visualization.py#L86), leading to remote code execution.
*   **Proof of Concept (PoC):**
    1. Start streamlit-geospatial.
    2. Go to the ðŸœï¸ Raster Data Visualization tab and select `Add visualization parameters`.
    3. Paste the following into `Enter visualization parameters`:
    ```
    __import__('code').InteractiveInterpreter().runsource('import os;os.system(\"echo $(uname -a) > foobar.txt\")')
    ```
    4.  Observe that a file `foobar.txt` has been created on the server, which contains the output of the `uname -a` command.
*   **Fix:** The fix for this vulnerability involves replacing the usage of `eval()` with `json.loads()` after replacing single quotes with double quotes in the user input: `vis_params = json.loads(vis_params.replace("'", '"'))`.
*   **Mitigation:** A whitelist of trusted URLs is implemented in the fix, and users can only input data that is a dictionary

The content provides more detail than a typical CVE description, including a detailed PoC and specific code locations.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.249 |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.242 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.232 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.231 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.226 |
| 6 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.219 |
| 7 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.216 |
| 8 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.215 |
| 9 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | dense | 0.387 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |

