# Vulnerability Information: CVE-2024-53082

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved virtio_net Add hash_key_length check Add hash_key_length check in virtnet_probe() to avoid possible **out of bound errors** when setting/reading the hash key.

### Vulnerability Description Key Phrases
- **weakness:** **out of bound errors**
- **product:** Linux kernel
- **component:** virtio_net

## CVE Reference Links Content Summary
Based on the provided information, this content is related to CVE-2024-53082.

**Root Cause:**
The vulnerability stems from a missing check on the `rss_max_key_size` read from the virtio device's configuration. Specifically, the driver does not validate if the provided `rss_max_key_size` exceeds the defined maximum `VIRTIO_NET_RSS_MAX_KEY_SIZE`.

**Weaknesses/Vulnerabilities:**
- **Out-of-bounds read/write:** Without proper validation, a malicious or misconfigured virtio device can provide an `rss_max_key_size` that is too large. This could lead to out-of-bounds reads or writes when the driver attempts to use this value in subsequent operations related to setting or reading the RSS hash key.

**Impact of Exploitation:**
- **Potential memory corruption:** An out-of-bounds read/write can corrupt kernel memory, potentially leading to a denial of service (system crash) or privilege escalation.
- **Information Leakage:** Out of bounds reads could potentially lead to the disclosure of sensitive information.

**Attack Vectors:**
- **Malicious Virtio Device:** An attacker who controls or compromises a virtio device can manipulate the `rss_max_key_size` during device initialization.
- **Misconfigured Virtio Device:** A misconfigured or buggy virtio device could also provide an invalid `rss_max_key_size`.

**Required Attacker Capabilities/Position:**
- The attacker needs to be in a position to control the virtio device configuration, which would generally involve control over the hypervisor or the virtual device itself.
- The attacker does not require any pre-existing vulnerability on the host system, but does need to be able to manipulate the device's configuration space.

**Additional Details:**
The patch introduces a check to validate that `vi->rss_key_size` is less than or equal to `VIRTIO_NET_RSS_MAX_KEY_SIZE` within the `virtnet_probe()` function. If the provided key size is invalid, the driver prints an error message and terminates the device probe process (`err = -EINVAL;`). This prevents the out-of-bounds access.
The commit message references "Fixes: c7114b1249fa", which indicates that the vulnerability was introduced when RSS support was added to the virtio_net driver.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.181 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.173 |
| 3 | 194 | Unexpected Sign Extension | Variant | Allowed | sparse | 0.165 |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.164 |
| 5 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.159 |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.155 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.154 |
| 8 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | sparse | 0.154 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.526 |
| 10 | 609 | Double-Checked Locking | Base | Allowed | graph | 0.002 |

