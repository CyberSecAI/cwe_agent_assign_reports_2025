# Vulnerability Information: CVE-2025-24353

## Vulnerability Description
Directus is a real-time API and App dashboard for managing SQL database content. Prior to version 11.2.0, when sharing an item, a typical user can specify an arbitrary role. It allows the user to use a higher-privileged role to see fields that otherwise the user should not be able to see. Instances that are impacted are those that use the share feature and have specific roles hierarchy and fields that are not visible for certain roles. Version 11.2.0 contains a patch the issue.

### Vulnerability Description Key Phrases
- **impact:** use higher-privileged role to see fields that otherwise should not be able to see
- **vector:** share feature
- **attacker:** typical user
- **product:** Directus
- **version:** prior to 11.2.0

## CVE Reference Links Content Summary
```text
UNRELATED
```
```text
The provided content describes a vulnerability (privilege escalation) in the Directus application related to the Share feature. Specifically, it states that a user can specify an arbitrary role when sharing an item, which allows them to access fields they would not normally be able to see. This is a **privilege escalation** vulnerability.

*   **Root cause of vulnerability**: The vulnerability lies in the lack of proper authorization checks when sharing items. The system does not restrict the ability of a user to specify a role with higher privileges.

*   **Weaknesses/vulnerabilities present**:
    *   Improper Access Control (CWE-269)
    *   The share feature allows users to specify an arbitrary role, granting unauthorized access to data.

*   **Impact of exploitation**:
    *   Unauthorized access to sensitive data/fields.
    *   Privilege escalation.

*   **Attack vectors**:
    *   An authenticated user with the ability to use the share feature can create a share with a higher-privileged role, potentially exposing sensitive information.

*   **Required attacker capabilities/position**:
    *   An authenticated user with permission to use the share feature.
    *   Knowledge of the Directus application and its data model.

*   **Mitigation or fix**:
    *   The provided content mentions that the vulnerability is fixed in version 11.2.0. The fix involves the following:
        *   Properly give out read permissions on access through a share
        *   Scope the permissions to only what the user who created it has access to instead of selecting a role
        *   Fix app hydration on shares
        *   The content suggests that specifying a role on share should be available only for admins.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.171 |
| 2 | 267 | Privilege Defined With Unsafe Actions | Base | Allowed | sparse | 0.165 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.164 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.160 |
| 5 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.158 |
| 6 | 497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | Base | Allowed | sparse | 0.158 |
| 7 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.157 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.157 |
| 9 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | Allowed | dense | 0.389 |
| 10 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | graph | 0.002 |

