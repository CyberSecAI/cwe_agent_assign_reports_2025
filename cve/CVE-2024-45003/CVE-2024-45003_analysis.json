{
  "cve_id": "CVE-2024-45003",
  "description": "In the Linux kernel, the following vulnerability has been resolved vfs Dont evict inode under the inode lru traversing context The inode reclaiming process(See function prune_icache_sb) collects all reclaimable inodes and mark them with I_FREEING flag at first, at that time, other processes will be stuck if they try getting these inodes (See function find_inode_fast), then the reclaiming process destroy the inodes by function dispose_list(). Some filesystems(eg. ext4 with ea_inode feature, ubifs with xattr) may do **inode lookup in the inode evicting callback function**, if the inode lookup is operated under the inode lru traversing context, deadlock problems may happen. Case 1 In function ext4_evict_inode(), the ea inode lookup could happen if ea_inode feature is enabled, the lookup process will be stuck under the evicting context like this 1. File A has inode i_reg and an ea inode i_ea 2. getfattr(A, xattr_buf) // i_ea is added into lru // lru->i_ea 3. Then, following three processes running like this PA PB echo 2 > /proc/sys/vm/drop_caches shrink_slab prune_dcache_sb // i_reg is added into lru, lru->i_ea->i_reg prune_icache_sb list_lru_walk_one inode_lru_isolate i_ea->i_state |= I_FREEING // set inode state inode_lru_isolate __iget(i_reg) spin_unlock(&i_reg->i_lock) spin_unlock(lru_lock) rm file A i_",
  "key_phrases": {
    "rootcause": "inode lookup in the inode evicting callback function",
    "weakness": "",
    "impact": "deadlock",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "vfs"
  },
  "reference_content": "The provided content contains details about a fix for a deadlock vulnerability in the Linux kernel, specifically addressing issues related to inode eviction during LRU traversal. This information is relevant to the CVE, as it describes the root cause, impact, and fix for the vulnerability.\n\n**Root Cause of Vulnerability:**\n\nThe root cause lies in the interaction between the inode reclaiming process and certain filesystems (ext4 with ea_inode, ubifs with xattr) that perform inode lookups within their inode eviction callbacks. The inode reclaiming process marks reclaimable inodes with the `I_FREEING` flag. When a filesystem attempts an inode lookup under the inode lru traversing context, and the target inode is marked with `I_FREEING`, it leads to a deadlock.\n\nTwo deadlock scenarios were identified:\n\n*   **Case 1 (Ext4):**  A process (PA) attempts to drop caches which triggers inode reclaiming, while another process (PB) tries to remove a file. The sequence of operations can lead to a situation where the inode reclaim process is waiting for an inode to become free, while the inode evict process is trying to lookup another inode which is marked I\\_FREEING, causing a deadlock.\n*   **Case 2 (UBIFS):** A similar issue arises in UBIFS where a file deletion process holds a mutex (wbuf->io\\_mutex) and then performs an inode lookup, and it races with the inode reclaiming process, resulting in an ABBA deadlock.\n\n**Weaknesses/Vulnerabilities Present:**\n\n*   **Deadlock:** The core vulnerability is the potential for a deadlock during inode eviction, specifically when filesystems perform inode lookups within eviction callbacks while the inode is in the process of being reclaimed.\n*   **Race Condition:** The described scenarios involve race conditions between the inode reclaiming process and other processes performing file operations.\n*   **Improper Synchronization:** The original design failed to properly synchronize access to inodes during both eviction and reclaiming process, leading to the deadlock.\n\n**Impact of Exploitation:**\n\n*   **System Hang/Denial of Service:** The deadlock leads to a system hang, preventing further operations and resulting in a denial of service. The system will become unresponsive, requiring a reboot.\n\n**Attack Vectors:**\n\n*   **Triggering Inode Reclaiming:** Attackers can trigger the vulnerability by initiating operations that lead to inode reclaiming, for example, by dropping caches (`echo 2 > /proc/sys/vm/drop_caches`).\n*   **File Operations:** Simultaneously performing file operations that trigger inode evictions (like `rm file A` and `rm file B`), while the inode reclaim process is active, can trigger the deadlock.\n*   **Specific Filesystem Usage**: The vulnerability is triggered when filesystems like `ext4` (with ea\\_inode feature enabled) or `ubifs` (with xattr) are used\n\n**Required Attacker Capabilities/Position:**\n\n*   **Local User:** The attacker needs to be a local user on the system with the ability to perform file operations and drop caches.\n*   **Ability to Trigger Specific File Operations:** The attacker needs to be able to trigger specific sequences of file operations that lead to inode eviction and lookups under memory pressure.\n*  **Targeted Filesystem:** The target file system must be one of the affected types, such as ext4 with the ea\\_inode feature or ubifs with xattr.\n\n**Fix:**\n\nThe fix introduces a new inode state flag, `I_LRU_ISOLATING`, to handle inode reclamation safely. Instead of using a regular inode reference, inodes are \"pinned\" using the new flag during the `inode_lru_isolate()` function. This prevents inode deletion from being triggered during page reclamation, thus avoiding the deadlock. The `evict()` function is also modified to wait for the `I_LRU_ISOLATING` flag to be cleared before proceeding with cleanup. The fix involves modifications to `fs/inode.c` and `include/linux/fs.h`.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-833 | Deadlock | 1.0 | Base | Primary | Allowed |\n| CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 0.7 | Class | Secondary Candidate | Allowed-with-Review |\n| CWE-772 | Missing Release of Resource after Effective Lifetime | 0.6 | Base | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE selected is CWE-833 (Deadlock), which accurately reflects the vulnerability's core issue. CWE-362 (Race Condition) is a related Class-level CWE that describes the concurrent execution aspect, but it is less specific than CWE-833. CWE-772 (Missing Release of Resource after Effective Lifetime) is also related, as the deadlock occurs when resources are not properly released. The hierarchical relationships support the choice of CWE-833 as the primary CWE.\n\n```mermaid\ngraph TD\n    cwe833[\"CWE-833: Deadlock\"]\n    cwe362[\"CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')\"]\n    cwe772[\"CWE-772: Missing Release of Resource after Effective Lifetime\"]\n\n    cwe833 -->|PEEROF| cwe362\n    cwe404[\"CWE-404: Improper Resource Shutdown or Release\"]\n    cwe772 -->|CHILDOF| cwe404\n    cwe772 -->|CANFOLLOW| cwe911[\"CWE-911: Improper Update of Reference Count\"]\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe833 primary\n    class cwe362,cwe772 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **inode lookup in the inode evicting callback function**. This leads to a race condition where the inode reclaiming process and other processes contend for the same resources. The lack of proper synchronization results in a **deadlock**, which is the ultimate impact of the vulnerability.\n\n## Summary of Analysis\nThe analysis is based on the provided evidence, which clearly indicates a deadlock vulnerability in the Linux kernel. The **rootcause** is the **inode lookup in the inode evicting callback function** during the inode reclaiming process, specifically when certain filesystems (ext4, ubifs) are used. The vulnerability chain involves a race condition and improper synchronization, ultimately leading to a deadlock.\n\nThe retriever results included several candidate CWEs, but CWE-833 (Deadlock) best matches the vulnerability description. CWE-362 (Race Condition) is a related weakness, but it is less specific than CWE-833. CWE-772 (Missing Release of Resource after Effective Lifetime) is a plausible secondary weakness, but its relationship to the primary deadlock is less direct.\n\nThe selected CWEs are at the optimal level of specificity. CWE-833 is a Base-level CWE that accurately represents the vulnerability's core issue. CWE-362 is a Class-level CWE that provides additional context about the concurrent execution aspect, but it is less specific than CWE-833.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-667: Improper Locking\n**Abstraction Level**: Class\n**Similarity Score**: 0.79\n**Source**: dense\n\n**Description**:\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-833: Deadlock\n**Abstraction Level**: Base\n**Similarity Score**: 0.79\n**Source**: dense\n\n**Description**:\nThe product contains multiple threads or executable segments that are waiting for each other to release a necessary lock, resulting in deadlock.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence operating concurrently.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-404: Improper Resource Shutdown or Release\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product does not release or incorrectly releases a resource before it is made available for re-use.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-755: Improper Handling of Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product does not handle or incorrectly handles an exceptional condition.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-407: Inefficient Algorithmic Complexity\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nAn algorithm in a product has an inefficient worst-case computational complexity that may be detrimental to system performance and can be triggered by an attacker, typically using crafted manipulations that ensure that the worst case is being reached.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-824: Access of Uninitialized Pointer\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product accesses or uses a pointer that has not been initialized.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-59: Improper Link Resolution Before File Access ('Link Following')\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-617: Reachable Assertion\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-775: Missing Release of File Descriptor or Handle after Effective Lifetime\n**Abstraction Level**: Variant\n**Similarity Score**: 1663.13\n**Source**: sparse\n\n**Description**:\nThe product does not release a file descriptor or handle after its effective lifetime has ended, i.e., after the file descriptor/handle is no longer needed.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-3",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-833 | Deadlock | 1.0 | Base | Primary | Allowed |\n| CWE-362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 0.7 | Class | Secondary Candidate | Allowed-with-Review |\n| CWE-772 | Missing Release of Resource after Effective Lifetime | 0.6 | Base | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE selected is CWE-833 (Deadlock), which accurately reflects the vulnerability's core issue. CWE-362 (Race Condition) is a related Class-level CWE that describes the concurrent execution aspect, but it is less specific than CWE-833. CWE-772 (Missing Release of Resource after Effective Lifetime) is also related, as the deadlock occurs when resources are not properly released. The hierarchical relationships support the choice of CWE-833 as the primary CWE.\n\n```mermaid\ngraph TD\n    cwe833[\"CWE-833: Deadlock\"]\n    cwe362[\"CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')\"]\n    cwe772[\"CWE-772: Missing Release of Resource after Effective Lifetime\"]\n\n    cwe833 -->|PEEROF| cwe362\n    cwe404[\"CWE-404: Improper Resource Shutdown or Release\"]\n    cwe772 -->|CHILDOF| cwe404\n    cwe772 -->|CANFOLLOW| cwe911[\"CWE-911: Improper Update of Reference Count\"]\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe833 primary\n    class cwe362,cwe772 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **inode lookup in the inode evicting callback function**. This leads to a race condition where the inode reclaiming process and other processes contend for the same resources. The lack of proper synchronization results in a **deadlock**, which is the ultimate impact of the vulnerability.\n\n## Summary of Analysis\nThe analysis is based on the provided evidence, which clearly indicates a deadlock vulnerability in the Linux kernel. The **rootcause** is the **inode lookup in the inode evicting callback function** during the inode reclaiming process, specifically when certain filesystems (ext4, ubifs) are used. The vulnerability chain involves a race condition and improper synchronization, ultimately leading to a deadlock.\n\nThe retriever results included several candidate CWEs, but CWE-833 (Deadlock) best matches the vulnerability description. CWE-362 (Race Condition) is a related weakness, but it is less specific than CWE-833. CWE-772 (Missing Release of Resource after Effective Lifetime) is a plausible secondary weakness, but its relationship to the primary deadlock is less direct.\n\nThe selected CWEs are at the optimal level of specificity. CWE-833 is a Base-level CWE that accurately represents the vulnerability's core issue. CWE-362 is a Class-level CWE that provides additional context about the concurrent execution aspect, but it is less specific than CWE-833.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-667: Improper Locking\n**Abstraction Level**: Class\n**Similarity Score**: 0.79\n**Source**: dense\n\n**Description**:\nThe product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-833: Deadlock\n**Abstraction Level**: Base\n**Similarity Score**: 0.79\n**Source**: dense\n\n**Description**:\nThe product contains multiple threads or executable segments that are waiting for each other to release a necessary lock, resulting in deadlock.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence operating concurrently.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-404: Improper Resource Shutdown or Release\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product does not release or incorrectly releases a resource before it is made available for re-use.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-755: Improper Handling of Exceptional Conditions\n**Abstraction Level**: Class\n**Similarity Score**: 0.76\n**Source**: dense\n\n**Description**:\nThe product does not handle or incorrectly handles an exceptional condition.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate\n\n## CWE-407: Inefficient Algorithmic Complexity\n**Abstraction Level**: Class\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nAn algorithm in a product has an inefficient worst-case computational complexity that may be detrimental to system performance and can be triggered by an attacker, typically using crafted manipulations that ensure that the worst case is being reached.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-824: Access of Uninitialized Pointer\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product accesses or uses a pointer that has not been initialized.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-59: Improper Link Resolution Before File Access ('Link Following')\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-617: Reachable Assertion\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition\n**Abstraction Level**: Base\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-775: Missing Release of File Descriptor or Handle after Effective Lifetime\n**Abstraction Level**: Variant\n**Similarity Score**: 1663.13\n**Source**: sparse\n\n**Description**:\nThe product does not release a file descriptor or handle after its effective lifetime has ended, i.e., after the file descriptor/handle is no longer needed.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-3\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-911:**\n- 911 (Improper Update of Reference Count) - ROOT\n\n\n**Chain starting from CWE-407:**\n- 407 (Inefficient Algorithmic Complexity) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "775",
        "name": "Missing Release of File Descriptor or Handle after Effective Lifetime",
        "source": "sparse"
      },
      "similarity": 940.5898303870263
    },
    {
      "metadata": {
        "doc_id": "917",
        "name": "Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')",
        "source": "sparse"
      },
      "similarity": 677.0128047845176
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 635.7117333290822
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 622.0016621728889
    },
    {
      "metadata": {
        "doc_id": "379",
        "name": "Creation of Temporary File in Directory with Insecure Permissions",
        "source": "sparse"
      },
      "similarity": 618.5129626395523
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse"
      },
      "similarity": 609.7686656064777
    },
    {
      "metadata": {
        "doc_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "source": "sparse"
      },
      "similarity": 608.3413427383007
    },
    {
      "metadata": {
        "doc_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "source": "sparse"
      },
      "similarity": 607.5771338724664
    },
    {
      "metadata": {
        "doc_id": "911",
        "name": "Improper Update of Reference Count",
        "type": "Base",
        "original_content": "The product uses a reference count to manage a resource, but it does not update or incorrectly updates the reference count.",
        "keyphrase_source": "rootcause:inode lookup in the inode evicting callback function",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.4318999976274942,
            "graph": 1.8859872370270896
          }
        }
      },
      "similarity": 0.4318999976274942
    },
    {
      "doc_id": "772",
      "text": "CWE-772: Missing Release of Resource after Effective Lifetime",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "772",
        "name": "Missing Release of Resource after Effective Lifetime",
        "type": "base",
        "original_content": "CWE-772: Missing Release of Resource after Effective Lifetime",
        "relationships": [
          {
            "source_id": "772",
            "target_id": "911",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "775",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "401",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "1091",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "772",
            "target_id": "404",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1340"
            }
          },
          {
            "source_id": "772",
            "target_id": "404",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          },
          {
            "source_id": "772",
            "target_id": "404",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "772",
            "target_id": "404",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "911",
            "target_id": "772",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "775",
            "target_id": "772",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "404",
            "target_id": "772",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "401",
            "target_id": "772",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1091",
            "target_id": "772",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "911",
                  "772",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "911"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "911",
                  "772",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "911"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-911",
      "CWE-407",
      "CWE-404",
      "CWE-775",
      "CWE-59",
      "CWE-667",
      "CWE-833",
      "CWE-3",
      "CWE-362",
      "CWE-755",
      "CWE-824",
      "CWE-617",
      "CWE-367",
      "CWE-772"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}