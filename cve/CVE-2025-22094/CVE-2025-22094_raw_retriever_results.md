# Raw Retriever Results for CVE-2025-22094

# Raw Retriever Results for CVE-2025-22094
## Query
In the Linux kernel, the following vulnerability has been resolved powerpc/perf Fix ref-counting on the PMU vpa_pmu Commit 176cda0619b6 (powerpc/perf Add perf interface to expose vpa counters) introduced vpa_pmu to expose Book3s-HV nested APIv2 provided L1L2 context switch latency counters to L1 user-space via perf-events. However the newly introduced PMU named vpa_pmu doesnt assign ownership of the PMU to the module vpa_pmu. Consequently the module vpa_pmu can be unloaded while one of the perf-events are still active, which can lead to kernel oops and panic of the form below on a Pseries-LPAR BUG Kernel NULL pointer dereference on read at 0x00000058 NIP [c000000000506cb8] event_sched_out+0x40/0x258 LR [c00000000050e8a4] __perf_remove_from_context+0x7c/0x2b0 Call Trace [c00000025fc3fc30] [c00000025f8457a8] 0xc00000025f8457a8 (unreliable) [c00000025fc3fc80] [fffffffffffffee0] 0xfffffffffffffee0 [c00000025fc3fcd0] [c000000000501e70] event_function+0xa8/0x120 Kernel panic - not syncing Aiee, killing interrupt handler! Fix this by adding the module ownership to vpa_pmu so that the module vpa_pmu is ref-counted and prevented from being unloaded when perf-events are initialized.

## Keyphrases
- **rootcause**: 'improper ref-counting'
- **weakness**: 'Kernel NULL pointer dereference'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4732 | 0.5217 | 0.4931 | 0.4874 | 20 |
| Sparse | 556.3682 | 618.9138 | 583.6808 | 583.4462 | 14 |
| Graph | 1.6848 | 2.7949 | 2.0516 | 2.0393 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | Base | 2.7949 | Allowed |
| 2 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.6784 | Allowed |
| 3 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 4 | 393 | Return of Wrong Status Code | base | 2.3296 | Allowed |
| 5 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 6 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 7 | 125 | Out-of-bounds Read | base | 2.2100 | Allowed |
| 8 | 252 | Unchecked Return Value | base | 2.2100 | Allowed |
| 9 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 10 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 11 | 822 | Untrusted Pointer Dereference | Base | 2.0387 | Allowed |
| 12 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 1.9139 | Allowed |
| 13 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 14 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 15 | 1284 | Improper Validation of Specified Quantity in Input | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.5217 | 0.5217 | Allowed |
| 2 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5192 | 0.5192 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5176 | 0.5176 | Allowed-with-Review |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5143 | 0.5143 | Allowed |
| 5 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.5138 | 0.5138 | Allowed |
| 6 | 667 | Improper Locking | Class | 0.5050 | 0.5050 | Allowed-with-Review |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5017 | 0.5017 | Allowed-with-Review |
| 8 | 911 | Improper Update of Reference Count | Base | 0.4947 | 0.4947 | Allowed |
| 9 | 822 | Untrusted Pointer Dereference | Base | 0.4910 | 0.4910 | Allowed |
| 10 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4875 | 0.4875 | Allowed |
| 11 | 1262 | Improper Access Control for Register Interface | Base | 0.4873 | 0.4873 | Allowed |
| 12 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4856 | 0.4856 | Allowed |
| 13 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4831 | 0.4831 | Allowed |
| 14 | 1037 | Processor Optimization Removal or Modification of Security-critical Code | Base | 0.4812 | 0.4812 | Allowed |
| 15 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4799 | 0.4799 | Discouraged |

## Sparse Retriever Results (14)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 393 | Return of Wrong Status Code | 618.9138 | 618.9138 | Allowed |
| 2 | 911 | Improper Update of Reference Count | 605.7134 | 605.7134 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 604.1109 | 604.1109 | Allowed-with-Review |
| 4 | 822 | Untrusted Pointer Dereference | 600.0853 | 600.0853 | Allowed |
| 5 | 476 | NULL Pointer Dereference | 596.7997 | 596.7997 | Allowed |
| 6 | 667 | Improper Locking | 588.3846 | 588.3846 | Allowed-with-Review |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | 586.7896 | 586.7896 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | 580.1028 | 580.1028 | Allowed |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 574.8902 | 574.8902 | Allowed |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 573.6427 | 573.6427 | Allowed |
| 11 | 833 | Deadlock | 564.6370 | 564.6370 | Allowed |
| 12 | 909 | Missing Initialization of Resource | 561.7113 | 561.7113 | Allowed-with-Review |
| 13 | 787 | Out-of-bounds Write | 559.3817 | 559.3817 | Allowed |
| 14 | 908 | Use of Uninitialized Resource | 556.3682 | 556.3682 | Allowed |
