# Vulnerability Information: CVE-2024-9355

## Vulnerability Description
A vulnerability was found in Golang FIPS OpenSSL. This flaw allows a malicious user to randomly cause an **uninitialized buffer length variable** with a zeroed buffer to be returned in FIPS mode. It may also be possible to force a false positive match between non-equal hashes when comparing a trusted computed hmac sum to an untrusted input sum if an attacker can send a zeroed buffer in place of a pre-computed sum. It is also possible to force a derived key to be all zeros instead of an unpredictable value. This may have follow-on implications for the Go TLS stack.

### Vulnerability Description Key Phrases
- **rootcause:** **uninitialized buffer length variable**
- **impact:** force a false positive match
- **vector:** zeroed buffer
- **attacker:** malicious user
- **product:** Golang FIPS OpenSSL

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "CVE-2024-9355": {
      "status": "relevant",
      "details": {
        "root_cause": "The vulnerability stems from an uninitialized buffer length variable in the CGO bindings of the golang-fips package, specifically affecting the (*boringHMAC).Sum() function when in FIPS mode.",
        "weaknesses": [
          "The primary weakness is the presence of an uninitialized buffer length variable. This leads to the possibility of a zeroed buffer being returned by the `(*boringHMAC).Sum()` function."
        ],
        "impact": "A malicious user may intermittently receive a zeroed buffer instead of a valid cryptographic hash. This can lead to a false positive match between a trusted computed HMAC sum and an untrusted input sum if the attacker controls the input. Additionally, it is possible to force a derived key to be all zeros instead of an unpredictable value. This can have follow-on implications for the Go TLS stack.",
         "attack_vectors": [
            "An attacker could exploit this by sending crafted inputs to a service that uses the vulnerable `(*boringHMAC).Sum()` function in FIPS mode.",
            "The attacker needs to be able to influence the input of the hmac function to cause an uninitialized buffer to be used"
          ],
        "required_capabilities": "The attacker needs to be able to trigger the vulnerable code path, specifically, influence the input to cause an uninitialized buffer to be used within the hmac function in FIPS mode. The attack is intermittent and depends on stack layout. The attacker must also be in a position to observe or use the output of the affected hmac function."
      },
        "affected_products": [
          "Red Hat Enterprise Linux 8",
          "Red Hat Enterprise Linux 9",
          "Red Hat Enterprise Linux 9.4 Extended Update Support",
          "Red Hat Enterprise Linux 7 Extended Lifecycle Support",
           "Red Hat Enterprise Linux Server - AUS 9.4",
           "Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 9.4",
           "Red Hat Enterprise Linux for x86_64 - Update Services for SAP Solutions 9.4",
           "Red Hat Enterprise Linux for ARM 64 - 4 years of updates 9.4",
          "Red Hat Enterprise Linux for IBM z Systems - 4 years of updates 9.4"
        ]
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.602 |
| 2 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.602 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.593 |
| 4 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.576 |
| 5 | 194 | Unexpected Sign Extension | Variant | Allowed | sparse | 0.573 |
| 6 | 457 | Use of Uninitialized Variable | Variant | Allowed | sparse | 0.573 |
| 7 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.572 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.566 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.600 |
| 10 | 193 | Off-by-one Error | Base | Allowed | graph | 0.003 |

