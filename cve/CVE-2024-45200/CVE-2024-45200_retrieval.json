{
  "vulnerability_info": "VulnerabilityInfo(cve_id='CVE-2024-45200', description='In Nintendo Mario Kart 8 Deluxe before 3.0.3, the LAN/LDN local multiplayer implementation allows a remote attacker to exploit a **stack-based buffer overflow** upon **deserialization** of session information via a malformed browse-reply packet, aka KartLANPwn. The victim is not required to join a game session with an attacker. The victim must open the Wireless Play (or LAN Play) menu from the games title screen, and an attacker nearby (LDN) or on the same LAN network as the victim can send a crafted reply packet to the victims console. This enables a remote attacker to obtain complete denial-of-service on the games process, or potentially, remote code execution on the victims console. The issue is caused by **incorrect use of the Nintendo Pia library**,', key_phrases={'rootcause': 'incorrect use of the Nintendo Pia library', 'weakness': ['deserialization', 'stack-based buffer overflow'], 'impact': [\"['obtain complete denial-of-service on the games process'\", \"'remote code execution']\"], 'vector': 'malformed browse-reply packet', 'attacker': 'remote attacker', 'product': 'Nintendo Mario Kart 8 Deluxe', 'version': 'before 3.0.3', 'component': 'LAN/LDN local multiplayer implementation'}, reference_content='Based on the provided content, here\\'s a breakdown of the vulnerability:\\n\\n**Root cause of vulnerability:**\\n\\n*   The vulnerability stems from an incorrect usage of the `Pia` P2P networking library in Mario Kart 8 Deluxe. Specifically, the `LAN_CopyAppData` function is sometimes called with an `outBufSize` argument that is larger than the actual `out` buffer.\\n\\n**Weaknesses/vulnerabilities present:**\\n\\n*   **Stack-based buffer overflow:** The `LAN_CopyAppData` function copies data from a network packet into a stack buffer. Due to the incorrect size check, an attacker can provide a size of application data larger than the destination buffer, causing a buffer overflow on the stack.\\n\\n**Impact of exploitation:**\\n\\n*   **Denial of Service (DoS):** The provided proof-of-concept crashes the game\\'s process.\\n*   **Potential remote code execution (RCE):** While the proof-of-concept is a crash, the overflow *could* lead to user-mode remote code execution if chained with an info leak, however, this was determined to be not very feasible given the Switch kernel\\'s usermode restrictions.\\n\\n**Attack vectors:**\\n\\n*   **Network:** The vulnerability is triggered through specially crafted \"browse-reply\" packets sent over the network, specifically in the LAN/LDN multiplayer mode.\\n\\n**Required attacker capabilities/position:**\\n\\n*   The attacker needs to be on the same local network as the target Nintendo Switch console.\\n*   The attacker needs to be able to send UDP packets to the target console (acting as a fake room host).\\n*   The attacker would need to have a way to discover the target console (e.g. by sending broadcast requests).\\n\\n**Additional notes:**\\n\\n*   The vulnerability affects all versions of Mario Kart 8 Deluxe up to and including v3.0.1 (v3.0.2 for China/Tencent).\\n*   Nintendo released a fix in v3.0.3 of the game.\\n*   The `Pia` library is used by first-party Nintendo Switch games for peer-to-peer networking in both local (LAN/LDN) and online (NEX) multiplayer.\\n*   The vulnerability was triggered by manipulating the length of application data in a browse-reply packet sent by the room host.\\n*   The stack overflow overwrite was able to corrupt the return address on the stack and trigger a process crash.', similar_info={'cwe_distribution': {}, 'cwe_consensus': '', 'similarity_stats': {'thresholds': [], 'total_samples_by_threshold': {}, 'top_cwes_by_threshold': {}}}, similarity_summary=SimilarityInsight(consensus_cwe='', top_cwes=[], confidence_levels={}, total_samples=0), analysis='', analysis_with_relationships='', criticism='', resolution='', relevant_cwes=[{'metadata': {'doc_id': '121', 'name': 'Stack-based Buffer Overflow', 'source': 'sparse', 'original_content': 'A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).', 'keyphrase_sources': [{'id': 'rootcause:incorrect use of the Nintendo Pia library', 'keyphrase': 'incorrect use of the Nintendo Pia library', 'type': 'rootcause'}, {'id': 'weakness:deserialization', 'keyphrase': 'deserialization', 'type': 'weakness'}, {'id': 'weakness:stack-based buffer overflow', 'keyphrase': 'stack-based buffer overflow', 'type': 'weakness'}, {'id': \"impact:['obtain complete denial-of-service on the games process'\", 'keyphrase': \"['obtain complete denial-of-service on the games process'\", 'type': 'impact'}, {'id': \"impact:'remote code execution']\", 'keyphrase': \"'remote code execution']\", 'type': 'impact'}, {'id': 'vector:malformed browse-reply packet', 'keyphrase': 'malformed browse-reply packet', 'type': 'vector'}, {'id': 'attacker:remote attacker', 'keyphrase': 'remote attacker', 'type': 'attacker'}, {'id': 'product:Nintendo Mario Kart 8 Deluxe', 'keyphrase': 'Nintendo Mario Kart 8 Deluxe', 'type': 'product'}, {'id': 'version:before 3.0.3', 'keyphrase': 'before 3.0.3', 'type': 'version'}, {'id': 'component:LAN/LDN local multiplayer implementation', 'keyphrase': 'LAN/LDN local multiplayer implementation', 'type': 'component'}]}, 'similarity': np.float64(761.092288636683)}, {'metadata': {'doc_id': '20', 'name': 'Improper Input Validation', 'source': 'sparse', 'original_content': 'The product receives input or data, but it does\\n        not validate or incorrectly validates that the input has the\\n        properties that are required to process the data safely and\\n        correctly.', 'keyphrase_sources': [{'id': 'rootcause:incorrect use of the Nintendo Pia library', 'keyphrase': 'incorrect use of the Nintendo Pia library', 'type': 'rootcause'}, {'id': 'weakness:deserialization', 'keyphrase': 'deserialization', 'type': 'weakness'}, {'id': 'weakness:stack-based buffer overflow', 'keyphrase': 'stack-based buffer overflow', 'type': 'weakness'}, {'id': \"impact:['obtain complete denial-of-service on the games process'\", 'keyphrase': \"['obtain complete denial-of-service on the games process'\", 'type': 'impact'}, {'id': \"impact:'remote code execution']\", 'keyphrase': \"'remote code execution']\", 'type': 'impact'}, {'id': 'vector:malformed browse-reply packet', 'keyphrase': 'malformed browse-reply packet', 'type': 'vector'}, {'id': 'attacker:remote attacker', 'keyphrase': 'remote attacker', 'type': 'attacker'}, {'id': 'product:Nintendo Mario Kart 8 Deluxe', 'keyphrase': 'Nintendo Mario Kart 8 Deluxe', 'type': 'product'}, {'id': 'version:before 3.0.3', 'keyphrase': 'before 3.0.3', 'type': 'version'}, {'id': 'component:LAN/LDN local multiplayer implementation', 'keyphrase': 'LAN/LDN local multiplayer implementation', 'type': 'component'}]}, 'similarity': np.float64(754.2824206040526)}, {'metadata': {'doc_id': '119', 'name': 'Improper Restriction of Operations within the Bounds of a Memory Buffer', 'source': 'sparse', 'original_content': \"The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.\", 'keyphrase_sources': [{'id': 'rootcause:incorrect use of the Nintendo Pia library', 'keyphrase': 'incorrect use of the Nintendo Pia library', 'type': 'rootcause'}, {'id': 'weakness:deserialization', 'keyphrase': 'deserialization', 'type': 'weakness'}, {'id': \"impact:'remote code execution']\", 'keyphrase': \"'remote code execution']\", 'type': 'impact'}, {'id': 'vector:malformed browse-reply packet', 'keyphrase': 'malformed browse-reply packet', 'type': 'vector'}, {'id': 'attacker:remote attacker', 'keyphrase': 'remote attacker', 'type': 'attacker'}, {'id': 'product:Nintendo Mario Kart 8 Deluxe', 'keyphrase': 'Nintendo Mario Kart 8 Deluxe', 'type': 'product'}, {'id': 'version:before 3.0.3', 'keyphrase': 'before 3.0.3', 'type': 'version'}, {'id': 'component:LAN/LDN local multiplayer implementation', 'keyphrase': 'LAN/LDN local multiplayer implementation', 'type': 'component'}]}, 'similarity': np.float64(744.862368484095)}, {'metadata': {'doc_id': '1284', 'name': 'Improper Validation of Specified Quantity in Input', 'source': 'sparse', 'original_content': 'The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.', 'keyphrase_sources': [{'id': 'rootcause:incorrect use of the Nintendo Pia library', 'keyphrase': 'incorrect use of the Nintendo Pia library', 'type': 'rootcause'}, {'id': 'weakness:deserialization', 'keyphrase': 'deserialization', 'type': 'weakness'}, {'id': 'weakness:stack-based buffer overflow', 'keyphrase': 'stack-based buffer overflow', 'type': 'weakness'}, {'id': \"impact:['obtain complete denial-of-service on the games process'\", 'keyphrase': \"['obtain complete denial-of-service on the games process'\", 'type': 'impact'}, {'id': \"impact:'remote code execution']\", 'keyphrase': \"'remote code execution']\", 'type': 'impact'}, {'id': 'vector:malformed browse-reply packet', 'keyphrase': 'malformed browse-reply packet', 'type': 'vector'}, {'id': 'attacker:remote attacker', 'keyphrase': 'remote attacker', 'type': 'attacker'}, {'id': 'product:Nintendo Mario Kart 8 Deluxe', 'keyphrase': 'Nintendo Mario Kart 8 Deluxe', 'type': 'product'}, {'id': 'version:before 3.0.3', 'keyphrase': 'before 3.0.3', 'type': 'version'}, {'id': 'component:LAN/LDN local multiplayer implementation', 'keyphrase': 'LAN/LDN local multiplayer implementation', 'type': 'component'}]}, 'similarity': np.float64(737.9183240445844)}, {'metadata': {'doc_id': '122', 'name': 'Heap-based Buffer Overflow', 'source': 'sparse', 'original_content': 'A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().', 'keyphrase_sources': [{'id': 'rootcause:incorrect use of the Nintendo Pia library', 'keyphrase': 'incorrect use of the Nintendo Pia library', 'type': 'rootcause'}, {'id': 'weakness:stack-based buffer overflow', 'keyphrase': 'stack-based buffer overflow', 'type': 'weakness'}, {'id': \"impact:'remote code execution']\", 'keyphrase': \"'remote code execution']\", 'type': 'impact'}, {'id': 'vector:malformed browse-reply packet', 'keyphrase': 'malformed browse-reply packet', 'type': 'vector'}, {'id': 'attacker:remote attacker', 'keyphrase': 'remote attacker', 'type': 'attacker'}, {'id': 'product:Nintendo Mario Kart 8 Deluxe', 'keyphrase': 'Nintendo Mario Kart 8 Deluxe', 'type': 'product'}, {'id': 'version:before 3.0.3', 'keyphrase': 'before 3.0.3', 'type': 'version'}]}, 'similarity': np.float64(734.0618008758673)}, {'metadata': {'doc_id': '120', 'name': \"Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')\", 'source': 'sparse', 'original_content': 'The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.', 'keyphrase_sources': [{'id': 'weakness:stack-based buffer overflow', 'keyphrase': 'stack-based buffer overflow', 'type': 'weakness'}]}, 'similarity': np.float64(701.176993226718)}, {'metadata': {'doc_id': '502', 'name': 'Deserialization of Untrusted Data', 'source': 'sparse', 'original_content': 'The product deserializes untrusted data without sufficiently ensuring that the resulting data will be valid.', 'keyphrase_sources': [{'id': 'weakness:deserialization', 'keyphrase': 'deserialization', 'type': 'weakness'}]}, 'similarity': np.float64(655.6304416313677)}, {'metadata': {'doc_id': '290', 'name': 'Authentication Bypass by Spoofing', 'source': 'sparse', 'original_content': 'This attack-focused weakness is caused by incorrectly implemented authentication schemes that are subject to spoofing attacks.', 'keyphrase_sources': [{'id': \"impact:['obtain complete denial-of-service on the games process'\", 'keyphrase': \"['obtain complete denial-of-service on the games process'\", 'type': 'impact'}]}, 'similarity': np.float64(261.5185832500627)}, {'metadata': {'doc_id': '787', 'name': 'Out-of-bounds Write', 'source': 'sparse', 'original_content': 'The product writes data past the end, or before the beginning, of the intended buffer.', 'keyphrase_sources': [{'id': \"impact:['obtain complete denial-of-service on the games process'\", 'keyphrase': \"['obtain complete denial-of-service on the games process'\", 'type': 'impact'}]}, 'similarity': np.float64(258.60002869042836)}, {'metadata': {'doc_id': '303', 'name': 'Incorrect Implementation of Authentication Algorithm', 'source': 'sparse', 'original_content': 'The requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.', 'keyphrase_sources': [{'id': 'component:LAN/LDN local multiplayer implementation', 'keyphrase': 'LAN/LDN local multiplayer implementation', 'type': 'component'}]}, 'similarity': np.float64(233.4511869085366)}], identified_cwes={'analyzer': [], 'critic_additional': []})",
  "retrieval_results": {
    "has_multiple_keyphrases": true,
    "keyphrase_cwe_sets": {
      "rootcause:incorrect use of the Nintendo Pia library": {
        "keyphrase": "incorrect use of the Nintendo Pia library",
        "type": "rootcause",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).",
              "keyphrase_sources": [
                {
                  "id": "rootcause:incorrect use of the Nintendo Pia library",
                  "keyphrase": "incorrect use of the Nintendo Pia library",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:deserialization",
                  "keyphrase": "deserialization",
                  "type": "weakness"
                },
                {
                  "id": "weakness:stack-based buffer overflow",
                  "keyphrase": "stack-based buffer overflow",
                  "type": "weakness"
                },
                {
                  "id": "impact:['obtain complete denial-of-service on the games process'",
                  "keyphrase": "['obtain complete denial-of-service on the games process'",
                  "type": "impact"
                },
                {
                  "id": "impact:'remote code execution']",
                  "keyphrase": "'remote code execution']",
                  "type": "impact"
                },
                {
                  "id": "vector:malformed browse-reply packet",
                  "keyphrase": "malformed browse-reply packet",
                  "type": "vector"
                },
                {
                  "id": "attacker:remote attacker",
                  "keyphrase": "remote attacker",
                  "type": "attacker"
                },
                {
                  "id": "product:Nintendo Mario Kart 8 Deluxe",
                  "keyphrase": "Nintendo Mario Kart 8 Deluxe",
                  "type": "product"
                },
                {
                  "id": "version:before 3.0.3",
                  "keyphrase": "before 3.0.3",
                  "type": "version"
                },
                {
                  "id": "component:LAN/LDN local multiplayer implementation",
                  "keyphrase": "LAN/LDN local multiplayer implementation",
                  "type": "component"
                }
              ]
            },
            "similarity": 761.092288636683
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:incorrect use of the Nintendo Pia library",
                  "keyphrase": "incorrect use of the Nintendo Pia library",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:deserialization",
                  "keyphrase": "deserialization",
                  "type": "weakness"
                },
                {
                  "id": "weakness:stack-based buffer overflow",
                  "keyphrase": "stack-based buffer overflow",
                  "type": "weakness"
                },
                {
                  "id": "impact:['obtain complete denial-of-service on the games process'",
                  "keyphrase": "['obtain complete denial-of-service on the games process'",
                  "type": "impact"
                },
                {
                  "id": "impact:'remote code execution']",
                  "keyphrase": "'remote code execution']",
                  "type": "impact"
                },
                {
                  "id": "vector:malformed browse-reply packet",
                  "keyphrase": "malformed browse-reply packet",
                  "type": "vector"
                },
                {
                  "id": "attacker:remote attacker",
                  "keyphrase": "remote attacker",
                  "type": "attacker"
                },
                {
                  "id": "product:Nintendo Mario Kart 8 Deluxe",
                  "keyphrase": "Nintendo Mario Kart 8 Deluxe",
                  "type": "product"
                },
                {
                  "id": "version:before 3.0.3",
                  "keyphrase": "before 3.0.3",
                  "type": "version"
                },
                {
                  "id": "component:LAN/LDN local multiplayer implementation",
                  "keyphrase": "LAN/LDN local multiplayer implementation",
                  "type": "component"
                }
              ]
            },
            "similarity": 754.2824206040526
          },
          {
            "metadata": {
              "doc_id": "119",
              "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
              "source": "sparse",
              "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:incorrect use of the Nintendo Pia library",
                  "keyphrase": "incorrect use of the Nintendo Pia library",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:deserialization",
                  "keyphrase": "deserialization",
                  "type": "weakness"
                },
                {
                  "id": "impact:'remote code execution']",
                  "keyphrase": "'remote code execution']",
                  "type": "impact"
                },
                {
                  "id": "vector:malformed browse-reply packet",
                  "keyphrase": "malformed browse-reply packet",
                  "type": "vector"
                },
                {
                  "id": "attacker:remote attacker",
                  "keyphrase": "remote attacker",
                  "type": "attacker"
                },
                {
                  "id": "product:Nintendo Mario Kart 8 Deluxe",
                  "keyphrase": "Nintendo Mario Kart 8 Deluxe",
                  "type": "product"
                },
                {
                  "id": "version:before 3.0.3",
                  "keyphrase": "before 3.0.3",
                  "type": "version"
                },
                {
                  "id": "component:LAN/LDN local multiplayer implementation",
                  "keyphrase": "LAN/LDN local multiplayer implementation",
                  "type": "component"
                }
              ]
            },
            "similarity": 744.862368484095
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:incorrect use of the Nintendo Pia library",
                  "keyphrase": "incorrect use of the Nintendo Pia library",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:deserialization",
                  "keyphrase": "deserialization",
                  "type": "weakness"
                },
                {
                  "id": "weakness:stack-based buffer overflow",
                  "keyphrase": "stack-based buffer overflow",
                  "type": "weakness"
                },
                {
                  "id": "impact:['obtain complete denial-of-service on the games process'",
                  "keyphrase": "['obtain complete denial-of-service on the games process'",
                  "type": "impact"
                },
                {
                  "id": "impact:'remote code execution']",
                  "keyphrase": "'remote code execution']",
                  "type": "impact"
                },
                {
                  "id": "vector:malformed browse-reply packet",
                  "keyphrase": "malformed browse-reply packet",
                  "type": "vector"
                },
                {
                  "id": "attacker:remote attacker",
                  "keyphrase": "remote attacker",
                  "type": "attacker"
                },
                {
                  "id": "product:Nintendo Mario Kart 8 Deluxe",
                  "keyphrase": "Nintendo Mario Kart 8 Deluxe",
                  "type": "product"
                },
                {
                  "id": "version:before 3.0.3",
                  "keyphrase": "before 3.0.3",
                  "type": "version"
                },
                {
                  "id": "component:LAN/LDN local multiplayer implementation",
                  "keyphrase": "LAN/LDN local multiplayer implementation",
                  "type": "component"
                }
              ]
            },
            "similarity": 737.9183240445844
          },
          {
            "metadata": {
              "doc_id": "122",
              "name": "Heap-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().",
              "keyphrase_sources": [
                {
                  "id": "rootcause:incorrect use of the Nintendo Pia library",
                  "keyphrase": "incorrect use of the Nintendo Pia library",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:stack-based buffer overflow",
                  "keyphrase": "stack-based buffer overflow",
                  "type": "weakness"
                },
                {
                  "id": "impact:'remote code execution']",
                  "keyphrase": "'remote code execution']",
                  "type": "impact"
                },
                {
                  "id": "vector:malformed browse-reply packet",
                  "keyphrase": "malformed browse-reply packet",
                  "type": "vector"
                },
                {
                  "id": "attacker:remote attacker",
                  "keyphrase": "remote attacker",
                  "type": "attacker"
                },
                {
                  "id": "product:Nintendo Mario Kart 8 Deluxe",
                  "keyphrase": "Nintendo Mario Kart 8 Deluxe",
                  "type": "product"
                },
                {
                  "id": "version:before 3.0.3",
                  "keyphrase": "before 3.0.3",
                  "type": "version"
                }
              ]
            },
            "similarity": 734.0618008758673
          }
        ]
      },
      "weakness:deserialization": {
        "keyphrase": "deserialization",
        "type": "weakness",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 659.5366111831706
          },
          {
            "metadata": {
              "doc_id": "502",
              "name": "Deserialization of Untrusted Data",
              "source": "sparse",
              "original_content": "The product deserializes untrusted data without sufficiently ensuring that the resulting data will be valid.",
              "keyphrase_sources": [
                {
                  "id": "weakness:deserialization",
                  "keyphrase": "deserialization",
                  "type": "weakness"
                }
              ]
            },
            "similarity": 655.6304416313677
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 654.664202701555
          },
          {
            "metadata": {
              "doc_id": "119",
              "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
              "source": "sparse",
              "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data."
            },
            "similarity": 637.3071409005408
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 636.625512019165
          }
        ]
      },
      "weakness:stack-based buffer overflow": {
        "keyphrase": "stack-based buffer overflow",
        "type": "weakness",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 761.6251472301968
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 711.4183822234602
          },
          {
            "metadata": {
              "doc_id": "122",
              "name": "Heap-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()."
            },
            "similarity": 704.6050435938437
          },
          {
            "metadata": {
              "doc_id": "120",
              "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
              "source": "sparse",
              "original_content": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
              "keyphrase_sources": [
                {
                  "id": "weakness:stack-based buffer overflow",
                  "keyphrase": "stack-based buffer overflow",
                  "type": "weakness"
                }
              ]
            },
            "similarity": 701.176993226718
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 698.5832709493399
          }
        ]
      },
      "impact:['obtain complete denial-of-service on the games process'": {
        "keyphrase": "['obtain complete denial-of-service on the games process'",
        "type": "impact",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 267.990742393369
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 266.5874782840891
          },
          {
            "metadata": {
              "doc_id": "290",
              "name": "Authentication Bypass by Spoofing",
              "source": "sparse",
              "original_content": "This attack-focused weakness is caused by incorrectly implemented authentication schemes that are subject to spoofing attacks.",
              "keyphrase_sources": [
                {
                  "id": "impact:['obtain complete denial-of-service on the games process'",
                  "keyphrase": "['obtain complete denial-of-service on the games process'",
                  "type": "impact"
                }
              ]
            },
            "similarity": 261.5185832500627
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 259.6782720224943
          },
          {
            "metadata": {
              "doc_id": "787",
              "name": "Out-of-bounds Write",
              "source": "sparse",
              "original_content": "The product writes data past the end, or before the beginning, of the intended buffer.",
              "keyphrase_sources": [
                {
                  "id": "impact:['obtain complete denial-of-service on the games process'",
                  "keyphrase": "['obtain complete denial-of-service on the games process'",
                  "type": "impact"
                }
              ]
            },
            "similarity": 258.60002869042836
          }
        ]
      },
      "impact:'remote code execution']": {
        "keyphrase": "'remote code execution']",
        "type": "impact",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 242.94356906525846
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 239.76798634826244
          },
          {
            "metadata": {
              "doc_id": "119",
              "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
              "source": "sparse",
              "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data."
            },
            "similarity": 234.5410219042327
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 233.66704000644066
          },
          {
            "metadata": {
              "doc_id": "122",
              "name": "Heap-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()."
            },
            "similarity": 232.7230450393742
          }
        ]
      },
      "vector:malformed browse-reply packet": {
        "keyphrase": "malformed browse-reply packet",
        "type": "vector",
        "cwes": [
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 240.64047577172917
          },
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 240.35006230940573
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 239.0925368837014
          },
          {
            "metadata": {
              "doc_id": "119",
              "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
              "source": "sparse",
              "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data."
            },
            "similarity": 235.8822027514891
          },
          {
            "metadata": {
              "doc_id": "122",
              "name": "Heap-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()."
            },
            "similarity": 232.89861200564576
          }
        ]
      },
      "attacker:remote attacker": {
        "keyphrase": "remote attacker",
        "type": "attacker",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 244.19630193121114
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 241.7729834287584
          },
          {
            "metadata": {
              "doc_id": "119",
              "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
              "source": "sparse",
              "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data."
            },
            "similarity": 235.7918563291222
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 235.59946146418153
          },
          {
            "metadata": {
              "doc_id": "122",
              "name": "Heap-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()."
            },
            "similarity": 234.47610240982016
          }
        ]
      },
      "product:Nintendo Mario Kart 8 Deluxe": {
        "keyphrase": "Nintendo Mario Kart 8 Deluxe",
        "type": "product",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 238.85641439458024
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 236.0539093632182
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 231.3624264405046
          },
          {
            "metadata": {
              "doc_id": "119",
              "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
              "source": "sparse",
              "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data."
            },
            "similarity": 229.27671152794375
          },
          {
            "metadata": {
              "doc_id": "122",
              "name": "Heap-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()."
            },
            "similarity": 228.93802682851094
          }
        ]
      },
      "version:before 3.0.3": {
        "keyphrase": "before 3.0.3",
        "type": "version",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 245.608789968327
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 241.47042700991935
          },
          {
            "metadata": {
              "doc_id": "119",
              "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
              "source": "sparse",
              "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data."
            },
            "similarity": 236.5570853532363
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 236.21642610557038
          },
          {
            "metadata": {
              "doc_id": "122",
              "name": "Heap-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()."
            },
            "similarity": 234.40722707966177
          }
        ]
      },
      "component:LAN/LDN local multiplayer implementation": {
        "keyphrase": "LAN/LDN local multiplayer implementation",
        "type": "component",
        "cwes": [
          {
            "metadata": {
              "doc_id": "121",
              "name": "Stack-based Buffer Overflow",
              "source": "sparse",
              "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)."
            },
            "similarity": 239.5912321931472
          },
          {
            "metadata": {
              "doc_id": "20",
              "name": "Improper Input Validation",
              "source": "sparse",
              "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly."
            },
            "similarity": 239.2908487167742
          },
          {
            "metadata": {
              "doc_id": "119",
              "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
              "source": "sparse",
              "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data."
            },
            "similarity": 234.92411702340627
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties."
            },
            "similarity": 234.5455711754934
          },
          {
            "metadata": {
              "doc_id": "303",
              "name": "Incorrect Implementation of Authentication Algorithm",
              "source": "sparse",
              "original_content": "The requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.",
              "keyphrase_sources": [
                {
                  "id": "component:LAN/LDN local multiplayer implementation",
                  "keyphrase": "LAN/LDN local multiplayer implementation",
                  "type": "component"
                }
              ]
            },
            "similarity": 233.4511869085366
          }
        ]
      }
    },
    "keyphrase_mapping": {
      "121": [
        {
          "id": "rootcause:incorrect use of the Nintendo Pia library",
          "keyphrase": "incorrect use of the Nintendo Pia library",
          "type": "rootcause"
        },
        {
          "id": "weakness:deserialization",
          "keyphrase": "deserialization",
          "type": "weakness"
        },
        {
          "id": "weakness:stack-based buffer overflow",
          "keyphrase": "stack-based buffer overflow",
          "type": "weakness"
        },
        {
          "id": "impact:['obtain complete denial-of-service on the games process'",
          "keyphrase": "['obtain complete denial-of-service on the games process'",
          "type": "impact"
        },
        {
          "id": "impact:'remote code execution']",
          "keyphrase": "'remote code execution']",
          "type": "impact"
        },
        {
          "id": "vector:malformed browse-reply packet",
          "keyphrase": "malformed browse-reply packet",
          "type": "vector"
        },
        {
          "id": "attacker:remote attacker",
          "keyphrase": "remote attacker",
          "type": "attacker"
        },
        {
          "id": "product:Nintendo Mario Kart 8 Deluxe",
          "keyphrase": "Nintendo Mario Kart 8 Deluxe",
          "type": "product"
        },
        {
          "id": "version:before 3.0.3",
          "keyphrase": "before 3.0.3",
          "type": "version"
        },
        {
          "id": "component:LAN/LDN local multiplayer implementation",
          "keyphrase": "LAN/LDN local multiplayer implementation",
          "type": "component"
        }
      ],
      "20": [
        {
          "id": "rootcause:incorrect use of the Nintendo Pia library",
          "keyphrase": "incorrect use of the Nintendo Pia library",
          "type": "rootcause"
        },
        {
          "id": "weakness:deserialization",
          "keyphrase": "deserialization",
          "type": "weakness"
        },
        {
          "id": "weakness:stack-based buffer overflow",
          "keyphrase": "stack-based buffer overflow",
          "type": "weakness"
        },
        {
          "id": "impact:['obtain complete denial-of-service on the games process'",
          "keyphrase": "['obtain complete denial-of-service on the games process'",
          "type": "impact"
        },
        {
          "id": "impact:'remote code execution']",
          "keyphrase": "'remote code execution']",
          "type": "impact"
        },
        {
          "id": "vector:malformed browse-reply packet",
          "keyphrase": "malformed browse-reply packet",
          "type": "vector"
        },
        {
          "id": "attacker:remote attacker",
          "keyphrase": "remote attacker",
          "type": "attacker"
        },
        {
          "id": "product:Nintendo Mario Kart 8 Deluxe",
          "keyphrase": "Nintendo Mario Kart 8 Deluxe",
          "type": "product"
        },
        {
          "id": "version:before 3.0.3",
          "keyphrase": "before 3.0.3",
          "type": "version"
        },
        {
          "id": "component:LAN/LDN local multiplayer implementation",
          "keyphrase": "LAN/LDN local multiplayer implementation",
          "type": "component"
        }
      ],
      "119": [
        {
          "id": "rootcause:incorrect use of the Nintendo Pia library",
          "keyphrase": "incorrect use of the Nintendo Pia library",
          "type": "rootcause"
        },
        {
          "id": "weakness:deserialization",
          "keyphrase": "deserialization",
          "type": "weakness"
        },
        {
          "id": "impact:'remote code execution']",
          "keyphrase": "'remote code execution']",
          "type": "impact"
        },
        {
          "id": "vector:malformed browse-reply packet",
          "keyphrase": "malformed browse-reply packet",
          "type": "vector"
        },
        {
          "id": "attacker:remote attacker",
          "keyphrase": "remote attacker",
          "type": "attacker"
        },
        {
          "id": "product:Nintendo Mario Kart 8 Deluxe",
          "keyphrase": "Nintendo Mario Kart 8 Deluxe",
          "type": "product"
        },
        {
          "id": "version:before 3.0.3",
          "keyphrase": "before 3.0.3",
          "type": "version"
        },
        {
          "id": "component:LAN/LDN local multiplayer implementation",
          "keyphrase": "LAN/LDN local multiplayer implementation",
          "type": "component"
        }
      ],
      "1284": [
        {
          "id": "rootcause:incorrect use of the Nintendo Pia library",
          "keyphrase": "incorrect use of the Nintendo Pia library",
          "type": "rootcause"
        },
        {
          "id": "weakness:deserialization",
          "keyphrase": "deserialization",
          "type": "weakness"
        },
        {
          "id": "weakness:stack-based buffer overflow",
          "keyphrase": "stack-based buffer overflow",
          "type": "weakness"
        },
        {
          "id": "impact:['obtain complete denial-of-service on the games process'",
          "keyphrase": "['obtain complete denial-of-service on the games process'",
          "type": "impact"
        },
        {
          "id": "impact:'remote code execution']",
          "keyphrase": "'remote code execution']",
          "type": "impact"
        },
        {
          "id": "vector:malformed browse-reply packet",
          "keyphrase": "malformed browse-reply packet",
          "type": "vector"
        },
        {
          "id": "attacker:remote attacker",
          "keyphrase": "remote attacker",
          "type": "attacker"
        },
        {
          "id": "product:Nintendo Mario Kart 8 Deluxe",
          "keyphrase": "Nintendo Mario Kart 8 Deluxe",
          "type": "product"
        },
        {
          "id": "version:before 3.0.3",
          "keyphrase": "before 3.0.3",
          "type": "version"
        },
        {
          "id": "component:LAN/LDN local multiplayer implementation",
          "keyphrase": "LAN/LDN local multiplayer implementation",
          "type": "component"
        }
      ],
      "122": [
        {
          "id": "rootcause:incorrect use of the Nintendo Pia library",
          "keyphrase": "incorrect use of the Nintendo Pia library",
          "type": "rootcause"
        },
        {
          "id": "weakness:stack-based buffer overflow",
          "keyphrase": "stack-based buffer overflow",
          "type": "weakness"
        },
        {
          "id": "impact:'remote code execution']",
          "keyphrase": "'remote code execution']",
          "type": "impact"
        },
        {
          "id": "vector:malformed browse-reply packet",
          "keyphrase": "malformed browse-reply packet",
          "type": "vector"
        },
        {
          "id": "attacker:remote attacker",
          "keyphrase": "remote attacker",
          "type": "attacker"
        },
        {
          "id": "product:Nintendo Mario Kart 8 Deluxe",
          "keyphrase": "Nintendo Mario Kart 8 Deluxe",
          "type": "product"
        },
        {
          "id": "version:before 3.0.3",
          "keyphrase": "before 3.0.3",
          "type": "version"
        }
      ],
      "502": [
        {
          "id": "weakness:deserialization",
          "keyphrase": "deserialization",
          "type": "weakness"
        }
      ],
      "120": [
        {
          "id": "weakness:stack-based buffer overflow",
          "keyphrase": "stack-based buffer overflow",
          "type": "weakness"
        }
      ],
      "290": [
        {
          "id": "impact:['obtain complete denial-of-service on the games process'",
          "keyphrase": "['obtain complete denial-of-service on the games process'",
          "type": "impact"
        }
      ],
      "787": [
        {
          "id": "impact:['obtain complete denial-of-service on the games process'",
          "keyphrase": "['obtain complete denial-of-service on the games process'",
          "type": "impact"
        }
      ],
      "303": [
        {
          "id": "component:LAN/LDN local multiplayer implementation",
          "keyphrase": "LAN/LDN local multiplayer implementation",
          "type": "component"
        }
      ]
    },
    "relevant_cwes": [
      {
        "metadata": {
          "doc_id": "121",
          "name": "Stack-based Buffer Overflow",
          "source": "sparse",
          "original_content": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).",
          "keyphrase_sources": [
            {
              "id": "rootcause:incorrect use of the Nintendo Pia library",
              "keyphrase": "incorrect use of the Nintendo Pia library",
              "type": "rootcause"
            },
            {
              "id": "weakness:deserialization",
              "keyphrase": "deserialization",
              "type": "weakness"
            },
            {
              "id": "weakness:stack-based buffer overflow",
              "keyphrase": "stack-based buffer overflow",
              "type": "weakness"
            },
            {
              "id": "impact:['obtain complete denial-of-service on the games process'",
              "keyphrase": "['obtain complete denial-of-service on the games process'",
              "type": "impact"
            },
            {
              "id": "impact:'remote code execution']",
              "keyphrase": "'remote code execution']",
              "type": "impact"
            },
            {
              "id": "vector:malformed browse-reply packet",
              "keyphrase": "malformed browse-reply packet",
              "type": "vector"
            },
            {
              "id": "attacker:remote attacker",
              "keyphrase": "remote attacker",
              "type": "attacker"
            },
            {
              "id": "product:Nintendo Mario Kart 8 Deluxe",
              "keyphrase": "Nintendo Mario Kart 8 Deluxe",
              "type": "product"
            },
            {
              "id": "version:before 3.0.3",
              "keyphrase": "before 3.0.3",
              "type": "version"
            },
            {
              "id": "component:LAN/LDN local multiplayer implementation",
              "keyphrase": "LAN/LDN local multiplayer implementation",
              "type": "component"
            }
          ]
        },
        "similarity": 761.092288636683
      },
      {
        "metadata": {
          "doc_id": "20",
          "name": "Improper Input Validation",
          "source": "sparse",
          "original_content": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
          "keyphrase_sources": [
            {
              "id": "rootcause:incorrect use of the Nintendo Pia library",
              "keyphrase": "incorrect use of the Nintendo Pia library",
              "type": "rootcause"
            },
            {
              "id": "weakness:deserialization",
              "keyphrase": "deserialization",
              "type": "weakness"
            },
            {
              "id": "weakness:stack-based buffer overflow",
              "keyphrase": "stack-based buffer overflow",
              "type": "weakness"
            },
            {
              "id": "impact:['obtain complete denial-of-service on the games process'",
              "keyphrase": "['obtain complete denial-of-service on the games process'",
              "type": "impact"
            },
            {
              "id": "impact:'remote code execution']",
              "keyphrase": "'remote code execution']",
              "type": "impact"
            },
            {
              "id": "vector:malformed browse-reply packet",
              "keyphrase": "malformed browse-reply packet",
              "type": "vector"
            },
            {
              "id": "attacker:remote attacker",
              "keyphrase": "remote attacker",
              "type": "attacker"
            },
            {
              "id": "product:Nintendo Mario Kart 8 Deluxe",
              "keyphrase": "Nintendo Mario Kart 8 Deluxe",
              "type": "product"
            },
            {
              "id": "version:before 3.0.3",
              "keyphrase": "before 3.0.3",
              "type": "version"
            },
            {
              "id": "component:LAN/LDN local multiplayer implementation",
              "keyphrase": "LAN/LDN local multiplayer implementation",
              "type": "component"
            }
          ]
        },
        "similarity": 754.2824206040526
      },
      {
        "metadata": {
          "doc_id": "119",
          "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
          "source": "sparse",
          "original_content": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
          "keyphrase_sources": [
            {
              "id": "rootcause:incorrect use of the Nintendo Pia library",
              "keyphrase": "incorrect use of the Nintendo Pia library",
              "type": "rootcause"
            },
            {
              "id": "weakness:deserialization",
              "keyphrase": "deserialization",
              "type": "weakness"
            },
            {
              "id": "impact:'remote code execution']",
              "keyphrase": "'remote code execution']",
              "type": "impact"
            },
            {
              "id": "vector:malformed browse-reply packet",
              "keyphrase": "malformed browse-reply packet",
              "type": "vector"
            },
            {
              "id": "attacker:remote attacker",
              "keyphrase": "remote attacker",
              "type": "attacker"
            },
            {
              "id": "product:Nintendo Mario Kart 8 Deluxe",
              "keyphrase": "Nintendo Mario Kart 8 Deluxe",
              "type": "product"
            },
            {
              "id": "version:before 3.0.3",
              "keyphrase": "before 3.0.3",
              "type": "version"
            },
            {
              "id": "component:LAN/LDN local multiplayer implementation",
              "keyphrase": "LAN/LDN local multiplayer implementation",
              "type": "component"
            }
          ]
        },
        "similarity": 744.862368484095
      },
      {
        "metadata": {
          "doc_id": "1284",
          "name": "Improper Validation of Specified Quantity in Input",
          "source": "sparse",
          "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
          "keyphrase_sources": [
            {
              "id": "rootcause:incorrect use of the Nintendo Pia library",
              "keyphrase": "incorrect use of the Nintendo Pia library",
              "type": "rootcause"
            },
            {
              "id": "weakness:deserialization",
              "keyphrase": "deserialization",
              "type": "weakness"
            },
            {
              "id": "weakness:stack-based buffer overflow",
              "keyphrase": "stack-based buffer overflow",
              "type": "weakness"
            },
            {
              "id": "impact:['obtain complete denial-of-service on the games process'",
              "keyphrase": "['obtain complete denial-of-service on the games process'",
              "type": "impact"
            },
            {
              "id": "impact:'remote code execution']",
              "keyphrase": "'remote code execution']",
              "type": "impact"
            },
            {
              "id": "vector:malformed browse-reply packet",
              "keyphrase": "malformed browse-reply packet",
              "type": "vector"
            },
            {
              "id": "attacker:remote attacker",
              "keyphrase": "remote attacker",
              "type": "attacker"
            },
            {
              "id": "product:Nintendo Mario Kart 8 Deluxe",
              "keyphrase": "Nintendo Mario Kart 8 Deluxe",
              "type": "product"
            },
            {
              "id": "version:before 3.0.3",
              "keyphrase": "before 3.0.3",
              "type": "version"
            },
            {
              "id": "component:LAN/LDN local multiplayer implementation",
              "keyphrase": "LAN/LDN local multiplayer implementation",
              "type": "component"
            }
          ]
        },
        "similarity": 737.9183240445844
      },
      {
        "metadata": {
          "doc_id": "122",
          "name": "Heap-based Buffer Overflow",
          "source": "sparse",
          "original_content": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().",
          "keyphrase_sources": [
            {
              "id": "rootcause:incorrect use of the Nintendo Pia library",
              "keyphrase": "incorrect use of the Nintendo Pia library",
              "type": "rootcause"
            },
            {
              "id": "weakness:stack-based buffer overflow",
              "keyphrase": "stack-based buffer overflow",
              "type": "weakness"
            },
            {
              "id": "impact:'remote code execution']",
              "keyphrase": "'remote code execution']",
              "type": "impact"
            },
            {
              "id": "vector:malformed browse-reply packet",
              "keyphrase": "malformed browse-reply packet",
              "type": "vector"
            },
            {
              "id": "attacker:remote attacker",
              "keyphrase": "remote attacker",
              "type": "attacker"
            },
            {
              "id": "product:Nintendo Mario Kart 8 Deluxe",
              "keyphrase": "Nintendo Mario Kart 8 Deluxe",
              "type": "product"
            },
            {
              "id": "version:before 3.0.3",
              "keyphrase": "before 3.0.3",
              "type": "version"
            }
          ]
        },
        "similarity": 734.0618008758673
      },
      {
        "metadata": {
          "doc_id": "120",
          "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
          "source": "sparse",
          "original_content": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
          "keyphrase_sources": [
            {
              "id": "weakness:stack-based buffer overflow",
              "keyphrase": "stack-based buffer overflow",
              "type": "weakness"
            }
          ]
        },
        "similarity": 701.176993226718
      },
      {
        "metadata": {
          "doc_id": "502",
          "name": "Deserialization of Untrusted Data",
          "source": "sparse",
          "original_content": "The product deserializes untrusted data without sufficiently ensuring that the resulting data will be valid.",
          "keyphrase_sources": [
            {
              "id": "weakness:deserialization",
              "keyphrase": "deserialization",
              "type": "weakness"
            }
          ]
        },
        "similarity": 655.6304416313677
      },
      {
        "metadata": {
          "doc_id": "290",
          "name": "Authentication Bypass by Spoofing",
          "source": "sparse",
          "original_content": "This attack-focused weakness is caused by incorrectly implemented authentication schemes that are subject to spoofing attacks.",
          "keyphrase_sources": [
            {
              "id": "impact:['obtain complete denial-of-service on the games process'",
              "keyphrase": "['obtain complete denial-of-service on the games process'",
              "type": "impact"
            }
          ]
        },
        "similarity": 261.5185832500627
      },
      {
        "metadata": {
          "doc_id": "787",
          "name": "Out-of-bounds Write",
          "source": "sparse",
          "original_content": "The product writes data past the end, or before the beginning, of the intended buffer.",
          "keyphrase_sources": [
            {
              "id": "impact:['obtain complete denial-of-service on the games process'",
              "keyphrase": "['obtain complete denial-of-service on the games process'",
              "type": "impact"
            }
          ]
        },
        "similarity": 258.60002869042836
      },
      {
        "metadata": {
          "doc_id": "303",
          "name": "Incorrect Implementation of Authentication Algorithm",
          "source": "sparse",
          "original_content": "The requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect.",
          "keyphrase_sources": [
            {
              "id": "component:LAN/LDN local multiplayer implementation",
              "keyphrase": "LAN/LDN local multiplayer implementation",
              "type": "component"
            }
          ]
        },
        "similarity": 233.4511869085366
      }
    ],
    "enhanced_query": "# Vulnerability Description\n\n    In Nintendo Mario Kart 8 Deluxe before 3.0.3, the LAN/LDN local multiplayer implementation allows a remote attacker to exploit a **stack-based buffer overflow** upon **deserialization** of session information via a malformed browse-reply packet, aka KartLANPwn. The victim is not required to join a game session with an attacker. The victim must open the Wireless Play (or LAN Play) menu from the games title screen, and an attacker nearby (LDN) or on the same LAN network as the victim can send a crafted reply packet to the victims console. This enables a remote attacker to obtain complete denial-of-service on the games process, or potentially, remote code execution on the victims console. The issue is caused by **incorrect use of the Nintendo Pia library**,\n\n    # Keyphrase-Specific CWE Analysis\n    This vulnerability contains multiple keyphrases that may map to different CWEs. \n    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.\n\n    ## ROOTCAUSE: 'incorrect use of the Nintendo Pia library'\n\nRelevant CWEs for this ROOTCAUSE:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer (Score: 744.86)\n\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data....\n\n### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 5. CWE-122: Heap-based Buffer Overflow (Score: 734.06)\n\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....\n\n## WEAKNESS: 'deserialization'\n\nRelevant CWEs for this WEAKNESS:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer (Score: 744.86)\n\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data....\n\n### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 5. CWE-502: Deserialization of Untrusted Data (Score: 655.63)\n\nThe product deserializes untrusted data without sufficiently ensuring that the resulting data will be valid....\n\n## WEAKNESS: 'stack-based buffer overflow'\n\nRelevant CWEs for this WEAKNESS:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 4. CWE-122: Heap-based Buffer Overflow (Score: 734.06)\n\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....\n\n### 5. CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') (Score: 701.18)\n\nThe product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow....\n\n## IMPACT: '['obtain complete denial-of-service on the games process''\n\nRelevant CWEs for this IMPACT:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 4. CWE-290: Authentication Bypass by Spoofing (Score: 261.52)\n\nThis attack-focused weakness is caused by incorrectly implemented authentication schemes that are subject to spoofing attacks....\n\n### 5. CWE-787: Out-of-bounds Write (Score: 258.60)\n\nThe product writes data past the end, or before the beginning, of the intended buffer....\n\n## IMPACT: ''remote code execution']'\n\nRelevant CWEs for this IMPACT:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer (Score: 744.86)\n\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data....\n\n### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 5. CWE-122: Heap-based Buffer Overflow (Score: 734.06)\n\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....\n\n## VECTOR: 'malformed browse-reply packet'\n\nRelevant CWEs for this VECTOR:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer (Score: 744.86)\n\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data....\n\n### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 5. CWE-122: Heap-based Buffer Overflow (Score: 734.06)\n\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....\n\n## ATTACKER: 'remote attacker'\n\nRelevant CWEs for this ATTACKER:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer (Score: 744.86)\n\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data....\n\n### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 5. CWE-122: Heap-based Buffer Overflow (Score: 734.06)\n\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....\n\n## PRODUCT: 'Nintendo Mario Kart 8 Deluxe'\n\nRelevant CWEs for this PRODUCT:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer (Score: 744.86)\n\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data....\n\n### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 5. CWE-122: Heap-based Buffer Overflow (Score: 734.06)\n\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....\n\n## VERSION: 'before 3.0.3'\n\nRelevant CWEs for this VERSION:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer (Score: 744.86)\n\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data....\n\n### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 5. CWE-122: Heap-based Buffer Overflow (Score: 734.06)\n\nA heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc()....\n\n## COMPONENT: 'LAN/LDN local multiplayer implementation'\n\nRelevant CWEs for this COMPONENT:\n\n### 1. CWE-121: Stack-based Buffer Overflow (Score: 761.09)\n\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....\n\n### 2. CWE-20: Improper Input Validation (Score: 754.28)\n\nThe product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly....\n\n### 3. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer (Score: 744.86)\n\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data....\n\n### 4. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 737.92)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n### 5. CWE-303: Incorrect Implementation of Authentication Algorithm (Score: 233.45)\n\nThe requirements for the product dictate the use of an established authentication algorithm, but the implementation of the algorithm is incorrect....\n\n\n    # Analysis Instructions\n    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.\n    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.\n    3. Provide a final determination of primary CWE(s) and any secondary CWEs.\n    4. Format your response using the standard analysis template.\n\n    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.\n    "
  },
  "retrieval_time": 2.289743661880493
}