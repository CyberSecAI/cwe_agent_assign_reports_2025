## Vulnerability Description
KubePi is a K8s panel. Starting in version 1.6.3 and prior to version 1.8.0, there is a defect in the KubePi JWT token verification. The JWT key in the default configuration file is empty. Although a random 32-bit string will be generated to overwrite the key in the configuration file when the key is detected to be empty in the configuration file reading logic, the key is empty during actual verification. Using an empty key to generate a JWT token can bypass the login verification and directly take over the back end. Version 1.8.0 contains a patch for this issue.

### Vulnerability Description Key Phrases
- **rootcause:** **empty JWT key in default configuration file**
- **impact:** bypass login verification
- **product:** KubePi
- **version:** 1.6.3 to 1.7.9
- **component:** JWT token verification

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The application's JWT token validation logic has a defect. Although a random 32-character string is generated and written to the configuration file as a JWT secret key when the key is empty, the actual JWT verification process uses the initial empty string key from the configuration file instead of the generated key.
- **Weaknesses/vulnerabilities present**:
    - JWT token verification bypass due to usage of empty key.
    - Inconsistent use of JWT key generation and verification.
    - Default empty JWT key in configuration file.
- **Impact of exploitation**: An attacker can bypass login authentication by generating a JWT token with an empty secret key, granting them full control of the backend. This allows for creating users and gaining unauthorized access.
- **Attack vectors**: Network-based attack.
- **Required attacker capabilities/position**: The attacker needs the ability to send HTTP requests to the vulnerable server.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.724 |
| 2 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.721 |
| 3 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.673 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.673 |
| 5 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.659 |
| 6 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.658 |
| 7 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.654 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.639 |
| 9 | 1394 | Use of Default Cryptographic Key | Base | Allowed | dense | 0.392 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-287: Improper Authentication

CWE-347: Improper Verification of Cryptographic Signature

CWE-345: Insufficient Verification of Data Authenticity

CWE-1390: Weak Authentication

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-1391: Use of Weak Credentials

CWE-321: Use of Hard-coded Cryptographic Key

CWE-863: Incorrect Authorization

CWE-1394: Use of Default Cryptographic Key

CWE-613: Insufficient Session Expiration