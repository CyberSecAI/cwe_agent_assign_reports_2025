# Vulnerability Information: CVE-2024-2544

## Vulnerability Description
The Popup Builder plugin for WordPress is vulnerable to unauthorized modification of data and loss of data due to a **missing capability check** on all AJAX actions. This makes it possible for authenticated attackers, with subscriber-level access and above, to perform multiple unauthorized actions, such as deleting subscribers, and importing subscribers to conduct stored **cross-site scripting** attacks.

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **weakness:** **cross-site scripting**
- **impact:** stored cross-site scripting attacks and unauthorized modification of data and loss of data
- **vector:** deleting subscribers and importing subscribers
- **attacker:** authenticated attackers with subscriber-level access and above
- **product:** Popup Builder plugin for WordPress
- **component:** all AJAX actions

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-2544:

**Root Cause of Vulnerability:**

The root cause is a missing authorization check in multiple AJAX actions within the Popup Builder plugin. This allows authenticated users, even those with low-level access (like subscribers), to execute actions that should be restricted to administrators.

**Weaknesses/Vulnerabilities Present:**

*   **Missing Authorization:** The primary vulnerability is the lack of proper capability checks before executing AJAX actions. This allows users without the necessary permissions to perform administrative tasks.
*   **Nonce Exposure**: One of the code changes includes a fix for "Nonce Exposure," however the details of this are not provided in the context.
*   **Insecure Data Handling:** There's mention of importing subscribers which could lead to stored cross-site scripting (XSS) attacks, however it is not detailed in the context.

**Impact of Exploitation:**

*   **Unauthorized Data Modification:** Attackers can modify data within the plugin, such as deleting subscribers.
*   **Data Loss:** The ability to delete subscribers leads to data loss.
*  **Stored Cross-Site Scripting (XSS):** Attackers can import malicious data (e.g., through subscriber import) that can be used to execute XSS attacks on other users, potentially leading to further compromise.
*  **Privilege Escalation**: While not explicit, the ability to perform actions meant for administrators can be a form of privilege escalation as it can be exploited by lower level users, particularly when they are intended only to be accessible by higher-level roles.

**Attack Vectors:**

*   **AJAX Requests:** The vulnerability is exploited through crafted AJAX requests to the vulnerable endpoints.
*   **Authentication Required:** An attacker must have an authenticated account on the WordPress site, but it doesn't require administrative privileges. Subscriber level access is enough.

**Required Attacker Capabilities/Position:**

*   **WordPress Account:** The attacker needs a valid user account on the target WordPress site (subscriber level or higher).
*   **Network Access:** The attacker needs to be able to send HTTP requests to the WordPress site.
*  **Basic Technical Skills:** The attacker needs some knowledge of how WordPress AJAX works.

**Additional Details:**

*   The provided code diffs show the addition of `current_user_can('manage_options')` checks to various AJAX actions within `com/classes/Ajax.php` and `com/classes/Updates.php`. This change restricts these actions to users with the 'manage_options' capability (administrators).
*  The changes to `com/classes/Actions.php` and `com/classes/popups/SGPopup.php` indicate that data is now filtered for specific keys, instead of using all `$_POST` data, this may be related to another vulnerability, but is not specified as such in the provided context.

* The `readme.txt` and config files show that version 4.3.2 addresses the vulnerability, along with a conflict with the WordPress menu settings.

In summary, CVE-2024-2544 is a critical vulnerability due to missing authorization checks in the Popup Builder plugin. It allows authenticated, low-privileged users to perform administrative actions, leading to data modification, data loss, and the potential for further attacks. The patch involves adding capability checks to various AJAX actions, and this is confirmed by analyzing code diffs in the provided text.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.502 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.466 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.383 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.376 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.371 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.371 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.353 |
| 8 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.340 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.449 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

