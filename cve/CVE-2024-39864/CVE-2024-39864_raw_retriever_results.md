# Raw Retriever Results for CVE-2024-39864

# Raw Retriever Results for CVE-2024-39864
## Query
The CloudStack integration API service allows running its unauthenticated API server (usually on port 8096 when configured and enabled via integration.api.port global setting) for internal portal integrations and for testing purposes. By default, the integration API service port is disabled and is considered disabled when integration.api.port is set to 0 or negative. Due to an improper initialisation logic, the integration API service would listen on a random port when its port value is set to 0 (default value). An attacker that can access the CloudStack management network could scan and find the randomised integration API service port and exploit it to perform unauthorised administrative actions and perform remote code execution on CloudStack managed hosts and result in complete compromise of the confidentiality, integrity, and availability of CloudStack managed infrastructure. Users are recommended to restrict the network access on the CloudStack management server hosts to only essential ports. Users are recommended to upgrade to version 4.18.2.1, 4.19.0.2 or later, which addresses this issue.

## Keyphrases
- **rootcause**: 'improper initialisation logic'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3257 | 0.4138 | 0.3485 | 0.3441 | 20 |
| Sparse | 886.6147 | 1042.7920 | 929.0274 | 917.7178 | 10 |
| Graph | 1.2880 | 2.3998 | 1.6594 | 1.5982 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 918 | Server-Side Request Forgery (SSRF) | base | 2.3998 | Allowed |
| 2 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 3 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 4 | 611 | Improper Restriction of XML External Entity Reference | base | 2.1190 | Allowed |
| 5 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.7731 | Allowed |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 8 | 306 | Missing Authentication for Critical Function | Base | 1.6439 | Allowed |
| 9 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 10 | 425 | Direct Request ('Forced Browsing') | base | 1.6052 | Allowed |
| 11 | 322 | Key Exchange without Entity Authentication | base | 1.5912 | Allowed |
| 12 | 1327 | Binding to an Unrestricted IP Address | Base | 1.5762 | Allowed |
| 13 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | base | 1.5210 | Allowed |
| 14 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 1.4285 | Allowed |
| 15 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.3747 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1327 | Binding to an Unrestricted IP Address | Base | 0.4138 | 0.4138 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | Base | 0.3693 | 0.3693 | Allowed |
| 3 | 862 | Missing Authorization | Class | 0.3663 | 0.3663 | Allowed-with-Review |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.3646 | 0.3646 | Allowed |
| 5 | 284 | Improper Access Control | Pillar | 0.3627 | 0.3627 | Discouraged |
| 6 | 269 | Improper Privilege Management | Class | 0.3614 | 0.3614 | Discouraged |
| 7 | 400 | Uncontrolled Resource Consumption | Class | 0.3576 | 0.3576 | Discouraged |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.3555 | 0.3555 | Allowed |
| 9 | 287 | Improper Authentication | Class | 0.3535 | 0.3535 | Discouraged |
| 10 | 291 | Reliance on IP Address for Authentication | Variant | 0.3531 | 0.3531 | Allowed |
| 11 | 863 | Incorrect Authorization | Class | 0.3350 | 0.3350 | Allowed-with-Review |
| 12 | 285 | Improper Authorization | Class | 0.3346 | 0.3346 | Discouraged |
| 13 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 0.3325 | 0.3325 | Allowed |
| 14 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.3314 | 0.3314 | Allowed |
| 15 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.3309 | 0.3309 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 611 | Improper Restriction of XML External Entity Reference | 1042.7920 | 1042.7920 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | 963.2141 | 963.2141 | Allowed |
| 3 | 918 | Server-Side Request Forgery (SSRF) | 944.6219 | 944.6219 | Allowed |
| 4 | 863 | Incorrect Authorization | 924.1019 | 924.1019 | Allowed-with-Review |
| 5 | 287 | Improper Authentication | 920.3721 | 920.3721 | Discouraged |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 915.0635 | 915.0635 | Allowed-with-Review |
| 7 | 522 | Insufficiently Protected Credentials | 913.0658 | 913.0658 | Allowed-with-Review |
| 8 | 346 | Origin Validation Error | 890.4198 | 890.4198 | Allowed-with-Review |
| 9 | 285 | Improper Authorization | 890.0083 | 890.0083 | Discouraged |
| 10 | 269 | Improper Privilege Management | 886.6147 | 886.6147 | Discouraged |
