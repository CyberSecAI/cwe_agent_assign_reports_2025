{
  "query": "A command for refining a collection shard key is missing an authorization check. This may cause the command to run directly on a shard, leading to either degradation of query performance, or to revealing chunk boundaries through timing side channels. This affects MongoDB Server v5.0 versions, prior to 5.0.22, MongoDB Server v6.0 versions, prior to 6.0.11 and MongoDB Server v7.0 versions prior to 7.0.3.",
  "keyphrases": {
    "rootcause": [
      "missing authorization check"
    ]
  },
  "timestamp": "2025-07-14T01:34:10.601104",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "295",
        "name": "Improper Certificate Validation",
        "abstraction": "base",
        "score": 2.6104000000000003,
        "description": "CWE-295: Improper Certificate Validation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "base",
        "score": 2.4699999999999998,
        "description": "CWE-639: Authorization Bypass Through User-Controlled Key...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "base",
        "score": 2.3295999999999997,
        "description": "CWE-306: Missing Authentication for Critical Function...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "551",
        "name": "Incorrect Behavior Order: Authorization Before Parsing and Canonicalization",
        "abstraction": "Base",
        "score": 1.6214726435292857,
        "description": "If a web server does not fully parse requested URLs before it examines them for authorization, it may be possible for an attacker to bypass authorization protection....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 1.5979924955621987,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "322",
        "name": "Key Exchange without Entity Authentication",
        "abstraction": "Base",
        "score": 1.5437592064401229,
        "description": "The product performs a key exchange with an actor without verifying the identity of that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "566",
        "name": "Authorization Bypass Through User-Controlled SQL Primary Key",
        "abstraction": "Variant",
        "score": 1.4823997231745019,
        "description": "The product uses a database table that includes records that should not be accessible to an actor, but it executes a SQL statement with a primary key that can be controlled by that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "408",
        "name": "Incorrect Behavior Order: Early Amplification",
        "abstraction": "Base",
        "score": 1.4520390581041336,
        "description": "The product allows an entity to perform a legitimate but expensive operation before authentication or authorization has taken place....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "269",
        "name": "Improper Privilege Management",
        "abstraction": "class",
        "score": 1.4080000000000001,
        "description": "CWE-269: Improper Privilege Management...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "1191",
        "name": "On-Chip Debug and Test Interface With Improper Access Control",
        "abstraction": "base",
        "score": 1.3104,
        "description": "CWE-1191: On-Chip Debug and Test Interface With Improper Access Control...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "266",
        "name": "Incorrect Privilege Assignment",
        "abstraction": "base",
        "score": 1.3104,
        "description": "CWE-266: Incorrect Privilege Assignment...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "941",
        "name": "Incorrectly Specified Destination in a Communication Channel",
        "abstraction": "base",
        "score": 1.2261600000000001,
        "description": "CWE-941: Incorrectly Specified Destination in a Communication Channel...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "420",
        "name": "Unprotected Alternate Channel",
        "abstraction": "base",
        "score": 1.1793600000000002,
        "description": "CWE-420: Unprotected Alternate Channel...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "284",
        "name": "Improper Access Control",
        "abstraction": "pillar",
        "score": 1.056,
        "description": "CWE-284: Improper Access Control...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "422",
        "name": "Unprotected Windows Messaging Channel ('Shatter')",
        "abstraction": "Variant",
        "score": 1.0158933344136083,
        "description": "The product does not properly verify the source of a message in the Windows Messaging System while running at elevated privileges, creating an alternate channel through which an attacker can directly ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1314",
        "name": "Missing Write Protection for Parametric Data Values",
        "abstraction": "base",
        "score": 1.0155600000000002,
        "description": "CWE-1314: Missing Write Protection for Parametric Data Values...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1299",
        "name": "Missing Protection Mechanism for Alternate Hardware Interface",
        "abstraction": "base",
        "score": 1.0155600000000002,
        "description": "CWE-1299: Missing Protection Mechanism for Alternate Hardware Interface...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1274",
        "name": "Improper Access Control for Volatile Memory Containing Boot Code",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1274: Improper Access Control for Volatile Memory Containing Boot Code...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "749",
        "name": "Exposed Dangerous Method or Function",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-749: Exposed Dangerous Method or Function...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "288",
        "name": "Authentication Bypass Using an Alternate Path or Channel",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-288: Authentication Bypass Using an Alternate Path or Channel...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 0.42749351215503273,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "566",
        "name": "Authorization Bypass Through User-Controlled SQL Primary Key",
        "abstraction": "Variant",
        "score": 0.39925971888340017,
        "description": "The product uses a database table that includes records that should not be accessible to an actor, but it executes a SQL statement with a primary key that can be controlled by that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "551",
        "name": "Incorrect Behavior Order: Authorization Before Parsing and Canonicalization",
        "abstraction": "Base",
        "score": 0.37988988273975854,
        "description": "If a web server does not fully parse requested URLs before it examines them for authorization, it may be possible for an attacker to bypass authorization protection....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "408",
        "name": "Incorrect Behavior Order: Early Amplification",
        "abstraction": "Base",
        "score": 0.37438876892243345,
        "description": "The product allows an entity to perform a legitimate but expensive operation before authentication or authorization has taken place....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "422",
        "name": "Unprotected Windows Messaging Channel ('Shatter')",
        "abstraction": "Variant",
        "score": 0.36950328081987943,
        "description": "The product does not properly verify the source of a message in the Windows Messaging System while running at elevated privileges, creating an alternate channel through which an attacker can directly ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "281",
        "name": "Improper Preservation of Permissions",
        "abstraction": "Base",
        "score": 0.36751634544692524,
        "description": "The product does not preserve permissions or incorrectly preserves permissions when copying, restoring, or sharing objects, which can cause them to have less restrictive permissions than intended....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "272",
        "name": "Least Privilege Violation",
        "abstraction": "Base",
        "score": 0.3674614877701462,
        "description": "The elevated privilege level required to perform operations such as chroot() should be dropped immediately after the operation is performed....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "943",
        "name": "Improper Neutralization of Special Elements in Data Query Logic",
        "abstraction": "Class",
        "score": 0.3660521259152429,
        "description": "The product generates a query intended to access or manipulate data in a data store such as a database, but it does not neutralize or incorrectly neutralizes special elements that can modify the inten...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1067",
        "name": "Excessive Execution of Sequential Searches of Data Resource",
        "abstraction": "Base",
        "score": 0.36601853914189686,
        "description": "The product contains a data query against an SQL table or view\n\t\t\t\t\tthat is configured in a way that does not utilize an index and may cause\n\t\t\t\t\tsequential searches to be performed....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "268",
        "name": "Privilege Chaining",
        "abstraction": "Base",
        "score": 0.3658023471069127,
        "description": "Two distinct privileges, roles, capabilities, or rights can be combined in a way that allows an entity to perform unsafe actions that would not be allowed without that combination....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "370",
        "name": "Missing Check for Certificate Revocation after Initial Check",
        "abstraction": "Variant",
        "score": 0.34991337000989525,
        "description": "The product does not check the revocation status of a certificate after its initial revocation check, which can cause the product to perform privileged actions even after the certificate is revoked at...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "689",
        "name": "Permission Race Condition During Resource Copy",
        "abstraction": "Compound",
        "score": 0.34347550337412575,
        "description": "The product, while copying or cloning a resource, does not set the resource's permissions or access control until the copy is complete, leaving the resource exposed to other spheres while the copy is ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "279",
        "name": "Incorrect Execution-Assigned Permissions",
        "abstraction": "Variant",
        "score": 0.3421263474374424,
        "description": "While it is executing, the product sets the permissions of an object in a way that violates the intended permissions that have been specified by the user....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "214",
        "name": "Invocation of Process Using Visible Sensitive Information",
        "abstraction": "Base",
        "score": 0.3420231874450395,
        "description": "A process is invoked with sensitive command-line arguments, environment variables, or other elements that can be seen by other processes on the operating system....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "841",
        "name": "Improper Enforcement of Behavioral Workflow",
        "abstraction": "Base",
        "score": 0.34148030336570934,
        "description": "The product supports a session in which more than one behavior must be performed by an actor, but it does not properly ensure that the actor performs the behaviors in the required sequence....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "414",
        "name": "Missing Lock Check",
        "abstraction": "Base",
        "score": 0.34004148742336415,
        "description": "A product does not check to see if a lock is present before performing sensitive operations on a resource....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "638",
        "name": "Not Using Complete Mediation",
        "abstraction": "Class",
        "score": 0.3397845302698869,
        "description": "The product does not perform access checks on a resource every time the resource is accessed by an entity, which can create resultant weaknesses if that entity's rights or privileges change over time....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1296",
        "name": "Incorrect Chaining or Granularity of Debug Components",
        "abstraction": "Base",
        "score": 0.33897417749276293,
        "description": "The product's debug components contain incorrect chaining or granularity of debug components....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 0.338689058015999,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "666",
        "name": "Operation on Resource in Wrong Phase of Lifetime",
        "abstraction": "Class",
        "score": 0.3386581611211163,
        "description": "The product performs an operation on a resource at the wrong phase of the resource's lifecycle, which can lead to unexpected behaviors....",
        "mapping_usage": "Discouraged"
      }
    ],
    "sparse": [
      {
        "cwe_id": "284",
        "name": "Improper Access Control",
        "abstraction": "Pillar",
        "score": 800.0,
        "description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "295",
        "name": "Improper Certificate Validation",
        "abstraction": "Base",
        "score": 393.25201686657846,
        "description": "The product does not validate, or incorrectly validates, a certificate....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 388.40080537385325,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 385.1608997523603,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "269",
        "name": "Improper Privilege Management",
        "abstraction": "Class",
        "score": 385.13072742791127,
        "description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 385.04603877573834,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "755",
        "name": "Improper Handling of Exceptional Conditions",
        "abstraction": "Class",
        "score": 371.38085081210886,
        "description": "The product does not handle or incorrectly handles an exceptional condition....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "862",
        "name": "Missing Authorization",
        "abstraction": "Class",
        "score": 370.95924139571275,
        "description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "20",
        "name": "Improper Input Validation",
        "abstraction": "Class",
        "score": 370.3233050351606,
        "description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correct...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 367.88136355968294,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "94",
        "name": "Improper Control of Generation of Code ('Code Injection')",
        "abstraction": "Base",
        "score": 365.62484784542994,
        "description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could mod...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "abstraction": "Class",
        "score": 120.01009005468823,
        "description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "790",
        "name": "Improper Filtering of Special Elements",
        "abstraction": "Class",
        "score": 119.39888801955986,
        "description": "The product receives data from an upstream component, but does not filter or incorrectly filters special elements before sending it to a downstream component....",
        "mapping_usage": "Allowed-with-Review"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.3386581611211163,
      "max": 0.42749351215503273,
      "mean": 0.3599276067428484,
      "median": 0.35785785855840396,
      "count": 20
    },
    "sparse": {
      "min": 119.39888801955986,
      "max": 800.0,
      "mean": 370.9668519168296,
      "median": 371.38085081210886,
      "count": 13
    },
    "graph": {
      "min": 1.0062,
      "max": 2.6104000000000003,
      "mean": 1.4331798230611925,
      "median": 1.3104,
      "count": 20
    }
  }
}