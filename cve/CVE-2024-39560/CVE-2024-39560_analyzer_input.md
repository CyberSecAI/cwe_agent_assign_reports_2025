# Vulnerability Information: CVE-2024-39560

## Vulnerability Description
An **Improper Handling of Exceptional Conditions** vulnerability in the routing protocol daemon (rpd) of Juniper Networks Junos OS and Junos OS Evolved allows a logically adjacent downstream RSVP neighbor to cause kernel memory exhaustion, leading to a kernel crash, resulting in a Denial of Service (DoS). The kernel **memory leak** and eventual crash will be seen when the downstream RSVP neighbor has a persistent error which will not be corrected. System kernel memory can be monitored through the use of the show system statistics kernel memory command as shown below user@router> show system statistics kernel memory Memory Size (kB) Percentage When Active 753092 18.4% Now Inactive 574300 14.0% Now Wired 443236 10.8% Now Cached 1911204 46.6% Now Buf 32768 0.8% Now Free 385072 9.4% Now Kernel Memory Now Data 312908 7.6% Now Text 2560 0.1% Now ... This issue affects Junos OS * All versions before 20.4R3-S9, * All versions of 21.2, * from 21.4 before 21.4R3-S5, * from 22.1 before 22.1R3-S5, * from 22.2 before 22.2R3-S3, * from 22.3 before 22.3R3-S2, * from 22.4 before 22.4R3, * from 23.2 before 23.2R2 Junos OS Evolved * All versions before 21.4R3-S5-EVO, * from 22.1-EVO before 22.1R3-S5-EV

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Handling of Exceptional Conditions**
- **weakness:** **memory leak**
- **impact:** Denial of Service and kernel memory exhaustion and leading to a kernel crash
- **vector:** persistent error which will not be corrected
- **attacker:** logically adjacent downstream RSVP neighbor
- **product:** Juniper Networks Junos OS and Junos OS Evolved
- **version:** ['Junos OS All versions before 20.4R3-S9' and 'All versions of 21.2' and 'from 21.4 before 21.4R3-S5' and 'from 22.1 before 22.1R3-S5' and 'from 22.2 before 22.2R3-S3' and 'from 22.3 before 22.3R3-S2' and 'from 22.4 before 22.4R3' and 'from 23.2 before 23.2R2' and 'Junos OS Evolved All versions before 21.4R3-S5-EVO' and 'from 22.1-EVO before 22.1R3-S5-EV']
- **component:** routing protocol daemon (rpd)

## CVE Reference Links Content Summary
UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 1.362 |
| 3 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 1.260 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 1.234 |
| 5 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 1.218 |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 1.174 |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | sparse | 1.173 |
| 8 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | Allowed | sparse | 1.164 |
| 9 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | dense | 0.588 |
| 10 | 390 | Detection of Error Condition Without Action | Base | Allowed | graph | 0.003 |

