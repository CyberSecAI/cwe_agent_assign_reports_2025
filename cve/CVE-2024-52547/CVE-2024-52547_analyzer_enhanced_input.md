## Vulnerability Description
An authenticated attacker can trigger a **stack based buffer overflow** in the DHIP Service (TCP port 80). This vulnerability has been resolved in firmware version 2.800.0000000.8.R.20241111.

### Vulnerability Description Key Phrases
- **weakness:** **stack based buffer overflow**
- **attacker:** authenticated attacker
- **product:** DHIP Service
- **version:** prior to firmware version 2.800.0000000.8.R.20241111

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-52547:

**Root Cause of Vulnerability:**
- Stack-based buffer overflow

**Weaknesses/Vulnerabilities Present:**
- The vulnerability is present in the DHIP service, which listens on TCP port 80.
- An authenticated attacker can trigger a stack-based buffer overflow.

**Impact of Exploitation:**
- Successful exploitation allows an attacker to execute arbitrary code on the target device.
- The attacker can gain full control of the device.
- This vulnerability is a critical component of an exploit chain that leads to remote code execution with root privileges.

**Attack Vectors:**
- The vulnerability is reachable via the network on TCP port 80.
- An attacker must first successfully bypass authentication using other vulnerabilities in the exploit chain, specifically CVE-2024-52544 and CVE-2024-52545.

**Required Attacker Capabilities/Position:**
- The attacker must be authenticated, which requires exploiting other vulnerabilities first to gain valid admin credentials.
- Once authenticated, the attacker can send a specially crafted payload to the DHIP service on TCP port 80 to trigger the buffer overflow.

**Additional Details:**
- This vulnerability is part of a five-vulnerability exploit chain discovered by Rapid7.
- The exploit chain is used to gain remote code execution on the Lorex 2K Indoor Wi-Fi Security Camera.
- The exploit chain involves an initial authentication bypass (CVE-2024-52544, CVE-2024-52545, CVE-2024-52546), followed by this authenticated stack overflow (CVE-2024-52547), and a code signing bypass (CVE-2024-52548).
- The successful exploitation of this vulnerability (CVE-2024-52547), allows for the execution of an OS command with root privileges.
- The device's code signing enforcement can then be bypassed, allowing arbitrary native code execution.

In summary, CVE-2024-52547 is a stack-based buffer overflow vulnerability that, while requiring prior authentication bypass, leads to remote code execution and full device compromise. It is a critical part of a sophisticated exploit chain.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.226 |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.225 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.202 |
| 6 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.188 |
| 7 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.184 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.184 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.567 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-121: Stack-based Buffer Overflow

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-193: Off-by-one Error

CWE-674: Uncontrolled Recursion

CWE-20: Improper Input Validation

CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input

CWE-128: Wrap-around Error