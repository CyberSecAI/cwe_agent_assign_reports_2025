# Vulnerability Information: CVE-2024-8436

## Vulnerability Description
The WP Easy Gallery - WordPress Gallery Plugin plugin for WordPress is vulnerable to SQL Injection via the edit_imageId and edit_imageDelete parameters in all versions up to, and including, 4.8.5 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with subscriber-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers with subscriber-level access and above
- **product:** WP Easy Gallery - WordPress Gallery Plugin
- **version:** up to and including 4.8.5
- **component:** ['edit_imageId' and 'edit_imageDelete parameters']

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Vulnerability:** SQL Injection

**Root Cause:** The vulnerability arises from insufficient sanitization and escaping of user-supplied input within SQL queries. Specifically, the `edit_imageId` and `edit_imageDelete` parameters are not properly handled before being incorporated into database queries.

**Weaknesses:**
*   **Insufficient Input Sanitization:** The plugin fails to properly sanitize and escape user-provided values passed through the `edit_imageId` and `edit_imageDelete` parameters.
*   **Lack of Prepared Statements:** The plugin does not use prepared statements, making it vulnerable to SQL injection. Instead, it directly concatenates user-supplied input into SQL queries.

**Impact of Exploitation:**
*   **Sensitive Data Exposure:** Attackers can inject malicious SQL code to extract sensitive information from the database, potentially including user credentials, configuration details, and other confidential data.
*   **Data Manipulation/Modification:** Attackers could modify or delete data in the database.

**Attack Vectors:**
*   **HTTP Parameters:** The vulnerability is triggered via the `edit_imageId` and `edit_imageDelete` parameters of HTTP requests.

**Required Attacker Capabilities/Position:**
*   **Authenticated Access:** Attackers need to have at least subscriber-level access to the WordPress site to exploit the vulnerability.

**Additional Details:**
*   The vulnerability affects all versions of the WP Easy Gallery plugin up to and including 4.8.5.
*   There is no known patch available as of the provided content.
*   The vulnerability has a CVSS score of 9.9, which is considered critical.
*   The vulnerable code is located within the `wp-easy-gallery.php` file of the plugin.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.602 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.600 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.546 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.533 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.528 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.527 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.523 |
| 9 | 82 | Improper Neutralization of Script in Attributes of IMG Tags in a Web Page | Variant | Allowed | dense | 0.459 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

