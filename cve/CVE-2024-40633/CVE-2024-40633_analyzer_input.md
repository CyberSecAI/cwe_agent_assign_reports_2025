# Vulnerability Information: CVE-2024-40633

## Vulnerability Description
Sylius is an Open Source eCommerce Framework on Symfony. A security vulnerability was discovered in the `/api/v2/shop/adjustments/{id}` endpoint, which retrieves order adjustments based on incremental integer IDs. The vulnerability allows an attacker to enumerate valid adjustment IDs and retrieve order tokens. Using these tokens, an attacker can access guest customer order details - sensitive guest customer information. The issue is fixed in versions 1.12.19, 1.13.4 and above. The `/api/v2/shop/adjustments/{id}` will always return `404` status. Users are advised to upgrade. Users unable to upgrade may alter their config to mitigate this issue. Please see the linked GHSA for details.

### Vulnerability Description Key Phrases
- **impact:** access guest customer order details
- **vector:** incremental integer IDs
- **attacker:** attacker
- **product:** Sylius
- **version:** before 1.12.19, 1.13.4
- **component:** /api/v2/shop/adjustments/{id} endpoint

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The `/api/v2/shop/adjustments/{id}` endpoint in Sylius allows retrieval of order adjustments using an incremental integer ID. This makes it possible for attackers to guess valid IDs.

**Weaknesses/Vulnerabilities Present:**

*   **Information Disclosure:** The endpoint discloses sensitive information, specifically order tokens, associated with adjustments.
*   **Predictable IDs:** The use of incremental integer IDs allows for easy enumeration of valid adjustment IDs.
*  **Lack of proper access control:** The endpoint doesn't restrict access based on user roles.

**Impact of Exploitation:**

*   **Access to Guest Customer Order Details:** By obtaining order tokens, an attacker can access the details of guest customer orders, which can contain sensitive personal information.
*   **Enumeration of valid IDs:** The attacker is able to enumerate all valid adjustments and the related order tokens.

**Attack Vectors:**

*   **Direct API Request:** Attacker sends GET requests to `/api/v2/shop/adjustments/{id}` with incrementing integer values as the `id`.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the application's API endpoint.
*   **No authentication needed:** The attacker doesn't need any authentication to exploit the vulnerability.

**Additional Notes**

* The advisory includes suggested workarounds that can be used if upgrading to the patched version isn't immediately possible.
* The advisory mentions that the fix is to ensure the endpoint always returns a 404 status, preventing access to any adjustment data.
* This is a High severity issue due to the sensitive information that could be exposed.
* The provided CWE is CWE-200 which is information disclosure.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.193 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.188 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.182 |
| 4 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.175 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.173 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.172 |
| 7 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.171 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.166 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.505 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

