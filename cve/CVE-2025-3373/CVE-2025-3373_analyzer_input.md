# Vulnerability Information: CVE-2025-3373

## Vulnerability Description
A vulnerability has been found in PCMan FTP Server 2.0.7 and classified as critical. Affected by this vulnerability is an unknown functionality of the component SITE CHMOD Command Handler. The manipulation leads to **buffer overflow**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** SITE CHMOD Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3373 Content

Based on the provided content, this relates to a vulnerability in PCMan FTP Server.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the `SITE CHMOD` command handling of PCMan FTP Server version 2.0.7. The exploit sends a crafted payload via the `SITE CHMOD` command to overwrite the instruction pointer (EIP).

**Weaknesses/vulnerabilities present:**

*   **Buffer Overflow:** The `SITE CHMOD` command does not properly validate the length of the input, allowing an attacker to write beyond the allocated buffer.
*   **Lack of Input Validation:** Insufficient input validation on the `SITE CHMOD` command.

**Impact of exploitation:**

Successful exploitation allows the attacker to execute arbitrary code on the target system. The provided exploit attempts to gain a reverse shell.

**Attack vectors:**

*   **Remote:** The vulnerability is exploitable remotely via the FTP protocol. An attacker can connect to the FTP server and send the malicious `SITE CHMOD` command.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the target FTP server on port 21.
*   **No Authentication Required:** The exploit uses anonymous FTP credentials, meaning no authentication is required.

**Mitigation or fix:**

The content does not provide information about a specific fix. However, mitigation would involve:

*   **Input Validation:** Implement robust input validation on the `SITE CHMOD` command to prevent buffer overflows.
*   **Buffer Size Limits:** Enforce strict buffer size limits for the `SITE CHMOD` command.
*   **Update:** Upgrade to a patched version of PCMan FTP Server if available.

**Additional Details (More detail than official CVE description):**

*   **Specific Version:** The exploit targets version 2.0.7 of PCMan FTP Server.
*   **Offset:** The exploit uses an offset of 2006 bytes.
*   **EIP overwrite:** The exploit overwrites EIP with `0x74e32fd9` (JMP ESP).
*   **Payload:** The exploit includes a shellcode payload designed to establish a reverse TCP connection to `192.168.176.136` on port 4444.
*   **Bad Characters:** The exploit avoids using null bytes (`\x00`), line feeds (`\x0a`), and carriage returns (`\x0d`).
*   **Tested OS:** The exploit was tested on Windows XP SP3.
*   **Exploit Code:** The content provides a complete Perl exploit script.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.406 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.388 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.338 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.335 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.320 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.559 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

