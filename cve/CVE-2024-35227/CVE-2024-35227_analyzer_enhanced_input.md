## Vulnerability Description
Discourse is an open-source discussion platform. Prior to version 3.2.3 on the `stable` branch and version 3.3.0.beta3 on the `tests-passed` branch, Oneboxing against a carefully crafted malicious URL can reduce the availability of a Discourse instance. The problem has been patched in version 3.2.3 on the `stable` branch and version 3.3.0.beta3 on the `tests-passed` branch. There are no known workarounds available for this vulnerability.

### Vulnerability Description Key Phrases
- **impact:** reduce availability of Discourse instance
- **vector:** Oneboxing against a carefully crafted malicious URL
- **product:** Discourse
- **version:** prior to 3.2.3 on stable branch and 3.3.0.beta3 on tests-passed branch

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-35227.

**Root cause of vulnerability:**
The vulnerability stems from the use of `Object#send` in the `Onebox::Engine::StandardEmbed` class within the Discourse application. The `send` method allows calling any method on an object, including private or protected ones, which can be exploited when processing untrusted data.

**Weaknesses/vulnerabilities present:**
- Unrestricted method invocation: The use of `Object#send` allows an attacker to potentially call arbitrary methods on the `normalizer` object, which can lead to unexpected behavior or denial of service.
- Code injection: While not explicitly mentioned in the provided text, the use of `send` can be a risk factor for code injection if the method names are derived from attacker-controlled input.

**Impact of exploitation:**
- Denial of Service: By crafting a malicious URL that triggers the `Onebox` functionality, an attacker can cause a denial of service by overloading the server or causing it to perform an excessive number of operations.

**Attack vectors:**
- Network: The attack can be performed remotely by sending a malicious URL to a Discourse instance.

**Required attacker capabilities/position:**
- No privileges required: The attacker does not need any special privileges to exploit the vulnerability.
- No user interaction: The attack does not require any user interaction. The attacker only needs to send a crafted URL to the Discourse instance.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | Allowed | sparse | 0.188 |
| 2 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.171 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.162 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.154 |
| 5 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | Allowed | sparse | 0.153 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.146 |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.135 |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.135 |
| 9 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | dense | 0.485 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory

CWE-835: Loop with Unreachable Exit Condition ('Infinite Loop')

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1390: Weak Authentication

CWE-525: Use of Web Browser Cache Containing Sensitive Information

CWE-863: Incorrect Authorization

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-1333: Inefficient Regular Expression Complexity

CWE-226: Sensitive Information in Resource Not Removed Before Reuse