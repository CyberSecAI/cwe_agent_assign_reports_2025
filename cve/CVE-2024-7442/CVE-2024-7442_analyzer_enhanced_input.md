## Vulnerability Description
** UNSUPPORTED WHEN ASSIGNED ** A vulnerability was found in Vivotek SD9364 VVTK-0103f. It has been rated as critical. This issue affects the function getenv of the file upload_file.cgi. The manipulation of the argument QUERY_STRING leads to **command injection**. The attack may be initiated remotely. The associated identifier of this vulnerability is VDB-273527. NOTE This vulnerability only affects products that are no longer supported by the maintainer. NOTE Vendor was contacted early and confirmed that the affected release tree is end-of-life.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Vivotek SD9364
- **version:** VVTK-0103f
- **component:** upload_file.cgi

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The program receives the attacker's GET request through the `getenv` function, obtains the value of the first field through code, and concatenates it into a formatted string using the `snprintf` function. Finally, the `system` function is used to execute the system command.",
  "Weaknesses/vulnerabilities present": [
    "Command Injection: The attacker's input is not filtered before being passed to the `system` function, allowing arbitrary command execution."
  ],
  "Impact of exploitation": "An attacker can execute arbitrary system commands on the vulnerable device.",
  "Attack vectors": "The vulnerability is triggered by sending a crafted GET request to the `upload_file.cgi` endpoint.",
  "Required attacker capabilities/position": "The attacker needs to be able to send HTTP GET requests to the vulnerable device."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.507 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.502 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.417 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.416 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.414 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.412 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.617 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-125: Out-of-bounds Read

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-306: Missing Authentication for Critical Function

CWE-790: Improper Filtering of Special Elements

CWE-184: Incomplete List of Disallowed Inputs