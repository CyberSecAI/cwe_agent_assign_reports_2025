# Vulnerability Information: CVE-2024-51566

## Vulnerability Description
The NVMe driver queue processing is vulernable to guest-induced infinite loops.

### Vulnerability Description Key Phrases
- **rootcause:** **infinite loops in NVMe driver queue processing**
- **vector:** guest-induced
- **attacker:** guest
- **component:** NVMe driver queue processing

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The NVMe driver queue processing in the bhyve hypervisor is vulnerable to guest-induced infinite loops.
- **Weaknesses/vulnerabilities present:** The NVMe driver queue processing logic allows a malicious guest to manipulate the queue in a way that results in an infinite loop within the bhyve process.
- **Impact of exploitation:** A malicious guest can trigger a denial-of-service (DoS) condition on the bhyve host by causing an infinite loop, which can render the host unresponsive.
- **Attack vectors:** The attack vector is a malicious guest VM that utilizes the vulnerable NVMe driver functionality to manipulate the queue.
- **Required attacker capabilities/position:** The attacker needs to have control of a guest VM running on a vulnerable bhyve hypervisor. They need to be able to interact with the NVMe device driver to send commands that will trigger the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.141 |
| 2 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.132 |
| 3 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | sparse | 0.130 |
| 4 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.107 |
| 5 | 703 | Improper Check or Handling of Exceptional Conditions | Pillar | Discouraged | sparse | 0.105 |
| 6 | 460 | Improper Cleanup on Thrown Exception | Base | Allowed | sparse | 0.095 |
| 7 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.095 |
| 8 | 774 | Allocation of File Descriptors or Handles Without Limits or Throttling | Variant | Allowed | sparse | 0.092 |
| 9 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | dense | 0.438 |
| 10 | 476 | NULL Pointer Dereference | Base | Allowed | graph | 0.003 |

