## Vulnerability Description
CORSAIR iCUE 5.9.105 with iCUE Murals on Windows allows unprivileged users to insert DLL files in the cuepkg-1.2.6 subdirectory of the installation directory.

### Vulnerability Description Key Phrases
- **vector:** insert DLL files
- **attacker:** unprivileged users
- **product:** CORSAIR iCUE
- **version:** 5.9.105 with iCUE Murals
- **component:** cuepkg-1.2.6 subdirectory

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-22002.

**Root cause of vulnerability:**
The vulnerability is a DLL hijacking issue in CORSAIR iCUE v5.9.105 during the update process. The "iCUEUpdateService" service spawns "cuepkg.exe" with "NT AUTHORITY\SYSTEM" privileges, and this process loads DLLs from the `\cuepkg-1.2.6` directory. Since a regular user can create files in this directory, a malicious DLL can be placed there and loaded by `cuepkg.exe` with elevated privileges.

**Weaknesses/vulnerabilities present:**
- DLL Hijacking: The application loads DLLs from a user-writable directory, which allows an attacker to inject a malicious DLL.
- Privilege Escalation: The vulnerable process runs with "NT AUTHORITY\SYSTEM" privileges, enabling the attacker to gain elevated privileges by injecting a malicious DLL.

**Impact of exploitation:**
Successful exploitation allows an attacker to achieve local privilege escalation from a low-privileged user to SYSTEM level. This means the attacker can execute arbitrary code with the highest privileges on the system.

**Attack vectors:**
The attack vector involves placing a malicious DLL (e.g., `MSASN1.dll`, `NTASN1.dll`, or `profapi.dll`) within the `\cuepkg-1.2.6` directory of the iCUE installation. The vulnerable application loads these DLLs during its update process.

**Required attacker capabilities/position:**
- The attacker needs local access to the system.
- The attacker must have write access to the `\cuepkg-1.2.6` directory within the iCUE installation directory.
- The attacker must be able to trigger the update process by either waiting for automatic updates or manually forcing an update check.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.056 |
| 2 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.055 |
| 3 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.050 |
| 4 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.048 |
| 5 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | Allowed | sparse | 0.046 |
| 6 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.043 |
| 7 | 250 | Execution with Unnecessary Privileges | Base | Allowed | sparse | 0.043 |
| 8 | 277 | Insecure Inherited Permissions | Variant | Allowed | sparse | 0.043 |
| 9 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | Allowed | dense | 0.484 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-427: Uncontrolled Search Path Element

CWE-276: Incorrect Default Permissions

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-379: Creation of Temporary File in Directory with Insecure Permissions

CWE-23: Relative Path Traversal

CWE-250: Execution with Unnecessary Privileges

CWE-277: Insecure Inherited Permissions

CWE-782: Exposed IOCTL with Insufficient Access Control

CWE-73: External Control of File Name or Path