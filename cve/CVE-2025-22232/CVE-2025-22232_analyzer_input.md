# Vulnerability Information: CVE-2025-22232

## Vulnerability Description
**Spring Cloud Config Server may not use Vault token sent by clients using a X-CONFIG-TOKEN header when making requests to Vault**. Your application may be affected by this if the following are true * You have Spring Vault on the classpath of your Spring Cloud Config Server and * You are using the X-CONFIG-TOKEN header to send a Vault token to the Spring Cloud Config Server for the Config Server to use when making requests to Vault and * You are using the default Spring Vault SessionManager implementation LifecycleAwareSessionManager or a SessionManager implementation that persists the Vault token such as SimpleSessionManager. In this case the SessionManager persists the first token it retrieves and will continue to use that token even if client requests to the Spring Cloud Config Server include a X-CONFIG-TOKEN header with a different value. Affected Spring Products and Versions Spring Cloud Config * 2.2.1.RELEASE - 4.2.1 Mitigation Users of affected versions should upgrade to the corresponding fixed version. Affected version(s)Fix versionAvailability4.2.x4.2.2OSS4.1.x4.1.6OSS4.0.x4.0.10Commercial3.1.x3.1.10Commercial3.0.x4.1.6OSS2.2.x4.1.6OSS NOTE Spring Cloud Config 3.0.x and 2.2.x are no longer under open source or commercial support. Users of these versions are encouraged to upgrade to a supported version. No other mitigation steps are necessary.

### Vulnerability Description Key Phrases
- **rootcause:** **Spring Cloud Config Server may not use Vault token sent by clients using a X-CONFIG-TOKEN header when making requests to Vault**
- **vector:** X-CONFIG-TOKEN header
- **product:** Spring Cloud Config Server
- **version:** 2.2.1.RELEASE - 4.2.1 and 4.0.x and 4.1.x and 4.2.x and 3.1.x and 3.0.x and 2.2.x

## CVE Reference Links Content Summary
```
Root cause of vulnerability:
Spring Cloud Config Server may not use Vault token sent by clients using a `X-CONFIG-TOKEN` header when making requests to Vault. The `SessionManager` persists the first token it retrieves and will continue to use that token even if client requests to the Spring Cloud Config Server include a `X-CONFIG-TOKEN` header with a different value.

Weaknesses/vulnerabilities present:
Spring Cloud Config Server's `SessionManager` implementations `LifecycleAwareSessionManager` and `SimpleSessionManager` (or any implementation that persists the Vault token) do not refresh the Vault token when a new one is sent via the `X-CONFIG-TOKEN` header.

Impact of exploitation:
The Spring Cloud Config Server may use a stale Vault token, potentially leading to unauthorized access to sensitive configuration data stored in Vault if the original token's permissions have been changed or revoked.

Attack vectors:
An attacker can send a `X-CONFIG-TOKEN` header with a malicious or expired Vault token to the Spring Cloud Config Server.

Required attacker capabilities/position:
The attacker needs to be able to send HTTP requests to the Spring Cloud Config Server and include a `X-CONFIG-TOKEN` header.

Mitigation or fix:
Users of affected versions should upgrade to the corresponding fixed version:
*   4.2.x to 4.2.2
*   4.1.x to 4.1.6
*   4.0.x to 4.0.10
*   3.1.x to 3.1.10

If you cannot upgrade, then you can either:
1.  Remove Spring Vault from the classpath if it is not needed or
2.  Implement your own `SessionManager` that does not persist the Vault token and provide a bean using that implementation in a `@Configuration` class.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 1.368 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 1.349 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 1.312 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 1.312 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 1.289 |
| 6 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 1.280 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 1.277 |
| 8 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 1.252 |
| 9 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | dense | 0.441 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.003 |

