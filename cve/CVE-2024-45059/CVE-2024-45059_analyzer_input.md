# Vulnerability Information: CVE-2024-45059

## Vulnerability Description
i-Educar is free, fully online school management software that can be used by school secretaries, teachers, coordinators, and area managers. A SQL Injection vulnerability was found prior to the 2.9 branch in the `ieducar/intranet/funcionario_vinculo_det.php` file, which creates the query by concatenating the unsanitized GET parameter `cod_func`, allowing the attacker to obtain sensitive information such as emails and password hashes. Commit 7824b95745fa2da6476b9901041d9c854bf52ffe fixes the issue.

### Vulnerability Description Key Phrases
- **rootcause:** **improper input sanitization**
- **weakness:** **SQL injection**
- **impact:** information disclosure and obtain sensitive information
- **product:** i-Educar
- **version:** prior to 2.9 branch
- **component:** ieducar/intranet/funcionario_vinculo_det.php

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**

*   The vulnerability stems from the construction of a SQL query through string concatenation, using a user-controlled GET parameter (`cod_func`) without proper sanitization or parameterization.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection:** The application is vulnerable to SQL injection due to the direct incorporation of user input into the SQL query.

**Impact of exploitation:**

*   **Full database access:** A successful SQL injection attack could allow an attacker to gain complete and unrestricted access to the database.
*   **Data exfiltration:** Attackers can potentially retrieve sensitive information, such as user emails and password hashes.

**Attack vectors:**

*   **HTTP GET parameter manipulation:** The attacker injects malicious SQL code via the `cod_func` GET parameter.
*   **Network:** The attack vector is network-based, meaning the attacker can exploit the vulnerability remotely.

**Required attacker capabilities/position:**

*   **Authentication:** The attacker needs to be authenticated to access the vulnerable page.
*   **Basic web request knowledge:** The attacker must be able to manipulate GET parameters in HTTP requests.
*   **SQL knowledge:** The attacker needs to have some knowledge of SQL to craft the injection payload.

**Additional details:**

*   The vulnerable code is located in the `ieducar/intranet/funcionario_vinculo_det.php` file, specifically on line 17.
*   The provided PoC demonstrates how to use `sqlmap` to exploit this vulnerability.
*   The vulnerability has a CVSS score of 8.8, classified as high severity, and is assigned CVE-2024-45059.
*   The vulnerability is present in i-Educar version 2.9 and has no patch available, as of the provided document.
*   The provided content recommends the use of prepared statements as the proper mitigation technique for this vulnerability.

The provided content gives significant details and context compared to a standard CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.363 |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.341 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.334 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.327 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.326 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.325 |
| 8 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.323 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.475 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

