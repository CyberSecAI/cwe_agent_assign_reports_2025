# Vulnerability Information: CVE-2024-3605

## Vulnerability Description
The WP Hotel Booking plugin for WordPress is vulnerable to SQL Injection via the room_type parameter of the /wphb/v1/rooms/search-rooms REST API endpoint in all versions up to, and including, 2.1.0 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** unauthenticated attackers
- **product:** WP Hotel Booking plugin for WordPress
- **version:** up to and including 2.1.0
- **component:** /wphb/v1/rooms/search-rooms REST API endpoint

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-3605

**Vulnerability Description:**

*   **Root Cause:** The vulnerability is due to insufficient escaping of user-supplied input and a lack of proper preparation in the existing SQL query within the WP Hotel Booking plugin. Specifically, the `room_type` parameter of the `/wphb/v1/rooms/search-rooms` REST API endpoint is vulnerable.

*   **Weakness:**  The plugin fails to sanitize or properly prepare the `room_type` parameter before using it in an SQL query. This allows an attacker to inject malicious SQL code.

*   **Impact of Exploitation:** An unauthenticated attacker can inject arbitrary SQL queries into the existing query, potentially allowing them to:
    *   Extract sensitive information from the database.
    *   Modify or delete data within the database.

*   **Attack Vector:** The vulnerability can be exploited through the `/wphb/v1/rooms/search-rooms` REST API endpoint by manipulating the `room_type` parameter.

*   **Required Attacker Capabilities:**
    *   The attacker does not need to be authenticated, they can trigger the vulnerability directly.
    *   The attacker needs to have network access to the affected WordPress instance and knowledge of the vulnerable API endpoint and parameter.

**Affected Software:**

*   **Plugin:** WP Hotel Booking
*   **Affected Versions:** All versions up to and including 2.1.0
*   **Patched Version:** 2.1.1

**Additional Information:**

*   The vulnerability is categorized as "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')".
*   It has a critical CVSS score of 10.0.
*   The vulnerability was discovered by Krzysztof ZajÄ…c of CERT PL.
*   The patch involves updating to version 2.1.1 or a newer patched version.

The changelog also mentions multiple "security" fixes in various versions, but the provided text does not give details about other vulnerabilities or any details that are not related to CVE-2024-3605.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.572 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.523 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.510 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.507 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.494 |
| 7 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.494 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.493 |
| 9 | 564 | SQL Injection: Hibernate | Variant | Allowed | dense | 0.564 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |

