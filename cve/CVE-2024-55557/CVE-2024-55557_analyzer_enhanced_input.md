## Vulnerability Description
ui/pref/ProxyPrefView.java in weasis-core in Weasis 4.5.1 has a **hardcoded key for symmetric encryption** of proxy credentials.

### Vulnerability Description Key Phrases
- **rootcause:** **hardcoded key for symmetric encryption**
- **product:** Weasis
- **version:** 4.5.1
- **component:** ui/pref/ProxyPrefView.java in weasis-core

## CVE Reference Links Content Summary
```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": {
    "related": true,
    "summary": "The provided content details a vulnerability in Weasis 4.5.1 (CVE-2024-55557) that exposes proxy credentials due to a hardcoded encryption key and weak encoding methods. An attacker can exploit this through local file access or remote access via the Weasis port.",
    "details": {
      "root_cause": "The root cause is a combination of a hardcoded symmetric encryption key within the `CryptoHandler.java`, and the use of weak encryption with Blowfish in ECB mode (which doesn't use an IV), combined with weak encoding methods (Base64 and gzip) in `WProperties.java`.",
      "weaknesses": [
        "Hardcoded encryption key: The key 'proxy.auth' is directly embedded in the source code, which makes it easily accessible to attackers.",
        "Use of Blowfish in ECB mode: ECB mode does not provide confidentiality when identical plaintexts are encrypted, because it always produces the same ciphertext. Using Blowfish in this mode is considered insecure.",
         "Weak Encoding: Using Base64 and gzip for 'encryption' is not a secure way of protecting data, these are reversible encoding methods not encryption.",
         "Lack of access controls: the persistence.properties file has read permissions for all users on the system, allowing local access.",
         "Exposed gogo shell: The gogo shell of Weasis provides remote access to sensitive data."
      ],
      "impact": "Successful exploitation allows an attacker to fully disclose proxy credentials, including usernames and passwords. This can lead to further unauthorized access to systems or networks that rely on these credentials. The impact is especially severe since the compromised credentials may grant access to sensitive resources behind the proxy. The exploit allows other users on the same system to read the password of another user.",
       "attack_vectors": [
        "Local file read: An attacker with local access to the Weasis host can read the `persistence.properties` file, which contains the encrypted proxy password.",
        "Remote path disclosure and file read: An attacker can remotely connect to the Weasis port and use the gogo shell to disclose the path of the persistence.properties file and then read its contents.",
        "Remote path disclosure and file read through Weasis UI: It is also possible to read any file from the weasis server using weasis UI using a crafted URL."
      ],
      "required_capabilities": "The attacker requires:\n- Local access to the filesystem to read the `persistence.properties` file or;\n- Network access to the Weasis port (e.g., 17179) to interact with the gogo shell.\n- Knowledge of the hardcoded encryption key ('proxy.auth') and the decryption process, which are available in the source code. \n- Basic understanding of how to use gzip and base64 decoding."
    }
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.213 |
| 2 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.176 |
| 3 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.157 |
| 4 | 1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | sparse | 0.153 |
| 5 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.149 |
| 6 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | sparse | 0.137 |
| 7 | 834 | Excessive Iteration | Class | Discouraged | sparse | 0.134 |
| 8 | 316 | Cleartext Storage of Sensitive Information in Memory | Variant | Allowed | sparse | 0.133 |
| 9 | 1394 | Use of Default Cryptographic Key | Base | Allowed | dense | 0.476 |
| 10 | 208 | Observable Timing Discrepancy | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-321: Use of Hard-coded Cryptographic Key

CWE-798: Use of Hard-coded Credentials

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-1204: Generation of Weak Initialization Vector (IV)

CWE-259: Use of Hard-coded Password

CWE-312: Cleartext Storage of Sensitive Information

CWE-834: Excessive Iteration

CWE-316: Cleartext Storage of Sensitive Information in Memory

CWE-1394: Use of Default Cryptographic Key

CWE-208: Observable Timing Discrepancy