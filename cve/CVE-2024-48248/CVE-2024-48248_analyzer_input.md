# Vulnerability Information: CVE-2024-48248

## Vulnerability Description
NAKIVO Backup & Replication before 11.0.0.88174 allows **absolute path traversal** for reading files via getImageByPath to /c/router (this may lead to remote code execution across the enterprise because PhysicalDiscovery has cleartext credentials).

### Vulnerability Description Key Phrases
- **weakness:** **absolute path traversal**
- **impact:** remote code execution
- **product:** NAKIVO Backup & Replication
- **version:** before 11.0.0.88174
- **component:** /c/router

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
The `getImageByPath` method within the NAKIVO Backup and Replication solution takes a user-supplied path and directly uses it to read a file, without proper input validation, leading to an arbitrary file read vulnerability.

Weaknesses/vulnerabilities present:
- Unauthenticated Arbitrary File Read (CVE-2024-48248)
- Lack of input validation on the `path` parameter within the `getImageByPath` method.

Impact of exploitation:
- An attacker can read arbitrary files on the target system, including sensitive data such as the database file containing credentials for integrations with other systems.
- Disclosure of sensitive information, including credentials for cloud services, domain controllers, and other integrated systems, potentially leading to further compromise.
- Potential for data exfiltration and further attacks, as the attacker can obtain backup data and other sensitive information.

Attack vectors:
- Exploiting the `/c/router` endpoint by sending a crafted POST request with the action "STPreLoadManagement" and method "getImageByPath" along with a path to the desired file.
- The vulnerability is accessible without authentication.

Required attacker capabilities/position:
- Network access to the NAKIVO Backup and Replication solution's Director interface, which listens on port 4443/TCP.
- Ability to craft and send HTTP POST requests with JSON payloads.
- Knowledge of file paths on the target system.

Mitigation or fix:
- NAKIVO has patched the vulnerability in version `v11.0.0.88174` and onwards by using the `FileUtils` library with the `getFile` function and stripping path manipulation.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.219 |
| 3 | 73 | External Control of File Name or Path | Base | Allowed | sparse | 0.170 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.167 |
| 5 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.154 |
| 6 | 37 | Path Traversal: '/absolute/pathname/here' | Variant | Allowed | sparse | 0.153 |
| 7 | 38 | Path Traversal: '\absolute\pathname\here' | Variant | Allowed | sparse | 0.139 |
| 8 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.136 |
| 9 | 24 | Path Traversal: '../filedir' | Variant | Allowed | dense | 0.571 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.002 |

