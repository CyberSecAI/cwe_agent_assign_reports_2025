# Vulnerability Information: CVE-2024-51186

## Vulnerability Description
D-Link DIR-820L 1.05b03 was discovered to contain a remote code execution (RCE) vulnerability via the ping_addr parameter in the ping_v4 and ping_v6 functions.

### Vulnerability Description Key Phrases
- **impact:** remote code execution
- **vector:** ping_addr parameter
- **product:** D-Link DIR-820L
- **version:** 1.05b03
- **component:** ping_v4 and ping_v6 functions

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause of Vulnerability:**
- The vulnerability is due to insufficient input sanitization of the `ping_addr` parameter within the `ping_v4` and `ping_v6` functions. This allows an attacker to inject arbitrary commands into the system.

**Weaknesses/Vulnerabilities Present:**
- Command Injection: The primary weakness is the ability to inject operating system commands through the vulnerable `ping_addr` parameter.

**Impact of Exploitation:**
- Remote Code Execution (RCE): An attacker can execute arbitrary code on the vulnerable device. In the provided example, the attacker executes `telnetd` to gain a shell on the device, leading to full compromise.

**Attack Vectors:**
- HTTP requests with `ccp_act=ping_v4` or `ccp_act=ping_v6` and a malicious `ping_addr` parameter.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send HTTP requests to the vulnerable D-Link DIR-820L router. This means the attacker could be on the local network or, potentially, able to reach the router's web interface from the internet if port forwarding or other means have exposed it.

**Additional Information:**
- The vulnerable functions are located in the "TOOLS" -> "SYSTEM CHECK" page, specifically the "PING TEST" and "IPV6 PING TEST" functionalities.
- The exploit was demonstrated on D-Link DIR-820L firmware version 1.05b03.
- The provided github content gives specific attack vectors with the `ccp_act` parameters.
- The legacy.us.dlink.com content indicates the device reached end of support in 2017.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.056 |
| 2 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | sparse | 0.050 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.049 |
| 4 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.046 |
| 5 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.045 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.044 |
| 7 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.043 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.040 |
| 9 | 912 | Hidden Functionality | Class | Allowed-with-Review | dense | 0.541 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

