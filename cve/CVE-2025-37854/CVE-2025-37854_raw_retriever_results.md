# Raw Retriever Results for CVE-2025-37854

# Raw Retriever Results for CVE-2025-37854
## Query
In the Linux kernel, the following vulnerability has been resolved drm/amdkfd Fix mode1 reset crash issue If HW scheduler hangs and mode1 reset is used to recover GPU, KFD signal user space to abort the processes. After process abort exit, user queues still use the GPU to access system memory before h/w is reset while KFD cleanup worker free system memory and free VRAM. There is use-after-free race bug that KFD allocate and reuse the freed system memory, and user queue write to the same system memory to corrupt the data structure and cause driver crash. To fix this race, KFD cleanup worker terminate user queues, then flush reset_domain wq to wait for any GPU ongoing reset complete, and then free outstanding BOs.

## Keyphrases
- **rootcause**: 'use-after-free race'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4038 | 0.4733 | 0.4319 | 0.4286 | 20 |
| Sparse | 176.5472 | 800.0000 | 579.4610 | 580.7868 | 11 |
| Graph | 1.6100 | 4.3290 | 2.1590 | 1.9834 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 4.3290 | Allowed |
| 2 | 123 | Write-what-where Condition | base | 2.9120 | Allowed |
| 3 | 908 | Use of Uninitialized Resource | Base | 2.7980 | Allowed |
| 4 | 416 | Use After Free | Variant | 2.5305 | Allowed |
| 5 | 415 | Double Free | Variant | 2.5222 | Allowed |
| 6 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.2100 | Allowed-with-Review |
| 8 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |
| 9 | 368 | Context Switching Race Condition | base | 2.1762 | Allowed |
| 10 | 479 | Signal Handler Use of a Non-reentrant Function | variant | 2.0659 | Allowed |
| 11 | 457 | Use of Uninitialized Variable | variant | 1.9008 | Allowed |
| 12 | 129 | Improper Validation of Array Index | variant | 1.8394 | Allowed |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7371 | Allowed-with-Review |
| 14 | 909 | Missing Initialization of Resource | Class | 1.7327 | Allowed-with-Review |
| 15 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4733 | 0.4733 | Allowed-with-Review |
| 2 | 416 | Use After Free | Variant | 0.4631 | 0.4631 | Allowed |
| 3 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4606 | 0.4606 | Allowed |
| 4 | 909 | Missing Initialization of Resource | Class | 0.4572 | 0.4572 | Allowed-with-Review |
| 5 | 908 | Use of Uninitialized Resource | Base | 0.4500 | 0.4500 | Allowed |
| 6 | 667 | Improper Locking | Class | 0.4495 | 0.4495 | Allowed-with-Review |
| 7 | 190 | Integer Overflow or Wraparound | Base | 0.4427 | 0.4427 | Allowed |
| 8 | 787 | Out-of-bounds Write | Base | 0.4418 | 0.4418 | Allowed |
| 9 | 366 | Race Condition within a Thread | Base | 0.4356 | 0.4356 | Allowed |
| 10 | 122 | Heap-based Buffer Overflow | Variant | 0.4337 | 0.4337 | Allowed |
| 11 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4235 | 0.4235 | Allowed |
| 12 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4230 | 0.4230 | Discouraged |
| 13 | 413 | Improper Resource Locking | Base | 0.4188 | 0.4188 | Allowed |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4149 | 0.4149 | Allowed |
| 15 | 833 | Deadlock | Base | 0.4128 | 0.4128 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 416 | Use After Free | 800.0000 | 800.0000 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 669.7493 | 669.7493 | Allowed-with-Review |
| 3 | 667 | Improper Locking | 659.5689 | 659.5689 | Allowed-with-Review |
| 4 | 415 | Double Free | 643.6585 | 643.6585 | Allowed |
| 5 | 364 | Signal Handler Race Condition | 602.0768 | 602.0768 | Allowed |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 580.7868 | 580.7868 | Allowed |
| 7 | 459 | Incomplete Cleanup | 577.0031 | 577.0031 | Allowed |
| 8 | 911 | Improper Update of Reference Count | 555.3325 | 555.3325 | Allowed |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | 555.2524 | 555.2524 | Allowed |
| 10 | 833 | Deadlock | 554.0954 | 554.0954 | Allowed |
| 11 | 908 | Use of Uninitialized Resource | 176.5472 | 176.5472 | Allowed |
