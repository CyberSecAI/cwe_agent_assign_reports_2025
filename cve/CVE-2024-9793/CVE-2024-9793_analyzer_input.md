# Vulnerability Information: CVE-2024-9793

## Vulnerability Description
A vulnerability classified as critical was found in Tenda AC1206 up to 15.03.06.23. This vulnerability affects the function ate_iwpriv_set/ate_ifconfig_set of the file /goform/ate. The manipulation leads to **command injection**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Tenda AC1206
- **version:** up to 15.03.06.23
- **component:** /goform/ate

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

The root cause of the vulnerability is the lack of proper input sanitization in the `ate_iwpriv_set` function of the Tenda AC1206 router firmware. Specifically, the function directly uses user-provided input in a system call without proper checks, allowing for command injection.

**Weaknesses/Vulnerabilities Present:**

*   **Command Injection:** The primary vulnerability is command injection. By sending specially crafted UDP messages to the router's port 7329, an attacker can inject arbitrary commands that are executed by the underlying operating system with the privileges of the running process.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** Successful exploitation allows the attacker to execute arbitrary commands on the router's operating system. This could lead to a variety of malicious outcomes, such as:
    *   Full control of the device.
    *   Installation of malware.
    *   Data exfiltration.
    *   Denial-of-service attacks.
    *   Network manipulation.

**Attack Vectors:**

*   **Network-Based Attack:** The attack vector is network-based. An attacker sends a UDP message to a specific port (7329) on the router.
*   **Pre-Authentication:** This vulnerability is pre-authentication, meaning that an attacker does not need to authenticate to exploit it.

**Required Attacker Capabilities/Position:**

*   **Network Connectivity:** The attacker must be on the same network or have a route to the target router's IP address.
*   **Basic Networking Knowledge:** The attacker needs a basic understanding of network communication, specifically UDP, to craft the malicious packets.

**Technical Details:**

1.  The Tenda router runs a service accessible via the `/goform/ate` URL, which starts a thread and calls `ate_main_handle`.
2.  `ate_main_handle` opens UDP port 7329 and processes incoming messages.
3.  The message format is `command args`.
4.  When the command is `iwpriv` and `arg` is `wlan0` or `wlan1` (with no `;` in the arg), the `ate_iwpriv_set` function is called.
5.  The `iwpriv_wlan_set` function executes user-provided input directly through a system call, leading to command injection.

**Example Attack:**

A crafted UDP packet sent to port 7329 on the router with the following payload:

```
b'iwpriv wlan0 & ls'
```

This will execute the `ls` command on the router.

The vulnerability is confirmed to be present in Tenda AC1206 firmware versions V15.03.06.23 and earlier.

This information is based on the provided GitHub report and the VulDB entry. The provided Tenda website content was not relevant to the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.431 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.405 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.353 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.353 |
| 7 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.349 |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.341 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.611 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

