## Vulnerability Description
A vulnerability was found in AMTT Hotel Broadband Operation System up to 3.0.3.151204. It has been classified as critical. Affected is an unknown function of the file /manager/frontdesk/online_status.php. The manipulation of the argument AccountID leads to **sql injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** AMTT Hotel Broadband Operation System
- **version:** up to 3.0.3.151204
- **component:** /manager/frontdesk/online_status.php

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**CVE ID:** CVE-2024-11051

**Vulnerable Software:**  HiBOS Hotel Broadband Operation System (HiBOS) versions V3.0.3.151204 and earlier.

**Root Cause of Vulnerability:**  The vulnerability stems from a lack of proper input sanitization in the HiBOS system. Specifically, the system fails to adequately sanitize user-provided input before incorporating it into SQL queries.

**Weaknesses/Vulnerabilities Present:**
*   **SQL Injection:** The primary vulnerability is a SQL injection flaw. This allows an attacker to inject malicious SQL code into input fields which are then executed by the database server.

**Impact of Exploitation:**
*   **Sensitive Data Disclosure:** Attackers can read sensitive data from the database.
*   **Data Modification:** The attacker can modify database records.
*   **Database Administration:** The attacker could potentially execute administrative operations on the database.
*   **Server Control:** In certain cases, the attacker could gain control of the server through database interactions.

**Attack Vectors:**
*   **HTTP GET Request:**  The provided Proof of Concept (POC) demonstrates that the vulnerability can be exploited using a crafted HTTP GET request to the `/manager/frontdesk/online_status.php` endpoint.
*   **Manipulated Input Fields:** The attack vector involves injecting SQL code into the `AccountID` parameter of the HTTP GET request.

**Required Attacker Capabilities/Position:**
*   **Network Access:** The attacker needs network access to the vulnerable HiBOS system.
*   **Basic HTTP Knowledge:** The attacker needs to be able to construct and send HTTP requests.

**Technical Details:**
*   The provided POC demonstrates a successful SQL injection using `AccountID=1%27or%20updatexml(1,concat(0x7e,(select%20@@version),0x7e),1)%20or%20%27`. This payload injects a SQL statement to extract the database version.

**Additional Information:**
*   The vulnerability is considered "high risk".
*  There's currently no available patch.

This analysis provides more detail than the official CVE description by identifying the vulnerable endpoint, the vulnerable parameter, and providing a working proof of concept.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.496 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.414 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.412 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.398 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.395 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.392 |
| 8 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.390 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.624 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-502: Deserialization of Untrusted Data

CWE-705: Incorrect Control Flow Scoping

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-73: External Control of File Name or Path