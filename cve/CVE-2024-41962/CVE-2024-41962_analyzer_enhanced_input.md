## Vulnerability Description
Bostr is an nostr relay aggregator proxy that acts like a regular nostr relay. bostr let everyone in even having **authorized_keys being set when noscraper is set to true**. This vulnerability is fixed in 3.0.10.

### Vulnerability Description Key Phrases
- **rootcause:** **authorized_keys being set when noscraper is set to true**
- **impact:** let everyone in
- **product:** Bostr
- **version:** before 3.0.10

## CVE Reference Links Content Summary
Based on the provided content, here's the vulnerability information for CVE-2024-41962:

**Root Cause:**
The vulnerability is located in the `auth.js` file of the `bostr` project. Specifically, the issue is with how the authentication logic handles the `noscraper` configuration. When `noscraper` is enabled, the code incorrectly bypasses the check against `authorized_keys`, allowing unauthorized users to access the bouncer.

**Weaknesses/Vulnerabilities Present:**
- **Incorrect Authorization Logic:** The primary weakness is the flawed logic in `auth.js` which fails to properly enforce authorization when `noscraper` is enabled. It allows any user to connect to the bouncer, regardless of their public key being present in the `authorized_keys` configuration.
- **Bypass of Intended Security:** The `noscraper` setting was intended for a different purpose but, due to the flawed implementation, can be used to bypass the intended authorization mechanism.

**Impact of Exploitation:**
- **Unauthorized Access:** Exploitation allows any user, even those not listed in `authorized_keys`, to connect to and use a private bouncer. This effectively bypasses the access control mechanisms of the software.
- **Confidentiality, Integrity, and Availability Risks:** Although the CVSS score indicates low impact on Confidentiality, Integrity and Availability, the unauthorized access could still lead to potentially malicious actions including data manipulation and service disruption.

**Attack Vectors:**
- **Network Access:** The vulnerability is exploitable remotely over the network.
- **Public Key Manipulation:**  An attacker can attempt to connect to the bouncer without having a public key listed in `authorized_keys`, and when `noscraper` is enabled, this attempt will succeed, bypassing authorization.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker must have network access to the vulnerable bouncer.
- **Basic Understanding of the Protocol:** The attacker needs only basic knowledge of how the bouncer's authorization protocol works to exploit the vulnerability.

**Additional Notes:**
- The provided information includes the specific code change that addresses the vulnerability, highlighting the incorrect logic within the `auth.js` file, which is in this code block `if (!authorized_keys?.includes(data.pubkey) && !private_keys[data.pubkey] && !noscraper)`.
- The vulnerability was discovered by `cxplay`.
- The issue affects versions of `bostr` prior to 3.0.10.
- A patch is available in version 3.0.10.
- A workaround involves disabling `noscraper` when `authorized_keys` is set.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.231 |
| 2 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.221 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.217 |
| 4 | 156 | Improper Neutralization of Whitespace | Variant | Allowed | sparse | 0.214 |
| 5 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.213 |
| 6 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.211 |
| 7 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.211 |
| 8 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.210 |
| 9 | 277 | Insecure Inherited Permissions | Variant | Allowed | dense | 0.369 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-276: Incorrect Default Permissions

CWE-863: Incorrect Authorization

CWE-156: Improper Neutralization of Whitespace

CWE-1333: Inefficient Regular Expression Complexity

CWE-184: Incomplete List of Disallowed Inputs

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-918: Server-Side Request Forgery (SSRF)

CWE-277: Insecure Inherited Permissions

CWE-226: Sensitive Information in Resource Not Removed Before Reuse