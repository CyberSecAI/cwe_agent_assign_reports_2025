# Vulnerability Information: CVE-2024-45799

## Vulnerability Description
FluxCP is a web-based Control Panel for rAthena servers written in PHP. A **javascript injection** is possible via venders/buyers list pages and shop names, that are currently not sanitized. This allows executing arbitrary javascript code on the users browser just by visiting the shop pages. As a result all logged in to fluxcp users can have their session info stolen. This issue has been addressed in release version 1.3. All users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **javascript injection**
- **impact:** session info theft
- **product:** FluxCP
- **component:** venders/buyers list pages and shop names

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

*   **Root cause of vulnerability:** The vulnerability stems from a lack of sanitization of shop names displayed on the vendors/buyers list pages within the FluxCP application. This allows for the injection of malicious JavaScript code.

*   **Weaknesses/vulnerabilities present:** The primary weakness is the absence of input sanitization, leading to a cross-site scripting (XSS) vulnerability.

*  **Impact of exploitation:** Successful exploitation could allow an attacker to execute arbitrary JavaScript code in the browsers of users visiting the affected shop pages. The provided content specifically mentions the potential for session information theft.

*   **Attack vectors:** The attack vector involves injecting malicious JavaScript within shop names. This malicious data is then displayed on the vendors/buyers list pages, triggering the code execution when a user visits those pages.

*   **Required attacker capabilities/position:** An attacker needs the ability to create or manipulate shop names to inject malicious JavaScript. This would likely involve either creating a shop or somehow modifying existing shop data. The attacker does not require any special privileges on the server itself, but rather the ability to interact with the application in ways that affect data being displayed.

The provided content gives more information than the placeholder CVE description, detailing the attack vector and impact.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.454 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.447 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.444 |
| 4 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.424 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.424 |
| 6 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.422 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.412 |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.412 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.478 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

