# Raw Retriever Results for CVE-2025-37868

# Raw Retriever Results for CVE-2025-37868
## Query
In the Linux kernel, the following vulnerability has been resolved drm/xe/userptr fix notifier vs folio deadlock User is reporting what smells like notifier vs folio deadlock, where migrate_pages_batch() on core kernel side is holding folio lock(s) and then interacting with the mappings of it, however those mappings are tied to some userptr, which means calling into the notifier callback and grabbing the notifier lock. With perfect timing it looks possible that the pages we pulled from the hmm fault can get sniped by migrate_pages_batch() at the same time that we are holding the notifier lock to mark the pages as accessed/dirty, but at this point we also want to grab the folio locks(s) to mark them as dirty, but if they are contended from notifier/migrate_pages_batch side then we deadlock since folio lock wont be dropped until we drop the notifier lock. Fortunately the mark_page_accessed/dirty is not really needed in the first place it seems and should have already been done by hmm fault, so just remove it. (cherry picked from commit bd7c0cb695e87c0e43247be8196b4919edbe0e85)

## Keyphrases
- **rootcause**: 'notifier vs folio deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4426 | 0.5272 | 0.4653 | 0.4590 | 20 |
| Sparse | 227.3498 | 908.0501 | 684.1382 | 701.9775 | 11 |
| Graph | 1.5281 | 2.3400 | 1.7821 | 1.7099 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 2 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 3 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 4 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 5 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 6 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 7 | 787 | Out-of-bounds Write | base | 1.7680 | Allowed |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 9 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 10 | 833 | Deadlock | Base | 1.7191 | Allowed |
| 11 | 413 | Improper Resource Locking | Base | 1.7008 | Allowed |
| 12 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 13 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 14 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 15 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5272 | 0.5272 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.5220 | 0.5220 | Allowed-with-Review |
| 3 | 413 | Improper Resource Locking | Base | 0.4849 | 0.4849 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4845 | 0.4845 | Allowed-with-Review |
| 5 | 909 | Missing Initialization of Resource | Class | 0.4747 | 0.4747 | Allowed-with-Review |
| 6 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4742 | 0.4742 | Allowed |
| 7 | 591 | Sensitive Data Storage in Improperly Locked Memory | Variant | 0.4641 | 0.4641 | Allowed |
| 8 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4638 | 0.4638 | Allowed |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4610 | 0.4610 | Allowed |
| 10 | 366 | Race Condition within a Thread | Base | 0.4596 | 0.4596 | Allowed |
| 11 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4584 | 0.4584 | Allowed |
| 12 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4577 | 0.4577 | Allowed |
| 13 | 773 | Missing Reference to Active File Descriptor or Handle | Variant | 0.4511 | 0.4511 | Allowed |
| 14 | 404 | Improper Resource Shutdown or Release | Class | 0.4494 | 0.4494 | Allowed-with-Review |
| 15 | 416 | Use After Free | Variant | 0.4489 | 0.4489 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 908.0501 | 908.0501 | Allowed-with-Review |
| 2 | 833 | Deadlock | 778.9396 | 778.9396 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 726.1419 | 726.1419 | Allowed-with-Review |
| 4 | 1390 | Weak Authentication | 714.1828 | 714.1828 | Allowed-with-Review |
| 5 | 125 | Out-of-bounds Read | 707.3178 | 707.3178 | Allowed |
| 6 | 61 | UNIX Symbolic Link (Symlink) Following | 701.9775 | 701.9775 | Allowed |
| 7 | 863 | Incorrect Authorization | 695.9168 | 695.9168 | Allowed-with-Review |
| 8 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | 692.6081 | 692.6081 | Allowed |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 689.9377 | 689.9377 | Allowed |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | 683.0987 | 683.0987 | Allowed-with-Review |
| 11 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 227.3498 | 227.3498 | Allowed |
