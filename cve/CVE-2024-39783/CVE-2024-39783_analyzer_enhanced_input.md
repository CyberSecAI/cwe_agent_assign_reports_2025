## Vulnerability Description
Multiple OS **command injection** vulnerabilities exist in the adm.cgi sch_reboot() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to a arbitrary code execution. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.A **command injection** vulnerability exists in the `restart_week` POST parameter.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **impact:** arbitrary code execution
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Wavlink AC3000
- **version:** M33A8.V5030.210505
- **component:** adm.cgi sch_reboot() functionality

## CVE Reference Links Content Summary
## Analysis of CVE-2024-39783 based on provided content:

This content **is relevant** to CVE-2024-39783. It provides significantly more detail than a standard CVE description.

**Root cause of vulnerability:**

The vulnerability stems from improper neutralization of special elements in commands passed to the `sch_reboot.sh` script via the `adm.cgi` script. Specifically, the `restart_hour`, `restart_min`, and `restart_week` POST parameters are not properly sanitized before being incorporated into a crontab entry.

**Weaknesses/vulnerabilities present:**

*   **Command Injection (CWE-77):**  The lack of input validation allows an attacker to inject arbitrary commands into the crontab, leading to arbitrary code execution.

**Impact of exploitation:**

Successful exploitation allows an attacker to execute arbitrary code on the Wavlink AC3000 router.

**Attack vectors:**

*   An attacker can send a specially crafted HTTP POST request to the `adm.cgi` script with malicious values in the `restart_hour`, `restart_min`, or `restart_week` parameters.
*   The attacker needs to be authenticated to the router's web interface.

**Required attacker capabilities/position:**

*   Network access to the Wavlink AC3000 router.
*   Valid credentials to log in to the router's web interface (authenticated access).
*   Understanding of crontab syntax to craft a malicious payload.

**Mitigation or fix:**

The report does not explicitly state a fix, but implies that proper input validation and sanitization of the `restart_hour`, `restart_min`, and `restart_week` parameters are necessary to prevent command injection.

**Additional Details:**

*   **Affected Product:** Wavlink AC3000 M33A8.V5030.210505
*   **CVSSv3 Score:** 9.1 (Critical)
*   The vulnerability involves manipulating the `SCH_Reboot` nvram item, which is then used to create a crontab entry.
*   The report details the specific functions and code locations involved in the vulnerability (`adm.cgi`, `sch_reboot()`, `sch_reboot.sh`).
*   The report identifies three specific CVEs related to this vulnerability: CVE-2024-39781 (restart\_hour injection), CVE-2024-39782 (restart\_min injection), and CVE-2024-39783 (restart\_week injection).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.358 |
| 4 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.346 |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.337 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.331 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.314 |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.309 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.625 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-134: Use of Externally-Controlled Format String

CWE-1287: Improper Validation of Specified Type of Input

CWE-790: Improper Filtering of Special Elements

CWE-138: Improper Neutralization of Special Elements

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs