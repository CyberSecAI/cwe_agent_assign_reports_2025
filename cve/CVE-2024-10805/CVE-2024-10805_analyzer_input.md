# Vulnerability Information: CVE-2024-10805

## Vulnerability Description
A vulnerability was found in code-projects University Event Management System 1.0. It has been classified as critical. This affects an unknown part of the file doedit.php. The manipulation of the argument id leads to **sql injection**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The initial researcher advisory mentions a confusing product name to be affected. Other parameters might be affected as well.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** code-projects University Event Management System
- **version:** 1
- **component:** doedit.php

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Vulnerability:** SQL Injection

**Root Cause:**
- The `doedit.php` file in the Events-Management-System does not properly sanitize or validate the `id` parameter before using it in an SQL query. The `id` parameter is directly concatenated into the SQL query, making it vulnerable to SQL injection.

**Weaknesses/Vulnerabilities:**
- Lack of input sanitization: The application does not sanitize the 'id' parameter before using it in SQL query, allowing the attacker to inject malicious SQL code.
- Direct concatenation of user-supplied data:  The 'id' parameter is directly concatenated into the SQL query, a classic vulnerability pattern.

**Impact of Exploitation:**
- Sensitive information disclosure: Attackers can use SQL injection to retrieve sensitive information from the database, potentially including usernames, passwords, personal data, or other confidential details.
- Database manipulation: The attacker could potentially modify data within the database, insert malicious data, or even delete database contents
- Full system compromise: With successful exploitation of SQL injection vulnerabilities, complete compromise of the system may be possible in some cases.

**Attack Vectors:**
- HTTP POST request to `doedit.php` with a crafted `id` parameter in the request body.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send HTTP requests to the vulnerable application.
- The attacker doesn't necessarily need to be logged in, as the vulnerability is present even without login.
- Basic understanding of SQL is required to craft SQL injection payloads.
- Knowledge of the vulnerable application's URL (`doedit.php`) and the parameter name (`id`).

**Technical Details from the provided text:**

- Vulnerable file: `doedit.php`
- Vulnerable parameter: `id`
- The provided Proof-of-Concept (POC) uses a `POST` request to `dodelete.php` and parameter `id` which is slightly different from description.
- The database name obtained with sqlmap is `healthcare`.
- sqlmap is used as a tool to test and exploit the vulnerability, although that is not the actual vector.

**Additional Notes:**
- The vulnerability is present even when the user isn't logged in.
- The provided text also mentions `dodelete.php`, but the main vulnerability described is in `doedit.php` and the sqlmap PoC uses `dodelete.php`.
- The included images show the successful extraction of the database name.
- The `sql16.md` document within the github repository documents this vulnerability for "Events-Management-system"

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.516 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.443 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.422 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.413 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.413 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.405 |
| 8 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.403 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.607 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

