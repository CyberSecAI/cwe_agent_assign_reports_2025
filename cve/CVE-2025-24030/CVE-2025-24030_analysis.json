{
  "cve_id": "CVE-2025-24030",
  "description": "Envoy Gateway is an open source project for managing Envoy Proxy as a standalone or Kubernetes-based application gateway. A user with access to the Kubernetes cluster can use a **path traversal attack** to execute Envoy Admin interface commands on proxies managed by any version of Envoy Gateway prior to 1.2.6. The admin interface can be used to terminate the Envoy process and extract the Envoy configuration (possibly containing confidential data). Version 1.2.6 fixes the issue. As a workaround, the `EnvoyProxy` API can be used to apply a bootstrap config patch that restricts access strictly to the prometheus stats endpoint. Find below an example of such a bootstrap patch.",
  "key_phrases": {
    "component": "",
    "rootcause": "",
    "vector": "",
    "weakness": "path traversal attack",
    "product": "Envoy Gateway",
    "impact": "execute Envoy Admin interface commands, terminate the Envoy process, extract the Envoy configuration",
    "attacker": "user with access to the Kubernetes cluster",
    "version": "prior to 1.2.6"
  },
  "reference_content": "Here's an analysis of the provided content, focusing on information relevant to CVE-2025-24030, and any additional context it provides.\n\n**Content from github.com_d9ebcbed_20250624_191239.html**\n\n*   **Vulnerability:** Envoy Admin Interface Exposed through prometheus metrics endpoint (GHSA-j777-63hf-hx76) - **MORE DETAIL THAN CVE DESCRIPTION**\n    *   **Root cause of vulnerability:** A path traversal attack can be used to execute Envoy Admin interface commands via the Prometheus metrics endpoint. The admin interface can be used to terminate the Envoy process and extract the Envoy configuration.\n    *   **Weaknesses/vulnerabilities present:** Path Traversal (CWE-419 is listed), and the admin interface can be used to extract sensitive information such as the Envoy configuration.\n    *   **Impact of exploitation:**\n        *   Ability to execute Envoy Admin interface commands.\n        *   Termination of the Envoy process.\n        *   Extraction of the Envoy configuration, potentially containing confidential data.\n    *   **Attack vectors:**\n        *   A user with access to a Kubernetes cluster where Envoy Gateway is installed.\n        *   Using a path traversal attack on the Prometheus metrics endpoint.\n        *   Example command: `curl --path-as-is http://<Proxy-Service-ClusterIP>:19001/stats/prometheus/../../config_dump`\n    *   **Required attacker capabilities/position:** Access to the Kubernetes cluster where Envoy Gateway is installed.\n    *   **Mitigation or fix:**\n        *   Upgrade to Envoy Gateway version 1.2.6 or later.\n        *   Workaround: Apply a bootstrap config patch to restrict access strictly to the Prometheus stats endpoint. Example provided in the content.\n\n**Content from www.envoyproxy.io_3d0e5f67_20250624_191241.html**\n\n*   **Relevance:** Provides detailed information about the Envoy administration interface and its functionalities.\n*   **Details**:\n    *   Describes the administration interface, its endpoints, and potential risks.\n    *   Highlights the importance of securing access to the administration interface, recommending a secure network or localhost access.\n    *   Provides documentation on endpoints like `/config_dump` which can be used to extract configuration data.\n    *   Details about `/stats/prometheus` endpoint are provided, which is related to the vulnerability.\n\n**Content from www.envoyproxy.io_f7e6afaa_20250624_191239.html**\n\n*   **Relevance:** Configuration best practices for Envoy, specifically focusing on edge proxy configurations.\n*   **Details:**\n    *   Provides configuration recommendations for edge proxies, including setting `normalize_path` and `merge_slashes` to mitigate path confusion vulnerabilities.\n    *   Recommends settings for the `path_with_escaped_slashes_action` configuration option.\n    *   Includes example YAML configurations demonstrating the recommended settings.\n\n**Overall:**\n\nThe provided content from `github.com_d9ebcbed_20250624_191239.html` directly addresses the vulnerability, providing a detailed description, impact, attack vector, and mitigation. The other content from `www.envoyproxy.io` provides related context by explaining the Envoy admin interface, its functionalities, and best practices for configuration, which relate to the overall security considerations of Envoy deployments.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-23 | Relative Path Traversal | 1.0 | Base | Allowed | Primary CWE: The vulnerability is caused by the product's failure to properly neutralize sequences that can resolve to a location outside of the restricted directory. |\n| CWE-497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | 0.7 | Base | Allowed | Secondary Candidate: The **path traversal** leads to the exposure of the Envoy configuration, which may contain sensitive data.|\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Allowed | Secondary Candidate: Executing Envoy Admin interface commands allows an attacker to terminate the Envoy process.|\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-23, Relative Path Traversal, which is a base-level CWE. This is because the root cause of the vulnerability is the **improper neutralization** of path traversal sequences. CWE-23 is related to CWE-22, Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), as CWE-23 is a specific type of CWE-22. CWE-497 is a Class level CWE which results from the Path Traversal Attack.\n\n```mermaid\ngraph TD\n    cwe23[\"CWE-23: Relative Path Traversal\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory\"]\n    cwe497[\"CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n\n    cwe23 -->|CHILDOF| cwe22\n    cwe23 -->|CANPRECEDE| cwe497\n    cwe23 -->|CANPRECEDE| cwe306\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe23 primary\n    class cwe497,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **path traversal vulnerability** (CWE-23). This allows the attacker to execute Envoy Admin interface commands, leading to two potential impacts: termination of the Envoy process (CWE-306) and extraction of the Envoy configuration (CWE-497).\n\n## Summary of Analysis\nThe initial assessment identified CWE-23 as the primary weakness due to the **path traversal vulnerability**. The `github.com_d9ebcbed_20250624_191239.html` content explicitly mentions a **path traversal attack** as the root cause. The vulnerability allows the execution of Envoy Admin interface commands, leading to potential impacts such as termination of the Envoy process and extraction of the Envoy configuration. The Retriever Results also listed CWE-23 and CWE-22 as high-scoring candidates.\n\nThe relationship graph shows that CWE-23 can precede CWE-497 and CWE-306. The abstraction level of CWE-23 is Base, which is the preferred level for mapping root causes.\n\nCWE-22 was considered but not selected as the primary CWE because CWE-23, Relative Path Traversal, is a more specific type of CWE-22.\n\nRelevant CWE Information:\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-23: Relative Path Traversal\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as \"..\" that can resolve to a location that is outside of that directory.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-306: Missing Authentication for Critical Function\n**Abstraction Level**: base\n**Similarity Score**: 2.47\n**Source**: graph\n\n**Description**:\nCWE-306: Missing Authentication for Critical Function\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Relationships**:\n- PARENTOF -> CWE-322\n- PARENTOF -> CWE-288\n- CHILDOF -> CWE-287\n- CHILDOF -> CWE-287\n- CHILDOF -> CWE-306",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-23 | Relative Path Traversal | 1.0 | Base | Allowed | Primary CWE: The vulnerability is caused by the product's failure to properly neutralize sequences that can resolve to a location outside of the restricted directory. |\n| CWE-497 | Exposure of Sensitive System Information to an Unauthorized Control Sphere | 0.7 | Base | Allowed | Secondary Candidate: The **path traversal** leads to the exposure of the Envoy configuration, which may contain sensitive data.|\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Allowed | Secondary Candidate: Executing Envoy Admin interface commands allows an attacker to terminate the Envoy process.|\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-23, Relative Path Traversal, which is a base-level CWE. This is because the root cause of the vulnerability is the **improper neutralization** of path traversal sequences. CWE-23 is related to CWE-22, Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'), as CWE-23 is a specific type of CWE-22. CWE-497 is a Class level CWE which results from the Path Traversal Attack.\n\n```mermaid\ngraph TD\n    cwe23[\"CWE-23: Relative Path Traversal\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory\"]\n    cwe497[\"CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n\n    cwe23 -->|CHILDOF| cwe22\n    cwe23 -->|CANPRECEDE| cwe497\n    cwe23 -->|CANPRECEDE| cwe306\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe23 primary\n    class cwe497,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **path traversal vulnerability** (CWE-23). This allows the attacker to execute Envoy Admin interface commands, leading to two potential impacts: termination of the Envoy process (CWE-306) and extraction of the Envoy configuration (CWE-497).\n\n## Summary of Analysis\nThe initial assessment identified CWE-23 as the primary weakness due to the **path traversal vulnerability**. The `github.com_d9ebcbed_20250624_191239.html` content explicitly mentions a **path traversal attack** as the root cause. The vulnerability allows the execution of Envoy Admin interface commands, leading to potential impacts such as termination of the Envoy process and extraction of the Envoy configuration. The Retriever Results also listed CWE-23 and CWE-22 as high-scoring candidates.\n\nThe relationship graph shows that CWE-23 can precede CWE-497 and CWE-306. The abstraction level of CWE-23 is Base, which is the preferred level for mapping root causes.\n\nCWE-22 was considered but not selected as the primary CWE because CWE-23, Relative Path Traversal, is a more specific type of CWE-22.\n\nRelevant CWE Information:\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product does not properly prevent sensitive system-level information from being accessed by unauthorized actors who do not have the same level of access to the underlying system as the product does.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-23: Relative Path Traversal\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as \"..\" that can resolve to a location that is outside of that directory.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-306: Missing Authentication for Critical Function\n**Abstraction Level**: base\n**Similarity Score**: 2.47\n**Source**: graph\n\n**Description**:\nCWE-306: Missing Authentication for Critical Function\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Relationships**:\n- PARENTOF -> CWE-322\n- PARENTOF -> CWE-288\n- CHILDOF -> CWE-287\n- CHILDOF -> CWE-287\n- CHILDOF -> CWE-306\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-288:**\n- 288 (Authentication Bypass Using an Alternate Path or Channel) - ROOT\n\n\n**Chain starting from CWE-22:**\n- 22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Path traversal",
        "match_reason": "term_in_phrase_whole_phrase"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "697",
        "name": "Incorrect Comparison",
        "source": "sparse"
      },
      "similarity": 624.5795799151291
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 595.7209323164133
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 593.9935289349464
    },
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "sparse"
      },
      "similarity": 584.8189482300846
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 569.7190966600342
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 565.7971746503622
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 550.1283645544676
    },
    {
      "metadata": {
        "doc_id": "941",
        "name": "Incorrectly Specified Destination in a Communication Channel",
        "type": "Base",
        "original_content": "The product creates a communication channel to initiate an outgoing request to an actor, but it does not correctly specify the intended destination for that actor.",
        "keyphrase_source": "weakness:path traversal attack",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.4676314523288625,
            "graph": 1.6019240418845715
          }
        }
      },
      "similarity": 0.4676314523288625
    },
    {
      "doc_id": "613",
      "text": "CWE-613: Insufficient Session Expiration",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "613",
        "name": "Insufficient Session Expiration",
        "type": "base",
        "original_content": "CWE-613: Insufficient Session Expiration",
        "relationships": [
          {
            "source_id": "613",
            "target_id": "352",
            "label": "REQUIREDBY",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "613",
            "target_id": "287",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "613",
            "target_id": "672",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "613",
            "target_id": "672",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "672",
            "target_id": "613",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "352",
            "target_id": "613",
            "label": "REQUIRES",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "287",
            "target_id": "613",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "287",
                  "613",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "287"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "287",
                  "613",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "287"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "613",
                  "287",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "287"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-288",
      "CWE-22",
      "CWE-306",
      "CWE-322",
      "CWE-287",
      "CWE-497",
      "CWE-23"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}