## Vulnerability Description
Nextcloud Server is a self hosted personal cloud system. Private shared calendar events recurrence exceptions can be read by sharees. It is recommended that the Nextcloud Server is upgraded to 27.1.10 or 28.0.6 or 29.0.1 and that the Nextcloud Enterprise Server is upgraded to 27.1.10 or 28.0.6 or 29.0.1.

### Vulnerability Description Key Phrases
- **impact:** read private shared calendar events recurrence exceptions
- **attacker:** sharees
- **product:** Nextcloud Server

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-37887:

**Root Cause of Vulnerability:**
The vulnerability lies in how Nextcloud handles recurrence exceptions in shared calendar events. Specifically, when a user shares a calendar, the system does not properly restrict access to recurrence exceptions associated with private events.

**Weaknesses/Vulnerabilities Present:**
- **Information Disclosure:** Private event details, specifically recurrence exceptions, are being exposed to users who have been granted access to the calendar. This violates the intended privacy of the events.
- **Inadequate Access Control:** The system fails to enforce proper access control regarding recurrence exceptions for shared calendars.

**Impact of Exploitation:**
- Unauthorized access to private calendar event details, specifically the recurrence exceptions. This could expose sensitive information related to the timing or modifications of private events.

**Attack Vectors:**
- Network access via the web interface or CalDAV.

**Required Attacker Capabilities/Position:**
- The attacker must have been granted access to a shared calendar that contains private events with recurrence exceptions.
- The attacker needs to be a valid Nextcloud user with access to the shared calendar.
- The attacker needs to view the shared calendar through the web interface or a CalDAV client.

**Additional Information:**
- The vulnerability is rated as "Low" severity.
- The vulnerability was reported by "section1".
- Patches are available in Nextcloud versions 27.1.10, 28.0.6, and 29.0.1.
- The related pull request that fixes the issue is https://github.com/nextcloud/server/pull/45309.
- The issue affects both Nextcloud Server and Nextcloud Enterprise Server.
- The vulnerability is tracked by GHSA-h4xv-cjpm-j595.
- There is no known workaround.
- CVSS v3 base metrics are AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N

The provided information is consistent with the CVE description, and provides additional details regarding the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.132 |
| 2 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.130 |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.120 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.119 |
| 5 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.119 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.116 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.114 |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.111 |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | dense | 0.336 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-532: Insertion of Sensitive Information into Log File

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-295: Improper Certificate Validation

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-23: Relative Path Traversal

CWE-789: Memory Allocation with Excessive Size Value

CWE-918: Server-Side Request Forgery (SSRF)

CWE-117: Improper Output Neutralization for Logs