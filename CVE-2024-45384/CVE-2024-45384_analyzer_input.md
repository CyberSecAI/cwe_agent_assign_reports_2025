# Vulnerability Information: CVE-2024-45384

## Vulnerability Description
**Padding Oracle vulnerability** in Apache Druid extension, druid-pac4j. This could allow an attacker to manipulate a pac4j session cookie. This issue affects Apache Druid versions 0.18.0 through 30.0.0. Since the druid-pac4j extension is optional and disabled by default, Druid installations not using the druid-pac4j extension are not affected by this vulnerability. While we are not aware of a way to meaningfully exploit this flaw, we nevertheless recommend upgrading to version 30.0.1 or higher which fixes the issue and ensuring you have a strong druid.auth.pac4j.cookiePassphrase as a precaution.

### Vulnerability Description Key Phrases
- **weakness:** **Padding Oracle vulnerability**
- **impact:** manipulate a pac4j session cookie
- **attacker:** attacker
- **product:** Apache Druid extension druid-pac4j
- **version:** 0.18.0 through 30.0.0

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Padding Oracle vulnerability in the `druid-pac4j` extension of Apache Druid.
- **Weaknesses/vulnerabilities present:** The vulnerability is a Padding Oracle vulnerability. This type of vulnerability arises when an application improperly handles padding during cryptographic operations, allowing an attacker to decrypt ciphertext by observing error messages. Specifically, in this case, it allows an attacker to manipulate the pac4j session cookie.
- **Impact of exploitation:**  An attacker can manipulate the pac4j session cookie. While a meaningful way to exploit this is unknown, it could lead to unauthorized access or other malicious activities, depending on the cookie's content and usage within the application.
- **Attack vectors:** The vulnerability can be exploited by manipulating the `pac4j` session cookie.
- **Required attacker capabilities/position:** The attacker needs to be able to interact with the application and modify the `pac4j` session cookie. The specifics of how an attacker manipulates the cookie (e.g., by intercepting and modifying it during transit) are not detailed. However, they must be able to send crafted cookie values to the server to trigger the padding oracle.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 610 | Externally Controlled Reference to a Resource in Another Sphere | Class | Discouraged | sparse | 0.600 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.482 |
| 3 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.454 |
| 4 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.442 |
| 5 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.439 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.436 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.434 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.431 |
| 9 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | dense | 0.519 |
| 10 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | Allowed | graph | 0.002 |

