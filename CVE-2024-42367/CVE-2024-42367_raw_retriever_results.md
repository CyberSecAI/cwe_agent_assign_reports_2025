# Raw Retriever Results for CVE-2024-42367

# Raw Retriever Results for CVE-2024-42367
## Query
aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. Prior to version 3.10.2, static routes which contain files with compressed variants (`.gz` or `.br` extension) are vulnerable to path traversal outside the root directory if those variants are symbolic links. The server protects static routes from path traversal outside the root directory when `follow_symlinks=False` (default). It does this by resolving the requested URL to an absolute path and then checking that path relative to the root. However, these checks are not performed when looking for compressed variants in the `FileResponse` class, and symbolic links are then automatically followed when performing the `Path.stat()` and `Path.open()` to send the file. Version 3.10.2 contains a patch for the issue.

## Keyphrases
- **weakness**: 'path traversal'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3287 | 0.4176 | 0.3634 | 0.3623 | 20 |
| Sparse | 577.9802 | 1000.0000 | 673.4753 | 618.6892 | 10 |
| Graph | 1.3600 | 2.5073 | 1.7203 | 1.6410 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.5073 | Allowed |
| 2 | 363 | Race Condition Enabling Link Following | base | 2.2100 | Allowed |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | 2.1394 | Allowed |
| 4 | 427 | Uncontrolled Search Path Element | base | 2.1190 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 6 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0856 | Allowed |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 8 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 9 | 36 | Absolute Path Traversal | Base | 1.6608 | Allowed |
| 10 | 23 | Relative Path Traversal | Base | 1.6499 | Allowed |
| 11 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 12 | 426 | Untrusted Search Path | base | 1.5210 | Allowed |
| 13 | 73 | External Control of File Name or Path | Base | 1.4901 | Allowed |
| 14 | 24 | Path Traversal: '../filedir' | Variant | 1.4750 | Allowed |
| 15 | 25 | Path Traversal: '/../filedir' | Variant | 1.4649 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 36 | Absolute Path Traversal | Base | 0.4176 | 0.4176 | Allowed |
| 2 | 24 | Path Traversal: '../filedir' | Variant | 0.4094 | 0.4094 | Allowed |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.4079 | 0.4079 | Allowed |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 0.3893 | 0.3893 | Allowed |
| 5 | 25 | Path Traversal: '/../filedir' | Variant | 0.3891 | 0.3891 | Allowed |
| 6 | 49 | Path Equivalence: 'filename/' (Trailing Slash) | Variant | 0.3872 | 0.3872 | Allowed |
| 7 | 23 | Relative Path Traversal | Base | 0.3810 | 0.3810 | Allowed |
| 8 | 28 | Path Traversal: '..\filedir' | Variant | 0.3804 | 0.3804 | Allowed |
| 9 | 55 | Path Equivalence: '/./' (Single Dot Directory) | Variant | 0.3796 | 0.3796 | Allowed |
| 10 | 26 | Path Traversal: '/dir/../filename' | Variant | 0.3784 | 0.3784 | Allowed |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.3461 | 0.3461 | Allowed |
| 12 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.3391 | 0.3391 | Allowed |
| 13 | 50 | Path Equivalence: '//multiple/leading/slash' | Variant | 0.3385 | 0.3385 | Allowed |
| 14 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.3379 | 0.3379 | Allowed |
| 15 | 33 | Path Traversal: '....' (Multiple Dot) | Variant | 0.3345 | 0.3345 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 1000.0000 | 1000.0000 | Allowed |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | 763.0013 | 763.0013 | Allowed |
| 3 | 23 | Relative Path Traversal | 700.4005 | 700.4005 | Allowed |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | 668.4713 | 668.4713 | Allowed |
| 5 | 427 | Uncontrolled Search Path Element | 622.1143 | 622.1143 | Allowed |
| 6 | 36 | Absolute Path Traversal | 615.2641 | 615.2641 | Allowed |
| 7 | 73 | External Control of File Name or Path | 606.3540 | 606.3540 | Allowed |
| 8 | 41 | Improper Resolution of Path Equivalence | 600.0851 | 600.0851 | Allowed |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 581.0820 | 581.0820 | Allowed |
| 10 | 863 | Incorrect Authorization | 577.9802 | 577.9802 | Allowed-with-Review |
