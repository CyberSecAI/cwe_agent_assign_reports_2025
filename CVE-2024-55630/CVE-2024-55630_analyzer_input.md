# Vulnerability Information: CVE-2024-55630

## Vulnerability Description
Joplin is a free, open source note taking and to-do application, which can handle a large number of notes organised into notebooks. Joplins HTML sanitizer allows the `name` attribute to be specified. If `name` is set to the same value as an existing `document` property (e.g. `querySelector`), that property is replaced with the element. This vulnerabilitys only known impact is denial of service. The note viewer fails to refresh until closed and re-opened with a different note. This issue has been addressed in version 3.2.8 and all users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **name attribute**
- **impact:** denial of service
- **product:** Joplin
- **version:** prior to 3.2.8

## CVE Reference Links Content Summary
## Analysis of CVE-2024-55630 based on provided content:

**1. Verification:**

Both provided content snippets relate to CVE-2024-55630, as explicitly stated in the first snippet and confirmed by the commit message in the second.

**2. Extracted Information:**

**Root cause of vulnerability:**

*   Joplin's HTML sanitizer allows the `name` attribute to be specified in HTML tags.
*   Setting the `name` attribute to the same value as an existing `document` property (e.g., `querySelector`, `getElementById`) overwrites that property with the element. This is known as DOM clobbering.

**Weaknesses/vulnerabilities present:**

*   DOM Clobbering

**Impact of exploitation:**

*   Denial of Service (DoS): The note viewer fails to refresh until closed and reopened with a different note.  Most script interactions with the Markdown viewer fail with errors.

**Attack vectors:**

*   Creating a note with malicious content containing an `<img>` tag with a `name` attribute set to a DOM property (e.g., `<img name=getElementById src=x/>`).
*   Attempting to switch notes after creating the malicious note.

**Required attacker capabilities/position:**

*   The attacker needs to be able to create a note within the Joplin application.
*   No special privileges are required.
*   User interaction is required (the user must attempt to switch notes).

**Mitigation or fix:**

*   The commit `e70efcb` removes the `name` attribute when rendering HTML to prevent the DOM clobbering vulnerability. Specifically, the code in `packages/renderer/htmlUtils.ts` now deletes the `name` attribute if it exists in the attributes being processed.

**Additional Details (more than official CVE description):**

*   **Affected versions:** <= 3.2.3
*   **CVSS Score:** 3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L (Overall score: /10)
*   **PoC:** The provided content includes a Proof of Concept (PoC) demonstrating the vulnerability.
*   **Credits:** The vulnerability was reported by @personalizedrefrigerator.
*   The commit message references issue #11591, which likely contains further details about the fix.
*   The test case `sanitize_22.md` and `sanitize_22.html` demonstrate the vulnerability and the expected sanitization.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.545 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.522 |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.518 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.516 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.512 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.503 |
| 7 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.500 |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.500 |
| 9 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | dense | 0.444 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

