# Vulnerability Information: CVE-2024-58042

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved rhashtable Fix potential **deadlock** by moving schedule_work outside lock Move the hash table growth check and work scheduling outside the rht lock to prevent a possible circular locking dependency. The original implementation could trigger a lockdep warning due to a potential **deadlock** scenario involving nested locks between rhashtable bucket, rq lock, and dsq lock. By relocating the growth check and work scheduling after releasing the rth lock, we break this potential **deadlock** chain. This change expands the flexibility of rhashtable by removing restrictive locking that previously limited its use in scheduler and workqueue contexts. Import to say that this calls rht_grow_above_75(), which reads from struct rhashtable without holding the lock, if this is a problem, we can move the check to the lock, and schedule the workqueue after the lock. Modified so that atomic_inc is also moved outside of the bucket lock along with the growth above 75% check.

### Vulnerability Description Key Phrases
- **weakness:** **deadlock**
- **product:** Linux kernel
- **component:** rhashtable

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.921 |
| 2 | 833 | Deadlock | Base | Allowed | sparse | 0.827 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.700 |
| 4 | 412 | Unrestricted Externally Accessible Lock | Base | Allowed | sparse | 0.690 |
| 5 | 764 | Multiple Locks of a Critical Resource | Base | Allowed | sparse | 0.666 |
| 6 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.666 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.664 |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.663 |
| 9 | 413 | Improper Resource Locking | Base | Allowed | dense | 0.465 |
| 10 | 416 | Use After Free | Variant | Allowed | graph | 0.002 |

