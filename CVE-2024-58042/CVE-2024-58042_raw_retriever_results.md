# Raw Retriever Results for CVE-2024-58042

# Raw Retriever Results for CVE-2024-58042
## Query
In the Linux kernel, the following vulnerability has been resolved rhashtable Fix potential deadlock by moving schedule_work outside lock Move the hash table growth check and work scheduling outside the rht lock to prevent a possible circular locking dependency. The original implementation could trigger a lockdep warning due to a potential deadlock scenario involving nested locks between rhashtable bucket, rq lock, and dsq lock. By relocating the growth check and work scheduling after releasing the rth lock, we break this potential deadlock chain. This change expands the flexibility of rhashtable by removing restrictive locking that previously limited its use in scheduler and workqueue contexts. Import to say that this calls rht_grow_above_75(), which reads from struct rhashtable without holding the lock, if this is a problem, we can move the check to the lock, and schedule the workqueue after the lock. Modified so that atomic_inc is also moved outside of the bucket lock along with the growth above 75% check.

## Keyphrases
- **weakness**: 'deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4229 | 0.4929 | 0.4446 | 0.4412 | 20 |
| Sparse | 656.7010 | 921.3035 | 711.5376 | 665.9558 | 10 |
| Graph | 1.2010 | 2.4700 | 1.5899 | 1.5725 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 412 | Unrestricted Externally Accessible Lock | base | 2.4700 | Allowed |
| 2 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 4 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 5 | 833 | Deadlock | Base | 1.6883 | Allowed |
| 6 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 7 | 413 | Improper Resource Locking | Base | 1.6834 | Allowed |
| 8 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 9 | 764 | Multiple Locks of a Critical Resource | Base | 1.6676 | Allowed |
| 10 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 11 | 170 | Improper Null Termination | base | 1.5350 | Allowed |
| 12 | 410 | Insufficient Resource Pool | base | 1.5210 | Allowed |
| 13 | 476 | NULL Pointer Dereference | Base | 1.5150 | Allowed |
| 14 | 415 | Double Free | variant | 1.4784 | Allowed |
| 15 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 1.4701 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 667 | Improper Locking | Class | 0.4929 | 0.4929 | Allowed-with-Review |
| 2 | 833 | Deadlock | Base | 0.4879 | 0.4879 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4665 | 0.4665 | Allowed-with-Review |
| 4 | 413 | Improper Resource Locking | Base | 0.4654 | 0.4654 | Allowed |
| 5 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4564 | 0.4564 | Allowed |
| 6 | 606 | Unchecked Input for Loop Condition | Base | 0.4506 | 0.4506 | Allowed |
| 7 | 909 | Missing Initialization of Resource | Class | 0.4495 | 0.4495 | Allowed-with-Review |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4476 | 0.4476 | Allowed |
| 9 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4470 | 0.4470 | Allowed |
| 10 | 328 | Use of Weak Hash | Base | 0.4438 | 0.4438 | Allowed |
| 11 | 244 | Improper Clearing of Heap Memory Before Release ('Heap Inspection') | Variant | 0.4386 | 0.4386 | Allowed |
| 12 | 122 | Heap-based Buffer Overflow | Variant | 0.4310 | 0.4310 | Allowed |
| 13 | 366 | Race Condition within a Thread | Base | 0.4307 | 0.4307 | Allowed |
| 14 | 190 | Integer Overflow or Wraparound | Base | 0.4295 | 0.4295 | Allowed |
| 15 | 193 | Off-by-one Error | Base | 0.4294 | 0.4294 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 921.3035 | 921.3035 | Allowed-with-Review |
| 2 | 833 | Deadlock | 827.2101 | 827.2101 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 700.1515 | 700.1515 | Allowed-with-Review |
| 4 | 412 | Unrestricted Externally Accessible Lock | 690.3762 | 690.3762 | Allowed |
| 5 | 764 | Multiple Locks of a Critical Resource | 666.2089 | 666.2089 | Allowed |
| 6 | 319 | Cleartext Transmission of Sensitive Information | 665.7027 | 665.7027 | Allowed |
| 7 | 125 | Out-of-bounds Read | 663.8697 | 663.8697 | Allowed |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 662.6330 | 662.6330 | Allowed |
| 9 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | 661.2192 | 661.2192 | Allowed |
| 10 | 451 | User Interface (UI) Misrepresentation of Critical Information | 656.7010 | 656.7010 | Allowed-with-Review |
