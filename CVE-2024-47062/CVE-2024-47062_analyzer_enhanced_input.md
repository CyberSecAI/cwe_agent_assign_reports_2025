## Vulnerability Description
Navidrome is an open source web-based music collection server and streamer. Navidrome automatically adds parameters in the URL to SQL queries. This can be exploited to access information by adding parameters like `password=...` in the URL (ORM Leak). Furthermore, the names of the parameters are not properly escaped, leading to SQL Injections. Finally, the username is used in a `LIKE` statement, allowing people to log in with `%` instead of their username. When adding parameters to the URL, they are automatically included in an SQL `LIKE` statement (depending on the parameters name). This allows attackers to potentially retrieve arbitrary information. For example, attackers can use the following request to test whether some encrypted passwords start with `AAA`. This results in an SQL query like `password LIKE AAA%`, allowing attackers to slowly brute-force passwords. When adding parameters to the URL, they are automatically added to an SQL query. The names of the parameters are not properly escaped. This behavior can be used to inject arbitrary SQL code (SQL Injection). These vulnerabilities can be used to leak information and dump the contents of the database and have been addressed in release version 0.53.0. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **improper input escaping**
- **weakness:** **SQL injection**
- **impact:** information disclosure
- **product:** Navidrome
- **version:** prior to 0.53.0

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-47062.

**Root cause of vulnerability:**
The application automatically adds URL parameters to SQL queries without proper sanitization. This occurs in three distinct ways:
1.  URL parameters are included in SQL `LIKE` statements, enabling information leakage.
2.  URL parameter names are not escaped, allowing for SQL injection.
3.  Usernames used in a `LIKE` statement during authentication permit logins using wildcard characters like `%`.

**Weaknesses/vulnerabilities present:**
1.  **ORM Leak:**  Parameters passed in the URL are used in SQL LIKE statements, potentially exposing sensitive information by allowing partial string matches.
2.  **SQL Injection:** Parameter names from the URL are directly inserted into SQL queries without proper escaping, leading to SQL injection vulnerabilities.
3.  **Authentication Weakness:**  The use of a `LIKE` operator in the username lookup allows users to log in with wildcard characters, bypassing authentication.

**Impact of exploitation:**
1.  **ORM Leak:** Attackers can potentially retrieve arbitrary information, including sensitive data like password fragments, by exploiting the SQL `LIKE` statement behavior.
2.  **SQL Injections:** Attackers can inject arbitrary SQL code, leading to database compromise, data exfiltration, or other malicious activities.
3.  **Authentication Weakness:**  Attackers can bypass authentication by using the wildcard `%` as a username.

**Attack vectors:**
The attack vectors involve crafting malicious HTTP GET requests that include specific parameters in the URL.

**Required attacker capabilities/position:**
Attackers require a network connection to the vulnerable application and need to craft malicious URLs. They require low privileges to exploit the vulnerability and no user interaction is required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 1.241 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 1.133 |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 1.123 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 1.116 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 1.093 |
| 7 | 20 | Improper Input Validation | Class | Discouraged | sparse | 1.092 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 1.087 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.561 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-285: Improper Authorization

CWE-20: Improper Input Validation

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-790: Improper Filtering of Special Elements

CWE-117: Improper Output Neutralization for Logs