# Analysis Report for CVE-2024-52286

# Vulnerability Analysis Report: CVE-2024-52286

## Description

Stirling-PDF is a locally hosted web application that allows you to perform various operations on PDF files. In affected versions the Merge functionality takes untrusted user input (file name) and uses it directly in the creation of HTML pages allowing any unauthenticated to execute JavaScript code in the context of the user. The issue stems to the code starting at `Line 24` in `src/main/resources/static/js/merge.js`. The file name is directly being input into InnerHTML with no sanitization on the file name, allowing a malicious user to be able to upload files with names containing HTML tags. As HTML tags can include JavaScript code, this can be used to execute JavaScript code in the context of the user. This is a self-injection style attack and relies on a user uploading the malicious file themselves and it impact only them, not other users. A user might be social engineered into running this to launch a phishing attack. Nevertheless, this breaks the expected security restrictions in place by the application. This issue has been addressed in version 0.32.0 and all users are advised to upgrade. There are no known workarounds for this vulnerability.

## Vulnerability Description Key Phrases

- **Rootcause:** improper input sanitization
- **Impact:** ['execute JavaScript code', 'phishing attack', 'upload files']
- **Attacker:** unauthenticated user
- **Product:** Stirling-PDF
- **Version:** before 0.32.0
- **Component:** Merge functionality

## Analysis (with Relationship Data)

# Summary

| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |
|---|---|---|---|---|---|
| CWE-79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1.0 | Base | Allowed | Primary CWE |
| CWE-434 | Unrestricted Upload of File with Dangerous Type | 0.7 | Base | Allowed | Secondary Candidate |

## Evidence and Confidence

*   **Confidence Score:** 0.9
*   **Evidence Strength:** HIGH

## Relationship Analysis
The primary relationship is that **Improper Input Neutralization (CWE-79)** can be caused by **Unrestricted Upload of File with Dangerous Type (CWE-434)** if the application doesn't validate file types or sanitize names upon upload. CWE-79 is a base level CWE, appropriate since the description clearly points to XSS due to unsanitized input within web page generation.

```mermaid
graph TD
    cwe79["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"]
    cwe434["CWE-434: Unrestricted Upload of File with Dangerous Type"]
    
    cwe79 <--|CANFOLLOW| cwe434

    classDef primary fill:#f96,stroke:#333,stroke-width:2px
    classDef secondary fill:#69f,stroke:#333
    class cwe79 primary
    class cwe434 secondary
```

## Vulnerability Chain
1.  **Root Cause:** **Improper input sanitization** of file names during file upload (**CWE-434**)
2.  **Weakness:** The unsanitized file name is then used directly in the creation of HTML pages.
3.  **Impact:** Execution of JavaScript code in the context of the user (**CWE-79**) and potential phishing attacks.

## Summary of Analysis
The primary weakness is **CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')** because the vulnerability description specifically states that the file name is directly input into InnerHTML with no sanitization, allowing a malicious user to upload files with names containing HTML tags. This allows JavaScript code to be executed in the context of the user. The "CVE Reference Links Content Summary" section also confirms this by stating that there is a "Lack of sanitization of user-supplied data" and a "Cross-Site Scripting (XSS) vulnerability."

The secondary weakness to consider is **CWE-434 Unrestricted Upload of File with Dangerous Type**. While the primary issue is the lack of sanitization (CWE-79), the fact that the application allows arbitrary file uploads, including those with potentially malicious names, contributes to the vulnerability. Specifically, the "CVE Reference Links Content Summary" section indicates that the "Attack vectors" include "Uploading a file with a malicious filename containing HTML tags". Thus, CWE-434 is a valid, albeit secondary, consideration.

The retriever results support these findings, with CWE-79 having the highest score. The graph relationships also support this, with CWE-434 potentially preceding CWE-79.

Other CWEs were considered but deemed less relevant:

*   CWE-138, CWE-116, CWE-94, CWE-1336, CWE-1321, CWE-1333, CWE-863, CWE-830: These are less directly related to the core issue of XSS due to unsanitized file names. For example, CWE-94 is about code injection, but the vulnerability is more directly about injecting HTML/JavaScript via a file name.

The selected CWEs are at the optimal level of specificity. CWE-79 is a base CWE that accurately describes the XSS vulnerability. CWE-434 describes how malicious files can be uploaded and lead to the XSS.


## CWE Relationship Analysis

Current CWEs represent these abstraction levels: .


### Vulnerability Chain Analysis

**Chain starting from CWE-863:**
- 863 (Incorrect Authorization) - ROOT


**Chain starting from CWE-116:**
- 116 (Improper Encoding or Escaping of Output) - ROOT



### CWE Relationship Diagram

```mermaid
graph TD
    classDef primary fill:#f96,stroke:#333,stroke-width:2px
    classDef secondary fill:#69f,stroke:#333
    classDef tertiary fill:#9e9,stroke:#333
```



*Report generated on 2025-07-13 21:08:05*
