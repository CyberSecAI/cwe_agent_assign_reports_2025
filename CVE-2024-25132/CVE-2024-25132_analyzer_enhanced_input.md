## Vulnerability Description
A flaw was found in the Hive hibernation controller component of OpenShift Dedicated. The ClusterDeployment.hive.openshift.io/v1 resource can be created with the spec.installed field set to true, regardless of the installation status, and a positive timespan for the spec.hibernateAfter value. If a ClusterSync.hiveinternal.openshift.io/v1alpha1 resource is also created, the hive hibernation controller will enter the reconciliation loop leading to a panic when **accessing a non-existing field in the ClusterDeployments status section**, resulting in a denial of service.

### Vulnerability Description Key Phrases
- **component:** Hive hibernation controller
- **rootcause:** **accessing a non-existing field in the ClusterDeployments status section**
- **product:** OpenShift Dedicated
- **impact:** denial of service, panic

## CVE Reference Links Content Summary
CVE-2024-25132 is related to the content. Here's the extracted information:

**Root cause of vulnerability:**

The `hive-controllers` pod in the `hive` namespace crashes due to a panic when reconciling `ClusterDeployment.hive.openshift.io/v1` resources with specific configurations (spec.installed=true and a positive spec.hibernateAfter timespan) alongside a `ClusterSync.hiveinternal.openshift.io/v1alpha1` resource. The panic occurs when accessing a non-existing field in the `ClusterDeployment`â€™s status section.

**Weaknesses/vulnerabilities present:**

*   Denial of Service (DoS)
*   Null pointer dereference/accessing non-existing fields.

**Impact of exploitation:**

*   The `hive hibernation controller` enters a `CrashLoopBackOff` state, causing a persistent denial of service.
*   All other controllers bundled within the `hive controller` become unavailable.

**Attack vectors:**

*   Creating a `ClusterDeployment.hive.openshift.io/v1` resource with `spec.installed` set to true and a positive `spec.hibernateAfter` value.
*   Creating a `ClusterSync.hiveinternal.openshift.io/v1alpha1` resource.
*   Bypassing Managed Resources Admission Webhook (F-02 Bypass).

**Required attacker capabilities/position:**

*   Developer privileges are required to create the necessary resources.

**Mitigation or fix:**

*   Check if the fields used by the controller on user-controlled objects are present before accessing them.

**Additional details (more than official CVE description):**

*   The issue was observed in a testing environment where hive components were co-located on a single cluster, and it's unclear if the behavior is reproducible in a standard deployment.
*   The bug is assigned to the "Product Security" team.
*   The bug is classified as "Security Response" -> "vulnerability" with medium priority and severity.
*   The bug blocks bug 2258855.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.491 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.487 |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.479 |
| 4 | 283 | Unverified Ownership | Base | Allowed | sparse | 0.474 |
| 5 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.473 |
| 6 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.471 |
| 7 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.470 |
| 8 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.467 |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.451 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-863: Incorrect Authorization

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-283: Unverified Ownership

CWE-667: Improper Locking

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-208: Observable Timing Discrepancy

CWE-400: Uncontrolled Resource Consumption

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-73: External Control of File Name or Path