# Vulnerability Information: CVE-2024-57184

## Vulnerability Description
An issue was discovered in GPAC v0.8.0, as demonstrated by MP4Box. It contains a **heap-based buffer overflow** in gf_m2ts_process_pmt in media_tools/mpegts.c2163 that can cause a denial of service (DOS) via a crafted MP4 file.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **impact:** denial of service (DOS)
- **vector:** crafted MP4 file
- **product:** GPAC
- **version:** v0.8.0
- **component:** gf_m2ts_process_pmt in media_tools/mpegts.c2163

## CVE Reference Links Content Summary
CVE-2024-57184: PLACEHOLDER - Implement CVE description retrieval

===CONTENT to ANALYZE===

**Content from github.com_392dc87e_20250624_193922.html (stripped)**

This content is about the GPAC project and its features, including security features. It doesn't contain any vulnerability information related to a CVE.

**Content from github.com_e75b0b0e_20250624_193924.html (stripped)**

This content details a heap-buffer-overflow vulnerability (AddressSanitizer report) in GPAC, specifically in `media_tools/mpegts.c` at line 2163 within the `gf_m2ts_process_pmt` function.

*   **Root cause of vulnerability:** Heap-buffer-overflow. The code reads beyond the allocated buffer size.
*   **Weaknesses/vulnerabilities present:** Heap buffer overflow.
*   **Impact of exploitation:**  The ASan report indicates a memory corruption issue, potentially leading to crashes or arbitrary code execution.
*   **Attack vectors:** The vulnerability is triggered when processing MPEG-TS packets, specifically during PMT (Program Map Table) processing. The provided run command `./MP4Box -dash 1000 crsh1` demonstrates a way to trigger the issue.
*   **Required attacker capabilities/position:** An attacker can provide a crafted MPEG-TS stream (e.g., through a file or network stream) that triggers the vulnerability. No specific privileges are required beyond the ability to provide input to MP4Box.
*   **Mitigation or fix:** The provided information does not include a fix. The issue was reported on Feb 29, 2020, and the commit referenced (8c5e847) in the first content snippet may contain a fix, but this is not explicitly stated. The commit message mentions fixing bugs/leaks in m2tsfuzz.

The provided GDB info points to the vulnerable line of code: `if (es->stream_type == GF_M2TS_VIDEO_HEVC) nb_hevc++;` within the `gf_m2ts_process_pmt` function.

This content provides more detail than a typical CVE description, including the specific file, function, and line number where the vulnerability occurs, as well as the ASan report and GDB backtrace.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.329 |
| 4 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.301 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.288 |
| 6 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.274 |
| 7 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.265 |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.258 |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | dense | 0.553 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

