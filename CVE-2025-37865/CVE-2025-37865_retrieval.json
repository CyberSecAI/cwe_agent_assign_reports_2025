{
  "vulnerability_info": "VulnerabilityInfo(cve_id='CVE-2025-37865', description='In the Linux kernel, the following vulnerability has been resolved net dsa mv88e6xxx fix -ENOENT when deleting VLANs and MST is unsupported Russell King reports that on the ZII dev rev B, deleting a bridge VLAN from a user port fails with -ENOENT https//lore.kernel.org/netdev/Z_lQXNP0s5-IiJzd@shell.armlinux.org.uk/ This comes from mv88e6xxx_port_vlan_leave() -> mv88e6xxx_mst_put(), which tries to find an MST entry in &chip->msts associated with the SID, but fails and returns -ENOENT as such. But we know that this chip does not support MST at all, so that is not surprising. The question is why does the guard in mv88e6xxx_mst_put() not exit early if (!sid) return 0 And the answer seems to be simple the sid comes from vlan.sid which supposedly was previously populated by mv88e6xxx_vtu_get(). But some chip->info->ops->vtu_getnext() implementations do not populate vlan.sid, for example see mv88e6185_g1_vtu_getnext(). In that case, later in mv88e6xxx_port_vlan_leave() we are using a **garbage sid** which is just residual stack memory. Testing for sid == 0 covers all cases of a non-bridge VLAN or a bridge VLAN mapped to the default MSTI. For some chips, SID 0 is valid and installed by mv88e6xxx_stu_setup(). A chip which does not support the STU would implicitly only support mapping all VLANs to the default MSTI, so although SID 0 is not valid, it would be sufficient, if we were to zero-initialize the vlan structure, to fix the bug, due to the coincidence that a test for vlan.sid == 0 already exists and leads to the same (correct) behavior. Another option which would be sufficient would be to add a test for mv88e6xxx_has_stu() inside mv88e6xxx_mst_put(), symmetric to the one which already exists in mv88e6xxx_mst_get(). But that placement means the caller will have to dereference vlan.sid, which means it will access **uninitialized memory**, which is not nice even if it ignores it later. So we end up making both modifications, in order to not rely just on the sid == 0 coincidence, but also to avoid having uninitialized structure fields which might get temporarily accessed.', key_phrases={'rootcause': ['uninitialized memory', 'garbage sid'], 'weakness': 'uninitialized stack memory', 'impact': '-ENOENT when deleting VLANs', 'vector': '', 'attacker': '', 'product': 'Linux kernel', 'version': '', 'component': 'net dsa mv88e6xxx'}, reference_content=None, similar_info={'cwe_distribution': {}, 'cwe_consensus': '', 'similarity_stats': {'thresholds': [], 'total_samples_by_threshold': {}, 'top_cwes_by_threshold': {}}}, similarity_summary=SimilarityInsight(consensus_cwe='', top_cwes=[], confidence_levels={}, total_samples=0), analysis='', analysis_with_relationships='', criticism='', resolution='', relevant_cwes=[{'metadata': {'doc_id': '824', 'name': 'Access of Uninitialized Pointer', 'source': 'sparse', 'original_content': 'The product accesses or uses a pointer that has not been initialized.', 'keyphrase_sources': [{'id': 'rootcause:uninitialized memory', 'keyphrase': 'uninitialized memory', 'type': 'rootcause'}, {'id': 'rootcause:garbage sid', 'keyphrase': 'garbage sid', 'type': 'rootcause'}, {'id': 'weakness:uninitialized stack memory', 'keyphrase': 'uninitialized stack memory', 'type': 'weakness'}, {'id': 'impact:-ENOENT when deleting VLANs', 'keyphrase': '-ENOENT when deleting VLANs', 'type': 'impact'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'component:net dsa mv88e6xxx', 'keyphrase': 'net dsa mv88e6xxx', 'type': 'component'}]}, 'similarity': np.float64(1557.2627180676968)}, {'metadata': {'doc_id': '863', 'name': 'Incorrect Authorization', 'source': 'sparse', 'original_content': 'The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.', 'keyphrase_sources': [{'id': 'rootcause:uninitialized memory', 'keyphrase': 'uninitialized memory', 'type': 'rootcause'}, {'id': 'rootcause:garbage sid', 'keyphrase': 'garbage sid', 'type': 'rootcause'}, {'id': 'weakness:uninitialized stack memory', 'keyphrase': 'uninitialized stack memory', 'type': 'weakness'}, {'id': 'impact:-ENOENT when deleting VLANs', 'keyphrase': '-ENOENT when deleting VLANs', 'type': 'impact'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'component:net dsa mv88e6xxx', 'keyphrase': 'net dsa mv88e6xxx', 'type': 'component'}]}, 'similarity': np.float64(1535.9098440591088)}, {'metadata': {'doc_id': '909', 'name': 'Missing Initialization of Resource', 'source': 'sparse', 'original_content': 'The product does not initialize a critical resource.', 'keyphrase_sources': [{'id': 'rootcause:uninitialized memory', 'keyphrase': 'uninitialized memory', 'type': 'rootcause'}, {'id': 'rootcause:garbage sid', 'keyphrase': 'garbage sid', 'type': 'rootcause'}, {'id': 'weakness:uninitialized stack memory', 'keyphrase': 'uninitialized stack memory', 'type': 'weakness'}, {'id': 'impact:-ENOENT when deleting VLANs', 'keyphrase': '-ENOENT when deleting VLANs', 'type': 'impact'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'component:net dsa mv88e6xxx', 'keyphrase': 'net dsa mv88e6xxx', 'type': 'component'}]}, 'similarity': np.float64(1530.1138722767237)}, {'metadata': {'doc_id': '476', 'name': 'NULL Pointer Dereference', 'source': 'sparse', 'original_content': 'The product dereferences a pointer that it expects to be valid but is NULL.', 'keyphrase_sources': [{'id': 'rootcause:uninitialized memory', 'keyphrase': 'uninitialized memory', 'type': 'rootcause'}]}, 'similarity': np.float64(1484.996965202105)}, {'metadata': {'doc_id': '125', 'name': 'Out-of-bounds Read', 'source': 'sparse', 'original_content': 'The product reads data past the end, or before the beginning, of the intended buffer.', 'keyphrase_sources': [{'id': 'rootcause:uninitialized memory', 'keyphrase': 'uninitialized memory', 'type': 'rootcause'}, {'id': 'weakness:uninitialized stack memory', 'keyphrase': 'uninitialized stack memory', 'type': 'weakness'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'component:net dsa mv88e6xxx', 'keyphrase': 'net dsa mv88e6xxx', 'type': 'component'}]}, 'similarity': np.float64(1483.9446902865634)}, {'metadata': {'doc_id': '923', 'name': 'Improper Restriction of Communication Channel to Intended Endpoints', 'source': 'sparse', 'original_content': 'The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint.', 'keyphrase_sources': [{'id': 'rootcause:garbage sid', 'keyphrase': 'garbage sid', 'type': 'rootcause'}, {'id': 'impact:-ENOENT when deleting VLANs', 'keyphrase': '-ENOENT when deleting VLANs', 'type': 'impact'}, {'id': 'product:Linux kernel', 'keyphrase': 'Linux kernel', 'type': 'product'}, {'id': 'component:net dsa mv88e6xxx', 'keyphrase': 'net dsa mv88e6xxx', 'type': 'component'}]}, 'similarity': np.float64(1481.9922739903877)}, {'metadata': {'doc_id': '212', 'name': 'Improper Removal of Sensitive Information Before Storage or Transfer', 'source': 'sparse', 'original_content': 'The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors.', 'keyphrase_sources': [{'id': 'rootcause:garbage sid', 'keyphrase': 'garbage sid', 'type': 'rootcause'}, {'id': 'impact:-ENOENT when deleting VLANs', 'keyphrase': '-ENOENT when deleting VLANs', 'type': 'impact'}]}, 'similarity': np.float64(1461.8239415697499)}, {'metadata': {'doc_id': '1284', 'name': 'Improper Validation of Specified Quantity in Input', 'source': 'sparse', 'original_content': 'The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.', 'keyphrase_sources': [{'id': 'weakness:uninitialized stack memory', 'keyphrase': 'uninitialized stack memory', 'type': 'weakness'}]}, 'similarity': np.float64(1389.2778473619685)}], identified_cwes={'analyzer': [], 'critic_additional': []})",
  "retrieval_results": {
    "has_multiple_keyphrases": true,
    "keyphrase_cwe_sets": {
      "rootcause:uninitialized memory": {
        "keyphrase": "uninitialized memory",
        "type": "rootcause",
        "cwes": [
          {
            "metadata": {
              "doc_id": "824",
              "name": "Access of Uninitialized Pointer",
              "source": "sparse",
              "original_content": "The product accesses or uses a pointer that has not been initialized.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:uninitialized memory",
                  "keyphrase": "uninitialized memory",
                  "type": "rootcause"
                },
                {
                  "id": "rootcause:garbage sid",
                  "keyphrase": "garbage sid",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:uninitialized stack memory",
                  "keyphrase": "uninitialized stack memory",
                  "type": "weakness"
                },
                {
                  "id": "impact:-ENOENT when deleting VLANs",
                  "keyphrase": "-ENOENT when deleting VLANs",
                  "type": "impact"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "component:net dsa mv88e6xxx",
                  "keyphrase": "net dsa mv88e6xxx",
                  "type": "component"
                }
              ]
            },
            "similarity": 1557.2627180676968
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:uninitialized memory",
                  "keyphrase": "uninitialized memory",
                  "type": "rootcause"
                },
                {
                  "id": "rootcause:garbage sid",
                  "keyphrase": "garbage sid",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:uninitialized stack memory",
                  "keyphrase": "uninitialized stack memory",
                  "type": "weakness"
                },
                {
                  "id": "impact:-ENOENT when deleting VLANs",
                  "keyphrase": "-ENOENT when deleting VLANs",
                  "type": "impact"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "component:net dsa mv88e6xxx",
                  "keyphrase": "net dsa mv88e6xxx",
                  "type": "component"
                }
              ]
            },
            "similarity": 1535.9098440591088
          },
          {
            "metadata": {
              "doc_id": "909",
              "name": "Missing Initialization of Resource",
              "source": "sparse",
              "original_content": "The product does not initialize a critical resource.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:uninitialized memory",
                  "keyphrase": "uninitialized memory",
                  "type": "rootcause"
                },
                {
                  "id": "rootcause:garbage sid",
                  "keyphrase": "garbage sid",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:uninitialized stack memory",
                  "keyphrase": "uninitialized stack memory",
                  "type": "weakness"
                },
                {
                  "id": "impact:-ENOENT when deleting VLANs",
                  "keyphrase": "-ENOENT when deleting VLANs",
                  "type": "impact"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "component:net dsa mv88e6xxx",
                  "keyphrase": "net dsa mv88e6xxx",
                  "type": "component"
                }
              ]
            },
            "similarity": 1530.1138722767237
          },
          {
            "metadata": {
              "doc_id": "476",
              "name": "NULL Pointer Dereference",
              "source": "sparse",
              "original_content": "The product dereferences a pointer that it expects to be valid but is NULL.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:uninitialized memory",
                  "keyphrase": "uninitialized memory",
                  "type": "rootcause"
                }
              ]
            },
            "similarity": 1484.996965202105
          },
          {
            "metadata": {
              "doc_id": "125",
              "name": "Out-of-bounds Read",
              "source": "sparse",
              "original_content": "The product reads data past the end, or before the beginning, of the intended buffer.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:uninitialized memory",
                  "keyphrase": "uninitialized memory",
                  "type": "rootcause"
                },
                {
                  "id": "weakness:uninitialized stack memory",
                  "keyphrase": "uninitialized stack memory",
                  "type": "weakness"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "component:net dsa mv88e6xxx",
                  "keyphrase": "net dsa mv88e6xxx",
                  "type": "component"
                }
              ]
            },
            "similarity": 1483.9446902865634
          }
        ]
      },
      "rootcause:garbage sid": {
        "keyphrase": "garbage sid",
        "type": "rootcause",
        "cwes": [
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 1529.8769375516392
          },
          {
            "metadata": {
              "doc_id": "824",
              "name": "Access of Uninitialized Pointer",
              "source": "sparse",
              "original_content": "The product accesses or uses a pointer that has not been initialized."
            },
            "similarity": 1495.1274440075351
          },
          {
            "metadata": {
              "doc_id": "923",
              "name": "Improper Restriction of Communication Channel to Intended Endpoints",
              "source": "sparse",
              "original_content": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:garbage sid",
                  "keyphrase": "garbage sid",
                  "type": "rootcause"
                },
                {
                  "id": "impact:-ENOENT when deleting VLANs",
                  "keyphrase": "-ENOENT when deleting VLANs",
                  "type": "impact"
                },
                {
                  "id": "product:Linux kernel",
                  "keyphrase": "Linux kernel",
                  "type": "product"
                },
                {
                  "id": "component:net dsa mv88e6xxx",
                  "keyphrase": "net dsa mv88e6xxx",
                  "type": "component"
                }
              ]
            },
            "similarity": 1481.9922739903877
          },
          {
            "metadata": {
              "doc_id": "909",
              "name": "Missing Initialization of Resource",
              "source": "sparse",
              "original_content": "The product does not initialize a critical resource."
            },
            "similarity": 1468.9880367994201
          },
          {
            "metadata": {
              "doc_id": "212",
              "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
              "source": "sparse",
              "original_content": "The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors.",
              "keyphrase_sources": [
                {
                  "id": "rootcause:garbage sid",
                  "keyphrase": "garbage sid",
                  "type": "rootcause"
                },
                {
                  "id": "impact:-ENOENT when deleting VLANs",
                  "keyphrase": "-ENOENT when deleting VLANs",
                  "type": "impact"
                }
              ]
            },
            "similarity": 1461.8239415697499
          }
        ]
      },
      "weakness:uninitialized stack memory": {
        "keyphrase": "uninitialized stack memory",
        "type": "weakness",
        "cwes": [
          {
            "metadata": {
              "doc_id": "824",
              "name": "Access of Uninitialized Pointer",
              "source": "sparse",
              "original_content": "The product accesses or uses a pointer that has not been initialized."
            },
            "similarity": 1463.3983802999298
          },
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 1434.8974951852165
          },
          {
            "metadata": {
              "doc_id": "909",
              "name": "Missing Initialization of Resource",
              "source": "sparse",
              "original_content": "The product does not initialize a critical resource."
            },
            "similarity": 1428.1062807916085
          },
          {
            "metadata": {
              "doc_id": "125",
              "name": "Out-of-bounds Read",
              "source": "sparse",
              "original_content": "The product reads data past the end, or before the beginning, of the intended buffer."
            },
            "similarity": 1401.8904494627711
          },
          {
            "metadata": {
              "doc_id": "1284",
              "name": "Improper Validation of Specified Quantity in Input",
              "source": "sparse",
              "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
              "keyphrase_sources": [
                {
                  "id": "weakness:uninitialized stack memory",
                  "keyphrase": "uninitialized stack memory",
                  "type": "weakness"
                }
              ]
            },
            "similarity": 1389.2778473619685
          }
        ]
      },
      "impact:-ENOENT when deleting VLANs": {
        "keyphrase": "-ENOENT when deleting VLANs",
        "type": "impact",
        "cwes": [
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 515.3233534698668
          },
          {
            "metadata": {
              "doc_id": "824",
              "name": "Access of Uninitialized Pointer",
              "source": "sparse",
              "original_content": "The product accesses or uses a pointer that has not been initialized."
            },
            "similarity": 500.6027687564405
          },
          {
            "metadata": {
              "doc_id": "923",
              "name": "Improper Restriction of Communication Channel to Intended Endpoints",
              "source": "sparse",
              "original_content": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint."
            },
            "similarity": 498.9954468309621
          },
          {
            "metadata": {
              "doc_id": "909",
              "name": "Missing Initialization of Resource",
              "source": "sparse",
              "original_content": "The product does not initialize a critical resource."
            },
            "similarity": 495.71643209877163
          },
          {
            "metadata": {
              "doc_id": "212",
              "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
              "source": "sparse",
              "original_content": "The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors."
            },
            "similarity": 492.63266618574085
          }
        ]
      },
      "product:Linux kernel": {
        "keyphrase": "Linux kernel",
        "type": "product",
        "cwes": [
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 512.9344393507134
          },
          {
            "metadata": {
              "doc_id": "909",
              "name": "Missing Initialization of Resource",
              "source": "sparse",
              "original_content": "The product does not initialize a critical resource."
            },
            "similarity": 506.1234324596197
          },
          {
            "metadata": {
              "doc_id": "824",
              "name": "Access of Uninitialized Pointer",
              "source": "sparse",
              "original_content": "The product accesses or uses a pointer that has not been initialized."
            },
            "similarity": 498.3758146691784
          },
          {
            "metadata": {
              "doc_id": "923",
              "name": "Improper Restriction of Communication Channel to Intended Endpoints",
              "source": "sparse",
              "original_content": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint."
            },
            "similarity": 496.56030011011376
          },
          {
            "metadata": {
              "doc_id": "125",
              "name": "Out-of-bounds Read",
              "source": "sparse",
              "original_content": "The product reads data past the end, or before the beginning, of the intended buffer."
            },
            "similarity": 494.9809420217406
          }
        ]
      },
      "component:net dsa mv88e6xxx": {
        "keyphrase": "net dsa mv88e6xxx",
        "type": "component",
        "cwes": [
          {
            "metadata": {
              "doc_id": "863",
              "name": "Incorrect Authorization",
              "source": "sparse",
              "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check."
            },
            "similarity": 510.5020363792441
          },
          {
            "metadata": {
              "doc_id": "824",
              "name": "Access of Uninitialized Pointer",
              "source": "sparse",
              "original_content": "The product accesses or uses a pointer that has not been initialized."
            },
            "similarity": 498.3758146691784
          },
          {
            "metadata": {
              "doc_id": "909",
              "name": "Missing Initialization of Resource",
              "source": "sparse",
              "original_content": "The product does not initialize a critical resource."
            },
            "similarity": 497.8530437969174
          },
          {
            "metadata": {
              "doc_id": "923",
              "name": "Improper Restriction of Communication Channel to Intended Endpoints",
              "source": "sparse",
              "original_content": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint."
            },
            "similarity": 497.35996287884893
          },
          {
            "metadata": {
              "doc_id": "125",
              "name": "Out-of-bounds Read",
              "source": "sparse",
              "original_content": "The product reads data past the end, or before the beginning, of the intended buffer."
            },
            "similarity": 488.674736833411
          }
        ]
      }
    },
    "keyphrase_mapping": {
      "824": [
        {
          "id": "rootcause:uninitialized memory",
          "keyphrase": "uninitialized memory",
          "type": "rootcause"
        },
        {
          "id": "rootcause:garbage sid",
          "keyphrase": "garbage sid",
          "type": "rootcause"
        },
        {
          "id": "weakness:uninitialized stack memory",
          "keyphrase": "uninitialized stack memory",
          "type": "weakness"
        },
        {
          "id": "impact:-ENOENT when deleting VLANs",
          "keyphrase": "-ENOENT when deleting VLANs",
          "type": "impact"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "component:net dsa mv88e6xxx",
          "keyphrase": "net dsa mv88e6xxx",
          "type": "component"
        }
      ],
      "863": [
        {
          "id": "rootcause:uninitialized memory",
          "keyphrase": "uninitialized memory",
          "type": "rootcause"
        },
        {
          "id": "rootcause:garbage sid",
          "keyphrase": "garbage sid",
          "type": "rootcause"
        },
        {
          "id": "weakness:uninitialized stack memory",
          "keyphrase": "uninitialized stack memory",
          "type": "weakness"
        },
        {
          "id": "impact:-ENOENT when deleting VLANs",
          "keyphrase": "-ENOENT when deleting VLANs",
          "type": "impact"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "component:net dsa mv88e6xxx",
          "keyphrase": "net dsa mv88e6xxx",
          "type": "component"
        }
      ],
      "909": [
        {
          "id": "rootcause:uninitialized memory",
          "keyphrase": "uninitialized memory",
          "type": "rootcause"
        },
        {
          "id": "rootcause:garbage sid",
          "keyphrase": "garbage sid",
          "type": "rootcause"
        },
        {
          "id": "weakness:uninitialized stack memory",
          "keyphrase": "uninitialized stack memory",
          "type": "weakness"
        },
        {
          "id": "impact:-ENOENT when deleting VLANs",
          "keyphrase": "-ENOENT when deleting VLANs",
          "type": "impact"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "component:net dsa mv88e6xxx",
          "keyphrase": "net dsa mv88e6xxx",
          "type": "component"
        }
      ],
      "476": [
        {
          "id": "rootcause:uninitialized memory",
          "keyphrase": "uninitialized memory",
          "type": "rootcause"
        }
      ],
      "125": [
        {
          "id": "rootcause:uninitialized memory",
          "keyphrase": "uninitialized memory",
          "type": "rootcause"
        },
        {
          "id": "weakness:uninitialized stack memory",
          "keyphrase": "uninitialized stack memory",
          "type": "weakness"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "component:net dsa mv88e6xxx",
          "keyphrase": "net dsa mv88e6xxx",
          "type": "component"
        }
      ],
      "923": [
        {
          "id": "rootcause:garbage sid",
          "keyphrase": "garbage sid",
          "type": "rootcause"
        },
        {
          "id": "impact:-ENOENT when deleting VLANs",
          "keyphrase": "-ENOENT when deleting VLANs",
          "type": "impact"
        },
        {
          "id": "product:Linux kernel",
          "keyphrase": "Linux kernel",
          "type": "product"
        },
        {
          "id": "component:net dsa mv88e6xxx",
          "keyphrase": "net dsa mv88e6xxx",
          "type": "component"
        }
      ],
      "212": [
        {
          "id": "rootcause:garbage sid",
          "keyphrase": "garbage sid",
          "type": "rootcause"
        },
        {
          "id": "impact:-ENOENT when deleting VLANs",
          "keyphrase": "-ENOENT when deleting VLANs",
          "type": "impact"
        }
      ],
      "1284": [
        {
          "id": "weakness:uninitialized stack memory",
          "keyphrase": "uninitialized stack memory",
          "type": "weakness"
        }
      ]
    },
    "relevant_cwes": [
      {
        "metadata": {
          "doc_id": "824",
          "name": "Access of Uninitialized Pointer",
          "source": "sparse",
          "original_content": "The product accesses or uses a pointer that has not been initialized.",
          "keyphrase_sources": [
            {
              "id": "rootcause:uninitialized memory",
              "keyphrase": "uninitialized memory",
              "type": "rootcause"
            },
            {
              "id": "rootcause:garbage sid",
              "keyphrase": "garbage sid",
              "type": "rootcause"
            },
            {
              "id": "weakness:uninitialized stack memory",
              "keyphrase": "uninitialized stack memory",
              "type": "weakness"
            },
            {
              "id": "impact:-ENOENT when deleting VLANs",
              "keyphrase": "-ENOENT when deleting VLANs",
              "type": "impact"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "component:net dsa mv88e6xxx",
              "keyphrase": "net dsa mv88e6xxx",
              "type": "component"
            }
          ]
        },
        "similarity": 1557.2627180676968
      },
      {
        "metadata": {
          "doc_id": "863",
          "name": "Incorrect Authorization",
          "source": "sparse",
          "original_content": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.",
          "keyphrase_sources": [
            {
              "id": "rootcause:uninitialized memory",
              "keyphrase": "uninitialized memory",
              "type": "rootcause"
            },
            {
              "id": "rootcause:garbage sid",
              "keyphrase": "garbage sid",
              "type": "rootcause"
            },
            {
              "id": "weakness:uninitialized stack memory",
              "keyphrase": "uninitialized stack memory",
              "type": "weakness"
            },
            {
              "id": "impact:-ENOENT when deleting VLANs",
              "keyphrase": "-ENOENT when deleting VLANs",
              "type": "impact"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "component:net dsa mv88e6xxx",
              "keyphrase": "net dsa mv88e6xxx",
              "type": "component"
            }
          ]
        },
        "similarity": 1535.9098440591088
      },
      {
        "metadata": {
          "doc_id": "909",
          "name": "Missing Initialization of Resource",
          "source": "sparse",
          "original_content": "The product does not initialize a critical resource.",
          "keyphrase_sources": [
            {
              "id": "rootcause:uninitialized memory",
              "keyphrase": "uninitialized memory",
              "type": "rootcause"
            },
            {
              "id": "rootcause:garbage sid",
              "keyphrase": "garbage sid",
              "type": "rootcause"
            },
            {
              "id": "weakness:uninitialized stack memory",
              "keyphrase": "uninitialized stack memory",
              "type": "weakness"
            },
            {
              "id": "impact:-ENOENT when deleting VLANs",
              "keyphrase": "-ENOENT when deleting VLANs",
              "type": "impact"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "component:net dsa mv88e6xxx",
              "keyphrase": "net dsa mv88e6xxx",
              "type": "component"
            }
          ]
        },
        "similarity": 1530.1138722767237
      },
      {
        "metadata": {
          "doc_id": "476",
          "name": "NULL Pointer Dereference",
          "source": "sparse",
          "original_content": "The product dereferences a pointer that it expects to be valid but is NULL.",
          "keyphrase_sources": [
            {
              "id": "rootcause:uninitialized memory",
              "keyphrase": "uninitialized memory",
              "type": "rootcause"
            }
          ]
        },
        "similarity": 1484.996965202105
      },
      {
        "metadata": {
          "doc_id": "125",
          "name": "Out-of-bounds Read",
          "source": "sparse",
          "original_content": "The product reads data past the end, or before the beginning, of the intended buffer.",
          "keyphrase_sources": [
            {
              "id": "rootcause:uninitialized memory",
              "keyphrase": "uninitialized memory",
              "type": "rootcause"
            },
            {
              "id": "weakness:uninitialized stack memory",
              "keyphrase": "uninitialized stack memory",
              "type": "weakness"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "component:net dsa mv88e6xxx",
              "keyphrase": "net dsa mv88e6xxx",
              "type": "component"
            }
          ]
        },
        "similarity": 1483.9446902865634
      },
      {
        "metadata": {
          "doc_id": "923",
          "name": "Improper Restriction of Communication Channel to Intended Endpoints",
          "source": "sparse",
          "original_content": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint.",
          "keyphrase_sources": [
            {
              "id": "rootcause:garbage sid",
              "keyphrase": "garbage sid",
              "type": "rootcause"
            },
            {
              "id": "impact:-ENOENT when deleting VLANs",
              "keyphrase": "-ENOENT when deleting VLANs",
              "type": "impact"
            },
            {
              "id": "product:Linux kernel",
              "keyphrase": "Linux kernel",
              "type": "product"
            },
            {
              "id": "component:net dsa mv88e6xxx",
              "keyphrase": "net dsa mv88e6xxx",
              "type": "component"
            }
          ]
        },
        "similarity": 1481.9922739903877
      },
      {
        "metadata": {
          "doc_id": "212",
          "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
          "source": "sparse",
          "original_content": "The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors.",
          "keyphrase_sources": [
            {
              "id": "rootcause:garbage sid",
              "keyphrase": "garbage sid",
              "type": "rootcause"
            },
            {
              "id": "impact:-ENOENT when deleting VLANs",
              "keyphrase": "-ENOENT when deleting VLANs",
              "type": "impact"
            }
          ]
        },
        "similarity": 1461.8239415697499
      },
      {
        "metadata": {
          "doc_id": "1284",
          "name": "Improper Validation of Specified Quantity in Input",
          "source": "sparse",
          "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
          "keyphrase_sources": [
            {
              "id": "weakness:uninitialized stack memory",
              "keyphrase": "uninitialized stack memory",
              "type": "weakness"
            }
          ]
        },
        "similarity": 1389.2778473619685
      }
    ],
    "enhanced_query": "# Vulnerability Description\n\n    In the Linux kernel, the following vulnerability has been resolved net dsa mv88e6xxx fix -ENOENT when deleting VLANs and MST is unsupported Russell King reports that on the ZII dev rev B, deleting a bridge VLAN from a user port fails with -ENOENT https//lore.kernel.org/netdev/Z_lQXNP0s5-IiJzd@shell.armlinux.org.uk/ This comes from mv88e6xxx_port_vlan_leave() -> mv88e6xxx_mst_put(), which tries to find an MST entry in &chip->msts associated with the SID, but fails and returns -ENOENT as such. But we know that this chip does not support MST at all, so that is not surprising. The question is why does the guard in mv88e6xxx_mst_put() not exit early if (!sid) return 0 And the answer seems to be simple the sid comes from vlan.sid which supposedly was previously populated by mv88e6xxx_vtu_get(). But some chip->info->ops->vtu_getnext() implementations do not populate vlan.sid, for example see mv88e6185_g1_vtu_getnext(). In that case, later in mv88e6xxx_port_vlan_leave() we are using a **garbage sid** which is just residual stack memory. Testing for sid == 0 covers all cases of a non-bridge VLAN or a bridge VLAN mapped to the default MSTI. For some chips, SID 0 is valid and installed by mv88e6xxx_stu_setup(). A chip which does not support the STU would implicitly only support mapping all VLANs to the default MSTI, so although SID 0 is not valid, it would be sufficient, if we were to zero-initialize the vlan structure, to fix the bug, due to the coincidence that a test for vlan.sid == 0 already exists and leads to the same (correct) behavior. Another option which would be sufficient would be to add a test for mv88e6xxx_has_stu() inside mv88e6xxx_mst_put(), symmetric to the one which already exists in mv88e6xxx_mst_get(). But that placement means the caller will have to dereference vlan.sid, which means it will access **uninitialized memory**, which is not nice even if it ignores it later. So we end up making both modifications, in order to not rely just on the sid == 0 coincidence, but also to avoid having uninitialized structure fields which might get temporarily accessed.\n\n    # Keyphrase-Specific CWE Analysis\n    This vulnerability contains multiple keyphrases that may map to different CWEs. \n    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.\n\n    ## ROOTCAUSE: 'uninitialized memory'\n\nRelevant CWEs for this ROOTCAUSE:\n\n### 1. CWE-824: Access of Uninitialized Pointer (Score: 1557.26)\n\nThe product accesses or uses a pointer that has not been initialized....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1535.91)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-909: Missing Initialization of Resource (Score: 1530.11)\n\nThe product does not initialize a critical resource....\n\n### 4. CWE-476: NULL Pointer Dereference (Score: 1485.00)\n\nThe product dereferences a pointer that it expects to be valid but is NULL....\n\n### 5. CWE-125: Out-of-bounds Read (Score: 1483.94)\n\nThe product reads data past the end, or before the beginning, of the intended buffer....\n\n## ROOTCAUSE: 'garbage sid'\n\nRelevant CWEs for this ROOTCAUSE:\n\n### 1. CWE-824: Access of Uninitialized Pointer (Score: 1557.26)\n\nThe product accesses or uses a pointer that has not been initialized....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1535.91)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-909: Missing Initialization of Resource (Score: 1530.11)\n\nThe product does not initialize a critical resource....\n\n### 4. CWE-923: Improper Restriction of Communication Channel to Intended Endpoints (Score: 1481.99)\n\nThe product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint....\n\n### 5. CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer (Score: 1461.82)\n\nThe product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors....\n\n## WEAKNESS: 'uninitialized stack memory'\n\nRelevant CWEs for this WEAKNESS:\n\n### 1. CWE-824: Access of Uninitialized Pointer (Score: 1557.26)\n\nThe product accesses or uses a pointer that has not been initialized....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1535.91)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-909: Missing Initialization of Resource (Score: 1530.11)\n\nThe product does not initialize a critical resource....\n\n### 4. CWE-125: Out-of-bounds Read (Score: 1483.94)\n\nThe product reads data past the end, or before the beginning, of the intended buffer....\n\n### 5. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 1389.28)\n\nThe product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....\n\n## IMPACT: '-ENOENT when deleting VLANs'\n\nRelevant CWEs for this IMPACT:\n\n### 1. CWE-824: Access of Uninitialized Pointer (Score: 1557.26)\n\nThe product accesses or uses a pointer that has not been initialized....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1535.91)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-909: Missing Initialization of Resource (Score: 1530.11)\n\nThe product does not initialize a critical resource....\n\n### 4. CWE-923: Improper Restriction of Communication Channel to Intended Endpoints (Score: 1481.99)\n\nThe product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint....\n\n### 5. CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer (Score: 1461.82)\n\nThe product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors....\n\n## PRODUCT: 'Linux kernel'\n\nRelevant CWEs for this PRODUCT:\n\n### 1. CWE-824: Access of Uninitialized Pointer (Score: 1557.26)\n\nThe product accesses or uses a pointer that has not been initialized....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1535.91)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-909: Missing Initialization of Resource (Score: 1530.11)\n\nThe product does not initialize a critical resource....\n\n### 4. CWE-125: Out-of-bounds Read (Score: 1483.94)\n\nThe product reads data past the end, or before the beginning, of the intended buffer....\n\n### 5. CWE-923: Improper Restriction of Communication Channel to Intended Endpoints (Score: 1481.99)\n\nThe product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint....\n\n## COMPONENT: 'net dsa mv88e6xxx'\n\nRelevant CWEs for this COMPONENT:\n\n### 1. CWE-824: Access of Uninitialized Pointer (Score: 1557.26)\n\nThe product accesses or uses a pointer that has not been initialized....\n\n### 2. CWE-863: Incorrect Authorization (Score: 1535.91)\n\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....\n\n### 3. CWE-909: Missing Initialization of Resource (Score: 1530.11)\n\nThe product does not initialize a critical resource....\n\n### 4. CWE-125: Out-of-bounds Read (Score: 1483.94)\n\nThe product reads data past the end, or before the beginning, of the intended buffer....\n\n### 5. CWE-923: Improper Restriction of Communication Channel to Intended Endpoints (Score: 1481.99)\n\nThe product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint....\n\n\n    # Analysis Instructions\n    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.\n    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.\n    3. Provide a final determination of primary CWE(s) and any secondary CWEs.\n    4. Format your response using the standard analysis template.\n\n    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.\n    "
  },
  "retrieval_time": 2.7315924167633057
}