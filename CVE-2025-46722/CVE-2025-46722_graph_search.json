{
  "retriever": "graph",
  "query": "vLLM is an inference and serving engine for large language models (LLMs). In versions starting from 0.7.0 to before 0.9.0, in the file vllm/multimodal/hasher.py, the MultiModalHasher class has a security and data integrity issue in its image hashing method. Currently, it serializes PIL.Image.Image objects using only obj.tobytes(), which returns only the raw pixel data, without including metadata such as the images shape (width, height, mode). As a result, two images of different sizes (e.g., 30x100 and 100x30) with the same pixel byte sequence could generate the same hash value. This may lead to hash collisions, incorrect cache hits, and even data leakage or security risks. This issue has been patched in version 0.9.0. Consider specifically these CWEs: CWE-863 CWE-407 CWE-327 CWE-759 CWE-1007 CWE-345 CWE-1427 CWE-328 CWE-836",
  "keyphrases": {
    "original_query": "vLLM is an inference and serving engine for large language models (LLMs). In versions starting from 0.7.0 to before 0.9.0, in the file vllm/multimodal/hasher.py, the MultiModalHasher class has a security and data integrity issue in its image hashing method. Currently, it serializes PIL.Image.Image objects using only obj.tobytes(), which returns only the raw pixel data, without including metadata such as the images shape (width, height, mode). As a result, two images of different sizes (e.g., 30x100 and 100x30) with the same pixel byte sequence could generate the same hash value. This may lead to hash collisions, incorrect cache hits, and even data leakage or security risks. This issue has been patched in version 0.9.0.",
    "enhanced_query": "vLLM is an inference and serving engine for large language models (LLMs). In versions starting from 0.7.0 to before 0.9.0, in the file vllm/multimodal/hasher.py, the MultiModalHasher class has a security and data integrity issue in its image hashing method. Currently, it serializes PIL.Image.Image objects using only obj.tobytes(), which returns only the raw pixel data, without including metadata such as the images shape (width, height, mode). As a result, two images of different sizes (e.g., 30x100 and 100x30) with the same pixel byte sequence could generate the same hash value. This may lead to hash collisions, incorrect cache hits, and even data leakage or security risks. This issue has been patched in version 0.9.0. Consider specifically these CWEs: CWE-863 CWE-407 CWE-327 CWE-759 CWE-1007 CWE-345 CWE-1427 CWE-328 CWE-836",
    "cwe_mentions": [
      "CWE-863",
      "CWE-407",
      "CWE-327",
      "CWE-759",
      "CWE-1007",
      "CWE-345",
      "CWE-1427",
      "CWE-328",
      "CWE-836"
    ],
    "search_time": 3.5186753273010254
  },
  "timestamp": "2025-07-15 01:34:52",
  "cve_id": "CVE-2025-46722",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "208",
      "name": "Observable Timing Discrepancy",
      "type": "base",
      "score": 2.2100000000000004,
      "relationship_count": 0
    },
    {
      "cwe_id": "385",
      "name": "Covert Timing Channel",
      "type": "base",
      "score": 1.7680000000000005,
      "relationship_count": 0
    },
    {
      "cwe_id": "836",
      "name": "Use of Password Hash Instead of Password for Authentication",
      "type": "Base",
      "score": 1.7269999392108637,
      "relationship_count": 0
    },
    {
      "cwe_id": "328",
      "name": "Use of Weak Hash",
      "type": "Base",
      "score": 1.6473655448808078,
      "relationship_count": 0
    },
    {
      "cwe_id": "1007",
      "name": "Insufficient Visual Distinction of Homoglyphs Presented to User",
      "type": "Base",
      "score": 1.5565440148278258,
      "relationship_count": 0
    },
    {
      "cwe_id": "1304",
      "name": "Improperly Preserved Integrity of Hardware Configuration State During a Power Save/Restore Operation",
      "type": "base",
      "score": 1.521,
      "relationship_count": 0
    },
    {
      "cwe_id": "301",
      "name": "Reflection Attack in an Authentication Protocol",
      "type": "base",
      "score": 1.521,
      "relationship_count": 0
    },
    {
      "cwe_id": "708",
      "name": "Incorrect Ownership Assignment",
      "type": "base",
      "score": 1.521,
      "relationship_count": 0
    },
    {
      "cwe_id": "358",
      "name": "Improperly Implemented Security Check for Standard",
      "type": "base",
      "score": 1.521,
      "relationship_count": 0
    },
    {
      "cwe_id": "1427",
      "name": "Improper Neutralization of Input Used for LLM Prompting",
      "type": "Base",
      "score": 1.4419102107102089,
      "relationship_count": 0
    },
    {
      "cwe_id": "327",
      "name": "Use of a Broken or Risky Cryptographic Algorithm",
      "type": "class",
      "score": 1.4080000000000001,
      "relationship_count": 0
    },
    {
      "cwe_id": "345",
      "name": "Insufficient Verification of Data Authenticity",
      "type": "class",
      "score": 1.3648,
      "relationship_count": 0
    },
    {
      "cwe_id": "759",
      "name": "Use of a One-Way Hash without a Salt",
      "type": "Variant",
      "score": 1.3403889328771619,
      "relationship_count": 0
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "type": "class",
      "score": 1.192,
      "relationship_count": 0
    },
    {
      "cwe_id": "290",
      "name": "Authentication Bypass by Spoofing",
      "type": "base",
      "score": 1.1466,
      "relationship_count": 0
    },
    {
      "cwe_id": "1271",
      "name": "Uninitialized Value on Reset for Registers Holding Security Settings",
      "type": "base",
      "score": 1.1466,
      "relationship_count": 0
    },
    {
      "cwe_id": "325",
      "name": "Missing Cryptographic Step",
      "type": "base",
      "score": 1.1466,
      "relationship_count": 0
    },
    {
      "cwe_id": "352",
      "name": "Cross-Site Request Forgery (CSRF)",
      "type": "compound",
      "score": 1.04,
      "relationship_count": 0
    },
    {
      "cwe_id": "804",
      "name": "Guessable CAPTCHA",
      "type": "base",
      "score": 1.0062,
      "relationship_count": 0
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "type": "base",
      "score": 1.0062,
      "relationship_count": 0
    }
  ]
}