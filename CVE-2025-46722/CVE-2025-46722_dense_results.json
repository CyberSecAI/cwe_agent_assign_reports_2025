{
  "query": "vLLM is an inference and serving engine for large language models (LLMs). In versions starting from 0.7.0 to before 0.9.0, in the file vllm/multimodal/hasher.py, the MultiModalHasher class has a security and data integrity issue in its image hashing method. Currently, it serializes PIL.Image.Image objects using only obj.tobytes(), which returns only the raw pixel data, without including metadata such as the images shape (width, height, mode). As a result, two images of different sizes (e.g., 30x100 and 100x30) with the same pixel byte sequence could generate the same hash value. This may lead to hash collisions, incorrect cache hits, and even data leakage or security risks. This issue has been patched in version 0.9.0.",
  "count": 11,
  "results": [
    {
      "cwe_id": "1427",
      "name": "Improper Neutralization of Input Used for LLM Prompting",
      "abstraction": "Base",
      "score": 0.40688836361552366,
      "original_score": 0.40688836361552366,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "328",
      "name": "Use of Weak Hash",
      "abstraction": "Base",
      "score": 0.37696442603539837,
      "original_score": 0.37696442603539837,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "759",
      "name": "Use of a One-Way Hash without a Salt",
      "abstraction": "Variant",
      "score": 0.3688833526452377,
      "original_score": 0.3688833526452377,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "836",
      "name": "Use of Password Hash Instead of Password for Authentication",
      "abstraction": "Base",
      "score": 0.3681772511735152,
      "original_score": 0.3681772511735152,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1007",
      "name": "Insufficient Visual Distinction of Homoglyphs Presented to User",
      "abstraction": "Base",
      "score": 0.3606836270658441,
      "original_score": 0.3606836270658441,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "581",
      "name": "Object Model Violation: Just One of Equals and Hashcode Defined",
      "abstraction": "Variant",
      "score": 0.3491489242892717,
      "original_score": 0.3491489242892717,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "760",
      "name": "Use of a One-Way Hash with a Predictable Salt",
      "abstraction": "Variant",
      "score": 0.3431284266866395,
      "original_score": 0.3431284266866395,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "129",
      "name": "Improper Validation of Array Index",
      "abstraction": "Variant",
      "score": 0.33235992575458595,
      "original_score": 0.33235992575458595,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "943",
      "name": "Improper Neutralization of Special Elements in Data Query Logic",
      "abstraction": "Class",
      "score": 0.3306184959293052,
      "original_score": 0.3306184959293052,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1287",
      "name": "Improper Validation of Specified Type of Input",
      "abstraction": "Base",
      "score": 0.32111774598019105,
      "original_score": 0.32111774598019105,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1039",
      "name": "Automated Recognition Mechanism with Inadequate Detection or Handling of Adversarial Input Perturbations",
      "abstraction": "Class",
      "score": 0.3016085952812695,
      "original_score": 0.3016085952812695,
      "mapping_usage": "Allowed-with-Review"
    }
  ],
  "statistics": {
    "min": 0.3016085952812695,
    "max": 0.40688836361552366,
    "mean": 0.3508708304051619,
    "median": 0.3491489242892717,
    "count": 11
  }
}