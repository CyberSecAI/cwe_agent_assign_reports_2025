# Raw Retriever Results for CVE-2025-46722

# Raw Retriever Results for CVE-2025-46722
## Query
vLLM is an inference and serving engine for large language models (LLMs). In versions starting from 0.7.0 to before 0.9.0, in the file vllm/multimodal/hasher.py, the MultiModalHasher class has a security and data integrity issue in its image hashing method. Currently, it serializes PIL.Image.Image objects using only obj.tobytes(), which returns only the raw pixel data, without including metadata such as the images shape (width, height, mode). As a result, two images of different sizes (e.g., 30x100 and 100x30) with the same pixel byte sequence could generate the same hash value. This may lead to hash collisions, incorrect cache hits, and even data leakage or security risks. This issue has been patched in version 0.9.0.

## Keyphrases
- **weakness**: 'hash collisions'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3016 | 0.4069 | 0.3508 | 0.3491 | 11 |
| Sparse | 164.4916 | 544.7499 | 462.3867 | 480.2448 | 11 |
| Graph | 1.0062 | 2.2100 | 1.4342 | 1.4253 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 208 | Observable Timing Discrepancy | base | 2.2100 | Allowed |
| 2 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 3 | 836 | Use of Password Hash Instead of Password for Authentication | Base | 1.7279 | Allowed |
| 4 | 328 | Use of Weak Hash | Base | 1.6485 | Allowed |
| 5 | 1007 | Insufficient Visual Distinction of Homoglyphs Presented to User | Base | 1.5573 | Allowed |
| 6 | 301 | Reflection Attack in an Authentication Protocol | base | 1.5210 | Allowed |
| 7 | 358 | Improperly Implemented Security Check for Standard | base | 1.5210 | Allowed |
| 8 | 1304 | Improperly Preserved Integrity of Hardware Configuration State During a Power Save/Restore Operation | base | 1.5210 | Allowed |
| 9 | 708 | Incorrect Ownership Assignment | base | 1.5210 | Allowed |
| 10 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 1.4426 | Allowed |
| 11 | 327 | Use of a Broken or Risky Cryptographic Algorithm | class | 1.4080 | Allowed-with-Review |
| 12 | 345 | Insufficient Verification of Data Authenticity | class | 1.3648 | Discouraged |
| 13 | 804 | Guessable CAPTCHA | base | 1.3572 | Allowed |
| 14 | 759 | Use of a One-Way Hash without a Salt | Variant | 1.3412 | Allowed |
| 15 | 863 | Incorrect Authorization | class | 1.3216 | Allowed-with-Review |

## Dense Retriever Results (11)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.4069 | 0.4069 | Allowed |
| 2 | 328 | Use of Weak Hash | Base | 0.3769 | 0.3769 | Allowed |
| 3 | 759 | Use of a One-Way Hash without a Salt | Variant | 0.3688 | 0.3688 | Allowed |
| 4 | 836 | Use of Password Hash Instead of Password for Authentication | Base | 0.3681 | 0.3681 | Allowed |
| 5 | 1007 | Insufficient Visual Distinction of Homoglyphs Presented to User | Base | 0.3606 | 0.3606 | Allowed |
| 6 | 581 | Object Model Violation: Just One of Equals and Hashcode Defined | Variant | 0.3491 | 0.3491 | Allowed |
| 7 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | 0.3430 | 0.3430 | Allowed |
| 8 | 129 | Improper Validation of Array Index | Variant | 0.3323 | 0.3323 | Allowed |
| 9 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | 0.3306 | 0.3306 | Allowed-with-Review |
| 10 | 1287 | Improper Validation of Specified Type of Input | Base | 0.3210 | 0.3210 | Allowed |
| 11 | 1039 | Automated Recognition Mechanism with Inadequate Detection or Handling of Adversarial Input Perturbations | Class | 0.3016 | 0.3016 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 328 | Use of Weak Hash | 544.7499 | 544.7499 | Allowed |
| 2 | 407 | Inefficient Algorithmic Complexity | 531.9996 | 531.9996 | Allowed-with-Review |
| 3 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 513.5033 | 513.5033 | Allowed-with-Review |
| 4 | 863 | Incorrect Authorization | 482.9605 | 482.9605 | Allowed-with-Review |
| 5 | 345 | Insufficient Verification of Data Authenticity | 481.7804 | 481.7804 | Discouraged |
| 6 | 347 | Improper Verification of Cryptographic Signature | 480.2448 | 480.2448 | Allowed |
| 7 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 474.7202 | 474.7202 | Allowed-with-Review |
| 8 | 1390 | Weak Authentication | 474.6865 | 474.6865 | Allowed-with-Review |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 473.6344 | 473.6344 | Allowed |
| 10 | 330 | Use of Insufficiently Random Values | 463.4822 | 463.4822 | Discouraged |
| 11 | 668 | Exposure of Resource to Wrong Sphere | 164.4916 | 164.4916 | Discouraged |
