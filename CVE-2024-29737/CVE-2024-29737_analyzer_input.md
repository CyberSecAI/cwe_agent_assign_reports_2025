# Vulnerability Information: CVE-2024-29737

# Vulnerability Description

    In streampark, the project module integrates Mavens compilation capabilities. The input parameter validation is not strict, allowing attackers to insert commands for remote command execution, The prerequisite for a successful attack is that the user needs to log in to the streampark system and have system-level permissions. Generally, only users of that system have the authorization to log in, and users would not manually input a dangerous operation command. Therefore, the risk level of this vulnerability is very low. Mitigation all users should upgrade to 2.1.4 Background info Log in to Streampark using the default username (e.g. test1, test2, test3) and the **default password** (streampark). Navigate to the Project module, then add a new project. Enter the git repository address of the project and input `touch /tmp/success_2.1.2` as the Build Argument. Note that there is no verification and interception of the special character `. As a result, you will find that this injection command will be successfully executed after executing the build. In the latest version, the special symbol ` is intercepted.

    # Keyphrase-Specific CWE Analysis
    This vulnerability contains multiple keyphrases that may map to different CWEs. 
    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.

    ## ROOTCAUSE: 'default password'

Relevant CWEs for this ROOTCAUSE:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-285: Improper Authorization (Score: 954.05)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 4. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 947.22)

The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....

### 5. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....

## ROOTCAUSE: 'improper input validation'

Relevant CWEs for this ROOTCAUSE:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-285: Improper Authorization (Score: 954.05)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 4. CWE-138: Improper Neutralization of Special Elements (Score: 947.33)

The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component....

### 5. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....

## WEAKNESS: 'command injection'

Relevant CWEs for this WEAKNESS:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-138: Improper Neutralization of Special Elements (Score: 947.33)

The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component....

### 4. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....

### 5. CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') (Score: 887.57)

The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes code syntax before using the input in a dynamic evaluation call (e.g. "eval")....

## IMPACT: 'command execution'

Relevant CWEs for this IMPACT:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-285: Improper Authorization (Score: 954.05)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 4. CWE-138: Improper Neutralization of Special Elements (Score: 947.33)

The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component....

### 5. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....

## IMPACT: 'execute commands'

Relevant CWEs for this IMPACT:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-285: Improper Authorization (Score: 954.05)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 4. CWE-138: Improper Neutralization of Special Elements (Score: 947.33)

The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component....

### 5. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....

## ATTACKER: 'attackers'

Relevant CWEs for this ATTACKER:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-285: Improper Authorization (Score: 954.05)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 4. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....

### 5. CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') (Score: 309.30)

The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users....

## PRODUCT: 'streampark'

Relevant CWEs for this PRODUCT:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-285: Improper Authorization (Score: 954.05)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 4. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....

### 5. CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') (Score: 309.30)

The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users....

## VERSION: 'before 2.1.4'

Relevant CWEs for this VERSION:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-285: Improper Authorization (Score: 954.05)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 4. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....

### 5. CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') (Score: 309.30)

The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users....

## COMPONENT: 'Project module'

Relevant CWEs for this COMPONENT:

### 1. CWE-863: Incorrect Authorization (Score: 960.10)

The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....

### 2. CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') (Score: 959.56)

The product constructs a string for a command to be executed by a separate component
in another control sphere, but it does not properly delimit the
intended arguments, options, or switches within that command string....

### 3. CWE-285: Improper Authorization (Score: 954.05)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 4. CWE-201: Insertion of Sensitive Information Into Sent Data (Score: 947.22)

The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....

### 5. CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') (Score: 945.81)

The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component....


    # Analysis Instructions
    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.
    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.
    3. Provide a final determination of primary CWE(s) and any secondary CWEs.
    4. Format your response using the standard analysis template.

    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.
    