# Vulnerability Information: CVE-2024-36575

## Vulnerability Description
A **Prototype Pollution** issue in getsetprop 1.1.0 allows an attacker to execute arbitrary code via global.accessor.

### Vulnerability Description Key Phrases
- **rootcause:** **Prototype Pollution**
- **impact:** execute arbitrary code
- **attacker:** attacker
- **product:** getsetprop
- **version:** 1.1.0

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability stems from the `global.accessor` function (located in `getsetprop/index.js:4`) where properties from a source object are unsafely assigned to a destination object. This function fails to sanitize or validate input properties.

**Weaknesses/Vulnerabilities:**

- **Prototype Pollution:** The function is vulnerable to prototype pollution via the special properties `__proto__` or `constructor.prototype`. An attacker can inject malicious payloads by manipulating these properties, which are inherited by all objects.
- **Unsafe Assignment:** Directly assigning source properties to the destination without sanitization or validation.

**Impact of Exploitation:**

- **Denial of Service (DoS):** By polluting the prototype, an attacker can disrupt the application's expected behavior, leading to crashes or instability.
- **Remote Code Execution (RCE):**  In some contexts, prototype pollution can be chained with other vulnerabilities or application logic to achieve remote code execution.
- **Cross-Site Scripting (XSS):**  By injecting malicious properties, an attacker might be able to achieve XSS in contexts where the polluted object is accessed and displayed without sanitization.

**Attack Vectors:**

- The attacker can supply a crafted JSON object containing `__proto__` or `constructor.prototype` to the vulnerable `set` function of the `getsetprop` library.
- By doing so the attacker is able to modify the `Object.prototype` of Javascript

**Required Attacker Capabilities/Position:**

- The attacker needs to be able to supply or control the input to the vulnerable `set` function of the `getsetprop` library.

**Additional Information:**

- The provided proof-of-concept (PoC) demonstrates how the `__proto__` property can be used to add a new property `polluted` to the `Object.prototype`, highlighting the prototype pollution.
- The maintainers of the vulnerable library did not provide any updates to fix the vulnerability.
- The content explicitly urges users to implement input sanitization and validation, specifically blocking `__proto__` and `constructor.prototype` in the inputs of the library.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.245 |
| 2 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | Allowed | sparse | 0.114 |
| 3 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | sparse | 0.108 |
| 4 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.085 |
| 5 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.084 |
| 6 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.083 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.083 |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.082 |
| 9 | 767 | Access to Critical Private Variable via Public Method | Base | Allowed | dense | 0.476 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |

