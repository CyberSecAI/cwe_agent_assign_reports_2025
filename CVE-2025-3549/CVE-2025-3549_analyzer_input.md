# Vulnerability Information: CVE-2025-3549

## Vulnerability Description
A vulnerability, which was classified as critical, was found in Open Asset Import Library Assimp 5.4.3. Affected is the function AssimpMD3ImporterValidateSurfaceHeaderOffsets of the file code/AssetLib/MD3/MD3Loader.cpp of the component File Handler. The manipulation leads to **heap-based buffer overflow**. The attack needs to be approached locally. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** Open Asset Import Library Assimp
- **version:** 5.4.3
- **component:** function AssimpMD3ImporterValidateSurfaceHeaderOffsets of the file code/AssetLib/MD3/MD3Loader.cpp of the component File Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3549 Content

Based on the provided content, this relates to a heap-based buffer overflow vulnerability in Assimp Library.

**Root cause of vulnerability:**

The vulnerability stems from a lack of validation of pointer validity within the `Assimp::MD3Importer::ValidateSurfaceHeaderOffsets` function. This leads to the use of wild pointers, causing an out-of-bounds read. Specifically, the condition `pcSurf->OFS_TRIANGLES + ofs + pcSurf->NUM_TRIANGLES * sizeof(MD3::Triangle) > fileSize` does not adequately prevent accessing memory outside the allocated buffer.

**Weaknesses/vulnerabilities present:**

*   **Heap-based Buffer Overflow (CWE-122):** The core vulnerability is a heap-based buffer overflow.
*   **Lack of Bounds Checking:** Insufficient validation of offsets and sizes before memory access.
*   **Wild Pointer Dereference:** The code uses a pointer without ensuring it points to a valid memory location.

**Impact of exploitation:**

*   **Application Crash:** The provided report shows the vulnerability triggers a segmentation fault, leading to a crash.
*   **Potential for Code Execution:** While not explicitly stated, a heap buffer overflow can potentially be exploited for code execution, depending on the heap layout and other factors.

**Attack vectors:**

*   **Malicious MD3 Files:** The vulnerability is triggered when processing specifically crafted, malformed MD3 files.
*   **Fuzzing:** The vulnerability was discovered through fuzzing, indicating that automated testing can effectively identify such issues.

**Required attacker capabilities/position:**

*   **File Creation/Modification:** An attacker needs to be able to create or modify MD3 files.
*   **Ability to Provide File to Assimp:** The attacker needs a way to provide the malicious file to an application using the Assimp library to load it.

**Mitigation or fix:**

The content does not provide a specific fix, but it implies that adding proper bounds checking and validation of pointer validity within the `Assimp::MD3Importer::ValidateSurfaceHeaderOffsets` function is necessary.

**Additional Details (more detail than official CVE description):**

*   The vulnerable code is located in `code/AssetLib/MD3/MD3Loader.cpp` at line 397.
*   The report includes a sample file (`Assimp_MD3Importer_ValidateSurfaceHeaderOffsets-hbo.zip`) that triggers the vulnerability.
*   The report includes ASan (AddressSanitizer) output, providing detailed information about the memory corruption.
*   Build instructions for reproducing the issue with sanitizers are provided.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.393 |
| 4 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.376 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.366 |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.358 |
| 7 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.351 |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.348 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.562 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

