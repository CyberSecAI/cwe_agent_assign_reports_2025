# Vulnerability Information: CVE-2024-57040

## Vulnerability Description
TL-WR845N(UN)_V4_200909 and TL-WR845N(UN)_V4_190219 was discovered to contain a **hardcoded password** for the root account which can be obtained by analyzing downloaded firmware or via a brute force attack through physical access to the router.

### Vulnerability Description Key Phrases
- **rootcause:** **hardcoded password**
- **product:** TL-WR845N(UN)_V4, TL-WR845N(UN)_V4
- **version:** 200909, 190219

## CVE Reference Links Content Summary
Root cause of vulnerability:
The root cause is the presence of hardcoded, easily crackable credentials (username "admin" and password "1234") within the router's firmware. These credentials are stored in the `squashfs-root/etc/passwd` and `squashfs-root/etc/passwd.bak` files, with the password MD5 hashed but easily cracked.

Weaknesses/vulnerabilities present:
- Hardcoded credentials
- Weak password ("1234")
- Credentials stored in easily accessible files within the firmware

Impact of exploitation:
Successful exploitation grants an attacker root user privilege on the router.

Attack vectors:
- Physical access to the router's SPI flash memory.
- Downloading the firmware from the manufacturer's website.

Required attacker capabilities/position:
- Ability to obtain the firmware (either physically or via download).
- Basic knowledge of firmware analysis tools (binwalk, FirmAudit).
- Ability to crack MD5 hashes (using tools like hashcat or john the ripper).
- (For validation) Access to a UART port and communication capabilities.

Mitigation or fix:
The content does not specify a mitigation or fix, but implies that changing the default credentials and avoiding hardcoding them in the firmware would resolve the issue.

Additional details:
- Affected models: TP-Link TL-WR845N
- Affected firmware versions: TL-WR845N(UN)_V4_190219, TL-WR845N(UN)_V4_200909, TL-WR845N(UN)_V4_201214
- The content provides more detail than a typical CVE description, including specific file paths, commands for extraction and analysis, and validation steps.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.302 |
| 2 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.286 |
| 3 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.269 |
| 4 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.232 |
| 5 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.231 |
| 6 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | sparse | 0.231 |
| 7 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.225 |
| 8 | 326 | Inadequate Encryption Strength | Class | Allowed-with-Review | sparse | 0.225 |
| 9 | 1393 | Use of Default Password | Base | Allowed | dense | 0.506 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |

