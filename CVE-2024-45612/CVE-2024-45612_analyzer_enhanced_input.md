## Vulnerability Description
Contao is an Open Source CMS. In affected versions an untrusted user can **inject insert tags into the canonical tag**, which are then replaced on the web page (front end). Users are advised to update to Contao 4.13.49, 5.3.15 or 5.4.3. Users unable to upgrade should disable canonical tags in the root page settings.

### Vulnerability Description Key Phrases
- **weakness:** **inject insert tags into the canonical tag**
- **attacker:** untrusted user
- **product:** Contao

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability stems from the ability to inject insert tags within canonical URLs. These insert tags are then processed and replaced when the page is rendered.

**Weaknesses/Vulnerabilities:**

- **Insert Tag Injection:** The core issue is the lack of proper sanitization or escaping of user-controlled input that's used to generate canonical URLs. This allows attackers to insert malicious or unexpected insert tags.

**Impact of Exploitation:**

- **Unintended Code Execution:** By injecting specially crafted insert tags, an attacker can potentially execute arbitrary code or perform unwanted actions on the server.
- **Information Disclosure:** If certain insert tags are used for sensitive data, it might be possible to leak it.
- **Denial of Service (potentially):** An attacker might be able to inject tags that cause the server to perform extensive or looping tasks, leading to resource exhaustion.
- The CVSS score indicates a **low impact on confidentiality**, **no impact on integrity**, and **no impact on availability.**

**Attack Vectors:**

- **Canonical URL Manipulation:** The attack vector involves manipulating the input used to generate canonical URLs. This could be done through various methods, depending on how the CMS handles these URLs.

**Required Attacker Capabilities/Position:**

- **Network Access:** The attacker needs network access to the vulnerable Contao instance since the vulnerability is network-based, as indicated in the CVSS metrics (AV:N).
- **No Special Privileges:**  No specific privileges or user interaction is required for successful exploitation (PR:N, UI:N).

**Additional Details:**

- **Affected Versions:** The vulnerability affects Contao versions 4.13 up to 4.13.48, 5.0, 5.1, 5.2, 5.3 up to 5.3.14, and 5.4 up to 5.4.2.
- **Patched Versions:** The vulnerability is fixed in Contao versions 4.13.49, 5.3.15, and 5.4.3.
- **Workaround:** A temporary workaround is to disable canonical tags in the website root page settings.
- The GitHub advisory provides a CVSS score of 5.3, which is considered moderate.
- The attack complexity is low (AC:L).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.367 |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.364 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.363 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.355 |
| 5 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.332 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.329 |
| 7 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.325 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.319 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.565 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-116: Improper Encoding or Escaping of Output

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-138: Improper Neutralization of Special Elements

CWE-917: Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-494: Download of Code Without Integrity Check