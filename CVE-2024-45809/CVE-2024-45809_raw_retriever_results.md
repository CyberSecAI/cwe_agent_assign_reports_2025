# Raw Retriever Results for CVE-2024-45809

# Raw Retriever Results for CVE-2024-45809
## Query
Envoy is a cloud-native high-performance edge/middle/service proxy. Jwt filter will lead to an Envoy crash when clear route cache with remote JWKs. In the following case 1. remote JWKs are used, which requires async header processing 2. clear_route_cache is enabled on the provider 3. header operations are enabled in JWT filter, e.g. header to claims feature 4. the routing table is configured in a way that the JWT header operations modify requests to not match any route. When these conditions are met, a crash is triggered in the upstream code due to nullptr reference conversion from route(). The root cause is the ordering of continueDecoding and clearRouteCache. This issue has been addressed in versions 1.31.2, 1.30.6, and 1.29.9. Users are advised to upgrade. There are no known workarounds for this vulnerability.

## Keyphrases
- **rootcause**: 'nullptr reference conversion'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4226 | 0.4603 | 0.4377 | 0.4346 | 20 |
| Sparse | 227.9450 | 751.4621 | 667.3816 | 705.2674 | 11 |
| Graph | 1.6743 | 2.2698 | 1.9648 | 2.0368 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2698 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | class | 2.2288 | Allowed-with-Review |
| 3 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 4 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 6 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 7 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 2.1936 | Allowed |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 9 | 347 | Improper Verification of Cryptographic Signature | base | 2.1190 | Allowed |
| 10 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 11 | 287 | Improper Authentication | class | 2.0336 | Discouraged |
| 12 | 823 | Use of Out-of-range Pointer Offset | base | 1.7680 | Allowed |
| 13 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 14 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 15 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4603 | 0.4603 | Allowed |
| 2 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | 0.4578 | 0.4578 | Allowed |
| 3 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | Class | 0.4553 | 0.4553 | Allowed-with-Review |
| 4 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.4520 | 0.4520 | Allowed |
| 5 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4493 | 0.4493 | Allowed |
| 6 | 1422 | Exposure of Sensitive Information caused by Incorrect Data Forwarding during Transient Execution | Base | 0.4459 | 0.4459 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4443 | 0.4443 | Allowed |
| 8 | 794 | Incomplete Filtering of Multiple Instances of Special Elements | Variant | 0.4426 | 0.4426 | Allowed |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4400 | 0.4400 | Allowed |
| 10 | 696 | Incorrect Behavior Order | Class | 0.4358 | 0.4358 | Allowed-with-Review |
| 11 | 410 | Insufficient Resource Pool | Base | 0.4333 | 0.4333 | Allowed |
| 12 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.4311 | 0.4311 | Allowed |
| 13 | 617 | Reachable Assertion | Base | 0.4307 | 0.4307 | Allowed |
| 14 | 674 | Uncontrolled Recursion | Class | 0.4307 | 0.4307 | Allowed-with-Review |
| 15 | 294 | Authentication Bypass by Capture-replay | Base | 0.4263 | 0.4263 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 287 | Improper Authentication | 751.4621 | 751.4621 | Discouraged |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | 738.5213 | 738.5213 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 725.5497 | 725.5497 | Allowed-with-Review |
| 4 | 347 | Improper Verification of Cryptographic Signature | 718.5776 | 718.5776 | Allowed |
| 5 | 863 | Incorrect Authorization | 713.2714 | 713.2714 | Allowed-with-Review |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | 705.2674 | 705.2674 | Allowed |
| 7 | 1333 | Inefficient Regular Expression Complexity | 701.4640 | 701.4640 | Allowed |
| 8 | 674 | Uncontrolled Recursion | 687.2390 | 687.2390 | Allowed-with-Review |
| 9 | 697 | Incorrect Comparison | 686.6604 | 686.6604 | Discouraged |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | 685.2390 | 685.2390 | Allowed |
| 11 | 789 | Memory Allocation with Excessive Size Value | 227.9450 | 227.9450 | Allowed |
