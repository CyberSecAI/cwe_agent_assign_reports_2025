# Vulnerability Information: CVE-2025-22036

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved exfat fix random **stack corruption** after get_block When get_block is called with a buffer_head allocated on the stack, such as do_mpage_readpage, **stack corruption** due to buffer_head UAF may occur in the following **race condition** situation. mpage_read_folio > do_mpage_readpage exfat_get_block bh_read __bh_read get_bh(bh) submit_bh wait_on_buffer ... end_buffer_read_sync __end_buffer_read_notouch unlock_buffer > ... ... ... ... > . . another_function > put_bh(bh) atomic_dec(bh->b_count) * **stack corruption** here * This patch returns -EAGAIN if a folio does not have buffers when bh_read needs to be called. By doing this, the caller can fallback to functions like block_read_full_folio(), create a buffer_head in the folio, and then call get_block again. Lets do not call bh_read() with on-stack buffer_head.

### Vulnerability Description Key Phrases
- **rootcause:** **race condition**
- **weakness:** **stack corruption**
- **product:** Linux kernel
- **component:** exfat

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.523 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.523 |
| 4 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.511 |
| 5 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.508 |
| 6 | 457 | Use of Uninitialized Variable | Variant | Allowed | sparse | 0.507 |
| 7 | 662 | Improper Synchronization | Class | Discouraged | sparse | 0.491 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.491 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.510 |
| 10 | 609 | Double-Checked Locking | Base | Allowed | graph | 0.003 |

