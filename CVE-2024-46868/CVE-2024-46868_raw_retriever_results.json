{
  "query": "In the Linux kernel, the following vulnerability has been resolved firmware qcom uefisecapp Fix deadlock in qcuefi_acquire() If the __qcuefi pointer is not set, then in the original code, we would hold onto the lock. That means that if we tried to set it later, then it would cause a deadlock. Drop the lock on the error path. Thats what all the callers are expecting.",
  "keyphrases": {
    "rootcause": [
      "If the __qcuefi pointer is not set",
      "then in the original code",
      "we would hold onto the lock"
    ],
    "weakness": [
      "deadlock"
    ]
  },
  "timestamp": "2025-07-12T04:47:37.826079",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "123",
        "name": "Write-what-where Condition",
        "abstraction": "base",
        "score": 2.353,
        "description": "CWE-123: Write-what-where Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "364",
        "name": "Signal Handler Race Condition",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-364: Signal Handler Race Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "variant",
        "score": 2.172,
        "description": "CWE-416: Use After Free...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "129",
        "name": "Improper Validation of Array Index",
        "abstraction": "variant",
        "score": 1.83936,
        "description": "CWE-129: Improper Validation of Array Index...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "413",
        "name": "Improper Resource Locking",
        "abstraction": "Base",
        "score": 1.719148159154066,
        "description": "The product does not lock or does not correctly lock a resource when the product must have exclusive access to the resource....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "833",
        "name": "Deadlock",
        "abstraction": "Base",
        "score": 1.7120820654969386,
        "description": "The product contains multiple threads or executable segments that are waiting for each other to release a necessary lock, resulting in deadlock....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1325",
        "name": "Improperly Controlled Sequential Memory Allocation",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1325: Improperly Controlled Sequential Memory Allocation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "252",
        "name": "Unchecked Return Value",
        "abstraction": "Base",
        "score": 1.5987851260225039,
        "description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "abstraction": "variant",
        "score": 1.5552000000000004,
        "description": "CWE-789: Memory Allocation with Excessive Size Value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "134",
        "name": "Use of Externally-Controlled Format String",
        "abstraction": "base",
        "score": 1.5350400000000004,
        "description": "CWE-134: Use of Externally-Controlled Format String...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "base",
        "score": 1.5350400000000004,
        "description": "CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1265",
        "name": "Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls",
        "abstraction": "base",
        "score": 1.5350400000000004,
        "description": "CWE-1265: Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "Base",
        "score": 1.5312365534840022,
        "description": "The product dereferences a pointer that it expects to be valid but is NULL....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "273",
        "name": "Improper Check for Dropped Privileges",
        "abstraction": "base",
        "score": 1.521,
        "description": "CWE-273: Improper Check for Dropped Privileges...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "197",
        "name": "Numeric Truncation Error",
        "abstraction": "base",
        "score": 1.521,
        "description": "CWE-197: Numeric Truncation Error...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1285",
        "name": "Improper Validation of Specified Index, Position, or Offset in Input",
        "abstraction": "Base",
        "score": 1.4993018813845427,
        "description": "The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the spe...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1332",
        "name": "Improper Handling of Faults that Lead to Instruction Skips",
        "abstraction": "Base",
        "score": 1.491576048038422,
        "description": "The device is missing or incorrectly implements circuitry or sensors that detect and mitigate the skipping of security-critical CPU instructions when they occur....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "590",
        "name": "Free of Memory not on the Heap",
        "abstraction": "variant",
        "score": 1.4169600000000002,
        "description": "CWE-590: Free of Memory not on the Heap...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "479",
        "name": "Signal Handler Use of a Non-reentrant Function",
        "abstraction": "variant",
        "score": 1.4169600000000002,
        "description": "CWE-479: Signal Handler Use of a Non-reentrant Function...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "base",
        "score": 1.3010400000000002,
        "description": "CWE-1284: Improper Validation of Specified Quantity in Input...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "833",
        "name": "Deadlock",
        "abstraction": "Base",
        "score": 0.5467818047431543,
        "description": "The product contains multiple threads or executable segments that are waiting for each other to release a necessary lock, resulting in deadlock....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "413",
        "name": "Improper Resource Locking",
        "abstraction": "Base",
        "score": 0.545476176045629,
        "description": "The product does not lock or does not correctly lock a resource when the product must have exclusive access to the resource....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1285",
        "name": "Improper Validation of Specified Index, Position, or Offset in Input",
        "abstraction": "Base",
        "score": 0.5175208428875784,
        "description": "The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the spe...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "667",
        "name": "Improper Locking",
        "abstraction": "Class",
        "score": 0.514248458863211,
        "description": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1332",
        "name": "Improper Handling of Faults that Lead to Instruction Skips",
        "abstraction": "Base",
        "score": 0.49288651518768417,
        "description": "The device is missing or incorrectly implements circuitry or sensors that detect and mitigate the skipping of security-critical CPU instructions when they occur....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1233",
        "name": "Security-Sensitive Hardware Controls with Missing Lock Bit Protection",
        "abstraction": "Base",
        "score": 0.4865614618418661,
        "description": "The product uses a register lock bit protection mechanism, but it does not ensure that the lock bit prevents modification of system registers or controls that perform changes to important hardware sys...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1319",
        "name": "Improper Protection against Electromagnetic Fault Injection (EM-FI)",
        "abstraction": "Base",
        "score": 0.48484234114414304,
        "description": "The device is susceptible to electromagnetic fault injection attacks, causing device internal information to be compromised or security mechanisms to be bypassed....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1256",
        "name": "Improper Restriction of Software Interfaces to Hardware Features",
        "abstraction": "Base",
        "score": 0.48301294165454356,
        "description": "The product provides software-controllable\n\t\t\tdevice functionality for capabilities such as power and\n\t\t\tclock management, but it does not properly limit\n\t\t\tfunctionality that can lead to modification...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1231",
        "name": "Improper Prevention of Lock Bit Modification",
        "abstraction": "Base",
        "score": 0.48095466289983524,
        "description": "The product uses a trusted lock bit for restricting access to registers, address regions, or other resources, but the product does not prevent the value of the lock bit from being modified after it ha...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "832",
        "name": "Unlock of a Resource that is not Locked",
        "abstraction": "Base",
        "score": 0.47930971295759384,
        "description": "The product attempts to unlock a resource that is not locked....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1243",
        "name": "Sensitive Non-Volatile Information Not Protected During Debug",
        "abstraction": "Base",
        "score": 0.47586078127678033,
        "description": "Access to security-sensitive information stored in fuses is not limited during debug....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "909",
        "name": "Missing Initialization of Resource",
        "abstraction": "Class",
        "score": 0.4718184226326073,
        "description": "The product does not initialize a critical resource....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1247",
        "name": "Improper Protection Against Voltage and Clock Glitches",
        "abstraction": "Base",
        "score": 0.46947428897343546,
        "description": "The device does not contain or contains incorrectly implemented circuitry or sensors to detect and mitigate voltage and clock glitches and protect sensitive information or software contained on the de...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1191",
        "name": "On-Chip Debug and Test Interface With Improper Access Control",
        "abstraction": "Base",
        "score": 0.46308138750242067,
        "description": "The chip does not implement or does not correctly perform access control to check whether users are authorized to access internal registers and test modes through the physical debug/test interface....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1264",
        "name": "Hardware Logic with Insecure De-Synchronization between Control and Data Channels",
        "abstraction": "Base",
        "score": 0.4623078725952243,
        "description": "The hardware logic for error handling and security checks can incorrectly forward data before the security check is complete....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1274",
        "name": "Improper Access Control for Volatile Memory Containing Boot Code",
        "abstraction": "Base",
        "score": 0.4608784866463423,
        "description": "The product conducts a secure-boot process that transfers bootloader code from Non-Volatile Memory (NVM) into Volatile Memory (VM), but it does not have sufficient access control or other protections ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1234",
        "name": "Hardware Internal or Debug Modes Allow Override of Locks",
        "abstraction": "Base",
        "score": 0.4594495017408906,
        "description": "System configuration protection may be bypassed during debug mode....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1222",
        "name": "Insufficient Granularity of Address Regions Protected by Register Locks",
        "abstraction": "Variant",
        "score": 0.4581971552015667,
        "description": "The product defines a large address region protected from modification by the same register lock control bit. This results in a conflict between the functional requirement that some addresses need to ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "abstraction": "Class",
        "score": 0.4552071789182044,
        "description": "The product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code ...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1299",
        "name": "Missing Protection Mechanism for Alternate Hardware Interface",
        "abstraction": "Base",
        "score": 0.45427497742180534,
        "description": "The lack of protections on alternate paths to access\n                control-protected assets (such as unprotected shadow registers\n                and other external facing unguarded interfaces) allo...",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "667",
        "name": "Improper Locking",
        "abstraction": "Class",
        "score": 427.2060738273909,
        "description": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "833",
        "name": "Deadlock",
        "abstraction": "Base",
        "score": 406.85388750011265,
        "description": "The product contains multiple threads or executable segments that are waiting for each other to release a necessary lock, resulting in deadlock....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "252",
        "name": "Unchecked Return Value",
        "abstraction": "Base",
        "score": 367.8017633605936,
        "description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "194",
        "name": "Unexpected Sign Extension",
        "abstraction": "Variant",
        "score": 367.5892793882048,
        "description": "The product performs an operation on a number that causes it to be sign extended when it is transformed into a larger data type. When the original number is negative, this can produce unexpected value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "415",
        "name": "Double Free",
        "abstraction": "Variant",
        "score": 364.02217690281094,
        "description": "The product calls free() twice on the same memory address, potentially leading to modification of unexpected memory locations....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "824",
        "name": "Access of Uninitialized Pointer",
        "abstraction": "Base",
        "score": 362.18516456089776,
        "description": "The product accesses or uses a pointer that has not been initialized....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "212",
        "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
        "abstraction": "Base",
        "score": 358.6695157026269,
        "description": "The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorize...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "abstraction": "Compound",
        "score": 357.31377641574494,
        "description": "The product, when opening a file or directory, does not sufficiently account for when the file is a symbolic link that resolves to a target outside of the intended control sphere. This could allow an ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "abstraction": "Class",
        "score": 356.19727012921885,
        "description": "The product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code ...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "abstraction": "Base",
        "score": 354.2746507540113,
        "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neu...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "606",
        "name": "Unchecked Input for Loop Condition",
        "abstraction": "Base",
        "score": 329.15031018321196,
        "description": "The product does not properly check inputs that are used for loop conditions, potentially leading to a denial of service or other consequences because of excessive looping....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.45427497742180534,
      "max": 0.5467818047431543,
      "mean": 0.4831072485567258,
      "median": 0.4775852471171871,
      "count": 20
    },
    "sparse": {
      "min": 329.15031018321196,
      "max": 427.2060738273909,
      "mean": 368.29671533862034,
      "median": 362.18516456089776,
      "count": 11
    },
    "graph": {
      "min": 1.3010400000000002,
      "max": 2.353,
      "mean": 1.6574284916790236,
      "median": 1.5350400000000004,
      "count": 20
    }
  }
}