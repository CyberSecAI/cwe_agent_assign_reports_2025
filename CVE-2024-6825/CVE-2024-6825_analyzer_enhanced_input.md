## Vulnerability Description
BerriAI/litellm version 1.40.12 contains a vulnerability that allows remote code execution. The issue exists in the handling of the post_call_rules configuration, where a **callback function** can be added. The provided value is split at the final . mark, with the last part considered the function name and the remaining part appended with the .py extension and imported. This allows an attacker to set a system method, such as os.system, as a callback, enabling the execution of arbitrary commands when a chat response is processed.

### Vulnerability Description Key Phrases
- **component:** handling of post_call_rules configuration
- **weakness:** **callback function**
- **product:** BerriAI/litellm
- **impact:** arbitrary command execution, remote code execution
- **attacker:** attacker
- **version:** 1.40.12

## CVE Reference Links Content Summary
UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.452 |
| 2 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.448 |
| 3 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.445 |
| 4 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.445 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.441 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.439 |
| 7 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.437 |
| 8 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.436 |
| 9 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | Allowed | dense | 0.481 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-125: Out-of-bounds Read

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1390: Weak Authentication

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-1427: Improper Neutralization of Input Used for LLM Prompting

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')