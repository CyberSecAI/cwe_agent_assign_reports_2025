# Vulnerability Information: CVE-2024-41259

## Vulnerability Description
Use of **insecure hashing algorithm** in the Gravatars service in Navidrome v0.52.3 allows attackers to manipulate a users account information.

### Vulnerability Description Key Phrases
- **rootcause:** **insecure hashing algorithm**
- **impact:** manipulate a users account information
- **attacker:** attackers
- **product:** Navidrome
- **version:** v0.52.3
- **component:** Gravatars service

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-41259.

**Root cause of vulnerability:**
Navidrome v0.52.3 uses the MD5 hashing algorithm to generate URLs for Gravatar avatars instead of the more secure SHA-256 algorithm.

**Weaknesses/vulnerabilities present:**
- Insecure hashing algorithm (MD5) is used to generate URLs, which is prone to collisions and is considered weak.
- Use of a weak hashing algorithm for URL generation leading to potential security issues.
- Potential for unauthorized modification of user information through controlled email addresses due to the weak MD5 hashing.

**Impact of exploitation:**
An attacker could potentially change another user's Gravatar information if they control an email address and can generate an MD5 hash collision. This could lead to denial of service or data manipulation depending on the service's reliance on the avatar.

**Attack vectors:**
The vulnerability can be exploited by using the MD5 algorithm to generate a collision with the target user's email address and using it to modify avatar information.

**Required attacker capabilities/position:**
An attacker needs to:
   - Control an email address that can be used to generate an MD5 hash collision
   - Have some knowledge of the hashing algorithm used for avatar URL generation
   - Ability to utilize the generated hash to modify gravatar information.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.188 |
| 2 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.159 |
| 3 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.158 |
| 4 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | sparse | 0.154 |
| 5 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.150 |
| 6 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.141 |
| 7 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.138 |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.138 |
| 9 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | Allowed | dense | 0.554 |
| 10 | 208 | Observable Timing Discrepancy | Base | Allowed | graph | 0.002 |

