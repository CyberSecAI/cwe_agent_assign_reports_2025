# Vulnerability Information: CVE-2024-47188

## Vulnerability Description
Suricata is a network Intrusion Detection System, Intrusion Prevention System and Network Security Monitoring engine. Prior to version 7.0.7, **missing initialization of the random seed for thash** leads to byte-range tracking having predictable hash table behavior. This can lead to an attacker forcing lots of data into a single hash bucket, leading to severe performance degradation. This issue has been addressed in 7.0.7.

### Vulnerability Description Key Phrases
- **rootcause:** **missing initialization of the random seed for thash**
- **impact:** predictable hash table behavior
- **product:** Suricata
- **version:** Prior to version 7.0.7

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-47188:

**Root cause of vulnerability:**

The root cause of the vulnerability is the missing initialization of the random seed for the "thash" function used in byte-range tracking within the Suricata intrusion detection system.

**Weaknesses/vulnerabilities present:**

The primary weakness is the predictable hash table behavior due to the lack of a random seed for the hash function. This makes it possible for an attacker to control hash collisions by crafting specific requests.

**Impact of exploitation:**

Exploitation leads to a denial-of-service (DoS) condition. By forcing many data entries into the same hash bucket, an attacker can cause severe performance degradation, making the system unavailable.

**Attack vectors:**

The attack vector is network-based, meaning the attacker can exploit this vulnerability by sending malicious HTTP requests.

**Required attacker capabilities/position:**

An attacker needs to be able to send network traffic to the vulnerable Suricata instance. No specific user interaction or privileges are required for this attack to succeed. The attacker needs to understand how to craft HTTP requests with specific byte-ranges that cause predictable hash collisions.

**Additional details:**
- The vulnerability is present in Suricata versions prior to 7.0.7.
- The vulnerability is related to a previous issue (Security #7209) that was also about the lack of random factor in "thash".
- The CVSS score is 7.5, with high impact on availability.
- The vulnerability is classified as CWE-330 (Use of Insufficiently Random Values).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | sparse | 0.391 |
| 2 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.380 |
| 3 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.376 |
| 4 | 1392 | Use of Default Credentials | Base | Allowed | sparse | 0.374 |
| 5 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | Allowed | sparse | 0.364 |
| 6 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.358 |
| 7 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.353 |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.345 |
| 9 | 334 | Small Space of Random Values | Base | Allowed | dense | 0.418 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |

