## Vulnerability Description
htags in GNU Global through 6.6.12 allows code execution in situations where dbpath (aka -d) is untrusted, because shell metacharacters may be used.

### Vulnerability Description Key Phrases
- **impact:** code execution
- **vector:** shell metacharacters
- **product:** GNU Global
- **version:** through 6.6.12
- **component:** dbpath (aka -d)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

The `htags` tool, specifically in `src/htags/htags.c`, takes user-provided input from the `-d` (dbpath) option and directly appends it to a command string that is later executed by the `system()` function. This happens without proper escaping or validation of the input.

**Weaknesses/Vulnerabilities Present:**

- **Command Injection:** The primary vulnerability is command injection. Because the input to `-d` is not sanitized, an attacker can insert arbitrary shell commands within the dbpath string, which will then be executed by the `system()` call.

**Impact of Exploitation:**

- **Arbitrary Command Execution:** An attacker can execute arbitrary shell commands with the privileges of the user running `htags`. This allows them to perform actions such as:
    - Modifying or deleting files.
    - Accessing sensitive data.
    - Installing malware.
    - Potentially gaining full control of the system.

**Attack Vectors:**

- **`--dbpath` Option:** The primary attack vector is through the `-d` or `--dbpath` command line option of the `htags` tool.

**Required Attacker Capabilities/Position:**

- The attacker must be able to execute the `htags` command, and must have control of the arguments passed to this command.

**Technical Details:**

- The vulnerability is located in the `src/htags/htags.c` file, specifically before the patch was applied (revision 1.236).
- The vulnerable code constructs a command by concatenating a string with the user-supplied `dbpath` value.
- The `system()` function is used to execute this constructed command string.
- Successful exploitation is shown by the attacker executing commands like `id` or redirecting the output of `pwd` to a file.

**Mitigation:**

The provided patch addresses the vulnerability by preventing the execution of injected commands, although the specific details of the fix are not provided in the text, and would require looking at the diff file attached to the email. It is noted that the vulnerability is fixed by rejecting the injected commands.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.043 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.038 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.036 |
| 5 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.036 |
| 6 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.036 |
| 7 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.035 |
| 8 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.034 |
| 9 | 553 | Command Shell in Externally Accessible Directory | Variant | Allowed | dense | 0.480 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-121: Stack-based Buffer Overflow

CWE-522: Insufficiently Protected Credentials

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-259: Use of Hard-coded Password

CWE-1390: Weak Authentication

CWE-553: Command Shell in Externally Accessible Directory

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')