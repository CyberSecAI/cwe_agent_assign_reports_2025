## Vulnerability Description
The vulnerability exists in the password storage of Mobateks MobaXterm in versions below 25.0. MobaXTerm uses an initialisation vector (IV) consisting only of zero bytes and a master key to encrypt each password individually. In the default configuration, on opening MobaXTerm, the user is prompted for their password. A derivative of the password is used as the master key. As both the master key and the IV are the same for each stored password, the AES CFB ciphertext depends only on the plaintext (the password). The **static IV and master key** make it easier to obtain sensitive information and to decrypt data when it is stored at rest.

### Vulnerability Description Key Phrases
- **component:** password storage
- **rootcause:** **static IV and master key**
- **weakness:** **uses IV consisting of only zero bytes and master key**
- **product:** Mobateks MobaXterm
- **impact:** obtain sensitive information, decrypt data when at rest
- **version:** below 25.0

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
MobaXTerm uses an initialisation vector (IV) consisting only of zero bytes and a master key to encrypt each password individually.

Weaknesses/vulnerabilities present:
- The static IV and master key make it easier to obtain sensitive information and to decrypt data when it is stored at rest.
- Password reuse can be recognized, as the same password is always encrypted to the same ciphertext.
- Chosen plaintext attacks can be performed, if one or multiple passwords can be recovered.
- The prefix of similar passwords can be recognized if one password is known.

Impact of exploitation:
An attacker that has access to the encrypted passwords can obtain sensitive information and decrypt data.

Attack vectors:
An attacker that has access to the encrypted passwords.

Required attacker capabilities/position:
An attacker with access to the encrypted passwords.

Mitigation or fix:
Manually reencrypt all passwords that were encrypted with a vulnerable version of MobaXterm. The vulnerability was fixed in version 25.0.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | sparse | 0.835 |
| 2 | 329 | Generation of Predictable IV with CBC Mode | Variant | Allowed | sparse | 0.735 |
| 3 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.724 |
| 4 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.686 |
| 5 | 331 | Insufficient Entropy | Base | Allowed | sparse | 0.677 |
| 6 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.677 |
| 7 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.674 |
| 8 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | sparse | 0.662 |
| 9 | 261 | Weak Encoding for Password | Base | Allowed | dense | 0.502 |
| 10 | 257 | Storing Passwords in a Recoverable Format | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1204: Generation of Weak Initialization Vector (IV)

CWE-329: Generation of Predictable IV with CBC Mode

CWE-321: Use of Hard-coded Cryptographic Key

CWE-1391: Use of Weak Credentials

CWE-331: Insufficient Entropy

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-798: Use of Hard-coded Credentials

CWE-312: Cleartext Storage of Sensitive Information

CWE-261: Weak Encoding for Password

CWE-257: Storing Passwords in a Recoverable Format