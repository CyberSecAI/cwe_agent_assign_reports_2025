# Vulnerability Information: CVE-2024-41670

## Vulnerability Description
In the module PayPal Official for PrestaShop 7+ releases prior to version 6.4.2 and for PrestaShop 1.6 releases prior to version 3.18.1, a malicious customer can confirm an order even if payment is finally declined by PayPal. A **logical weakness** during the capture of a payment in case of disabled webhooks can be exploited to create an accepted order. This could allow a threat actor to confirm an order with a fraudulent payment support. Versions 6.4.2 and 3.18.1 contain a patch for the issue. Additionally, users enable webhooks and check they are callable.

### Vulnerability Description Key Phrases
- **weakness:** **logical weakness**
- **impact:** confirm order with fraudulent payment
- **attacker:** malicious customer
- **product:** PayPal Official for PrestaShop
- **version:** 7+ prior to 6.4.2, 1.6 prior to 3.18.1

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "A logical weakness during the capture of a payment in case of disabled webhooks allows a malicious customer to confirm an order as 'payment accepted' even if the payment is ultimately declined by PayPal.",
  "Weaknesses/vulnerabilities present": "Improperly implemented security check for payment status.",
  "Impact of exploitation": "A malicious customer can confirm an order with a fraudulent payment, leading to the processing of an order without receiving actual payment.",
  "Attack vectors": "Network. Exploitation of a logical weakness when webhooks are disabled.",
  "Required attacker capabilities/position": "Low privileges are required. The attacker is a customer with the ability to place orders on the e-commerce platform."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.524 |
| 2 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | Allowed | sparse | 0.520 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.510 |
| 4 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.506 |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.496 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.496 |
| 7 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.496 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.493 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.448 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.002 |

