## Vulnerability Description
liboqs is a C-language cryptographic library that provides implementations of post-quantum cryptography algorithms. A **control-flow timing lean** has been identified in the reference implementation of the Kyber key encapsulation mechanism when it is compiled with Clang 15-18 for `-Os`, `-O1`, and other compilation options. A proof-of-concept local attack on the reference implementation leaks the entire ML-KEM 512 secret key in ~10 minutes using end-to-end decapsulation timing measurements. The issue has been fixed in version 0.10.1. As a possible workaround, some compiler options may produce vectorized code that does not leak secret information, however relying on these compiler options as a workaround may not be reliable.

### Vulnerability Description Key Phrases
- **rootcause:** **control-flow timing lean**
- **impact:** leakage of entire ML-KEM 512 secret key
- **vector:** decapsulation timing measurements
- **product:** liboqs
- **component:** reference implementation of Kyber key encapsulation mechanism

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The `poly_frommsg` function in the Kyber reference implementation, despite source-level mitigations, produces a secret-dependent branch due to compiler optimizations by Clang (versions 15-18) when compiled with certain flags.",
    "weaknesses": [
      "CWE-208: Observable Timing Discrepancy",
      "CWE-385: Insufficiently Protected Credentials"
    ],
    "impact": "A control-flow timing leak allows an attacker to extract the ML-KEM 512 secret key through timing measurements of the decapsulation process. A proof-of-concept local attack can leak the entire key in approximately 10 minutes.",
    "attack_vectors": "The vulnerability can be exploited through timing analysis of the Kyber decapsulation process. The attack is network based since an attacker can send carefully crafted ciphertexts to trigger decapsulation.",
    "required_attacker_capabilities": "The attacker needs to be able to perform timing measurements of the decapsulation process. The attacker does not need any specific privileges."
  },
  "affected_software": {
    "name": "liboqs",
    "versions": "<=0.10.0",
     "patched_versions": "0.10.1 and higher"
  },
  "additional_details": "The vulnerability stems from how Clang optimizes the `poly_frommsg` function when specific compiler flags are used (e.g., `-Os`, `-O1`, `-O2 -fno-vectorize`, `-O3 -fno-vectorize`). This optimization results in a conditional branch based on the message input, which introduces a timing difference exploitable by an attacker."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.628 |
| 2 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.572 |
| 3 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.560 |
| 4 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.559 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.544 |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.535 |
| 7 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.531 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.525 |
| 9 | 1258 | Exposure of Sensitive System Information Due to Uncleared Debug Information | Base | Allowed | dense | 0.452 |
| 10 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-208: Observable Timing Discrepancy

CWE-347: Improper Verification of Cryptographic Signature

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-203: Observable Discrepancy

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-1391: Use of Weak Credentials

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-1258: Exposure of Sensitive System Information Due to Uncleared Debug Information

CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer