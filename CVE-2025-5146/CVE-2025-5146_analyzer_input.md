# Vulnerability Information: CVE-2025-5146

## Vulnerability Description
A vulnerability has been found in Netcore NBR1005GPEV2, B6V2, COVER5, NAP830, NAP930, NBR100V2 and NBR200V2 up to 20250508 and classified as critical. This vulnerability affects the function passwd_set of the file /usr/bin/routerd of the component HTTP Header Handler. The manipulation of the argument pwd leads to command injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **component:** /usr/bin/routerd
- **vector:** pwd argument
- **weakness:** **command injection, weakness**
- **product:** Netcore NBR1005GPEV2, B6V2, COVER5, NAP830, NAP930, NBR100V2 and NBR200V2
- **version:** up to 20250508

## CVE Reference Links Content Summary
Here's an analysis of the provided content regarding CVE-2025-5146:

The content from github.com describes a command injection vulnerability in Netcore routers and wireless APs. It contains detailed information, including affected products, vulnerability causes, proof of concept (POC), and a recommended solution, going far beyond the typical scope of a CVE description.

Here's a breakdown:

*   **Root cause of vulnerability:** The vulnerability stems from insufficient input validation in the `passwd_set` method within the `routerd` service. Specifically, the password field is directly passed to the `passwd_set_api` function without any sanitization or validation. This, in turn, allows for command injection. The `passwd_set_api` function uses `popen` to execute commands.
*   **Weaknesses/vulnerabilities present:**
    *   Command injection: The primary vulnerability is the ability to inject arbitrary commands into the system through the password field.
    *   Lack of input validation: The core weakness is the absence of proper input validation, particularly on the password field when calling `passwd_set_api`.
*   **Impact of exploitation:** Successful exploitation leads to arbitrary command execution on the vulnerable device. This could potentially lead to full system compromise, data theft, or denial of service.
*   **Attack vectors:** The attack vector involves sending a crafted HTTP POST request to the `/ubus` endpoint of the router. The request includes a JSON payload that specifies the `routerd` service and the `passwd_set` method, with a malicious command injected into the `pwd` parameter. The attacker needs to know a valid session ID to exploit the vulnerability, which must be obtained after login.
*   **Required attacker capabilities/position:** The attacker needs to:
    *   Have network access to the vulnerable device.
    *   Know the IP address of the device
    *   Authenticate to the web interface of the router to obtain a session ID.
    *   Craft a malicious HTTP POST request with a valid session ID and a command injection payload.
*   **Mitigation or fix:**
    *   The recommended solution is to apply the same validation logic used for the username (allowing only underscores, letters, and numbers) to the password field.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.470 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.436 |
| 5 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.388 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.376 |
| 7 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.373 |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.372 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.650 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

