# Raw Retriever Results for CVE-2024-9617

# Raw Retriever Results for CVE-2024-9617
## Query
An IDOR vulnerability in danswer-ai/danswer v0.3.94 allows an attacker to view any files. The application does not verify whether the attacker is the creator of the file, allowing the attacker to directly call the GET /api/chat/file/{file_id} interface to view any users file.

## Keyphrases
- **rootcause**: 'lack of access control verification'
- **weakness**: 'IDOR'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4472 | 0.5343 | 0.4849 | 0.4939 | 20 |
| Sparse | 246.8084 | 1000.0000 | 346.1119 | 300.2272 | 13 |
| Graph | 0.9624 | 2.3998 | 1.3133 | 1.0928 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | base | 2.3998 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | base | 2.3296 | Allowed |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.7061 | Allowed |
| 4 | 552 | Files or Directories Accessible to External Parties | Base | 1.6346 | Allowed |
| 5 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.5024 | Allowed |
| 6 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 1.4970 | Allowed |
| 7 | 863 | Incorrect Authorization | class | 1.4080 | Allowed-with-Review |
| 8 | 862 | Missing Authorization | class | 1.3648 | Allowed-with-Review |
| 9 | 322 | Key Exchange without Entity Authentication | base | 1.3572 | Allowed |
| 10 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | base | 1.1794 | Allowed |
| 11 | 804 | Guessable CAPTCHA | base | 1.0062 | Allowed |
| 12 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | base | 1.0062 | Allowed |
| 13 | 1244 | Internal Asset Exposed to Unsafe Debug Access Level or State | base | 1.0062 | Allowed |
| 14 | 939 | Improper Authorization in Handler for Custom URL Scheme | base | 1.0062 | Allowed |
| 15 | 1314 | Missing Write Protection for Parametric Data Values | base | 1.0062 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 552 | Files or Directories Accessible to External Parties | Base | 0.5343 | 0.5343 | Allowed |
| 2 | 24 | Path Traversal: '../filedir' | Variant | 0.5262 | 0.5262 | Allowed |
| 3 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.5126 | 0.5126 | Allowed |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5102 | 0.5102 | Allowed |
| 5 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | 0.5073 | 0.5073 | Allowed |
| 6 | 25 | Path Traversal: '/../filedir' | Variant | 0.5050 | 0.5050 | Allowed |
| 7 | 204 | Observable Response Discrepancy | Base | 0.5039 | 0.5039 | Allowed |
| 8 | 69 | Improper Handling of Windows ::DATA Alternate Data Stream | Variant | 0.4989 | 0.4989 | Allowed |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.4970 | 0.4970 | Allowed |
| 10 | 36 | Absolute Path Traversal | Base | 0.4968 | 0.4968 | Allowed |
| 11 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4910 | 0.4910 | Allowed |
| 12 | 202 | Exposure of Sensitive Information Through Data Queries | Base | 0.4891 | 0.4891 | Allowed |
| 13 | 425 | Direct Request ('Forced Browsing') | Base | 0.4591 | 0.4591 | Allowed |
| 14 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.4574 | 0.4574 | Allowed |
| 15 | 548 | Exposure of Information Through Directory Listing | Variant | 0.4573 | 0.4573 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | 1000.0000 | 1000.0000 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | 319.6346 | 319.6346 | Allowed |
| 3 | 863 | Incorrect Authorization | 315.3447 | 315.3447 | Allowed-with-Review |
| 4 | 862 | Missing Authorization | 308.2372 | 308.2372 | Allowed-with-Review |
| 5 | 347 | Improper Verification of Cryptographic Signature | 306.7237 | 306.7237 | Allowed |
| 6 | 285 | Improper Authorization | 306.4901 | 306.4901 | Discouraged |
| 7 | 532 | Insertion of Sensitive Information into Log File | 300.2272 | 300.2272 | Allowed |
| 8 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | 299.7858 | 299.7858 | Discouraged |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | 299.2391 | 299.2391 | Allowed |
| 10 | 1390 | Weak Authentication | 298.3911 | 298.3911 | Allowed-with-Review |
| 11 | 288 | Authentication Bypass Using an Alternate Path or Channel | 250.6936 | 250.6936 | Allowed |
| 12 | 204 | Observable Response Discrepancy | 247.8786 | 247.8786 | Allowed |
| 13 | 201 | Insertion of Sensitive Information Into Sent Data | 246.8084 | 246.8084 | Allowed |
