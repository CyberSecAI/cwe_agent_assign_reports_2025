# Vulnerability Information: CVE-2025-0374

## Vulnerability Description
When etcupdate encounters conflicts while merging files, it saves a version containing conflict markers in /var/db/etcupdate/conflicts. This version does not preserve the mode of the input file, and is world-readable. This applies to files that would normally have restricted visibility, such as /etc/master.passwd. An unprivileged local user may be able to read encrypted root and user passwords from the temporary master.passwd file created in /var/db/etcupdate/conflicts. This is possible only when conflicts within the password file arise during an update, and the unprotected file is deleted when conflicts are resolved.

### Vulnerability Description Key Phrases
- **weakness:** **world-readable master.passwd file in /var/db/etcupdate/conflicts**
- **impact:** read encrypted root and user passwords
- **attacker:** unprivileged local user
- **component:** etcupdate

## CVE Reference Links Content Summary
## Analysis of CVE-2025-0374 based on provided content

The provided content from security.freebsd.org relates to CVE-2025-0374. The content from security.netapp.com is unusable as it requires JavaScript.

Here's a breakdown of the vulnerability information extracted from the FreeBSD security advisory:

**Root cause of vulnerability:**

When `etcupdate` encounters conflicts during file merging, it saves a version with conflict markers to `/var/db/etcupdate/conflicts`. This temporary file does not preserve the original file's permissions and is world-readable.

**Weaknesses/vulnerabilities present:**

*   Insecure file permissions on conflict files created by `etcupdate`.
*   Loss of file mode (permissions) during conflict resolution.

**Impact of exploitation:**

An unprivileged local user can read sensitive information, specifically encrypted root and user passwords, from the temporary `master.passwd` file if conflicts arise during an update and the unprotected file is not promptly deleted.

**Attack vectors:**

*   Local access to a FreeBSD system.
*   Triggering conflicts during an `etcupdate` operation (e.g., by manually modifying files that `etcupdate` manages).

**Required attacker capabilities/position:**

*   Unprivileged local user account on the affected FreeBSD system.

**Mitigation or fix:**

*   Upgrade to a supported FreeBSD stable or release/security branch dated after the correction date (January 28, 2025, or January 29, 2025, depending on the branch).
*   Update via `freebsd-update(8)` or by applying the provided patch and recompiling the system.
*   Avoid using `etcupdate` if possible, and use `freebsd-update(8)` instead.

**Additional Details (more than official CVE description):**

*   Specific Git commit hashes are provided for each affected branch, allowing for precise identification of the fix.
*   Instructions for updating via binary patch (`freebsd-update`) and source code patch are detailed.
*   Affected FreeBSD versions are explicitly listed (13.4, 14.1, 14.2).
*   The advisory includes information about verifying the patch's signature using GPG.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 563 | Assignment to Variable without Use | Base | Allowed | alternate_terms | 0.700 |
| 2 | 621 | Variable Extraction Error | Variant | Allowed | alternate_terms | 0.700 |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.500 |
| 4 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.483 |
| 5 | 653 | Improper Isolation or Compartmentalization | Class | Allowed | sparse | 0.472 |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.471 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.466 |
| 8 | 277 | Insecure Inherited Permissions | Variant | Allowed | sparse | 0.465 |
| 9 | 620 | Unverified Password Change | Base | Allowed | dense | 0.511 |
| 10 | 260 | Password in Configuration File | Base | Allowed | graph | 0.002 |

