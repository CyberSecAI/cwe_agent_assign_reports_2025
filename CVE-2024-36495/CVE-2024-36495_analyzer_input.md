# Vulnerability Information: CVE-2024-36495

## Vulnerability Description
The application Faronics WINSelect (Standard + Enterprise) saves its configuration in an encrypted file on the file system which Everyone has read and write access to, path to file C\ProgramData\WINSelect\WINSelect.wsd The path for the affected WINSelect Enterprise configuration file is C\ProgramData\Faronics\StorageSpace\WS\WINSelect.wsd

### Vulnerability Description Key Phrases
- **product:** Faronics WINSelect

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerabilities associated with CVE-2024-36495, CVE-2024-36496, and CVE-2024-36497:

**Root Cause of Vulnerabilities:**
The root cause of these vulnerabilities lies in a combination of insecure file handling, weak encryption practices, and the storage of sensitive information in plaintext within Faronics WINSelect.

**Weaknesses/Vulnerabilities Present:**

1.  **CVE-2024-36495: Insecure File Permissions:**
    *   **Weakness:** The configuration file (`WINSelect.wsd`) is stored with read and write permissions for "Everyone". While the file is locked by the `WSEngine.exe` process during normal operation, this default permission allows for modification of the file when the process is not running or if the attacker has a way to bypass this lock.
    *   **Vulnerability:** This allows any local user to read and potentially modify the configuration file.

2.  **CVE-2024-36496: Hardcoded Credentials and Weak Encryption:**
    *   **Weakness:** The configuration file is encrypted using a static key derived from a hardcoded password ("Kunal"). The encryption key is generated by hashing this password using the MD5 algorithm without salt, and using the first 5 bytes of the hash as the RC4 key.
    *   **Vulnerability:** This weak encryption allows an attacker to easily decrypt the configuration file, as the key derivation process is easily reproduced.

3.  **CVE-2024-36497: Unhashed Password Storage:**
    *   **Weakness:** The decrypted configuration file stores the WINSelect administrator password in plaintext.
    *  **Vulnerability:** After decrypting the file, an attacker can retrieve the administrator password, allowing complete control over the application settings.

**Impact of Exploitation:**
An attacker who successfully exploits these vulnerabilities can:

*   **Completely bypass WINSelect:** By decrypting the configuration file, obtaining the administrator password, they can disable all restrictions imposed by WINSelect.
*   **Remove restrictions:** This includes disabling kiosk mode, application restrictions, and any other security measures enforced by WINSelect.
*   **Gain control over the system:** With WINSelect disabled, the attacker gains more freedom to manipulate the system and potentially perform other malicious actions.

**Attack Vectors:**
The primary attack vector for these vulnerabilities is **local access**. An attacker needs to have local access to the machine where WINSelect is installed.

**Required Attacker Capabilities/Position:**
An attacker requires the following capabilities:

*   **Local User Access:** They must have a valid user account on the target machine with access to the file system.
*   **Technical Knowledge:** They need the ability to use API monitoring tools, decrypt files, and understand basic security concepts to exploit the hardcoded credentials and extract the password.
*   **Ability to execute scripts:** They need to be able to execute a script to decrypt the config file

**Summary of Attack Steps**
1. Access the `WINSelect.wsd` config file (Standard or Enterprise paths)
2. Decrypt the config file using the provided python script which uses the hardcoded "Kunal" password and MD5/RC4
3. Extract the plaintext admin password from the decrypted file.
4. Use the admin password to disable WINSelect

**Additional Notes:**

*   The advisory notes that the vendor has released a patch (version 8.30.xx.903) that addresses these issues with the use of PBKDF2 with SHA256 and 600000 iterations for password storage. However, the hardcoded key issue was not resolved in this patch.
*   The provided python script from the advisory can be used to decrypt the `WINSelect.wsd` config file.
*   The vulnerabilities impact both the standard and enterprise versions of Faronics WINSelect.
*   The vulnerabilities were discovered by Daniel Hirschberger from SEC Consult Vulnerability Lab.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.096 |
| 2 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.089 |
| 3 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.086 |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.081 |
| 5 | 428 | Unquoted Search Path or Element | Base | Allowed | sparse | 0.078 |
| 6 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.076 |
| 7 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.076 |
| 8 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.074 |
| 9 | 313 | Cleartext Storage in a File or on Disk | Variant | Allowed | dense | 0.418 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |

