# Vulnerability Information: CVE-2024-47910

## Vulnerability Description
An issue was discovered in SonarSource SonarQube before 9.9.5 LTA and 10.x before 10.5. A SonarQube user with the Administrator role can modify an existing configuration of a GitHub integration to exfiltrate a pre-signed JWT.

### Vulnerability Description Key Phrases
- **impact:** exfiltrate a pre-signed JWT
- **vector:** modify an existing configuration of a GitHub integration
- **attacker:** SonarQube user with the Administrator role
- **product:** SonarSource SonarQube
- **version:** before 9.9.5 LTA and 10.x before 10.5

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   A vulnerability existed in the way SonarQube handled GitHub integration configurations. Specifically, an administrator could modify the GitHub API URL without providing a Private Key for verification.

**Weaknesses/Vulnerabilities:**

*   **Insecure Configuration Modification:** The vulnerability allowed modification of the GitHub integration configuration (specifically the API URL) without proper verification.

**Impact of Exploitation:**

*   **JWT Exfiltration:** A malicious administrator could modify the GitHub API URL to point to a location under their control and exfiltrate a pre-signed JWT (JSON Web Token). This JWT could then potentially be used to gain unauthorized access to resources that rely on this token.

**Attack Vectors:**

*   The attack vector is through the SonarQube application's configuration interface for the GitHub integration.
*   An attacker would need administrative access to the SonarQube instance.

**Required Attacker Capabilities/Position:**

*   **Administrator Access:** The attacker must have administrator-level privileges within the SonarQube instance.
*   **SonarQube Interface:** The attacker would need to access the SonarQube web interface to modify the GitHub integration settings.

**Mitigation:**

*   The vulnerability is mitigated by forcing administrators to provide a Private Key for verification when modifying the GitHub API URL.

**Versions Affected:**

*   Versions prior to 9.9.5 LTA and 10.5 are affected.

**Patched Versions:**

*   9.9.5 LTA and 10.5 (released on June 25th) included the fix.
*   Latest bug fixes and security patches are available in 9.9.6 LTA and 10.6.

**Additional Notes:**

*   The vulnerability was discovered by security researchers at Synacktiv on February 19, 2024.
*   There is no known exploitation of this vulnerability in the wild.
*   The CVSS score assigned is 6.5, which is considered medium severity.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.077 |
| 2 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.074 |
| 3 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.073 |
| 4 | 267 | Privilege Defined With Unsafe Actions | Base | Allowed | sparse | 0.072 |
| 5 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.071 |
| 6 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.071 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.071 |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.071 |
| 9 | 862 | Missing Authorization | Class | Allowed-with-Review | dense | 0.506 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

