# Raw Retriever Results for CVE-2024-39476

# Raw Retriever Results for CVE-2024-39476
## Query
In the Linux kernel, the following vulnerability has been resolved md/raid5 fix deadlock that raid5d() wait for itself to clear MD_SB_CHANGE_PENDING Xiao reported that lvm2 test lvconvert-raid-takeover.sh can hang with small possibility, the root cause is exactly the same as commit bed9e27baf52 (Revert md/raid5 Wait for MD_SB_CHANGE_PENDING in raid5d) However, Dan reported another hang after that, and junxiao investigated the problem and found out that this is caused by plugged bio cant issue from raid5d(). Current implementation in raid5d() has a weird dependence 1) md_check_recovery() from raid5d() must hold reconfig_mutex to clear MD_SB_CHANGE_PENDING 2) raid5d() handles IO in a deadloop, until all IO are issued 3) IO from raid5d() must wait for MD_SB_CHANGE_PENDING to be cleared This behaviour is introduce before v2.6, and for consequence, if other context hold reconfig_mutex, and md_check_recovery() cant update super_block, then raid5d() will waste one cpu 100% by the deadloop, until reconfig_mutex is released. Refer to the implementation from raid1 and raid10, fix this problem by skipping issue IO if MD_SB_CHANGE_PENDING is still set after md_check_recovery(), daemon thread will be woken up when reconfig_mutex is released. Meanwhile, the hang problem will be fixed as well.

## Keyphrases
- **rootcause**: 'deadlock caused by circular dependency'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3996 | 0.5032 | 0.4198 | 0.4144 | 20 |
| Sparse | 260.0190 | 842.5191 | 758.8171 | 798.1487 | 11 |
| Graph | 1.4602 | 2.6100 | 1.8160 | 1.6901 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 2.6100 | Allowed |
| 2 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 3 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | base | 2.2100 | Allowed |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | base | 2.1190 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 6 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 7 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 9 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 10 | 833 | Deadlock | Base | 1.6954 | Allowed |
| 11 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 12 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.6746 | Allowed-with-Review |
| 14 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 15 | 413 | Improper Resource Locking | Base | 1.6721 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5032 | 0.5032 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.4547 | 0.4547 | Allowed-with-Review |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4326 | 0.4326 | Allowed-with-Review |
| 4 | 413 | Improper Resource Locking | Base | 0.4323 | 0.4323 | Allowed |
| 5 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4322 | 0.4322 | Allowed |
| 6 | 909 | Missing Initialization of Resource | Class | 0.4299 | 0.4299 | Allowed-with-Review |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4266 | 0.4266 | Allowed |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4159 | 0.4159 | Allowed |
| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4149 | 0.4149 | Discouraged |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4149 | 0.4149 | Allowed |
| 11 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4140 | 0.4140 | Allowed |
| 12 | 911 | Improper Update of Reference Count | Base | 0.4075 | 0.4075 | Allowed |
| 13 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4037 | 0.4037 | Allowed |
| 14 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4036 | 0.4036 | Allowed |
| 15 | 126 | Buffer Over-read | Variant | 0.4035 | 0.4035 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 842.5191 | 842.5191 | Allowed-with-Review |
| 2 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 821.7901 | 821.7901 | Allowed |
| 3 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 820.7995 | 820.7995 | Allowed |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | 816.8802 | 816.8802 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 807.5883 | 807.5883 | Allowed-with-Review |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | 798.1487 | 798.1487 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | 796.0351 | 796.0351 | Allowed |
| 8 | 1390 | Weak Authentication | 794.8530 | 794.8530 | Allowed-with-Review |
| 9 | 787 | Out-of-bounds Write | 794.8475 | 794.8475 | Allowed |
| 10 | 833 | Deadlock | 793.5077 | 793.5077 | Allowed |
| 11 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 260.0190 | 260.0190 | Allowed |
