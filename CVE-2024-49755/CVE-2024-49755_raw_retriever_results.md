# Raw Retriever Results for CVE-2024-49755

# Raw Retriever Results for CVE-2024-49755
## Query
Duende IdentityServer is an OpenID Connect and OAuth 2.x framework for ASP.NET Core. IdentityServers local API authentication handler performs insufficient validation of the cnf claim in DPoP access tokens. This allows an attacker to use leaked DPoP access tokens at local api endpoints even without possessing the private key for signing proof tokens. Note that this only impacts custom endpoints within an IdentityServer implementation that have explicitly used the LocalApiAuthenticationHandler for authentication. This vulnerability is patched in IdentityServer 7.0.8. Version 6.3 and below are unaffected, as they do not support DPoP in Local APIs.

## Keyphrases
- **rootcause**: 'insufficient validation of the cnf claim in DPoP access tokens'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3901 | 0.5196 | 0.4203 | 0.4129 | 20 |
| Sparse | 157.1364 | 571.5871 | 499.3965 | 523.9144 | 11 |
| Graph | 1.3747 | 2.4700 | 1.7759 | 1.6529 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 306 | Missing Authentication for Critical Function | base | 2.4700 | Allowed |
| 2 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 4 | 567 | Unsynchronized Access to Shared Data in a Multithreaded Context | base | 2.2100 | Allowed |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 6 | 52 | Path Equivalence: '/multiple/trailing/slash//' | variant | 2.0400 | Allowed |
| 7 | 46 | Path Equivalence: 'filename ' (Trailing Space) | variant | 2.0400 | Allowed |
| 8 | 173 | Improper Handling of Alternate Encoding | variant | 2.0400 | Allowed |
| 9 | 603 | Use of Client-Side Authentication | Base | 1.6745 | Allowed |
| 10 | 289 | Authentication Bypass by Alternate Name | Base | 1.6737 | Allowed |
| 11 | 433 | Unparsed Raw Web Content Delivery | variant | 1.6320 | Allowed |
| 12 | 488 | Exposure of Data Element to Wrong Session | Base | 1.5893 | Allowed |
| 13 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 14 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 15 | 613 | Insufficient Session Expiration | Base | 1.5028 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 556 | ASP.NET Misconfiguration: Use of Identity Impersonation | Variant | 0.5196 | 0.5196 | Allowed |
| 2 | 520 | .NET Misconfiguration: Use of Impersonation | Variant | 0.4918 | 0.4918 | Allowed |
| 3 | 289 | Authentication Bypass by Alternate Name | Base | 0.4427 | 0.4427 | Allowed |
| 4 | 488 | Exposure of Data Element to Wrong Session | Base | 0.4402 | 0.4402 | Allowed |
| 5 | 603 | Use of Client-Side Authentication | Base | 0.4362 | 0.4362 | Allowed |
| 6 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4317 | 0.4317 | Allowed |
| 7 | 554 | ASP.NET Misconfiguration: Not Using Input Validation Framework | Variant | 0.4315 | 0.4315 | Allowed |
| 8 | 1270 | Generation of Incorrect Security Tokens | Base | 0.4285 | 0.4285 | Allowed |
| 9 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.4229 | 0.4229 | Allowed |
| 10 | 602 | Client-Side Enforcement of Server-Side Security | Class | 0.4223 | 0.4223 | Allowed-with-Review |
| 11 | 204 | Observable Response Discrepancy | Base | 0.4035 | 0.4035 | Allowed |
| 12 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | 0.3965 | 0.3965 | Allowed |
| 13 | 1385 | Missing Origin Validation in WebSockets | Variant | 0.3951 | 0.3951 | Allowed |
| 14 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.3936 | 0.3936 | Allowed |
| 15 | 1174 | ASP.NET Misconfiguration: Improper Model Validation | Variant | 0.3931 | 0.3931 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | 571.5871 | 571.5871 | Allowed |
| 2 | 863 | Incorrect Authorization | 557.8095 | 557.8095 | Allowed-with-Review |
| 3 | 287 | Improper Authentication | 548.9556 | 548.9556 | Discouraged |
| 4 | 1390 | Weak Authentication | 541.8997 | 541.8997 | Allowed-with-Review |
| 5 | 306 | Missing Authentication for Critical Function | 527.0848 | 527.0848 | Allowed |
| 6 | 347 | Improper Verification of Cryptographic Signature | 523.9144 | 523.9144 | Allowed |
| 7 | 522 | Insufficiently Protected Credentials | 520.2225 | 520.2225 | Allowed-with-Review |
| 8 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | 515.6770 | 515.6770 | Discouraged |
| 9 | 532 | Insertion of Sensitive Information into Log File | 514.6578 | 514.6578 | Allowed |
| 10 | 284 | Improper Access Control | 514.4166 | 514.4166 | Discouraged |
| 11 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 157.1364 | 157.1364 | Allowed-with-Review |
