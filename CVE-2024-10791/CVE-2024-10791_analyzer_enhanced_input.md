## Vulnerability Description
A vulnerability, which was classified as critical, has been found in Codezips Hospital Appointment System 1.0. This issue affects some unknown processing of the file /doctorAction.php. The manipulation of the argument Name leads to **sql injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The initial researcher advisory mentions contradicting file and parameter names to be affected.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** Codezips Hospital Appointment System
- **version:** 1
- **component:** /doctorAction.php

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-10791.

**Root cause of vulnerability:**
The root cause is a SQL injection vulnerability in the `docterAction.php` file. This is due to the lack of proper sanitization or validation of user-supplied input from the "Username" parameter. This parameter is directly used in SQL queries.

**Weaknesses/vulnerabilities present:**
- SQL Injection: The primary vulnerability is the injection of malicious SQL code through the "Username" parameter.

**Impact of exploitation:**
- Unauthorized database access
- Sensitive data leakage
- Data tampering
- Comprehensive system control
- Service interruption

**Attack vectors:**
- The vulnerability is triggered by sending a crafted POST request to the `docterAction.php` file with a malicious payload in the "Username" parameter. The "branch" parameter is also present in the requests, but it does not seem to be related to the vulnerability itself.
-  No login or authorization is required to exploit this vulnerability.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP POST requests to the vulnerable server.
- The attacker doesn't need any prior authentication or authorization.

**Additional details:**
- The issue was discovered during a security review of the "Hospital Appointment System In PHP With Source Code."
- The vulnerability can be exploited using boolean-based blind, error-based, and time-based blind SQL injection techniques.
- The provided payload examples demonstrate how to exploit these different injection techniques.
- SQLMap was used to verify the vulnerability.
- Suggested repairs include using prepared statements, input validation, minimizing database user permissions, and regular security audits.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.464 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.390 |
| 4 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.384 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.378 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.374 |
| 7 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.354 |
| 8 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.350 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.565 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-117: Improper Output Neutralization for Logs

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-266: Incorrect Privilege Assignment

CWE-341: Predictable from Observable State

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-425: Direct Request ('Forced Browsing')