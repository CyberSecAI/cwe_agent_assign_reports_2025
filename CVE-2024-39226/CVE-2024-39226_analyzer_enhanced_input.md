## Vulnerability Description
GL-iNet products AR750/AR750S/AR300M/AR300M16/MT300N-V2/B1300/MT1300/SFT1200/X750 v4.3.11, MT3000/MT2500/AXT1800/AX1800/A1300/X300B v4.5.16, XE300 v4.3.16, E750 v4.3.12, AP1300/S1300 v4.3.13, and XE3000/X3000 v4.4 were discovered to contain a vulnerability can be exploited to manipulate routers by passing malicious shell commands through the s2s API.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **impact:** execute malicious shell commands
- **product:** GL-iNet products
- **version:** v4.3.11 and v4.5.16 and v4.3.16 and v4.3.12 and v4.3.13 and v4.4
- **component:** s2s API

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from insufficient input sanitization in the s2s API, allowing an attacker to inject arbitrary shell commands through the `port` parameter.

**Weaknesses/Vulnerabilities:**
- **Shell Injection:** The primary vulnerability is shell injection. The application does not properly sanitize user-provided input that is passed to a shell command, leading to the execution of arbitrary commands.
- **Insecure API:** The s2s API is vulnerable due to the lack of input validation.

**Impact of Exploitation:**
- **Arbitrary Command Execution:** Successful exploitation allows an attacker to execute arbitrary shell commands on the router.
- **Router Manipulation:**  Attackers can gain control and manipulate the router, potentially leading to data exfiltration, denial of service, or other malicious activities.

**Attack Vectors:**
- **Network Access:** An attacker needs network access to the router's API to send the malicious request.
- **s2s API:** The vulnerability is exploited by making a crafted request to the s2s API, specifically targeting the `enable_echo_server` method.
- **HTTP Request:** The provided example shows how the vulnerability can be exploited using a `curl` request.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker must have network connectivity to reach the affected router and its s2s interface.
- **API Knowledge:** Some understanding of the s2s API is required to craft the malicious request, but the provided curl command significantly reduces the technical bar.

**Additional Notes:**
- The provided content gives explicit examples of how to exploit the vulnerability.
- The content includes a list of affected devices and firmware versions that were vulnerable.
- A patch has been released for each of the listed devices, making them no longer vulnerable.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.266 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.262 |
| 5 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.253 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.246 |
| 7 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.241 |
| 8 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.241 |
| 9 | 326 | Inadequate Encryption Strength | Class | Allowed-with-Review | dense | 0.567 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-121: Stack-based Buffer Overflow

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-400: Uncontrolled Resource Consumption

CWE-790: Improper Filtering of Special Elements

CWE-259: Use of Hard-coded Password

CWE-208: Observable Timing Discrepancy

CWE-326: Inadequate Encryption Strength

CWE-410: Insufficient Resource Pool