## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved ima fix **buffer overrun** in ima_eventdigest_init_common Function ima_eventdigest_init() calls ima_eventdigest_init_common() with HASH_ALGO__LAST which is then used to access the array hash_digest_size[] leading to **buffer overrun**. Have a conditional statement to handle this.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overrun**
- **product:** Linux kernel
- **component:** ima_eventdigest_init() function

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability lies in the `ima_eventdigest_init_common` function within the Integrity Measurement Architecture (IMA) subsystem of the Linux kernel. This function is used to initialize a digest in an IMA event. When a digest is not present (e.g., during a violation measurement), the function attempts to make room for it by increasing an offset. This offset is incremented by the digest size based on the provided `hash_algo`. However, the code was calling  `ima_eventdigest_init_common` with `HASH_ALGO__LAST` which is used as an index into the `hash_digest_size` array which would lead to a buffer over-read and write.

**Vulnerability:**
- **Buffer Overrun:** The primary vulnerability is a buffer overrun. By calling `ima_eventdigest_init_common` with  `HASH_ALGO__LAST` which is outside the bounds of the `hash_digest_size` array, the code would perform a read outside the bounds of the array, leading to a buffer over-read and subsequent buffer-overrun when attempting to write with this invalid size.

**Impact of Exploitation:**
- **Memory Corruption:** The buffer overrun could lead to memory corruption, potentially overwriting critical kernel data.
- **System Instability:** This corruption could result in system crashes, unpredictable behavior, and denial of service.
- **Potential for Privilege Escalation:** In some scenarios, carefully crafted memory corruption can be used to gain elevated privileges, although the information does not give specific details how this can be achieved with this vulnerability.

**Attack Vectors:**
- The vulnerability is triggered when creating an IMA event, specifically during violation measurements where a digest is not present
- The `ima_eventdigest_init_common` function is called with  `HASH_ALGO__LAST`

**Required Attacker Capabilities/Position:**
- The attacker needs to trigger an IMA event where the digest is absent, typically a violation measurement, and cause the `ima_eventdigest_init_common` to be called with `HASH_ALGO__LAST`. This can be achieved by actions that would trigger IMA policy violations.
- The attacker needs to have the ability to cause an IMA event that triggers the vulnerable code path. This may involve certain system operations or modifying files in a way that triggers the configured IMA policy.

**Additional Details:**
- The fix introduces a conditional statement to handle the `HASH_ALGO__LAST` case. If the hash algorithm is not specified or invalid (`hash_algo < HASH_ALGO__LAST`), the code will increase the offset by the size of either SHA1 or MD5 digest size.

This vulnerability is present in Linux kernel versions prior to the fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.263 |
| 3 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.237 |
| 4 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.233 |
| 5 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.222 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.217 |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.212 |
| 8 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.208 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.554 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-125: Out-of-bounds Read

CWE-193: Off-by-one Error

CWE-909: Missing Initialization of Resource

CWE-190: Integer Overflow or Wraparound

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-126: Buffer Over-read

CWE-128: Wrap-around Error