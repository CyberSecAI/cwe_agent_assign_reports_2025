## Vulnerability Description
A Denial of Service (DoS) condition has been discovered in GitLab CE/EE affecting all versions starting with 15.9 before 17.0.6, 17.1 prior to 17.1.4, and 17.2 prior to 17.2.2. It is possible for an attacker to cause catastrophic backtracking while parsing results from Elasticsearch.

### Vulnerability Description Key Phrases
- **impact:** Denial of Service (DoS)
- **vector:** catastrophic backtracking
- **product:** GitLab CE/EE
- **version:** 15.9 to 17.0.6 and 17.1 prior to 17.1.4 and 17.2 prior to 17.2.2

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A regular expression used for highlighting search results in code can cause catastrophic backtracking when processing very long lines with matches.
- **Weaknesses/vulnerabilities present:** Regular expression denial-of-service (ReDoS) vulnerability due to an inefficient regular expression pattern.
- **Impact of exploitation:**  An attacker can cause high CPU usage on the GitLab server by sending a large number of search requests with very long lines containing matches, potentially leading to denial of service.
- **Attack vectors:** The vulnerability is triggered through the search functionality of GitLab. An attacker needs to send a search query with `scope=blobs` that returns a result containing very long lines with matches.
- **Required attacker capabilities/position:** The attacker needs to have access to a GitLab instance and be able to send search requests. They do not need any specific privileges beyond this. They need to craft search queries that will return results with very long lines with matches.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.125 |
| 2 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.122 |
| 3 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.121 |
| 4 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | Allowed | sparse | 0.110 |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.109 |
| 6 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.109 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.107 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.105 |
| 9 | 863 | Incorrect Authorization | Class | Allowed-with-Review | dense | 0.498 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1333: Inefficient Regular Expression Complexity

CWE-400: Uncontrolled Resource Consumption

CWE-696: Incorrect Behavior Order

CWE-1286: Improper Validation of Syntactic Correctness of Input

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-755: Improper Handling of Exceptional Conditions

CWE-285: Improper Authorization

CWE-121: Stack-based Buffer Overflow

CWE-863: Incorrect Authorization

CWE-410: Insufficient Resource Pool