# Vulnerability Information: CVE-2024-40585

## Vulnerability Description
An insertion of sensitive information into log file vulnerabilities [CWE-532] in FortiManager version 7.4.0, version 7.2.3 and below, version 7.0.8 and below, version 6.4.12 and below, version 6.2.11 and below and FortiAnalyzer version 7.4.0, version 7.2.3 and below, version 7.0.8 and below, version 6.4.12 and below, version 6.2.11 and below eventlog may allow any low privileged user with access to event log section to retrieve certificate private key and encrypted password logged as system log.

### Vulnerability Description Key Phrases
- **component:** eventlog
- **weakness:** **information disclosure**
- **product:** FortiManager, FortiAnalyzer
- **impact:** retrieve certificate private key and encrypted password
- **attacker:** any low privileged user
- **version:** ['7.4.0', '7.2.3 and below', '7.0.8 and below', '6.4.12 and below', '6.2.11 and below']

## CVE Reference Links Content Summary
```json
{
  "CVE": "CVE-2024-40585",
  "content": [
    {
      "extracted_data": {
        "Root cause of vulnerability": "An insertion of sensitive information into log file vulnerabilities [CWE-532]",
        "Weaknesses/vulnerabilities present": "Allows any low privileged user with access to event log section to retrieve certificate private key and encrypted password logged as system log.",
        "Impact of exploitation": "Information disclosure",
        "Attack vectors": "Access to the event log section.",
        "Required attacker capabilities/position": "Any low privileged user with access to event log section.",
        "Mitigation or fix": "Upgrade to FortiAnalyzer 7.4.1 or above, 7.2.4 or above, 7.0.9 or above, 6.4.13 or above, 6.2.12 or above, or migrate to a fixed release for FortiManager 6.4 and 6.2 versions.",
        "Affected products": "FortiAnalyzer 7.4.0, 7.2.0 through 7.2.3, 7.0.0 through 7.0.8, 6.4.0 through 6.4.12, 6.2.0 through 6.2.11, and FortiManager 7.4.0, 7.2.0 through 7.2.3, 7.0.0 through 7.0.8, 6.4 all versions, 6.2 all versions"
      },
      "source": "fortiguard.fortinet.com_32395505_20250624_180636.html",
      "more_detail": "Yes"
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.550 |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.524 |
| 4 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.522 |
| 5 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.520 |
| 6 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.519 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.504 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.503 |
| 9 | 778 | Insufficient Logging | Base | Allowed | dense | 0.632 |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | Allowed | graph | 0.002 |

