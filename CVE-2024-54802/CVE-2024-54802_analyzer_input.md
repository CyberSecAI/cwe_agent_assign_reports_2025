# Vulnerability Information: CVE-2024-54802

## Vulnerability Description
In Netgear WNR854T 1.5.2 (North America), the UPNP service (/usr/sbin/upnp) is vulnerable to **stack-based buffer overflow** in the M-SEARCH Host header.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **vector:** M-SEARCH Host header
- **product:** Netgear WNR854T
- **version:** 1.5.2
- **component:** /usr/sbin/upnp

## CVE Reference Links Content Summary
## CVE-2024-54802 Analysis

**CVE Description:** (Based on the provided content, as the placeholder was not replaced) A stack-based buffer overflow in the UPnP (Universal Plug and Play) service (/usr/sbin/upnp) affecting the M-SEARCH Host header.

**1. Verification:** The content directly discusses CVE-2024-54802 and details a stack-based buffer overflow in the UPnP service, specifically related to the M-SEARCH Host header. This aligns with the provided CVE description.

**2. Extracted Information:**

*   **Root cause of vulnerability:** Unbounded `strcpy` into a fixed-size stack variable within the `advertise_res` function (0x22bc4) when handling the M-SEARCH Host header.
*   **Weaknesses/vulnerabilities present:** Stack-based buffer overflow, improper bounds checking.
*   **Impact of exploitation:** Remote code execution. An attacker can corrupt adjacent memory and control execution flow.
*   **Attack vectors:** Sending a maliciously crafted M-SEARCH request with an oversized Host header to the vulnerable service.  The UPnP service is exposed to the WAN.
*   **Required attacker capabilities/position:** No authentication required. Attack can be launched from network-adjacent positions or over the internet (WAN-facing).
*   **Mitigation or fix:** Not specified in the provided content.

**3. Additional Details (compared to a standard CVE description):**

*   The content provides specific memory addresses (0x22bc4) related to the vulnerable code.
*   It details the use of a ROP gadget at 0x2d4dc (mov r0, r5 ; bl system) for exploitation.
*   It includes a Python code snippet demonstrating a potential payload structure.
*   It notes the lack of exploit mitigations like ASLR and DEP on the target device.
*   The content explains the payload structure, including padding, register control, and the ROP gadget usage.
*   It provides a specific example payload.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.201 |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.178 |
| 5 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.168 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.166 |
| 7 | 681 | Incorrect Conversion between Numeric Types | Base | Allowed | sparse | 0.164 |
| 8 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.160 |
| 9 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | dense | 0.556 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

