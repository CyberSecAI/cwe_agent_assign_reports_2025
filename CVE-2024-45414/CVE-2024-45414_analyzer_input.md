# Vulnerability Information: CVE-2024-45414

## Vulnerability Description
The HTTPD binary in multiple ZTE routers has a **stack-based buffer overflow** vulnerability in webPrivateDecrypt function. This function is responsible for decrypting RSA encrypted ciphertext, the encrypted data is supplied base64 encoded. The decoded ciphertext is stored on the stack without checking its length. An unauthenticated attacker can get RCE as root by exploiting this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **impact:** RCE and remote code execution
- **attacker:** unauthenticated attacker
- **product:** ZTE routers
- **component:** webPrivateDecrypt function in HTTPD binary

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The `webPrivateDecrypt` function in the HTTPD binary of multiple ZTE routers does not validate the length of the decrypted data before storing it on the stack. The function decrypts RSA encrypted ciphertext provided in base64 encoded format.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow (CWE-121) due to insufficient bounds checking when writing decrypted data to a stack buffer.
- **Impact of exploitation**: An unauthenticated attacker can achieve Remote Code Execution (RCE) as root by sending crafted data to trigger the overflow.
- **Attack vectors**: The vulnerability is triggered via the HTTP server of the router. An attacker needs to send a crafted base64 encoded ciphertext to the `webPrivateDecrypt` function.
- **Required attacker capabilities/position**: The attacker needs network access to the router's HTTP server. No authentication is needed.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.357 |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.330 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.330 |
| 6 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.318 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.318 |
| 8 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.305 |
| 9 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | dense | 0.555 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

