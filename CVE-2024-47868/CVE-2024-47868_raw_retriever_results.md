# Raw Retriever Results for CVE-2024-47868

# Raw Retriever Results for CVE-2024-47868
## Query
Gradio is an open-source Python package designed for quick prototyping. This is a **data validation vulnerability** affecting several Gradio components, which allows arbitrary file leaks through the post-processing step. Attackers can exploit these components by crafting requests that bypass expected input constraints. This issue could lead to sensitive files being exposed to unauthorized users, especially when combined with other vulnerabilities, such as issue TOB-GRADIO-15. The components most at risk are those that return or handle file data. Vulnerable Components 1. **String to FileData** DownloadButton, Audio, ImageEditor, Video, Model3D, File, UploadButton. 2. **Complex data to FileData** Chatbot, MultimodalTextbox. 3. **Direct file read in preprocess** Code. 4. **Dictionary converted to FileData** ParamViewer, Dataset. Exploit Scenarios 1. A developer creates a Dropdown list that passes values to a DownloadButton. An attacker bypasses the allowed inputs, sends an arbitrary file path (like `/etc/passwd`), and downloads sensitive files. 2. An attacker crafts a malicious payload in a ParamViewer component, leaking sensitive files from a server through the arbitrary file leak. This issue has been resolved in `gradio>5.0`. Upgrading to the latest version will mitigate this vulnerability. There are no known workarounds for this vulnerability.

## Keyphrases
- **rootcause**: 'data validation vulnerability'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5220 | 0.5779 | 0.5329 | 0.5278 | 20 |
| Sparse | 266.8939 | 841.4228 | 771.8582 | 820.0097 | 11 |
| Graph | 1.5389 | 2.6784 | 2.0267 | 1.9890 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.6784 | Allowed |
| 2 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 2.5741 | Allowed |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 2.5573 | Allowed |
| 4 | 23 | Relative Path Traversal | base | 2.4700 | Allowed |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.4065 | Allowed |
| 6 | 183 | Permissive List of Allowed Inputs | base | 2.2100 | Allowed |
| 7 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 9 | 117 | Improper Output Neutralization for Logs | base | 2.2100 | Allowed |
| 10 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 11 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 12 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 13 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 14 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 15 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.6968 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.5779 | 0.5779 | Allowed |
| 2 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.5521 | 0.5521 | Allowed |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.5448 | 0.5448 | Allowed |
| 4 | 863 | Incorrect Authorization | Class | 0.5383 | 0.5383 | Allowed-with-Review |
| 5 | 502 | Deserialization of Untrusted Data | Base | 0.5373 | 0.5373 | Allowed |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.5366 | 0.5366 | Allowed-with-Review |
| 7 | 36 | Absolute Path Traversal | Base | 0.5337 | 0.5337 | Allowed |
| 8 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 0.5326 | 0.5326 | Allowed |
| 9 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.5297 | 0.5297 | Allowed |
| 10 | 790 | Improper Filtering of Special Elements | Class | 0.5287 | 0.5287 | Allowed-with-Review |
| 11 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5270 | 0.5270 | Allowed |
| 12 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.5267 | 0.5267 | Allowed |
| 13 | 306 | Missing Authentication for Critical Function | Base | 0.5264 | 0.5264 | Allowed |
| 14 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.5262 | 0.5262 | Allowed |
| 15 | 1333 | Inefficient Regular Expression Complexity | Base | 0.5247 | 0.5247 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 841.4228 | 841.4228 | Allowed |
| 2 | 1333 | Inefficient Regular Expression Complexity | 838.1630 | 838.1630 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 830.2807 | 830.2807 | Allowed |
| 4 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 829.3505 | 829.3505 | Allowed |
| 5 | 23 | Relative Path Traversal | 822.8640 | 822.8640 | Allowed |
| 6 | 863 | Incorrect Authorization | 820.0097 | 820.0097 | Allowed-with-Review |
| 7 | 918 | Server-Side Request Forgery (SSRF) | 812.3258 | 812.3258 | Allowed |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 811.6582 | 811.6582 | Allowed |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 811.5948 | 811.5948 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | 805.8767 | 805.8767 | Allowed |
| 11 | 639 | Authorization Bypass Through User-Controlled Key | 266.8939 | 266.8939 | Allowed |
