# Vulnerability Information: CVE-2024-37026

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved drm/xe Only use reserved BCS instances for usm migrate exec queue **The GuC context scheduling queue is 2 entires deep, thus it is possible for a migration job to be stuck behind a fault if migration exec queue shares engines with user jobs**. This can deadlock as the migrate exec queue is required to service page faults. Avoid deadlock by only using reserved BCS instances for usm migrate exec queue. (cherry picked from commit 04f4a70a183a688a60fe3882d6e4236ea02cfc67)

### Vulnerability Description Key Phrases
- **rootcause:** **The GuC context scheduling queue is 2 entires deep, thus it is possible for a migration job to be stuck behind a fault if migration exec queue shares engines with user jobs**
- **impact:** deadlock
- **product:** Linux kernel
- **component:** drm/xe

## CVE Reference Links Content Summary
The provided content is related to the following vulnerability:

**Root cause of vulnerability:**
The GuC (Graphics micro-controller) context scheduling queue has a limited depth of 2 entries. When the migration exec queue shares engines with user jobs, a migration job can get stuck behind a faulting user job. This occurs because the migrate exec queue is needed to service page faults, but if it's blocked, it can lead to a deadlock.

**Weaknesses/vulnerabilities present:**
- **Resource contention:** The migration execution queue shares resources (BCS engines) with user-level jobs.
- **Limited queue depth:** The GuC context scheduling queue's shallow depth of 2 exacerbates the contention issue.
- **Dependency on migration for fault handling:** The migration exec queue is required to service page faults.

**Impact of exploitation:**
- **Deadlock:** A deadlock can occur when a migration job gets stuck behind a faulting job, preventing the system from servicing page faults and thus halting progress.

**Attack vectors:**
- The vulnerability is triggered by a specific sequence of events involving user-level jobs causing page faults and migration jobs attempting to execute. It does not appear to be directly exploitable by an attacker, but occurs because of the way the system is designed.
- It's more of a design flaw than a directly exploitable vulnerability

**Required attacker capabilities/position:**
- The vulnerability can be triggered by normal user space activity. No special privileges or capabilities are needed to trigger this deadlock.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 606 | Unchecked Input for Loop Condition | Base | Allowed | sparse | 0.539 |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | sparse | 0.465 |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.457 |
| 4 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.456 |
| 5 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.455 |
| 6 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.438 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.434 |
| 8 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.433 |
| 9 | 833 | Deadlock | Base | Allowed | dense | 0.551 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.003 |

