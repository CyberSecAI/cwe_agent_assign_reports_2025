{
  "cve_id": "CVE-2025-31492",
  "description": "mod_auth_openidc is an OpenID Certified authentication and authorization module for the Apache 2.x HTTP server that implements the OpenID Connect Relying Party functionality. Prior to 2.4.16.11, a bug in a mod_auth_openidc results in disclosure of protected content to unauthenticated users. The conditions for disclosure are an OIDCProviderAuthRequestMethod POST, a valid account, and there mustnt be any application-level gateway (or load balancer etc) protecting the server. When you request a protected resource, the response includes the HTTP status, the HTTP headers, the intended response (the self-submitting form), and the protected resource (with no headers). This is an example of a request for a protected resource, including all the data returned. In the case where mod_auth_openidc returns a form, it has to return OK from check_userid so as not to go down the error path in httpd. This means httpd will try to issue the protected resource. oidc_content_handler is called early, which has the opportunity to prevent the normal output being issued by httpd. oidc_content_handler has a number of checks for when it intervenes, but it doesnt check for this case, so the handler returns DECLINED. Consequently, httpd appends the protected content to the response. The issue has been patched in mod_auth_openidc versions >= 2.4.16.11.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "disclosure of protected content",
    "vector": "OIDCProviderAuthRequestMethod POST",
    "attacker": "unauthenticated users",
    "product": "mod_auth_openidc",
    "version": "Prior to 2.4.16.11",
    "component": ""
  },
  "reference_content": "## Analysis of CVE-2025-31492 based on provided content:\n\nThe provided content details a security vulnerability (CVE-2025-31492) in `libapache2-mod-auth-openidc`. Here's a breakdown of the information extracted:\n\n**Root cause of vulnerability:**\n\nA bug in `mod_auth_openidc` causes disclosure of protected content to unauthenticated users when specific conditions are met. Specifically, the `oidc_content_handler` doesn't properly check for a specific case, leading to the appending of protected content to the HTTP response.\n\n**Weaknesses/vulnerabilities present:**\n\n*   Disclosure of protected content.\n*   Insufficient checks within the `oidc_content_handler`.\n\n**Impact of exploitation:**\n\nUnauthenticated users can access protected resources, including HTTP headers and the resource content itself.\n\n**Attack vectors:**\n\n*   Using `OIDCProviderAuthRequestMethod POST`.\n*   Having `Require valid-user` directive enabled.\n*   The server *not* being protected by an application-level gateway (load balancer, etc.).\n*   A crafted HTTP request to a protected resource.\n\n**Required attacker capabilities/position:**\n\n*   Network access to the vulnerable server.\n*   No authentication required.\n*   Ability to observe the raw HTTP response (e.g., using a tool that doesn't silently drop invalid data).\n\n**Mitigation or fix:**\n\n*   Upgrade to `libapache2-mod-auth-openidc` version `2.4.9.4-0+deb11u5` (for Debian 11 bullseye).\n*   Switch to `OIDCProviderAuthRequestMethod GET` (default).\n*   Place an application-level gateway (load balancer) in front of the server to hide the extra content.\n\n**Additional Details (more than official CVE description):**\n\n*   The fix was backported from `mod_auth_openidc` version `2.4.16.11`.\n*   The vulnerability is related to how the module handles form submissions during authentication.\n*   The vulnerability is difficult to detect with standard HTTP libraries, requiring analysis of raw network data.\n*   The Debian Security Tracker link is provided for further information.\n*   The vulnerability is tracked as Debian Bug #1102413.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-201 | Insertion of Sensitive Information Into Sent Data | 0.9 | Base | Primary | Allowed |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Secondary Candidate | Allowed |\n| CWE-863 | Incorrect Authorization | 0.5 | Class | Secondary Candidate | Allowed-with-Review |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE identified is CWE-201, which focuses on the insertion of sensitive information into sent data. CWE-306 (Missing Authentication) and CWE-863 (Incorrect Authorization) were considered as potential related issues, but the core of the vulnerability is the exposure of the protected resource itself due to a mishandling of the response in the absence of external gateway protection. CWE-201 is a base-level CWE and fits the **root cause** described in the vulnerability details. The relationships considered were primarily parent-child and peer relationships to ensure the selected CWE was at the correct abstraction level and accurately captured the vulnerability.\n\n```mermaid\ngraph TD\n    cwe201[\"CWE-201: Insertion of Sensitive Information Into Sent Data\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n\n    cwe201 -->|CANFOLLOW| cwe212[\"CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer\"]\n    cwe306 -->|CHILDOF| cwe287[\"CWE-287: Improper Authentication\"]\n    cwe863 -->|CHILDOF| cwe285[\"CWE-285: Improper Authorization\"]\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe201 primary\n    class cwe306,cwe863 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with a request for a protected resource. The mod_auth_openidc module processes the request, and due to a **missing** check in the `oidc_content_handler`, it returns `DECLINED`. This leads to httpd appending the protected content to the response. The chain is:\n1.  Request for protected resource.\n2.  **Missing** check in `oidc_content_handler`.\n3.  `oidc_content_handler` returns `DECLINED`.\n4.  httpd appends protected content to the response (**Insertion of Sensitive Information Into Sent Data**).\n\nThe **root cause** is the **missing** check which leads to the unintentional inclusion of sensitive information in the HTTP response.\n\n## Summary of Analysis\nThe initial analysis focused on identifying the **root cause** of the vulnerability. While authentication and authorization issues were considered, the core issue is the unintended disclosure of protected content due to a **missing** check within the `oidc_content_handler`. This leads to sensitive information being included in the response.\n\nThe evidence from the \"CVE Reference Links Content Summary\" section is critical: \"A bug in `mod_auth_openidc` causes disclosure of protected content to unauthenticated users when specific conditions are met. Specifically, the `oidc_content_handler` doesn't properly check for a specific case, leading to the appending of protected content to the HTTP response.\"\n\nThe graph relationships highlight that CWE-201 can lead to CWE-212 (Improper Removal of Sensitive Information Before Storage or Transfer), suggesting a potential follow-up weakness. The analysis has led to the conclusion that CWE-201 is the most appropriate CWE, with a confidence level of 0.9.\n\nRelevant CWE Information:\n\n*   **CWE-201 (Insertion of Sensitive Information Into Sent Data):** This CWE accurately captures the vulnerability because the protected content (sensitive information) is being inserted into the HTTP response due to a coding error. The security implication is the exposure of sensitive resources to unauthorized users.\n\n*   **CWE-306 (Missing Authentication for Critical Function):** While unauthenticated users can access the content, the primary issue isn't a complete lack of authentication but rather a failure in the module's content handling that bypasses the intended protection mechanisms when certain conditions are met. Therefore, it's a secondary consideration.\n\n*   **CWE-863 (Incorrect Authorization):** Similar to CWE-306, this isn't the primary issue. The authorization might be in place, but the content handler **incorrectly** allows the protected content to be sent in certain scenarios.\n\nCWE-201 is at the optimal level of specificity because it directly addresses the insertion of sensitive data into the response, which is the core weakness. The alternatives, CWE-306 and CWE-863, are related but do not fully capture the essence of the vulnerability.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-201 | Insertion of Sensitive Information Into Sent Data | 0.9 | Base | Primary | Allowed |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Secondary Candidate | Allowed |\n| CWE-863 | Incorrect Authorization | 0.5 | Class | Secondary Candidate | Allowed-with-Review |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE identified is CWE-201, which focuses on the insertion of sensitive information into sent data. CWE-306 (Missing Authentication) and CWE-863 (Incorrect Authorization) were considered as potential related issues, but the core of the vulnerability is the exposure of the protected resource itself due to a mishandling of the response in the absence of external gateway protection. CWE-201 is a base-level CWE and fits the **root cause** described in the vulnerability details. The relationships considered were primarily parent-child and peer relationships to ensure the selected CWE was at the correct abstraction level and accurately captured the vulnerability.\n\n```mermaid\ngraph TD\n    cwe201[\"CWE-201: Insertion of Sensitive Information Into Sent Data\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n\n    cwe201 -->|CANFOLLOW| cwe212[\"CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer\"]\n    cwe306 -->|CHILDOF| cwe287[\"CWE-287: Improper Authentication\"]\n    cwe863 -->|CHILDOF| cwe285[\"CWE-285: Improper Authorization\"]\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe201 primary\n    class cwe306,cwe863 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with a request for a protected resource. The mod_auth_openidc module processes the request, and due to a **missing** check in the `oidc_content_handler`, it returns `DECLINED`. This leads to httpd appending the protected content to the response. The chain is:\n1.  Request for protected resource.\n2.  **Missing** check in `oidc_content_handler`.\n3.  `oidc_content_handler` returns `DECLINED`.\n4.  httpd appends protected content to the response (**Insertion of Sensitive Information Into Sent Data**).\n\nThe **root cause** is the **missing** check which leads to the unintentional inclusion of sensitive information in the HTTP response.\n\n## Summary of Analysis\nThe initial analysis focused on identifying the **root cause** of the vulnerability. While authentication and authorization issues were considered, the core issue is the unintended disclosure of protected content due to a **missing** check within the `oidc_content_handler`. This leads to sensitive information being included in the response.\n\nThe evidence from the \"CVE Reference Links Content Summary\" section is critical: \"A bug in `mod_auth_openidc` causes disclosure of protected content to unauthenticated users when specific conditions are met. Specifically, the `oidc_content_handler` doesn't properly check for a specific case, leading to the appending of protected content to the HTTP response.\"\n\nThe graph relationships highlight that CWE-201 can lead to CWE-212 (Improper Removal of Sensitive Information Before Storage or Transfer), suggesting a potential follow-up weakness. The analysis has led to the conclusion that CWE-201 is the most appropriate CWE, with a confidence level of 0.9.\n\nRelevant CWE Information:\n\n*   **CWE-201 (Insertion of Sensitive Information Into Sent Data):** This CWE accurately captures the vulnerability because the protected content (sensitive information) is being inserted into the HTTP response due to a coding error. The security implication is the exposure of sensitive resources to unauthorized users.\n\n*   **CWE-306 (Missing Authentication for Critical Function):** While unauthenticated users can access the content, the primary issue isn't a complete lack of authentication but rather a failure in the module's content handling that bypasses the intended protection mechanisms when certain conditions are met. Therefore, it's a secondary consideration.\n\n*   **CWE-863 (Incorrect Authorization):** Similar to CWE-306, this isn't the primary issue. The authorization might be in place, but the content handler **incorrectly** allows the protected content to be sent in certain scenarios.\n\nCWE-201 is at the optimal level of specificity because it directly addresses the insertion of sensitive data into the response, which is the core weakness. The alternatives, CWE-306 and CWE-863, are related but do not fully capture the essence of the vulnerability.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-306:**\n- 306 (Missing Authentication for Critical Function) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Authorization",
        "match_reason": "term_in_phrase_compound_part_1"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 395.13846763317156
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 384.5103624428705
    },
    {
      "metadata": {
        "doc_id": "1204",
        "name": "Generation of Weak Initialization Vector (IV)",
        "source": "sparse"
      },
      "similarity": 381.9947912404746
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 374.0947786284952
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 363.5091425048326
    },
    {
      "metadata": {
        "doc_id": "212",
        "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
        "source": "sparse"
      },
      "similarity": 362.69819481184055
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 360.6449556264676
    },
    {
      "metadata": {
        "doc_id": "601",
        "name": "URL Redirection to Untrusted Site ('Open Redirect')",
        "type": "Base",
        "original_content": "The web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a redirect.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.43268862239894923
          }
        }
      },
      "similarity": 0.43268862239894923
    },
    {
      "doc_id": "1282",
      "text": "CWE-1282: Assumed-Immutable Data is Stored in Writable Memory",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "1282",
        "name": "Assumed-Immutable Data is Stored in Writable Memory",
        "type": "base",
        "original_content": "CWE-1282: Assumed-Immutable Data is Stored in Writable Memory",
        "relationships": [
          {
            "source_id": "1282",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1282",
            "target_id": "668",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "668",
            "target_id": "1282",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1282",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "471",
                  "1282",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "471"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "471",
                  "1282",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "471"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "1282",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "471"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-306",
      "CWE-201",
      "CWE-285",
      "CWE-287",
      "CWE-212"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}