{
  "query": "MinIO is a high performance object storage. Starting in RELEASE.2024-06-06T09-36-42Z and prior to RELEASE.2025-02-28T09-55-16Z, a bug in evaluating the trust of the SSH key used in an SFTP connection to MinIO allows authentication bypass and unauthorized data access. On a MinIO server with SFTP access configured and using LDAP as an external identity provider, MinIO supports SSH key based authentication for SFTP connections when the user has the `sshPublicKey` attribute set in their LDAP server. The server trusts the clients key only when the public key is the same as the `sshPublicKey` attribute. Due to the bug, when the user has no `sshPublicKey` property in LDAP, the server ends up trusting the key allowing the client to perform any FTP operations allowed by the MinIO access policies associated with the LDAP user (or any of their groups). Three requirements must be met in order to exploit the vulnerability. First, the MinIO server must be configured to allow SFTP access and use LDAP as an external identity provider. Second, the attacker must have knowledge of an LDAP username that does not have the `sshPublicKey` property set. Third, such an LDAP username or one of their groups must also have some MinIO access policy configured. When this bug is successfully exploited, the attacker can perform any FTP operations (i.e. reading, writing, deleting and listing objects) allowed by the access policy associated with the LDAP user account (and their groups). Version 1.2.0 fixes the issue.",
  "count": 20,
  "results": [
    {
      "cwe_id": "90",
      "name": "Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')",
      "abstraction": "Base",
      "score": 0.47113587441212296,
      "original_score": 0.47113587441212296,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "220",
      "name": "Storage of File With Sensitive Data Under FTP Root",
      "abstraction": "Variant",
      "score": 0.46421140775179903,
      "original_score": 0.46421140775179903,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1394",
      "name": "Use of Default Cryptographic Key",
      "abstraction": "Base",
      "score": 0.460286512114656,
      "original_score": 0.460286512114656,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "306",
      "name": "Missing Authentication for Critical Function",
      "abstraction": "Base",
      "score": 0.4474004054170192,
      "original_score": 0.4474004054170192,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "277",
      "name": "Insecure Inherited Permissions",
      "abstraction": "Variant",
      "score": 0.44695730505757436,
      "original_score": 0.44695730505757436,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "522",
      "name": "Insufficiently Protected Credentials",
      "abstraction": "Class",
      "score": 0.44352130875746226,
      "original_score": 0.44352130875746226,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "abstraction": "Class",
      "score": 0.44233950857170834,
      "original_score": 0.44233950857170834,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "287",
      "name": "Improper Authentication",
      "abstraction": "Class",
      "score": 0.4407279754360038,
      "original_score": 0.4407279754360038,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "score": 0.44056896206390794,
      "original_score": 0.44056896206390794,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "269",
      "name": "Improper Privilege Management",
      "abstraction": "Class",
      "score": 0.43926691421567776,
      "original_score": 0.43926691421567776,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "285",
      "name": "Improper Authorization",
      "abstraction": "Class",
      "score": 0.41813136420780805,
      "original_score": 0.41813136420780805,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "532",
      "name": "Insertion of Sensitive Information into Log File",
      "abstraction": "Base",
      "score": 0.41673360267369364,
      "original_score": 0.41673360267369364,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 0.416097995884981,
      "original_score": 0.416097995884981,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "286",
      "name": "Incorrect User Management",
      "abstraction": "Class",
      "score": 0.41280125482381663,
      "original_score": 0.41280125482381663,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "326",
      "name": "Inadequate Encryption Strength",
      "abstraction": "Class",
      "score": 0.41163006488182136,
      "original_score": 0.41163006488182136,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "abstraction": "Base",
      "score": 0.4091251759849568,
      "original_score": 0.4091251759849568,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "200",
      "name": "Exposure of Sensitive Information to an Unauthorized Actor",
      "abstraction": "Class",
      "score": 0.4081670162460353,
      "original_score": 0.4081670162460353,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "540",
      "name": "Inclusion of Sensitive Information in Source Code",
      "abstraction": "Base",
      "score": 0.40628335583402375,
      "original_score": 0.40628335583402375,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "303",
      "name": "Incorrect Implementation of Authentication Algorithm",
      "abstraction": "Base",
      "score": 0.4057268383336121,
      "original_score": 0.4057268383336121,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "918",
      "name": "Server-Side Request Forgery (SSRF)",
      "abstraction": "Base",
      "score": 0.40565897027878906,
      "original_score": 0.40565897027878906,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.40565897027878906,
    "max": 0.47113587441212296,
    "mean": 0.43033859064737345,
    "median": 0.4286991392117429,
    "count": 20
  }
}