## Vulnerability Description
The Stackable - Page Builder Gutenberg Blocks plugin for WordPress is vulnerable to CSS Injection in all versions up to, and including, 3.13.6. This makes it possible for unauthenticated attackers to embed untrusted style information into comments resulting in a possibility of data exfiltration such as admin nonces with limited impact. These nonces could be used to perform CSRF attacks within a limited time window. The presence of other plugins may make additional nonces available, which may pose a risk in plugins that dont perform capability checks to protect AJAX actions or other actions reachable by lower-privileged users.

### Vulnerability Description Key Phrases
- **weakness:** **cross-site scripting**
- **impact:** data exfiltration
- **vector:** CSS injection
- **attacker:** unauthenticated attackers
- **product:** Stackable - Page Builder Gutenberg Blocks plugin for WordPress
- **version:** up to and including 3.13.6

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-8760

**Root Cause of Vulnerability:** The vulnerability stems from a lack of proper sanitization and control over CSS generation within the Stackable – Page Builder Gutenberg Blocks plugin, allowing for CSS injection.

**Weaknesses/Vulnerabilities Present:**
*   **Unauthenticated CSS Injection:** The plugin fails to properly sanitize user-provided data when generating CSS, allowing unauthenticated users to inject malicious CSS code.
*   **Improper Control of Code Generation:** The vulnerability is classified as "Improper Control of Generation of Code ('Code Injection')", highlighting the flawed process of generating CSS code.

**Impact of Exploitation:**
*   **Data Exfiltration:** Attackers can embed malicious CSS to potentially extract sensitive information, such as admin nonces.
*   **Limited CSRF Attacks:** The extracted admin nonces could be used to perform CSRF (Cross-Site Request Forgery) attacks. However, this is limited by the lifespan of the nonce.
*   **Potential for Wider Impact:** If other plugins are present, additional nonces could be exposed and exploited if those plugins don't implement sufficient capability checks, leading to potential unauthorized actions or access via AJAX calls or other actions reachable by low privileged users.

**Attack Vectors:**
*   **Unauthenticated Access:** The attack can be launched by an unauthenticated user.
*   **Comment Injection:** The malicious CSS code is injected via comments, which are then processed by the vulnerable plugin, resulting in the malicious CSS being applied.

**Required Attacker Capabilities/Position:**
*   **No Special Privileges:** Attackers do not require any special privileges or authentication to exploit this vulnerability.
*   **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable WordPress site.

**Additional Details:**
* The vulnerability affects all versions of the Stackable – Page Builder Gutenberg Blocks plugin up to and including version 3.13.6.
* The vulnerability has been patched in version 3.13.7.
* The provided diffs in the second document show modifications to multiple CSS and Javascript files, as well as `kses.php` and `dynamic-breakpoints.php`, likely to remediate the CSS injection vulnerability.
* The vulnerability was discovered by Francesco Carlucci.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.605 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.533 |
| 3 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.521 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.504 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.498 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.498 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.477 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.460 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.548 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-862: Missing Authorization

CWE-863: Incorrect Authorization

CWE-116: Improper Encoding or Escaping of Output

CWE-285: Improper Authorization

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-502: Deserialization of Untrusted Data

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type