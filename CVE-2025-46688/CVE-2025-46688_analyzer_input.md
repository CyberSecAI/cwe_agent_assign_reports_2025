# Vulnerability Information: CVE-2025-46688

## Vulnerability Description
quickjs-ng through 0.9.0 has an **incorrect size calculation** in JS_ReadBigInt for a BigInt, leading to a **heap-based buffer overflow**. QuickJS before 2025-04-26 is also affected.

### Vulnerability Description Key Phrases
- **component:** JS_ReadBigInt for BigInt
- **rootcause:** **incorrect size calculation**
- **weakness:** **heap-based buffer overflow**
- **product:** quickjs-ng, QuickJS
- **version:** through 0.9.0, before 2025-04-26

## CVE Reference Links Content Summary
Here's a breakdown of the provided content, focusing on the CVE-related information:

**CVE ID:** CVE-2025-46688 (Placeholder - needs actual description)

**Analysis:**

The provided content details fixes for heap buffer overflows in the QuickJS JavaScript engine.  It appears to address two related vulnerabilities:

*   **Vulnerability 1 (quickjs.c):** A buffer overflow in `JS_ReadString` and `JS_ReadBigInt` due to missing length checks and incorrect size calculations. This is the vulnerability addressed by commit `1eb05e44fa` (cherry-picked into quickjs-ng as `28fa43d3ddff2c1ba91b6e3a788b2d7ba82d1465`).
*   **Vulnerability 2 (tests/test\_bjson.js):**  A change to the test suite (`test_bjson.js`) to handle potential errors during BJSON parsing, specifically related to invalid version errors. This seems to be related to the first vulnerability, as it updates the test corpus to account for the fix.

**Extracted Information (Vulnerability 1 - quickjs.c):**

*   **Root Cause:**
    *   Missing length check in `JS_ReadString` allowing allocation of a buffer smaller than needed.
    *   Incorrect size calculation in `JS_ReadBigInt` leading to a smaller buffer allocation than required.
*   **Weaknesses/Vulnerabilities Present:**
    *   Heap buffer overflow.
    *   Integer overflow (in the size calculation for `JS_ReadBigInt`).
*   **Impact of Exploitation:**
    *   Potential for arbitrary code execution (heap corruption).
*   **Attack Vectors:**
    *   Crafted input (BJSON or JavaScript) that triggers the vulnerable code paths.  The provided example input demonstrates a potential exploit.
*   **Required Attacker Capabilities/Position:**
    *   Ability to provide malicious input to the QuickJS engine.
*   **Mitigation/Fix:**
    *   Added length checks in `JS_ReadString` to prevent allocation of too-small buffers.
    *   Corrected the size calculation in `JS_ReadBigInt` to accurately determine the required buffer size.
    *   Updated the test suite to handle potential errors.

**Additional Notes:**

*   The content indicates that this fix was originally implemented in the `bellard/quickjs` repository and then cherry-picked into the `quickjs-ng` fork.
*   The ASAN (AddressSanitizer) reports provide detailed information about the memory corruption, including the addresses and call stacks involved.
*   The provided content gives more detail than a typical CVE description would. It includes code snippets, ASAN reports, and reproduction steps.

**Response:**

The content is **RELEVANT** and provides detailed information about a heap buffer overflow vulnerability in QuickJS. The extracted information above summarizes the key details.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 131 | Incorrect Calculation of Buffer Size | Base | Allowed | sparse | 0.237 |
| 4 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.221 |
| 5 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.215 |
| 6 | 681 | Incorrect Conversion between Numeric Types | Base | Allowed | sparse | 0.207 |
| 7 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.206 |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.195 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.534 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

