# Vulnerability Information: CVE-2024-55951

## Vulnerability Description
Metabase is an open-source data analytics platform. For new sandboxing configurations created in 1.52.0 till 1.52.2.4, sandboxed users are able to see field filter values from other sandboxed users. This is fixed in 1.52.2.5. Users on 1.52.0 or 1.52.1 or 1.5.2 should upgrade to 1.52.2.5. There are no workarounds for this issue aside from upgrading.

### Vulnerability Description Key Phrases
- **weakness:** **information disclosure**
- **impact:** see field filter values from other sandboxed users
- **product:** Metabase
- **version:** 1.52.0 till 1.52.2.4
- **component:** sandboxing configurations

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability described:

*   **Root cause of vulnerability:** Field filter values for the first sandboxed user are cached, and subsequent sandboxed users are able to see these cached values. This is due to improper caching mechanisms when handling field filters in sandboxed environments.

*   **Weaknesses/vulnerabilities present:**
    *   **Information Disclosure:** The vulnerability allows sandboxed users to view filter values from other sandboxed users, which should be isolated.
    *   **Improper caching:** The caching mechanism does not properly account for sandboxed user contexts, leading to cross-user data leakage.

*   **Impact of exploitation:**
    *   **Confidentiality breach:**  The primary impact is the unauthorized disclosure of filter values between sandboxed users. This is classified as a low confidentiality impact on the subsequent system because the leaked data is likely related to filtering and does not directly expose the system's full data.
    *   No impact on integrity and availability according to the provided information.

*   **Attack vectors:**
    *   **Network:** The vulnerability is exploitable over the network, as it involves interaction with a web application.

*   **Required attacker capabilities/position:**
    *   **Low privileges:** The attacker needs to have a low-privileged account (sandboxed user account).
    *   **Active user interaction:** A user is required to interact with the system for this vulnerability to be triggered. This suggests a scenario where a user will apply a filter that will be cached for another user to see.

**CVSS Metrics:**

The provided CVSS v4 vector string `CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:A/VC:N/VI:N/VA:N/SC:L/SI:N/SA:N` breaks down as:

*   **AV:N (Attack Vector: Network):** The vulnerability is exploitable over a network.
*  **AC:L (Attack Complexity: Low):** No special conditions are needed to exploit this vulnerability
*   **AT:N (Attack Requirements: None):** No specific attack prerequisites are required.
*   **PR:L (Privileges Required: Low):** An attacker needs a low-privileged account.
*   **UI:A (User Interaction: Active):** The vulnerability requires user interaction (another user applying the filter to be leaked).
*   **VC:N (Vulnerable System Confidentiality: None):** No confidentiality impact on the directly affected vulnerable system.
*   **VI:N (Vulnerable System Integrity: None):** No integrity impact on the directly affected vulnerable system.
*   **VA:N (Vulnerable System Availability: None):** No availability impact on the directly affected vulnerable system.
*   **SC:L (Subsequent System Confidentiality: Low):** Low confidentiality impact on the subsequent system, as leaked filter data isn't considered highly sensitive.
*   **SI:N (Subsequent System Integrity: None):** No integrity impact on the subsequent system.
*   **SA:N (Subsequent System Availability: None):** No availability impact on the subsequent system.

**Additional Notes:**

*   The vulnerability is specific to the Enterprise version of Metabase.
*   The issue affects versions 1.52.0 up to 1.52.2.4 and is fixed in 1.52.2.5.
*   No workarounds exist besides upgrading to the patched version.
*   The advisory suggests using Metabase's audit feature to identify potential user impact.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | Allowed | sparse | 0.332 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.331 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.325 |
| 5 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.321 |
| 6 | 822 | Untrusted Pointer Dereference | Base | Allowed | sparse | 0.321 |
| 7 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.315 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.312 |
| 9 | 1230 | Exposure of Sensitive Information Through Metadata | Base | Allowed | dense | 0.444 |
| 10 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | graph | 0.002 |

