# Vulnerability Information: CVE-2025-26619

## Vulnerability Description
Vega is a visualization grammar, a declarative format for creating, saving, and sharing interactive visualization designs. In `vega` 5.30.0 and lower and in `vega-functions` 5.15.0 and lower , **it was possible to call JavaScript functions from the Vega expression language that were not meant to be supported**. The issue is patched in `vega` `5.31.0` and `vega-functions` `5.16.0`. Some workarounds are available. Run `vega` without `vega.expressionInterpreter`. This mode is not the default as it is slower. Alternatively, using the interpreter described in CSP safe mode (Content Security Policy) prevents arbitrary Javascript from running, so users of this mode are not affected by this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **it was possible to call JavaScript functions from the Vega expression language that were not meant to be supported**
- **impact:** arbitrary Javascript from running
- **product:** vega
- **version:** 5.30.0 and lower and 5.31.0

## CVE Reference Links Content Summary
## CVE-2025-26619 Analysis

The provided content relates to CVE-2025-26619. It provides significantly more detail than the placeholder CVE description.

**Root cause of vulnerability:**

The vulnerability stems from the ability to call JavaScript functions from the Vega expression language that are not intended to be supported. Specifically, the `filter` property of a `select` parameter in Vega-Lite exposes the browser's `Window` object via `event.view`, allowing arbitrary code execution.

**Weaknesses/vulnerabilities present:**

*   **Cross-Site Scripting (XSS):** The core vulnerability is an XSS issue.
*   **Unsafe Function Call:**  The Vega expression language allows calling functions without proper sanitization or restriction.
*   **Exposure of `event.view`:** The exposure of the `event.view` object provides access to the browser's window object, enabling arbitrary JavaScript execution.

**Impact of exploitation:**

Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of the user's browser. This can lead to:

*   Stealing sensitive information (cookies, tokens, etc.).
*   Defacing the web page.
*   Redirecting the user to malicious websites.
*   Performing actions on behalf of the user.

**Attack vectors:**

*   Crafting a malicious Vega-Lite specification that includes a `select` parameter with a vulnerable `filter` expression.
*   Embedding this malicious specification in a web page or application that uses Vega-Lite.

**Required attacker capabilities/position:**

*   The attacker needs to be able to control or influence the Vega-Lite specification used by the application. This could involve:
    *   Directly modifying the specification if they have access.
    *   Injecting malicious code into a data source that is used to generate the specification.
*   Basic understanding of JavaScript and Vega-Lite syntax.

**Mitigation or fix:**

*   **Upgrade:** Upgrade to Vega version 5.31.0 or later, or Vega-Functions version 5.16.0 or later.
*   **Disable `expressionInterpreter`:** Run Vega without the `vega.expressionInterpreter`. This is slower but avoids the vulnerability.
*   **CSP Safe Mode:** Use Vega in CSP (Content Security Policy) safe mode, which prevents arbitrary JavaScript from running.
*   **Input Validation:** Implement strict input validation and sanitization of any data used to generate Vega-Lite specifications.

The content also provides a proof-of-concept (PoC) Vega-Lite specification that demonstrates the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.679 |
| 2 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.679 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.676 |
| 4 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.654 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.648 |
| 6 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.646 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.644 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.641 |
| 9 | 624 | Executable Regular Expression Error | Base | Allowed | dense | 0.384 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

