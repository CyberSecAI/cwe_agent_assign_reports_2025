# Vulnerability Information: CVE-2024-12354

## Vulnerability Description
A vulnerability, which was classified as critical, was found in SourceCodester Phone Contact Manager System 1.0. Affected is the function UserInterfaceMenuDisplayStart of the component User Menu. The manipulation leads to **buffer overflow**. It is possible to launch the attack on the local host. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** SourceCodester Phone Contact Manager System
- **version:** 1
- **component:** UserInterfaceMenuDisplayStart in User Menu

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-12354.

**Root cause of vulnerability:**
The vulnerability is due to improper input validation in the `UserInterface::MenuDisplayStart()` function of the Phone Contact Manager System. The program uses `std::cin >> choice` to parse user input into an integer variable `choice`, but it doesn't validate the length or range of the input.

**Weaknesses/vulnerabilities present:**
- **Lack of input validation:** The program does not check if the input is within the expected range of menu options or if the input string is too long.
- **Integer truncation:** When a very long number is entered, `std::cin >> choice` truncates it to the maximum value of an `int` (2147483647) without any error handling.
- **Infinite loop:** The main loop in `Phone Contact Manager System.cpp` does not handle the case where `choice` has an unexpected value (such as the maximum `int` value), leading to an infinite loop.

**Impact of exploitation:**
- **Program Logic Errors:** An excessively long input causes the program to enter an infinite loop repeatedly displaying the main menu due to the unhandled value of choice.
- **Resource Consumption:** The infinite loop leads to high CPU usage, which impacts overall system performance by continuously executing the same code without any meaningful operation.
- **User Experience Issues:** The program does not provide any feedback for invalid input, making it unusable.

**Attack vectors:**
- User inputting an excessively long number when prompted to make a menu selection.

**Required attacker capabilities/position:**
- The attacker needs to be able to interact with the program's menu input (i.e., have local or remote access to the program's execution environment).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.389 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.368 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.336 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.329 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.324 |
| 9 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | dense | 0.561 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

