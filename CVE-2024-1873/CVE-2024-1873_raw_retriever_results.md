# Raw Retriever Results for CVE-2024-1873

# Raw Retriever Results for CVE-2024-1873
## Query
parisneo/lollms-webui is vulnerable to path traversal and denial of service attacks due to an exposed `/select_database` endpoint in version a9d16b0. The endpoint improperly handles file paths, allowing attackers to specify absolute paths when interacting with the `DiscussionsDB` instance. This flaw enables attackers to create directories anywhere on the system where the application has permissions, potentially leading to denial of service by creating directories with names of critical files, such as HTTPS certificate files, causing server startup failures. Additionally, attackers can manipulate the database path, resulting in the loss of client data by constantly changing the file location to an attacker-controlled location, scattering the data across the filesystem and making recovery difficult.

## Keyphrases
- **rootcause**: 'improper file handling'
- **weakness**: 'path traversal'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5374 | 0.5882 | 0.5508 | 0.5473 | 20 |
| Sparse | 501.5243 | 1000.0000 | 604.5884 | 571.9964 | 11 |
| Graph | 1.5105 | 4.3290 | 1.9904 | 1.7262 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 4.3290 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.8357 | Allowed |
| 3 | 73 | External Control of File Name or Path | Base | 2.8354 | Allowed |
| 4 | 363 | Race Condition Enabling Link Following | base | 2.2100 | Allowed |
| 5 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 6 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 7 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 2.0020 | Allowed |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | base | 1.7680 | Allowed-with-Review |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 10 | 36 | Absolute Path Traversal | Base | 1.7289 | Allowed |
| 11 | 23 | Relative Path Traversal | Base | 1.7235 | Allowed |
| 12 | 183 | Permissive List of Allowed Inputs | base | 1.6848 | Allowed |
| 13 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 14 | 20 | Improper Input Validation | class | 1.6736 | Discouraged |
| 15 | 689 | Permission Race Condition During Resource Copy | compound | 1.6100 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 36 | Absolute Path Traversal | Base | 0.5882 | 0.5882 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5715 | 0.5715 | Allowed |
| 3 | 24 | Path Traversal: '../filedir' | Variant | 0.5636 | 0.5636 | Allowed |
| 4 | 23 | Relative Path Traversal | Base | 0.5634 | 0.5634 | Allowed |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.5582 | 0.5582 | Allowed |
| 6 | 552 | Files or Directories Accessible to External Parties | Base | 0.5565 | 0.5565 | Allowed |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.5565 | 0.5565 | Allowed |
| 8 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.5556 | 0.5556 | Allowed |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5521 | 0.5521 | Allowed |
| 10 | 306 | Missing Authentication for Critical Function | Base | 0.5497 | 0.5497 | Allowed |
| 11 | 863 | Incorrect Authorization | Class | 0.5449 | 0.5449 | Allowed-with-Review |
| 12 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.5430 | 0.5430 | Allowed |
| 13 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.5429 | 0.5429 | Allowed |
| 14 | 425 | Direct Request ('Forced Browsing') | Base | 0.5404 | 0.5404 | Allowed |
| 15 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | 0.5394 | 0.5394 | Discouraged |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 1000.0000 | 1000.0000 | Allowed |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | 645.7463 | 645.7463 | Allowed |
| 3 | 23 | Relative Path Traversal | 586.1350 | 586.1350 | Allowed |
| 4 | 73 | External Control of File Name or Path | 583.4280 | 583.4280 | Allowed |
| 5 | 732 | Incorrect Permission Assignment for Critical Resource | 582.1179 | 582.1179 | Allowed-with-Review |
| 6 | 306 | Missing Authentication for Critical Function | 571.9964 | 571.9964 | Allowed |
| 7 | 36 | Absolute Path Traversal | 555.0800 | 555.0800 | Allowed |
| 8 | 427 | Uncontrolled Search Path Element | 542.8705 | 542.8705 | Allowed |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | 542.6630 | 542.6630 | Allowed |
| 10 | 863 | Incorrect Authorization | 538.9108 | 538.9108 | Allowed-with-Review |
| 11 | 434 | Unrestricted Upload of File with Dangerous Type | 501.5243 | 501.5243 | Allowed |
