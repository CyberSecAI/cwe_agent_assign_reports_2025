{
  "cve_id": "CVE-2024-37665",
  "description": "An **access control issue** in Wvp GB28181 Pro 2.0 allows authenticated attackers to escalate privileges to Administrator via a crafted POST request.",
  "key_phrases": {
    "rootcause": "access control issue",
    "weakness": "",
    "impact": "escalate privileges to Administrator",
    "vector": "crafted POST request",
    "attacker": "authenticated attackers",
    "product": "Wvp GB28181 Pro",
    "version": "2",
    "component": ""
  },
  "reference_content": "Based on the provided content, here's a breakdown of the vulnerability information:\n\n**Vulnerability:**\n\n*   **Root Cause:**  The vulnerability is due to an Insecure Direct Object Reference (IDOR) in the user management interface of WVP-GB28181-pro 2.0. Specifically, when changing a user's password, the `userId` parameter in the request is not properly validated, allowing an attacker to modify the password of other users, including the administrator account.\n\n*   **Weakness:** Lack of proper authorization checks when updating user passwords. The system relies on the user-supplied `userId` parameter without verifying if the current user has the authority to modify the password of the user identified by the provided `userId`.\n\n*  **Impact:**\n    *   **Privilege Escalation:** An ordinary user can modify the password of the administrator account, gaining full access to the platform.\n    *   **Data Exposure/Modification:** With administrator access, the attacker can access and modify sensitive information, platform resources, and configurations.\n\n*   **Attack Vector:**\n    *   The attacker must be able to log into the platform with a non-administrative user account.\n    *   The attacker must then navigate to the user management interface and intercept the password change request.\n    *   The attacker modifies the request by changing the `userId` parameter to \"1\" (or the administrator's ID), and by modifying the new password value.\n\n*   **Attacker Capabilities:**\n    *   The attacker needs a valid non-administrator user account on the platform.\n    *   The attacker needs basic web development skills to inspect and modify HTTP requests.\n    *   The attacker must have access to the network where the application is hosted.\n\n**Technical Details:**\n\nThe report indicates the following steps to reproduce the vulnerability:\n\n1.  Log into the WVP-GB28181-pro 2.0 platform with a regular user account (credentials were shown to be `admin/123`).\n2.  Navigate to the user management section.\n3.  Intercept the password change request.\n4.  Modify the `userId` parameter in the request to `1` (or the ID of the admin user).\n5.  Change the password to a new value and send the request.\n6.  Login using the admin account with the changed password.\n\nThe report also provided a link to a publicly accessible instance of the vulnerable application: `http://112.28.134.194:8088/#/login`.\n\n**Additional Notes:**\n\nThe provided content includes links to the repository and documentation of the wvp-GB28181-pro project. It also emphasizes that the vulnerability exists in version 2.0 and that the reported issue was a logical flaw.\n\n**Summary:**\n\nThe content describes a critical IDOR vulnerability in the password reset functionality of the `wvp-GB28181-pro` application. A non-admin user can exploit this vulnerability to escalate privileges, gain full access to the system, and potentially compromise sensitive data. The attacker achieves this by manipulating the `userId` parameter in the password change request, enabling them to modify the passwords of other users, including the administrator.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.9 | Base | Allowed | Primary CWE. The `userId` parameter is user-controlled and used to access and modify another user's data. |\n| CWE-863 | Incorrect Authorization | 0.7 | Class | Allowed-with-Review | Secondary candidate. The product performs an authorization check, but it does so incorrectly. |\n| CWE-285 | Improper Authorization | 0.6 | Class | Discouraged | Secondary candidate. The product does not perform or incorrectly performs an authorization check. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is CWE-639, a Base-level CWE describing authorization bypass via user-controlled key. CWE-863 and CWE-285 are Class-level CWEs representing incorrect and improper authorization, respectively. CWE-639 is a more specific representation of the vulnerability than the Class-level CWEs.\n\n```mermaid\ngraph TD\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n\n    cwe639 -->|InstanceOf| cwe863\n    cwe639 -->|InstanceOf| cwe285\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe639 primary\n    class cwe863,cwe285 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the lack of proper validation of the `userId` parameter, leading to an authorization bypass and ultimately resulting in privilege escalation.\n\nLack of proper validation of `userId` (CWE-639) -> Authorization Bypass -> Privilege Escalation (Impact)\n\n## Summary of Analysis\nThe initial assessment identified CWE-639 as the primary root cause due to the **lack of proper validation** of the user-controlled `userId` parameter. This aligns with the IDOR vulnerability described in the CVE Reference Links Content Summary, where the system relies on the user-supplied `userId` without verifying if the user has the authority to modify the password of the user identified by that ID. The evidence explicitly states, \"The vulnerability is due to an Insecure Direct Object Reference (IDOR) in the user management interface of WVP-GB28181-pro 2.0. Specifically, when changing a user's password, the `userId` parameter in the request is not properly validated, allowing an attacker to modify the password of other users, including the administrator account.\"\n\nThe \"Authentication vs Authorization vs Access Control Guidance\" section helps to distinguish between authentication and authorization issues. In this case, the issue is related to authorization since the attacker is already authenticated, but lacks the authorization to modify other users' passwords. The \"Privileges vs Permissions Guidance\" further clarifies that this is related to a privilege issue since the attacker is escalating their privileges to administrator.\n\nCWE-863 (Incorrect Authorization) and CWE-285 (Improper Authorization) were considered as secondary candidates. However, CWE-639 (Authorization Bypass Through User-Controlled Key) is more specific as it directly addresses the root cause, which is the **improper handling of the user-controlled key** (`userId` parameter) that leads to the authorization bypass.\n\nThe selected CWEs are at the optimal level of specificity, with CWE-639 being a Base-level CWE that precisely describes the vulnerability. The confidence level is high due to the clear evidence and the alignment of the CWE with the vulnerability description.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-639: Authorization Bypass Through User-Controlled Key\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-863: Incorrect Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 2965.79\n**Source**: sparse\n\n**Description**:\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-285: Improper Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 2911.87\n**Source**: sparse\n\n**Description**:\nThe product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-639 | Authorization Bypass Through User-Controlled Key | 0.9 | Base | Allowed | Primary CWE. The `userId` parameter is user-controlled and used to access and modify another user's data. |\n| CWE-863 | Incorrect Authorization | 0.7 | Class | Allowed-with-Review | Secondary candidate. The product performs an authorization check, but it does so incorrectly. |\n| CWE-285 | Improper Authorization | 0.6 | Class | Discouraged | Secondary candidate. The product does not perform or incorrectly performs an authorization check. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is CWE-639, a Base-level CWE describing authorization bypass via user-controlled key. CWE-863 and CWE-285 are Class-level CWEs representing incorrect and improper authorization, respectively. CWE-639 is a more specific representation of the vulnerability than the Class-level CWEs.\n\n```mermaid\ngraph TD\n    cwe639[\"CWE-639: Authorization Bypass Through User-Controlled Key\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n\n    cwe639 -->|InstanceOf| cwe863\n    cwe639 -->|InstanceOf| cwe285\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe639 primary\n    class cwe863,cwe285 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the lack of proper validation of the `userId` parameter, leading to an authorization bypass and ultimately resulting in privilege escalation.\n\nLack of proper validation of `userId` (CWE-639) -> Authorization Bypass -> Privilege Escalation (Impact)\n\n## Summary of Analysis\nThe initial assessment identified CWE-639 as the primary root cause due to the **lack of proper validation** of the user-controlled `userId` parameter. This aligns with the IDOR vulnerability described in the CVE Reference Links Content Summary, where the system relies on the user-supplied `userId` without verifying if the user has the authority to modify the password of the user identified by that ID. The evidence explicitly states, \"The vulnerability is due to an Insecure Direct Object Reference (IDOR) in the user management interface of WVP-GB28181-pro 2.0. Specifically, when changing a user's password, the `userId` parameter in the request is not properly validated, allowing an attacker to modify the password of other users, including the administrator account.\"\n\nThe \"Authentication vs Authorization vs Access Control Guidance\" section helps to distinguish between authentication and authorization issues. In this case, the issue is related to authorization since the attacker is already authenticated, but lacks the authorization to modify other users' passwords. The \"Privileges vs Permissions Guidance\" further clarifies that this is related to a privilege issue since the attacker is escalating their privileges to administrator.\n\nCWE-863 (Incorrect Authorization) and CWE-285 (Improper Authorization) were considered as secondary candidates. However, CWE-639 (Authorization Bypass Through User-Controlled Key) is more specific as it directly addresses the root cause, which is the **improper handling of the user-controlled key** (`userId` parameter) that leads to the authorization bypass.\n\nThe selected CWEs are at the optimal level of specificity, with CWE-639 being a Base-level CWE that precisely describes the vulnerability. The confidence level is high due to the clear evidence and the alignment of the CWE with the vulnerability description.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-639: Authorization Bypass Through User-Controlled Key\n**Abstraction Level**: Base\n**Similarity Score**: 0.73\n**Source**: dense\n\n**Description**:\nThe system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-863: Incorrect Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 2965.79\n**Source**: sparse\n\n**Description**:\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-285: Improper Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 2911.87\n**Source**: sparse\n\n**Description**:\nThe product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-285 is high-level and lower-level CWEs can frequently be used instead. It is a level-1 Class (i.e., a child of a Pillar).\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-285:**\n- 285 (Improper Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "source": "sparse"
      },
      "similarity": 143.99325238564077
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 139.67024146169416
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 139.1679899329989
    },
    {
      "metadata": {
        "doc_id": "782",
        "name": "Exposed IOCTL with Insufficient Access Control",
        "source": "sparse"
      },
      "similarity": 137.9963386800209
    },
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "sparse"
      },
      "similarity": 136.86701505341352
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 133.8823135700353
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 132.77856121607118
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 132.30963330871975
    },
    {
      "metadata": {
        "doc_id": "1220",
        "name": "Insufficient Granularity of Access Control",
        "type": "Base",
        "original_content": "The product implements access controls via a policy or other feature with the intention to disable or restrict accesses (reads and/or writes) to assets in a system from untrusted agents. However, implemented access controls lack required granularity, which renders the control policy too broad because it allows accesses from unauthorized agents to the security-sensitive assets.",
        "keyphrase_source": "rootcause:access control issue",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5995593857072986,
            "graph": 1.7479711728824356
          }
        }
      },
      "similarity": 0.5995593857072986
    },
    {
      "doc_id": "471",
      "text": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
      "score": 2.7196000000000002,
      "metadata": {
        "doc_id": "471",
        "name": "Modification of Assumed-Immutable Data (MAID)",
        "type": "base",
        "original_content": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
        "relationships": [
          {
            "source_id": "471",
            "target_id": "621",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "607",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "602",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "473",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "425",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "291",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1321",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1282",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "471",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "621",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "607",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "602",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "473",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "425",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "291",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1321",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1282",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.5599999999999999,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_up",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "425"
            },
            "abstraction_path_up": {
              "path": [
                [
                  "472",
                  "471",
                  "CHILDOF"
                ]
              ],
              "score": 0.5599999999999999,
              "type": "abstraction_path_up",
              "source": "472"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "425"
            }
          }
        },
        "abstraction_level": "base",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.7196000000000002
          }
        }
      },
      "similarity": 2.7196000000000002
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-285",
      "CWE-639"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}