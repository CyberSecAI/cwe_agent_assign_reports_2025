# Vulnerability Information: CVE-2024-9940

## Vulnerability Description
The Calculated Fields Form plugin for WordPress is vulnerable to HTML Injection in all versions up to, and including, 5.2.45. This is due to the plugin not properly neutralizing HTML elements from submitted forms. This makes it possible for unauthenticated attackers to inject arbitrary HTML that will render when the administrator views form submissions in their email.

### Vulnerability Description Key Phrases
- **rootcause:** **improper neutralization of HTML elements**
- **weakness:** **HTML injection**
- **attacker:** unauthenticated attackers
- **product:** Calculated Fields Form plugin for WordPress
- **version:** up to and including 5.2.45

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Vulnerability:** HTML Injection

**Root Cause:** The Calculated Fields Form plugin fails to properly sanitize HTML elements submitted through forms. This allows attackers to inject arbitrary HTML code into form submissions.

**Weaknesses/Vulnerabilities:**
*   **Improper Neutralization of Special Elements:** The plugin does not adequately neutralize or encode HTML elements present in user-submitted data before displaying it. This allows the injected HTML to be interpreted as code by the browser when the administrator views the form submissions via email, potentially leading to unintended execution.

**Impact of Exploitation:**
*   **Arbitrary HTML Injection:** An unauthenticated attacker can inject malicious HTML code.
*   **Email Rendering Issues:**  When an administrator views the form submissions in their email client, the injected HTML will be rendered.
*   The injected HTML could potentially be used for phishing, defacement, or other malicious purposes within the context of the email rendering.

**Attack Vectors:**
*   **Form Submission:** The attacker exploits the vulnerability by submitting a form containing malicious HTML code. The vulnerable plugin does not properly sanitize the HTML when the data is sent via email.

**Required Attacker Capabilities/Position:**
*   **Unauthenticated Access:** The attacker does not need to be logged in or have any special privileges. They only need access to a form created by the vulnerable plugin.
*   **Form Interaction:** The attacker must be able to submit data through a form created by the vulnerable plugin.

**Additional Details:**

*   The vulnerability is present in all versions of the Calculated Fields Form plugin up to and including 5.2.45.
*   The vulnerability was fixed in version 5.2.46 by introducing a new "accept_html" attribute in field settings. When set to true, a field's value will not be sanitized, effectively allowing HTML code.
*   The fix also includes sanitization logic for textareas and other fields if the accept_html attribute is set to false.
*   The vulnerability was discovered by Max Boll (\_b0lli) and reported through Wordfence.

This information is more detailed than the typical CVE description, providing a clear explanation of the vulnerability, its root cause, impact, and the fix implemented.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.431 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.431 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.425 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.420 |
| 6 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.387 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.386 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.373 |
| 9 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | dense | 0.528 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

