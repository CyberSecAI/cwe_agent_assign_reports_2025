# Vulnerability Information: CVE-2024-8127

## Vulnerability Description
A vulnerability classified as critical was found in D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04 up to 20240814. This vulnerability affects the function cgi_unzip of the file /cgi-bin/webfile_mgr.cgi of the component HTTP POST Request Handler. The manipulation of the argument path leads to **command injection**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. NOTE This vulnerability only affects products that are no longer supported by the maintainer. NOTE Vendor was contacted early and confirmed that the product is end-of-life. It should be retired and replaced.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **vector:** manipulation of path argument
- **product:** D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04
- **component:** /cgi-bin/webfile_mgr.cgi

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2024-8127",
      "is_related": false,
      "details": "UNRELATED",
       "extracted_information": {}
    },
       {
      "cve_id": "CVE-2024-3272",
       "is_related": true,
      "details": {
        "root_cause": "Command injection vulnerability in the cgi_unzip function of /cgi-bin/webfile_mgr.cgi.",
        "weaknesses": [
          "Improper sanitization of the 'path' variable received from a POST request.",
          "The 'path' variable is passed to sprintf and popen, allowing command execution.",
          "The fix_path_special_char function failed to prevent command injection"
        ],
        "impact": "Arbitrary command execution on the affected devices.",
        "attack_vectors": "Sending a malicious POST request to /cgi-bin/webfile_mgr.cgi with a crafted 'path' variable.",
         "attacker_capabilities": "An attacker needs to send a crafted HTTP POST request to the device."
      }
    },
    {
        "cve_id": "CVE-2024-3273",
       "is_related": true,
        "details":{
         "root_cause": "Series of command injection vulnerabilities affecting configuration scripts (CGI) used by the web configuration interface.",
         "weaknesses":[
            "Command injection vulnerability in CGI scripts."
         ],
         "impact":"Arbitrary command execution",
          "attack_vectors": "Exploiting vulnerable CGI scripts via the web interface.",
          "attacker_capabilities": "An attacker would need network access to the web configuration interface."
        }
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.738 |
| 4 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.689 |
| 5 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.688 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.670 |
| 7 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.666 |
| 8 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | Variant | Allowed | sparse | 0.652 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.654 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |

