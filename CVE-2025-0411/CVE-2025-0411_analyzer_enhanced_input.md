## Vulnerability Description
7-Zip Mark-of-the-Web Bypass Vulnerability. This vulnerability allows remote attackers to **bypass the Mark-of-the-Web protection mechanism** on affected installations of 7-Zip. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file. The specific flaw exists within the handling of archived files. When extracting files from a crafted archive that bears the Mark-of-the-Web, 7-Zip does not propagate the Mark-of-the-Web to the extracted files. An attacker can leverage this vulnerability to execute arbitrary code in the context of the current user. Was ZDI-CAN-25456.

### Vulnerability Description Key Phrases
- **weakness:** **bypass the Mark-of-the-Web protection mechanism**
- **product:** 7-Zip
- **impact:** execute arbitrary code, bypass Mark-of-the-Web protection
- **attacker:** remote attackers

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on the specified CVE:

**1. Content from www.zerodayinitiative.com_3f4a10bf_20250624_210728.html (text)**

*   **Relevance:** This content directly relates to CVE-2025-0411, as it provides the ZDI advisory for the vulnerability.
*   **Extraction:**
    *   **Root cause of vulnerability:** The vulnerability lies in the handling of archived files. When extracting files from an archive with Mark-of-the-Web, 7-Zip doesn't propagate the Mark-of-the-Web to the extracted files.
    *   **Weaknesses/vulnerabilities present:** Mark-of-the-Web bypass.
    *   **Impact of exploitation:** Execution of arbitrary code in the context of the current user.
    *   **Attack vectors:** The target must visit a malicious page or open a malicious file.
    *   **Required attacker capabilities/position:** Remote attackers. User interaction is required.
    *   **Mitigation or fix:** Fixed in 7-Zip version 24.09.
    *   **More detail than the official CVE description:** Yes, it provides more detail.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.684 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.682 |
| 3 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.664 |
| 4 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.659 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.646 |
| 6 | 274 | Improper Handling of Insufficient Privileges | Base | Discouraged | sparse | 0.643 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.637 |
| 8 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.629 |
| 9 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | dense | 0.556 |
| 10 | 129 | Improper Validation of Array Index | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-23: Relative Path Traversal

CWE-787: Out-of-bounds Write

CWE-20: Improper Input Validation

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-274: Improper Handling of Insufficient Privileges

CWE-306: Missing Authentication for Critical Function

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-409: Improper Handling of Highly Compressed Data (Data Amplification)

CWE-129: Improper Validation of Array Index