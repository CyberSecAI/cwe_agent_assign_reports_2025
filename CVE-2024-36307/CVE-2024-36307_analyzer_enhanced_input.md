## Vulnerability Description
A **security agent link following vulnerability** in Trend Micro Apex One and Apex One as a Service could allow a local attacker to disclose sensitive information about the agent on affected installations. Please note an attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **security agent link following vulnerability**
- **impact:** disclose sensitive information about the agent
- **attacker:** local attacker
- **product:** Trend Micro Apex One and Apex One as a Service

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-36307:

**Root Cause of Vulnerability:**

*   The vulnerability lies within the `VsApiNT` module of the Trend Micro Apex One Security Agent.
*   The root cause is related to how the agent handles mount points, allowing for file disclosure.

**Weaknesses/Vulnerabilities Present:**

*   **Link Following:** The vulnerability involves the agent's ability to follow symbolic links or mount points, which leads to unintended file access.
*   **Information Disclosure:** Attackers can abuse the agent to disclose the content of arbitrary files on the system.

**Impact of Exploitation:**

*   **Sensitive Information Disclosure:** An attacker can gain access to sensitive information by reading arbitrary files on the system in the context of SYSTEM privileges.
*   **Loss of Confidentiality:**  The vulnerability can result in the disclosure of confidential data.

**Attack Vectors:**

*   **Local Attack:** The attack is limited to local attackers who already have the ability to execute low-privileged code on the target system.
*   **Mount Point Abuse:** Attackers create a mount point to trick the agent into accessing the target file.

**Required Attacker Capabilities/Position:**

*   **Low-Privilege Code Execution:** The attacker must be able to execute low-privileged code on the target system.
*   **File System Access:** The attacker needs access to the file system to create a mount point.

**Additional Notes:**

*   The vulnerability is triggered by the attacker creating a mount point, and the agent inadvertently disclosing the contents of the file pointed to by the mount point.
*   The vulnerability is exploitable in the context of the SYSTEM account, meaning the attacker could potentially access most system files.
*   Trend Micro has released an update to address this vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 250 | Execution with Unnecessary Privileges | Base | Allowed | sparse | 0.445 |
| 2 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.418 |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.359 |
| 4 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | Allowed | sparse | 0.352 |
| 5 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.339 |
| 6 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.331 |
| 7 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.317 |
| 8 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.313 |
| 9 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | dense | 0.545 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-250: Execution with Unnecessary Privileges

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-1386: Insecure Operation on Windows Junction / Mount Point

CWE-284: Improper Access Control

CWE-346: Origin Validation Error

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-259: Use of Hard-coded Password

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-73: External Control of File Name or Path