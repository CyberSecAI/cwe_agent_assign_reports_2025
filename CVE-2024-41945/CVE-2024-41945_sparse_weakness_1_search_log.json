{
  "method": "sparse_weakness_1",
  "query": "fuels-ts is a library for interacting with Fuel v2. The typescript SDK has no awareness of to-be-spent transactions causing some transactions to fail or silently get pruned as they are funded with already used UTXOs. The problem occurs, because the `fund` function in `fuels-ts/packages/account/src/account.ts` gets the needed ressources statelessly with the function `getResourcesToSpend` without taking into consideration already used UTXOs. This issue will lead to unexpected SDK behaviour, such as a transaction not getting included in the `txpool` / in a block or a previous transaction silently getting removed from the `txpool` and replaced with a new one.",
  "keyphrases": {
    "weakness": "does not consider already used UTXOs"
  },
  "timestamp": "2025-07-13T13:31:51.031183",
  "results_count": 10,
  "results_summary": [
    {
      "doc_id": "754",
      "name": "Improper Check for Unusual or Exceptional Conditions",
      "score": 481.9905082006305
    },
    {
      "doc_id": "347",
      "name": "Improper Verification of Cryptographic Signature",
      "score": 473.3832043980616
    },
    {
      "doc_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 467.9461728126289
    },
    {
      "doc_id": "863",
      "name": "Incorrect Authorization",
      "score": 461.70196787358486
    },
    {
      "doc_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 455.27520461112346
    }
  ]
}