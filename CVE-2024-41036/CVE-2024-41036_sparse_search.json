{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolvednet ks8851 Fix deadlock with the SPI chip variantWhen SMP is enabled and spinlocks are actually functional then there isa deadlock with the statelock spinlock between ks8851_start_xmit_spiand ks8851_irq watchdog BUG soft lockup - CPU#0 stuck for 27s! call trace queued_spin_lock_slowpath+0x100/0x284 do_raw_spin_lock+0x34/0x44 ks8851_start_xmit_spi+0x30/0xb8 ks8851_start_xmit+0x14/0x20 netdev_start_xmit+0x40/0x6c dev_hard_start_xmit+0x6c/0xbc sch_direct_xmit+0xa4/0x22c __qdisc_run+0x138/0x3fc qdisc_run+0x24/0x3c net_tx_action+0xf8/0x130 handle_softirqs+0x1ac/0x1f0 __do_softirq+0x14/0x20 ____do_softirq+0x10/0x1c call_on_irq_stack+0x3c/0x58 do_softirq_own_stack+0x1c/0x28 __irq_exit_rcu+0x54/0x9c irq_exit_rcu+0x10/0x1c el1_interrupt+0x38/0x50 el1h_64_irq_handler+0x18/0x24 el1h_64_irq+0x64/0x68 __netif_schedule+0x6c/0x80 netif_tx_wake_queue+0x38/0x48 ks8851_irq+0xb8/0x2c8 irq_thread_fn+0x2c/0x74 irq_thread+0x10c/0x1b0 kthread+0xc8/0xd8 ret_from_fork+0x10/0x20This issue has not been identified earlier because tests were done ona device with SMP disabled and so spinlocks were actually NOPs.Now use spin_(un)lock_bh for TX queue related locking to avoid executionof softirq work synchronously that would lead to a deadlock.",
  "keyphrases": {
    "rootcause": [
      "A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    ],
    "weakness": [
      "The driver uses a regular spinlock instead of a spinlock with bottom half (BH) disabling",
      "leading to a potential deadlock when accessing shared resources from both the main execution context",
      "the interrupt context."
    ]
  },
  "timestamp": "2025-07-13 12:49:51",
  "cve_id": "CVE-2024-41036",
  "result_count": 13,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 546.3258504234328,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 493.47149549929566,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "score": 406.3659529509812,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 395.442155746544,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "755",
      "name": "Improper Handling of Exceptional Conditions",
      "score": 395.0196602409326,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 392.3006580334561,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "923",
      "name": "Improper Restriction of Communication Channel to Intended Endpoints",
      "score": 389.82109093606095,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 383.69516529123155,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 381.9925145348077,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "606",
      "name": "Unchecked Input for Loop Condition",
      "score": 381.54709427275793,
      "search_source": "rootcause:A deadlock occurs due to incorrect spinlock usage in the ks8851 network driver when SMP is enabled."
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "score": 346.9115174779135,
      "search_source": "weakness:leading to a potential deadlock when accessing shared resources from both the main execution context"
    },
    {
      "cwe_id": "116",
      "name": "Improper Encoding or Escaping of Output",
      "score": 337.7834996492856,
      "search_source": "weakness:leading to a potential deadlock when accessing shared resources from both the main execution context"
    },
    {
      "cwe_id": "1269",
      "name": "Product Released in Non-Release Configuration",
      "score": 335.8223383522914,
      "search_source": "weakness:The driver uses a regular spinlock instead of a spinlock with bottom half (BH) disabling"
    }
  ]
}