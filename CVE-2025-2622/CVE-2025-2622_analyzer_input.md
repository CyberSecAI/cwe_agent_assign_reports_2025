# Vulnerability Information: CVE-2025-2622

## Vulnerability Description
A vulnerability was found in aizuda snail-job 1.4.0. It has been classified as critical. Affected is the function getRuntime of the file /snail-job/workflow/check-node-expression of the component Workflow-Task Management Module. The manipulation of the argument nodeExpression leads to **deserialization**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **deserialization**
- **product:** aizuda snail-job
- **version:** 1.4.0
- **component:** /snail-job/workflow/check-node-expression

## CVE Reference Links Content Summary
```
Root cause of vulnerability:
The application is vulnerable to SpEL (Spring Expression Language) injection, leading to RCE (Remote Code Execution) due to the use of an unfiltered `StandardEvaluationContext`. The vulnerability exists in the `snail-job` application.

Weaknesses/vulnerabilities present:
- SpEL injection vulnerability
- Lack of input filtering in the expression evaluation process
- Use of `StandardEvaluationContext`, which supports the full SpEL syntax, including potentially dangerous operations like calling system commands.

Impact of exploitation:
Successful exploitation allows an attacker to execute arbitrary commands on the application server. The provided proof of concept (PoC) demonstrates this by executing the "calc" command.

Attack vectors:
The attack vector involves injecting a malicious SpEL expression into the "nodeExpression" field when creating or updating a decision node within the workflow/task management functionality. The PoC provides the exact HTTP request with the malicious payload.

Required attacker capabilities/position:
An attacker needs the ability to interact with the "snail-job" application, specifically the workflow/task management functionality, and the ability to send a crafted HTTP request with a malicious SpEL expression. The attacker also needs valid authentication credentials.

Mitigation or fix:
The recommended fix is to replace `StandardEvaluationContext` with `SimpleEvaluationContext` in the `SpELExpressionEngine.java` file.  `SimpleEvaluationContext` supports a subset of SpEL syntax and does not include Java type references, constructors, and bean references.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.427 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.408 |
| 3 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.358 |
| 4 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.350 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.349 |
| 6 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.348 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.345 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.341 |
| 9 | 306 | Missing Authentication for Critical Function | Base | Allowed | dense | 0.560 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

