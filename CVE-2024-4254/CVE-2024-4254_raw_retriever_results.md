# Raw Retriever Results for CVE-2024-4254

# Raw Retriever Results for CVE-2024-4254
## Query
The deploy-website.yml workflow in the gradio-app/gradio repository, specifically in the main branch, is vulnerable to secrets exfiltration due to improper authorization. The vulnerability arises from the workflows explicit checkout and execution of code from a fork, which is unsafe as it allows the running of untrusted code in an environment with access to push to the base repository and access secrets. This flaw could lead to the exfiltration of sensitive secrets such as GITHUB_TOKEN, HF_TOKEN, VERCEL_ORG_ID, VERCEL_PROJECT_ID, COMMENT_TOKEN, AWSACCESSKEYID, AWSSECRETKEY, and VERCEL_TOKEN. The vulnerability is present in the workflow file located at https//github.com/gradio-app/gradio/blob/72f4ca88ab569aae47941b3fb0609e57f2e13a27/.github/workflows/deploy-website.yml.

## Keyphrases
- **rootcause**: 'improper authorization'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5073 | 0.5504 | 0.5233 | 0.5247 | 20 |
| Sparse | 172.8218 | 800.0000 | 557.1020 | 575.0714 | 12 |
| Graph | 1.0062 | 1.7550 | 1.3471 | 1.4321 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 1.7550 | Allowed |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.7061 | Allowed |
| 3 | 306 | Missing Authentication for Critical Function | Base | 1.6626 | Allowed |
| 4 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 1.6311 | Allowed |
| 5 | 322 | Key Exchange without Entity Authentication | base | 1.5912 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.5504 | Allowed |
| 7 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 1.4919 | Allowed |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 1.4891 | Allowed |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | 1.4867 | Allowed |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | base | 1.4602 | Allowed |
| 11 | 526 | Cleartext Storage of Sensitive Information in an Environment Variable | variant | 1.4040 | Allowed |
| 12 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | base | 1.1794 | Allowed |
| 13 | 266 | Incorrect Privilege Assignment | base | 1.1794 | Allowed |
| 14 | 1191 | On-Chip Debug and Test Interface With Improper Access Control | base | 1.1466 | Allowed |
| 15 | 863 | Incorrect Authorization | Class | 1.0691 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.5504 | 0.5504 | Allowed |
| 2 | 863 | Incorrect Authorization | Class | 0.5396 | 0.5396 | Allowed-with-Review |
| 3 | 306 | Missing Authentication for Critical Function | Base | 0.5329 | 0.5329 | Allowed |
| 4 | 862 | Missing Authorization | Class | 0.5325 | 0.5325 | Allowed-with-Review |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5296 | 0.5296 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.5280 | 0.5280 | Allowed |
| 7 | 285 | Improper Authorization | Class | 0.5262 | 0.5262 | Discouraged |
| 8 | 502 | Deserialization of Untrusted Data | Base | 0.5258 | 0.5258 | Allowed |
| 9 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.5256 | 0.5256 | Allowed |
| 10 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.5251 | 0.5251 | Allowed |
| 11 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.5243 | 0.5243 | Allowed |
| 12 | 532 | Insertion of Sensitive Information into Log File | Base | 0.5237 | 0.5237 | Allowed |
| 13 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.5206 | 0.5206 | Allowed |
| 14 | 209 | Generation of Error Message Containing Sensitive Information | Base | 0.5173 | 0.5173 | Allowed |
| 15 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.5165 | 0.5165 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 284 | Improper Access Control | 800.0000 | 800.0000 | Discouraged |
| 2 | 214 | Invocation of Process Using Visible Sensitive Information | 640.2220 | 640.2220 | Allowed |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 596.0576 | 596.0576 | Allowed |
| 4 | 918 | Server-Side Request Forgery (SSRF) | 588.7960 | 588.7960 | Allowed |
| 5 | 863 | Incorrect Authorization | 578.9262 | 578.9262 | Allowed-with-Review |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | 577.0978 | 577.0978 | Allowed |
| 7 | 285 | Improper Authorization | 573.0450 | 573.0450 | Discouraged |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | 555.9409 | 555.9409 | Allowed |
| 9 | 862 | Missing Authorization | 541.8416 | 541.8416 | Allowed-with-Review |
| 10 | 470 | Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection') | 534.5058 | 534.5058 | Allowed |
| 11 | 939 | Improper Authorization in Handler for Custom URL Scheme | 525.9689 | 525.9689 | Allowed |
| 12 | 191 | Integer Underflow (Wrap or Wraparound) | 172.8218 | 172.8218 | Allowed |
