{
  "cve_id": "CVE-2025-23419",
  "description": "When multiple server blocks are configured to share the same IP address and port, an attacker can use session resumption to bypass client certificate authentication requirements on these servers. This vulnerability arises when TLS Session Tickets https//nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_session_ticket_key are used and/or the SSL session cache https//nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_session_cache are used in the default server and the default server is performing client certificate authentication. Note Software versions which have reached End of Technical Support (EoTS) are not evaluated.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "SSL session cache are used in the default server and the default server is performing client certificate authentication",
    "impact": "bypass client certificate authentication requirements",
    "vector": "session resumption",
    "attacker": "attacker",
    "product": "",
    "version": "",
    "component": ""
  },
  "reference_content": "Root cause of vulnerability:\nA problem with SSL session resumption in nginx allows reuse of SSL sessions in named-based virtual hosts in unrelated contexts.\n\nWeaknesses/vulnerabilities present:\nBypass of client certificate authentication.\n\nImpact of exploitation:\nAllows bypassing client certificate authentication in some configurations.\n\nAttack vectors:\nReusing SSL sessions in named-based virtual hosts in unrelated contexts.\n\nRequired attacker capabilities/position:\nAn attacker needs to be able to reuse SSL sessions.\n\nMitigation or fix:\nThe problem is fixed in nginx versions 1.26.3 and 1.27.4. The vulnerability affects nginx 1.11.4 and newer built with OpenSSL if TLSv1.3 protocol and session resumption are enabled (ssl_session_cache or ssl_session_tickets).\n\nThis content provides more detail than the official CVE description.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-295 | Improper Certificate Validation | 0.75 | Base | Allowed | Primary CWE |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Allowed | Secondary Candidate |\n| CWE-863 | Incorrect Authorization | 0.5 | Class | Allowed-with-Review | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE selected is CWE-295, which deals with improper certificate validation. The retriever results also suggest CWE-306 (Missing Authentication) and CWE-863 (Incorrect Authorization) as potential candidates. CWE-295 is chosen because the vulnerability involves bypassing client certificate authentication requirements. It's a base-level CWE, which is preferred. CWE-306 and CWE-863 are considered as contributing factors because the **weakness** allows bypassing authentication, but the root cause is specifically related to certificate validation during session resumption.\n\n```mermaid\ngraph TD\n    cwe295[\"CWE-295: Improper Certificate Validation\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe287[\"CWE-287: Improper Authentication\"]\n\n    cwe306 -->|CHILDOF| cwe287\n    cwe863 -->|CHILDOF| cwe287\n    cwe295 -->|CANPRECEDE| cwe306\n    cwe295 -->|CANPRECEDE| cwe863\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe295 primary\n    class cwe306,cwe863 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper configuration of SSL session caching in the default server** when client certificate authentication is enabled. This leads to the **bypass of client certificate authentication**. The root cause is the **improper validation of certificates during session resumption**, leading to potential missing or incorrect authorization checks.\n\n## Summary of Analysis\nThe initial analysis considered multiple CWEs, including authentication bypass and incorrect authorization. However, the key phrase from the vulnerability description, \"SSL session cache are used in the default server and the default server is performing client certificate authentication\" and the CVE reference summary \"Bypass of client certificate authentication\" pointed towards a problem with certificate validation. The final selection of CWE-295 is based on the root cause identified in the provided text. This is further supported by the CVE Reference Links Content Summary, which mentions the bypass of client certificate authentication. The selection is at the base level of abstraction, providing sufficient specificity.\n\nRelevant CWE Information:\n\n**CWE-295: Improper Certificate Validation**: The vulnerability directly involves bypassing client certificate authentication, making this CWE a strong match. This is the root cause of the authentication bypass.\n\n**CWE-306: Missing Authentication for Critical Function**: This could be a consequence of the **improper certificate validation**, but the root cause is the validation itself.\n\n**CWE-863: Incorrect Authorization**: Similar to CWE-306, this could be a result of the **improper certificate validation** if the system relies on the certificate for authorization decisions.\n\nThe description indicates that the vulnerability occurs when \"an attacker can use session resumption to bypass client certificate authentication requirements.\" This clearly indicates that the certificate validation is not being properly enforced during session resumption, which aligns perfectly with CWE-295.\n\nThe selection is based on the available evidence and aims to identify the root cause of the vulnerability.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-295 | Improper Certificate Validation | 0.75 | Base | Allowed | Primary CWE |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Allowed | Secondary Candidate |\n| CWE-863 | Incorrect Authorization | 0.5 | Class | Allowed-with-Review | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE selected is CWE-295, which deals with improper certificate validation. The retriever results also suggest CWE-306 (Missing Authentication) and CWE-863 (Incorrect Authorization) as potential candidates. CWE-295 is chosen because the vulnerability involves bypassing client certificate authentication requirements. It's a base-level CWE, which is preferred. CWE-306 and CWE-863 are considered as contributing factors because the **weakness** allows bypassing authentication, but the root cause is specifically related to certificate validation during session resumption.\n\n```mermaid\ngraph TD\n    cwe295[\"CWE-295: Improper Certificate Validation\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe287[\"CWE-287: Improper Authentication\"]\n\n    cwe306 -->|CHILDOF| cwe287\n    cwe863 -->|CHILDOF| cwe287\n    cwe295 -->|CANPRECEDE| cwe306\n    cwe295 -->|CANPRECEDE| cwe863\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe295 primary\n    class cwe306,cwe863 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper configuration of SSL session caching in the default server** when client certificate authentication is enabled. This leads to the **bypass of client certificate authentication**. The root cause is the **improper validation of certificates during session resumption**, leading to potential missing or incorrect authorization checks.\n\n## Summary of Analysis\nThe initial analysis considered multiple CWEs, including authentication bypass and incorrect authorization. However, the key phrase from the vulnerability description, \"SSL session cache are used in the default server and the default server is performing client certificate authentication\" and the CVE reference summary \"Bypass of client certificate authentication\" pointed towards a problem with certificate validation. The final selection of CWE-295 is based on the root cause identified in the provided text. This is further supported by the CVE Reference Links Content Summary, which mentions the bypass of client certificate authentication. The selection is at the base level of abstraction, providing sufficient specificity.\n\nRelevant CWE Information:\n\n**CWE-295: Improper Certificate Validation**: The vulnerability directly involves bypassing client certificate authentication, making this CWE a strong match. This is the root cause of the authentication bypass.\n\n**CWE-306: Missing Authentication for Critical Function**: This could be a consequence of the **improper certificate validation**, but the root cause is the validation itself.\n\n**CWE-863: Incorrect Authorization**: Similar to CWE-306, this could be a result of the **improper certificate validation** if the system relies on the certificate for authorization decisions.\n\nThe description indicates that the vulnerability occurs when \"an attacker can use session resumption to bypass client certificate authentication requirements.\" This clearly indicates that the certificate validation is not being properly enforced during session resumption, which aligns perfectly with CWE-295.\n\nThe selection is based on the available evidence and aims to identify the root cause of the vulnerability.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-306:**\n- 306 (Missing Authentication for Critical Function) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "295",
        "name": "Improper Certificate Validation",
        "source": "sparse"
      },
      "similarity": 489.922497148431
    },
    {
      "metadata": {
        "doc_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "source": "sparse"
      },
      "similarity": 475.04533161495135
    },
    {
      "metadata": {
        "doc_id": "290",
        "name": "Authentication Bypass by Spoofing",
        "source": "sparse"
      },
      "similarity": 466.2168479191831
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 457.89364882681895
    },
    {
      "metadata": {
        "doc_id": "319",
        "name": "Cleartext Transmission of Sensitive Information",
        "source": "sparse"
      },
      "similarity": 456.63021620505685
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 452.0980396790145
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 444.152106593236
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 441.2641040156139
    },
    {
      "metadata": {
        "doc_id": "384",
        "name": "Session Fixation",
        "type": "Compound",
        "original_content": "Authenticating a user, or otherwise establishing a new user session, without invalidating any existing session identifier gives an attacker the opportunity to steal authenticated sessions.",
        "keyphrase_source": "weakness:SSL session cache are used in the default server",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This is a well-known Composite of multiple weaknesses that must all occur simultaneously, although it is attack-oriented in nature.",
          "comments": "While attack-oriented composites are supported in CWE, they have not been a focus of research. There is a chance that future research or CWE scope clarifications will change or deprecate them. Perform root-cause analysis to determine which weaknesses allow session fixation to occur, and map to those weaknesses. For example, predictable session identifiers might enable session fixation attacks to succeed; if this occurs, they might be better characterized as randomness/predictability weaknesses.",
          "reasons": [
            "Other"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5030784281786671
          }
        }
      },
      "similarity": 0.5030784281786671
    },
    {
      "doc_id": "350",
      "text": "CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action",
      "score": 2.6784000000000003,
      "metadata": {
        "doc_id": "350",
        "name": "Reliance on Reverse DNS Resolution for a Security-Critical Action",
        "type": "variant",
        "original_content": "CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action",
        "relationships": [
          {
            "source_id": "350",
            "target_id": "923",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "350",
            "target_id": "807",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "350",
            "target_id": "290",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "923",
            "target_id": "350",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "807",
            "target_id": "350",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "290",
            "target_id": "350",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.76,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.2,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "923",
                  "350",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "923"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "290",
                  "350",
                  "PARENTOF"
                ]
              ],
              "score": 0.76,
              "type": "abstraction_path_down",
              "source": "290"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "923",
                  "350",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "923"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "350",
                  "923",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "923"
            }
          }
        },
        "abstraction_level": "variant",
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.6784000000000003
          }
        }
      },
      "similarity": 2.6784000000000003
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-306",
      "CWE-287",
      "CWE-295"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}