# Vulnerability Information: CVE-2024-13369

## Vulnerability Description
The Tour Master - Tour Booking, Travel, Hotel plugin for WordPress is vulnerable to **time-based SQL Injection** via the review_id parameter in all versions up to, and including, 5.3.6 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Subscriber-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL Injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers with Subscriber-level access and above
- **product:** Tour Master - Tour Booking and Hotel WordPress plugin and Travel
- **version:** all versions up to and including 5.3.6

## CVE Reference Links Content Summary
CVE-2024-13369 - PLACEHOLDER - Implement CVE description retrieval

The provided content is a changelog for the "Tour Master" plugin for WordPress. It details numerous updates and bug fixes across many versions, from v5.0.0 down to v4.0.0 and earlier.  Several entries specifically mention "security improvement" or "improve securities" without providing details.

Here's a breakdown of the security-related information extracted from the changelog:

* **Root cause of vulnerability:** Not specified. The changelog only indicates security improvements were made, but doesn't detail the underlying vulnerabilities.
* **Weaknesses/vulnerabilities present:** Not specified. The changelog does not list specific vulnerabilities that were addressed.
* **Impact of exploitation:** Not specified.
* **Attack vectors:** Not specified.
* **Required attacker capabilities/position:** Not specified.
* **Mitigation or fix:** The mitigation is to update to the latest version of the plugin. Specific versions with security improvements are:
    * **v5.3.9:** "Improve security – include/template-settings.php"
    * **v5.3.8:** "improve securities – include/table-util.php"
    * **v5.3.5:** "Security improvement – single/login.php, include/custom-filter.php, include/paypal.php, include/user-util.php, include/payment-util.php, include/stripe/stripe.php, tour/include/order.php, tour/include/tour-option.php, tour/single/user/my-booking.php, room/include/order.php, room/include/paypal.php, room/include/user-page.php, room/single/user/room-booking.php, room/single/user/wishlist.php, room/include/pb/pb-element-room-review.php, room/include/pb/room-style.php"
    * **v5.3.4:** "Security improvement – include/utility.php, room/include/payment-element.php, room/include/order.php, tour/include/order.php, include/payment-util.php, include/table-util.php, include/utility.php"
    * **v5.3.0:** "Improve security" (general statement)
    * **v5.2.5:** "Security improvement – single/login.php, include/custom-filter.php, include/paypal.php, include/user-util.php, include/payment-util.php, include/stripe/stripe.php, tour/include/order.php, tour/include/tour-option.php, tour/single/user/my-booking.php, room/include/order.php, room/include/paypal.php, room/include/user-page.php, room/single/user/room-booking.php, room/single/user/wishlist.php, room/include/pb/pb-element-room-review.php, room/include/pb/room-style.php"
    * **v5.2.4:** "Security improvement – include/utility.php, room/include/payment-element.php, room/include/order.php, tour/include/order.php, include/payment-util.php, include/table-util.php, include/utility.php"

The content provides more detail than the official CVE description (which is currently a placeholder) by listing specific files that were modified as part of the security improvements. However, it does *not* provide details about the nature of the vulnerabilities themselves.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.582 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.519 |
| 4 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.504 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.501 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.497 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.496 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.492 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.474 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

