# Raw Retriever Results for CVE-2025-0628

# Raw Retriever Results for CVE-2025-0628
## Query
An improper authorization vulnerability exists in the main-latest version of BerriAI/litellm. When a user with the role internal_user_viewer logs into the application, they are provided with an overly privileged API key. This key can be used to access all the admin functionality of the application, including endpoints such as /users/list and /users/get_users. This vulnerability allows for privilege escalation within the application, enabling any account to become a PROXY ADMIN.

## Keyphrases
- **rootcause**: 'improper authorization'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4572 | 0.5136 | 0.4834 | 0.4798 | 20 |
| Sparse | 135.4811 | 800.0000 | 413.1509 | 422.9496 | 13 |
| Graph | 1.0062 | 2.2100 | 1.3438 | 1.0781 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 3 | 202 | Exposure of Sensitive Information Through Data Queries | base | 2.0452 | Allowed |
| 4 | 267 | Privilege Defined With Unsafe Actions | Base | 1.7062 | Allowed |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.7040 | Allowed |
| 6 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 7 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 1.4864 | Allowed |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.4740 | Allowed |
| 9 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.1466 | Allowed |
| 10 | 623 | Unsafe ActiveX Control Marked Safe For Scripting | variant | 1.0920 | Allowed |
| 11 | 269 | Improper Privilege Management | Class | 1.0642 | Discouraged |
| 12 | 863 | Incorrect Authorization | Class | 1.0615 | Allowed-with-Review |
| 13 | 285 | Improper Authorization | Class | 1.0597 | Discouraged |
| 14 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.0584 | Allowed |
| 15 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | base | 1.0062 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 267 | Privilege Defined With Unsafe Actions | Base | 0.5136 | 0.5136 | Allowed |
| 2 | 269 | Improper Privilege Management | Class | 0.5125 | 0.5125 | Discouraged |
| 3 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.5091 | 0.5091 | Allowed |
| 4 | 863 | Incorrect Authorization | Class | 0.5084 | 0.5084 | Allowed-with-Review |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5075 | 0.5075 | Allowed |
| 6 | 285 | Improper Authorization | Class | 0.5042 | 0.5042 | Discouraged |
| 7 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4990 | 0.4990 | Allowed |
| 8 | 862 | Missing Authorization | Class | 0.4956 | 0.4956 | Allowed-with-Review |
| 9 | 306 | Missing Authentication for Critical Function | Base | 0.4950 | 0.4950 | Allowed |
| 10 | 250 | Execution with Unnecessary Privileges | Base | 0.4876 | 0.4876 | Allowed |
| 11 | 532 | Insertion of Sensitive Information into Log File | Base | 0.4720 | 0.4720 | Allowed |
| 12 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4710 | 0.4710 | Allowed |
| 13 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.4708 | 0.4708 | Allowed |
| 14 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 0.4639 | 0.4639 | Allowed |
| 15 | 1188 | Initialization of a Resource with an Insecure Default | Base | 0.4624 | 0.4624 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 284 | Improper Access Control | 800.0000 | 800.0000 | Discouraged |
| 2 | 863 | Incorrect Authorization | 455.5608 | 455.5608 | Allowed-with-Review |
| 3 | 285 | Improper Authorization | 440.5472 | 440.5472 | Discouraged |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | 438.4412 | 438.4412 | Allowed |
| 5 | 269 | Improper Privilege Management | 430.9130 | 430.9130 | Discouraged |
| 6 | 287 | Improper Authentication | 427.7300 | 427.7300 | Discouraged |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | 422.9496 | 422.9496 | Allowed |
| 8 | 425 | Direct Request ('Forced Browsing') | 420.8875 | 420.8875 | Allowed |
| 9 | 306 | Missing Authentication for Critical Function | 420.8754 | 420.8754 | Allowed |
| 10 | 267 | Privilege Defined With Unsafe Actions | 420.7809 | 420.7809 | Allowed |
| 11 | 862 | Missing Authorization | 420.4144 | 420.4144 | Allowed-with-Review |
| 12 | 532 | Insertion of Sensitive Information into Log File | 136.3803 | 136.3803 | Allowed |
| 13 | 522 | Insufficiently Protected Credentials | 135.4811 | 135.4811 | Allowed-with-Review |
