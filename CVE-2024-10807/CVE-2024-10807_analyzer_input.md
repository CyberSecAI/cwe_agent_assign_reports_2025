# Vulnerability Information: CVE-2024-10807

## Vulnerability Description
A vulnerability was found in PHPGurukul Hospital Management System 4.0. It has been rated as problematic. This issue affects some unknown processing of the file hms/doctor/search.php. The manipulation of the argument searchdata leads to **cross site scripting**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **cross site scripting**
- **vector:** manipulation of searchdata argument
- **product:** PHPGurukul Hospital Management System
- **version:** 4
- **component:** hms/doctor/search.php

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The application directly outputs user-supplied data from the `$_POST['searchdata']` parameter into the HTML response without any sanitization or encoding.

**Weaknesses/Vulnerabilities Present:**

*   **Cross-Site Scripting (XSS):** The lack of input sanitization allows an attacker to inject arbitrary HTML or JavaScript code, leading to an XSS vulnerability.

**Impact of Exploitation:**

*   An attacker can inject malicious scripts that can:
    *   Steal cookies or session tokens.
    *   Redirect users to malicious websites.
    *   Deface the website.
    *   Perform actions on behalf of the user.

**Attack Vectors:**

*   The attacker crafts a malicious payload containing JavaScript code.
*   The attacker submits this payload in the `searchdata` parameter via a POST request to the `search.php` file.
*   The application reflects the unsanitized input back into the HTML, causing the browser to execute the attacker's JavaScript code.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to send a POST request to the vulnerable `search.php` endpoint.
*   The attacker needs to be able to manipulate the `searchdata` parameter within the POST request. No authentication is mentioned, so it appears no login is required.

**Additional Details:**

*   **Vulnerable File:** `hms/doctor/search.php`
*  **Vulnerable Parameter:** `searchdata`
*   **Vulnerable Code Snippet:**

    ```php
    if(isset($_POST['search']))
    {
    $sdata=$_POST['searchdata'];
    ?>
    <h4 align="center">Result against "<?php echo $sdata;?>" keyword </h4>
    ```

*   **Demonstration Payload:** `<script>alert('XSS')</script>` or `"></script><script>alert('XSS')</script>` (latter provided in the demonstration section of the github content).
*   The provided content includes images that show the vulnerable search field, how the payload is injected, and the resulting XSS alert.
*   **Mitigation:** The provided content also describes using `htmlspecialchars()` to sanitize the output as a prevention technique.

This vulnerability is more specifically a reflected XSS vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.479 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.469 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.376 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.357 |
| 5 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.348 |
| 6 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.333 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.325 |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.311 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.539 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

