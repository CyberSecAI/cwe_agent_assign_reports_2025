# Raw Retriever Results for CVE-2024-1544

# Raw Retriever Results for CVE-2024-1544
## Query
Generating the ECDSA nonce k samples a random number r and then truncates this randomness with a modular reduction mod n where n is the order of the elliptic curve. Meaning k = r mod n. The division used during the reduction estimates a factor q_e by dividing the upper two digits (a digit having e.g. a size of 8 byte) of r by the upper digit of n and then decrements q_e in a loop until it has the correct size. Observing the number of times q_e is decremented through a control-flow revealing side-channel reveals a bias in the most significant bits of k. Depending on the curve this is either a negligible bias or a significant bias large enough to reconstruct k with lattice reduction methods. For SECP160R1, e.g., we find a bias of 15 bits.

## Keyphrases
- **weakness**: 'truncation of randomness for ECDSA nonce k'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3225 | 0.4411 | 0.3801 | 0.3877 | 20 |
| Sparse | 208.6666 | 650.4858 | 556.9785 | 622.6136 | 12 |
| Graph | 1.2542 | 2.4700 | 1.7078 | 1.5043 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 208 | Observable Timing Discrepancy | base | 2.4700 | Allowed |
| 2 | 203 | Observable Discrepancy | base | 2.4700 | Allowed |
| 3 | 347 | Improper Verification of Cryptographic Signature | base | 2.3296 | Allowed |
| 4 | 385 | Covert Timing Channel | base | 2.2100 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.1190 | Allowed |
| 6 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 7 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 8 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | 1.6789 | Allowed |
| 9 | 129 | Improper Validation of Array Index | variant | 1.5552 | Allowed |
| 10 | 341 | Predictable from Observable State | base | 1.5210 | Allowed |
| 11 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | 1.4876 | Allowed |
| 12 | 336 | Same Seed in Pseudo-Random Number Generator (PRNG) | Variant | 1.4773 | Allowed |
| 13 | 339 | Small Seed Space in PRNG | Variant | 1.4754 | Allowed |
| 14 | 197 | Numeric Truncation Error | Base | 1.4264 | Allowed |
| 15 | 195 | Signed to Unsigned Conversion Error | variant | 1.4040 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | 0.4411 | 0.4411 | Allowed |
| 2 | 332 | Insufficient Entropy in PRNG | Variant | 0.4244 | 0.4244 | Allowed |
| 3 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | 0.4221 | 0.4221 | Allowed |
| 4 | 336 | Same Seed in Pseudo-Random Number Generator (PRNG) | Variant | 0.4141 | 0.4141 | Allowed |
| 5 | 339 | Small Seed Space in PRNG | Variant | 0.4124 | 0.4124 | Allowed |
| 6 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | 0.4104 | 0.4104 | Allowed |
| 7 | 323 | Reusing a Nonce, Key Pair in Encryption | Base | 0.4082 | 0.4082 | Allowed |
| 8 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | 0.4048 | 0.4048 | Allowed |
| 9 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | 0.3964 | 0.3964 | Allowed |
| 10 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | 0.3933 | 0.3933 | Allowed |
| 11 | 343 | Predictable Value Range from Previous Values | Base | 0.3821 | 0.3821 | Allowed |
| 12 | 780 | Use of RSA Algorithm without OAEP | Variant | 0.3613 | 0.3613 | Allowed |
| 13 | 1291 | Public Key Re-Use for Signing both Debug and Production Code | Base | 0.3587 | 0.3587 | Allowed |
| 14 | 333 | Improper Handling of Insufficient Entropy in TRNG | Variant | 0.3519 | 0.3519 | Allowed |
| 15 | 342 | Predictable Exact Value from Previous Values | Base | 0.3518 | 0.3518 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 197 | Numeric Truncation Error | 650.4858 | 650.4858 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | 638.2812 | 638.2812 | Allowed |
| 3 | 203 | Observable Discrepancy | 636.2725 | 636.2725 | Allowed |
| 4 | 347 | Improper Verification of Cryptographic Signature | 635.0464 | 635.0464 | Allowed |
| 5 | 208 | Observable Timing Discrepancy | 629.0094 | 629.0094 | Allowed |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 625.6475 | 625.6475 | Allowed |
| 7 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | 619.5798 | 619.5798 | Allowed |
| 8 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | 613.3443 | 613.3443 | Allowed |
| 9 | 667 | Improper Locking | 611.0942 | 611.0942 | Allowed-with-Review |
| 10 | 330 | Use of Insufficiently Random Values | 606.3788 | 606.3788 | Discouraged |
| 11 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 209.9350 | 209.9350 | Allowed |
| 12 | 193 | Off-by-one Error | 208.6666 | 208.6666 | Allowed |
