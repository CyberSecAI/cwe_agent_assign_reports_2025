## Vulnerability Description
Arc before 2024-08-26 allows remote code execution in JavaScript boosts. Boosts that run JavaScript cannot be shared by default however (because of **misconfigured Firebase ACLs**), it is possible to create or update a boost using another users ID. This installs the boost in the victims browser and runs arbitrary Javascript on that browser in a privileged context. NOTE this is a no-action cloud vulnerability with zero affected users.

### Vulnerability Description Key Phrases
- **rootcause:** **misconfigured Firebase ACLs**
- **impact:** create or update boost using another users ID and remote code execution and run arbitrary Javascript
- **product:** Arc
- **version:** before 2024-08-26

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the CVE-2024-45489 vulnerability:

**1. Root Cause:**

*   The vulnerability stemmed from misconfigured Access Control Lists (ACLs) in Arc's Firebase backend.
*   Specifically, the ACLs did not properly restrict modifications to the `creatorID` field of "Boosts" (custom website modifications) stored in Firebase.

**2. Weaknesses/Vulnerabilities Present:**

*   **Insecure Direct Object Reference (IDOR):** The core issue was that users could modify the `creatorID` of a Boost. Since the `creatorID` determines which user a Boost applies to, this allowed for unauthorized assignment of boosts to other users.
*   **Lack of Input Validation/Authorization:** The system failed to properly validate and authorize the user making the request to change the `creatorID` field. It essentially trusted the client-side request and did not verify the user's permissions on the server-side.
*   **Remote Code Execution (RCE):** Because Boosts can contain arbitrary Javascript, an attacker could create a malicious boost, assign it to a victim, and then force the execution of arbitrary javascript within the victim's browser when they visit the target website.
*   **Privacy Violation:** The browser was sending website URLs to Firebase on each page load to determine which boosts should be applied, which violated their own privacy policy. This was happening when the boost editor was open.

**3. Impact of Exploitation:**

*   **Remote Code Execution:** An attacker could achieve RCE on any user's Arc browser by changing the ownership of a crafted "boost".
*   **Data Exfiltration:** Through RCE, an attacker could steal cookies, credentials, or other sensitive information from the victim's browser session.
*   **Cross-site Scripting (XSS):** Since a malicious Boost would execute its JavaScript in the context of a user's browser session on a specific website, the attacker could potentially perform XSS attacks on that website.
*   **Privacy Violation:** The browser was sending website URLs to Firebase on each page load, violating user privacy by tracking browsing history, when boost editor was open.

**4. Attack Vectors:**

*   **Direct Firebase API manipulation:** Attackers directly manipulated the Firebase API to change `creatorID` field via API calls to firestore.
*   **Exploitation of shared resources:** Attackers could obtain user IDs of potential victims through shared boosts or easels features.

**5. Required Attacker Capabilities/Position:**

*   **Arc User Account:** The attacker needs an Arc account to create boosts and interact with the Firebase database.
*   **Knowledge of Firebase:** Understanding how the Firebase API and Firestore security rules work was needed to exploit the vulnerability.
*   **Victim User ID:** The attacker required a victim's user ID to target them with the malicious boost. The ID can be acquired in many ways, like user referral, published boosts or user easels.
*   **Network Access:** The attacker needed the ability to send Firebase API requests to alter the boost's `creatorID`.

**Additional Details Not in the CVE Description:**

*   The attacker publicly disclosed how to retrieve user IDs using shared boosts, shared easels and user referrals.
*   The exploit could be leveraged on privileged pages like `chrome://settings`
*   The company's initial response included patching the vulnerability, acknowledging the flaw, planning to implement a formal bug bounty program, and promising to move away from Firebase for new features.
*   The company initially awarded a bounty of $2,000 for the report, which was met with public criticism of the low reward amount.
*   The company was sending URLs to Firebase while the Boost editor was open, violating their privacy policy.

**Timeline:**
*   **Aug 25 5:48pm:** Initial contact with Arc co-founder over signal (encrypted)
*   **Aug 25 6:02pm:** Vulnerability PoC executed on co-founder's account.
*   **Aug 25 6:13pm:** Added to Slack channel after details shared.
*   **Aug 26 9:41pm:** Vulnerability patched and bounty awarded.
*   **Sep 6 7:49pm:** CVE Assigned

The content provides significant detail beyond the basic CVE description, including technical details, context, and the company's response.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.384 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.377 |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.374 |
| 4 | 451 | User Interface (UI) Misrepresentation of Critical Information | Class | Allowed-with-Review | sparse | 0.359 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.358 |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.353 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.352 |
| 8 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.350 |
| 9 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | dense | 0.492 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-451: User Interface (UI) Misrepresentation of Critical Information

CWE-116: Improper Encoding or Escaping of Output

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-863: Incorrect Authorization

CWE-918: Server-Side Request Forgery (SSRF)

CWE-1021: Improper Restriction of Rendered UI Layers or Frames

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')