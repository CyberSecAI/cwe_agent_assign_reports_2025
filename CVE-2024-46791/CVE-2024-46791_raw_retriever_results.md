# Raw Retriever Results for CVE-2024-46791

# Raw Retriever Results for CVE-2024-46791
## Query
In the Linux kernel, the following vulnerability has been resolved can mcp251x fix deadlock if an interrupt occurs during mcp251x_open The mcp251x_hw_wake() function is called with the mpc_lock mutex held and disables the interrupt handler so that no interrupts can be processed while waking the device. If an interrupt has already occurred then waiting for the interrupt handler to complete will deadlock because it will be trying to acquire the same mutex. CPU0 CPU1 ---- ---- mcp251x_open() mutex_lock(&priv->mcp_lock) request_threaded_irq() mcp251x_can_ist() mutex_lock(&priv->mcp_lock) mcp251x_hw_wake() disable_irq() <-- deadlock Use disable_irq_nosync() instead because the interrupt handler does everything while holding the mutex so it doesnt matter if its still running.

## Keyphrases
- **rootcause**: 'improper use of disable_irq() function'
- **weakness**: 'deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4160 | 0.5059 | 0.4462 | 0.4417 | 20 |
| Sparse | 384.2895 | 564.7128 | 474.1343 | 461.6247 | 11 |
| Graph | 1.3010 | 2.4700 | 1.7394 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.4700 | Allowed |
| 2 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 3 | 831 | Signal Handler Function Associated with Multiple Signals | variant | 2.1624 | Allowed |
| 4 | 479 | Signal Handler Use of a Non-reentrant Function | variant | 2.0659 | Allowed |
| 5 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 6 | 415 | Double Free | variant | 2.0400 | Allowed |
| 7 | 833 | Deadlock | Base | 1.6957 | Allowed |
| 8 | 413 | Improper Resource Locking | Base | 1.6947 | Allowed |
| 9 | 134 | Use of Externally-Controlled Format String | base | 1.6848 | Allowed |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.6848 | Allowed-with-Review |
| 11 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 12 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 1.6838 | Allowed |
| 13 | 590 | Free of Memory not on the Heap | variant | 1.5552 | Allowed |
| 14 | 368 | Context Switching Race Condition | base | 1.5210 | Allowed |
| 15 | 1037 | Processor Optimization Removal or Modification of Security-critical Code | base | 1.5210 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5059 | 0.5059 | Allowed |
| 2 | 413 | Improper Resource Locking | Base | 0.4990 | 0.4990 | Allowed |
| 3 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4788 | 0.4788 | Allowed |
| 4 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4712 | 0.4712 | Allowed |
| 5 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.4652 | 0.4652 | Allowed |
| 6 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | 0.4586 | 0.4586 | Allowed |
| 7 | 667 | Improper Locking | Class | 0.4516 | 0.4516 | Allowed-with-Review |
| 8 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4501 | 0.4501 | Allowed |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4468 | 0.4468 | Allowed |
| 10 | 832 | Unlock of a Resource that is not Locked | Base | 0.4455 | 0.4455 | Allowed |
| 11 | 1262 | Improper Access Control for Register Interface | Base | 0.4380 | 0.4380 | Allowed |
| 12 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4377 | 0.4377 | Allowed |
| 13 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.4286 | 0.4286 | Allowed |
| 14 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4267 | 0.4267 | Allowed |
| 15 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 0.4245 | 0.4245 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 564.7128 | 564.7128 | Allowed-with-Review |
| 2 | 833 | Deadlock | 529.8189 | 529.8189 | Allowed |
| 3 | 364 | Signal Handler Race Condition | 527.6374 | 527.6374 | Allowed |
| 4 | 828 | Signal Handler with Functionality that is not Asynchronous-Safe | 502.9002 | 502.9002 | Allowed |
| 5 | 831 | Signal Handler Function Associated with Multiple Signals | 486.2481 | 486.2481 | Allowed |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 461.6247 | 461.6247 | Allowed-with-Review |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 460.2885 | 460.2885 | Allowed |
| 8 | 459 | Incomplete Cleanup | 446.7010 | 446.7010 | Allowed |
| 9 | 346 | Origin Validation Error | 426.6234 | 426.6234 | Allowed-with-Review |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 424.6328 | 424.6328 | Allowed |
| 11 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | 384.2895 | 384.2895 | Allowed |
