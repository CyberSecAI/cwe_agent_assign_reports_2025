# Vulnerability Information: CVE-2024-4295

## Vulnerability Description
The Email Subscribers by Icegram Express plugin for WordPress is vulnerable to SQL Injection via the hash parameter in all versions up to, and including, 5.7.20 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **vector:** hash parameter
- **attacker:** unauthenticated attackers
- **product:** Email Subscribers by Icegram Express
- **version:** up to 5.7.20

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-4295

**Root Cause:** The vulnerability stems from insufficient sanitization and escaping of the `hash` parameter within the "Email Subscribers by Icegram Express" WordPress plugin. This lack of proper input handling, combined with the absence of sufficient preparation on the existing SQL query, allows for SQL injection.

**Weaknesses/Vulnerabilities:**
* **SQL Injection:** The primary vulnerability is SQL injection. The plugin fails to properly sanitize user-supplied input (`hash` parameter) before using it in a SQL query.
* **Insufficient Input Sanitization:** The plugin does not adequately escape the user-supplied `hash` parameter.
* **Lack of Prepared Statements:**  The existing SQL query is not sufficiently prepared, which allows attackers to inject malicious SQL code.

**Impact of Exploitation:**
* **Sensitive Information Disclosure:** Attackers can extract sensitive information from the database by injecting malicious SQL queries. This could include user data, email lists, configuration details, or other confidential information stored in the database.
* **Data Manipulation:** While not explicitly mentioned, SQL injection could potentially lead to data manipulation within the database.
* **Complete Compromise:** In severe cases, this vulnerability could lead to full database takeover and potentially compromise the entire WordPress installation.

**Attack Vectors:**
* **Network:** Attackers can exploit this vulnerability remotely over the network.
* **Unauthenticated:**  The vulnerability is exploitable by unauthenticated users, meaning no login is required to initiate the attack.
* **`hash` Parameter:** The vulnerable parameter is identified as `hash`.

**Required Attacker Capabilities/Position:**
* **Network Access:** The attacker needs to have network access to the target WordPress site.
* **No authentication:** The attacker does not need any authentication or any specific user privileges to exploit the vulnerability.
* **Knowledge of the vulnerable parameter:** The attacker needs to know that the `hash` parameter is vulnerable.

**Additional Notes:**
* The Wordfence article indicates that 8,919 attacks targeting this vulnerability were blocked in the 24 hours prior to publication.
* The vulnerable versions are all versions up to and including 5.7.20 of the Email Subscribers by Icegram Express plugin.
* The patched version is 5.7.21, which contains the fix for this vulnerability.
* The provided changeset shows that `absint` was added to the array\_map to prevent SQL injection.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.546 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.494 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.492 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.473 |
| 6 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.472 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.470 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.467 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.502 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

