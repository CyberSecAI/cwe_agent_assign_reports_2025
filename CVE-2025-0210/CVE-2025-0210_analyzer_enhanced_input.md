## Vulnerability Description
A vulnerability has been found in Campcodes School Faculty Scheduling System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /admin/ajax.php?action=login. The manipulation of the argument username leads to **sql injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** Campcodes School Faculty Scheduling System
- **version:** 1
- **component:** /admin/ajax.php?action=login

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**CVE ID:** CVE-2025-0210 (Based on the document title)

**Root Cause of Vulnerability:**

*   The vulnerability stems from a **blind SQL injection** in the `login()` function within the `/admin/ajax.php` file of the School Faculty Scheduling System. The application directly incorporates user-supplied data from the `username` and `password` fields into an SQL query without proper sanitization or parameterization. Specifically, the `username` parameter is directly concatenated into the SQL query string.

**Weaknesses/Vulnerabilities Present:**

*   **Blind SQL Injection:** The primary vulnerability is blind SQL injection. This means that the attacker cannot directly see the results of their SQL queries in the application's responses. However, they can infer information by observing the application's behavior, such as response times, which can be manipulated using time-based injection techniques.
*   **Lack of Input Sanitization:** The application fails to sanitize or validate user inputs before using them in database queries, specifically the `username` parameter.
*   **MD5 Hashing of Password:** While MD5 hashing is used for the password, the injection is in the username field and can be exploited without breaking the password hash.

**Impact of Exploitation:**

*   **Authentication Bypass:** An attacker can potentially bypass the login mechanism by injecting SQL queries that always return true, effectively gaining unauthorized access to the admin panel.
*   **Data Exfiltration:** Although it is a blind SQL injection, an attacker can use techniques like time-based injection to extract sensitive data, such as user credentials, from the database.
*   **Data Modification:** While less likely, with time and effort, it may be possible to modify the database.

**Attack Vectors:**

*   **HTTP POST Request:** The attack vector is through a crafted HTTP POST request to the `/admin/ajax.php` endpoint with the `action=login` parameter.
*   **Malicious Username Parameter:** The core of the attack lies in crafting a malicious `username` parameter containing SQL injection payloads.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker requires network access to the server hosting the vulnerable application.
*   **Basic HTTP Knowledge:** The attacker needs a basic understanding of how to send HTTP POST requests and how to craft URL encoded payloads.
*   **SQL Injection Knowledge:** The attacker needs knowledge of SQL syntax and blind SQL injection techniques, including time-based injection methods.

**Additional Details (from the provided content):**

*   **Affected Component:** `/admin/ajax.php`
*   **Vulnerable Function:** `login()`
*   **Payload Example:** The provided proof-of-concept (PoC) shows a time-based blind SQL injection payload within the `username` field, using `SLEEP(7)` to cause a noticeable delay and confirm the injection.
*   **Targeted System:** The system is identified as a "School Faculty Scheduling System," which suggests that the application likely holds sensitive information about faculty and scheduling data.
*   **Vendor Information:** The content links to the vendor's page on CampCodes, where the vulnerable application was likely downloaded.

In summary, this is a serious vulnerability that could lead to a complete compromise of the application and its data.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.433 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.370 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.369 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.359 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.347 |
| 7 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.333 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.333 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.588 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-117: Improper Output Neutralization for Logs

CWE-306: Missing Authentication for Critical Function

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-73: External Control of File Name or Path