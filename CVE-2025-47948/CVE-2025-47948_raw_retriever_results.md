# Raw Retriever Results for CVE-2025-47948

# Raw Retriever Results for CVE-2025-47948
## Query
Cocotais Bot is a QQ official robot framework based on qq-bot-sdk. Starting in version 1.5.0-test2-hotfix and prior to version 1.6.2, command echoing feature in the framework allows users to indirectly trigger privileged behavior by injecting special platform tags. Specifically, an unauthorized user can use the `/echo ` command to cause the bot to send a message that mentions all members in the chat, bypassing any permission controls. This can lead to spam, disruption, or abuse of notification systems. Version 1.6.2 contains a patch for the issue.

## Keyphrases
- **rootcause**: 'command echoing feature in framework'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3310 | 0.4037 | 0.3567 | 0.3609 | 20 |
| Sparse | 149.5868 | 512.3048 | 458.3392 | 487.6472 | 11 |
| Graph | 1.3676 | 3.1917 | 1.8514 | 1.5609 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 3.1917 | Allowed |
| 2 | 184 | Incomplete List of Disallowed Inputs | Base | 2.7658 | Allowed |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 2.3584 | Allowed |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | base | 2.3296 | Allowed |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.2100 | Allowed |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | base | 2.2100 | Allowed |
| 7 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 8 | 494 | Download of Code Without Integrity Check | base | 1.7680 | Allowed |
| 9 | 294 | Authentication Bypass by Capture-replay | Base | 1.5807 | Allowed |
| 10 | 267 | Privilege Defined With Unsafe Actions | Base | 1.5665 | Allowed |
| 11 | 473 | PHP External Variable Modification | variant | 1.5552 | Allowed |
| 12 | 456 | Missing Initialization of a Variable | variant | 1.5552 | Allowed |
| 13 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 1.5552 | Allowed |
| 14 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 1.5324 | Allowed-with-Review |
| 15 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | base | 1.5210 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 790 | Improper Filtering of Special Elements | Class | 0.4037 | 0.4037 | Allowed-with-Review |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.3829 | 0.3829 | Allowed |
| 3 | 294 | Authentication Bypass by Capture-replay | Base | 0.3819 | 0.3819 | Allowed |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.3731 | 0.3731 | Allowed |
| 5 | 799 | Improper Control of Interaction Frequency | Class | 0.3710 | 0.3710 | Allowed-with-Review |
| 6 | 73 | External Control of File Name or Path | Base | 0.3701 | 0.3701 | Allowed |
| 7 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | 0.3688 | 0.3688 | Allowed |
| 8 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.3687 | 0.3687 | Allowed |
| 9 | 514 | Covert Channel | Class | 0.3676 | 0.3676 | Allowed-with-Review |
| 10 | 250 | Execution with Unnecessary Privileges | Base | 0.3667 | 0.3667 | Allowed |
| 11 | 1287 | Improper Validation of Specified Type of Input | Base | 0.3551 | 0.3551 | Allowed |
| 12 | 863 | Incorrect Authorization | Class | 0.3453 | 0.3453 | Allowed-with-Review |
| 13 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.3411 | 0.3411 | Allowed |
| 14 | 121 | Stack-based Buffer Overflow | Variant | 0.3397 | 0.3397 | Allowed |
| 15 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.3354 | 0.3354 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 512.3048 | 512.3048 | Allowed-with-Review |
| 2 | 267 | Privilege Defined With Unsafe Actions | 506.5396 | 506.5396 | Allowed |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 500.4369 | 500.4369 | Allowed |
| 4 | 116 | Improper Encoding or Escaping of Output | 499.0513 | 499.0513 | Allowed-with-Review |
| 5 | 184 | Incomplete List of Disallowed Inputs | 488.9238 | 488.9238 | Allowed |
| 6 | 285 | Improper Authorization | 487.6472 | 487.6472 | Discouraged |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | 477.0478 | 477.0478 | Allowed |
| 8 | 138 | Improper Neutralization of Special Elements | 475.1526 | 475.1526 | Discouraged |
| 9 | 1333 | Inefficient Regular Expression Complexity | 474.0334 | 474.0334 | Allowed |
| 10 | 1390 | Weak Authentication | 471.0071 | 471.0071 | Allowed-with-Review |
| 11 | 284 | Improper Access Control | 149.5868 | 149.5868 | Discouraged |
