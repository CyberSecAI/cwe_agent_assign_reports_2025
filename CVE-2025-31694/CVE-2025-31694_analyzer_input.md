# Vulnerability Information: CVE-2025-31694

# Vulnerability Description

    **Incorrect Authorization** vulnerability in Drupal Two-factor Authentication (TFA) allows Forceful Browsing.This issue affects Two-factor Authentication (TFA) from 0.0.0 before 1.10.0.

    # Keyphrase-Specific CWE Analysis
    This vulnerability contains multiple keyphrases that may map to different CWEs. 
    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.

    ## ROOTCAUSE: 'Incorrect Authorization'

Relevant CWEs for this ROOTCAUSE:

### 1. CWE-697: Incorrect Comparison (Score: 165.19)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 2. CWE-1390: Weak Authentication (Score: 148.27)

The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....

### 3. CWE-287: Improper Authentication (Score: 148.12)

When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....

### 4. CWE-425: Direct Request ('Forced Browsing') (Score: 140.24)

The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files....

### 5. CWE-639: Authorization Bypass Through User-Controlled Key (Score: 135.53)

The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....

## WEAKNESS: 'Authorization vulnerability'

Relevant CWEs for this WEAKNESS:

### 1. CWE-697: Incorrect Comparison (Score: 165.19)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 2. CWE-1390: Weak Authentication (Score: 148.27)

The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....

### 3. CWE-287: Improper Authentication (Score: 148.12)

When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....

### 4. CWE-425: Direct Request ('Forced Browsing') (Score: 140.24)

The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files....

### 5. CWE-291: Reliance on IP Address for Authentication (Score: 121.83)

The product uses an IP address for authentication....

## WEAKNESS: 'Improper Access Control'

Relevant CWEs for this WEAKNESS:

### 1. CWE-697: Incorrect Comparison (Score: 165.19)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 2. CWE-1390: Weak Authentication (Score: 148.27)

The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....

### 3. CWE-287: Improper Authentication (Score: 148.12)

When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....

### 4. CWE-425: Direct Request ('Forced Browsing') (Score: 140.24)

The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files....

### 5. CWE-291: Reliance on IP Address for Authentication (Score: 121.83)

The product uses an IP address for authentication....

## IMPACT: 'Forceful Browsing'

Relevant CWEs for this IMPACT:

### 1. CWE-697: Incorrect Comparison (Score: 165.19)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 2. CWE-1390: Weak Authentication (Score: 148.27)

The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....

### 3. CWE-287: Improper Authentication (Score: 148.12)

When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....

### 4. CWE-425: Direct Request ('Forced Browsing') (Score: 140.24)

The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files....

### 5. CWE-308: Use of Single-factor Authentication (Score: 41.60)

The use of single-factor authentication can lead to unnecessary risk of compromise when compared with the benefits of a dual-factor authentication scheme....

## PRODUCT: 'Drupal Two-factor Authentication (TFA)'

Relevant CWEs for this PRODUCT:

### 1. CWE-697: Incorrect Comparison (Score: 165.19)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 2. CWE-1390: Weak Authentication (Score: 148.27)

The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....

### 3. CWE-287: Improper Authentication (Score: 148.12)

When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....

### 4. CWE-654: Reliance on a Single Factor in a Security Decision (Score: 57.52)

A protection mechanism relies exclusively, or to a large extent, on the evaluation of a single condition or the integrity of a single object or entity in order to make a decision about granting access to restricted resources or functionality....

### 5. CWE-308: Use of Single-factor Authentication (Score: 41.60)

The use of single-factor authentication can lead to unnecessary risk of compromise when compared with the benefits of a dual-factor authentication scheme....

## VERSION: '0.0.0 before 1.10.0'

Relevant CWEs for this VERSION:

### 1. CWE-697: Incorrect Comparison (Score: 165.19)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 2. CWE-1390: Weak Authentication (Score: 148.27)

The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....

### 3. CWE-287: Improper Authentication (Score: 148.12)

When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....

### 4. CWE-425: Direct Request ('Forced Browsing') (Score: 140.24)

The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files....

### 5. CWE-291: Reliance on IP Address for Authentication (Score: 121.83)

The product uses an IP address for authentication....


    # Analysis Instructions
    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.
    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.
    3. Provide a final determination of primary CWE(s) and any secondary CWEs.
    4. Format your response using the standard analysis template.

    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.
    