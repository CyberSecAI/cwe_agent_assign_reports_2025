## Vulnerability Description
In SonarQube before 10.4 and 9.9.4 LTA, encrypted values generated using the Settings Encryption feature are potentially exposed in cleartext as part of the URL parameters in the logs (such as SonarQube Access Logs, Proxy Logs, etc).

### Vulnerability Description Key Phrases
- **impact:** expose encrypted values generated using the Settings Encryption feature in cleartext
- **product:** SonarQube
- **version:** before 10.4 and 9.9.4 LTA

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

The vulnerability stems from the way SonarQube's settings encryption feature handles the values to be encrypted. Instead of passing these values in the request body, which is typically not logged, they are passed as URI parameters to the `/encrypt` API endpoint. This causes the values to be logged by the web server and potentially any intermediary HTTPS proxies.

**Weaknesses/Vulnerabilities Present:**

*   **Exposure of Sensitive Data in Logs:** The primary weakness is the logging of unencrypted sensitive data (the values intended for encryption) within web server logs. This completely defeats the purpose of the encryption feature itself.

**Impact of Exploitation:**

*   **Compromised Secrets:** Attackers with access to the web server logs or proxy logs can obtain the values intended to be encrypted. This can lead to a variety of security breaches depending on what secrets were exposed (e.g. database credentials, API keys etc.).
*   **Loss of Confidentiality:** The leak compromises the confidentiality of sensitive information, which is the main objective of the encryption feature.

**Attack Vectors:**

*   **Access to Web Server Logs:** An attacker who gains unauthorized access to the web server's log files can extract the sensitive information that was logged as URI parameters.
*   **Access to Proxy Logs:** If an HTTPS proxy is used, its logs might also contain the vulnerable information. Any attacker with access to these logs will be able to compromise the sensitive data.

**Required Attacker Capabilities/Position:**

*   **Access to Server Logs:** The attacker needs to be able to access the web server's log files. This could mean the attacker compromised the server, has access to a logging server, or otherwise has access to where these logs are being stored.
*   **Access to Proxy Logs:** If proxies are being used, the attacker could also be in a position to obtain and analyze those log files.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.087 |
| 2 | 598 | Use of GET Request Method With Sensitive Query Strings | Variant | Allowed | sparse | 0.077 |
| 3 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.075 |
| 4 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.074 |
| 5 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | sparse | 0.072 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.071 |
| 7 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.070 |
| 8 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.070 |
| 9 | 311 | Missing Encryption of Sensitive Data | Class | Discouraged | dense | 0.488 |
| 10 | 523 | Unprotected Transport of Credentials | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-532: Insertion of Sensitive Information into Log File

CWE-598: Use of GET Request Method With Sensitive Query Strings

CWE-256: Plaintext Storage of a Password

CWE-276: Incorrect Default Permissions

CWE-312: Cleartext Storage of Sensitive Information

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-522: Insufficiently Protected Credentials

CWE-321: Use of Hard-coded Cryptographic Key

CWE-311: Missing Encryption of Sensitive Data

CWE-523: Unprotected Transport of Credentials