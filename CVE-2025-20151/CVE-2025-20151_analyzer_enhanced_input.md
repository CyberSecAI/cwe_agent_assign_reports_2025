## Vulnerability Description
A vulnerability in the implementation of the Simple Network Management Protocol Version 3 (SNMPv3) feature of Cisco IOS Software and Cisco IOS XE Software could allow an authenticated, remote attacker to poll an affected device using SNMP, even if the device is configured to deny SNMP traffic from an unauthorized source or the SNMPv3 username is removed from the configuration. This vulnerability exists because of **the way that the SNMPv3 configuration is stored** in the Cisco IOS Software and Cisco IOS XE Software startup configuration. An attacker could exploit this vulnerability by polling an affected device from a source address that should have been denied. A successful exploit could allow the attacker to perform SNMP operations from a source that should be denied. Note The attacker has no control of the SNMPv3 configuration. To exploit this vulnerability, the attacker must have valid SNMPv3 user credentials. For more information, see the section of this advisory.

### Vulnerability Description Key Phrases
- **component:** Simple Network Management Protocol Version 3 (SNMPv3)
- **vector:** polling an affected device from a source address that should have been denied
- **weakness:** **the way that the SNMPv3 configuration is stored**
- **product:** Cisco IOS Software, Cisco IOS XE Software
- **impact:** perform SNMP operations from a source that should be denied, poll an affected device using SNMP
- **attacker:** authenticated remote attacker

## CVE Reference Links Content Summary
## Analysis of CVE-2025-20151 based on provided content:

The content is relevant to CVE-2025-20151. Here's a breakdown of the extracted information:

**Root cause of vulnerability:**

The vulnerability exists due to the way the SNMPv3 configuration is stored in the Cisco IOS Software and Cisco IOS XE Software startup configuration. Specifically, the conversion of authentication and privacy protocol strings to fixed-length octets, along with the addition of the "encrypted" keyword, can dramatically increase the configuration line length.

**Weaknesses/vulnerabilities present:**

*   Configuration truncation: If the resulting configuration line exceeds 255 characters, it may be truncated when read back into the running configuration after a device reload.
*   Missing ACL enforcement: This truncation can lead to the ACL (Access Control List) not being applied to the SNMPv3 user, effectively removing access restrictions.
*   CWE-16: Configuration

**Impact of exploitation:**

An authenticated, remote attacker can poll an affected device using SNMP, even if the device is configured to deny SNMP traffic from unauthorized sources or the SNMPv3 username is removed from the configuration. This allows the attacker to perform SNMP operations from a source that should be denied.

**Attack vectors:**

*   Remote attack via SNMP polling.
*   Requires valid SNMPv3 user credentials.

**Required attacker capabilities/position:**

*   Authenticated attacker (valid SNMPv3 credentials).
*   Ability to send SNMP polls to the affected device.

**Mitigation or fix:**

*   **Workarounds:**
    *   Move the IPv4/IPv6 ACL name to be attached to the SNMPv3 group name instead of the username.
    *   Shorten the combination of user, group, and ACL names.
*   **Fixed Software:**
    *   Upgrade to Cisco IOS XE Software releases 17.15.3 or 17.17.1 and reconfigure SNMPv3 using type 6 encryption.

**CVSS Score:**

*   Base Score: 4.3 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Additional Details (more than official CVE description):**

*   The advisory includes examples of affected and corrected configurations.
*   It details the character length increases caused by different authentication and privacy protocols.
*   It specifies that Cisco does not plan to release a fix specifically for this vulnerability but provides a configuration change as a workaround.
*   It lists related Cisco Bug IDs: CSCwi84832 and CSCwk87338.
*   It clarifies that the vulnerability does *not* affect IOS XR Software, Meraki products, or NX-OS Software.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.937 |
| 2 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.929 |
| 3 | 799 | Improper Control of Interaction Frequency | Class | Allowed-with-Review | sparse | 0.916 |
| 4 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.905 |
| 5 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.896 |
| 6 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.885 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.881 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.881 |
| 9 | 291 | Reliance on IP Address for Authentication | Variant | Allowed | dense | 0.529 |
| 10 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-522: Insufficiently Protected Credentials

CWE-20: Improper Input Validation

CWE-799: Improper Control of Interaction Frequency

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-284: Improper Access Control

CWE-532: Insertion of Sensitive Information into Log File

CWE-285: Improper Authorization

CWE-863: Incorrect Authorization

CWE-291: Reliance on IP Address for Authentication

CWE-1257: Improper Access Control Applied to Mirrored or Aliased Memory Regions