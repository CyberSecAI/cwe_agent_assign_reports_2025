{
  "method": "sparse_rootcause_1",
  "query": "In the Linux kernel, the following vulnerability has been resolvedscsi ufs core Fix deadlock during RTC updateThere is a deadlock when runtime suspend waits for the flush of RTC work,and the RTC work calls ufshcd_rpm_get_sync() to wait for runtime resume.Here is deadlock backtracekworker/01 D 4892.876354 10 10971 4859 0x4208060 0x8 10 0 120 670730152367ptr f0ffff80c2e40000 0 1 0x00000001 0x000000ff 0x000000ff 0x000000ff __switch_to+0x1a8/0x2d4 __schedule+0x684/0xa98 schedule+0x48/0xc8 schedule_timeout+0x48/0x170 do_wait_for_common+0x108/0x1b0 wait_for_completion+0x44/0x60 __flush_work+0x39c/0x424 __cancel_work_sync+0xd8/0x208 cancel_delayed_work_sync+0x14/0x28 __ufshcd_wl_suspend+0x19c/0x480 ufshcd_wl_runtime_suspend+0x3c/0x1d4 scsi_runtime_suspend+0x78/0xc8 __rpm_callback+0x94/0x3e0 rpm_suspend+0x2d4/0x65c __pm_runtime_suspend+0x80/0x114 scsi_runtime_idle+0x38/0x6c rpm_idle+0x264/0x338 __pm_runtime_idle+0x80/0x110 ufshcd_rtc_work+0x128/0x1e4 process_one_work+0x26c/0x650 worker_thread+0x260/0x3d8 kthread+0x110/0x134 ret_from_fork+0x10/0x20Skip updating RTC if RPM state is not RPM_ACTIVE.",
  "keyphrases": {
    "rootcause": "A deadlock occurs when runtime suspend waits for the flush of RTC work"
  },
  "timestamp": "2025-07-13T15:50:28.740479",
  "results_count": 10,
  "results_summary": [
    {
      "doc_id": "833",
      "name": "Deadlock",
      "score": 444.51107605165134
    },
    {
      "doc_id": "667",
      "name": "Improper Locking",
      "score": 420.63674898415934
    },
    {
      "doc_id": "337",
      "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
      "score": 358.3503674135669
    },
    {
      "doc_id": "663",
      "name": "Use of a Non-reentrant Function in a Concurrent Context",
      "score": 309.75674830751524
    },
    {
      "doc_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "score": 309.52160533691745
    }
  ]
}