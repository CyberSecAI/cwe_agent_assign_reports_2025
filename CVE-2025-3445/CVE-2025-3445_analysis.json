{
  "cve_id": "CVE-2025-3445",
  "description": "A **Path Traversal Zip Slip vulnerability** has been identified in mholt/archiver in Go. This vulnerability allows using a crafted ZIP file containing path traversal symlinks to create or overwrite files with the users privileges or application utilizing the library. When using the archiver.Unarchive functionality with ZIP files, like this archiver.Unarchive(zipFile, outputDir), A crafted ZIP file can be extracted in such a way that it writes files to the affected system with the same privileges as the application executing this vulnerable functionality. Consequently, sensitive files may be overwritten, potentially leading to privilege escalation, code execution, and other severe outcomes in some cases. Its worth noting that a similar vulnerability was found in TAR files (CVE-2024-0406). Although a fix was implemented, it hasnt been officially released, and the affected project has since been deprecated. The successor to mholt/archiver is a new project called mholt/archives, and its initial release (v0.1.0) removes the Unarchive() functionality.",
  "key_phrases": {
    "rootcause": "Path Traversal Zip Slip vulnerability",
    "weakness": "",
    "impact": [
      "privilege escalation",
      "overwrite files",
      "code execution"
    ],
    "vector": "crafted ZIP file",
    "attacker": "",
    "product": "mholt/archiver",
    "version": "",
    "component": "Unarchive functionality"
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-23 | Relative Path Traversal | 1.0 | Base | Primary CWE | Allowed |\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.7 | Base | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\n\nThe primary weakness is **CWE-23 Relative Path Traversal**, which occurs when a program does not properly neutralize sequences like \"..\" that can resolve to a location outside of a restricted directory. This can lead to the creation or overwriting of files in unintended locations. **CWE-59 Improper Link Resolution Before File Access ('Link Following')** is a closely related CWE and can occur in conjunction with path traversal vulnerabilities when the file path includes symbolic links. The attack involves crafting a ZIP archive with path traversal sequences and/or symbolic links that, when extracted, write files to arbitrary locations due to the **improper pathname limitation**.\n\n```mermaid\ngraph TD\n    cwe23[\"CWE-23: Relative Path Traversal\"]\n    cwe59[\"CWE-59: Improper Link Resolution Before File Access\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    \n    cwe23 -->|CANFOLLOW| cwe73\n    cwe59 -->|CANFOLLOW| cwe73\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe23 primary\n    class cwe59 secondary\n    class cwe73 tertiary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with a crafted ZIP file containing path traversal sequences and/or symlinks. Due to the **improper limitation of pathnames**, the archive extraction process writes files to locations outside the intended directory. This leads to the potential for sensitive file overwrite, privilege escalation, and ultimately, code execution.\n\nCrafted ZIP File -> **CWE-23: Relative Path Traversal** or **CWE-59: Improper Link Resolution Before File Access** -> File Overwrite -> Privilege Escalation/Code Execution\n\n## Summary of Analysis\n\nThe primary CWE is **CWE-23 Relative Path Traversal**, because the **root cause** of the vulnerability lies in the **improper handling of pathnames** within the ZIP archive, which allows an attacker to write files to arbitrary locations. The vulnerability description explicitly mentions a \"Path Traversal Zip Slip vulnerability,\" which strongly supports this classification. The evidence is high, with the vulnerability description clearly outlining the **root cause** and potential impact.\n\nThe selection of **CWE-23** as the primary CWE is at the optimal level of specificity because it directly addresses the vulnerability's root cause and is a Base level CWE. While **CWE-59** is also a valid concern given the potential for symbolic links in the attack, the core issue is the path traversal.\n\nRelevant CWE Information:\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-59: Improper Link Resolution Before File Access ('Link Following')\n**Abstraction Level**: Base\n**Similarity Score**: 0.79\n**Source**: dense\n\n**Description**:\nThe product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-23: Relative Path Traversal\n**Abstraction Level**: Base\n**Similarity Score**: 0.77\n**Source**: dense\n\n**Description**:\nThe product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as \"..\" that can resolve to a location that is outside of that directory.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
  "analysis_with_relationships": "# Summary\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-23 | Relative Path Traversal | 1.0 | Base | Primary CWE | Allowed |\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.7 | Base | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\n\nThe primary weakness is **CWE-23 Relative Path Traversal**, which occurs when a program does not properly neutralize sequences like \"..\" that can resolve to a location outside of a restricted directory. This can lead to the creation or overwriting of files in unintended locations. **CWE-59 Improper Link Resolution Before File Access ('Link Following')** is a closely related CWE and can occur in conjunction with path traversal vulnerabilities when the file path includes symbolic links. The attack involves crafting a ZIP archive with path traversal sequences and/or symbolic links that, when extracted, write files to arbitrary locations due to the **improper pathname limitation**.\n\n```mermaid\ngraph TD\n    cwe23[\"CWE-23: Relative Path Traversal\"]\n    cwe59[\"CWE-59: Improper Link Resolution Before File Access\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n    \n    cwe23 -->|CANFOLLOW| cwe73\n    cwe59 -->|CANFOLLOW| cwe73\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe23 primary\n    class cwe59 secondary\n    class cwe73 tertiary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with a crafted ZIP file containing path traversal sequences and/or symlinks. Due to the **improper limitation of pathnames**, the archive extraction process writes files to locations outside the intended directory. This leads to the potential for sensitive file overwrite, privilege escalation, and ultimately, code execution.\n\nCrafted ZIP File -> **CWE-23: Relative Path Traversal** or **CWE-59: Improper Link Resolution Before File Access** -> File Overwrite -> Privilege Escalation/Code Execution\n\n## Summary of Analysis\n\nThe primary CWE is **CWE-23 Relative Path Traversal**, because the **root cause** of the vulnerability lies in the **improper handling of pathnames** within the ZIP archive, which allows an attacker to write files to arbitrary locations. The vulnerability description explicitly mentions a \"Path Traversal Zip Slip vulnerability,\" which strongly supports this classification. The evidence is high, with the vulnerability description clearly outlining the **root cause** and potential impact.\n\nThe selection of **CWE-23** as the primary CWE is at the optimal level of specificity because it directly addresses the vulnerability's root cause and is a Base level CWE. While **CWE-59** is also a valid concern given the potential for symbolic links in the attack, the core issue is the path traversal.\n\nRelevant CWE Information:\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-59: Improper Link Resolution Before File Access ('Link Following')\n**Abstraction Level**: Base\n**Similarity Score**: 0.79\n**Source**: dense\n\n**Description**:\nThe product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-23: Relative Path Traversal\n**Abstraction Level**: Base\n**Similarity Score**: 0.77\n**Source**: dense\n\n**Description**:\nThe product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as \"..\" that can resolve to a location that is outside of that directory.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-59:**\n- 59 (Improper Link Resolution Before File Access ('Link Following')) - ROOT\n\n\n**Chain starting from CWE-73:**\n- 73 (External Control of File Name or Path) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Path traversal",
        "match_reason": "term_in_phrase_whole_phrase"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Zip Slip",
        "match_reason": "term_in_phrase_whole_phrase"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "59",
        "name": "Improper Link Resolution Before File Access ('Link Following')",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Zip Slip",
        "match_reason": "term_in_phrase_whole_phrase"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "source": "sparse"
      },
      "similarity": 812.5061960884616
    },
    {
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "source": "sparse"
      },
      "similarity": 762.5908552900717
    },
    {
      "metadata": {
        "doc_id": "409",
        "name": "Improper Handling of Highly Compressed Data (Data Amplification)",
        "source": "sparse"
      },
      "similarity": 749.6844809412418
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 742.3996393473567
    },
    {
      "metadata": {
        "doc_id": "552",
        "name": "Files or Directories Accessible to External Parties",
        "source": "sparse"
      },
      "similarity": 727.2317664933797
    },
    {
      "metadata": {
        "doc_id": "24",
        "name": "Path Traversal: '../filedir'",
        "type": "Variant",
        "original_content": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize \"../\" sequences that can resolve to a location that is outside of that directory.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5361779702130658,
            "graph": 1.5261004551953925
          }
        }
      },
      "similarity": 0.5361779702130658
    },
    {
      "doc_id": "363",
      "text": "CWE-363: Race Condition Enabling Link Following",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "363",
        "name": "Race Condition Enabling Link Following",
        "type": "base",
        "original_content": "CWE-363: Race Condition Enabling Link Following",
        "relationships": [
          {
            "source_id": "363",
            "target_id": "59",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "363",
            "target_id": "367",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "59",
            "target_id": "363",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "367",
            "target_id": "363",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "59",
                  "363",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "59"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "59",
                  "363",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "59"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "363",
                  "59",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "59"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-59",
      "CWE-73",
      "CWE-23"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}