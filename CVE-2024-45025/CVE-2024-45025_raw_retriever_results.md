# Raw Retriever Results for CVE-2024-45025

# Raw Retriever Results for CVE-2024-45025
## Query
In the Linux kernel, the following vulnerability has been resolved fix bitmap corruption on close_range() with CLOSE_RANGE_UNSHARE copy_fd_bitmaps(new, old, count) is expected to copy the first count/BITS_PER_LONG bits from old->full_fds_bits[] and fill the rest with zeroes. What it does is copying enough words (BITS_TO_LONGS(count/BITS_PER_LONG)), then memsets the rest. That works fine, *if* all bits past the cutoff point are clear. Otherwise we are risking garbage from the last word wed copied. For most of the callers that is true - expand_fdtable() has count equal to old->max_fds, so theres no open descriptors past count, let alone fully occupied words in ->open_fds[], which is what bits in ->full_fds_bits[] correspond to. The other caller (dup_fd()) passes sane_fdtable_size(old_fdt, max_fds), which is the smallest multiple of BITS_PER_LONG that covers all opened descriptors below max_fds. In the common case (copying on fork()) max_fds is ~0U, so all opened descriptors will be below it and we are fine, by the same reasons why the call in expand_fdtable() is safe. Unfortunately, there is a case where max_fds is less than that and where we might, indeed, end up with junk in ->full_fds_bits[] - close_range(from, to, CLOSE_RANGE_UNSHARE) with * descriptor table being currently shared * to being above the current capacity of descriptor table * from being just under some chunk of opened descriptors. In that case we end up with observably wrong behaviour - e.g. spa

## Keyphrases
- **weakness**: 'bitmap corruption'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4465 | 0.5052 | 0.4635 | 0.4609 | 20 |
| Sparse | 866.7659 | 936.5006 | 893.6441 | 885.8413 | 10 |
| Graph | 1.6744 | 2.9286 | 1.9727 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.9286 | Allowed |
| 2 | 190 | Integer Overflow or Wraparound | Base | 2.4864 | Allowed |
| 3 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 4 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 5 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 6 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 7 | 911 | Improper Update of Reference Count | Base | 2.0524 | Allowed |
| 8 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 1.9350 | Allowed |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 11 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 12 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 13 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 14 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | base | 1.6848 | Allowed |
| 15 | 562 | Return of Stack Variable Address | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.5052 | 0.5052 | Allowed |
| 2 | 911 | Improper Update of Reference Count | Base | 0.4849 | 0.4849 | Allowed |
| 3 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4812 | 0.4812 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4807 | 0.4807 | Allowed-with-Review |
| 5 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.4762 | 0.4762 | Allowed |
| 6 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4739 | 0.4739 | Allowed |
| 7 | 667 | Improper Locking | Class | 0.4715 | 0.4715 | Allowed-with-Review |
| 8 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4704 | 0.4704 | Allowed |
| 9 | 190 | Integer Overflow or Wraparound | Base | 0.4675 | 0.4675 | Allowed |
| 10 | 689 | Permission Race Condition During Resource Copy | Compound | 0.4673 | 0.4673 | Allowed |
| 11 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4544 | 0.4544 | Allowed |
| 12 | 126 | Buffer Over-read | Variant | 0.4521 | 0.4521 | Allowed |
| 13 | 1335 | Incorrect Bitwise Shift of Integer | Base | 0.4504 | 0.4504 | Allowed |
| 14 | 127 | Buffer Under-read | Variant | 0.4497 | 0.4497 | Allowed |
| 15 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4489 | 0.4489 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | 936.5006 | 936.5006 | Allowed |
| 2 | 911 | Improper Update of Reference Count | 923.6587 | 923.6587 | Allowed |
| 3 | 190 | Integer Overflow or Wraparound | 912.2916 | 912.2916 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 908.0405 | 908.0405 | Allowed-with-Review |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 894.8994 | 894.8994 | Allowed |
| 6 | 787 | Out-of-bounds Write | 876.7831 | 876.7831 | Allowed |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | 874.2368 | 874.2368 | Allowed |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | 873.9165 | 873.9165 | Allowed |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 869.3474 | 869.3474 | Allowed |
| 10 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 866.7659 | 866.7659 | Allowed |
