# Vulnerability Information: CVE-2024-5611

## Vulnerability Description
The Stratum - Elementor Widgets plugin for WordPress is vulnerable to **Stored Cross-Site Scripting** via the label_years attribute within the Countdown widget in all versions up to, and including, 1.4.1 due to **insufficient input sanitization and output escaping**. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping**
- **weakness:** **Stored Cross-Site Scripting**
- **impact:** inject arbitrary web scripts
- **attacker:** authenticated attackers
- **product:** Stratum - Elementor Widgets plugin for WordPress
- **version:** all versions up to and including 1.4.1
- **component:** Countdown widget

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**CVE ID:** CVE-2024-5611

**Root Cause of Vulnerability:**
- The vulnerability stems from insufficient input sanitization and output escaping within the 'Stratum – Elementor Widgets' plugin's Countdown widget. Specifically, the `label_years` attribute is vulnerable to stored XSS.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize user-supplied input for the `label_years` attribute in the Countdown widget before rendering it on the page. This allows an attacker to inject malicious JavaScript code.

**Impact of Exploitation:**
- **Arbitrary Script Execution:** An attacker can inject malicious JavaScript code into a page that utilizes the vulnerable Countdown widget. This injected script will execute within the browsers of users who visit the page, potentially leading to:
    - **Session Hijacking:** Stealing user session cookies, allowing the attacker to impersonate the victim.
    - **Malware Distribution:** Redirecting users to malicious websites or downloading malware onto their systems.
    - **Defacement:** Altering the content of the page, causing it to display malicious or misleading information.
    - **Phishing:** Displaying fake login forms or other interfaces that trick users into providing sensitive information.
- **Privilege Escalation**: Although not explicitly stated, the ability to execute arbitrary JavaScript opens avenues for privilege escalation if combined with other vulnerabilities or weak security practices.

**Attack Vectors:**
- **Plugin Configuration:** The attacker injects malicious JavaScript through the `label_years` field of the Countdown widget when configuring it via Elementor page builder.
- **Web Page Rendering:** When a user loads a page with the configured countdown widget the injected malicious script is executed.

**Required Attacker Capabilities/Position:**
- **Authenticated Access:** The attacker needs to have at least "Contributor"-level access to the WordPress site.
- **Elementor Page Builder Access:** The attacker needs to have access to Elementor page builder to be able to create/edit content.
- **Knowledge of plugin vulnerability:** The attacker needs to know the affected plugin and the vulnerable attribute (`label_years`)

**Additional Details:**

*   The vulnerability affects all versions of the "Stratum – Elementor Widgets" plugin up to and including version 1.4.1.
*   The vulnerability was patched in version 1.4.2. The patch included sanitization of the `label_years` attribute using `esc_html()` and `wp_kses_post()`.

**Summary:**

The Stratum Elementor Widgets plugin had a stored XSS vulnerability in its countdown widget that allowed attackers with at least Contributor access to inject malicious JavaScript code via the label_years attribute and execute it within the browsers of users who visit the page, potentially leading to various attacks such as session hijacking, malware distribution, and phishing. The vulnerability was fixed in version 1.4.2 by sanitizing the input before rendering it on the page.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.519 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.502 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.479 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.468 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.404 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.390 |
| 7 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.383 |
| 8 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.381 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.496 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

