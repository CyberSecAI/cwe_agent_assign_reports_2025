# Raw Retriever Results for CVE-2024-44935

# Raw Retriever Results for CVE-2024-44935
## Query
In the Linux kernel, the following vulnerability has been resolved sctp Fix null-ptr-deref in reuseport_add_sock(). syzbot reported a null-ptr-deref while accessing sk2->sk_reuseport_cb in reuseport_add_sock(). [0] The repro first creates a listener with SO_REUSEPORT. Then, it creates another listener on the same port and concurrently closes the first listener. The second listen() calls reuseport_add_sock() with the first listener as sk2, where sk2->sk_reuseport_cb is not expected to be cleared concurrently, but the close() does clear it by reuseport_detach_sock(). The problem is SCTP does not properly synchronise reuseport_alloc(), reuseport_add_sock(), and reuseport_detach_sock(). The caller of reuseport_alloc() and reuseport_{add,detach}_sock() must provide synchronisation for sockets that are classified into the same reuseport group. Otherwise, such sockets form multiple identical reuseport groups, and all groups except one would be silently dead. 1. Two sockets call listen() concurrently 2. No socket in the same group found in sctp_ep_hashtable[] 3. Two sockets call reuseport_alloc() and form two reuseport groups 4. Only one group hit first in __sctp_rcv_lookup_endpoint() receives incoming packets Also, the reported null-ptr-deref could occur. TCP/UDP guarantees that would not happen by holding the hash bucket lock. Lets apply the locking strategy to __sctp_hash_endpoint() and __sctp_unhash_endpoint(). [0] Oops general protection fault, pr

## Keyphrases
- **rootcause**: 'improper synchronisation'
- **weakness**: 'null-ptr-deref'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5283 | 0.5942 | 0.5494 | 0.5458 | 20 |
| Sparse | 694.6988 | 817.1274 | 759.2532 | 756.1562 | 11 |
| Graph | 1.4468 | 2.8414 | 1.7934 | 1.6960 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | Base | 2.8414 | Allowed |
| 2 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 3 | 252 | Unchecked Return Value | base | 2.2100 | Allowed |
| 4 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 5 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7690 | Allowed-with-Review |
| 7 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 9 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 10 | 833 | Deadlock | Base | 1.7073 | Allowed |
| 11 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 12 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 13 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 14 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |
| 15 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 476 | NULL Pointer Dereference | Base | 0.5942 | 0.5942 | Allowed |
| 2 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5817 | 0.5817 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5801 | 0.5801 | Allowed-with-Review |
| 4 | 667 | Improper Locking | Class | 0.5656 | 0.5656 | Allowed-with-Review |
| 5 | 909 | Missing Initialization of Resource | Class | 0.5645 | 0.5645 | Allowed-with-Review |
| 6 | 911 | Improper Update of Reference Count | Base | 0.5585 | 0.5585 | Allowed |
| 7 | 605 | Multiple Binds to the Same Port | Variant | 0.5576 | 0.5576 | Allowed |
| 8 | 366 | Race Condition within a Thread | Base | 0.5546 | 0.5546 | Allowed |
| 9 | 822 | Untrusted Pointer Dereference | Base | 0.5545 | 0.5545 | Allowed |
| 10 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5536 | 0.5536 | Allowed |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5380 | 0.5380 | Allowed |
| 12 | 416 | Use After Free | Variant | 0.5351 | 0.5351 | Allowed |
| 13 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5348 | 0.5348 | Allowed |
| 14 | 193 | Off-by-one Error | Base | 0.5341 | 0.5341 | Allowed |
| 15 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5339 | 0.5339 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 817.1274 | 817.1274 | Allowed-with-Review |
| 2 | 476 | NULL Pointer Dereference | 806.7371 | 806.7371 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 768.8902 | 768.8902 | Allowed-with-Review |
| 4 | 667 | Improper Locking | 767.5995 | 767.5995 | Allowed-with-Review |
| 5 | 833 | Deadlock | 761.2737 | 761.2737 | Allowed |
| 6 | 1390 | Weak Authentication | 756.1562 | 756.1562 | Allowed-with-Review |
| 7 | 287 | Improper Authentication | 745.7945 | 745.7945 | Discouraged |
| 8 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 745.0528 | 745.0528 | Allowed-with-Review |
| 9 | 347 | Improper Verification of Cryptographic Signature | 744.3335 | 744.3335 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | 744.1209 | 744.1209 | Allowed |
| 11 | 131 | Incorrect Calculation of Buffer Size | 694.6988 | 694.6988 | Allowed |
