{
  "method": "sparse_combined",
  "query": "In the Linux kernel, the following vulnerability has been resolved ext4 do not create EA inode under buffer lock ext4_xattr_set_entry() creates new EA inodes while holding buffer lock on the external xattr block. This is problematic as it nests all the allocation locking (which acquires locks on other buffers) under the buffer lock. This can even deadlock when the filesystem is corrupted and e.g. quota file is setup to contain xattr block as data block. Move the allocation of EA inode out of ext4_xattr_set_entry() into the callers.",
  "keyphrases": {
    "rootcause": [
      "ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    ],
    "weakness": [
      "improper locking"
    ]
  },
  "timestamp": "2025-07-12T03:20:13.662135",
  "results_count": 12,
  "results_summary": [
    {
      "doc_id": "667",
      "name": "Improper Locking",
      "score": 472.48185086907944
    },
    {
      "doc_id": "833",
      "name": "Deadlock",
      "score": 466.0523050238247
    },
    {
      "doc_id": "190",
      "name": "Integer Overflow or Wraparound",
      "score": 438.86464296761005
    },
    {
      "doc_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 437.7455467850747
    },
    {
      "doc_id": "664",
      "name": "Improper Control of a Resource Through its Lifetime",
      "score": 424.7354746395329
    }
  ]
}