{
  "retriever": "dense",
  "query": "In the Linux kernel, the following vulnerability has been resolved ext4 do not create EA inode under buffer lock ext4_xattr_set_entry() creates new EA inodes while holding buffer lock on the external xattr block. This is problematic as it nests all the allocation locking (which acquires locks on other buffers) under the buffer lock. This can even deadlock when the filesystem is corrupted and e.g. quota file is setup to contain xattr block as data block. Move the allocation of EA inode out of ext4_xattr_set_entry() into the callers.",
  "keyphrases": {
    "rootcause": [
      "ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    ],
    "weakness": [
      "improper locking"
    ]
  },
  "timestamp": "2025-07-12 03:20:13",
  "cve_id": "CVE-2024-40972",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "type": "Base",
      "score": 0.5108974246541294
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "type": "Class",
      "score": 0.5032863799809941
    },
    {
      "cwe_id": "412",
      "name": "Unrestricted Externally Accessible Lock",
      "type": "Base",
      "score": 0.4902374432126033
    },
    {
      "cwe_id": "403",
      "name": "Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak')",
      "type": "Base",
      "score": 0.48689088730774865
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "type": "Base",
      "score": 0.48213558789580535
    },
    {
      "cwe_id": "832",
      "name": "Unlock of a Resource that is not Locked",
      "type": "Base",
      "score": 0.4803591732232484
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "type": "Class",
      "score": 0.46993065718616694
    },
    {
      "cwe_id": "591",
      "name": "Sensitive Data Storage in Improperly Locked Memory",
      "type": "Variant",
      "score": 0.46715849265134546
    },
    {
      "cwe_id": "708",
      "name": "Incorrect Ownership Assignment",
      "type": "Base",
      "score": 0.4622645074242421
    },
    {
      "cwe_id": "1260",
      "name": "Improper Handling of Overlap Between Protected Memory Ranges",
      "type": "Base",
      "score": 0.46031443022133745
    },
    {
      "cwe_id": "1421",
      "name": "Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution",
      "type": "Base",
      "score": 0.4429893371472321
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "type": "Class",
      "score": 0.4416590437695256
    },
    {
      "cwe_id": "774",
      "name": "Allocation of File Descriptors or Handles Without Limits or Throttling",
      "type": "Variant",
      "score": 0.4399227479329732
    },
    {
      "cwe_id": "775",
      "name": "Missing Release of File Descriptor or Handle after Effective Lifetime",
      "type": "Variant",
      "score": 0.43529646378605075
    },
    {
      "cwe_id": "764",
      "name": "Multiple Locks of a Critical Resource",
      "type": "Base",
      "score": 0.4341965022126528
    },
    {
      "cwe_id": "765",
      "name": "Multiple Unlocks of a Critical Resource",
      "type": "Base",
      "score": 0.43347137221178
    },
    {
      "cwe_id": "689",
      "name": "Permission Race Condition During Resource Copy",
      "type": "Compound",
      "score": 0.4322347796799245
    },
    {
      "cwe_id": "190",
      "name": "Integer Overflow or Wraparound",
      "type": "Base",
      "score": 0.43210103015351153
    },
    {
      "cwe_id": "1244",
      "name": "Internal Asset Exposed to Unsafe Debug Access Level or State",
      "type": "Base",
      "score": 0.43050453960329094
    },
    {
      "cwe_id": "805",
      "name": "Buffer Access with Incorrect Length Value",
      "type": "Base",
      "score": 0.430115192131304
    }
  ]
}