{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved ext4 do not create EA inode under buffer lock ext4_xattr_set_entry() creates new EA inodes while holding buffer lock on the external xattr block. This is problematic as it nests all the allocation locking (which acquires locks on other buffers) under the buffer lock. This can even deadlock when the filesystem is corrupted and e.g. quota file is setup to contain xattr block as data block. Move the allocation of EA inode out of ext4_xattr_set_entry() into the callers.",
  "keyphrases": {
    "rootcause": [
      "ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    ],
    "weakness": [
      "improper locking"
    ]
  },
  "timestamp": "2025-07-13 12:45:07",
  "cve_id": "CVE-2024-40972",
  "result_count": 12,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 472.48185086907944,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 466.0523050238247,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "190",
      "name": "Integer Overflow or Wraparound",
      "score": 438.86464296761005,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 437.7455467850747,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "664",
      "name": "Improper Control of a Resource Through its Lifetime",
      "score": 424.7354746395329,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "197",
      "name": "Numeric Truncation Error",
      "score": 424.3278724437762,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "775",
      "name": "Missing Release of File Descriptor or Handle after Effective Lifetime",
      "score": 420.9805007061309,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 414.5554309283496,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "score": 413.9993446542848,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 413.05898584698934,
      "search_source": "rootcause:ext4_xattr_set_entry() creates new EA inodes while holding buffer lock"
    },
    {
      "cwe_id": "789",
      "name": "Memory Allocation with Excessive Size Value",
      "score": 369.76813949117053,
      "search_source": "weakness:improper locking"
    },
    {
      "cwe_id": "226",
      "name": "Sensitive Information in Resource Not Removed Before Reuse",
      "score": 369.7302624428152,
      "search_source": "weakness:improper locking"
    }
  ]
}