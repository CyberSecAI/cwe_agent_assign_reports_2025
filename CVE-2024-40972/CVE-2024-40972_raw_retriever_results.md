# Raw Retriever Results for CVE-2024-40972

# Raw Retriever Results for CVE-2024-40972
## Query
In the Linux kernel, the following vulnerability has been resolved ext4 do not create EA inode under buffer lock ext4_xattr_set_entry() creates new EA inodes while holding buffer lock on the external xattr block. This is problematic as it nests all the allocation locking (which acquires locks on other buffers) under the buffer lock. This can even deadlock when the filesystem is corrupted and e.g. quota file is setup to contain xattr block as data block. Move the allocation of EA inode out of ext4_xattr_set_entry() into the callers.

## Keyphrases
- **rootcause**: 'ext4_xattr_set_entry() creates new EA inodes while holding buffer lock'
- **weakness**: 'improper locking'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4301 | 0.5109 | 0.4583 | 0.4517 | 20 |
| Sparse | 369.7303 | 472.4819 | 422.1917 | 422.6542 | 12 |
| Graph | 1.4808 | 3.0654 | 1.9613 | 1.6949 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | base | 3.0654 | Allowed |
| 2 | 190 | Integer Overflow or Wraparound | base | 2.8210 | Allowed |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 2.2922 | Allowed |
| 4 | 41 | Improper Resolution of Path Equivalence | base | 2.2922 | Allowed |
| 5 | 128 | Wrap-around Error | base | 2.2698 | Allowed |
| 6 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2698 | Allowed |
| 7 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | base | 2.2090 | Allowed |
| 8 | 410 | Insufficient Resource Pool | base | 2.1762 | Allowed |
| 9 | 73 | External Control of File Name or Path | base | 1.8252 | Allowed |
| 10 | 412 | Unrestricted Externally Accessible Lock | Base | 1.6954 | Allowed |
| 11 | 413 | Improper Resource Locking | Base | 1.6944 | Allowed |
| 12 | 833 | Deadlock | Base | 1.6863 | Allowed |
| 13 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 14 | 193 | Off-by-one Error | base | 1.6848 | Allowed |
| 15 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 413 | Improper Resource Locking | Base | 0.5109 | 0.5109 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.5033 | 0.5033 | Allowed-with-Review |
| 3 | 412 | Unrestricted Externally Accessible Lock | Base | 0.4902 | 0.4902 | Allowed |
| 4 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.4869 | 0.4869 | Allowed |
| 5 | 833 | Deadlock | Base | 0.4821 | 0.4821 | Allowed |
| 6 | 832 | Unlock of a Resource that is not Locked | Base | 0.4804 | 0.4804 | Allowed |
| 7 | 909 | Missing Initialization of Resource | Class | 0.4699 | 0.4699 | Allowed-with-Review |
| 8 | 591 | Sensitive Data Storage in Improperly Locked Memory | Variant | 0.4672 | 0.4672 | Allowed |
| 9 | 708 | Incorrect Ownership Assignment | Base | 0.4623 | 0.4623 | Allowed |
| 10 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4603 | 0.4603 | Allowed |
| 11 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4430 | 0.4430 | Allowed |
| 12 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4417 | 0.4417 | Allowed-with-Review |
| 13 | 774 | Allocation of File Descriptors or Handles Without Limits or Throttling | Variant | 0.4399 | 0.4399 | Allowed |
| 14 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4353 | 0.4353 | Allowed |
| 15 | 764 | Multiple Locks of a Critical Resource | Base | 0.4342 | 0.4342 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 472.4819 | 472.4819 | Allowed-with-Review |
| 2 | 833 | Deadlock | 466.0523 | 466.0523 | Allowed |
| 3 | 190 | Integer Overflow or Wraparound | 438.8646 | 438.8646 | Allowed |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | 437.7455 | 437.7455 | Allowed |
| 5 | 664 | Improper Control of a Resource Through its Lifetime | 424.7355 | 424.7355 | Discouraged |
| 6 | 197 | Numeric Truncation Error | 424.3279 | 424.3279 | Allowed |
| 7 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | 420.9805 | 420.9805 | Allowed |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | 414.5554 | 414.5554 | Allowed |
| 9 | 125 | Out-of-bounds Read | 413.9993 | 413.9993 | Allowed |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 413.0590 | 413.0590 | Allowed-with-Review |
| 11 | 789 | Memory Allocation with Excessive Size Value | 369.7681 | 369.7681 | Allowed |
| 12 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 369.7303 | 369.7303 | Allowed |
