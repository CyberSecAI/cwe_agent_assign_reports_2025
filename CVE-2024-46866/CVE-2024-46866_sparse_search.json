{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved drm/xe/client add missing bo locking in show_meminfo() bo_meminfo() wants to inspect bo state like tt and the ttm resource, however this state can change at any point leading to stuff like NPD and UAF, if the bo lock is not held. Grab the bo lock when calling bo_meminfo(), ensuring we drop any spinlocks first. In the case of object_idr we now also need to hold a ref. v2 (MattB) - Also add xe_bo_assert_held() (cherry picked from commit 4f63d712fa104c3ebefcb289d1e733e86d8698c7)",
  "keyphrases": {
    "rootcause": [
      "missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    ]
  },
  "timestamp": "2025-07-12 04:47:21",
  "cve_id": "CVE-2024-46866",
  "result_count": 13,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 485.00262087190106,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 459.01928931851864,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "764",
      "name": "Multiple Locks of a Critical Resource",
      "score": 440.71140358944393,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "476",
      "name": "NULL Pointer Dereference",
      "score": 419.97966146009105,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "score": 416.9507422741591,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 404.81372260347536,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 403.74185178928434,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "212",
      "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
      "score": 398.7739362310671,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 396.7435090895408,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "306",
      "name": "Missing Authentication for Critical Function",
      "score": 391.9247254290321,
      "search_source": "rootcause:missing bo locking in show_meminfo() bo_meminfo() ... if the bo lock is not held"
    },
    {
      "cwe_id": "617",
      "name": "Reachable Assertion",
      "score": 114.22561131696465,
      "search_source": "base_query"
    },
    {
      "cwe_id": "610",
      "name": "Externally Controlled Reference to a Resource in Another Sphere",
      "score": 113.33791481036639,
      "search_source": "base_query"
    },
    {
      "cwe_id": "663",
      "name": "Use of a Non-reentrant Function in a Concurrent Context",
      "score": 113.14966715940784,
      "search_source": "base_query"
    }
  ]
}