{
  "cve_id": "CVE-2024-41108",
  "description": "FOG is a free open-source cloning/imaging/rescue suite/inventory management system. The hostinfo page has **missing/improper access control** since only the hosts mac address is required to obtain the configuration information. This data can only be retrieved if a task is pending on that host. Otherwise, an error message containing Invalid tasking! will be returned. The domainpassword in the hostinfo dump is hidden even to authenticated users, as it is displayed as a row of asterisks when navigating to the hosts Active Directory settings. This vulnerability is fixed in 1.5.10.41.",
  "key_phrases": {
    "rootcause": "missing/improper access control",
    "weakness": "",
    "impact": "obtain configuration information",
    "vector": "hosts mac address",
    "attacker": "",
    "product": "FOG",
    "version": "before 1.5.10.41",
    "component": "hostinfo page"
  },
  "reference_content": "Based on the provided information, this content is related to CVE-2024-41108.\n\n**Root cause of vulnerability:**\nThe vulnerability stems from missing or improper access control in the `hostinfo.php` and `hostname.php` pages. These pages expose sensitive host configuration information when a task is pending for the host and the attacker has the MAC address.\n\n**Weaknesses/vulnerabilities present:**\n- **Missing Access Control:** The `hostinfo.php` and `hostname.php` scripts do not properly validate the requestor. They allow access to host configuration data (including AD credentials) based solely on the host's MAC address being provided in the request and a pending task for the host.\n- **Information Disclosure:** Sensitive information is exposed, such as Active Directory credentials, hostname, IP, and other host-related configurations.\n- **Lack of Authentication:** The vulnerable scripts do not require authentication to access sensitive information.\n\n**Impact of exploitation:**\n- **Confidentiality Breach:** Attackers can obtain sensitive information such as Active Directory domain credentials, host configurations, and other inventory data.\n- **Lateral Movement:** The compromised AD credentials could be used to gain access to other systems within the network.\n- **Data Loss:** Attackers could potentially use the compromised information to manipulate the host configurations.\n\n**Attack vectors:**\n- **Network Access:** An attacker with network access to the FOGProject web interface can exploit this vulnerability.\n- **HTTP Requests:** Attackers can use standard HTTP requests to access the vulnerable pages.\n- **MAC Address:** The only requirement is the knowledge of a target host's MAC address and a pending task for the host.\n\n**Required attacker capabilities/position:**\n- The attacker needs network access to the FOGProject web interface.\n- The attacker needs to obtain the MAC address of a host that has a pending task.\n- The attacker does not require any authentication.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-862 | Missing Authorization | 1.0 | Base | Primary CWE | Allowed |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.7 | Class | Secondary Candidate | Discouraged |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-862, which is a Base level CWE and a child of the Class level CWE-285 (Improper Authorization). The vulnerability description clearly indicates a **missing authorization** check, making CWE-862 a more precise fit than its parent. CWE-306 (Missing Authentication) was considered but deemed less suitable since the vulnerability focuses on authorization after a potential (though not enforced) authentication. CWE-200 (Exposure of Sensitive Information) is related as it describes the impact of the missing authorization, but is a class level CWE and also less precise than CWE-862.\n\n```mermaid\ngraph TD\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n\n    cwe862 -->|CHILDOF| cwe285\n    cwe862 -->|CAN_RESULT_IN| cwe200\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe862 primary\n    class cwe200,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing authorization** check (CWE-862) on the `hostinfo.php` page. This leads to the exposure of sensitive information (CWE-200), such as Active Directory credentials, when an attacker provides a valid MAC address for a host with a pending task. The initial flaw is the **lack of proper access control**, which directly leads to the information disclosure.\n\n## Summary of Analysis\nThe primary CWE assignment is based on the clear evidence of a **missing authorization** check. The vulnerability description states that the `hostinfo.php` page allows access to sensitive host configuration data based solely on the host's MAC address and a pending task, without properly validating the requestor.\n\nThe evidence supporting this includes:\n*   \"The hostinfo page has **missing/improper access control** since only the hosts mac address is required to obtain the configuration information.\"\n*   \"The vulnerability stems from missing or **improper access control** in the `hostinfo.php` and `hostname.php` pages.\"\n*   \"These pages expose sensitive host configuration information when a task is pending for the host and the attacker has the MAC address.\"\n*   \"**Missing Access Control:** The `hostinfo.php` and `hostname.php` scripts do not properly validate the requestor.\"\n\nThe retriever results also listed CWE-863 (Incorrect Authorization), CWE-306 (Missing Authentication), CWE-201 (Insertion of Sensitive Information Into Sent Data), CWE-639 (Authorization Bypass Through User-Controlled Key), CWE-209 (Generation of Error Message Containing Sensitive Information), and CWE-285 (Improper Authorization). Of these, CWE-306 was considered since the description mentions a **lack of authentication**. However, since the primary issue is that a MAC address alone is sufficient to retrieve sensitive information for a host with a pending task, the issue is more accurately described as a **missing authorization** check *after* a potential, but not enforced, authentication.\n\nCWE-200 is a reasonable secondary mapping, as it is a direct result of the **missing authorization**. However, it represents the impact, not the root cause.\n\nCWE-862 is the most specific and appropriate CWE for this vulnerability. It aligns perfectly with the **missing authorization** identified in the vulnerability description and the CVE reference content summary. The CWE is at the Base level of abstraction, which is preferred.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-862 | Missing Authorization | 1.0 | Base | Primary CWE | Allowed |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.7 | Class | Secondary Candidate | Discouraged |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-862, which is a Base level CWE and a child of the Class level CWE-285 (Improper Authorization). The vulnerability description clearly indicates a **missing authorization** check, making CWE-862 a more precise fit than its parent. CWE-306 (Missing Authentication) was considered but deemed less suitable since the vulnerability focuses on authorization after a potential (though not enforced) authentication. CWE-200 (Exposure of Sensitive Information) is related as it describes the impact of the missing authorization, but is a class level CWE and also less precise than CWE-862.\n\n```mermaid\ngraph TD\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n\n    cwe862 -->|CHILDOF| cwe285\n    cwe862 -->|CAN_RESULT_IN| cwe200\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe862 primary\n    class cwe200,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing authorization** check (CWE-862) on the `hostinfo.php` page. This leads to the exposure of sensitive information (CWE-200), such as Active Directory credentials, when an attacker provides a valid MAC address for a host with a pending task. The initial flaw is the **lack of proper access control**, which directly leads to the information disclosure.\n\n## Summary of Analysis\nThe primary CWE assignment is based on the clear evidence of a **missing authorization** check. The vulnerability description states that the `hostinfo.php` page allows access to sensitive host configuration data based solely on the host's MAC address and a pending task, without properly validating the requestor.\n\nThe evidence supporting this includes:\n*   \"The hostinfo page has **missing/improper access control** since only the hosts mac address is required to obtain the configuration information.\"\n*   \"The vulnerability stems from missing or **improper access control** in the `hostinfo.php` and `hostname.php` pages.\"\n*   \"These pages expose sensitive host configuration information when a task is pending for the host and the attacker has the MAC address.\"\n*   \"**Missing Access Control:** The `hostinfo.php` and `hostname.php` scripts do not properly validate the requestor.\"\n\nThe retriever results also listed CWE-863 (Incorrect Authorization), CWE-306 (Missing Authentication), CWE-201 (Insertion of Sensitive Information Into Sent Data), CWE-639 (Authorization Bypass Through User-Controlled Key), CWE-209 (Generation of Error Message Containing Sensitive Information), and CWE-285 (Improper Authorization). Of these, CWE-306 was considered since the description mentions a **lack of authentication**. However, since the primary issue is that a MAC address alone is sufficient to retrieve sensitive information for a host with a pending task, the issue is more accurately described as a **missing authorization** check *after* a potential, but not enforced, authentication.\n\nCWE-200 is a reasonable secondary mapping, as it is a direct result of the **missing authorization**. However, it represents the impact, not the root cause.\n\nCWE-862 is the most specific and appropriate CWE for this vulnerability. It aligns perfectly with the **missing authorization** identified in the vulnerability description and the CVE reference content summary. The CWE is at the Base level of abstraction, which is preferred.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-862:**\n- 862 (Missing Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "600",
        "name": "Uncaught Exception in Servlet ",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Missing Catch Block",
        "match_reason": "phrase_in_term_compound_part_0"
      },
      "similarity": 700.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 517.4690766113794
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 501.63280703197915
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 501.51205673240395
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 495.75436823995506
    },
    {
      "metadata": {
        "doc_id": "209",
        "name": "Generation of Error Message Containing Sensitive Information",
        "source": "sparse"
      },
      "similarity": 490.51665061179256
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 490.35594032477934
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 489.82911870672746
    },
    {
      "metadata": {
        "doc_id": "1249",
        "name": "Application-Level Admin Tool with Inconsistent View of Underlying Operating System",
        "type": "Base",
        "original_content": "The product provides an application for administrators to manage parts of the underlying operating system, but the application does not accurately identify all of the relevant entities or resources that exist in the OS; that is, the application's model of the OS's state is inconsistent with the OS's actual state.",
        "keyphrase_source": "rootcause:improper access control",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.4303535344883288,
            "graph": 1.4546948804982238
          }
        }
      },
      "similarity": 0.4303535344883288
    },
    {
      "doc_id": "226",
      "text": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "226",
        "name": "Sensitive Information in Resource Not Removed Before Reuse",
        "type": "base",
        "original_content": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
        "relationships": [
          {
            "source_id": "226",
            "target_id": "244",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1342",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1301",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1272",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1239",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "201",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "212",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "459",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "459",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "244",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "212",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "201",
            "target_id": "226",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1301",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1272",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "201"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "201"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "226",
                  "201",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "201"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-862",
      "CWE-639",
      "CWE-306",
      "CWE-201",
      "CWE-285",
      "CWE-200",
      "CWE-209"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}