# Vulnerability Information: CVE-2025-47423

## Vulnerability Description
Personal Weather Station Dashboard 12_lts allows unauthenticated remote attackers to read arbitrary files via ../ **directory traversal** in the test parameter to /others/_test.php, as demonstrated by reading the servers private SSL key in cleartext.

### Vulnerability Description Key Phrases
- **weakness:** **directory traversal**
- **impact:** read arbitrary files
- **vector:** ../ directory traversal in the test parameter
- **attacker:** unauthenticated remote attackers
- **product:** Personal Weather Station Dashboard
- **version:** 12_lts
- **component:** /others/_test.php

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on the information relevant to CVE-2025-47423:

**Content from github.com_70fd043a_20250624_105016.html**

*   **Root cause of vulnerability:** The vulnerability is due to Local File Inclusion (LFI) in the `Personal Weather Station Dashboard` version `12_lts`. The vulnerable component is `/others/_test.php`.
*   **Weaknesses/vulnerabilities present:** The `test` parameter in `/others/_test.php` is vulnerable to LFI. The code uses `str_replace` to remove `../`, but this is insufficient to prevent directory traversal, allowing attackers to read arbitrary files.
*   **Impact of exploitation:**
    *   Read arbitrary files on the filesystem.
    *   Expose private SSL keys (e.g., `server.key`).
    *   Perform man-in-the-middle (MITM) attacks.
    *   Impersonate the HTTPS server.
*   **Attack vectors:** The vulnerability is exploited by sending a GET request to `/others/_test.php` with the `test` parameter set to a file path using directory traversal, like: `GET /others/_test.php?test=../../../apache/conf/ssl.key/server.key HTTP/1.1`.
*   **Required attacker capabilities/position:** Unauthenticated remote attackers.
*   **Mitigation or fix:**
    *   Use strict allowlisting for include targets.
    *   Sanitize input with `basename()` and check against allowed files.
    *   Avoid dynamic inclusion based on user input.
    *   Specifically, a code example is provided to fix the issue:
        ```
        $allowed_tests = ['index.php', 'module_test.php'];
        $script = isset($_GET['test']) ? basename($_GET['test']) : 'index.php';

        if (!in_array($script, $allowed_tests)) {
            die("Invalid test file.");
        }

        include(__DIR__ . '/scripts/' . $script);
        ```
    *   If running `Personal Weather Station Dashboard 12_lts`: immediately remove or update `_test.php`, implement the fixed script with file whitelisting, and rotate and reissue any compromised TLS certificates.
*   **More detail than the official CVE description:** This content provides significantly more detail than a typical CVE description, including the vulnerable code snippet, a proof-of-concept (PoC), and a specific fix.

**Content from github.com_70fd043a_20250624_202939.html**

*   This content provides the same vulnerability information as the previous one.

**Content from github.com_dba769c8_20250624_202940.html**

*   UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.188 |
| 3 | 24 | Path Traversal: '../filedir' | Variant | Allowed | sparse | 0.180 |
| 4 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.174 |
| 5 | 829 | Inclusion of Functionality from Untrusted Control Sphere | Base | Allowed | sparse | 0.170 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.168 |
| 7 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.166 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.155 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.554 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

