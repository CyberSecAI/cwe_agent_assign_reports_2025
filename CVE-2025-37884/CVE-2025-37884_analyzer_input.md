# Vulnerability Information: CVE-2025-37884

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved bpf Fix **deadlock between rcu_tasks_trace and event_mutex**. Fix the following deadlock CPU A _free_event() perf_kprobe_destroy() mutex_lock(&event_mutex) perf_trace_event_unreg() synchronize_rcu_tasks_trace() There are several paths where _free_event() grabs event_mutex and calls sync_rcu_tasks_trace. Above is one such case. CPU B bpf_prog_test_run_syscall() rcu_read_lock_trace() bpf_prog_run_pin_on_cpu() bpf_prog_load() bpf_tracing_func_proto() trace_set_clr_event() mutex_lock(&event_mutex) Delegate trace_set_clr_event() to workqueue to avoid such lock dependency.

### Vulnerability Description Key Phrases
- **rootcause:** **deadlock between rcu_tasks_trace and event_mutex**
- **product:** Linux kernel
- **component:** bpf

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.315 |
| 2 | 833 | Deadlock | Base | Allowed | sparse | 0.292 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.220 |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.214 |
| 5 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.213 |
| 6 | 663 | Use of a Non-reentrant Function in a Concurrent Context | Base | Allowed | sparse | 0.213 |
| 7 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | Allowed | sparse | 0.206 |
| 8 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.206 |
| 9 | 413 | Improper Resource Locking | Base | Allowed | dense | 0.467 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |

