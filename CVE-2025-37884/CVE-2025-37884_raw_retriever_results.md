# Raw Retriever Results for CVE-2025-37884

# Raw Retriever Results for CVE-2025-37884
## Query
In the Linux kernel, the following vulnerability has been resolved bpf Fix deadlock between rcu_tasks_trace and event_mutex. Fix the following deadlock CPU A _free_event() perf_kprobe_destroy() mutex_lock(&event_mutex) perf_trace_event_unreg() synchronize_rcu_tasks_trace() There are several paths where _free_event() grabs event_mutex and calls sync_rcu_tasks_trace. Above is one such case. CPU B bpf_prog_test_run_syscall() rcu_read_lock_trace() bpf_prog_run_pin_on_cpu() bpf_prog_load() bpf_tracing_func_proto() trace_set_clr_event() mutex_lock(&event_mutex) Delegate trace_set_clr_event() to workqueue to avoid such lock dependency.

## Keyphrases
- **rootcause**: 'deadlock between rcu_tasks_trace', 'event_mutex'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4264 | 0.5162 | 0.4511 | 0.4406 | 20 |
| Sparse | 193.4186 | 314.7103 | 220.1960 | 205.7294 | 13 |
| Graph | 1.4611 | 2.6100 | 1.7930 | 1.6868 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 2.6100 | Allowed |
| 2 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 3 | 368 | Context Switching Race Condition | base | 2.1762 | Allowed |
| 4 | 364 | Signal Handler Race Condition | Base | 2.1181 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 6 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 8 | 833 | Deadlock | Base | 1.7093 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7011 | Allowed-with-Review |
| 10 | 413 | Improper Resource Locking | Base | 1.6888 | Allowed |
| 11 | 134 | Use of Externally-Controlled Format String | base | 1.6848 | Allowed |
| 12 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 13 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 14 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 15 | 689 | Permission Race Condition During Resource Copy | compound | 1.6160 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5162 | 0.5162 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.5114 | 0.5114 | Allowed-with-Review |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4912 | 0.4912 | Allowed-with-Review |
| 4 | 413 | Improper Resource Locking | Base | 0.4668 | 0.4668 | Allowed |
| 5 | 909 | Missing Initialization of Resource | Class | 0.4635 | 0.4635 | Allowed-with-Review |
| 6 | 366 | Race Condition within a Thread | Base | 0.4548 | 0.4548 | Allowed |
| 7 | 416 | Use After Free | Variant | 0.4513 | 0.4513 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4488 | 0.4488 | Allowed |
| 9 | 911 | Improper Update of Reference Count | Base | 0.4429 | 0.4429 | Allowed |
| 10 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4418 | 0.4418 | Allowed |
| 11 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4395 | 0.4395 | Allowed |
| 12 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4387 | 0.4387 | Allowed |
| 13 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4379 | 0.4379 | Allowed |
| 14 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4370 | 0.4370 | Allowed |
| 15 | 415 | Double Free | Variant | 0.4351 | 0.4351 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 314.7103 | 314.7103 | Allowed-with-Review |
| 2 | 833 | Deadlock | 292.4316 | 292.4316 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 219.7927 | 219.7927 | Allowed-with-Review |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | 213.5249 | 213.5249 | Allowed |
| 5 | 364 | Signal Handler Race Condition | 213.3584 | 213.3584 | Allowed |
| 6 | 663 | Use of a Non-reentrant Function in a Concurrent Context | 212.7262 | 212.7262 | Allowed |
| 7 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | 205.7294 | 205.7294 | Allowed |
| 8 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 205.5517 | 205.5517 | Discouraged |
| 9 | 407 | Inefficient Algorithmic Complexity | 201.1104 | 201.1104 | Allowed-with-Review |
| 10 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 198.4615 | 198.4615 | Allowed |
| 11 | 606 | Unchecked Input for Loop Condition | 197.7552 | 197.7552 | Allowed |
| 12 | 770 | Allocation of Resources Without Limits or Throttling | 193.9772 | 193.9772 | Allowed |
| 13 | 191 | Integer Underflow (Wrap or Wraparound) | 193.4186 | 193.4186 | Allowed |
