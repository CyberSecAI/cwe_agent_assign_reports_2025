# Vulnerability Information: CVE-2024-23600

## Vulnerability Description
**Improper Input Validation** of query search results for private field data in PingIDM (Query Filter module) allows for a potentially efficient brute forcing approach leading to information disclosure.

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Input Validation**
- **impact:** information disclosure
- **vector:** brute forcing approach
- **product:** PingIDM
- **component:** Query Filter module

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from a query filter injection flaw in the Ping Identity PingIDM API. Specifically, the API allows filtering of user data based on various fields using operators like 'sw' (starts with) and 'co' (contains).  Although the 'password' field is protected and not intended for filtering, it can be exploited by injecting malicious query filters.

**Weaknesses/Vulnerabilities:**
- **Query Filter Injection:** The primary vulnerability is the ability to inject arbitrary queries into the API's filtering mechanism. This allows an attacker to query data they should not have access to.
- **Insufficient Input Sanitization:** The API does not properly sanitize or validate the input provided to the `_queryFilter` parameter, allowing the use of the `password` field in the filter.
- **Exposure of Protected Field:** The 'password' field, which is explicitly protected and should not be accessible via filtering, can be used in a query.
- **Blind Brute-force:** The vulnerability allows for a blind brute-force attack on user passwords due to the support of operators like "starts-with" and "contains" combined with the ability to query the password field, even in encrypted form.

**Impact of Exploitation:**
- **Password Disclosure:** Attackers can potentially obtain user passwords, either in plaintext or encrypted form, based on the server configuration.
- **Data Breach:** Successful exploitation can lead to a data breach if an attacker obtains valid user credentials, granting unauthorized access to the system and its resources.
- **Account Compromise:** Obtained credentials can be used to compromise user accounts.
- **Lateral Movement:** Compromised accounts may be leveraged for further attacks within the organization.

**Attack Vectors:**
- **API Manipulation:** The vulnerability is exploited by crafting malicious HTTP GET requests to the `/openidm/managed/user` endpoint, including a manipulated `_queryFilter` parameter.
- **Direct API Interaction:** An attacker can directly interact with the API to exploit the query filter injection.

**Required Attacker Capabilities/Position:**
- **Read access to "User" collection:**  The attacker needs to have read access to the "User" collection. This is generally done through a valid, potentially low-privileged, account.
- **Understanding of API:**  The attacker must have a basic understanding of the PingIDM API to formulate the malicious query filters.
- **Network Access:** The attacker needs to be able to send HTTP requests to the PingIDM server.

**Additional Details:**
- The vulnerability exists in versions 7.0.0 to 7.5.0 of Ping Identity PingIDM (formerly ForgeRock Identity Management), and older unsupported versions.
- The vulnerability can be used to brute-force both plaintext and encrypted passwords, depending on the server's configuration.
- The issue extends to all protected fields of custom or built-in collections, but this remains to be tested.
- A workaround exists for custom roles, where the "password" field's permissions can be set to "None," preventing queries on this field. However, this does not work for built-in roles.
- The vendor has released patches and the fix is included in version 8.0.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.181 |
| 2 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | Allowed | sparse | 0.166 |
| 3 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | sparse | 0.140 |
| 4 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.138 |
| 5 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.132 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.128 |
| 7 | 665 | Improper Initialization | Class | Discouraged | sparse | 0.126 |
| 8 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.126 |
| 9 | 598 | Use of GET Request Method With Sensitive Query Strings | Variant | Allowed | dense | 0.503 |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | graph | 0.002 |

