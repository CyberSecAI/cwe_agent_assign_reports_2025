# Raw Retriever Results for CVE-2025-22056

# Raw Retriever Results for CVE-2025-22056
## Query
In the Linux kernel, the following vulnerability has been resolved netfilter nft_tunnel fix geneve_opt type confusion addition When handling multiple NFTA_TUNNEL_KEY_OPTS_GENEVE attributes, the parsing logic should place every geneve_opt structure one by one compactly. Hence, when deciding the next geneve_opt position, the pointer addition should be in units of char *. However, the current implementation erroneously does type conversion before the addition, which will lead to heap out-of-bounds write. [ 6.989857] ================================================================== [ 6.990293] BUG KASAN slab-out-of-bounds in nft_tunnel_obj_init+0x977/0xa70 [ 6.990725] Write of size 124 at addr ffff888005f18974 by task poc/178 [ 6.991162] [ 6.991259] CPU 0 PID 178 Comm poc-oob-write Not tainted 6.1.132 #1 [ 6.991655] Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org 04/01/2014 [ 6.992281] Call Trace [ 6.992423] [ 6.992586] dump_stack_lvl+0x44/0x5c [ 6.992801] print_report+0x184/0x4be [ 6.993790] kasan_report+0xc5/0x100 [ 6.994252] kasan_check_range+0xf3/0x1a0 [ 6.994486] memcpy+0x38/0x60 [ 6.994692] nft_tunnel_obj_init+0x977/0xa70 [ 6.995677] nft_obj_init+0x10c/0x1b0 [ 6.995891] nf_tables_newobj+0x585/0x950 [ 6.996922] nfnetlink_rcv_batch+0xdf9/0x1020 [ 6.998997] nfnetlink_rcv+0x1df/0x220 [ 6.999537] netlink_unicast+0x395/0x530 [ 7.000771] netlink_sendmsg+0x3d0/0x6d0 [ 7.001462] __sock_sendmsg+0x99/0xa0 [ 7.001707] ____sys_sendmsg+0x409/0x450 [ 7.002391] ___sys_sendmsg+0xfd/0x170 [ 7.003145] __sys_sendmsg+0xea/0x170 [ 7.004359] do_syscall_64+0x5e/0x90 [ 7.005817] entry_SYSCALL_64_after_hwframe+0x6e/0xd8 [ 7.006127] RIP 00330x7ec756d4e407 [ 7.006339] Code 48 89 fa 4c 89 df e8 38 aa 00 00 8b 93 08 03 00 00 59 5e 48 83 f8 fc 74 1a 5b c3 0f 1f 84 00 00 00 00 00 48 8b 44 24 10 0f 05 c3 0f 1f 80 00 00 00 00 83 e2 39 83 faf [ 7.007364] RSP 002b00007ffed5d46760 EFLAGS 00000202 ORIG_RAX 000000000000002e [ 7.007827] RAX ffffffffffffffda RBX 00007ec756cc4740 RCX 00007ec756d4e407 [ 7.008223] RDX 0000000000000000 RSI 00007ffed5d467f0 RDI 0000000000000003 [ 7.008620] RBP 00007ffed5d468a0 R08 0000000000000000 R09 0000000000000000 [ 7.009039] R10 0000000000000000 R11 0000000000000202 R12 0000000000000000 [ 7.009429] R13 00007ffed5d478b0 R14 00007ec756ee5000 R15 00005cbd4e655cb8 Fix this bug with correct pointer addition and conversion in parse and dump code.

## Keyphrases
- **rootcause**: 'type confusion'
- **weakness**: 'heap out-of-bounds write', 'slab-out-of-bounds write'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5072 | 0.5782 | 0.5388 | 0.5413 | 20 |
| Sparse | 261.6193 | 834.2302 | 759.2149 | 801.4000 | 13 |
| Graph | 1.5552 | 2.2568 | 1.8700 | 1.7111 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 170 | Improper Null Termination | base | 2.2568 | Allowed |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.2100 | Allowed |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 2.2100 | Allowed |
| 4 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 5 | 908 | Use of Uninitialized Resource | base | 2.2100 | Allowed |
| 6 | 1287 | Improper Validation of Specified Type of Input | base | 2.1762 | Allowed |
| 7 | 306 | Missing Authentication for Critical Function | base | 2.1190 | Allowed |
| 8 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | Base | 2.0473 | Allowed |
| 9 | 73 | External Control of File Name or Path | base | 1.7550 | Allowed |
| 10 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.7115 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.7106 | Allowed |
| 12 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 1.6848 | Allowed |
| 13 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |
| 14 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | base | 1.6848 | Allowed |
| 15 | 128 | Wrap-around Error | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5782 | 0.5782 | Allowed |
| 2 | 121 | Stack-based Buffer Overflow | Variant | 0.5746 | 0.5746 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5667 | 0.5667 | Allowed-with-Review |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5652 | 0.5652 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5648 | 0.5648 | Allowed |
| 6 | 122 | Heap-based Buffer Overflow | Variant | 0.5641 | 0.5641 | Allowed |
| 7 | 190 | Integer Overflow or Wraparound | Base | 0.5624 | 0.5624 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5605 | 0.5605 | Allowed |
| 9 | 126 | Buffer Over-read | Variant | 0.5555 | 0.5555 | Allowed |
| 10 | 476 | NULL Pointer Dereference | Base | 0.5539 | 0.5539 | Allowed |
| 11 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5287 | 0.5287 | Allowed-with-Review |
| 12 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5245 | 0.5245 | Allowed |
| 13 | 193 | Off-by-one Error | Base | 0.5153 | 0.5153 | Allowed |
| 14 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5104 | 0.5104 | Discouraged |
| 15 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.5104 | 0.5104 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 306 | Missing Authentication for Critical Function | 834.2302 | 834.2302 | Allowed |
| 2 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | 824.2263 | 824.2263 | Allowed |
| 3 | 20 | Improper Input Validation | 819.7878 | 819.7878 | Discouraged |
| 4 | 912 | Hidden Functionality | 811.4097 | 811.4097 | Allowed-with-Review |
| 5 | 121 | Stack-based Buffer Overflow | 806.2478 | 806.2478 | Allowed |
| 6 | 302 | Authentication Bypass by Assumed-Immutable Data | 803.0819 | 803.0819 | Allowed |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | 801.4000 | 801.4000 | Discouraged |
| 8 | 190 | Integer Overflow or Wraparound | 795.2760 | 795.2760 | Allowed |
| 9 | 400 | Uncontrolled Resource Consumption | 792.1414 | 792.1414 | Discouraged |
| 10 | 288 | Authentication Bypass Using an Alternate Path or Channel | 787.4567 | 787.4567 | Allowed |
| 11 | 125 | Out-of-bounds Read | 771.3197 | 771.3197 | Allowed |
| 12 | 787 | Out-of-bounds Write | 761.5966 | 761.5966 | Allowed |
| 13 | 287 | Improper Authentication | 261.6193 | 261.6193 | Discouraged |
