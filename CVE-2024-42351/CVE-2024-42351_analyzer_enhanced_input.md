## Vulnerability Description
Galaxy is a free, open-source system for analyzing data, authoring workflows, training and education, publishing tools, managing infrastructure, and more. An attacker can potentially replace the contents of public datasets resulting in data loss or tampering. All supported branches of Galaxy (and more back to release_21.05) were amended with the below patch. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **impact:** data loss or tampering
- **vector:** replace contents of public datasets
- **attacker:** attacker
- **product:** Galaxy
- **version:** All supported branches

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-42351:

**Root Cause of Vulnerability:**

The vulnerability stems from the Galaxy platform's dataset import functionality, specifically how it handles UUIDs during dataset imports.  Prior to the patch, the system directly set the UUID of a dataset based on the provided `dataset_attrs` during an import process. This allowed external or malicious actors to overwrite the UUID with their own specified value if they had the ability to import data with the `allow_edit` setting enabled.

**Weaknesses/Vulnerabilities Present:**

*   **Unrestricted Dataset UUID Modification:** The core weakness is the ability to directly set the dataset UUID based on user-provided input during import. This allowed potentially unauthorized modification of dataset metadata (UUID).
*   **Data Tampering:** An attacker could exploit this to potentially replace the contents of public datasets by manipulating the UUID. This is because the UUID is used to identify the dataset.

**Impact of Exploitation:**

*   **Data Loss:** By replacing a dataset's UUID, an attacker can effectively make it inaccessible and potentially overwrite it.
*   **Data Tampering:** An attacker can replace the actual content of a public dataset with their own data, leading to potential data corruption or malicious content injection.

**Attack Vectors:**

*   **Dataset Import with `allow_edit`:** An attacker needs to have the ability to import datasets into the Galaxy platform with `allow_edit` option enabled.

**Required Attacker Capabilities/Position:**

*   **Access to Galaxy with Dataset Import Privileges**: An attacker would need to have a user account with permissions to import data into a Galaxy instance with the `allow_edit` option enabled, and be able to control `dataset_attrs` in the import process.

**Patch Information:**

The provided patch modifies the `handle_dataset_object_edit` function in `lib/galaxy/model/store/__init__.py`.  The change is that the UUID is set based on `dataset_attrs` only if `self.import_options.allow_edit` is `True`. This prevents unauthorized changes to the UUID and mitigates the vulnerability.

The vulnerability has been assigned **Moderate** severity.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.112 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.110 |
| 3 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.110 |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.109 |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.108 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.107 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.105 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.104 |
| 9 | 285 | Improper Authorization | Class | Discouraged | dense | 0.490 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-1390: Weak Authentication

CWE-532: Insertion of Sensitive Information into Log File

CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer

CWE-863: Incorrect Authorization

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-285: Improper Authorization

CWE-226: Sensitive Information in Resource Not Removed Before Reuse