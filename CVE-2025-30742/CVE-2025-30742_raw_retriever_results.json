{
  "query": "httpd.c in atophttpd 2.8.0 has an off-by-one error and resultant out-of-bounds read because a certain 1024-character req string would not have a final \\\\0 character.",
  "keyphrases": {
    "rootcause": [
      "off-by-one error"
    ],
    "weakness": [
      "out-of-bounds read"
    ]
  },
  "timestamp": "2025-07-12T12:24:40.003163",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "124",
        "name": "Buffer Underwrite ('Buffer Underflow')",
        "abstraction": "base",
        "score": 2.9952,
        "description": "CWE-124: Buffer Underwrite ('Buffer Underflow')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "193",
        "name": "Off-by-one Error",
        "abstraction": "Base",
        "score": 2.8234827532359685,
        "description": "A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "170",
        "name": "Improper Null Termination",
        "abstraction": "Base",
        "score": 2.8164731090552593,
        "description": "The product does not terminate or incorrectly terminates a string or array with a null character or equivalent terminator....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "base",
        "score": 2.7014000000000005,
        "description": "CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "126",
        "name": "Buffer Over-read",
        "abstraction": "variant",
        "score": 2.6784000000000003,
        "description": "CWE-126: Buffer Over-read...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "base",
        "score": 2.3998000000000004,
        "description": "CWE-125: Out-of-bounds Read...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "787",
        "name": "Out-of-bounds Write",
        "abstraction": "base",
        "score": 2.2776000000000005,
        "description": "CWE-787: Out-of-bounds Write...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "839",
        "name": "Numeric Range Comparison Without Minimum Check",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-839: Numeric Range Comparison Without Minimum Check...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "825",
        "name": "Expired Pointer Dereference",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-825: Expired Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "824",
        "name": "Access of Uninitialized Pointer",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-824: Access of Uninitialized Pointer...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "823",
        "name": "Use of Out-of-range Pointer Offset",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-823: Use of Out-of-range Pointer Offset...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "822",
        "name": "Untrusted Pointer Dereference",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-822: Untrusted Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "617",
        "name": "Reachable Assertion",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-617: Reachable Assertion...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "123",
        "name": "Write-what-where Condition",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-123: Write-what-where Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "681",
        "name": "Incorrect Conversion between Numeric Types",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-681: Incorrect Conversion between Numeric Types...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "562",
        "name": "Return of Stack Variable Address",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-562: Return of Stack Variable Address...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "182",
        "name": "Collapse of Data into Unsafe Value",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-182: Collapse of Data into Unsafe Value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "190",
        "name": "Integer Overflow or Wraparound",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-190: Integer Overflow or Wraparound...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1257",
        "name": "Improper Access Control Applied to Mirrored or Aliased Memory Regions",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1257: Improper Access Control Applied to Mirrored or Aliased Memory Regions...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1260",
        "name": "Improper Handling of Overlap Between Protected Memory Ranges",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1260: Improper Handling of Overlap Between Protected Memory Ranges...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "130",
        "name": "Improper Handling of Length Parameter Inconsistency",
        "abstraction": "Base",
        "score": 0.5345869168576566,
        "description": "The product parses a formatted message or structure, but it does not handle or incorrectly handles a length field that is inconsistent with the actual length of the associated data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "55",
        "name": "Path Equivalence: '/./' (Single Dot Directory)",
        "abstraction": "Variant",
        "score": 0.5332855256882792,
        "description": "The product accepts path input in the form of single dot directory exploit ('/./') without appropriate validation, which can lead to ambiguous path resolution and allow an attacker to traverse the fil...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "234",
        "name": "Failure to Handle Missing Parameter",
        "abstraction": "Variant",
        "score": 0.5324465832874568,
        "description": "If too few arguments are sent to a function, the function will still pop the expected number of arguments from the stack. Potentially, a variable number of arguments could be exhausted in a function a...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "551",
        "name": "Incorrect Behavior Order: Authorization Before Parsing and Canonicalization",
        "abstraction": "Base",
        "score": 0.5284124796721371,
        "description": "If a web server does not fully parse requested URLs before it examines them for authorization, it may be possible for an attacker to bypass authorization protection....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "174",
        "name": "Double Decoding of the Same Data",
        "abstraction": "Variant",
        "score": 0.5231827371522989,
        "description": "The product decodes the same input twice, which can limit the effectiveness of any protection mechanism that occurs in between the decoding operations....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "805",
        "name": "Buffer Access with Incorrect Length Value",
        "abstraction": "Base",
        "score": 0.5154475775838963,
        "description": "The product uses a sequential operation to read or write a buffer, but it uses an incorrect length value that causes it to access memory that is outside of the bounds of the buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "606",
        "name": "Unchecked Input for Loop Condition",
        "abstraction": "Base",
        "score": 0.5108111245402784,
        "description": "The product does not properly check inputs that are used for loop conditions, potentially leading to a denial of service or other consequences because of excessive looping....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "69",
        "name": "Improper Handling of Windows ::DATA Alternate Data Stream",
        "abstraction": "Variant",
        "score": 0.5076088587506545,
        "description": "The product does not properly prevent access to, or detect usage of, alternate data streams (ADS)....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "127",
        "name": "Buffer Under-read",
        "abstraction": "Variant",
        "score": 0.5009815164579505,
        "description": "The product reads from a buffer using buffer access mechanisms such as indexes or pointers that reference memory locations prior to the targeted buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "786",
        "name": "Access of Memory Location Before Start of Buffer",
        "abstraction": "Base",
        "score": 0.5009793413341425,
        "description": "The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "433",
        "name": "Unparsed Raw Web Content Delivery",
        "abstraction": "Variant",
        "score": 0.474158840455534,
        "description": "The product stores raw content or supporting code under the web document root with an extension that is not specifically handled by the server....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "32",
        "name": "Path Traversal: '...' (Triple Dot)",
        "abstraction": "Variant",
        "score": 0.471317173668282,
        "description": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize '...' (triple dot) sequences that can resolve to a location th...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "33",
        "name": "Path Traversal: '....' (Multiple Dot)",
        "abstraction": "Variant",
        "score": 0.4703205981235219,
        "description": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize '....' (multiple dot) sequences that can resolve to a location...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "239",
        "name": "Failure to Handle Incomplete Element",
        "abstraction": "Variant",
        "score": 0.4697117229381658,
        "description": "The product does not properly handle when a particular element is not completely specified....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "177",
        "name": "Improper Handling of URL Encoding (Hex Encoding)",
        "abstraction": "Variant",
        "score": 0.4681654221451265,
        "description": "The product does not properly handle when all or part of an input has been URL encoded....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1389",
        "name": "Incorrect Parsing of Numbers with Different Radices",
        "abstraction": "Base",
        "score": 0.4662057712219678,
        "description": "The product parses numeric input assuming base 10 (decimal) values, but it does not account for inputs that use a different base number (radix)....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "67",
        "name": "Improper Handling of Windows Device Names",
        "abstraction": "Variant",
        "score": 0.46581612762448865,
        "description": "The product constructs pathnames from user input, but it does not handle or incorrectly handles a pathname containing a Windows device name such as AUX or CON. This typically leads to denial of servic...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "49",
        "name": "Path Equivalence: 'filename/' (Trailing Slash)",
        "abstraction": "Variant",
        "score": 0.46543262731236873,
        "description": "The product accepts path input in the form of trailing slash ('filedir/') without appropriate validation, which can lead to ambiguous path resolution and allow an attacker to traverse the file system ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "166",
        "name": "Improper Handling of Missing Special Element",
        "abstraction": "Base",
        "score": 0.4591482479816528,
        "description": "The product receives input from an upstream component, but it does not handle or incorrectly handles when an expected special element is missing....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "394",
        "name": "Unexpected Status Code or Return Value",
        "abstraction": "Base",
        "score": 0.45671925209899933,
        "description": "The product does not properly check when a function or operation returns a value that is legitimate for the function, but is not expected by the product....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "193",
        "name": "Off-by-one Error",
        "abstraction": "Base",
        "score": 267.0218896039189,
        "description": "A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "170",
        "name": "Improper Null Termination",
        "abstraction": "Base",
        "score": 214.46794499981212,
        "description": "The product does not terminate or incorrectly terminates a string or array with a null character or equivalent terminator....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "Base",
        "score": 193.44649344890004,
        "description": "The product reads data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "187",
        "name": "Partial String Comparison",
        "abstraction": "Variant",
        "score": 191.73435988288034,
        "description": "The product performs a comparison that only examines a portion of a factor before determining whether there is a match, such as a substring, leading to resultant weaknesses....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "124",
        "name": "Buffer Underwrite ('Buffer Underflow')",
        "abstraction": "Base",
        "score": 183.28416887752815,
        "description": "The product writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "682",
        "name": "Incorrect Calculation",
        "abstraction": "Pillar",
        "score": 180.53065308753676,
        "description": "The product performs a calculation that generates incorrect or unintended results that are later used in security-critical decisions or resource management....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "147",
        "name": "Improper Neutralization of Input Terminators",
        "abstraction": "Variant",
        "score": 176.6314443351424,
        "description": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as input terminators when they are sent to a dow...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "617",
        "name": "Reachable Assertion",
        "abstraction": "Base",
        "score": 176.57660379445826,
        "description": "The product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "190",
        "name": "Integer Overflow or Wraparound",
        "abstraction": "Base",
        "score": 175.18978199500816,
        "description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 174.67439485153324,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "122",
        "name": "Heap-based Buffer Overflow",
        "abstraction": "Variant",
        "score": 172.84458821388614,
        "description": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine suc...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "197",
        "name": "Numeric Truncation Error",
        "abstraction": "Base",
        "score": 172.34099879057078,
        "description": "Truncation errors occur when a primitive is cast to a primitive of a smaller size and data is lost in the conversion....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "158",
        "name": "Improper Neutralization of Null Byte or NUL Character",
        "abstraction": "Variant",
        "score": 172.2451876025276,
        "description": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes NUL characters or null bytes when they are sent to a downstream component....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "abstraction": "Base",
        "score": 51.959711256592996,
        "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neu...",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.45671925209899933,
      "max": 0.5345869168576566,
      "mean": 0.4927369222447429,
      "median": 0.48756909089483824,
      "count": 20
    },
    "sparse": {
      "min": 51.959711256592996,
      "max": 267.0218896039189,
      "mean": 178.78201576716398,
      "median": 176.60402406480034,
      "count": 14
    },
    "graph": {
      "min": 1.6848000000000003,
      "max": 2.9952,
      "mean": 2.203937793114562,
      "median": 2.2100000000000004,
      "count": 20
    }
  }
}