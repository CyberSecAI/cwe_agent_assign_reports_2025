## Vulnerability Description
Pimcores Admin Classic Bundle provides a Backend UI for Pimcore. An **HTML injection** issue allows users with access to the email sending functionality to inject arbitrary HTML code into emails sent via the admin interface, potentially leading to session cookie theft and the alteration of page content. The vulnerability was discovered in the /admin/email/send-test-email endpoint using the POST method. The vulnerable parameter is content, which permits the injection of arbitrary HTML code during the email sending process. While JavaScript code injection is blocked through filtering, HTML code injection remains possible. This vulnerability is fixed in 1.7.6.

### Vulnerability Description Key Phrases
- **component:** /admin/email/send-test-email endpoint
- **weakness:** **HTML injection**
- **product:** Pimcores Admin Classic Bundle
- **impact:** session cookie theft, alteration of page content
- **attacker:** users with access to the email sending functionality

## CVE Reference Links Content Summary
```
- Root cause of vulnerability: HTML injection vulnerability due to insufficient sanitization of user input in the `/admin/email/send-test-email` endpoint.
- Weaknesses/vulnerabilities present: HTML injection (CWE-79)
- Impact of exploitation:  Allows injection of arbitrary HTML code into emails, potentially leading to phishing attacks (e.g., fake login forms) and potentially session cookie theft or alteration of page content.
- Attack vectors: The vulnerability is exploitable by a user with access to the email sending functionality in the admin interface, who can inject HTML code into the email content parameter.
- Required attacker capabilities/position: The attacker must have access to the email sending functionality in the admin interface and the ability to input the malicious HTML payload.
- Mitigation or fix: Fixed in version 1.7.6.  The fix involves stripping HTML tags from the email content.  The suggested mitigation is that all functionalities that process user input should be carefully reviewed to ensure that data is appropriately encoded as HTML entities in server responses.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.571 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.565 |
| 4 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.565 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.563 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.521 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.514 |
| 8 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.513 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.498 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-138: Improper Neutralization of Special Elements

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-117: Improper Output Neutralization for Logs