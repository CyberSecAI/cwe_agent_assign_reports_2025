# Vulnerability Information: CVE-2024-55953

## Vulnerability Description
DataEase is an open source business analytics tool. Authenticated users can read and deserialize arbitrary files through the background JDBC connection. When constructing the jdbc connection string, the **parameters are not filtered**. This vulnerability has been fixed in v1.18.27. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **parameters are not filtered**
- **impact:** arbitrary file access
- **attacker:** authenticated users
- **product:** DataEase
- **version:** before 1.18.27
- **component:** background JDBC connection

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-55953:

**Root Cause of Vulnerability:**

The vulnerability stems from insufficient filtering of parameters when constructing JDBC connection strings in DataEase. Specifically, the application fails to properly sanitize the `host` parameter, allowing an attacker to inject malicious parameters. This enables them to bypass intended restrictions and execute arbitrary actions.

**Weaknesses/Vulnerabilities Present:**

*   **Inadequate Input Validation:** The primary weakness is the lack of robust input validation for the `host` parameter in the JDBC connection string. The application attempts to filter "illegal parameters" but does not apply this filtering correctly to the complete JDBC URL, leaving it vulnerable to parameter injection.
*   **Deserialization Vulnerability:** The injected parameters, such as `autoDeserialize=true` can trigger deserialization of arbitrary data, potentially leading to remote code execution.
*   **Arbitrary File Read:** By using the `allowLoadLocalInfile` parameter combined with a crafted username containing the path of a file to read, an attacker can force the application to read arbitrary files from the server.

**Impact of Exploitation:**

*   **Arbitrary File Read:** An authenticated attacker can read sensitive files from the server, such as `/etc/passwd`, exposing potentially confidential data.
*   **Remote Code Execution:** By exploiting the deserialization vulnerability, an attacker could potentially execute arbitrary code on the server. The provided content specifically demonstrates file reading, however, the underlying deserialization issue implies the possibility of RCE
*   **Data Breach:** Successful exploitation could lead to data breaches by compromising system files and potentially other internal data through crafted queries.

**Attack Vectors:**

*   **Malicious JDBC URL Construction:** The attacker crafts a malicious JDBC connection URL by injecting harmful parameters into the `host` parameter during the datasource configuration.
*   **HTTP POST Request:** The crafted configuration is sent via an HTTP POST request to the `/datasource/validate/` endpoint.

**Required Attacker Capabilities/Position:**

*   **Authentication:** The attacker needs to be an authenticated user of the DataEase application to exploit this vulnerability.
*   **Knowledge of JDBC Parameters:** The attacker needs to know about specific MySQL JDBC connection parameters (e.g., `autoDeserialize`, `allowLoadLocalInfile`, `user`) that can be used to perform arbitrary file read or potentially achieve remote code execution.

**Additional Details:**

*   The vulnerability exists in the `MysqlConfiguration` class within the `io.dataease.dto.datasource` package.
*   The code snippet provided shows how the `getJdbc()` method constructs the JDBC URL without properly validating the host parameters.
*   The attacker bypasses the illegal parameter check by encoding the malicious parameters into the host parameter, which is not directly checked against the `illegalParameters` list.
*   The fix includes adding a check to the constructed JDBC URL, not just `extraParams`.

**Affected Versions:**

*   Versions <= 1.18.26 are affected.

**Patched Versions:**

*   Version 1.18.27 and later contain the fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.335 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.334 |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.314 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.311 |
| 5 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.307 |
| 6 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.307 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.304 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.303 |
| 9 | 69 | Improper Handling of Windows ::DATA Alternate Data Stream | Variant | Allowed | dense | 0.457 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.002 |

