# Raw Retriever Results for CVE-2024-6868

# Raw Retriever Results for CVE-2024-6868
## Query
mudler/LocalAI version 2.17.1 allows for arbitrary file write due to improper handling of automatic archive extraction. When model configurations specify additional files as archives (e.g., .tar), these archives are automatically extracted after downloading. This behavior can be exploited to perform a tarslip attack, allowing files to be written to arbitrary locations on the server, bypassing checks that normally restrict files to the models directory. This vulnerability can lead to remote code execution (RCE) by overwriting backend assets used by the server.

## Keyphrases
- **rootcause**: 'improper handling of automatic archive extraction'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4870 | 0.5433 | 0.5054 | 0.5013 | 20 |
| Sparse | 126.8032 | 546.1620 | 412.7722 | 410.3773 | 11 |
| Graph | 1.3747 | 2.5641 | 1.8500 | 1.7379 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 2.5641 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.5605 | Allowed |
| 3 | 363 | Race Condition Enabling Link Following | base | 2.2100 | Allowed |
| 4 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 5 | 183 | Permissive List of Allowed Inputs | base | 2.2100 | Allowed |
| 6 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | 2.1907 | Allowed |
| 7 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.0930 | Allowed |
| 8 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 9 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 11 | 36 | Absolute Path Traversal | Base | 1.7078 | Allowed |
| 12 | 23 | Relative Path Traversal | Base | 1.6911 | Allowed |
| 13 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 14 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 15 | 73 | External Control of File Name or Path | Base | 1.5464 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5433 | 0.5433 | Allowed |
| 2 | 24 | Path Traversal: '../filedir' | Variant | 0.5338 | 0.5338 | Allowed |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.5316 | 0.5316 | Allowed |
| 4 | 36 | Absolute Path Traversal | Base | 0.5269 | 0.5269 | Allowed |
| 5 | 552 | Files or Directories Accessible to External Parties | Base | 0.5226 | 0.5226 | Allowed |
| 6 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.5137 | 0.5137 | Allowed |
| 7 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | 0.5078 | 0.5078 | Allowed |
| 8 | 530 | Exposure of Backup File to an Unauthorized Control Sphere | Variant | 0.5077 | 0.5077 | Allowed |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.5064 | 0.5064 | Allowed-with-Review |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5064 | 0.5064 | Allowed |
| 11 | 377 | Insecure Temporary File | Class | 0.4962 | 0.4962 | Allowed-with-Review |
| 12 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.4958 | 0.4958 | Allowed |
| 13 | 378 | Creation of Temporary File With Insecure Permissions | Base | 0.4945 | 0.4945 | Allowed |
| 14 | 28 | Path Traversal: '..\filedir' | Variant | 0.4940 | 0.4940 | Allowed |
| 15 | 73 | External Control of File Name or Path | Base | 0.4889 | 0.4889 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | 546.1620 | 546.1620 | Allowed |
| 2 | 23 | Relative Path Traversal | 499.1792 | 499.1792 | Allowed |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 485.5315 | 485.5315 | Allowed |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | 447.0626 | 447.0626 | Allowed |
| 5 | 61 | UNIX Symbolic Link (Symlink) Following | 434.6102 | 434.6102 | Allowed |
| 6 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 410.3773 | 410.3773 | Allowed |
| 7 | 427 | Uncontrolled Search Path Element | 401.9219 | 401.9219 | Allowed |
| 8 | 754 | Improper Check for Unusual or Exceptional Conditions | 398.4400 | 398.4400 | Allowed-with-Review |
| 9 | 502 | Deserialization of Untrusted Data | 397.9478 | 397.9478 | Allowed |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | 392.4583 | 392.4583 | Allowed-with-Review |
| 11 | 184 | Incomplete List of Disallowed Inputs | 126.8032 | 126.8032 | Allowed |
