## Vulnerability Description
The OSM Map Widget for Elementor plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the id parameter in all versions up to, and including, 1.2.2 due to **insufficient input sanitization and output escaping**. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping**
- **weakness:** **cross-site scripting**
- **impact:** inject arbitrary web scripts
- **attacker:** unauthenticated attackers
- **product:** OSM Map Widget for Elementor plugin for WordPress
- **version:** all versions up to and including 1.2.2

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-79

#### Top CWEs
- CWE-79 (Count: 51)
- CWE-1321 (Count: 2)

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-4663

**Root Cause of Vulnerability:**
- Insufficient input sanitization and output escaping of the `id` parameter.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS)

**Impact of Exploitation:**
- An attacker can inject arbitrary web scripts into pages.
- These scripts execute when a user interacts with the affected page (e.g., clicks a link).
- Successful exploitation can lead to various malicious actions, including:
    - Redirecting users to malicious sites.
    - Stealing session cookies.
    - Defacing the website.
    - Performing actions on behalf of the victim user.

**Attack Vectors:**
- Network-based attacks

**Required Attacker Capabilities/Position:**
- An attacker needs to be able to inject malicious scripts via the `id` parameter.
- The vulnerability is triggered when a user loads a page where the malicious script was injected.
- Contributor+ access is required.

**Additional Information:**
- The vulnerability exists in the OSM Map Widget for Elementor WordPress plugin.
- The affected versions are 1.2.2 and earlier.
- The vulnerability is fixed in version 1.3.0.
- The vulnerability is present in the `osm-map.php` file, specifically around line 1478.
- The Wordfence report indicates the vulnerability is stored XSS, not reflected. The description incorrectly states it is reflected. This implies the payload is saved within the database and re-executed upon page load.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.575 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.531 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.518 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.484 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.420 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.419 |
| 7 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.411 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.407 |
| 9 | 91 | XML Injection (aka Blind XPath Injection) | Base | Allowed | dense | 0.492 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-138: Improper Neutralization of Special Elements

CWE-116: Improper Encoding or Escaping of Output

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-862: Missing Authorization

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-502: Deserialization of Untrusted Data

CWE-91: XML Injection (aka Blind XPath Injection)

CWE-494: Download of Code Without Integrity Check