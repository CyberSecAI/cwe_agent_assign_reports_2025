# Raw Retriever Results for CVE-2024-43887

# Raw Retriever Results for CVE-2024-43887
## Query
In the Linux kernel, the following vulnerability has been resolved net/tcp Disable TCP-AO static key after RCU grace period The lifetime of TCP-AO static_key is the same as the last tcp_ao_info. On the socket destruction tcp_ao_info ceases to be with RCU grace period, while tcp-ao static branch is currently deferred destructed. The static key definition is DEFINE_STATIC_KEY_DEFERRED_FALSE(tcp_ao_needed, HZ) which means that if RCU grace period is delayed by more than a second and tcp_ao_needed is in the process of disablement, other CPUs may yet see tcp_ao_info which atent dead, but soon-to-be. And that breaks the assumption of static_key_fast_inc_not_disabled(). See the comment near the definition > * The caller must make sure that the static key cant get disabled while > * in this function. It doesnt patch jump labels, only adds a user to > * an already enabled static key. Originally it was introduced in commit eb8c507296f6 (jump_label Prevent key->enabled int overflow), which is needed for the atomic contexts, one of which would be the creation of a full socket from a request socket. In that atomic context, its known by the presence of the key (md5/ao) that the static branch is already enabled. So, the ref counter for that static branch is just incremented instead of holding the proper mutex. static_key_fast_inc_not_disabled() is just a helper for such usage case. But it must not be used if the static branch could get disabled in parallel as its not prote

## Keyphrases
- **rootcause**: 'improper use of static key'
- **weakness**: 'overflow'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3872 | 0.4360 | 0.4051 | 0.4067 | 20 |
| Sparse | 700.0000 | 1179.8327 | 1039.0040 | 1130.8504 | 15 |
| Graph | 1.3600 | 2.6827 | 1.6825 | 1.6221 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 259 | Use of Hard-coded Password | variant | 2.6827 | Allowed |
| 2 | 208 | Observable Timing Discrepancy | base | 2.2100 | Allowed |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | base | 2.1190 | Allowed |
| 4 | 472 | External Control of Assumed-Immutable Web Parameter | base | 1.7680 | Allowed |
| 5 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 6 | 826 | Premature Release of Resource During Expected Lifetime | base | 1.6848 | Allowed |
| 7 | 562 | Return of Stack Variable Address | base | 1.6848 | Allowed |
| 8 | 1341 | Multiple Releases of Same Resource or Handle | base | 1.6848 | Allowed |
| 9 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 1.6848 | Allowed |
| 10 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 1.6247 | Allowed |
| 11 | 1231 | Improper Prevention of Lock Bit Modification | Base | 1.6195 | Allowed |
| 12 | 1204 | Generation of Weak Initialization Vector (IV) | Base | 1.5748 | Allowed |
| 13 | 1291 | Public Key Re-Use for Signing both Debug and Production Code | base | 1.5210 | Allowed |
| 14 | 301 | Reflection Attack in an Authentication Protocol | base | 1.5210 | Allowed |
| 15 | 772 | Missing Release of Resource after Effective Lifetime | Base | 1.4965 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 911 | Improper Update of Reference Count | Base | 0.4360 | 0.4360 | Allowed |
| 2 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4255 | 0.4255 | Allowed |
| 3 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4195 | 0.4195 | Allowed |
| 4 | 606 | Unchecked Input for Loop Condition | Base | 0.4181 | 0.4181 | Allowed |
| 5 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.4164 | 0.4164 | Allowed |
| 6 | 1422 | Exposure of Sensitive Information caused by Incorrect Data Forwarding during Transient Execution | Base | 0.4154 | 0.4154 | Allowed |
| 7 | 1394 | Use of Default Cryptographic Key | Base | 0.4150 | 0.4150 | Allowed |
| 8 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4149 | 0.4149 | Allowed |
| 9 | 833 | Deadlock | Base | 0.4123 | 0.4123 | Allowed |
| 10 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4088 | 0.4088 | Allowed |
| 11 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4046 | 0.4046 | Allowed |
| 12 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | 0.3968 | 0.3968 | Allowed |
| 13 | 321 | Use of Hard-coded Cryptographic Key | Variant | 0.3922 | 0.3922 | Allowed |
| 14 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.3914 | 0.3914 | Allowed-with-Review |
| 15 | 667 | Improper Locking | Class | 0.3903 | 0.3903 | Allowed-with-Review |

## Sparse Retriever Results (15)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 321 | Use of Hard-coded Cryptographic Key | 1179.8327 | 1179.8327 | Allowed |
| 2 | 1204 | Generation of Weak Initialization Vector (IV) | 1175.5223 | 1175.5223 | Allowed |
| 3 | 1391 | Use of Weak Credentials | 1167.6684 | 1167.6684 | Allowed-with-Review |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | 1150.2934 | 1150.2934 | Allowed |
| 5 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 1141.2499 | 1141.2499 | Allowed-with-Review |
| 6 | 863 | Incorrect Authorization | 1138.9629 | 1138.9629 | Allowed-with-Review |
| 7 | 287 | Improper Authentication | 1136.4605 | 1136.4605 | Discouraged |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 1130.8504 | 1130.8504 | Allowed |
| 9 | 203 | Observable Discrepancy | 1120.7080 | 1120.7080 | Allowed |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | 1118.6493 | 1118.6493 | Allowed |
| 11 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 1024.8622 | 1024.8622 | Allowed-with-Review |
| 12 | 190 | Integer Overflow or Wraparound | 1000.0000 | 1000.0000 | Allowed |
| 13 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 700.0000 | 700.0000 | Discouraged |
| 14 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | 700.0000 | 700.0000 | Allowed-with-Review |
| 15 | 121 | Stack-based Buffer Overflow | 700.0000 | 700.0000 | Allowed |
