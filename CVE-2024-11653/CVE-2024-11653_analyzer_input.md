# Vulnerability Information: CVE-2024-11653

## Vulnerability Description
A vulnerability was found in EnGenius ENH1350EXT, ENS500-AC and ENS620EXT up to 20241118. It has been rated as critical. Affected by this issue is some unknown functionality of the file /admin/network/diag_traceroute. The manipulation of the argument diag_traceroute leads to **command injection**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** EnGenius ENH1350EXT and ENS500-AC and ENS620EXT
- **version:** up to 20241118
- **component:** /admin/network/diag_traceroute

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-79

#### Top CWEs
- CWE-79 (Count: 22)
- CWE-77 (Count: 12)
- CWE-89 (Count: 11)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The `diag_traceroute` parameter in the `/admin/network/diag_traceroute` interface of ENGENIUS routers is vulnerable to command injection. The user-supplied value for `diag_traceroute` is directly passed to the `diag_command` function without sanitization, allowing arbitrary commands to be executed.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability due to lack of input sanitization.
- **Impact of exploitation:** Successful exploitation allows an attacker to execute arbitrary system commands with the privileges of the web server, potentially gaining complete control of the device.
- **Attack vectors:** HTTP GET request to the `/cgi-bin/luci/.../admin/network/diag_traceroute/` endpoint with a crafted `diag_traceroute` parameter containing shell commands.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to access the web interface of the router.
    - The attacker must be logged into the device as an administrator to access the vulnerable interface.
    - The attacker can inject commands by crafting an HTTP request with a malicious `diag_traceroute` parameter.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.517 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.484 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.420 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.403 |
| 7 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.402 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.401 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.635 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

