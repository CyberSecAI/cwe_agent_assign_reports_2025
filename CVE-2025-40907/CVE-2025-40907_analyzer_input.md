# Vulnerability Information: CVE-2025-40907

## Vulnerability Description
FCGI versions 0.44 through 0.82, for Perl, include a vulnerable version of the FastCGI fcgi2 (aka fcgi) library. The included FastCGI library is affected by CVE-2025-23016, causing an integer overflow (and resultant heap-based buffer overflow) via crafted nameLen or valueLen values in data to the IPC socket. This occurs in ReadParams in fcgiapp.c.

### Vulnerability Description Key Phrases
- **component:** ReadParams in fcgiapp.c
- **vector:** crafted nameLen or valueLen values in data to the IPC socket
- **weakness:** **integer overflow, heap-based buffer overflow**
- **product:** FCGI
- **version:** 0.44 through 0.82

## CVE Reference Links Content Summary
## Analysis of CVE-2025-23016 based on provided content:

**CVE Description:** The provided content does not contain the official CVE description.

**Root cause of vulnerability:** An integer overflow in the `ReadParams` function of `fcgiapp.c` when processing `nameLen` and `valueLen` values received via the FastCGI protocol. Specifically, if `nameLen` and `valueLen` are equal to `0x7fffffff`, adding 2 during the `malloc` call on a 32-bit architecture results in an integer overflow, leading to a small allocation size.

**Weaknesses/vulnerabilities present:**
*   Integer Overflow: The lack of proper validation of input lengths leads to an integer overflow.
*   Heap Overflow: The integer overflow results in a heap-based buffer overflow when `FCGX_GetStr` is called with an incorrect size.

**Impact of exploitation:**
*   Potential for arbitrary code execution. The exploit allows overwriting memory on the heap, potentially leading to control of the program's execution flow.
*   The vulnerability is more easily exploitable on 32-bit architectures.

**Attack vectors:**
*   Crafted FastCGI requests with large `nameLen` and `valueLen` values.
*   Requires the FastCGI socket to be exposed (e.g., not configured as a UNIX socket).

**Required attacker capabilities/position:**
*   Ability to send crafted FastCGI requests to the server.
*   Knowledge of the FastCGI protocol and the vulnerable code.
*   Network access to the FastCGI socket.

**Mitigation or fix:**
*   Upgrade to FastCGI version 2.4.5 or later, which includes a fix for CVE-2025-23016.
*   Limit remote access to the FastCGI socket by configuring it as a UNIX socket.
*   The patch adds checks to ensure `nameLen` and `valueLen` are less than `INT_MAX` before allocating memory.

**Additional Details (compared to a potential official CVE description):**

*   The provided content includes a detailed explanation of the vulnerability, including the specific code involved and the steps to exploit it.
*   It provides a proof-of-concept exploit.
*   It discusses the impact of the vulnerability in the context of embedded systems and the importance of system protections like ASLR.
*   It details the specific conditions required for successful exploitation.
*   It provides information about the vulnerability's discovery and reporting process.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.360 |
| 4 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.343 |
| 5 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.339 |
| 6 | 681 | Incorrect Conversion between Numeric Types | Base | Allowed | sparse | 0.339 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.335 |
| 8 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.322 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.548 |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | graph | 0.003 |

