{
  "cve_id": "CVE-2024-10937",
  "description": "The Related Posts, Inline Related Posts, Contextual Related Posts, Related Content By PickPlugins plugin for WordPress is vulnerable to **Sensitive Information Exposure** in all versions up to, and including, 2.0.58 via the wp_ajax_nopriv_related_post_ajax_get_post_ids AJAX action. This makes it possible for unauthenticated attackers to extract sensitive data including titles of posts in draft status.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "Sensitive Information Exposure",
    "impact": "extract sensitive data including titles of posts in draft status",
    "vector": "",
    "attacker": "unauthenticated attackers",
    "product": [
      "Related Posts",
      "Inline Related Posts",
      "Contextual Related Posts",
      "Related Content By PickPlugins plugin for WordPress"
    ],
    "version": "all versions up to and including 2.0.58",
    "component": "wp_ajax_nopriv_related_post_ajax_get_post_ids AJAX action"
  },
  "reference_content": "Based on the provided information, here's a breakdown of the vulnerability:\n\n**CVE ID:** CVE-2024-10937\n\n**Root Cause of Vulnerability:**\nThe vulnerability stems from improper access control in the `related_post_ajax_get_post_ids` AJAX action. This action was accessible to unauthenticated users due to the use of `wp_ajax_nopriv_`.\n\n**Weaknesses/Vulnerabilities Present:**\n- **Improper Access Control:** The AJAX action `related_post_ajax_get_post_ids` lacked proper authentication checks, making it accessible to unauthenticated users.\n- **Sensitive Information Exposure:** The vulnerable function allowed retrieval of data, including titles of posts, even if the posts were in draft status.\n\n**Impact of Exploitation:**\n- **Information Disclosure:** An attacker could retrieve sensitive information about unpublished content, specifically the titles of draft posts. This could reveal information that was intended to be kept private.\n\n**Attack Vectors:**\n- **Network:** The vulnerability is accessible remotely over the network.\n- **Unauthenticated Access:**  An attacker does not need to be logged in or have any specific user privileges to exploit the vulnerability.\n\n**Required Attacker Capabilities/Position:**\n- The attacker needs to be able to send a request to the vulnerable AJAX endpoint (`wp_ajax_nopriv_related_post_ajax_get_post_ids`). No other special capabilities are required.\n\n**Additional details:**\n- The vulnerability was fixed by removing the `wp_ajax_nopriv_` action hook for `related_post_ajax_get_post_ids`, effectively restricting access to authenticated users with the 'manage_options' capability.\n- The affected plugin is \"Related Posts, Inline Related Posts, Contextual Related Posts, Related Content By PickPlugins\" versions up to and including 2.0.58\n- The vulnerability was patched in version 2.0.59",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-862 | Missing Authorization | 1.0 | Class | Primary | Allowed-with-Review |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.9 | Class | Secondary | Discouraged |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.95\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-862 [**Missing Authorization**], which is a Class-level CWE. While it would be ideal to find a more specific Base or Variant CWE, the description explicitly mentions the absence of authorization checks, making this the most fitting choice. CWE-200 [**Exposure of Sensitive Information to an Unauthorized Actor**] is a consequence of the missing authorization. Thus, CWE-862 CanPrecede CWE-200.\n\n```mermaid\ngraph TD\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    \n    cwe862 -->|CANPRECEDE| cwe200\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe862 primary\n    class cwe200 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **Missing Authorization** (CWE-862) on an AJAX action, leading to **Sensitive Information Exposure** (CWE-200), specifically the titles of draft posts.\n\n## Summary of Analysis\nThe initial analysis identified that the root cause of the vulnerability is the **missing authorization** on the `wp_ajax_nopriv_related_post_ajax_get_post_ids` AJAX action. This allows unauthenticated attackers to access sensitive information, namely the titles of posts in draft status.\n\nThe evidence strongly supports the selection of CWE-862 [**Missing Authorization**] as the primary weakness. The CVE Reference Links Content Summary explicitly states: \"The vulnerability stems from improper access control... This action was accessible to unauthenticated users due to the use of `wp_ajax_nopriv_`.\" Further, it notes, \"**Improper Access Control**: The AJAX action `related_post_ajax_get_post_ids` lacked proper authentication checks, making it accessible to unauthenticated users.\"\n\nCWE-200 [**Exposure of Sensitive Information to an Unauthorized Actor**] is a secondary weakness as it describes the impact of the **missing authorization**. The vulnerability description states that it makes it \"possible for unauthenticated attackers to extract sensitive data including titles of posts in draft status.\"\n\nI considered other CWEs from the Retriever Results, such as CWE-863 [**Incorrect Authorization**], but it is less appropriate because the primary issue is not an incorrect authorization check but the complete absence of one.\n\nCWE-352 [**Cross-Site Request Forgery (CSRF)**] was also considered, but it does not fit the vulnerability description because there's no mention or indication of CSRF being involved.\n\nCWE-201 [**Insertion of Sensitive Information Into Sent Data**] was also considered, but is less appropriate than CWE-200 as it describes a scenario where sensitive data is *included* within a larger dataset being sent, whereas this vulnerability is about exposing sensitive information directly due to lack of access control.\n\nThe selected CWEs are at the optimal level of specificity, with CWE-862 directly addressing the **missing authorization** and CWE-200 describing the resulting **sensitive information exposure**.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-862 | Missing Authorization | 1.0 | Class | Primary | Allowed-with-Review |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.9 | Class | Secondary | Discouraged |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.95\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-862 [**Missing Authorization**], which is a Class-level CWE. While it would be ideal to find a more specific Base or Variant CWE, the description explicitly mentions the absence of authorization checks, making this the most fitting choice. CWE-200 [**Exposure of Sensitive Information to an Unauthorized Actor**] is a consequence of the missing authorization. Thus, CWE-862 CanPrecede CWE-200.\n\n```mermaid\ngraph TD\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    \n    cwe862 -->|CANPRECEDE| cwe200\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe862 primary\n    class cwe200 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with **Missing Authorization** (CWE-862) on an AJAX action, leading to **Sensitive Information Exposure** (CWE-200), specifically the titles of draft posts.\n\n## Summary of Analysis\nThe initial analysis identified that the root cause of the vulnerability is the **missing authorization** on the `wp_ajax_nopriv_related_post_ajax_get_post_ids` AJAX action. This allows unauthenticated attackers to access sensitive information, namely the titles of posts in draft status.\n\nThe evidence strongly supports the selection of CWE-862 [**Missing Authorization**] as the primary weakness. The CVE Reference Links Content Summary explicitly states: \"The vulnerability stems from improper access control... This action was accessible to unauthenticated users due to the use of `wp_ajax_nopriv_`.\" Further, it notes, \"**Improper Access Control**: The AJAX action `related_post_ajax_get_post_ids` lacked proper authentication checks, making it accessible to unauthenticated users.\"\n\nCWE-200 [**Exposure of Sensitive Information to an Unauthorized Actor**] is a secondary weakness as it describes the impact of the **missing authorization**. The vulnerability description states that it makes it \"possible for unauthenticated attackers to extract sensitive data including titles of posts in draft status.\"\n\nI considered other CWEs from the Retriever Results, such as CWE-863 [**Incorrect Authorization**], but it is less appropriate because the primary issue is not an incorrect authorization check but the complete absence of one.\n\nCWE-352 [**Cross-Site Request Forgery (CSRF)**] was also considered, but it does not fit the vulnerability description because there's no mention or indication of CSRF being involved.\n\nCWE-201 [**Insertion of Sensitive Information Into Sent Data**] was also considered, but is less appropriate than CWE-200 as it describes a scenario where sensitive data is *included* within a larger dataset being sent, whereas this vulnerability is about exposing sensitive information directly due to lack of access control.\n\nThe selected CWEs are at the optimal level of specificity, with CWE-862 directly addressing the **missing authorization** and CWE-200 describing the resulting **sensitive information exposure**.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-862:**\n- 862 (Missing Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 310.7884436149637
    },
    {
      "metadata": {
        "doc_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "source": "sparse"
      },
      "similarity": 307.80947521586256
    },
    {
      "metadata": {
        "doc_id": "862",
        "name": "Missing Authorization",
        "source": "sparse"
      },
      "similarity": 305.03532726414886
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 300.4956215744057
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 286.63886859516
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 278.7473560505294
    },
    {
      "metadata": {
        "doc_id": "266",
        "name": "Incorrect Privilege Assignment",
        "source": "sparse"
      },
      "similarity": 276.08869225768257
    },
    {
      "metadata": {
        "doc_id": "24",
        "name": "Path Traversal: '../filedir'",
        "source": "sparse"
      },
      "similarity": 275.44561069953454
    },
    {
      "metadata": {
        "doc_id": "96",
        "name": "Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')",
        "type": "Base",
        "original_content": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes code syntax before inserting the input into an executable resource, such as a library, configuration file, or template.",
        "keyphrase_source": "weakness:Sensitive Information Exposure",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5215404116373792,
            "sparse": 91.99133182379347
          }
        }
      },
      "similarity": 0.5215404116373792
    },
    {
      "doc_id": "434",
      "text": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
      "score": 0.5429725041705007,
      "metadata": {
        "doc_id": "434",
        "name": "Unrestricted Upload of File with Dangerous Type",
        "type": "Base",
        "extended_description": null,
        "alternate_terms": [
          "Unrestricted File Upload"
        ],
        "original_content": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
        "relationships": [
          {
            "source_id": "434",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "183",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "430",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "436",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "351",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "669",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "434",
            "target_id": "669",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "669",
            "target_id": "434",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "430",
            "target_id": "434",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "183",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "source": "graph",
        "sources": [
          "vector",
          "graph"
        ],
        "vector_score": 0.5429725041705007,
        "graph_score": 3.4866,
        "score_components": {
          "relationship_chain": 0.6,
          "explicit_mention": 1.0,
          "abstraction_path": 0.9,
          "sequence_path": 0.6400000000000001
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "863",
                  "942",
                  "PARENTOF"
                ],
                [
                  "942",
                  "183",
                  "CHILDOF"
                ],
                [
                  "183",
                  "434",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.6,
              "type": "relationship_chain",
              "source": "863"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "425",
                  "98",
                  "CANPRECEDE"
                ],
                [
                  "98",
                  "73",
                  "CANFOLLOW"
                ],
                [
                  "73",
                  "434",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.6400000000000001,
              "type": "vulnerability_sequence_forward",
              "source": "425"
            }
          }
        },
        "is_explicit": true,
        "abstraction_level": "base",
        "position": "after",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.4971846391502305,
            "graph": 2.3091490016682
          }
        }
      },
      "similarity": 2.3091490016682
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-862",
      "CWE-201",
      "CWE-352",
      "CWE-200"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}