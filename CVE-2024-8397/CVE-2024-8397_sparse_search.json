{
  "retriever": "sparse",
  "query": "The webtoffee-gdpr-cookie-consent WordPress plugin before 2.6.1 does not properly sanitize and escape the IP headers when logging them, allowing visitors to conduct Stored Cross-Site Scripting attacks. The payload gets triggered when an admin visits the Consent report page and the malicious script is executed in the admin context.",
  "keyphrases": {
    "rootcause": [
      "does not properly sanitize",
      "escape the IP headers"
    ],
    "weakness": [
      "Cross-Site Scripting"
    ]
  },
  "timestamp": "2025-07-14 03:43:21",
  "cve_id": "CVE-2024-8397",
  "result_count": 14,
  "results": [
    {
      "cwe_id": "352",
      "name": "Cross-Site Request Forgery (CSRF)",
      "score": 428.0712337807659,
      "search_source": "rootcause:escape the IP headers"
    },
    {
      "cwe_id": "116",
      "name": "Improper Encoding or Escaping of Output",
      "score": 380.4053481019707,
      "search_source": "rootcause:does not properly sanitize"
    },
    {
      "cwe_id": "79",
      "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "score": 371.0863334848669,
      "search_source": "weakness:Cross-Site Scripting"
    },
    {
      "cwe_id": "138",
      "name": "Improper Neutralization of Special Elements",
      "score": 359.9521278092448,
      "search_source": "rootcause:does not properly sanitize"
    },
    {
      "cwe_id": "434",
      "name": "Unrestricted Upload of File with Dangerous Type",
      "score": 341.8747944398706,
      "search_source": "rootcause:does not properly sanitize"
    },
    {
      "cwe_id": "862",
      "name": "Missing Authorization",
      "score": 319.7722124074828,
      "search_source": "rootcause:does not properly sanitize"
    },
    {
      "cwe_id": "93",
      "name": "Improper Neutralization of CRLF Sequences ('CRLF Injection')",
      "score": 308.24692030567445,
      "search_source": "rootcause:escape the IP headers"
    },
    {
      "cwe_id": "90",
      "name": "Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')",
      "score": 304.0328910215223,
      "search_source": "rootcause:does not properly sanitize"
    },
    {
      "cwe_id": "89",
      "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
      "score": 303.66347148128233,
      "search_source": "rootcause:escape the IP headers"
    },
    {
      "cwe_id": "113",
      "name": "Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')",
      "score": 302.8002371485731,
      "search_source": "rootcause:escape the IP headers"
    },
    {
      "cwe_id": "942",
      "name": "Permissive Cross-domain Policy with Untrusted Domains",
      "score": 300.2039273680027,
      "search_source": "weakness:Cross-Site Scripting"
    },
    {
      "cwe_id": "644",
      "name": "Improper Neutralization of HTTP Headers for Scripting Syntax",
      "score": 298.4167477158673,
      "search_source": "rootcause:escape the IP headers"
    },
    {
      "cwe_id": "80",
      "name": "Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)",
      "score": 298.15070079309334,
      "search_source": "weakness:Cross-Site Scripting"
    },
    {
      "cwe_id": "472",
      "name": "External Control of Assumed-Immutable Web Parameter",
      "score": 91.45914806734109,
      "search_source": "base_query"
    }
  ]
}