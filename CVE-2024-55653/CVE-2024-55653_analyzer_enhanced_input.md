## Vulnerability Description
PwnDoc is a penetration test report generator. In versions up to and including 0.5.3, an authenticated user is able to crash the backend by raising a `**UnhandledPromiseRejection**` on audits which exits the backend. The user doesnt need to know the audit id, since a bad audit id will also raise the rejection. With the backend being unresponsive, the whole application becomes unusable for all users of the application. As of time of publication, no known patches are available.

### Vulnerability Description Key Phrases
- **weakness:** **UnhandledPromiseRejection**
- **impact:** crash the backend
- **vector:** raising a `UnhandledPromiseRejection` on audits
- **attacker:** authenticated user
- **product:** PwnDoc
- **version:** up to and including 0.5.3

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The application's backend does not handle promise rejections properly in asynchronous functions, specifically in the `audit.js` route. When a promise is rejected without a corresponding `.catch()` or error handler, it leads to an `UnhandledPromiseRejection` which causes the backend to crash.
- **Weaknesses/vulnerabilities present**: Lack of error handling in asynchronous functions within the audit route. Specifically, the identified vulnerable endpoints within `backend/src/routes/audit.js` lack proper error handling for promise rejections.
- **Impact of exploitation**: A successful exploit results in a denial-of-service (DoS) condition, rendering the application unusable for all users due to the backend crashing.
- **Attack vectors**: Network-based attacks, where an attacker sends malicious HTTP requests to specific API endpoints.
- **Required attacker capabilities/position**: An attacker must be an authenticated user with the ability to make API requests. The attacker doesn't need to know a valid audit ID, as the vulnerability can be triggered with a bad ID as well.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.400 |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.399 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.399 |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.392 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.392 |
| 6 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.385 |
| 7 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.380 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.379 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.413 |
| 10 | 215 | Insertion of Sensitive Information Into Debugging Code | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-918: Server-Side Request Forgery (SSRF)

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-532: Insertion of Sensitive Information into Log File

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-502: Deserialization of Untrusted Data

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-215: Insertion of Sensitive Information Into Debugging Code