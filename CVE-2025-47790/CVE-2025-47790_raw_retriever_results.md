# Raw Retriever Results for CVE-2025-47790

# Raw Retriever Results for CVE-2025-47790
## Query
Nextcloud Server is a self hosted personal cloud system. Nextcloud Server prior to 29.0.15, 30.0.9, and 31.0.3 and Nextcloud Enterprise Server prior to 26.0.13.15, 27.1.11.15, 28.0.14.6, 29.0.15, 30.0.9, and 31.0.3 have a bug with session handling. The bug caused skipping the second factor confirmation after a successful login with the username and password when the server was configured with `remember_login_cookie_lifetime` set to `0`, once the session expired on the page to select the second factor and the page is reloaded. Nextcloud Server 29.0.15, 30.0.9, and 31.0.3 and Nextcloud Enterprise Server is upgraded to 26.0.13.15, 27.1.11.15, 28.0.14.6, 29.0.15, 30.0.9 and 31.0.3 contain a patch. As a workaround, set the `remember_login_cookie_lifetime` in config.php to a value other than `0`, e.g. `900`. Beware that this is only a workaround for new sessions created after the configuration change. System administration can delete affected sessions.

## Keyphrases
- **rootcause**: 'bug with session handling'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4234 | 0.4847 | 0.4466 | 0.4381 | 20 |
| Sparse | 947.2278 | 1082.0909 | 981.2362 | 970.1864 | 10 |
| Graph | 1.2880 | 2.4436 | 1.7162 | 1.5655 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 613 | Insufficient Session Expiration | Base | 2.4436 | Allowed |
| 2 | 209 | Generation of Error Message Containing Sensitive Information | Base | 2.3802 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 2.3711 | Allowed |
| 4 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 5 | 756 | Missing Custom Error Page | base | 2.2100 | Allowed |
| 6 | 600 | Uncaught Exception in Servlet  | variant | 2.0400 | Allowed |
| 7 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.8394 | Allowed |
| 8 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.6320 | Allowed |
| 9 | 532 | Insertion of Sensitive Information into Log File | Base | 1.6273 | Allowed |
| 10 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.6100 | Allowed |
| 11 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 12 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.5210 | Allowed |
| 13 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 1.5081 | Allowed |
| 14 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 1.4421 | Allowed |
| 15 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.4040 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | 0.4847 | 0.4847 | Allowed |
| 2 | 613 | Insufficient Session Expiration | Base | 0.4790 | 0.4790 | Allowed |
| 3 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | 0.4776 | 0.4776 | Allowed |
| 4 | 384 | Session Fixation | Compound | 0.4746 | 0.4746 | Allowed |
| 5 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | 0.4678 | 0.4678 | Allowed |
| 6 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | 0.4655 | 0.4655 | Allowed |
| 7 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | 0.4604 | 0.4604 | Allowed |
| 8 | 307 | Improper Restriction of Excessive Authentication Attempts | Base | 0.4525 | 0.4525 | Allowed |
| 9 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.4466 | 0.4466 | Allowed |
| 10 | 287 | Improper Authentication | Class | 0.4444 | 0.4444 | Discouraged |
| 11 | 565 | Reliance on Cookies without Validation and Integrity Checking | Base | 0.4318 | 0.4318 | Allowed |
| 12 | 209 | Generation of Error Message Containing Sensitive Information | Base | 0.4312 | 0.4312 | Allowed |
| 13 | 603 | Use of Client-Side Authentication | Base | 0.4300 | 0.4300 | Allowed |
| 14 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4298 | 0.4298 | Allowed |
| 15 | 539 | Use of Persistent Cookies Containing Sensitive Information | Variant | 0.4294 | 0.4294 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1390 | Weak Authentication | 1082.0909 | 1082.0909 | Allowed-with-Review |
| 2 | 532 | Insertion of Sensitive Information into Log File | 1019.9188 | 1019.9188 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 983.6206 | 983.6206 | Allowed |
| 4 | 209 | Generation of Error Message Containing Sensitive Information | 979.8597 | 979.8597 | Allowed |
| 5 | 863 | Incorrect Authorization | 975.9651 | 975.9651 | Allowed-with-Review |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | 964.4077 | 964.4077 | Allowed |
| 7 | 23 | Relative Path Traversal | 954.8687 | 954.8687 | Allowed |
| 8 | 287 | Improper Authentication | 952.9448 | 952.9448 | Discouraged |
| 9 | 400 | Uncontrolled Resource Consumption | 951.4580 | 951.4580 | Discouraged |
| 10 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 947.2278 | 947.2278 | Allowed |
