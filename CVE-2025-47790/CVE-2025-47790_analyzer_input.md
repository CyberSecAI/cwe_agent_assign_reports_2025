# Vulnerability Information: CVE-2025-47790

## Vulnerability Description
Nextcloud Server is a self hosted personal cloud system. Nextcloud Server prior to 29.0.15, 30.0.9, and 31.0.3 and Nextcloud Enterprise Server prior to 26.0.13.15, 27.1.11.15, 28.0.14.6, 29.0.15, 30.0.9, and 31.0.3 have a **bug with session handling**. The bug caused skipping the second factor confirmation after a successful login with the username and password when the server was configured with `remember_login_cookie_lifetime` set to `0`, once the session expired on the page to select the second factor and the page is reloaded. Nextcloud Server 29.0.15, 30.0.9, and 31.0.3 and Nextcloud Enterprise Server is upgraded to 26.0.13.15, 27.1.11.15, 28.0.14.6, 29.0.15, 30.0.9 and 31.0.3 contain a patch. As a workaround, set the `remember_login_cookie_lifetime` in config.php to a value other than `0`, e.g. `900`. Beware that this is only a workaround for new sessions created after the configuration change. System administration can delete affected sessions.

### Vulnerability Description Key Phrases
- **rootcause:** **bug with session handling**
- **product:** Nextcloud Server, Nextcloud Enterprise Server
- **impact:** skipping second factor confirmation
- **version:** prior to 29.0.15, 30.0.9, and 31.0.3 and Nextcloud Enterprise Server prior to 26.0.13.15, 27.1.11.15, 28.0.14.6, 29.0.15, 30.0.9, and 31.0.3

## CVE Reference Links Content Summary
```text
* Root cause of vulnerability: A bug in the session handling caused skipping the second factor confirmation after a successful login with the username and password when the server was configured with `remember_login_cookie_lifetime` set to `0`, once the session expired on the page to select the second factor and the page is reloaded.
* Weaknesses/vulnerabilities present: The vulnerability is categorized as CWE-287.
* Impact of exploitation: Skipping the second factor confirmation. Confidentiality and Integrity are High. Availability is None.
* Attack vectors: The vulnerability is exploitable over the Network.
* Required attacker capabilities/position: The attacker needs Low privileges and User interaction is Required.
* Mitigation or fix: It is recommended that the Nextcloud Server is upgraded to 29.0.15, 30.0.9 or 31.0.3. It is recommended that the Nextcloud Enterprise Server is upgraded to 26.0.13.15, 27.1.11.15, 28.0.14.6, 29.0.15, 30.0.9 or 31.0.3. Workarounds: Set the `remember_login_cookie_lifetime` in config.php to a value other than `0`, e.g. `900`. System administration can delete affected sessions listed by the database query provided in the document.
* Additional detail: The content provides more detail than the official CVE description. The content provides the package affected, affected versions, patched versions, a description, workarounds, severity, CVSS v3 base metrics and a CVE ID.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 1.082 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 1.020 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.984 |
| 4 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.980 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.976 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.964 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.955 |
| 8 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.953 |
| 9 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | dense | 0.485 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

