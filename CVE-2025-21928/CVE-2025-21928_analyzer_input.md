# Vulnerability Information: CVE-2025-21928

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved HID intel-ish-hid Fix **use-after-free** issue in ishtp_hid_remove() The system can experience a random crash a few minutes after the driver is removed. This issue occurs due to **improper handling of memory freeing** in the ishtp_hid_remove() function. The function currently frees the `driver_data` directly within the loop that destroys the HID devices, which can lead to accessing freed memory. Specifically, `hid_destroy_device()` uses `driver_data` when it calls `hid_ishtp_set_feature()` to power off the sensor, so freeing `driver_data` beforehand can result in accessing invalid memory. This patch resolves the issue by storing the `driver_data` in a temporary variable before calling `hid_destroy_device()`, and then freeing the `driver_data` after the device is destroyed.

### Vulnerability Description Key Phrases
- **rootcause:** **improper handling of memory freeing**
- **weakness:** **use-after-free**
- **impact:** random crash
- **product:** Linux kernel
- **component:** ishtp_hid_remove() function

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 416 | Use After Free | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.738 |
| 3 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.659 |
| 4 | 415 | Double Free | Variant | Allowed | sparse | 0.659 |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.632 |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.630 |
| 7 | 682 | Incorrect Calculation | Pillar | Discouraged | sparse | 0.612 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.610 |
| 9 | 908 | Use of Uninitialized Resource | Base | Allowed | dense | 0.526 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.003 |

