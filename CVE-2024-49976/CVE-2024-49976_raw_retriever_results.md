# Raw Retriever Results for CVE-2024-49976

# Raw Retriever Results for CVE-2024-49976
## Query
In the Linux kernel, the following vulnerability has been resolved tracing/timerlat Drop interface_lock in stop_kthread() stop_kthread() is the offline callback for trace/osnoiseonline, since commit 5bfbcd1ee57b (tracing/timerlat Add interface_lock around clearing of kthread in stop_kthread()), the following ABBA deadlock scenario is introduced T1 | T2 [BP] | T3 [AP] osnoise_hotplug_workfn() | work_for_cpu_fn() | cpuhp_thread_fun() | _cpu_down() | osnoise_cpu_die() mutex_lock(&interface_lock) | | stop_kthread() | cpus_write_lock() | mutex_lock(&interface_lock) cpus_read_lock() | cpuhp_kick_ap() | As the interface_lock here in just for protecting the kthread field of the osn_var, use xchg() instead to fix this issue. Also use for_each_online_cpu() back in stop_per_cpu_kthreads() as it can take cpu_read_lock() again.

## Keyphrases
- **rootcause**: 'ABBA deadlock scenario'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4231 | 0.5415 | 0.4487 | 0.4390 | 20 |
| Sparse | 104.5379 | 351.1892 | 290.0660 | 316.0531 | 12 |
| Graph | 1.6100 | 2.8652 | 1.9661 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 2 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.3296 | Allowed |
| 4 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 5 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 6 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 7 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | base | 2.2100 | Allowed |
| 8 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 2.0395 | Allowed |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 11 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 12 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 13 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 14 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 15 | 833 | Deadlock | Base | 1.7182 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5415 | 0.5415 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4855 | 0.4855 | Allowed-with-Review |
| 3 | 667 | Improper Locking | Class | 0.4811 | 0.4811 | Allowed-with-Review |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4617 | 0.4617 | Allowed |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4540 | 0.4540 | Allowed |
| 6 | 413 | Improper Resource Locking | Base | 0.4523 | 0.4523 | Allowed |
| 7 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4516 | 0.4516 | Allowed |
| 8 | 366 | Race Condition within a Thread | Base | 0.4511 | 0.4511 | Allowed |
| 9 | 416 | Use After Free | Variant | 0.4416 | 0.4416 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4397 | 0.4397 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4383 | 0.4383 | Allowed |
| 12 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4365 | 0.4365 | Allowed |
| 13 | 911 | Improper Update of Reference Count | Base | 0.4350 | 0.4350 | Allowed |
| 14 | 909 | Missing Initialization of Resource | Class | 0.4348 | 0.4348 | Allowed-with-Review |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4346 | 0.4346 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 833 | Deadlock | 351.1892 | 351.1892 | Allowed |
| 2 | 667 | Improper Locking | 349.0914 | 349.0914 | Allowed-with-Review |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 337.2829 | 337.2829 | Allowed |
| 4 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 333.6333 | 333.6333 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 325.5007 | 325.5007 | Allowed-with-Review |
| 6 | 125 | Out-of-bounds Read | 316.2201 | 316.2201 | Allowed |
| 7 | 1333 | Inefficient Regular Expression Complexity | 315.8862 | 315.8862 | Allowed |
| 8 | 1284 | Improper Validation of Specified Quantity in Input | 315.2529 | 315.2529 | Allowed |
| 9 | 674 | Uncontrolled Recursion | 313.9579 | 313.9579 | Allowed-with-Review |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | 313.6952 | 313.6952 | Allowed |
| 11 | 59 | Improper Link Resolution Before File Access ('Link Following') | 104.5437 | 104.5437 | Allowed |
| 12 | 319 | Cleartext Transmission of Sensitive Information | 104.5379 | 104.5379 | Allowed |
