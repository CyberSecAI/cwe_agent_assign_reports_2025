{
  "cve_id": "CVE-2024-50188",
  "description": "In the Linux kernel, the following vulnerability has been resolved net phy dp83869 fix **memory corruption** when enabling fiber When configuring the fiber port, the DP83869 PHY driver **incorrectly calls linkmode_set_bit() with a bit mask (1 << 10) rather than a bit number (10)**. This corrupts some other memory location -- in case of arm64 the priv pointer in the same structure. Since the advertising flags are updated from supported at the end of the function the incorrect line isnt needed at all and can be removed.",
  "key_phrases": {
    "rootcause": "incorrectly calls linkmode_set_bit() with a bit mask (1 << 10) rather than a bit number (10)",
    "weakness": "memory corruption",
    "impact": "",
    "vector": "",
    "attacker": "",
    "product": "Linux kernel",
    "version": "",
    "component": "DP83869 PHY driver"
  },
  "reference_content": "- **Root cause of vulnerability**: The DP83869 PHY driver incorrectly calls `linkmode_set_bit()` with a bitmask instead of a bit number when configuring the fiber port.\n- **Weaknesses/vulnerabilities present**: Memory corruption.\n- **Impact of exploitation**: The incorrect bitmask corrupts other memory locations, potentially leading to system instability or other undefined behavior. On arm64, it was observed to corrupt the `priv` pointer in the same structure.\n- **Attack vectors**: Configuring the fiber port of the DP83869 PHY.\n- **Required attacker capabilities/position**:  The attacker needs to be able to trigger the fiber port configuration in the driver.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-787 | Out-of-bounds Write | 1.0 | Base | Primary | Allowed |\n| CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | 0.6 | Base | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-787, which represents the **memory corruption** due to writing outside the intended buffer. CWE-1285 is considered because the root cause involves an **incorrect** parameter when calling `linkmode_set_bit()`, suggesting a validation issue regarding the input index.\n\n```mermaid\ngraph TD\n    cwe787[\"CWE-787: Out-of-bounds Write\"]\n    cwe1285[\"CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input\"]\n    cwe119[\"CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer\"]\n    \n    cwe787 -->|CHILDOF| cwe119\n    cwe1285 -->|CANPRECEDE| cwe787\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe787 primary\n    class cwe1285 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **incorrect** call to `linkmode_set_bit()` (potentially related to CWE-1285), leading to an out-of-bounds write (CWE-787), and ultimately resulting in **memory corruption**.\n\n## Summary of Analysis\nThe primary assessment is based on the provided evidence indicating that the driver **incorrectly calls linkmode_set_bit() with a bit mask (1 << 10) rather than a bit number (10)**, which leads to **memory corruption**. This directly corresponds to CWE-787 (Out-of-bounds Write). The retriever results also list CWE-787 as the top candidate.\n\nThe vulnerability description explicitly mentions **memory corruption** due to an incorrect parameter being passed to `linkmode_set_bit()`. The incorrect parameter causes an out-of-bounds write, leading to the observed memory corruption.\n\nCWE-787 is selected because it accurately describes the **memory corruption** resulting from writing outside the intended buffer. It is a base-level CWE, providing a specific representation of the weakness.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the specified index/position/offset has the required properties.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-787: Out-of-bounds Write\n**Abstraction Level**: base\n**Similarity Score**: 4.33\n**Source**: graph\n\n**Description**:\nCWE-787: Out-of-bounds Write\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Relationships**:\n- CANFOLLOW -> CWE-825\n- CANFOLLOW -> CWE-824\n- CANFOLLOW -> CWE-823\n- CANFOLLOW -> CWE-822\n- PARENTOF -> CWE-124\n\n---\n\n**CWE-787: Out-of-bounds Write**\n\n*   **Technical Explanation:** The DP83869 PHY driver **incorrectly calls `linkmode_set_bit()` with a bit mask instead of a bit number.** This leads to writing data outside the intended memory region, causing **memory corruption**.\n*   **Security Implications:** Out-of-bounds writes can lead to arbitrary code execution, denial of service, or information disclosure. In this specific case, the `priv` pointer is corrupted.\n*   **Relationship Analysis:** CWE-787 is a base-level CWE and a child of CWE-119 (Improper Restriction of Operations within the Bounds of a Memory Buffer).\n*   **Mapping Guidance Influence:** The MITRE mapping guidance allows the usage of CWE-787, as it is a base-level CWE.\n*   **Primary/Secondary:** Primary\n\n**CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input**\n\n*   **Technical Explanation:** The root cause mentions the driver **incorrectly calls linkmode_set_bit() with a bit mask (1 << 10) rather than a bit number (10)**. This can be interpreted as the function is not properly validating the input (bit mask vs bit number) which resulted in the out-of-bounds write (CWE-787)\n*   **Security Implications:** Improper validation can allow attackers to manipulate indices and offsets, leading to unintended memory access.\n*   **Relationship Analysis:** CWE-1285 is base-level CWE and is related to improper input validation.\n*   **Mapping Guidance Influence:** The MITRE mapping guidance allows the usage of CWE-1285, as it is a base-level CWE.\n*   **Primary/Secondary:** Secondary. It contributes to the root cause but doesn't directly describe the memory corruption.\n\n**CWEs Considered But Not Used:**\n\n*   CWE-119 (Improper Restriction of Operations within the Bounds of a Memory Buffer): This is a more general CWE. CWE-787 provides a more specific description of the vulnerability.\n*   CWE-190 (Integer Overflow or Wraparound): Not directly related to the described **memory corruption**.\n*   CWE-415 (Double Free), CWE-401 (Missing Release of Memory after Effective Lifetime): These are memory management issues, but they do not directly describe the **memory corruption** caused by the incorrect call to `linkmode_set_bit()`.\n*   CWE-125 (Out-of-bounds Read): The vulnerability description focuses on **memory corruption** due to a write, not a read.\n*   CWE-123 (Write-what-where Condition): While this could describe the impact, CWE-787 more accurately describes the root cause.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-787 | Out-of-bounds Write | 1.0 | Base | Primary | Allowed |\n| CWE-1285 | Improper Validation of Specified Index, Position, or Offset in Input | 0.6 | Base | Secondary Candidate | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-787, which represents the **memory corruption** due to writing outside the intended buffer. CWE-1285 is considered because the root cause involves an **incorrect** parameter when calling `linkmode_set_bit()`, suggesting a validation issue regarding the input index.\n\n```mermaid\ngraph TD\n    cwe787[\"CWE-787: Out-of-bounds Write\"]\n    cwe1285[\"CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input\"]\n    cwe119[\"CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer\"]\n    \n    cwe787 -->|CHILDOF| cwe119\n    cwe1285 -->|CANPRECEDE| cwe787\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe787 primary\n    class cwe1285 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **incorrect** call to `linkmode_set_bit()` (potentially related to CWE-1285), leading to an out-of-bounds write (CWE-787), and ultimately resulting in **memory corruption**.\n\n## Summary of Analysis\nThe primary assessment is based on the provided evidence indicating that the driver **incorrectly calls linkmode_set_bit() with a bit mask (1 << 10) rather than a bit number (10)**, which leads to **memory corruption**. This directly corresponds to CWE-787 (Out-of-bounds Write). The retriever results also list CWE-787 as the top candidate.\n\nThe vulnerability description explicitly mentions **memory corruption** due to an incorrect parameter being passed to `linkmode_set_bit()`. The incorrect parameter causes an out-of-bounds write, leading to the observed memory corruption.\n\nCWE-787 is selected because it accurately describes the **memory corruption** resulting from writing outside the intended buffer. It is a base-level CWE, providing a specific representation of the weakness.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input\n**Abstraction Level**: Base\n**Similarity Score**: 0.74\n**Source**: dense\n\n**Description**:\nThe product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the specified index/position/offset has the required properties.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-787: Out-of-bounds Write\n**Abstraction Level**: base\n**Similarity Score**: 4.33\n**Source**: graph\n\n**Description**:\nCWE-787: Out-of-bounds Write\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n**Relationships**:\n- CANFOLLOW -> CWE-825\n- CANFOLLOW -> CWE-824\n- CANFOLLOW -> CWE-823\n- CANFOLLOW -> CWE-822\n- PARENTOF -> CWE-124\n\n---\n\n**CWE-787: Out-of-bounds Write**\n\n*   **Technical Explanation:** The DP83869 PHY driver **incorrectly calls `linkmode_set_bit()` with a bit mask instead of a bit number.** This leads to writing data outside the intended memory region, causing **memory corruption**.\n*   **Security Implications:** Out-of-bounds writes can lead to arbitrary code execution, denial of service, or information disclosure. In this specific case, the `priv` pointer is corrupted.\n*   **Relationship Analysis:** CWE-787 is a base-level CWE and a child of CWE-119 (Improper Restriction of Operations within the Bounds of a Memory Buffer).\n*   **Mapping Guidance Influence:** The MITRE mapping guidance allows the usage of CWE-787, as it is a base-level CWE.\n*   **Primary/Secondary:** Primary\n\n**CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input**\n\n*   **Technical Explanation:** The root cause mentions the driver **incorrectly calls linkmode_set_bit() with a bit mask (1 << 10) rather than a bit number (10)**. This can be interpreted as the function is not properly validating the input (bit mask vs bit number) which resulted in the out-of-bounds write (CWE-787)\n*   **Security Implications:** Improper validation can allow attackers to manipulate indices and offsets, leading to unintended memory access.\n*   **Relationship Analysis:** CWE-1285 is base-level CWE and is related to improper input validation.\n*   **Mapping Guidance Influence:** The MITRE mapping guidance allows the usage of CWE-1285, as it is a base-level CWE.\n*   **Primary/Secondary:** Secondary. It contributes to the root cause but doesn't directly describe the memory corruption.\n\n**CWEs Considered But Not Used:**\n\n*   CWE-119 (Improper Restriction of Operations within the Bounds of a Memory Buffer): This is a more general CWE. CWE-787 provides a more specific description of the vulnerability.\n*   CWE-190 (Integer Overflow or Wraparound): Not directly related to the described **memory corruption**.\n*   CWE-415 (Double Free), CWE-401 (Missing Release of Memory after Effective Lifetime): These are memory management issues, but they do not directly describe the **memory corruption** caused by the incorrect call to `linkmode_set_bit()`.\n*   CWE-125 (Out-of-bounds Read): The vulnerability description focuses on **memory corruption** due to a write, not a read.\n*   CWE-123 (Write-what-where Condition): While this could describe the impact, CWE-787 more accurately describes the root cause.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-123:**\n- 123 (Write-what-where Condition) - ROOT\n\n\n**Chain starting from CWE-823:**\n- 823 (Use of Out-of-range Pointer Offset) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "787",
        "name": "Out-of-bounds Write",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Memory Corruption",
        "match_reason": "exact_match_whole_phrase"
      },
      "similarity": 1000.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "125",
        "name": "Out-of-bounds Read",
        "source": "sparse"
      },
      "similarity": 508.65469079719
    },
    {
      "metadata": {
        "doc_id": "190",
        "name": "Integer Overflow or Wraparound",
        "source": "sparse"
      },
      "similarity": 486.08991831391245
    },
    {
      "metadata": {
        "doc_id": "415",
        "name": "Double Free",
        "source": "sparse"
      },
      "similarity": 481.68777907031006
    },
    {
      "metadata": {
        "doc_id": "401",
        "name": "Missing Release of Memory after Effective Lifetime",
        "source": "sparse"
      },
      "similarity": 476.2224867956738
    },
    {
      "metadata": {
        "doc_id": "681",
        "name": "Incorrect Conversion between Numeric Types",
        "source": "sparse"
      },
      "similarity": 475.50613049223534
    },
    {
      "metadata": {
        "doc_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "source": "sparse"
      },
      "similarity": 467.4656752730016
    },
    {
      "metadata": {
        "doc_id": "755",
        "name": "Improper Handling of Exceptional Conditions",
        "source": "sparse"
      },
      "similarity": 467.32920196880207
    },
    {
      "metadata": {
        "doc_id": "1285",
        "name": "Improper Validation of Specified Index, Position, or Offset in Input",
        "type": "Base",
        "original_content": "The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the specified index/position/offset has the required properties.",
        "keyphrase_source": "weakness:memory corruption",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.5527680907122103
          }
        }
      },
      "similarity": 0.5527680907122103
    },
    {
      "doc_id": "123",
      "text": "CWE-123: Write-what-where Condition",
      "score": 3.0082,
      "metadata": {
        "doc_id": "123",
        "name": "Write-what-where Condition",
        "type": "base",
        "original_content": "CWE-123: Write-what-where Condition",
        "relationships": [
          {
            "source_id": "123",
            "target_id": "590",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "123",
            "target_id": "479",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "123",
            "target_id": "416",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "123",
            "target_id": "364",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "123",
            "target_id": "134",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "123",
            "target_id": "120",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "123",
            "target_id": "119",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1340"
            }
          },
          {
            "source_id": "123",
            "target_id": "119",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          },
          {
            "source_id": "123",
            "target_id": "787",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "787",
            "target_id": "123",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "590",
            "target_id": "123",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "479",
            "target_id": "123",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "416",
            "target_id": "123",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "415",
            "target_id": "123",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "364",
            "target_id": "123",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "134",
            "target_id": "123",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "120",
            "target_id": "123",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "119",
            "target_id": "123",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1305"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 0.7,
          "abstraction_path": 0.7200000000000001,
          "sequence_path": 0.8,
          "peer_group": 0.9
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "vulnerability_sequence_forward",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "415",
                  "123",
                  "PEEROF"
                ]
              ],
              "score": 0.7,
              "type": "relationship_chain",
              "source": "415"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "119",
                  "123",
                  "PARENTOF"
                ]
              ],
              "score": 0.7200000000000001,
              "type": "abstraction_path_down",
              "source": "119"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "415",
                  "364",
                  "CANFOLLOW"
                ],
                [
                  "364",
                  "123",
                  "CANPRECEDE"
                ]
              ],
              "score": 0.8,
              "type": "vulnerability_sequence_forward",
              "source": "415"
            },
            "peer_relationship": {
              "path": [
                [
                  "415",
                  "123",
                  "PEEROF"
                ]
              ],
              "score": 0.9,
              "type": "peer_relationship",
              "source": "415"
            }
          }
        },
        "abstraction_level": "base",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 3.0082
          }
        }
      },
      "similarity": 3.0082
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-123",
      "CWE-823",
      "CWE-125",
      "CWE-787",
      "CWE-401",
      "CWE-1285",
      "CWE-124",
      "CWE-825",
      "CWE-190",
      "CWE-822",
      "CWE-824",
      "CWE-119",
      "CWE-415"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}