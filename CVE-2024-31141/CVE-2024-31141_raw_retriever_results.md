# Raw Retriever Results for CVE-2024-31141

# Raw Retriever Results for CVE-2024-31141
## Query
Files or Directories Accessible to External Parties, Improper Privilege Management vulnerability in Apache Kafka Clients. Apache Kafka Clients accept configuration data for customizing behavior, and includes ConfigProvider plugins in order to manipulate these configurations. Apache Kafka also provides FileConfigProvider, DirectoryConfigProvider, and EnvVarConfigProvider implementations which include the ability to read from disk or environment variables. In applications where Apache Kafka Clients configurations can be specified by an untrusted party, attackers may use these ConfigProviders to read arbitrary contents of the disk and environment variables. In particular, this flaw may be used in Apache Kafka Connect to escalate from REST API access to filesystem/environment access, which may be undesirable in certain environments, including SaaS products. This issue affects Apache Kafka Clients from 2.3.0 through 3.5.2, 3.6.2, 3.7.0. Users with affected applications are recommended to upgrade kafka-clients to version >=3.8.0, and set the JVM system property org.apache.kafka.automatic.config.providers=none. Users of Kafka Connect with one of the listed ConfigProvider implementations specified in their worker config are also recommended to add appropriate allowlist.pattern and allowed.paths to restrict their operation to appropriate bounds. For users of Kafka Clients or Kafka Connect in environments that trust users with disk and environment variable access, it is not recommended to set the system property. For users of the Kafka Broker, Kafka MirrorMaker 2.0, Kafka Streams, and Kafka command-line tools, it is not recommended to set the system property.

## Keyphrases
- **rootcause**: 'Improper Privilege Management'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4799 | 0.5510 | 0.5080 | 0.5049 | 20 |
| Sparse | 1152.4648 | 1238.3151 | 1200.8021 | 1208.8207 | 10 |
| Graph | 1.3010 | 2.2100 | 1.7484 | 1.6646 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 322 | Key Exchange without Entity Authentication | base | 2.2100 | Allowed |
| 2 | 606 | Unchecked Input for Loop Condition | base | 2.2100 | Allowed |
| 3 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2100 | Allowed |
| 4 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 7 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.0400 | Allowed |
| 8 | 276 | Incorrect Default Permissions | Base | 1.7044 | Allowed |
| 9 | 250 | Execution with Unnecessary Privileges | Base | 1.6953 | Allowed |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 11 | 532 | Insertion of Sensitive Information into Log File | Base | 1.6549 | Allowed |
| 12 | 689 | Permission Race Condition During Resource Copy | compound | 1.6100 | Allowed |
| 13 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 14 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 15 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 269 | Improper Privilege Management | Class | 0.5510 | 0.5510 | Discouraged |
| 2 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.5479 | 0.5479 | Allowed |
| 3 | 276 | Incorrect Default Permissions | Base | 0.5403 | 0.5403 | Allowed |
| 4 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 0.5332 | 0.5332 | Allowed-with-Review |
| 5 | 250 | Execution with Unnecessary Privileges | Base | 0.5299 | 0.5299 | Allowed |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5261 | 0.5261 | Allowed |
| 7 | 266 | Incorrect Privilege Assignment | Base | 0.5240 | 0.5240 | Allowed |
| 8 | 532 | Insertion of Sensitive Information into Log File | Base | 0.5210 | 0.5210 | Allowed |
| 9 | 862 | Missing Authorization | Class | 0.5186 | 0.5186 | Allowed-with-Review |
| 10 | 552 | Files or Directories Accessible to External Parties | Base | 0.5167 | 0.5167 | Allowed |
| 11 | 378 | Creation of Temporary File With Insecure Permissions | Base | 0.4932 | 0.4932 | Allowed |
| 12 | 863 | Incorrect Authorization | Class | 0.4887 | 0.4887 | Allowed-with-Review |
| 13 | 284 | Improper Access Control | Pillar | 0.4884 | 0.4884 | Discouraged |
| 14 | 522 | Insufficiently Protected Credentials | Class | 0.4882 | 0.4882 | Allowed-with-Review |
| 15 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4873 | 0.4873 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | 1238.3151 | 1238.3151 | Allowed |
| 2 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 1236.3426 | 1236.3426 | Allowed-with-Review |
| 3 | 532 | Insertion of Sensitive Information into Log File | 1223.6131 | 1223.6131 | Allowed |
| 4 | 863 | Incorrect Authorization | 1218.4486 | 1218.4486 | Allowed-with-Review |
| 5 | 834 | Excessive Iteration | 1212.5851 | 1212.5851 | Discouraged |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 1205.0562 | 1205.0562 | Allowed |
| 7 | 668 | Exposure of Resource to Wrong Sphere | 1185.3811 | 1185.3811 | Discouraged |
| 8 | 269 | Improper Privilege Management | 1168.4355 | 1168.4355 | Discouraged |
| 9 | 522 | Insufficiently Protected Credentials | 1167.3790 | 1167.3790 | Allowed-with-Review |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | 1152.4648 | 1152.4648 | Allowed-with-Review |
