## Vulnerability Description
When logs are written to a widely-writable directory (the default), an unprivileged attacker may predict a privileged processs log file path and pre-create a symbolic link to a sensitive file in its place. When that privileged process runs, it will follow the planted symlink and overwrite that sensitive file. To fix that, glog now causes the program to exit (with status code 2) when it finds that the configured log file already exists.

### Vulnerability Description Key Phrases

## CVE Reference Links Content Summary
The content relates to CVE-2024-45339.

Here's a breakdown:

*   **Root cause of vulnerability:** Insecure temporary file usage. Specifically, when logs are written to a widely-writable directory, an unprivileged attacker could predict the log file path and create a symbolic link to a sensitive file. The privileged process would then follow the symlink, overwriting the sensitive file.
*   **Weaknesses/vulnerabilities present:** CWE-61 (Inconsistent Pathname Resolution) and CWE-377 (Insecure Temporary File)
*   **Impact of exploitation:** An attacker could overwrite sensitive files, leading to high impacts on both confidentiality and integrity.
*   **Attack vectors:** Local attack. The attacker needs to be able to write to the directory where the logs are written. They can predict the log file names (program, host, username, tag, date, time, and PID).
*   **Required attacker capabilities/position:** An unprivileged attacker with write access to the log directory. They need to predict log file names.
*   **Mitigation or fix:** The glog library has been updated to cause the program to exit (with status code 2) when it finds that the configured log file already exists. The fix uses `os.OpenFile(fname, os.O_RDWR|os.O_CREATE|os.O_EXCL, 0666)`, the `O_EXCL` flag prevents the vulnerability by failing the open call if the file already exists.

The content provides more detail than the official CVE description, offering a concrete example of how an attacker could exploit the vulnerability and describing the fix in detail.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.175 |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.156 |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.149 |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.144 |
| 5 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.143 |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.137 |
| 7 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.135 |
| 8 | 65 | Windows Hard Link | Variant | Allowed | sparse | 0.132 |
| 9 | 779 | Logging of Excessive Data | Base | Allowed | dense | 0.427 |
| 10 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-276: Incorrect Default Permissions

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-427: Uncontrolled Search Path Element

CWE-65: Windows Hard Link

CWE-779: Logging of Excessive Data

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')