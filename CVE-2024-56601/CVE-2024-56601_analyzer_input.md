# Vulnerability Information: CVE-2024-56601

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved net inet do not leave a dangling sk pointer in inet_create() sock_init_data() attaches the allocated sk object to the provided sock object. If inet_create() fails later, the sk object is freed, but the sock object retains the dangling pointer, which may create **use-after-free** later. Clear the sk pointer in the sock object on error.

### Vulnerability Description Key Phrases
- **rootcause:** **use-after-free**
- **impact:** create use-after-free
- **product:** Linux kernel
- **component:** net inet

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
The vulnerability stems from the `inet_create()` function in the Linux kernel's networking subsystem. Specifically, when a socket (`sk`) object is allocated and associated with a socket (`sock`) object using `sock_init_data()`, the `sk` pointer within the `sock` object is not cleared if `inet_create()` fails later on. This leads to a dangling pointer because the `sk` object is freed on failure, but `sock` still retains a pointer to the freed memory.

**Weaknesses/Vulnerabilities Present:**
- **Dangling Pointer:** The primary vulnerability is the presence of a dangling `sk` pointer within the `sock` object after a failure in `inet_create()`.
- **Use-After-Free (UAF):** The dangling pointer can lead to a use-after-free vulnerability if the `sock` object is used in a way that attempts to access the freed memory pointed to by `sock->sk`.

**Impact of Exploitation:**
- **Use-After-Free:** Successful exploitation of this vulnerability would result in a use-after-free condition. 
- **Kernel Panic:** This could lead to a crash or kernel panic.
- **Arbitrary Code Execution:** In some cases, use-after-free vulnerabilities can be leveraged by an attacker to achieve arbitrary code execution.

**Attack Vectors:**
- The attack vector is through the creation of a network socket that triggers the error conditions within the `inet_create()` function, leading to the dangling pointer.
- An attacker might be able to trigger the failure conditions in `inet_create()` by providing crafted inputs, or exploiting other kernel behaviors that could cause the socket creation to fail.

**Required Attacker Capabilities/Position:**
- The attacker would need to be able to create network sockets and induce failure conditions.
- The attacker would need some control over socket creation and/or the conditions that cause `inet_create` to fail, this would likely require some existing privileges or access to a network device that will then be used to trigger the vulnerable code path.

**More details than the CVE Description:**
The provided content gives more detail than the official CVE description placeholder would provide. The commits detail the specific vulnerable code path, the root cause, and the fix. The commit messages describe how `sock_init_data` attaches the `sk` object to the `sock` object and how failures in `inet_create` leave the `sock` object with a dangling `sk` pointer. The patch then clears the `sock->sk` pointer on error, preventing the use-after-free.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 416 | Use After Free | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 415 | Double Free | Variant | Allowed | sparse | 0.430 |
| 3 | 911 | Improper Update of Reference Count | Base | Allowed | sparse | 0.398 |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.389 |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.384 |
| 6 | 825 | Expired Pointer Dereference | Base | Allowed | sparse | 0.349 |
| 7 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | sparse | 0.343 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.334 |
| 9 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | Allowed | dense | 0.414 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.003 |

