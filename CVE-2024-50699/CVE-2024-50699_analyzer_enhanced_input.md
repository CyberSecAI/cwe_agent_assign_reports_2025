## Vulnerability Description
TP-Link TL-WR845N(UN)_V4_201214, TL-WR845N(UN)_V4_200909 and TL-WR845N(UN)_V4_190219 were discovered to contain weak **default credentials** for the Administrator account.

### Vulnerability Description Key Phrases
- **rootcause:** **default credentials**
- **weakness:** **weak default credentials**
- **product:** ['TP-Link TL-WR845N(UN)_V4_201214' and 'TL-WR845N(UN)_V4_200909' and 'TL-WR845N(UN)_V4_190219']
- **component:** Administrator account

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The TP-Link TL-WR845N router firmware, during upgrade processes, retains the previously used admin credentials. Older firmware versions transmit credentials insecurely, which can be intercepted by attackers and then used after the router is upgraded.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure Credential Transmission (Older Versions):**
    *   Firmware version `TL-WR845N(UN)_V4_190219` transmits admin credentials in the HTTP request cookies using base64 encoding, which is easily reversible.
    *   Firmware versions `TL-WR845N(UN)_V4_200909` and `TL-WR845N(UN)_V4_201214` transmit admin credentials in plain text during factory reset.
*   **Credential Reuse After Upgrade:** Upgraded firmware does not require the user to change the admin credentials. This allows an attacker who obtained credentials from an earlier, vulnerable firmware version to log into the upgraded device.

**Impact of Exploitation:**

*   **Full Admin Access:** An attacker who obtains the admin credentials can gain full control of the router through its web admin portal. This can allow the attacker to:
    *   Change router settings.
    *   Monitor network traffic.
    *   Potentially compromise other devices on the network.
    *   Use the router as part of a botnet.
   
**Attack Vectors:**

*   **Network Sniffing:** An attacker on the same network as the router can intercept network traffic using techniques like ARP poisoning.
*   **HTTP Request Inspection:** The attacker filters HTTP packets to extract the credentials.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker must be on the same network (either LAN or Wi-Fi) as the target router.
*   **Packet Sniffing Capability:** The attacker needs to be able to capture and analyze network traffic (e.g., using Wireshark).
*   **ARP Poisoning (for active attacks):** The attacker may perform ARP poisoning to ensure all the traffic is directed to the attacker's machine.
*   **Knowledge of Insecure Transmission:** The attacker needs to be aware of how the credentials are transmitted (base64 encoding in older version or plaintext in later versions during reset) by older/vulnerable firmware.

**Additional Details:**

*   The report links to two separate vulnerabilities previously identified as `CVE-2024-46341` and `CVE-2024-46340`, but does not explain how the current vulnerability differs from the previous ones.
*   The content provides specific packet filters and locations of the plain text credentials (`/cgi/softup HTTP/1.1`) in the captured packets.

This description gives a good understanding of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1394 | Use of Default Cryptographic Key | Base | Allowed | sparse | 0.170 |
| 2 | 326 | Inadequate Encryption Strength | Class | Allowed-with-Review | sparse | 0.169 |
| 3 | 778 | Insufficient Logging | Base | Allowed | sparse | 0.145 |
| 4 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.141 |
| 5 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.133 |
| 6 | 1393 | Use of Default Password | Base | Allowed | sparse | 0.132 |
| 7 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.131 |
| 8 | 1392 | Use of Default Credentials | Base | Allowed | sparse | 0.130 |
| 9 | 1188 | Initialization of a Resource with an Insecure Default | Base | Allowed | dense | 0.556 |
| 10 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1394: Use of Default Cryptographic Key

CWE-326: Inadequate Encryption Strength

CWE-778: Insufficient Logging

CWE-259: Use of Hard-coded Password

CWE-1391: Use of Weak Credentials

CWE-1393: Use of Default Password

CWE-330: Use of Insufficiently Random Values

CWE-1392: Use of Default Credentials

CWE-1188: Initialization of a Resource with an Insecure Default

CWE-321: Use of Hard-coded Cryptographic Key