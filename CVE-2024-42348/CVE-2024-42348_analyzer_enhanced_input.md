## Vulnerability Description
FOG is a cloning/imaging/rescue suite/inventory management system. FOG Server 1.5.10.41.2 can leak AD username and password when registering a computer. This vulnerability is fixed in 1.5.10.41.3 and 1.6.0-beta.1395.

### Vulnerability Description Key Phrases
- **impact:** leak AD username and password
- **product:** FOG Server
- **version:** 1.5.10.41.2
- **component:** registration

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**CVE ID:** CVE-2024-42348

**Root Cause of Vulnerability:**
The vulnerability stems from the FOG Server software failing to check if a username/password used for tasking "download image" is valid when a new computer is registered manually.

**Weaknesses/Vulnerabilities Present:**
- **Lack of Input Validation:** The system doesn't validate or sanitize the username and password used for the image download task, allowing an attacker to inject malicious input.
- **Information Leakage:** The system leaks sensitive information (AD domain, username, and password) when processing a crafted request.

**Impact of Exploitation:**
- **Confidentiality Breach:** An unauthenticated attacker can recover the Active Directory (AD) username and password used by the FOG server. This grants unauthorized access to the AD domain.
- **Potential Lateral Movement:**  The leaked credentials could be used for further malicious activities within the affected network, potentially escalating to wider compromise.

**Attack Vectors:**
- **Network-based:** The attacker sends a crafted HTTP request to the FOG server.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to have network access to the FOG server.
- **No Authentication Required:** The attacker does not need to authenticate to exploit the vulnerability.
- **Basic Knowledge:** The attacker requires knowledge on how to craft the specific HTTP request. A proof-of-concept script is also available (https://alexandre.botzung.fr/poc_FOG_E9XJUHi93f.sh).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.066 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.064 |
| 3 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.064 |
| 4 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.063 |
| 5 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.062 |
| 6 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.062 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.062 |
| 8 | 204 | Observable Response Discrepancy | Base | Allowed | sparse | 0.062 |
| 9 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | Allowed | dense | 0.442 |
| 10 | 390 | Detection of Error Condition Without Action | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-522: Insufficiently Protected Credentials

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-287: Improper Authentication

CWE-863: Incorrect Authorization

CWE-204: Observable Response Discrepancy

CWE-1249: Application-Level Admin Tool with Inconsistent View of Underlying Operating System

CWE-390: Detection of Error Condition Without Action