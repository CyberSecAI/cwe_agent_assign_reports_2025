# Raw Retriever Results for CVE-2024-42354

# Raw Retriever Results for CVE-2024-42354
## Query
Shopware is an open commerce platform. The store-API works with regular entities and not expose all fields for the public API fields need to be marked as ApiAware in the EntityDefinition. So only ApiAware fields of the EntityDefinition will be encoded to the final JSON. Prior to versions 6.6.5.1 and 6.5.8.13, the processing of the Criteria did not considered ManyToMany associations and so they were not considered properly and the protections didnt get used. This issue cannot be reproduced with the default entities by Shopware, but can be triggered with extensions. Update to Shopware 6.6.5.1 or 6.5.8.13 to receive a patch. For older versions of 6.2, 6.3, and 6.4, corresponding security measures are also available via a plugin.

## Keyphrases
- **rootcause**: 'improper processing of ManyToMany associations'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3408 | 0.3989 | 0.3639 | 0.3646 | 20 |
| Sparse | 231.4763 | 762.9409 | 686.5996 | 723.3983 | 11 |
| Graph | 1.4080 | 2.8652 | 1.8698 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 184 | Incomplete List of Disallowed Inputs | base | 2.8652 | Allowed |
| 2 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 4 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 5 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | base | 2.2100 | Allowed |
| 6 | 499 | Serializable Class Containing Sensitive Data | variant | 2.0400 | Allowed |
| 7 | 498 | Cloneable Class Containing Sensitive Information | variant | 2.0400 | Allowed |
| 8 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 9 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.8018 | Allowed |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 11 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 12 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 1.7287 | Allowed |
| 13 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.7276 | Allowed |
| 14 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.6968 | Allowed |
| 15 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | class | 1.6736 | Discouraged |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1023 | Incomplete Comparison with Missing Factors | Class | 0.3989 | 0.3989 | Allowed-with-Review |
| 2 | 525 | Use of Web Browser Cache Containing Sensitive Information | Variant | 0.3939 | 0.3939 | Allowed |
| 3 | 611 | Improper Restriction of XML External Entity Reference | Base | 0.3846 | 0.3846 | Allowed |
| 4 | 1025 | Comparison Using Wrong Factors | Base | 0.3820 | 0.3820 | Allowed |
| 5 | 922 | Insecure Storage of Sensitive Information | Class | 0.3820 | 0.3820 | Allowed-with-Review |
| 6 | 8 | J2EE Misconfiguration: Entity Bean Declared Remote | Variant | 0.3767 | 0.3767 | Allowed |
| 7 | 435 | Improper Interaction Between Multiple Correctly-Behaving Entities | Pillar | 0.3758 | 0.3758 | Discouraged |
| 8 | 576 | EJB Bad Practices: Use of Java I/O | Variant | 0.3736 | 0.3736 | Allowed |
| 9 | 437 | Incomplete Model of Endpoint Features | Base | 0.3720 | 0.3720 | Allowed |
| 10 | 502 | Deserialization of Untrusted Data | Base | 0.3715 | 0.3715 | Allowed |
| 11 | 202 | Exposure of Sensitive Information Through Data Queries | Base | 0.3577 | 0.3577 | Allowed |
| 12 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | 0.3532 | 0.3532 | Allowed |
| 13 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.3485 | 0.3485 | Allowed |
| 14 | 488 | Exposure of Data Element to Wrong Session | Base | 0.3482 | 0.3482 | Allowed |
| 15 | 1024 | Comparison of Incompatible Types | Base | 0.3475 | 0.3475 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 762.9409 | 762.9409 | Allowed-with-Review |
| 2 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | 751.7098 | 751.7098 | Discouraged |
| 3 | 116 | Improper Encoding or Escaping of Output | 749.2384 | 749.2384 | Allowed-with-Review |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | 744.0022 | 744.0022 | Allowed |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 733.1081 | 733.1081 | Allowed |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | 723.3983 | 723.3983 | Allowed |
| 7 | 1333 | Inefficient Regular Expression Complexity | 717.2283 | 717.2283 | Allowed |
| 8 | 285 | Improper Authorization | 713.7971 | 713.7971 | Discouraged |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 713.7951 | 713.7951 | Allowed |
| 10 | 1390 | Weak Authentication | 711.9014 | 711.9014 | Allowed-with-Review |
| 11 | 328 | Use of Weak Hash | 231.4763 | 231.4763 | Allowed |
