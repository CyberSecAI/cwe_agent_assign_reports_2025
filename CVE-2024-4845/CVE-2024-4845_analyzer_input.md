# Vulnerability Information: CVE-2024-4845

## Vulnerability Description
The Icegram Express plugin for WordPress is vulnerable to SQL Injection via the options[list_id] parameter in all versions up to, and including, 5.7.22 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Subscriber-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers
- **product:** Icegram Express plugin for WordPress
- **version:** up to 5.7.22
- **component:** options[list_id] parameter

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-4845:

**1. Verification of CVE Relevance:**

*   The provided content, specifically from the Wordfence article and the `readme.txt` changelog, confirms that this CVE relates to a SQL Injection vulnerability found in the Icegram Express plugin, versions 5.7.22 and below. The `readme.txt` file from the plugin itself explicitly mentions `SQL Injection vulnerability during contact import - CVE-2024-4845`.

**2. Root Cause of Vulnerability:**

*   The root cause is insufficient input sanitization and lack of proper SQL query preparation, specifically for the `options[list_id]` parameter during contact import. This allows for the injection of malicious SQL code.

**3. Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The vulnerability is a classic SQL injection flaw, where user-supplied data is not properly handled before being used in an SQL query.

**4. Impact of Exploitation:**

*   **Data Breach:** Attackers can use this vulnerability to extract sensitive information from the database, such as user data, configuration settings, and potentially other sensitive data related to the WordPress installation or other plugins.
*   **Data Modification/Deletion:** While the description primarily emphasizes data extraction, SQL injection can also be used to modify or delete data.
*   **Potential for Privilege Escalation:** It might be possible to escalate user privileges by manipulating the database, though this is not directly mentioned.

**5. Attack Vectors:**

*   **HTTP Request Manipulation:** Attackers can exploit this vulnerability by sending a crafted HTTP request containing malicious SQL code in the `options[list_id]` parameter.

**6. Required Attacker Capabilities/Position:**

*   **Authentication Required:** Attackers need to be authenticated as a user with at least "Subscriber" level access or above to exploit this vulnerability.
*   **Knowledge of Vulnerable Parameter:** Attackers must be aware of the `options[list_id]` parameter.
*   **Basic SQL Injection Knowledge:** Attackers require basic SQL injection knowledge to construct the malicious payload.

**Additional Notes:**

*   The Wordfence article provides a CVSS score of 8.8, indicating a high severity vulnerability.
*   The fix for this vulnerability is to update to version 5.7.23 or higher.
*   The vulnerability was reported and addressed thanks to the Wordfence team.
*   The provided content from `plugins.trac.wordpress.org` shows the code changes introduced to fix the vulnerability, including minor updates for handling of image sizes and email delivery status. However, the SQL injection fix itself is not explicitly visible in the diffs.
*   The code diffs from `email-subscribers/trunk/lite/includes/class-es-common.php` shows a change in the function name from `get_image_sizes` to `get_registered_image_sizes`, which was also linked to the resolution of this CVE.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.564 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.522 |
| 4 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.508 |
| 5 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.506 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.499 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.497 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.492 |
| 9 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | dense | 0.479 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

