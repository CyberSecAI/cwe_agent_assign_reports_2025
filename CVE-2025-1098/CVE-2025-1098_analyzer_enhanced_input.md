## Vulnerability Description
A security issue was discovered in ingress-nginx https//github.com/kubernetes/ingress-nginx where the `mirror-target` and `mirror-host` Ingress annotations can be used to inject arbitrary configuration into nginx. This can lead to arbitrary code execution in the context of the ingress-nginx controller, and disclosure of Secrets accessible to the controller. (Note that in the default installation, the controller can access all Secrets cluster-wide.)

### Vulnerability Description Key Phrases
- **product:** ingress-nginx
- **impact:** arbitrary code execution, disclosure of Secrets

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1098 Content

This content **is relevant** to CVE-2025-1098. It provides detailed information about a vulnerability in the ingress-nginx controller.

Here's an extraction of the relevant information:

**Root cause of vulnerability:**

The `mirror-target` and `mirror-host` Ingress annotations can be used to inject arbitrary configuration into nginx.

**Weaknesses/vulnerabilities present:**

*   Configuration injection
*   Arbitrary code execution (potential)
*   Secret disclosure (potential)

**Impact of exploitation:**

*   Arbitrary code execution in the context of the ingress-nginx controller.
*   Disclosure of Secrets accessible to the controller (potentially all cluster Secrets in a default installation).

**Attack vectors:**

*   Exploitation through unsanitized `mirror-target` or `mirror-host` annotations in Ingress resources.

**Required attacker capabilities/position:**

*   Low privilege - requires the ability to create or modify Ingress resources.

**Mitigation or fix:**

*   **ACTION REQUIRED:** Upgrade ingress-nginx to v1.11.5, v1.12.1, or any later version.
*   Fixed Versions: ingress-nginx [main@2e9f373](https://github.com/kubernetes/ingress-nginx/pull/13068/commits/2e9f37380afb7853fa6daa1c3e6659550aadfd90)
*   Upgrading instructions: [https://kubernetes.github.io/ingress-nginx/deploy/upgrade/](https://kubernetes.github.io/ingress-nginx/deploy/upgrade/)

**Additional Details (more than official CVE description):**

*   **CVSS Rating:** CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (Score: 8.8, High)
*   **Affected Versions:** < v1.11.0, v1.11.0 - 1.11.4, v1.12.0
*   **Detection:** Suspicious data within the `mirror-target` or `mirror-host` annotations of an Ingress resource.
*   **Acknowledgements:**  The vulnerability was reported by Nir Ohfeld, Ronen Shustin, Sagi Tzadik and Hillai Ben Sasson from Wiz. Fixed and coordinated by Marco Ebert, James Strong, Tabitha Sable, and the Kubernetes Security Response Committee.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.135 |
| 2 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.132 |
| 3 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.130 |
| 4 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.130 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.129 |
| 6 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.125 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.124 |
| 8 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.124 |
| 9 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | dense | 0.509 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-668: Exposure of Resource to Wrong Sphere

CWE-522: Insufficiently Protected Credentials

CWE-256: Plaintext Storage of a Password

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-287: Improper Authentication

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-941: Incorrectly Specified Destination in a Communication Channel

CWE-184: Incomplete List of Disallowed Inputs