{
  "cve_id": "CVE-2025-4598",
  "description": "A vulnerability was found in systemd-coredump. This flaw allows an attacker to force a SUID process to crash and replace it with a non-SUID binary to access the originals privileged process coredump, allowing the attacker to read sensitive data, such as /etc/shadow content, loaded by the original process. A SUID binary or process has a special type of permission, which allows the process to run with the file owners permissions, regardless of the user executing the binary. This allows the process to access more restricted data than unprivileged users or processes would be able to. An attacker can leverage this flaw by forcing a SUID process to crash and force the Linux kernel to recycle the process PID before systemd-coredump can analyze the /proc/pid/auxv file. If the attacker wins the **race condition**, they gain access to the originals SUID process coredump file. They can read sensitive content loaded into memory by the original binary, affecting data confidentiality.",
  "key_phrases": {
    "rootcause": "race condition",
    "weakness": "",
    "impact": [
      "access original SUID process coredump file",
      "access privileged process coredump",
      "read sensitive content",
      "read sensitive data"
    ],
    "vector": "forcing a SUID process to crash",
    "attacker": "attacker",
    "product": "systemd-coredump",
    "version": "",
    "component": ""
  },
  "reference_content": "Here's an analysis of the provided content, focusing on CVE-2025-4598:\n\n**Content from bugzilla.redhat.com_d157eb03_20250624_142329.html (text)**\n\n*   **Relevance:** This content is **relevant** as it directly mentions CVE-2025-4598 and provides details about the vulnerability.\n*   **Extracted Information:**\n    *   **CVE ID:** CVE-2025-4598\n    *   **Summary:**  systemd-coredump: race condition that allows a local attacker t... (incomplete - truncated by Bugzilla)\n    *   **Description:** A race condition in systemd-coredump allows a local attacker to crash a SUID program and gain read access to the resulting core dump.\n    *   **Weaknesses/Vulnerabilities:** Race condition in systemd-coredump.\n    *   **Impact of Exploitation:** A local attacker can crash a SUID program and gain read access to the resulting core dump.\n    *   **Product:** Security Response\n    *   **Classification:** Other\n    *   **Component:** vulnerability\n    *   **OS:** Linux\n    *   **Severity:** medium\n    *   **Assignee:** Product Security DevOps Team\n    *   **Depends On:** Bug 2369244, 2369246, 2369245, 2369247 (related bugs)\n    *   **Reported:** 2025-05-29\n    *   **Modified:** 2025-06-02\n\n**Content from lists.openwall.net_ae5d8845_20250624_204226.html (text)**\n\n*   **Relevance:**  This content is **not relevant** because it's a mailing list archive listing for Openwall. It lists mailing lists. It does not contain vulnerability information.\n\n**Content from www.openwall.com_aff47406_20250624_142330.html (text)**\n\n*   **Relevance:**  This content is **not relevant** because it is a webpage that links to different Openwall products.\n\n**Content from www.openwall.com_bc2440b2_20250624_142327.html (text)**\n\n*   **Relevance:**  This content is **not relevant** because it links to different Openwall products and projects.\n\n**Content from lists.openwall.net_ae5d8845_20250624_204226.html (text)**\n\n*   **Relevance:** This content is **not relevant** because it's a webpage that links to different Openwall mailing lists.\n\n**Content from lists.openwall.net_ae5d8845_20250624_204226.html (text)**\n\n*   **Relevance:**  This content is **not relevant** because it's a webpage that links to different Openwall mailing lists.\n\n**Content from www.openwall.com_bc2440b2_20250624_142327.html (text)**\n\n*   **Relevance:**  This content is **not relevant** because it's a webpage that links to different Openwall products.\n\n**Content from lists.openwall.net_ae5d8845_20250624_204226.html (text)**\n\n*   **Relevance:** This content is **not relevant** because it is a mailing list archive listing for Openwall.\n\n**Content from www.openwall.com_ff0141a7_20250624_204227.html (text)**\n\n*   **Relevance:** This content is **not relevant** because it's a web page that lists the blists software.\n\n**Content from access.redhat.com_123c8f56_20250624_142328.html (stripped)**\n*   **Relevance:** This content is **not relevant** because it is a Red Hat customer portal with links to different services.\n\n**Content from access.redhat.com_123c8f56_20250624_204226.html (stripped)**\n*   **Relevance:** This content is **not relevant** because it is a Red Hat customer portal with links to different services.\n\n**Content from bugzilla.redhat.com_d157eb03_20250624_142329.html (text)**\n\n*   **Relevance:** This content is **relevant** as it directly mentions CVE-2025-4598 and provides details about the vulnerability.\n*   **Extracted Information:**\n    *   **CVE ID:** CVE-2025-4598\n    *   **Summary:** CVE-2025-4598 systemd-coredump: race condition that allows a local attacker t...\n    *   **Description:** A race condition in systemd-coredump allows a local attacker to crash a SUID program and gain read access to the resulting core dump\n    *   **Weaknesses/Vulnerabilities:** Race condition in systemd-coredump.\n    *   **Impact of Exploitation:** A local attacker can crash a SUID program and gain read access to the resulting core dump.\n    *   **Product:** Security Response\n    *   **Classification:** Other\n    *   **Component:** vulnerability\n    *   **OS:** Linux\n    *   **Severity:** medium\n    *   **Assignee:** Product Security DevOps Team\n    *   **Depends On:** Bug 2369244, 2369246, 2369245, 2369247 (related bugs)\n    *   **Reported:** 2025-05-29\n    *   **Modified:** 2025-06-02\n\n**Content from the Email with subject \"Local information disclosure in apport and systemd-coredump\"**\n\n*   **Relevance:** This email is **highly relevant** as it's a Qualys Security Advisory that details both CVE-2025-5054 (apport) and CVE-2025-4598 (systemd-coredump). It provides detailed analysis, proof-of-concept code, and mitigation strategies.\n*   **Extracted Information (for CVE-2025-4598):**\n    *   **Root cause of vulnerability:** A race condition in systemd-coredump. Specifically, the lack of protection against the \"kill-and-replace\" attack, where an attacker can replace a crashed SUID process with a non-SUID process before systemd-coredump analyzes the process's memory.\n    *   **Weaknesses/Vulnerabilities present:**\n        *   Race condition in systemd-coredump's handling of core dumps.\n        *   systemd-coredump does not protect against the \"kill-and-replace\" race condition.\n    *   **Impact of exploitation:** Local information disclosure. An attacker can crash a SUID program and gain read access to the resulting core dump, leading to the potential for reading sensitive information like /etc/shadow.  The advisory highlights an attack against root daemons where an attacker can crash root daemons that fork() and setuid() to the attacker's uid, gain read access to the resulting core dumps, and therefore to the root daemons' memory, leading to the leakage of secrets.\n    *   **Attack vectors:**\n        *   Crashing a SUID program using a core-dumping signal (SIGSEGV or SIGSYS).\n        *   Rapidly replacing the crashed SUID process with a non-SUID process (with matching UIDs/GIDs) before systemd-coredump analyzes the core dump.\n    *   **Required attacker capabilities/position:** Local, unprivileged user account. Ability to execute code and send signals.\n    *   **Mitigation or fix:**\n        *   Set `/proc/sys/fs/suid_dumpable` to `0` (SUID_DUMP_DISABLE) to prevent SUID programs and root daemons from being analyzed in case of a crash.  This is a temporary fix.\n        *   The recommended long-term fix:\n            *   Always take account of the kernel's per-process \"dumpable\" flag (the %d specifier) when determining whether a non-root user should have access to a core dump.\n            *   Use the new %F specifier in `/proc/sys/kernel/core_pattern` (a pidfd to the crashed process) to detect if the crashed process has been replaced.\n    *   **More Detail than Official CVE:** This content provides *significantly* more detail than a typical CVE description, including:\n        *   Detailed analysis of the vulnerability.\n        *   Detailed attack vectors.\n        *   Two Proof-of-Concept programs\n        *   Specific examples of vulnerable daemons\n        *   A description of the root cause and the various checks/defenses that were attempted in systemd-coredump and why those defenses failed.\n\n**Content from the Reply with subject \"Re: Local information disclosure in apport and systemd-coredump\"**\n*   **Relevance:** This content is **relevant** because it discusses a PoC for the CVE and provides information on the exploit.\n*   **Extracted Information:**\n    *   **Attack vector:** Crashing a SUID program and quickly replacing it with a non-SUID process.\n    *   **Vulnerable Program:** unix\\_chkpwd\n    *   **Additional Information:** The email mentions that with a low kernel.pid\\_max, the race condition succeeds frequently and with some inotify, the attacker can get password hashes.\n\n**Content from the Reply with subject \"Re: Local information disclosure in apport and systemd-coredump\"**\n*   **Relevance:** This content is **relevant** because it provides information on the impact of the CVE, fixes to it, and the CVSS score.\n*   **Extracted Information:**\n    *   **Impact:** Local information disclosure on RHEL 9.\n    *   **Affected Programs:** systemd\n    *   **Fix:** The fix involves taking the kernel's per-process \"dumpable\" flag into consideration, and by using the new %F specifier.\n    *   **Attack Complexity:** Low\n    *   **Threat impact:** Important.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 0.9 | Base | Primary | Allowed |\n| CWE-267 | Privilege Defined With Unsafe Actions | 0.5 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE is CWE-367, which is a Base level CWE that describes a TOCTOU race condition. The vulnerability description explicitly mentions a **race condition** where the state of a resource changes between the check and use, which aligns with CWE-367. The secondary CWE is CWE-267, which relates to privileges being used to perform unsafe actions. In this case, the SUID privilege allows the vulnerable process to access restricted data.\n\n```mermaid\ngraph TD\n    cwe367[\"CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition\"]\n    cwe267[\"CWE-267: Privilege Defined With Unsafe Actions\"]\n    cwe362[\"CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')\"]\n    \n    cwe367 -->|CHILDOF| cwe362\n    cwe362 -->|ParentOF| cwe367\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe367 primary\n    class cwe267 secondary\n    class cwe362 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with a **race condition** (CWE-367) in systemd-coredump. This race occurs when an attacker can replace a crashed SUID process with a non-SUID process before systemd-coredump analyzes the /proc/pid/auxv file. If the attacker wins the race, they gain unauthorized access to the original SUID process's coredump file, leading to the exposure of sensitive data (e.g., /etc/shadow content). The vulnerability exploits a **privilege** (CWE-267) associated with SUID processes to access restricted data.\n\n## Summary of Analysis\nThe primary assessment is based on the evidence that a **race condition** is present in the systemd-coredump utility. The vulnerability description and the CVE reference summary clearly state that a **race condition** allows a local attacker to crash a SUID program and gain read access to the resulting core dump. The Qualys Security Advisory provides detailed analysis and specifically mentions the **lack of protection against the \"kill-and-replace\" attack**.\n\nThe initial analysis considered CWE-362, as it is a Class-level CWE for general race conditions. However, CWE-367 is more specific, as it describes a time-of-check time-of-use race condition, which aligns more closely with the vulnerability description. Additionally, CWE-367 is a Base level CWE, which is preferred over Class level CWEs.\n\nThe graph relationships influenced the final selection by showing the parent-child relationship between CWE-362 and CWE-367. While CWE-362 is a broader category, CWE-367 provides a more precise characterization of the race condition.\n\nThe selected CWEs are at the optimal level of specificity because CWE-367 directly addresses the TOCTOU **race condition**, and CWE-267 highlights the role of privileges in enabling the vulnerability.\n\nRelevant CWE Information:\n\n**CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition**\n\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.\n\n**CWE-267: Privilege Defined With Unsafe Actions**\n\nA particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 0.9 | Base | Primary | Allowed |\n| CWE-267 | Privilege Defined With Unsafe Actions | 0.5 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE is CWE-367, which is a Base level CWE that describes a TOCTOU race condition. The vulnerability description explicitly mentions a **race condition** where the state of a resource changes between the check and use, which aligns with CWE-367. The secondary CWE is CWE-267, which relates to privileges being used to perform unsafe actions. In this case, the SUID privilege allows the vulnerable process to access restricted data.\n\n```mermaid\ngraph TD\n    cwe367[\"CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition\"]\n    cwe267[\"CWE-267: Privilege Defined With Unsafe Actions\"]\n    cwe362[\"CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')\"]\n    \n    cwe367 -->|CHILDOF| cwe362\n    cwe362 -->|ParentOF| cwe367\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe367 primary\n    class cwe267 secondary\n    class cwe362 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with a **race condition** (CWE-367) in systemd-coredump. This race occurs when an attacker can replace a crashed SUID process with a non-SUID process before systemd-coredump analyzes the /proc/pid/auxv file. If the attacker wins the race, they gain unauthorized access to the original SUID process's coredump file, leading to the exposure of sensitive data (e.g., /etc/shadow content). The vulnerability exploits a **privilege** (CWE-267) associated with SUID processes to access restricted data.\n\n## Summary of Analysis\nThe primary assessment is based on the evidence that a **race condition** is present in the systemd-coredump utility. The vulnerability description and the CVE reference summary clearly state that a **race condition** allows a local attacker to crash a SUID program and gain read access to the resulting core dump. The Qualys Security Advisory provides detailed analysis and specifically mentions the **lack of protection against the \"kill-and-replace\" attack**.\n\nThe initial analysis considered CWE-362, as it is a Class-level CWE for general race conditions. However, CWE-367 is more specific, as it describes a time-of-check time-of-use race condition, which aligns more closely with the vulnerability description. Additionally, CWE-367 is a Base level CWE, which is preferred over Class level CWEs.\n\nThe graph relationships influenced the final selection by showing the parent-child relationship between CWE-362 and CWE-367. While CWE-362 is a broader category, CWE-367 provides a more precise characterization of the race condition.\n\nThe selected CWEs are at the optimal level of specificity because CWE-367 directly addresses the TOCTOU **race condition**, and CWE-267 highlights the role of privileges in enabling the vulnerability.\n\nRelevant CWE Information:\n\n**CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition**\n\nThe product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.\n\n**CWE-267: Privilege Defined With Unsafe Actions**\n\nA particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-367:**\n- 367 (Time-of-check Time-of-use (TOCTOU) Race Condition) - ROOT\n\n\n**Chain starting from CWE-362:**\n- 362 (Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Race Condition",
        "match_reason": "exact_match_whole_phrase"
      },
      "similarity": 1000.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "source": "sparse"
      },
      "similarity": 968.1201371190804
    },
    {
      "metadata": {
        "doc_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "source": "sparse"
      },
      "similarity": 942.1616127567804
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 918.9372454120701
    },
    {
      "metadata": {
        "doc_id": "276",
        "name": "Incorrect Default Permissions",
        "source": "sparse"
      },
      "similarity": 892.4229806746612
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 870.8159876297198
    },
    {
      "metadata": {
        "doc_id": "787",
        "name": "Out-of-bounds Write",
        "source": "sparse"
      },
      "similarity": 869.1925820042454
    },
    {
      "metadata": {
        "doc_id": "667",
        "name": "Improper Locking",
        "source": "sparse"
      },
      "similarity": 862.3392414687794
    },
    {
      "metadata": {
        "doc_id": "250",
        "name": "Execution with Unnecessary Privileges",
        "type": "Base",
        "original_content": "The product performs an operation at a privilege level that is higher than the minimum level required, which creates new weaknesses or amplifies the consequences of other weaknesses.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5547115533693243,
            "graph": 1.7153822197937834
          }
        }
      },
      "similarity": 0.5547115533693243
    },
    {
      "doc_id": "386",
      "text": "CWE-386: Symbolic Name not Mapping to Correct Object",
      "score": 2.3764000000000003,
      "metadata": {
        "doc_id": "386",
        "name": "Symbolic Name not Mapping to Correct Object",
        "type": "base",
        "original_content": "CWE-386: Symbolic Name not Mapping to Correct Object",
        "relationships": [
          {
            "source_id": "386",
            "target_id": "61",
            "label": "REQUIREDBY",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "386",
            "target_id": "486",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "386",
            "target_id": "610",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "386",
            "target_id": "367",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "386",
            "target_id": "706",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "706",
            "target_id": "386",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "61",
            "target_id": "386",
            "label": "REQUIRES",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 0.7200000000000001,
          "sequence_path": 0.8,
          "peer_group": 0.9
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "732",
                  "61",
                  "REQUIREDBY"
                ],
                [
                  "61",
                  "386",
                  "REQUIRES"
                ]
              ],
              "score": 0.7200000000000001,
              "type": "relationship_chain",
              "source": "732"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "362",
                  "61",
                  "REQUIREDBY"
                ],
                [
                  "61",
                  "386",
                  "REQUIRES"
                ]
              ],
              "score": 0.8,
              "type": "vulnerability_sequence_forward",
              "source": "362"
            },
            "peer_relationship": {
              "path": [
                [
                  "386",
                  "367",
                  "PEEROF"
                ]
              ],
              "score": 0.9,
              "type": "peer_relationship",
              "source": "367"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.3764000000000003
          }
        }
      },
      "similarity": 2.3764000000000003
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-367",
      "CWE-362",
      "CWE-267"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}