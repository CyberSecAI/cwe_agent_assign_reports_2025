# Vulnerability Information: CVE-2025-4598

## Vulnerability Description
A vulnerability was found in systemd-coredump. This flaw allows an attacker to force a SUID process to crash and replace it with a non-SUID binary to access the originals privileged process coredump, allowing the attacker to read sensitive data, such as /etc/shadow content, loaded by the original process. A SUID binary or process has a special type of permission, which allows the process to run with the file owners permissions, regardless of the user executing the binary. This allows the process to access more restricted data than unprivileged users or processes would be able to. An attacker can leverage this flaw by forcing a SUID process to crash and force the Linux kernel to recycle the process PID before systemd-coredump can analyze the /proc/pid/auxv file. If the attacker wins the **race condition**, they gain access to the originals SUID process coredump file. They can read sensitive content loaded into memory by the original binary, affecting data confidentiality.

### Vulnerability Description Key Phrases
- **rootcause:** **race condition**
- **impact:** access original SUID process coredump file and access privileged process coredump and read sensitive content and read sensitive data
- **vector:** forcing a SUID process to crash
- **attacker:** attacker
- **product:** systemd-coredump

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on CVE-2025-4598:

**Content from bugzilla.redhat.com_d157eb03_20250624_142329.html (text)**

*   **Relevance:** This content is **relevant** as it directly mentions CVE-2025-4598 and provides details about the vulnerability.
*   **Extracted Information:**
    *   **CVE ID:** CVE-2025-4598
    *   **Summary:**  systemd-coredump: race condition that allows a local attacker t... (incomplete - truncated by Bugzilla)
    *   **Description:** A race condition in systemd-coredump allows a local attacker to crash a SUID program and gain read access to the resulting core dump.
    *   **Weaknesses/Vulnerabilities:** Race condition in systemd-coredump.
    *   **Impact of Exploitation:** A local attacker can crash a SUID program and gain read access to the resulting core dump.
    *   **Product:** Security Response
    *   **Classification:** Other
    *   **Component:** vulnerability
    *   **OS:** Linux
    *   **Severity:** medium
    *   **Assignee:** Product Security DevOps Team
    *   **Depends On:** Bug 2369244, 2369246, 2369245, 2369247 (related bugs)
    *   **Reported:** 2025-05-29
    *   **Modified:** 2025-06-02

**Content from lists.openwall.net_ae5d8845_20250624_204226.html (text)**

*   **Relevance:**  This content is **not relevant** because it's a mailing list archive listing for Openwall. It lists mailing lists. It does not contain vulnerability information.

**Content from www.openwall.com_aff47406_20250624_142330.html (text)**

*   **Relevance:**  This content is **not relevant** because it is a webpage that links to different Openwall products.

**Content from www.openwall.com_bc2440b2_20250624_142327.html (text)**

*   **Relevance:**  This content is **not relevant** because it links to different Openwall products and projects.

**Content from lists.openwall.net_ae5d8845_20250624_204226.html (text)**

*   **Relevance:** This content is **not relevant** because it's a webpage that links to different Openwall mailing lists.

**Content from lists.openwall.net_ae5d8845_20250624_204226.html (text)**

*   **Relevance:**  This content is **not relevant** because it's a webpage that links to different Openwall mailing lists.

**Content from www.openwall.com_bc2440b2_20250624_142327.html (text)**

*   **Relevance:**  This content is **not relevant** because it's a webpage that links to different Openwall products.

**Content from lists.openwall.net_ae5d8845_20250624_204226.html (text)**

*   **Relevance:** This content is **not relevant** because it is a mailing list archive listing for Openwall.

**Content from www.openwall.com_ff0141a7_20250624_204227.html (text)**

*   **Relevance:** This content is **not relevant** because it's a web page that lists the blists software.

**Content from access.redhat.com_123c8f56_20250624_142328.html (stripped)**
*   **Relevance:** This content is **not relevant** because it is a Red Hat customer portal with links to different services.

**Content from access.redhat.com_123c8f56_20250624_204226.html (stripped)**
*   **Relevance:** This content is **not relevant** because it is a Red Hat customer portal with links to different services.

**Content from bugzilla.redhat.com_d157eb03_20250624_142329.html (text)**

*   **Relevance:** This content is **relevant** as it directly mentions CVE-2025-4598 and provides details about the vulnerability.
*   **Extracted Information:**
    *   **CVE ID:** CVE-2025-4598
    *   **Summary:** CVE-2025-4598 systemd-coredump: race condition that allows a local attacker t...
    *   **Description:** A race condition in systemd-coredump allows a local attacker to crash a SUID program and gain read access to the resulting core dump
    *   **Weaknesses/Vulnerabilities:** Race condition in systemd-coredump.
    *   **Impact of Exploitation:** A local attacker can crash a SUID program and gain read access to the resulting core dump.
    *   **Product:** Security Response
    *   **Classification:** Other
    *   **Component:** vulnerability
    *   **OS:** Linux
    *   **Severity:** medium
    *   **Assignee:** Product Security DevOps Team
    *   **Depends On:** Bug 2369244, 2369246, 2369245, 2369247 (related bugs)
    *   **Reported:** 2025-05-29
    *   **Modified:** 2025-06-02

**Content from the Email with subject "Local information disclosure in apport and systemd-coredump"**

*   **Relevance:** This email is **highly relevant** as it's a Qualys Security Advisory that details both CVE-2025-5054 (apport) and CVE-2025-4598 (systemd-coredump). It provides detailed analysis, proof-of-concept code, and mitigation strategies.
*   **Extracted Information (for CVE-2025-4598):**
    *   **Root cause of vulnerability:** A race condition in systemd-coredump. Specifically, the lack of protection against the "kill-and-replace" attack, where an attacker can replace a crashed SUID process with a non-SUID process before systemd-coredump analyzes the process's memory.
    *   **Weaknesses/Vulnerabilities present:**
        *   Race condition in systemd-coredump's handling of core dumps.
        *   systemd-coredump does not protect against the "kill-and-replace" race condition.
    *   **Impact of exploitation:** Local information disclosure. An attacker can crash a SUID program and gain read access to the resulting core dump, leading to the potential for reading sensitive information like /etc/shadow.  The advisory highlights an attack against root daemons where an attacker can crash root daemons that fork() and setuid() to the attacker's uid, gain read access to the resulting core dumps, and therefore to the root daemons' memory, leading to the leakage of secrets.
    *   **Attack vectors:**
        *   Crashing a SUID program using a core-dumping signal (SIGSEGV or SIGSYS).
        *   Rapidly replacing the crashed SUID process with a non-SUID process (with matching UIDs/GIDs) before systemd-coredump analyzes the core dump.
    *   **Required attacker capabilities/position:** Local, unprivileged user account. Ability to execute code and send signals.
    *   **Mitigation or fix:**
        *   Set `/proc/sys/fs/suid_dumpable` to `0` (SUID_DUMP_DISABLE) to prevent SUID programs and root daemons from being analyzed in case of a crash.  This is a temporary fix.
        *   The recommended long-term fix:
            *   Always take account of the kernel's per-process "dumpable" flag (the %d specifier) when determining whether a non-root user should have access to a core dump.
            *   Use the new %F specifier in `/proc/sys/kernel/core_pattern` (a pidfd to the crashed process) to detect if the crashed process has been replaced.
    *   **More Detail than Official CVE:** This content provides *significantly* more detail than a typical CVE description, including:
        *   Detailed analysis of the vulnerability.
        *   Detailed attack vectors.
        *   Two Proof-of-Concept programs
        *   Specific examples of vulnerable daemons
        *   A description of the root cause and the various checks/defenses that were attempted in systemd-coredump and why those defenses failed.

**Content from the Reply with subject "Re: Local information disclosure in apport and systemd-coredump"**
*   **Relevance:** This content is **relevant** because it discusses a PoC for the CVE and provides information on the exploit.
*   **Extracted Information:**
    *   **Attack vector:** Crashing a SUID program and quickly replacing it with a non-SUID process.
    *   **Vulnerable Program:** unix\_chkpwd
    *   **Additional Information:** The email mentions that with a low kernel.pid\_max, the race condition succeeds frequently and with some inotify, the attacker can get password hashes.

**Content from the Reply with subject "Re: Local information disclosure in apport and systemd-coredump"**
*   **Relevance:** This content is **relevant** because it provides information on the impact of the CVE, fixes to it, and the CVSS score.
*   **Extracted Information:**
    *   **Impact:** Local information disclosure on RHEL 9.
    *   **Affected Programs:** systemd
    *   **Fix:** The fix involves taking the kernel's per-process "dumpable" flag into consideration, and by using the new %F specifier.
    *   **Attack Complexity:** Low
    *   **Threat impact:** Important.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.968 |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.942 |
| 4 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.919 |
| 5 | 276 | Incorrect Default Permissions | Base | Allowed | sparse | 0.892 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.871 |
| 7 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.869 |
| 8 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.862 |
| 9 | 250 | Execution with Unnecessary Privileges | Base | Allowed | dense | 0.555 |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | Base | Allowed | graph | 0.002 |


---

## CWE Classification Guidance

The following guidance has been automatically included because relevant keywords were detected in the vulnerability description:

### Privileges vs Permissions Guidance

## ===Guidance===

### Level Set – Privileges vs Permissions (in Access Control Context)

**Privileges**

* Represents the *actor's identity level* or capabilities (e.g., root, admin, regular user, guest).
* Commonly defined by roles or security contexts assigned during session creation or login.
* Often involved in **privilege escalation** (e.g., a regular user gaining admin rights).
* 🔍 *Who* the user is and *what they are supposed to be able to do.*

**Permissions**

* Represents *what actions are allowed* on specific resources (files, services, APIs).
* Usually attached to *resources*, not people.
* Permissions can be affected dynamically by changes in role or context.
* 🔍 *What* the user is allowed to do to *which resource.*

#### Short Rule:

> **Privileges** = rights assigned to a user role
> **Permissions** = access rules applied to specific objects/resources

---

### Mapping Discussion – CWE Usage for Privileges vs Permissions

#### 🔸 CWE-266: **Incorrect Privilege Assignment**

* The system assigns incorrect privileges to a user (e.g., admin instead of guest).
* Often the result of misconfigured roles or faulty logic during account provisioning.
* ✅ *“A user created with the ‘guest’ role was assigned admin privileges due to a logic flaw.”*

#### 🔸 CWE-250: **Execution with Unnecessary Privileges**

* Code runs with higher privileges than needed to complete its function.
* Often found in daemons, services, or mobile apps that don't drop privileges.
* ✅ *“The backup service runs as root but only needs read access.”*

#### 🔸 CWE-284: **Improper Access Control** (Parent/Generic)

* Used when the system fails to enforce restrictions on access to resources.
* If no specific privilege or permission mistake is identifiable, use this.
* ⚠️ This is **often overused**. Only default to 284 if children like 285 or 266 don't fit.

#### 🔸 CWE-285: **Improper Authorization**

* A subset of access control failures where the system incorrectly allows an action based on flawed permission checking.
* Think: "The check is there but doesn't work properly."
* ✅ *“User can access another user’s invoice due to logic flaw in role verification.”*

---

## Mapping Examples – Privilege Issues

### Bad Mapping Example (Incorrect use of CWE-269):

> *“User can escalate privileges to admin.”*
> ❌ Mapping: CWE-269 (*discouraged – only shows technical impact, not cause*)
> ✅ Correct mapping (if cause known):

* Misconfigured roles: **CWE-266**
* Permission not dropped after privilege change: **CWE-250**
* Role-check bypass via logic flaw: **CWE-863**

---

## Technical Impact Phrases – Privilege vs Permission Mapping Cues

| Phrase                                      | Suggests                              | Possible CWE                                 |
| ------------------------------------------- | ------------------------------------- | -------------------------------------------- |
| “Escalate to root/admin”                    | Privilege escalation impact           | Not CWE-269! Use root cause (e.g., 266, 250) |
| “Assigned wrong role/group”                 | Misassigned privilege                 | CWE-266                                      |
| “Runs as root” or “Should not run as admin” | Over-privileged execution             | CWE-250                                      |
| “Unauthorized read/write to file”           | Permission control issue              | CWE-285                                      |
| “Can access resource without correct role”  | Incorrect or missing permission check | CWE-285, 862, 863                            |

---

## Good Mapping Examples – Privileges & Permissions

* ✅ **CWE-266**: *“When a new user registers, the system assigns them admin role due to a missing role validation.”*
* ✅ **CWE-250**: *“Installer runs with system-level privileges but doesn't require them to install files in the user directory.”*
* ✅ **CWE-284**: *“Inconsistent access rules between UI and backend for sensitive endpoints.”*
* ✅ **CWE-285**: *“Authorization logic fails to restrict access to finance reports based on department.”*

---

## Summary Table – CWE Quick Selection Guide

| Symptom                                                             | Root Cause            | Best CWE    |
| ------------------------------------------------------------------- | --------------------- | ----------- |
| User gets higher privilege role (e.g., admin) by mistake            | Role misassignment    | **CWE-266** |
| Code runs with elevated privileges it doesn’t need                  | No privilege dropping | **CWE-250** |
| Access control is wrong but unclear if it's permission or privilege | General flaw          | **CWE-284** |
| Permissions are improperly checked                                  | Flawed logic          | **CWE-285** |
| Identity is never checked                                           | Authentication issue  | **CWE-306** |
| Authorization logic is completely missing                           | **CWE-862**           |             |
| Authorization logic is present but flawed                           | **CWE-863**           |             |


