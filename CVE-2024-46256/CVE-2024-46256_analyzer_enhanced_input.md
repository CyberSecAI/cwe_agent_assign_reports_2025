## Vulnerability Description
A **Command injection** vulnerability in requestLetsEncryptSsl in NginxProxyManager 2.11.3 allows an attacker to RCE via Add Lets Encrypt Certificate.

### Vulnerability Description Key Phrases
- **weakness:** **Command injection**
- **impact:** RCE and remote code execution
- **vector:** Add Lets Encrypt Certificate
- **attacker:** attacker
- **product:** NginxProxyManager
- **version:** 2.11.3
- **component:** requestLetsEncryptSsl

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The application was vulnerable to command injection because it was using user-supplied input without proper sanitization when constructing shell commands.",
    "weaknesses": [
      "Command Injection",
	    "Improper Input Sanitization"
    ],
    "impact": "An attacker could execute arbitrary shell commands on the server by injecting malicious commands into the DNS provider credentials field.",
    "attack_vectors": [
      "By crafting a malicious string containing shell commands in the 'dns_provider_credentials' field when requesting or renewing a Let's Encrypt certificate via a DNS challenge."
    ],
    "required_attacker_capabilities": "The attacker needs to be an authenticated user with the ability to create or modify certificates and specify DNS provider credentials.",
    "additional_details": "The vulnerability was present in how the application handled DNS provider credentials for Let's Encrypt certificate requests using DNS challenges. Specifically, when creating a temporary file to store credentials, the application concatenated the unsanitized user input into the shell command used to create the file and set the permissions, resulting in code execution. This was resolved by using built-in Node.js functions to write and delete the credential file instead of using shell commands."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.135 |
| 4 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.133 |
| 5 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | sparse | 0.132 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.128 |
| 7 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.127 |
| 8 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.120 |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | dense | 0.524 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-790: Improper Filtering of Special Elements

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-1236: Improper Neutralization of Formula Elements in a CSV File

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-918: Server-Side Request Forgery (SSRF)

CWE-117: Improper Output Neutralization for Logs