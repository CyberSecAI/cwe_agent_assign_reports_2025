# Vulnerability Information: CVE-2025-21617

## Vulnerability Description
Guzzle OAuth Subscriber signs Guzzle requests using OAuth 1.0. Prior to 0.8.1, **Nonce generation does not use sufficient entropy nor a cryptographically secure pseudorandom source**. This can leave servers vulnerable to replay attacks when TLS is not used. This vulnerability is fixed in 0.8.1.

### Vulnerability Description Key Phrases
- **rootcause:** **Nonce generation does not use sufficient entropy nor a cryptographically secure pseudorandom source**
- **impact:** replay attacks
- **product:** Guzzle OAuth Subscriber
- **version:** prior to 0.8.1

## CVE Reference Links Content Summary
CVE-2025-21617

**Root cause of vulnerability:**

Nonce generation does not use sufficient entropy nor a cryptographically secure pseudorandom source. Specifically, the `generateNonce` function in `src/Oauth1.php` used `uniqid()` and `sha1()` which are not cryptographically secure for generating nonces.

**Weaknesses/vulnerabilities present:**

*   CWE-338: Insufficient Randomness

**Impact of exploitation:**

This can leave servers vulnerable to replay attacks when TLS is not used.

**Attack vectors:**

Replay attacks when TLS is not used.

**Required attacker capabilities/position:**

An attacker capable of intercepting and replaying OAuth requests without TLS protection.

**Mitigation or fix:**

Upgrade to version 0.8.1 or higher. The fix replaces the insecure nonce generation with `bin2hex(random_bytes(20))`, which uses a cryptographically secure pseudorandom number generator.

**Additional Details:**

The provided content includes details beyond the official CVE description, specifically the code changes made in the 0.8.1 release to address the vulnerability. It also references a similar vulnerability, CVE-2025-22376.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.361 |
| 2 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.336 |
| 3 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.310 |
| 4 | 1204 | Generation of Weak Initialization Vector (IV) | Base | Allowed | sparse | 0.301 |
| 5 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.286 |
| 6 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.283 |
| 7 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.282 |
| 8 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.280 |
| 9 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | Allowed | dense | 0.451 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |

