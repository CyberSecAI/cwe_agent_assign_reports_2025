## Vulnerability Description
A security issue was discovered in ingress-nginx https//github.com/kubernetes/ingress-nginx where the `auth-url` Ingress annotation can be used to inject configuration into nginx. This can lead to arbitrary code execution in the context of the ingress-nginx controller, and disclosure of Secrets accessible to the controller. (Note that in the default installation, the controller can access all Secrets cluster-wide.)

### Vulnerability Description Key Phrases
- **vector:** ingress-nginx auth-url Ingress annotation
- **product:** ingress-nginx
- **impact:** ['arbitrary code execution', 'disclosure of Secrets']

## CVE Reference Links Content Summary
## Analysis of CVE-2025-24514 Content

This content **IS RELATED** to CVE-2025-24514. It provides detailed information about the vulnerability.

**Root cause of vulnerability:**

The `auth-url` Ingress annotation in ingress-nginx can be used to inject configuration into nginx.

**Weaknesses/vulnerabilities present:**

*   Configuration injection
*   Arbitrary code execution in the context of the ingress-nginx controller.
*   Disclosure of Secrets accessible to the controller (potentially all cluster-wide Secrets in default installations).

**Impact of exploitation:**

*   Arbitrary code execution
*   Secret disclosure

**Attack vectors:**

*   Exploitation through a crafted `auth-url` annotation within an Ingress resource.

**Required attacker capabilities/position:**

*   Low privilege access to modify Ingress resources.

**Mitigation or fix:**

*   **Upgrade:** Upgrade ingress-nginx to v1.11.5, v1.12.1, or any later version.
*   **CLI Argument:** Enable the `enable-annotation-validation` CLI argument set to “true” prior to upgrading.
*   **Detection:** Monitor for suspicious data within the `auth-url` annotation of Ingress resources.

**Additional Details (more than official CVE description):**

*   **CVSS Score:** 8.8 (High) - CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
*   **Affected Versions:** < v1.11.0, v1.11.0 - 1.11.4, v1.12.0
*   **Fixed Version:** ingress-nginx [main@ab470eb](https://github.com/kubernetes/ingress-nginx/pull/13068/commits/ab470eb920924d62a197ebddd8a4cc3031a77ddf)
*   **Acknowledgements:**  The vulnerability was reported by Nir Ohfeld, Ronen Shustin and Sagi Tzadik from Wiz and fixed/coordinated by Marco Ebert, James Strong, Tabitha Sable, and the Kubernetes Security Response Committee.
*   **Detection:** Suspicious data within the `auth-url` annotation of an Ingress resource.
*   **Contact:** security@kubernetes.io if exploitation is suspected.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1007 | Insufficient Visual Distinction of Homoglyphs Presented to User | Base | Allowed | alternate_terms | 0.700 |
| 2 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | alternate_terms | 0.700 |
| 3 | 1022 | Use of Web Link to Untrusted Target with window.opener Access | Variant | Allowed | alternate_terms | 0.700 |
| 4 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.128 |
| 5 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.127 |
| 6 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.126 |
| 7 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.124 |
| 8 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.123 |
| 9 | 306 | Missing Authentication for Critical Function | Base | Allowed | dense | 0.521 |
| 10 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-1007: Insufficient Visual Distinction of Homoglyphs Presented to User

CWE-1021: Improper Restriction of Rendered UI Layers or Frames

CWE-1022: Use of Web Link to Untrusted Target with window.opener Access

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-256: Plaintext Storage of a Password

CWE-522: Insufficiently Protected Credentials

CWE-668: Exposure of Resource to Wrong Sphere

CWE-287: Improper Authentication

CWE-306: Missing Authentication for Critical Function

CWE-942: Permissive Cross-domain Policy with Untrusted Domains