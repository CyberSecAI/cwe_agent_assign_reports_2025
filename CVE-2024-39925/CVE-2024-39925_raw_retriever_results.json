{
  "query": "An issue was discovered in Vaultwarden (formerly Bitwarden_RS) 1.30.3. It lacks an offboarding process for members who leave an organization. As a result, the shared organization key is not rotated when a member departs. Consequently, the departing member, whose access should be revoked, retains a copy of the organization key. Additionally, the application fails to adequately protect some encrypted data stored on the server. Consequently, an authenticated user could gain unauthorized access to encrypted data of any organization, even if the user is not a member of the targeted organization. However, the user would need to know the corresponding organizationId. Hence, if a user (whose access to an organization has been revoked) already possesses the organization key, that user could use the key to decrypt the leaked data.",
  "keyphrases": {
    "rootcause": [
      "lacking offboarding process"
    ]
  },
  "timestamp": "2025-07-12T03:07:24.613047",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "259",
        "name": "Use of Hard-coded Password",
        "abstraction": "variant",
        "score": 2.68272,
        "description": "CWE-259: Use of Hard-coded Password...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "321",
        "name": "Use of Hard-coded Cryptographic Key",
        "abstraction": "variant",
        "score": 1.96992,
        "description": "CWE-321: Use of Hard-coded Cryptographic Key...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "298",
        "name": "Improper Validation of Certificate Expiration",
        "abstraction": "variant",
        "score": 1.91472,
        "description": "CWE-298: Improper Validation of Certificate Expiration...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 1.6911534025493171,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "309",
        "name": "Use of Password System for Primary Authentication",
        "abstraction": "base",
        "score": 1.6707600000000002,
        "description": "CWE-309: Use of Password System for Primary Authentication...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1204",
        "name": "Generation of Weak Initialization Vector (IV)",
        "abstraction": "Base",
        "score": 1.6103742240053114,
        "description": "The product uses a cryptographic primitive that uses an Initialization\n\t\t\tVector (IV), but the product does not generate IVs that are\n\t\t\tsufficiently unpredictable or unique according to the expected\n...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "613",
        "name": "Insufficient Session Expiration",
        "abstraction": "Base",
        "score": 1.5326880350277703,
        "description": "According to WASC, \"Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.\"...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "386",
        "name": "Symbolic Name not Mapping to Correct Object",
        "abstraction": "base",
        "score": 1.521,
        "description": "CWE-386: Symbolic Name not Mapping to Correct Object...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1291",
        "name": "Public Key Re-Use for Signing both Debug and Production Code",
        "abstraction": "base",
        "score": 1.521,
        "description": "CWE-1291: Public Key Re-Use for Signing both Debug and Production Code...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "324",
        "name": "Use of a Key Past its Expiration Date",
        "abstraction": "Base",
        "score": 1.4924951582271944,
        "description": "The product uses a cryptographic key or password past its expiration date, which diminishes its safety significantly by increasing the timing window for cracking attacks against that key....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1394",
        "name": "Use of Default Cryptographic Key",
        "abstraction": "Base",
        "score": 1.4892251437298052,
        "description": "The product uses a default cryptographic key for potentially critical functionality....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "262",
        "name": "Not Using Password Aging",
        "abstraction": "Base",
        "score": 1.4323946096733706,
        "description": "The product does not have a mechanism in place for managing password aging....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "class",
        "score": 1.4080000000000001,
        "description": "CWE-863: Incorrect Authorization...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "287",
        "name": "Improper Authentication",
        "abstraction": "class",
        "score": 1.3648,
        "description": "CWE-287: Improper Authentication...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "656",
        "name": "Reliance on Security Through Obscurity",
        "abstraction": "class",
        "score": 1.3600000000000003,
        "description": "CWE-656: Reliance on Security Through Obscurity...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "384",
        "name": "Session Fixation",
        "abstraction": "compound",
        "score": 1.3388000000000002,
        "description": "CWE-384: Session Fixation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "abstraction": "compound",
        "score": 1.2880000000000003,
        "description": "CWE-352: Cross-Site Request Forgery (CSRF)...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "942",
        "name": "Permissive Cross-domain Policy with Untrusted Domains",
        "abstraction": "variant",
        "score": 1.2864,
        "description": "CWE-942: Permissive Cross-domain Policy with Untrusted Domains...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1275",
        "name": "Sensitive Cookie with Improper SameSite Attribute",
        "abstraction": "variant",
        "score": 1.2624,
        "description": "CWE-1275: Sensitive Cookie with Improper SameSite Attribute...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "abstraction": "Base",
        "score": 1.2575829219926544,
        "description": "The web application does not sufficiently verify inputs that are assumed to be immutable but are actually externally controllable, such as hidden form fields....",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "1394",
        "name": "Use of Default Cryptographic Key",
        "abstraction": "Base",
        "score": 0.5040999035043072,
        "description": "The product uses a default cryptographic key for potentially critical functionality....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "324",
        "name": "Use of a Key Past its Expiration Date",
        "abstraction": "Base",
        "score": 0.5018829184891025,
        "description": "The product uses a cryptographic key or password past its expiration date, which diminishes its safety significantly by increasing the timing window for cracking attacks against that key....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1204",
        "name": "Generation of Weak Initialization Vector (IV)",
        "abstraction": "Base",
        "score": 0.4852225398675762,
        "description": "The product uses a cryptographic primitive that uses an Initialization\n\t\t\tVector (IV), but the product does not generate IVs that are\n\t\t\tsufficiently unpredictable or unique according to the expected\n...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "759",
        "name": "Use of a One-Way Hash without a Salt",
        "abstraction": "Variant",
        "score": 0.48056259625731307,
        "description": "The product uses a one-way cryptographic hash against an input that should not be reversible, such as a password, but the product does not also use a salt as part of the input....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 0.4789862841018999,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "331",
        "name": "Insufficient Entropy",
        "abstraction": "Base",
        "score": 0.4787059051033964,
        "description": "The product uses an algorithm or scheme that produces insufficient entropy, leaving patterns or clusters of values that are more likely to occur than others....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "370",
        "name": "Missing Check for Certificate Revocation after Initial Check",
        "abstraction": "Variant",
        "score": 0.47766592370088923,
        "description": "The product does not check the revocation status of a certificate after its initial revocation check, which can cause the product to perform privileged actions even after the certificate is revoked at...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1391",
        "name": "Use of Weak Credentials",
        "abstraction": "Class",
        "score": 0.47588846541871804,
        "description": "The product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "640",
        "name": "Weak Password Recovery Mechanism for Forgotten Password",
        "abstraction": "Base",
        "score": 0.4746606344075205,
        "description": "The product contains a mechanism for users to recover or change their passwords without knowing the original password, but the mechanism is weak....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "262",
        "name": "Not Using Password Aging",
        "abstraction": "Base",
        "score": 0.4732700833063747,
        "description": "The product does not have a mechanism in place for managing password aging....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "620",
        "name": "Unverified Password Change",
        "abstraction": "Base",
        "score": 0.4695368203251751,
        "description": "When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "283",
        "name": "Unverified Ownership",
        "abstraction": "Base",
        "score": 0.4673219521295962,
        "description": "The product does not properly verify that a critical resource is owned by the proper entity....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "922",
        "name": "Insecure Storage of Sensitive Information",
        "abstraction": "Class",
        "score": 0.46621835370300896,
        "description": "The product stores sensitive information without properly limiting read or write access by unauthorized actors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "613",
        "name": "Insufficient Session Expiration",
        "abstraction": "Base",
        "score": 0.4652700105930919,
        "description": "According to WASC, \"Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.\"...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "257",
        "name": "Storing Passwords in a Recoverable Format",
        "abstraction": "Base",
        "score": 0.46496102110767124,
        "description": "The storage of passwords in a recoverable format makes them subject to password reuse attacks by malicious users. In fact, it should be noted that recoverable encrypted passwords provide no significan...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "359",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
        "abstraction": "Base",
        "score": 0.46382826828278506,
        "description": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have t...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "307",
        "name": "Improper Restriction of Excessive Authentication Attempts",
        "abstraction": "Base",
        "score": 0.46321538866610945,
        "description": "The product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "304",
        "name": "Missing Critical Step in Authentication",
        "abstraction": "Base",
        "score": 0.46108881002502033,
        "description": "The product implements an authentication technique, but it skips a step that weakens the technique....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "286",
        "name": "Incorrect User Management",
        "abstraction": "Class",
        "score": 0.46090848780078425,
        "description": "The product does not properly manage a user within its environment....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "325",
        "name": "Missing Cryptographic Step",
        "abstraction": "Base",
        "score": 0.4605970118017215,
        "description": "The product does not implement a required step in a cryptographic algorithm, resulting in weaker encryption than advertised by the algorithm....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "610",
        "name": "Externally Controlled Reference to a Resource in Another Sphere",
        "abstraction": "Class",
        "score": 704.9776216258335,
        "description": "The product uses an externally controlled name or reference that resolves to a resource that is outside of the intended control sphere....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 702.6004985440671,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "321",
        "name": "Use of Hard-coded Cryptographic Key",
        "abstraction": "Variant",
        "score": 689.7406309773296,
        "description": "The use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 686.547094196221,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "287",
        "name": "Improper Authentication",
        "abstraction": "Class",
        "score": 666.8548410671859,
        "description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 665.6548344835267,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "abstraction": "Base",
        "score": 652.950034498756,
        "description": "The product does not verify, or incorrectly verifies, the cryptographic signature for data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1390",
        "name": "Weak Authentication",
        "abstraction": "Class",
        "score": 646.3875537270048,
        "description": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "abstraction": "Class",
        "score": 645.3369347621635,
        "description": "The product uses a broken or risky cryptographic algorithm or protocol....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "abstraction": "Class",
        "score": 636.1214224897761,
        "description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information....",
        "mapping_usage": "Discouraged"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.4605970118017215,
      "max": 0.5040999035043072,
      "mean": 0.47369456892960315,
      "median": 0.4714034518157749,
      "count": 20
    },
    "sparse": {
      "min": 636.1214224897761,
      "max": 704.9776216258335,
      "mean": 669.7171466371864,
      "median": 666.2548377753562,
      "count": 10
    },
    "graph": {
      "min": 1.2575829219926544,
      "max": 2.68272,
      "mean": 1.554721674760271,
      "median": 1.4908601509784998,
      "count": 20
    }
  }
}