# Raw Retriever Results for CVE-2024-38346

# Raw Retriever Results for CVE-2024-38346
## Query
The CloudStack cluster service runs on unauthenticated port (default 9090) that can be misused to run arbitrary commands on targeted hypervisors and CloudStack management server hosts. Some of these commands were found to have command injection vulnerabilities that can result in arbitrary code execution via agents on the hosts that may run as a privileged user. An attacker that can reach the cluster service on the unauthenticated port (default 9090), can exploit this to perform remote code execution on CloudStack managed hosts and result in complete compromise of the confidentiality, integrity, and availability of CloudStack managed infrastructure. Users are recommended to restrict the network access to the cluster service port (default 9090) on a CloudStack management server host to only its peer CloudStack management server hosts. Users are recommended to upgrade to version 4.18.2.1, 4.19.0.2 or later, which addresses this issue.

## Keyphrases
- **weakness**: 'command injection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4827 | 0.5365 | 0.4985 | 0.4960 | 20 |
| Sparse | 737.5398 | 1000.0000 | 789.0695 | 758.4504 | 11 |
| Graph | 1.2864 | 2.8652 | 1.7716 | 1.7378 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 322 | Key Exchange without Entity Authentication | base | 2.8652 | Allowed |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 2.4089 | Allowed |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 2.3987 | Allowed |
| 4 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 5 | 611 | Improper Restriction of XML External Entity Reference | base | 2.1190 | Allowed |
| 6 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.0400 | Allowed |
| 7 | 425 | Direct Request ('Forced Browsing') | base | 1.8252 | Allowed |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 10 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | class | 1.7680 | Allowed-with-Review |
| 11 | 250 | Execution with Unnecessary Privileges | Base | 1.7075 | Allowed |
| 12 | 306 | Missing Authentication for Critical Function | Base | 1.6615 | Allowed |
| 13 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 14 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | class | 1.4080 | Allowed-with-Review |
| 15 | 494 | Download of Code Without Integrity Check | base | 1.3676 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.5365 | 0.5365 | Allowed |
| 2 | 250 | Execution with Unnecessary Privileges | Base | 0.5270 | 0.5270 | Allowed |
| 3 | 306 | Missing Authentication for Critical Function | Base | 0.5193 | 0.5193 | Allowed |
| 4 | 269 | Improper Privilege Management | Class | 0.5062 | 0.5062 | Discouraged |
| 5 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.5053 | 0.5053 | Allowed |
| 6 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.5051 | 0.5051 | Allowed |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.4993 | 0.4993 | Allowed |
| 8 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | 0.4985 | 0.4985 | Discouraged |
| 9 | 284 | Improper Access Control | Pillar | 0.4983 | 0.4983 | Discouraged |
| 10 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4976 | 0.4976 | Allowed |
| 11 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.4944 | 0.4944 | Allowed |
| 12 | 732 | Incorrect Permission Assignment for Critical Resource | Class | 0.4930 | 0.4930 | Allowed-with-Review |
| 13 | 862 | Missing Authorization | Class | 0.4907 | 0.4907 | Allowed-with-Review |
| 14 | 522 | Insufficiently Protected Credentials | Class | 0.4906 | 0.4906 | Allowed-with-Review |
| 15 | 532 | Insertion of Sensitive Information into Log File | Base | 0.4854 | 0.4854 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 611 | Improper Restriction of XML External Entity Reference | 869.2145 | 869.2145 | Allowed |
| 3 | 306 | Missing Authentication for Critical Function | 792.7392 | 792.7392 | Allowed |
| 4 | 269 | Improper Privilege Management | 773.4948 | 773.4948 | Discouraged |
| 5 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 773.3553 | 773.3553 | Allowed-with-Review |
| 6 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 758.4504 | 758.4504 | Allowed |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | 748.1900 | 748.1900 | Allowed-with-Review |
| 8 | 287 | Improper Authentication | 745.8463 | 745.8463 | Discouraged |
| 9 | 285 | Improper Authorization | 740.8004 | 740.8004 | Discouraged |
| 10 | 863 | Incorrect Authorization | 740.1336 | 740.1336 | Allowed-with-Review |
| 11 | 20 | Improper Input Validation | 737.5398 | 737.5398 | Discouraged |
