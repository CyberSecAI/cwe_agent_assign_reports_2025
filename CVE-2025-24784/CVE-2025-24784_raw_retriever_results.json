{
  "query": "kubewarden-controller is a Kubernetes controller that allows you to dynamically register Kubewarden admission policies. The policy group feature, added to by the 1.17.0 release. By being namespaced, the AdmissionPolicyGroup has a well constrained impact on cluster resources. Hence, its considered safe to allow non-admin users to create and manage these resources in the namespaces they own. Kubewarden policies can be allowed to query the Kubernetes API at evaluation time these types of policies are called context aware. Context aware policies can perform list and get operations against a Kubernetes cluster. The queries are done using the ServiceAccount of the Policy Server instance that hosts the policy. That means that access to the cluster is determined by the RBAC rules that apply to that ServiceAccount. The AdmissionPolicyGroup CRD allowed the deployment of context aware policies. This could allow an attacker to obtain information about resources that are out of their reach, by leveraging a higher access to the cluster granted to the ServiceAccount token used to run the policy. The impact of this vulnerability depends on the privileges that have been granted to the ServiceAccount used to run the Policy Server and assumes that users are using the recommended best practices of keeping the Policy Servers ServiceAccount least privileged. By default, the Kubewarden helm chart grants access to the following resources (cluster wide) only Namespace, Pod, Deployment and Ingress. This vulnerability is fixed in 1.21.0.",
  "keyphrases": {
    "rootcause": [
      "The AdmissionPolicyGroup CRD allowed the deployment of context aware policies"
    ],
    "weakness": [
      "query the Kubernetes API at evaluation time"
    ]
  },
  "timestamp": "2025-07-12T10:49:57.323917",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "1275",
        "name": "Sensitive Cookie with Improper SameSite Attribute",
        "abstraction": "variant",
        "score": 2.2704,
        "description": "CWE-1275: Sensitive Cookie with Improper SameSite Attribute...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "322",
        "name": "Key Exchange without Entity Authentication",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-322: Key Exchange without Entity Authentication...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "350",
        "name": "Reliance on Reverse DNS Resolution for a Security-Critical Action",
        "abstraction": "variant",
        "score": 2.04,
        "description": "CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "613",
        "name": "Insufficient Session Expiration",
        "abstraction": "base",
        "score": 1.6744000000000003,
        "description": "CWE-613: Insufficient Session Expiration...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "386",
        "name": "Symbolic Name not Mapping to Correct Object",
        "abstraction": "base",
        "score": 1.6744000000000003,
        "description": "CWE-386: Symbolic Name not Mapping to Correct Object...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "842",
        "name": "Placement of User into Incorrect Group",
        "abstraction": "Base",
        "score": 1.6742027579247263,
        "description": "The product or the administrator places a user into an incorrect group....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1268",
        "name": "Policy Privileges are not Assigned Consistently Between Control and Data Agents",
        "abstraction": "Base",
        "score": 1.6394708033546084,
        "description": "The product's hardware-enforced access control for a particular resource improperly accounts for privilege discrepancies between control and write policies.\n\t\t\t   ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1220",
        "name": "Insufficient Granularity of Access Control",
        "abstraction": "Base",
        "score": 1.6296936143374667,
        "description": "The product implements access controls via a policy or other feature with the intention to disable or restrict accesses (reads and/or writes) to assets in a system from untrusted agents. However, impl...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "352",
        "name": "Cross-Site Request Forgery (CSRF)",
        "abstraction": "compound",
        "score": 1.61,
        "description": "CWE-352: Cross-Site Request Forgery (CSRF)...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "689",
        "name": "Permission Race Condition During Resource Copy",
        "abstraction": "compound",
        "score": 1.61,
        "description": "CWE-689: Permission Race Condition During Resource Copy...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "abstraction": "compound",
        "score": 1.61,
        "description": "CWE-61: UNIX Symbolic Link (Symlink) Following...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "abstraction": "class",
        "score": 1.4080000000000001,
        "description": "CWE-732: Incorrect Permission Assignment for Critical Resource...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "base",
        "score": 1.3676000000000001,
        "description": "CWE-476: NULL Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "variant",
        "score": 1.2624,
        "description": "CWE-416: Use After Free...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "425",
        "name": "Direct Request ('Forced Browsing')",
        "abstraction": "base",
        "score": 1.2261600000000001,
        "description": "CWE-425: Direct Request ('Forced Browsing')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "384",
        "name": "Session Fixation",
        "abstraction": "compound",
        "score": 1.1600000000000001,
        "description": "CWE-384: Session Fixation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "266",
        "name": "Incorrect Privilege Assignment",
        "abstraction": "Base",
        "score": 1.0827458572419415,
        "description": "A product incorrectly assigns a privilege to a particular actor, creating an unintended sphere of control for that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "346",
        "name": "Origin Validation Error",
        "abstraction": "class",
        "score": 1.0304000000000002,
        "description": "CWE-346: Origin Validation Error...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "441",
        "name": "Unintended Proxy or Intermediary ('Confused Deputy')",
        "abstraction": "class",
        "score": 1.0304000000000002,
        "description": "CWE-441: Unintended Proxy or Intermediary ('Confused Deputy')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "340",
        "name": "Generation of Predictable Numbers or Identifiers",
        "abstraction": "class",
        "score": 1.0304000000000002,
        "description": "CWE-340: Generation of Predictable Numbers or Identifiers...",
        "mapping_usage": "Allowed-with-Review"
      }
    ],
    "dense": [
      {
        "cwe_id": "1268",
        "name": "Policy Privileges are not Assigned Consistently Between Control and Data Agents",
        "abstraction": "Base",
        "score": 0.48353192303583875,
        "description": "The product's hardware-enforced access control for a particular resource improperly accounts for privilege discrepancies between control and write policies.\n\t\t\t   ...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "842",
        "name": "Placement of User into Incorrect Group",
        "abstraction": "Base",
        "score": 0.4623878723318611,
        "description": "The product or the administrator places a user into an incorrect group....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1220",
        "name": "Insufficient Granularity of Access Control",
        "abstraction": "Base",
        "score": 0.4573642486761341,
        "description": "The product implements access controls via a policy or other feature with the intention to disable or restrict accesses (reads and/or writes) to assets in a system from untrusted agents. However, impl...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "286",
        "name": "Incorrect User Management",
        "abstraction": "Class",
        "score": 0.4376125247218131,
        "description": "The product does not properly manage a user within its environment....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "642",
        "name": "External Control of Critical State Data",
        "abstraction": "Class",
        "score": 0.43369655061471324,
        "description": "The product stores security-critical state information about its users, or the product itself, in a location that is accessible to unauthorized actors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 0.43189048440401745,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "267",
        "name": "Privilege Defined With Unsafe Actions",
        "abstraction": "Base",
        "score": 0.42706144030120846,
        "description": "A particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "214",
        "name": "Invocation of Process Using Visible Sensitive Information",
        "abstraction": "Base",
        "score": 0.42228608793814615,
        "description": "A process is invoked with sensitive command-line arguments, environment variables, or other elements that can be seen by other processes on the operating system....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "183",
        "name": "Permissive List of Allowed Inputs",
        "abstraction": "Base",
        "score": 0.42203046006336403,
        "description": "The product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are explicitly allowed by policy because the inputs are assumed to be safe, but the list is...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 0.42088006606267425,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "862",
        "name": "Missing Authorization",
        "abstraction": "Class",
        "score": 0.4132531602867222,
        "description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 0.4128243388467153,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "942",
        "name": "Permissive Cross-domain Policy with Untrusted Domains",
        "abstraction": "Variant",
        "score": 0.40038810946473347,
        "description": "The product uses a cross-domain policy file that includes domains that should not be trusted....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 0.40001596208574997,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "552",
        "name": "Files or Directories Accessible to External Parties",
        "abstraction": "Base",
        "score": 0.39811855949925834,
        "description": "The product makes files or directories accessible to unauthorized actors, even though they should not be....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 0.3980158601269044,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "529",
        "name": "Exposure of Access Control List Files to an Unauthorized Control Sphere",
        "abstraction": "Variant",
        "score": 0.39786064033306523,
        "description": "The product stores access control list files in a directory or other container that is accessible to actors outside of the intended control sphere....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "90",
        "name": "Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')",
        "abstraction": "Base",
        "score": 0.39778065775348526,
        "description": "The product constructs all or part of an LDAP query using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modi...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "284",
        "name": "Improper Access Control",
        "abstraction": "Pillar",
        "score": 0.39644448767639195,
        "description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "184",
        "name": "Incomplete List of Disallowed Inputs",
        "abstraction": "Base",
        "score": 0.3947548262840109,
        "description": "The product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are not allowed by policy or otherwise require other action to neutralize before additional...",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "abstraction": "Class",
        "score": 1439.5042253347456,
        "description": "The product establishes a communication channel to (or from) an endpoint for privileged or protected operations, but it does not properly ensure that it is communicating with the correct endpoint....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 1421.6636581853718,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 1322.606919501005,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "696",
        "name": "Incorrect Behavior Order",
        "abstraction": "Class",
        "score": 1280.7428048903669,
        "description": "The product performs multiple related behaviors, but the behaviors are performed in the wrong order in ways which may produce resultant weaknesses....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "abstraction": "Class",
        "score": 1277.5472332584472,
        "description": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "532",
        "name": "Insertion of Sensitive Information into Log File",
        "abstraction": "Base",
        "score": 1274.8594393225158,
        "description": "The product writes sensitive information to a log file....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1220",
        "name": "Insufficient Granularity of Access Control",
        "abstraction": "Base",
        "score": 1272.204967252254,
        "description": "The product implements access controls via a policy or other feature with the intention to disable or restrict accesses (reads and/or writes) to assets in a system from untrusted agents. However, impl...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "552",
        "name": "Files or Directories Accessible to External Parties",
        "abstraction": "Base",
        "score": 1259.6600479617273,
        "description": "The product makes files or directories accessible to unauthorized actors, even though they should not be....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "942",
        "name": "Permissive Cross-domain Policy with Untrusted Domains",
        "abstraction": "Variant",
        "score": 1251.780465810756,
        "description": "The product uses a cross-domain policy file that includes domains that should not be trusted....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 1250.2505462227687,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "269",
        "name": "Improper Privilege Management",
        "abstraction": "Class",
        "score": 1148.6921196147339,
        "description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor....",
        "mapping_usage": "Discouraged"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.3947548262840109,
      "max": 0.48353192303583875,
      "mean": 0.42040991302534036,
      "median": 0.41706661317469823,
      "count": 20
    },
    "sparse": {
      "min": 1148.6921196147339,
      "max": 1439.5042253347456,
      "mean": 1290.8647661231537,
      "median": 1274.8594393225158,
      "count": 11
    },
    "graph": {
      "min": 1.0304000000000002,
      "max": 2.2704,
      "mean": 1.5120336516429371,
      "median": 1.61,
      "count": 20
    }
  }
}