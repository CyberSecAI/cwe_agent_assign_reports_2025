# Raw Retriever Results for CVE-2025-24784

# Raw Retriever Results for CVE-2025-24784
## Query
kubewarden-controller is a Kubernetes controller that allows you to dynamically register Kubewarden admission policies. The policy group feature, added to by the 1.17.0 release. By being namespaced, the AdmissionPolicyGroup has a well constrained impact on cluster resources. Hence, its considered safe to allow non-admin users to create and manage these resources in the namespaces they own. Kubewarden policies can be allowed to query the Kubernetes API at evaluation time these types of policies are called context aware. Context aware policies can perform list and get operations against a Kubernetes cluster. The queries are done using the ServiceAccount of the Policy Server instance that hosts the policy. That means that access to the cluster is determined by the RBAC rules that apply to that ServiceAccount. The AdmissionPolicyGroup CRD allowed the deployment of context aware policies. This could allow an attacker to obtain information about resources that are out of their reach, by leveraging a higher access to the cluster granted to the ServiceAccount token used to run the policy. The impact of this vulnerability depends on the privileges that have been granted to the ServiceAccount used to run the Policy Server and assumes that users are using the recommended best practices of keeping the Policy Servers ServiceAccount least privileged. By default, the Kubewarden helm chart grants access to the following resources (cluster wide) only Namespace, Pod, Deployment and Ingress. This vulnerability is fixed in 1.21.0.

## Keyphrases
- **rootcause**: 'The AdmissionPolicyGroup CRD allowed the deployment of context aware policies'
- **weakness**: 'query the Kubernetes API at evaluation time'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3948 | 0.4835 | 0.4204 | 0.4171 | 20 |
| Sparse | 1148.6921 | 1439.5042 | 1290.8648 | 1274.8594 | 11 |
| Graph | 1.0304 | 2.2704 | 1.5120 | 1.6100 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 2.2704 | Allowed |
| 2 | 322 | Key Exchange without Entity Authentication | base | 2.2100 | Allowed |
| 3 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.0400 | Allowed |
| 4 | 613 | Insufficient Session Expiration | base | 1.6744 | Allowed |
| 5 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 6 | 842 | Placement of User into Incorrect Group | Base | 1.6742 | Allowed |
| 7 | 1268 | Policy Privileges are not Assigned Consistently Between Control and Data Agents | Base | 1.6395 | Allowed |
| 8 | 1220 | Insufficient Granularity of Access Control | Base | 1.6297 | Allowed |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.6100 | Allowed |
| 10 | 689 | Permission Race Condition During Resource Copy | compound | 1.6100 | Allowed |
| 11 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 12 | 732 | Incorrect Permission Assignment for Critical Resource | class | 1.4080 | Allowed-with-Review |
| 13 | 476 | NULL Pointer Dereference | base | 1.3676 | Allowed |
| 14 | 416 | Use After Free | variant | 1.2624 | Allowed |
| 15 | 425 | Direct Request ('Forced Browsing') | base | 1.2262 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1268 | Policy Privileges are not Assigned Consistently Between Control and Data Agents | Base | 0.4835 | 0.4835 | Allowed |
| 2 | 842 | Placement of User into Incorrect Group | Base | 0.4624 | 0.4624 | Allowed |
| 3 | 1220 | Insufficient Granularity of Access Control | Base | 0.4574 | 0.4574 | Allowed |
| 4 | 286 | Incorrect User Management | Class | 0.4376 | 0.4376 | Allowed-with-Review |
| 5 | 642 | External Control of Critical State Data | Class | 0.4337 | 0.4337 | Allowed-with-Review |
| 6 | 863 | Incorrect Authorization | Class | 0.4319 | 0.4319 | Allowed-with-Review |
| 7 | 267 | Privilege Defined With Unsafe Actions | Base | 0.4271 | 0.4271 | Allowed |
| 8 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.4223 | 0.4223 | Allowed |
| 9 | 183 | Permissive List of Allowed Inputs | Base | 0.4220 | 0.4220 | Allowed |
| 10 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.4209 | 0.4209 | Allowed |
| 11 | 862 | Missing Authorization | Class | 0.4133 | 0.4133 | Allowed-with-Review |
| 12 | 285 | Improper Authorization | Class | 0.4128 | 0.4128 | Discouraged |
| 13 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | 0.4004 | 0.4004 | Allowed |
| 14 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4000 | 0.4000 | Allowed |
| 15 | 552 | Files or Directories Accessible to External Parties | Base | 0.3981 | 0.3981 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 1439.5042 | 1439.5042 | Allowed-with-Review |
| 2 | 863 | Incorrect Authorization | 1421.6637 | 1421.6637 | Allowed-with-Review |
| 3 | 285 | Improper Authorization | 1322.6069 | 1322.6069 | Discouraged |
| 4 | 696 | Incorrect Behavior Order | 1280.7428 | 1280.7428 | Allowed-with-Review |
| 5 | 732 | Incorrect Permission Assignment for Critical Resource | 1277.5472 | 1277.5472 | Allowed-with-Review |
| 6 | 532 | Insertion of Sensitive Information into Log File | 1274.8594 | 1274.8594 | Allowed |
| 7 | 1220 | Insufficient Granularity of Access Control | 1272.2050 | 1272.2050 | Allowed |
| 8 | 552 | Files or Directories Accessible to External Parties | 1259.6600 | 1259.6600 | Allowed |
| 9 | 942 | Permissive Cross-domain Policy with Untrusted Domains | 1251.7805 | 1251.7805 | Allowed |
| 10 | 306 | Missing Authentication for Critical Function | 1250.2505 | 1250.2505 | Allowed |
| 11 | 269 | Improper Privilege Management | 1148.6921 | 1148.6921 | Discouraged |
