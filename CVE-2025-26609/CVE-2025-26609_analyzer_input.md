# Vulnerability Information: CVE-2025-26609

## Vulnerability Description
WeGIA is an open source Web Manager for Institutions with a focus on Portuguese language users. A **SQL Injection** vulnerability was discovered in the WeGIA application, `familiar_docfamiliar.php` endpoint. This vulnerability could allow an attacker to execute arbitrary SQL queries, allowing unauthorized access to sensitive information. This issue has been addressed in version 3.2.14 and all users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **SQL Injection**
- **impact:** execute arbitrary SQL queries
- **attacker:** attacker
- **product:** WeGIA
- **version:** before 3.2.14
- **component:** familiar_docfamiliar.php endpoint

## CVE Reference Links Content Summary
CVE-2025-26609 is related to the content. Here's the extracted information:

**Root cause of vulnerability:**
Lack of validation of user input in the `familiar_docfamiliar.php` endpoint.

**Weaknesses/vulnerabilities present:**
SQL Injection (CWE-89, CWE-284)

**Impact of exploitation:**
- Retrieving sensitive data
- DoS Attack (dropping SQL tables)
- File Upload (under certain conditions)

**Attack vectors:**
- `POST /html/atendido/familiar_docfamiliar.php`
- Parameters: `id_dependente`, `id_doc`
- Exploitation possible even without being logged in due to improper execution termination after session validation.

**Required attacker capabilities/position:**
No privileges required, no user interaction needed, network access is sufficient.

**Mitigation or fix:**
Patched versions: 3.2.13. Affected versions: <=3.2.11. (The content does not detail *how* the vulnerability was fixed, only that it was patched.)

**PoC:**
`curl -X POST "localhost:8080/html/atendido/familiar_docfamiliar.php" --data "id_doc=999&id_dependente=1+AND+(SELECT+299+FROM+(SELECT(SLEEP(5)))a)&action=excluir"`
or
`curl -X POST "localhost:8080/html/atendido/familiar_docfamiliar.php" --data "id_doc=999+AND+(SELECT+299+FROM+(SELECT(SLEEP(5)))a)&id_dependente=1&action=excluir"`

**Severity:**
Critical (CVSS score: 10.0)

**CVSS v4 base metrics:**
AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H

This content provides more detail than the official CVE description (which is currently a placeholder).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.386 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.379 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.379 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.371 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.369 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.364 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.362 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.510 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

