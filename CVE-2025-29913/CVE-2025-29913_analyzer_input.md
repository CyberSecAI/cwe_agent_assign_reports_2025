# Vulnerability Information: CVE-2025-29913

## Vulnerability Description
CryptoLib provides a software-only solution using the CCSDS Space Data Link Security Protocol - Extended Procedures (SDLS-EP) to secure communications between a spacecraft running the core Flight System (cFS) and a ground station. A critical **heap buffer overflow** vulnerability was identified in the `Crypto_TC_Prep_AAD` function of CryptoLib versions 1.3.3 and prior. This vulnerability allows an attacker to trigger a Denial of Service (DoS) or potentially execute arbitrary code (RCE) by providing a maliciously crafted telecommand (TC) frame that causes an unsigned integer underflow. The vulnerability lies in the function `Crypto_TC_Prep_AAD`, specifically during the computation of `tc_mac_start_index`. The affected code incorrectly calculates the MAC start index without ensuring it remains within the bounds of the `ingest` buffer. When `tc_mac_start_index` underflows due to an incorrect length calculation, the function attempts to access an out-of-bounds memory location, leading to a segmentation fault. The vulnerability is still present in the repository as of commit `d3cc420ace96d02a5b7e83d88cbd2e48010d5723`.

### Vulnerability Description Key Phrases
- **component:** Crypto_TC_Prep_AAD function
- **vector:** maliciously crafted telecommand (TC) frame
- **weakness:** **heap buffer overflow**
- **product:** CryptoLib
- **impact:** Denial of Service (DoS), potentially execute arbitrary code (RCE), segmentation fault
- **version:** versions 1.3.3 and prior

## CVE Reference Links Content Summary
## Analysis of CVE-2025-29913 Content

This content **IS RELATED** to CVE-2025-29913. It provides a detailed security advisory regarding a heap buffer overflow vulnerability in the CryptoLib library. The content provides more detail than the placeholder CVE description.

Here's an extraction of the relevant information:

**Root cause of vulnerability:**

*   The calculation of `tc_mac_start_index` can result in an underflow when `tc_sdls_processed_frame->tc_header.fl` is smaller than `fecf_len + sa_ptr->stmacf_len`.
*   This leads to an out-of-bounds read when copying memory from `ingest`.

**Weaknesses/vulnerabilities present:**

*   Heap buffer overflow
*   Integer underflow (unsigned integer underflow)
*   CWE-125: Out-of-bounds write
*   CWE-191: Integer Underflow/Overflow

**Impact of exploitation:**

*   Denial of Service (DoS): Application crash due to out-of-bounds memory access.
*   Remote Code Execution (RCE): Potential for arbitrary code execution if the overflow is exploited to manipulate the heap.

**Attack vectors:**

*   Network: The vulnerability is exploitable over the network.
*   Maliciously crafted telecommand (TC) frame. Specifically, the provided PoC packet: `080300080B00000AE3B20E`

**Required attacker capabilities/position:**

*   No privileges required.
*   No user interaction required.
*   Network access to the system using the vulnerable library.

**Mitigation or fix:**

*   The advisory states that the vulnerability is still present in the latest commit of the advisory fix branch (`d3cc420ace96d02a5b7e83d88cbd2e48010d5723`) as of the time of the advisory. No patched versions are listed.

**CVSS Score:**

*   9.8 (Critical)
*   CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**Affected versions:**

*   <= 1.3.3

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.830 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.829 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.815 |
| 6 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.805 |
| 7 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.785 |
| 8 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.766 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.594 |
| 10 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | Allowed | graph | 0.002 |

