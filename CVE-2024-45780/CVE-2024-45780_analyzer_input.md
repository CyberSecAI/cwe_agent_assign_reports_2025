# Vulnerability Information: CVE-2024-45780

## Vulnerability Description
A flaw was found in grub2. When reading tar files, grub2 allocates an internal buffer for the file name. However, it **fails to properly verify the allocation against possible **integer overflow**s**. Its possible to cause the allocation length to overflow with a crafted tar file, leading to a heap out-of-bounds write. This flaw eventually allows an attacker to circumvent secure boot protections.

### Vulnerability Description Key Phrases
- **rootcause:** **fails to properly verify the allocation against possible integer overflows**
- **vector:** crafted tar file
- **weakness:** **integer overflow**
- **product:** grub2
- **impact:** allocate a small buffer for the file name, heap out-of-bounds write, circumvent secure boot protections

## CVE Reference Links Content Summary
```
**Root cause of vulnerability:**
When reading tar files, grub2 allocates an internal buffer for the file name, but it fails to properly verify the allocation against possible integer overflows.

**Weaknesses/vulnerabilities present:**
Integer Overflow causes Heap OOB Write.

**Impact of exploitation:**
An attacker may leverage this to eventually circumvent secure boot protections.

**Attack vectors:**
Crafted tar file.

**Required attacker capabilities/position:**
An attacker may leverage this by crafting a malicious tar file.

**Mitigation or fix:**
The content mentions that this vulnerability is fixed by upstream patches that are in the GRUB2 git repository.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 2 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.457 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.453 |
| 4 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | sparse | 0.443 |
| 5 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.433 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.431 |
| 7 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.423 |
| 8 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.418 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.558 |
| 10 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | Allowed | graph | 0.002 |

