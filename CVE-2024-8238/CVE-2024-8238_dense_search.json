{
  "retriever": "dense",
  "query": "In version 3.22.0 of aimhubio/aim, the AimQL query language uses an outdated version of the safer_getattr() function from RestrictedPython. This version does not protect against the str.format_map() method, allowing an attacker to leak server-side secrets or potentially gain unrestricted code execution. The vulnerability arises because str.format_map() can read arbitrary attributes of Python objects, enabling attackers to access sensitive variables such as os.environ. If an attacker can write files to a known location on the Aim server, they can use str.format_map() to load a malicious .dll/.so file into the Python interpreter, leading to unrestricted code execution.",
  "keyphrases": {
    "rootcause": [
      "outdated version of safer_getattr() function"
    ],
    "weakness": [
      "str.format_map() can read arbitrary attributes of Python objects"
    ]
  },
  "timestamp": "2025-07-12 07:54:28",
  "cve_id": "CVE-2024-8238",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "36",
      "name": "Absolute Path Traversal",
      "type": "Base",
      "score": 0.4786403949272902
    },
    {
      "cwe_id": "134",
      "name": "Use of Externally-Controlled Format String",
      "type": "Base",
      "score": 0.47255650737914545
    },
    {
      "cwe_id": "749",
      "name": "Exposed Dangerous Method or Function",
      "type": "Base",
      "score": 0.4560170260501376
    },
    {
      "cwe_id": "676",
      "name": "Use of Potentially Dangerous Function",
      "type": "Base",
      "score": 0.4537881483372722
    },
    {
      "cwe_id": "943",
      "name": "Improper Neutralization of Special Elements in Data Query Logic",
      "type": "Class",
      "score": 0.4529528795482883
    },
    {
      "cwe_id": "598",
      "name": "Use of GET Request Method With Sensitive Query Strings",
      "type": "Variant",
      "score": 0.45287139444847285
    },
    {
      "cwe_id": "202",
      "name": "Exposure of Sensitive Information Through Data Queries",
      "type": "Base",
      "score": 0.4522204142700186
    },
    {
      "cwe_id": "540",
      "name": "Inclusion of Sensitive Information in Source Code",
      "type": "Base",
      "score": 0.450070417497383
    },
    {
      "cwe_id": "359",
      "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      "type": "Base",
      "score": 0.44923425507079917
    },
    {
      "cwe_id": "790",
      "name": "Improper Filtering of Special Elements",
      "type": "Class",
      "score": 0.4490405687498787
    },
    {
      "cwe_id": "267",
      "name": "Privilege Defined With Unsafe Actions",
      "type": "Base",
      "score": 0.44466913515143114
    },
    {
      "cwe_id": "89",
      "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
      "type": "Base",
      "score": 0.4230904488876459
    },
    {
      "cwe_id": "214",
      "name": "Invocation of Process Using Visible Sensitive Information",
      "type": "Base",
      "score": 0.4222576226038217
    },
    {
      "cwe_id": "472",
      "name": "External Control of Assumed-Immutable Web Parameter",
      "type": "Base",
      "score": 0.41970601151306985
    },
    {
      "cwe_id": "434",
      "name": "Unrestricted Upload of File with Dangerous Type",
      "type": "Base",
      "score": 0.41850911247821587
    },
    {
      "cwe_id": "532",
      "name": "Insertion of Sensitive Information into Log File",
      "type": "Base",
      "score": 0.41824693956736264
    },
    {
      "cwe_id": "95",
      "name": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "type": "Variant",
      "score": 0.41818915277642776
    },
    {
      "cwe_id": "918",
      "name": "Server-Side Request Forgery (SSRF)",
      "type": "Base",
      "score": 0.41610870689766516
    },
    {
      "cwe_id": "285",
      "name": "Improper Authorization",
      "type": "Class",
      "score": 0.4157475528645919
    },
    {
      "cwe_id": "915",
      "name": "Improperly Controlled Modification of Dynamically-Determined Object Attributes",
      "type": "Base",
      "score": 0.41560063102285016
    }
  ]
}