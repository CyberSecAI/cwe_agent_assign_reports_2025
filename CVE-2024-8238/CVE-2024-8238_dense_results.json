{
  "query": "In version 3.22.0 of aimhubio/aim, the AimQL query language uses an outdated version of the safer_getattr() function from RestrictedPython. This version does not protect against the str.format_map() method, allowing an attacker to leak server-side secrets or potentially gain unrestricted code execution. The vulnerability arises because str.format_map() can read arbitrary attributes of Python objects, enabling attackers to access sensitive variables such as os.environ. If an attacker can write files to a known location on the Aim server, they can use str.format_map() to load a malicious .dll/.so file into the Python interpreter, leading to unrestricted code execution.",
  "count": 20,
  "results": [
    {
      "cwe_id": "36",
      "name": "Absolute Path Traversal",
      "abstraction": "Base",
      "score": 0.4786403949272902,
      "original_score": 0.4786403949272902,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "134",
      "name": "Use of Externally-Controlled Format String",
      "abstraction": "Base",
      "score": 0.47255650737914545,
      "original_score": 0.47255650737914545,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "749",
      "name": "Exposed Dangerous Method or Function",
      "abstraction": "Base",
      "score": 0.4560170260501376,
      "original_score": 0.4560170260501376,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "676",
      "name": "Use of Potentially Dangerous Function",
      "abstraction": "Base",
      "score": 0.4537881483372722,
      "original_score": 0.4537881483372722,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "943",
      "name": "Improper Neutralization of Special Elements in Data Query Logic",
      "abstraction": "Class",
      "score": 0.4529528795482883,
      "original_score": 0.4529528795482883,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "598",
      "name": "Use of GET Request Method With Sensitive Query Strings",
      "abstraction": "Variant",
      "score": 0.45287139444847285,
      "original_score": 0.45287139444847285,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "202",
      "name": "Exposure of Sensitive Information Through Data Queries",
      "abstraction": "Base",
      "score": 0.4522204142700186,
      "original_score": 0.4522204142700186,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "540",
      "name": "Inclusion of Sensitive Information in Source Code",
      "abstraction": "Base",
      "score": 0.450070417497383,
      "original_score": 0.450070417497383,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "359",
      "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      "abstraction": "Base",
      "score": 0.44923425507079917,
      "original_score": 0.44923425507079917,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "790",
      "name": "Improper Filtering of Special Elements",
      "abstraction": "Class",
      "score": 0.4490405687498787,
      "original_score": 0.4490405687498787,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "267",
      "name": "Privilege Defined With Unsafe Actions",
      "abstraction": "Base",
      "score": 0.44466913515143114,
      "original_score": 0.44466913515143114,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "89",
      "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
      "abstraction": "Base",
      "score": 0.4230904488876459,
      "original_score": 0.4230904488876459,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "214",
      "name": "Invocation of Process Using Visible Sensitive Information",
      "abstraction": "Base",
      "score": 0.4222576226038217,
      "original_score": 0.4222576226038217,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "472",
      "name": "External Control of Assumed-Immutable Web Parameter",
      "abstraction": "Base",
      "score": 0.41970601151306985,
      "original_score": 0.41970601151306985,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "434",
      "name": "Unrestricted Upload of File with Dangerous Type",
      "abstraction": "Base",
      "score": 0.41850911247821587,
      "original_score": 0.41850911247821587,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "532",
      "name": "Insertion of Sensitive Information into Log File",
      "abstraction": "Base",
      "score": 0.41824693956736264,
      "original_score": 0.41824693956736264,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "95",
      "name": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "abstraction": "Variant",
      "score": 0.41818915277642776,
      "original_score": 0.41818915277642776,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "918",
      "name": "Server-Side Request Forgery (SSRF)",
      "abstraction": "Base",
      "score": 0.41610870689766516,
      "original_score": 0.41610870689766516,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "285",
      "name": "Improper Authorization",
      "abstraction": "Class",
      "score": 0.4157475528645919,
      "original_score": 0.4157475528645919,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "915",
      "name": "Improperly Controlled Modification of Dynamically-Determined Object Attributes",
      "abstraction": "Base",
      "score": 0.41560063102285016,
      "original_score": 0.41560063102285016,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.41560063102285016,
    "max": 0.4786403949272902,
    "mean": 0.4389758660020884,
    "median": 0.4468548519506549,
    "count": 20
  }
}