# Raw Retriever Results for CVE-2025-37743

# Raw Retriever Results for CVE-2025-37743
## Query
In the Linux kernel, the following vulnerability has been resolved wifi ath12k Avoid memory leak while enabling statistics Driver uses monitor destination rings for extended statistics mode and standalone monitor mode. In extended statistics mode, TLVs are parsed from the buffer received from the monitor destination ring and assigned to the ppdu_info structure to update per-packet statistics. In standalone monitor mode, along with per-packet statistics, the packet data (payload) is captured, and the driver updates per MSDU to mac80211. When the AP interface is enabled, only extended statistics mode is activated. As part of enabling monitor rings for collecting statistics, the driver subscribes to HAL_RX_MPDU_START TLV in the filter configuration. This TLV is received from the monitor destination ring, and kzalloc for the mon_mpdu object occurs, which is not freed, leading to a memory leak. The kzalloc for the mon_mpdu object is only required while enabling the standalone monitor interface. This causes a memory leak while enabling extended statistics mode in the driver. Fix this memory leak by removing the kzalloc for the mon_mpdu object in the HAL_RX_MPDU_START TLV handling. Additionally, remove the standalone monitor mode handlings in the HAL_MON_BUF_ADDR and HAL_RX_MSDU_END TLVs. These TLV tags will be handled properly when enabling standalone monitor mode in the future. Tested-on QCN9274 hw2.0 PCI WLAN.WBE.1.3.1-00173-QCAHKSWPL_SILICONZ-1 Tested-on WCN7850 hw2.0 PCI WLAN.HMT.1.0.c5-00481-QCAHMTSWPL_V1.0_V2.0_SILICONZ-3

## Keyphrases
- **weakness**: 'memory leak'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4697 | 0.5748 | 0.4952 | 0.4894 | 20 |
| Sparse | 338.9158 | 1148.7852 | 943.4427 | 981.2888 | 11 |
| Graph | 1.6100 | 3.4866 | 2.0638 | 1.8037 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 125 | Out-of-bounds Read | base | 3.4866 | Allowed |
| 2 | 908 | Use of Uninitialized Resource | Base | 2.8186 | Allowed |
| 3 | 129 | Improper Validation of Array Index | variant | 2.6784 | Allowed |
| 4 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 5 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 6 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 8 | 170 | Improper Null Termination | base | 2.2100 | Allowed |
| 9 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 10 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 13 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 14 | 909 | Missing Initialization of Resource | Class | 1.7633 | Allowed-with-Review |
| 15 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5748 | 0.5748 | Allowed |
| 2 | 909 | Missing Initialization of Resource | Class | 0.5427 | 0.5427 | Allowed-with-Review |
| 3 | 908 | Use of Uninitialized Resource | Base | 0.5129 | 0.5129 | Allowed |
| 4 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.5126 | 0.5126 | Allowed |
| 5 | 121 | Stack-based Buffer Overflow | Variant | 0.5074 | 0.5074 | Allowed |
| 6 | 126 | Buffer Over-read | Variant | 0.5068 | 0.5068 | Allowed |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5024 | 0.5024 | Allowed |
| 8 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.4976 | 0.4976 | Allowed |
| 9 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4940 | 0.4940 | Allowed |
| 10 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4940 | 0.4940 | Allowed |
| 11 | 122 | Heap-based Buffer Overflow | Variant | 0.4848 | 0.4848 | Allowed |
| 12 | 911 | Improper Update of Reference Count | Base | 0.4827 | 0.4827 | Allowed |
| 13 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4817 | 0.4817 | Discouraged |
| 14 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4781 | 0.4781 | Allowed |
| 15 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4743 | 0.4743 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | 1148.7852 | 1148.7852 | Allowed |
| 2 | 125 | Out-of-bounds Read | 1069.1731 | 1069.1731 | Allowed |
| 3 | 126 | Buffer Over-read | 1004.3573 | 1004.3573 | Allowed |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | 994.8271 | 994.8271 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 982.0550 | 982.0550 | Allowed-with-Review |
| 6 | 197 | Numeric Truncation Error | 981.2888 | 981.2888 | Allowed |
| 7 | 476 | NULL Pointer Dereference | 977.3238 | 977.3238 | Allowed |
| 8 | 306 | Missing Authentication for Critical Function | 962.6297 | 962.6297 | Allowed |
| 9 | 732 | Incorrect Permission Assignment for Critical Resource | 959.9779 | 959.9779 | Allowed-with-Review |
| 10 | 667 | Improper Locking | 958.5356 | 958.5356 | Allowed-with-Review |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | 338.9158 | 338.9158 | Allowed |
