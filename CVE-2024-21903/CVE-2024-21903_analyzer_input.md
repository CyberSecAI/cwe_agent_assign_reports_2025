# Vulnerability Information: CVE-2024-21903

## Vulnerability Description
An **OS command injection** vulnerability has been reported to affect several QNAP operating system versions. If exploited, the vulnerability could allow authenticated administrators to execute commands via a network. We have already fixed the vulnerability in the following versions QTS 5.1.6.2722 build 20240402 and later QuTS hero h5.1.6.2734 build 20240414 and later

### Vulnerability Description Key Phrases
- **weakness:** **OS command injection**
- **impact:** execute commands
- **attacker:** authenticated administrators
- **product:** QNAP QTS and QuTS hero
- **version:** 5.1.6.2722 and h5.1.6.2734

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-78

#### Top CWEs
- CWE-78 (Count: 32)
- CWE-77 (Count: 3)

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is due to an OS command injection.",
    "weaknesses": [
      "OS command injection"
    ],
    "impact": "Successful exploitation could allow remote attackers to inject malicious commands.",
     "attack_vectors": [
      "Remote"
    ],
    "attacker_capabilities": "The attacker needs to have gained user access to the system."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.327 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.312 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.295 |
| 6 | 610 | Externally Controlled Reference to a Resource in Another Sphere | Class | Discouraged | sparse | 0.273 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.272 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.271 |
| 9 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | dense | 0.551 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

