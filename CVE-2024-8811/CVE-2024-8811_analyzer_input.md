# Vulnerability Information: CVE-2024-8811

## Vulnerability Description
WinZip Mark-of-the-Web Bypass Vulnerability. This vulnerability allows remote attackers to bypass the Mark-of-the-Web protection mechanism on affected installations of WinZip. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file. The specific flaw exists within the handling of archive files. When opening an archive that bears the Mark-of-the-Web, WinZip removes the Mark-of-the-Web from the archive file. Following extraction, the extracted files also lack the Mark-of-the-Web. An attacker can leverage this vulnerability to execute arbitrary code in the context of the current user. Was ZDI-CAN-23983.

### Vulnerability Description Key Phrases
- **impact:** execute arbitrary code
- **vector:** malicious page or file
- **attacker:** remote attackers
- **product:** WinZip

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

*   **Root cause of vulnerability:** The vulnerability lies in how WinZip handles archive files containing the Mark-of-the-Web (MOTW). When such an archive is opened, WinZip incorrectly removes the MOTW from the archive file itself. Subsequently, when files are extracted, they also lack the MOTW.
*   **Weaknesses/vulnerabilities present:** The core weakness is the improper handling of MOTW by WinZip, leading to the removal of security metadata which is supposed to be applied to files originating from the internet.
*   **Impact of exploitation:** An attacker can exploit this vulnerability to bypass MOTW protection, which is designed to prevent execution of untrusted files. This allows the attacker to execute arbitrary code in the context of the current user, potentially gaining complete control of the affected system.
*   **Attack vectors:** The attack vector involves tricking a user into opening a specially crafted archive file. This could be done by hosting a malicious file on a website or delivering it via email.
*   **Required attacker capabilities/position:** The attacker needs to be able to provide a malicious archive to the target user. The user must then open the malicious file, requiring user interaction, but the attacker does not need any special privileges on the system itself.

The advisory also specifies that:
* The vulnerability is fixed in WinZip 76.8
* The vulnerability was reported to the vendor on 2024-05-03
* Credit is given to Peter Girnus (@gothburz) of Trend Micro Zero Day Initiative

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.231 |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.225 |
| 3 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.224 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.218 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.217 |
| 6 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.216 |
| 7 | 1007 | Insufficient Visual Distinction of Homoglyphs Presented to User | Base | Allowed | sparse | 0.212 |
| 8 | 274 | Improper Handling of Insufficient Privileges | Base | Discouraged | sparse | 0.211 |
| 9 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | dense | 0.540 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.003 |

