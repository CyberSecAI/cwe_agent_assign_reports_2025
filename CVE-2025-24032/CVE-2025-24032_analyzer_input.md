# Vulnerability Information: CVE-2025-24032

## Vulnerability Description
PAM-PKCS#11 is a Linux-PAM login module that allows a X.509 certificate based user login. Prior to version 0.6.13, if cert_policy is set to none (the default value), then pam_pkcs11 will only check if the user is capable of logging into the token. An attacker may create a different token with the users public data (e.g. the users certificate) and a PIN known to the attacker. If no signature with the private key is required, then the attacker may now login as user with that created token. The default to *not* check the private keys signature has been changed with commit commi6638576892b59a99389043c90a1e7dd4d783b921, so that all versions starting with pam_pkcs11-0.6.0 should be affected. As a workaround, in `pam_pkcs11.conf`, set at least `cert_policy = signature`.

### Vulnerability Description Key Phrases
- **rootcause:** **pam_pkcs11 doesn't check the signature**
- **weakness:** **pam_pkcs11 doesn't check the signature**
- **impact:** attacker may now login as user with that created token
- **vector:** create a different token with the users public data
- **attacker:** attacker
- **product:** pam_pkcs11
- **version:** prior to version 0.6.13

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on information relevant to CVE-2025-24032:

**github.com_29844e08_20250624_202157.html:**

*   **Relevance:** The content discusses changes related to CVE-2025-24032 in the `pam_pkcs11` module.

    *   **Root cause of vulnerability:** The vulnerability is described as an authentication bypass that can occur if `cert_policy` is set to `none` (the default).
    *   **Weaknesses/vulnerabilities present:**  Authentication bypass.
    *   **Mitigation or fix:** The commit introduces the `no_signature` policy to explicitly disable signature checks. The default behavior now *requires* signature verification. Setting `cert_policy = signature` in `pam_pkcs11.conf` is a suggested workaround.

**github.com_64ad1aae_20250624_202151.html:**

*   **Relevance:** This commit log mentions a fix for CVE-2025-24032 in the `pam_pkcs11` module.

    *   **Root cause of vulnerability:** The vulnerability is described as an authentication bypass
    *   **Weaknesses/vulnerabilities present:** Authentication bypass.
    *   **Mitigation or fix:** The fix uses signatures to verify authentication by default.

**github.com_72239769_20250624_202201.html:**

*   **Relevance:**  This is a security advisory detailing CVE-2025-24032 in the `pam_pkcs11` module.
    *   **Impact of exploitation:**  An attacker can bypass authentication.
    *   **Root cause of vulnerability:** The vulnerability stems from the default `cert_policy = none`.
    *   **Attack vectors:** The attacker can create a token with the user's public data and a known PIN.
    *   **Required attacker capabilities/position:**  Attacker needs to create a token with the user's public data and know the attacker's PIN.
    *   **Mitigation or fix:**  Set `cert_policy = signature;` in `pam_pkcs11.conf`.

**github.com_cb3bde13_20250624_202154.html:**

*   **Relevance:** This commit log describes the fix for CVE-2025-24032.
    *   **Root cause of vulnerability:**  The default `cert_policy` setting of `none`.
    *   **Weaknesses/vulnerabilities present:** Authentication bypass.
    *   **Mitigation or fix:** The fix defaults to verifying signatures. The new `no_signature` policy is introduced to disable the signature check.

**github.com_d54a5760_20250624_202159.html:**

*   **Relevance:** This release contains the fix for CVE-2025-24032.
    *   **Mitigation or fix:** Use signatures to verify authentication by default.

**lists.debian.org_8dfaab1a_20250624_202201.html:**

*   **Relevance:** This is a Debian LTS security advisory for CVE-2025-24032.
    *   **Weaknesses/vulnerabilities present:** Authentication bypass.
    *   **Mitigation or fix:** Fixed in version 0.6.11-4+deb11u1.

**www.vicarius.io_9e767ba6_20250624_202203.html and www.vicarius.io_bf9327a8_20250624_202205.html:**

*   **Relevance:** UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.790 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.778 |
| 3 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.777 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.759 |
| 5 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.735 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.731 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.712 |
| 8 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.706 |
| 9 | 304 | Missing Critical Step in Authentication | Base | Allowed | dense | 0.433 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

