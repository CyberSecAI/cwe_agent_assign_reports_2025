# Raw Retriever Results for CVE-2025-24032

# Raw Retriever Results for CVE-2025-24032
## Query
PAM-PKCS#11 is a Linux-PAM login module that allows a X.509 certificate based user login. Prior to version 0.6.13, if cert_policy is set to none (the default value), then pam_pkcs11 will only check if the user is capable of logging into the token. An attacker may create a different token with the users public data (e.g. the users certificate) and a PIN known to the attacker. If no signature with the private key is required, then the attacker may now login as user with that created token. The default to *not* check the private keys signature has been changed with commit commi6638576892b59a99389043c90a1e7dd4d783b921, so that all versions starting with pam_pkcs11-0.6.0 should be affected. As a workaround, in `pam_pkcs11.conf`, set at least `cert_policy = signature`.

## Keyphrases
- **rootcause**: 'pam_pkcs11 doesn't check the signature'
- **weakness**: 'pam_pkcs11 doesn't check the signature'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3722 | 0.4328 | 0.3990 | 0.4010 | 20 |
| Sparse | 225.3447 | 790.2931 | 652.3019 | 721.5839 | 12 |
| Graph | 1.1587 | 2.2100 | 1.4944 | 1.4298 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 2 | 208 | Observable Timing Discrepancy | base | 2.2100 | Allowed |
| 3 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 4 | 304 | Missing Critical Step in Authentication | Base | 1.6231 | Allowed |
| 5 | 1270 | Generation of Incorrect Security Tokens | Base | 1.6205 | Allowed |
| 6 | 1394 | Use of Default Cryptographic Key | Base | 1.5762 | Allowed |
| 7 | 298 | Improper Validation of Certificate Expiration | variant | 1.5691 | Allowed |
| 8 | 301 | Reflection Attack in an Authentication Protocol | Base | 1.4752 | Allowed |
| 9 | 322 | Key Exchange without Entity Authentication | base | 1.4602 | Allowed |
| 10 | 347 | Improper Verification of Cryptographic Signature | Base | 1.4516 | Allowed |
| 11 | 1390 | Weak Authentication | class | 1.4080 | Allowed-with-Review |
| 12 | 370 | Missing Check for Certificate Revocation after Initial Check | variant | 1.4040 | Allowed |
| 13 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.3747 | Allowed |
| 14 | 863 | Incorrect Authorization | class | 1.3648 | Allowed-with-Review |
| 15 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 1.3246 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 304 | Missing Critical Step in Authentication | Base | 0.4328 | 0.4328 | Allowed |
| 2 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.4269 | 0.4269 | Allowed |
| 3 | 347 | Improper Verification of Cryptographic Signature | Base | 0.4230 | 0.4230 | Allowed |
| 4 | 1394 | Use of Default Cryptographic Key | Base | 0.4209 | 0.4209 | Allowed |
| 5 | 1270 | Generation of Incorrect Security Tokens | Base | 0.4209 | 0.4209 | Allowed |
| 6 | 565 | Reliance on Cookies without Validation and Integrity Checking | Base | 0.4176 | 0.4176 | Allowed |
| 7 | 296 | Improper Following of a Certificate's Chain of Trust | Base | 0.4160 | 0.4160 | Allowed |
| 8 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.4117 | 0.4117 | Allowed |
| 9 | 521 | Weak Password Requirements | Base | 0.4105 | 0.4105 | Allowed |
| 10 | 603 | Use of Client-Side Authentication | Base | 0.4095 | 0.4095 | Allowed |
| 11 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | 0.3924 | 0.3924 | Allowed |
| 12 | 287 | Improper Authentication | Class | 0.3920 | 0.3920 | Discouraged |
| 13 | 620 | Unverified Password Change | Base | 0.3810 | 0.3810 | Allowed |
| 14 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | 0.3803 | 0.3803 | Allowed |
| 15 | 325 | Missing Cryptographic Step | Base | 0.3782 | 0.3782 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1390 | Weak Authentication | 790.2931 | 790.2931 | Allowed-with-Review |
| 2 | 863 | Incorrect Authorization | 777.6866 | 777.6866 | Allowed-with-Review |
| 3 | 347 | Improper Verification of Cryptographic Signature | 777.1967 | 777.1967 | Allowed |
| 4 | 287 | Improper Authentication | 758.5612 | 758.5612 | Discouraged |
| 5 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 734.9623 | 734.9623 | Allowed-with-Review |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | 731.2059 | 731.2059 | Allowed |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | 711.9619 | 711.9619 | Allowed |
| 8 | 208 | Observable Timing Discrepancy | 705.9841 | 705.9841 | Allowed |
| 9 | 295 | Improper Certificate Validation | 694.9027 | 694.9027 | Allowed |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 693.9774 | 693.9774 | Allowed |
| 11 | 321 | Use of Hard-coded Cryptographic Key | 225.5459 | 225.5459 | Allowed |
| 12 | 798 | Use of Hard-coded Credentials | 225.3447 | 225.3447 | Allowed |
