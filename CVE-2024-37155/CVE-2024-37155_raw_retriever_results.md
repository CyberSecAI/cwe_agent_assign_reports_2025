# Raw Retriever Results for CVE-2024-37155

# Raw Retriever Results for CVE-2024-37155
## Query
OpenCTI is an open source platform allowing organizations to manage their cyber threat intelligence knowledge and observables. Prior to version 6.1.9, the regex validation used to prevent Introspection queries can be bypassed by removing the extra whitespace, carriage return, and line feed characters from the query. GraphQL Queries in OpenCTI can be validated using the `secureIntrospectionPlugin`. The regex check in the plkugin can be bypassed by removing the carriage return and line feed characters (`\r\n`). Running a curl command against a local instance of OpenCTI will result in a limited error message. By running the same Introspection query without the `\r\n` characters, the unauthenticated user is able to successfully run a full Introspection query. Bypassing this restriction allows the attacker to gather a wealth of information about the GraphQL endpoint functionality that can be used to perform actions and/or read data without authorization. These queries can also be weaponized to conduct a Denial of Service (DoS) attack if sent repeatedly. Users should upgrade to version 6.1.9 to receive a patch for the issue.

## Keyphrases
- **rootcause**: 'regex validation bypass'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4494 | 0.4940 | 0.4629 | 0.4601 | 20 |
| Sparse | 902.7357 | 963.5349 | 920.5153 | 915.9023 | 10 |
| Graph | 1.0062 | 2.2100 | 1.3454 | 1.4040 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 117 | Improper Output Neutralization for Logs | base | 2.2100 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | Base | 1.6466 | Allowed |
| 3 | 294 | Authentication Bypass by Capture-replay | Base | 1.6105 | Allowed |
| 4 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 1.6084 | Allowed |
| 5 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | base | 1.5210 | Allowed |
| 6 | 319 | Cleartext Transmission of Sensitive Information | Base | 1.4873 | Allowed |
| 7 | 1333 | Inefficient Regular Expression Complexity | Base | 1.4800 | Allowed |
| 8 | 1287 | Improper Validation of Specified Type of Input | Base | 1.4766 | Allowed |
| 9 | 285 | Improper Authorization | class | 1.4080 | Discouraged |
| 10 | 144 | Improper Neutralization of Line Delimiters | variant | 1.4040 | Allowed |
| 11 | 145 | Improper Neutralization of Section Delimiters | variant | 1.4040 | Allowed |
| 12 | 322 | Key Exchange without Entity Authentication | base | 1.3572 | Allowed |
| 13 | 777 | Regular Expression without Anchors | variant | 1.2000 | Allowed |
| 14 | 863 | Incorrect Authorization | Class | 1.0478 | Allowed-with-Review |
| 15 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | base | 1.0156 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1333 | Inefficient Regular Expression Complexity | Base | 0.4940 | 0.4940 | Allowed |
| 2 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.4763 | 0.4763 | Allowed |
| 3 | 777 | Regular Expression without Anchors | Variant | 0.4758 | 0.4758 | Allowed |
| 4 | 294 | Authentication Bypass by Capture-replay | Base | 0.4741 | 0.4741 | Allowed |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | 0.4732 | 0.4732 | Allowed |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.4730 | 0.4730 | Allowed-with-Review |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.4701 | 0.4701 | Allowed |
| 8 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | 0.4687 | 0.4687 | Allowed-with-Review |
| 9 | 185 | Incorrect Regular Expression | Class | 0.4674 | 0.4674 | Allowed-with-Review |
| 10 | 204 | Observable Response Discrepancy | Base | 0.4657 | 0.4657 | Allowed |
| 11 | 522 | Insufficiently Protected Credentials | Class | 0.4545 | 0.4545 | Allowed-with-Review |
| 12 | 214 | Invocation of Process Using Visible Sensitive Information | Base | 0.4533 | 0.4533 | Allowed |
| 13 | 649 | Reliance on Obfuscation or Encryption of Security-Relevant Inputs without Integrity Checking | Base | 0.4528 | 0.4528 | Allowed |
| 14 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | 0.4526 | 0.4526 | Allowed-with-Review |
| 15 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 0.4526 | 0.4526 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 963.5349 | 963.5349 | Allowed-with-Review |
| 2 | 1333 | Inefficient Regular Expression Complexity | 937.3626 | 937.3626 | Allowed |
| 3 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 922.1311 | 922.1311 | Allowed |
| 4 | 306 | Missing Authentication for Critical Function | 920.6928 | 920.6928 | Allowed |
| 5 | 285 | Improper Authorization | 919.1408 | 919.1408 | Discouraged |
| 6 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | 912.6639 | 912.6639 | Allowed |
| 7 | 20 | Improper Input Validation | 910.8310 | 910.8310 | Discouraged |
| 8 | 287 | Improper Authentication | 910.1615 | 910.1615 | Discouraged |
| 9 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 905.8984 | 905.8984 | Allowed |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 902.7357 | 902.7357 | Allowed |
