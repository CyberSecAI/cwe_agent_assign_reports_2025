# Vulnerability Information: CVE-2024-8128

## Vulnerability Description
A vulnerability, which was classified as critical, has been found in D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04 up to 20240814. This issue affects the function cgi_add_zip of the file /cgi-bin/webfile_mgr.cgi of the component HTTP POST Request Handler. The manipulation of the argument path leads to **command injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. NOTE This vulnerability only affects products that are no longer supported by the maintainer. NOTE Vendor was contacted early and confirmed that the product is end-of-life. It should be retired and replaced.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** D-Link DNS-120 and DNR-202L and DNS-315L and DNS-320 and DNS-320L and DNS-320LW and DNS-321 and DNR-322L and DNS-323 and DNS-325 and DNS-326 and DNS-327L and DNR-326 and DNS-340L and DNS-343 and DNS-345 and DNS-726-4 and DNS-1100-4 and DNS-1200-05 and DNS-1550-04
- **version:** up to 20240814
- **component:** cgi_add_zip in /cgi-bin/webfile_mgr.cgi

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The vulnerability lies in the `cgi_add_zip` function within the `/cgi-bin/webfile_mgr.cgi` file of D-Link NAS devices. The `path` variable, received via a POST request, is used in a `popen` command without proper sanitization via the `fix_path_special_char` function, leading to command injection.",
  "Weaknesses/vulnerabilities present": [
    "Command injection",
    "Insufficient input sanitization"
  ],
  "Impact of exploitation": "Successful exploitation allows attackers to execute arbitrary commands on the affected device.",
  "Attack vectors": "The attack vector is a crafted HTTP POST request to the `/cgi-bin/webfile_mgr.cgi` endpoint, specifically targeting the `cgi_add_zip` function and injecting malicious commands within the `path` variable.",
  "Required attacker capabilities/position": "The attacker needs to be able to send HTTP POST requests to the vulnerable device. The attacker needs to be on the same network as the device or have access to it through exposed services."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.746 |
| 4 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.698 |
| 5 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.694 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.683 |
| 7 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.679 |
| 8 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.663 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.645 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |

