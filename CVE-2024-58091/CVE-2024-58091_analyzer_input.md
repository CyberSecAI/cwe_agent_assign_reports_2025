# Vulnerability Information: CVE-2024-58091

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved drm/fbdev-dma Add shadow buffering for deferred I/O DMA areas are not necessarily backed by struct page, so we cannot rely on it for deferred I/O. Allocate a shadow buffer for drivers that require deferred I/O and use it as framebuffer memory. Fixes driver errors about being Unable to handle kernel NULL pointer dereference at virtual address or Unable to handle kernel paging request at virtual address. The patch splits drm_fbdev_dma_driver_fbdev_probe() in an initial allocation, which creates the DMA-backed buffer object, and a tail that sets up the fbdev data structures. There is a tail function for direct memory mappings and a tail function for deferred I/O with the shadow buffer. It is no longer possible to use deferred I/O without shadow buffer. It can be re-added if there exists a reliably test for usable struct page in the allocated DMA-backed buffer object.

### Vulnerability Description Key Phrases
- **impact:** kernel NULL pointer dereference
- **product:** Linux kernel
- **component:** drm/fbdev-dma

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.295 |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.278 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.275 |
| 4 | 908 | Use of Uninitialized Resource | Base | Allowed | sparse | 0.267 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.251 |
| 6 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.248 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.245 |
| 8 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | Allowed | sparse | 0.243 |
| 9 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | Allowed | dense | 0.490 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.002 |

