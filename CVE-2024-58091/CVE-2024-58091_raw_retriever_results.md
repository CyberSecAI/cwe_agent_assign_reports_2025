# Raw Retriever Results for CVE-2024-58091

# Raw Retriever Results for CVE-2024-58091
## Query
In the Linux kernel, the following vulnerability has been resolved drm/fbdev-dma Add shadow buffering for deferred I/O DMA areas are not necessarily backed by struct page, so we cannot rely on it for deferred I/O. Allocate a shadow buffer for drivers that require deferred I/O and use it as framebuffer memory. Fixes driver errors about being Unable to handle kernel NULL pointer dereference at virtual address or Unable to handle kernel paging request at virtual address. The patch splits drm_fbdev_dma_driver_fbdev_probe() in an initial allocation, which creates the DMA-backed buffer object, and a tail that sets up the fbdev data structures. There is a tail function for direct memory mappings and a tail function for deferred I/O with the shadow buffer. It is no longer possible to use deferred I/O without shadow buffer. It can be re-added if there exists a reliably test for usable struct page in the allocated DMA-backed buffer object.

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3881 | 0.4896 | 0.4083 | 0.4007 | 20 |
| Sparse | 236.8905 | 294.9267 | 257.8797 | 249.7120 | 10 |
| Graph | 1.6848 | 3.4866 | 2.0463 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | base | 3.4866 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.9988 | Allowed |
| 3 | 908 | Use of Uninitialized Resource | Base | 2.7829 | Allowed |
| 4 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 5 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.3400 | Allowed |
| 6 | 129 | Improper Validation of Array Index | variant | 2.1936 | Allowed |
| 7 | 456 | Missing Initialization of a Variable | variant | 2.0554 | Allowed |
| 8 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 9 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.7852 | Allowed |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 11 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 12 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 13 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 14 | 909 | Missing Initialization of Resource | Class | 1.7231 | Allowed-with-Review |
| 15 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 0.4896 | 0.4896 | Allowed |
| 2 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4303 | 0.4303 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.4214 | 0.4214 | Allowed-with-Review |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4197 | 0.4197 | Allowed |
| 5 | 1312 | Missing Protection for Mirrored Regions in On-Chip Fabric Firewall | Base | 0.4147 | 0.4147 | Allowed |
| 6 | 805 | Buffer Access with Incorrect Length Value | Base | 0.4122 | 0.4122 | Allowed |
| 7 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | 0.4105 | 0.4105 | Allowed |
| 8 | 126 | Buffer Over-read | Variant | 0.4053 | 0.4053 | Allowed |
| 9 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4042 | 0.4042 | Allowed |
| 10 | 908 | Use of Uninitialized Resource | Base | 0.4010 | 0.4010 | Allowed |
| 11 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4004 | 0.4004 | Allowed |
| 12 | 786 | Access of Memory Location Before Start of Buffer | Base | 0.4003 | 0.4003 | Discouraged |
| 13 | 822 | Untrusted Pointer Dereference | Base | 0.3993 | 0.3993 | Allowed |
| 14 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.3977 | 0.3977 | Allowed |
| 15 | 763 | Release of Invalid Pointer or Reference | Base | 0.3972 | 0.3972 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 909 | Missing Initialization of Resource | 294.9267 | 294.9267 | Allowed-with-Review |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | 277.9291 | 277.9291 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 274.6011 | 274.6011 | Allowed-with-Review |
| 4 | 908 | Use of Uninitialized Resource | 267.1464 | 267.1464 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 251.4071 | 251.4071 | Allowed |
| 6 | 667 | Improper Locking | 248.0169 | 248.0169 | Allowed-with-Review |
| 7 | 125 | Out-of-bounds Read | 244.5069 | 244.5069 | Allowed |
| 8 | 782 | Exposed IOCTL with Insufficient Access Control | 242.6186 | 242.6186 | Allowed |
| 9 | 122 | Heap-based Buffer Overflow | 240.7537 | 240.7537 | Allowed |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 236.8905 | 236.8905 | Allowed |
