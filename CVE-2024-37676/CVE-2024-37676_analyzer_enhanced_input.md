## Vulnerability Description
An issue in htop-dev htop v.2.20 allows a local attacker to cause an **out-of-bounds access** in the Header_populateFromSettings function.

### Vulnerability Description Key Phrases
- **weakness:** **out-of-bounds access**
- **attacker:** local attacker
- **product:** htop-dev htop
- **version:** v.2.20
- **component:** Header_populateFromSettings function

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-37676:

**1. Verification of CVE Relevance:**

   - The provided content includes a gist specifically named `CVE-2024-37676` by user Cirno9-dev. The gist contains a description matching the CVE ID and a description of the vulnerability, confirming its relevance.

**2. Root Cause of Vulnerability:**
   - The vulnerability stems from a mismatch between the configured number of right meter modes and the actual number of right meters defined in the htop configuration file.

**3. Weaknesses/Vulnerabilities Present:**
    - Out-of-bounds read vulnerability in the `Header_populateFromSettings` function. The function reads meter configurations based on the `right_meter_modes` setting length, but fails to check if there are enough configured `right_meters`, causing it to read beyond the bounds of the allocated memory.

**4. Impact of Exploitation:**
    - The out-of-bounds read could potentially lead to a crash, denial of service or the disclosure of sensitive information located in the memory.
    - There is no mention of other impacts, like code execution.

**5. Attack Vectors:**
    - Attack vector: Maliciously crafted htop configuration file.

**6. Required Attacker Capabilities/Position:**
    - The attacker needs to be able to influence or modify the htop configuration file used by a victim. This could be through social engineering or a supply chain attack or by having write access to user's configuration.
    - No special capabilities are needed, such as specific system calls.

**Additional Notes:**
 - The provided information gives more details than the official CVE description.
- The gist specifies the affected version as 2.2.0.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.185 |
| 2 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.183 |
| 3 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.180 |
| 4 | 129 | Improper Validation of Array Index | Variant | Allowed | sparse | 0.176 |
| 5 | 824 | Access of Uninitialized Pointer | Base | Allowed | sparse | 0.176 |
| 6 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.173 |
| 7 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | sparse | 0.173 |
| 8 | 131 | Incorrect Calculation of Buffer Size | Base | Allowed | sparse | 0.172 |
| 9 | 908 | Use of Uninitialized Resource | Base | Allowed | dense | 0.549 |
| 10 | 825 | Expired Pointer Dereference | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-125: Out-of-bounds Read

CWE-787: Out-of-bounds Write

CWE-129: Improper Validation of Array Index

CWE-824: Access of Uninitialized Pointer

CWE-20: Improper Input Validation

CWE-823: Use of Out-of-range Pointer Offset

CWE-131: Incorrect Calculation of Buffer Size

CWE-908: Use of Uninitialized Resource

CWE-825: Expired Pointer Dereference