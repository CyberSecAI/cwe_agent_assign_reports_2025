## Vulnerability Description
Botan is a C++ cryptography library. X.509 certificates can identify elliptic curves using either an object identifier or using explicit encoding of the parameters. A **bug in the parsing of name constraint extensions** in X.509 certificates meant that if the extension included both permitted subtrees and excluded subtrees, only the permitted subtree would be checked. If a certificate included a name which was permitted by the permitted subtree but also excluded by excluded subtree, it would be accepted. Fixed in versions 3.5.0 and 2.19.5.

### Vulnerability Description Key Phrases
- **rootcause:** **bug in the parsing of name constraint extensions**
- **impact:** accept certificate which was excluded
- **product:** Botan
- **version:** before 3.5.0 and 2.19.5
- **component:** X.509 certificates

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A bug in the parsing of name constraint extensions in X.509 certificates. Specifically, if the extension included both permitted subtrees and excluded subtrees, only the permitted subtree was checked.
- **Weaknesses/vulnerabilities present**: Improper validation of X.509 certificate name constraint extensions, specifically when both permitted and excluded subtrees are present.
- **Impact of exploitation**: A certificate containing a name that should have been excluded by the excluded subtree, but was permitted by the permitted subtree, would be incorrectly accepted. This could lead to the acceptance of unauthorized certificates. The integrity of the system is impacted since unauthorized certificates could potentially be used.
- **Attack vectors**: Network-based attacks using maliciously crafted X.509 certificates.
- **Required attacker capabilities/position**: An attacker needs the ability to generate X.509 certificates that have both permitted and excluded subtrees, and have the target application process these certificates. No user interaction is required and no privileges are required.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.503 |
| 2 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.492 |
| 3 | 277 | Insecure Inherited Permissions | Variant | Allowed | sparse | 0.491 |
| 4 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | Allowed | sparse | 0.484 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.474 |
| 6 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.464 |
| 7 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.462 |
| 8 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.457 |
| 9 | 296 | Improper Following of a Certificate's Chain of Trust | Base | Allowed | dense | 0.434 |
| 10 | 208 | Observable Timing Discrepancy | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-125: Out-of-bounds Read

CWE-295: Improper Certificate Validation

CWE-277: Insecure Inherited Permissions

CWE-297: Improper Validation of Certificate with Host Mismatch

CWE-863: Incorrect Authorization

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-203: Observable Discrepancy

CWE-190: Integer Overflow or Wraparound

CWE-296: Improper Following of a Certificate's Chain of Trust

CWE-208: Observable Timing Discrepancy