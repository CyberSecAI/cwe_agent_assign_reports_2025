# Raw Retriever Results for CVE-2024-45313

# Raw Retriever Results for CVE-2024-45313
## Query
Overleaf is a web-based collaborative LaTeX editor. When installing Server Pro using the Overleaf Toolkit from before 2024-07-17 or legacy docker-compose.yml from before 2024-08-28, the configuration for LaTeX compiles was insecure by default, requiring the administrator to enable the security features via a configuration setting (`SIBLING_CONTAINERS_ENABLED` in Toolkit, `SANDBOXED_COMPILES` in legacy docker-compose/custom deployments). If these security features are not enabled then users have access to the `sharelatex` container resources (filesystem, network, environment variables) when running compiles, leading to multiple file access vulnerabilities, either directly or via symlinks created during compiles. The setting has now been changed to be secure by default for new installs in the Toolkit and legacy docker-compose deployment. The Overleaf Toolkit has been updated to set `SIBLING_CONTAINERS_ENABLED=true` by default for new installs. It is recommended that any existing installations using the previous default setting migrate to using sibling containers. Existing installations can set `SIBLING_CONTAINERS_ENABLED=true` in `config/overleaf.rc` as a mitigation. In legacy docker-compose/custom deployments `SANDBOXED_COMPILES=true` should be used.

## Keyphrases
- **rootcause**: 'insecure default configuration'
- **weakness**: 'multiple file access vulnerabilities'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3587 | 0.4852 | 0.3950 | 0.3999 | 20 |
| Sparse | 690.1194 | 876.0522 | 775.0393 | 765.5136 | 11 |
| Graph | 1.0584 | 2.3296 | 1.5118 | 1.4999 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 306 | Missing Authentication for Critical Function | base | 2.3296 | Allowed |
| 2 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 3 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6557 | Allowed |
| 5 | 689 | Permission Race Condition During Resource Copy | compound | 1.6100 | Allowed |
| 6 | 552 | Files or Directories Accessible to External Parties | Base | 1.5777 | Allowed |
| 7 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 8 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 9 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.5024 | Allowed |
| 10 | 277 | Insecure Inherited Permissions | Variant | 1.5002 | Allowed |
| 11 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 1.4996 | Allowed |
| 12 | 1188 | Initialization of a Resource with an Insecure Default | Base | 1.4513 | Allowed |
| 13 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.4410 | Allowed |
| 14 | 732 | Incorrect Permission Assignment for Critical Resource | class | 1.4080 | Allowed-with-Review |
| 15 | 476 | NULL Pointer Dereference | base | 1.3676 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 277 | Insecure Inherited Permissions | Variant | 0.4852 | 0.4852 | Allowed |
| 2 | 1188 | Initialization of a Resource with an Insecure Default | Base | 0.4280 | 0.4280 | Allowed |
| 3 | 552 | Files or Directories Accessible to External Parties | Base | 0.4228 | 0.4228 | Allowed |
| 4 | 863 | Incorrect Authorization | Class | 0.4190 | 0.4190 | Allowed-with-Review |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4144 | 0.4144 | Allowed |
| 6 | 256 | Plaintext Storage of a Password | Base | 0.4138 | 0.4138 | Allowed |
| 7 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 0.4135 | 0.4135 | Allowed |
| 8 | 1394 | Use of Default Cryptographic Key | Base | 0.4134 | 0.4134 | Allowed |
| 9 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 0.4125 | 0.4125 | Allowed |
| 10 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.4122 | 0.4122 | Allowed |
| 11 | 377 | Insecure Temporary File | Class | 0.3875 | 0.3875 | Allowed-with-Review |
| 12 | 276 | Incorrect Default Permissions | Base | 0.3858 | 0.3858 | Allowed |
| 13 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.3657 | 0.3657 | Allowed |
| 14 | 540 | Inclusion of Sensitive Information in Source Code | Base | 0.3630 | 0.3630 | Allowed |
| 15 | 346 | Origin Validation Error | Class | 0.3626 | 0.3626 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1188 | Initialization of a Resource with an Insecure Default | 876.0522 | 876.0522 | Allowed |
| 2 | 306 | Missing Authentication for Critical Function | 818.8541 | 818.8541 | Allowed |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | 796.2618 | 796.2618 | Allowed-with-Review |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | 784.7306 | 784.7306 | Allowed |
| 5 | 277 | Insecure Inherited Permissions | 783.8486 | 783.8486 | Allowed |
| 6 | 863 | Incorrect Authorization | 765.5136 | 765.5136 | Allowed-with-Review |
| 7 | 918 | Server-Side Request Forgery (SSRF) | 761.8890 | 761.8890 | Allowed |
| 8 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 754.2175 | 754.2175 | Allowed-with-Review |
| 9 | 668 | Exposure of Resource to Wrong Sphere | 747.3504 | 747.3504 | Discouraged |
| 10 | 276 | Incorrect Default Permissions | 746.5956 | 746.5956 | Allowed |
| 11 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 690.1194 | 690.1194 | Allowed |
