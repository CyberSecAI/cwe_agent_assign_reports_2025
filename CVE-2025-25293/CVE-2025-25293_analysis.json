{
  "cve_id": "CVE-2025-25293",
  "description": "ruby-saml provides security assertion markup language (SAML) single sign-on (SSO) for Ruby. Prior to versions 1.12.4 and 1.18.0, ruby-saml is susceptible to remote Denial of Service (DoS) with compressed SAML responses. ruby-saml uses zlib to decompress SAML responses in case theyre compressed. It is possible to **bypass the message size check with a compressed assertion** since the message size is checked before inflation and not after. This issue may lead to remote Denial of Service (DoS). Versions 1.12.4 and 1.18.0 fix the issue.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "bypass the message size check with a compressed assertion",
    "impact": "remote Denial of Service (DoS)",
    "vector": "compressed SAML responses",
    "attacker": "",
    "product": "ruby-saml",
    "version": "prior to versions 1.12.4 and 1.18.0",
    "component": ""
  },
  "reference_content": "```text\nUNRELATED\n```\n\n```text\nHere's an analysis of the provided content:\n\nContent from about.gitlab.com_7fcd7ae0_20250624_121727.html:\n\n*   **Relevance:** The content discusses GitLab's security releases, including fixes for vulnerabilities in the `ruby-saml` library, which is relevant to the user's request. It specifically mentions CVE-2025-25291, CVE-2025-25292, and CVE-2025-25293.\n*   **Information:**\n    *   **Vulnerability:** Mentions CVE-2025-25291, CVE-2025-25292 and CVE-2025-25293, which are related to vulnerabilities in the `ruby-saml` library.\n    *   **Impact:** \"On GitLab CE/EE instances using SAML authentication, under certain circumstances, an attacker with access to a valid signed SAML document from the IdP could authenticate as another valid user within the environment's SAML IdP.\" The content also states that CVE-2025-25293 can lead to DoS.\n    *   **Mitigation/Fix:** GitLab recommends upgrading to versions 17.7.7, 17.8.5, and 17.9.2. The content provides specific mitigation steps for self-managed GitLab instances.\n    *   **Additional Detail**: The content provides more detail than the official CVE descriptions, including specific versions and mitigation steps for GitLab instances.\n*   **Extraction:**\n\n    *   **Vulnerability:** CVE-2025-25291 and CVE-2025-25292 were identified in the `ruby-saml` library. CVE-2025-25293 is a DoS vulnerability.\n    *   **Impact:** Under certain circumstances, an attacker with access to a valid signed SAML document could authenticate as another valid user. CVE-2025-25293 may lead to remote Denial of Service (DoS).\n    *   **Attack Vector:**  The attacker needs access to a valid signed SAML document from the IdP.\n    *   **Mitigation or fix:** Upgrade to GitLab CE/EE versions 17.7.7, 17.8.5, or 17.9.2. Mitigation steps are also provided.\n\nContent from github.blog_c8641cb5_20250624_121728.html:\n\n*   **Relevance:** This blog post from GitHub details the authentication bypass vulnerabilities (CVE-2025-25291 and CVE-2025-25292) in the `ruby-saml` library.\n*   **Information:**\n    *   **Vulnerability:** CVE-2025-25291 and CVE-2025-25292 are authentication bypass vulnerabilities. The root cause is a parser differential.\n    *   **Impact:** An attacker in possession of a single valid signature that was created with the key used to validate SAML responses or assertions of the targeted organization, can use it to construct assertions for any users which will be accepted by ruby-saml.\n    *   **Attack Vector:** The attacker needs a valid signature.\n    *   **Mitigation/Fix:** The content mentions updating to ruby-saml version 1.18.0 and indicates that references to libraries making use of ruby-saml (such as omniauth-saml) need also be updated to a version that reference a fixed version of ruby-saml.\n    *   **Additional Detail**: This provides more detail than the official CVE descriptions, including the root cause, attack vectors and a description of the parser differential.\n\n*   **Extraction:**\n\n    *   **Vulnerability:**  CVE-2025-25291 and CVE-2025-25292, authentication bypass vulnerabilities due to a parser differential in ruby-saml.\n    *   **Root cause of vulnerability:** Parser differential.\n    *   **Impact:** Allows an attacker with a valid signature to construct assertions for any user.\n    *   **Attack Vector:**  Requires possession of a single valid signature.\n    *   **Mitigation or fix:**  Update to ruby-saml version 1.18.0.\n\nContent from github.com_221a1380_20250624_203153.html, github.com_221a1380_20250624_203154.html, github.com_8235ed6e_20250624_203151.html, github.com_8235ed6e_20250624_203153.html, github.com_8235ed6e_20250624_203154.html and github.com_88e6c9d7_20250624_121730.html\n\n*   **Relevance:** All of these Github advisory pages provide information related to the vulnerabilities.\n*   **Information:**\n    *   **Vulnerability:**  CVE-2025-25291, CVE-2025-25292 are authentication bypass vulnerabilities. CVE-2025-25293 is a DoS vulnerability.\n    *   **Impact:**  Authentication bypass. DoS.\n    *   **Affected Versions:**  Specific versions are listed for each vulnerability.\n    *   **Mitigation/Fix:** Update to patched versions.\n*   **Extraction:**\n\n    *   **Vulnerability:** CVE-2025-25291, CVE-2025-25292 and CVE-2025-25293\n    *   **Impact:** Authentication bypass and Denial of Service (DoS).\n    *   **Affected versions:** Listed in each advisory.\n    *   **Mitigation/Fix:** Upgrade to patched versions (1.12.4 and 1.18.0).\n\nContent from github.com_ac6386af_20250624_121729.html:\n\n*   **Relevance:**  This GitHub commit details a fix for CVE-2025-25293.\n*   **Information:**\n    *   **Vulnerability:**  CVE-2025-25293:  Denial of Service (DoS) vulnerability.\n    *   **Mitigation/Fix:** A commit to limit the size of the SAML message to prevent DoS.\n    *   **Extraction:**\n        *   **Vulnerability:**  CVE-2025-25293\n        *   **Mitigation/Fix:** Added a message size check to prevent DoS.\n\nContent from github.com_c8303a4f_20250624_121732.html and github.com_f7d19871_20250624_121730.html:\n\n*   **Relevance:** These pages provide information relevant to CVE-2025-25291, CVE-2025-25292 and CVE-2025-25293\n*   **Information:**\n    *   **Vulnerability:**  CVE-2025-25291, CVE-2025-25292 (Signature Wrapping Vulnerabilities) and CVE-2025-25293 (DoS).\n    *   **Impact:** Authentication bypass (CVE-2025-25291, CVE-2025-25292).  DoS (CVE-2025-25293)\n    *   **Affected versions:**  Specific versions are listed for each vulnerability.\n    *   **Mitigation/Fix:** Upgrade to patched versions.\n*   **Extraction:**\n\n    *   **Vulnerability:** CVE-2025-25291, CVE-2025-25292 and CVE-2025-25293\n    *   **Impact:** Authentication bypass and Denial of Service (DoS).\n    *   **Affected versions:** Listed in each advisory.\n    *   **Mitigation/Fix:** Upgrade to patched versions.\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-400 | Uncontrolled Resource Consumption | 0.8 | Class | Primary | Allowed-with-Review |\n| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.7 | Base | Secondary | Allowed |\n| CWE-409 | Improper Handling of Highly Compressed Data (Data Amplification) | 0.6 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE is CWE-400, which is a Class-level CWE. CWE-770 and CWE-409 are potential children of CWE-400 which is more specific and also base level.\n```mermaid\ngraph TD\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe409[\"CWE-409: Improper Handling of Highly Compressed Data (Data Amplification)\"]\n\n    cwe770 -->|CHILDOF| cwe400\n    cwe409 -->|CHILDOF| cwe400\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe400 primary\n    class cwe770,cwe409 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **bypass of the message size check with a compressed assertion**, leading to uncontrolled resource consumption, which then leads to a remote Denial of Service (DoS). The chain is: **Improper Size Check** -> **Uncontrolled Resource Consumption** -> **Denial of Service**.\n\n## Summary of Analysis\nThe primary weakness is the **bypass of the message size check with a compressed assertion** which leads to uncontrolled resource consumption causing a denial of service.\nCWE-400 (Uncontrolled Resource Consumption) is selected as the primary CWE because the vulnerability ultimately leads to excessive resource consumption, resulting in a denial-of-service condition. This aligns with the core definition of CWE-400.\nThe evidence supporting this is: \"**bypass the message size check with a compressed assertion**\" and \"This issue may lead to remote Denial of Service (DoS).\"\n\nCWE-770 (Allocation of Resources Without Limits or Throttling) is considered a secondary CWE because the **bypass** allows the allocation of resources without proper limits.\n\nCWE-409 (Improper Handling of Highly Compressed Data (Data Amplification)) is considered a secondary CWE since the vulnerability involves compressed data that isn't properly handled.\n\nCWE-789 (Memory Allocation with Excessive Size Value) was considered, but it is related to memory allocation specifically. While memory could be a resource, the description does not limit it to memory.\n\nCWE-1284 (Improper Validation of Specified Quantity in Input) was considered, as the message size check is bypassed, which would imply improper validation. However, the consequence is more accurately described by CWE-400.\n\nCWE-1333 (Inefficient Regular Expression Complexity) was considered but is not applicable because the vulnerability does not involve regular expressions.\n\nCWE-170 (Improper Null Termination) was considered but is not applicable as there is no mention of null termination issues.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-400 | Uncontrolled Resource Consumption | 0.8 | Class | Primary | Allowed-with-Review |\n| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.7 | Base | Secondary | Allowed |\n| CWE-409 | Improper Handling of Highly Compressed Data (Data Amplification) | 0.6 | Base | Secondary | Allowed |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE is CWE-400, which is a Class-level CWE. CWE-770 and CWE-409 are potential children of CWE-400 which is more specific and also base level.\n```mermaid\ngraph TD\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe409[\"CWE-409: Improper Handling of Highly Compressed Data (Data Amplification)\"]\n\n    cwe770 -->|CHILDOF| cwe400\n    cwe409 -->|CHILDOF| cwe400\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe400 primary\n    class cwe770,cwe409 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **bypass of the message size check with a compressed assertion**, leading to uncontrolled resource consumption, which then leads to a remote Denial of Service (DoS). The chain is: **Improper Size Check** -> **Uncontrolled Resource Consumption** -> **Denial of Service**.\n\n## Summary of Analysis\nThe primary weakness is the **bypass of the message size check with a compressed assertion** which leads to uncontrolled resource consumption causing a denial of service.\nCWE-400 (Uncontrolled Resource Consumption) is selected as the primary CWE because the vulnerability ultimately leads to excessive resource consumption, resulting in a denial-of-service condition. This aligns with the core definition of CWE-400.\nThe evidence supporting this is: \"**bypass the message size check with a compressed assertion**\" and \"This issue may lead to remote Denial of Service (DoS).\"\n\nCWE-770 (Allocation of Resources Without Limits or Throttling) is considered a secondary CWE because the **bypass** allows the allocation of resources without proper limits.\n\nCWE-409 (Improper Handling of Highly Compressed Data (Data Amplification)) is considered a secondary CWE since the vulnerability involves compressed data that isn't properly handled.\n\nCWE-789 (Memory Allocation with Excessive Size Value) was considered, but it is related to memory allocation specifically. While memory could be a resource, the description does not limit it to memory.\n\nCWE-1284 (Improper Validation of Specified Quantity in Input) was considered, as the message size check is bypassed, which would imply improper validation. However, the consequence is more accurately described by CWE-400.\n\nCWE-1333 (Inefficient Regular Expression Complexity) was considered but is not applicable because the vulnerability does not involve regular expressions.\n\nCWE-170 (Improper Null Termination) was considered but is not applicable as there is no mention of null termination issues.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-1284:**\n- 1284 (Improper Validation of Specified Quantity in Input) - ROOT\n\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "source": "sparse"
      },
      "similarity": 624.772424380189
    },
    {
      "metadata": {
        "doc_id": "617",
        "name": "Reachable Assertion",
        "source": "sparse"
      },
      "similarity": 504.4510367533065
    },
    {
      "metadata": {
        "doc_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "source": "sparse"
      },
      "similarity": 491.15544276807066
    },
    {
      "metadata": {
        "doc_id": "1390",
        "name": "Weak Authentication",
        "source": "sparse"
      },
      "similarity": 490.35562855153
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse"
      },
      "similarity": 484.23568451530156
    },
    {
      "metadata": {
        "doc_id": "409",
        "name": "Improper Handling of Highly Compressed Data (Data Amplification)",
        "source": "sparse"
      },
      "similarity": 483.8273240486942
    },
    {
      "metadata": {
        "doc_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "source": "sparse"
      },
      "similarity": 481.8911521301528
    },
    {
      "metadata": {
        "doc_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "source": "sparse"
      },
      "similarity": 479.9468214916397
    },
    {
      "metadata": {
        "doc_id": "918",
        "name": "Server-Side Request Forgery (SSRF)",
        "type": "Base",
        "original_content": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
        "keyphrase_source": "weakness:bypass the message size check with a compressed assertion",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.39156329514831656,
            "graph": 1.4443267806381728
          }
        }
      },
      "similarity": 0.39156329514831656
    },
    {
      "doc_id": "193",
      "text": "CWE-193: Off-by-one Error",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "193",
        "name": "Off-by-one Error",
        "type": "base",
        "original_content": "CWE-193: Off-by-one Error",
        "relationships": [
          {
            "source_id": "193",
            "target_id": "119",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "193",
            "target_id": "170",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "193",
            "target_id": "617",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "193",
            "target_id": "682",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "193",
            "target_id": "682",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "682",
            "target_id": "193",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "617",
            "target_id": "193",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "170",
            "target_id": "193",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "119",
            "target_id": "193",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "617",
                  "193",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "617"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "617",
                  "193",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "617"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "193",
                  "617",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "617"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-1284",
      "CWE-400",
      "CWE-770",
      "CWE-170",
      "CWE-1333",
      "CWE-789",
      "CWE-409"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}