# Vulnerability Information: CVE-2025-25293

## Vulnerability Description
ruby-saml provides security assertion markup language (SAML) single sign-on (SSO) for Ruby. Prior to versions 1.12.4 and 1.18.0, ruby-saml is susceptible to remote Denial of Service (DoS) with compressed SAML responses. ruby-saml uses zlib to decompress SAML responses in case theyre compressed. It is possible to **bypass the message size check with a compressed assertion** since the message size is checked before inflation and not after. This issue may lead to remote Denial of Service (DoS). Versions 1.12.4 and 1.18.0 fix the issue.

### Vulnerability Description Key Phrases
- **weakness:** **bypass the message size check with a compressed assertion**
- **impact:** remote Denial of Service (DoS)
- **vector:** compressed SAML responses
- **product:** ruby-saml
- **version:** prior to versions 1.12.4 and 1.18.0

## CVE Reference Links Content Summary
```text
UNRELATED
```

```text
Here's an analysis of the provided content:

Content from about.gitlab.com_7fcd7ae0_20250624_121727.html:

*   **Relevance:** The content discusses GitLab's security releases, including fixes for vulnerabilities in the `ruby-saml` library, which is relevant to the user's request. It specifically mentions CVE-2025-25291, CVE-2025-25292, and CVE-2025-25293.
*   **Information:**
    *   **Vulnerability:** Mentions CVE-2025-25291, CVE-2025-25292 and CVE-2025-25293, which are related to vulnerabilities in the `ruby-saml` library.
    *   **Impact:** "On GitLab CE/EE instances using SAML authentication, under certain circumstances, an attacker with access to a valid signed SAML document from the IdP could authenticate as another valid user within the environment's SAML IdP." The content also states that CVE-2025-25293 can lead to DoS.
    *   **Mitigation/Fix:** GitLab recommends upgrading to versions 17.7.7, 17.8.5, and 17.9.2. The content provides specific mitigation steps for self-managed GitLab instances.
    *   **Additional Detail**: The content provides more detail than the official CVE descriptions, including specific versions and mitigation steps for GitLab instances.
*   **Extraction:**

    *   **Vulnerability:** CVE-2025-25291 and CVE-2025-25292 were identified in the `ruby-saml` library. CVE-2025-25293 is a DoS vulnerability.
    *   **Impact:** Under certain circumstances, an attacker with access to a valid signed SAML document could authenticate as another valid user. CVE-2025-25293 may lead to remote Denial of Service (DoS).
    *   **Attack Vector:**  The attacker needs access to a valid signed SAML document from the IdP.
    *   **Mitigation or fix:** Upgrade to GitLab CE/EE versions 17.7.7, 17.8.5, or 17.9.2. Mitigation steps are also provided.

Content from github.blog_c8641cb5_20250624_121728.html:

*   **Relevance:** This blog post from GitHub details the authentication bypass vulnerabilities (CVE-2025-25291 and CVE-2025-25292) in the `ruby-saml` library.
*   **Information:**
    *   **Vulnerability:** CVE-2025-25291 and CVE-2025-25292 are authentication bypass vulnerabilities. The root cause is a parser differential.
    *   **Impact:** An attacker in possession of a single valid signature that was created with the key used to validate SAML responses or assertions of the targeted organization, can use it to construct assertions for any users which will be accepted by ruby-saml.
    *   **Attack Vector:** The attacker needs a valid signature.
    *   **Mitigation/Fix:** The content mentions updating to ruby-saml version 1.18.0 and indicates that references to libraries making use of ruby-saml (such as omniauth-saml) need also be updated to a version that reference a fixed version of ruby-saml.
    *   **Additional Detail**: This provides more detail than the official CVE descriptions, including the root cause, attack vectors and a description of the parser differential.

*   **Extraction:**

    *   **Vulnerability:**  CVE-2025-25291 and CVE-2025-25292, authentication bypass vulnerabilities due to a parser differential in ruby-saml.
    *   **Root cause of vulnerability:** Parser differential.
    *   **Impact:** Allows an attacker with a valid signature to construct assertions for any user.
    *   **Attack Vector:**  Requires possession of a single valid signature.
    *   **Mitigation or fix:**  Update to ruby-saml version 1.18.0.

Content from github.com_221a1380_20250624_203153.html, github.com_221a1380_20250624_203154.html, github.com_8235ed6e_20250624_203151.html, github.com_8235ed6e_20250624_203153.html, github.com_8235ed6e_20250624_203154.html and github.com_88e6c9d7_20250624_121730.html

*   **Relevance:** All of these Github advisory pages provide information related to the vulnerabilities.
*   **Information:**
    *   **Vulnerability:**  CVE-2025-25291, CVE-2025-25292 are authentication bypass vulnerabilities. CVE-2025-25293 is a DoS vulnerability.
    *   **Impact:**  Authentication bypass. DoS.
    *   **Affected Versions:**  Specific versions are listed for each vulnerability.
    *   **Mitigation/Fix:** Update to patched versions.
*   **Extraction:**

    *   **Vulnerability:** CVE-2025-25291, CVE-2025-25292 and CVE-2025-25293
    *   **Impact:** Authentication bypass and Denial of Service (DoS).
    *   **Affected versions:** Listed in each advisory.
    *   **Mitigation/Fix:** Upgrade to patched versions (1.12.4 and 1.18.0).

Content from github.com_ac6386af_20250624_121729.html:

*   **Relevance:**  This GitHub commit details a fix for CVE-2025-25293.
*   **Information:**
    *   **Vulnerability:**  CVE-2025-25293:  Denial of Service (DoS) vulnerability.
    *   **Mitigation/Fix:** A commit to limit the size of the SAML message to prevent DoS.
    *   **Extraction:**
        *   **Vulnerability:**  CVE-2025-25293
        *   **Mitigation/Fix:** Added a message size check to prevent DoS.

Content from github.com_c8303a4f_20250624_121732.html and github.com_f7d19871_20250624_121730.html:

*   **Relevance:** These pages provide information relevant to CVE-2025-25291, CVE-2025-25292 and CVE-2025-25293
*   **Information:**
    *   **Vulnerability:**  CVE-2025-25291, CVE-2025-25292 (Signature Wrapping Vulnerabilities) and CVE-2025-25293 (DoS).
    *   **Impact:** Authentication bypass (CVE-2025-25291, CVE-2025-25292).  DoS (CVE-2025-25293)
    *   **Affected versions:**  Specific versions are listed for each vulnerability.
    *   **Mitigation/Fix:** Upgrade to patched versions.
*   **Extraction:**

    *   **Vulnerability:** CVE-2025-25291, CVE-2025-25292 and CVE-2025-25293
    *   **Impact:** Authentication bypass and Denial of Service (DoS).
    *   **Affected versions:** Listed in each advisory.
    *   **Mitigation/Fix:** Upgrade to patched versions.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.625 |
| 2 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.504 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.491 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.490 |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.484 |
| 6 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | Base | Allowed | sparse | 0.484 |
| 7 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.482 |
| 8 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.480 |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | dense | 0.392 |
| 10 | 193 | Off-by-one Error | Base | Allowed | graph | 0.002 |

