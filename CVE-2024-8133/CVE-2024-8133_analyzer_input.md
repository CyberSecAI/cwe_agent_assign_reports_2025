# Vulnerability Information: CVE-2024-8133

## Vulnerability Description
A vulnerability was found in D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04 up to 20240814. It has been declared as critical. This vulnerability affects the function cgi_FMT_R5_SpareDsk_DiskMGR of the file /cgi-bin/hd_config.cgi of the component HTTP POST Request Handler. The manipulation of the argument f_source_dev leads to **command injection**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. NOTE This vulnerability only affects products that are no longer supported by the maintainer. NOTE Vendor was contacted early and confirmed that the product is end-of-life. It should be retired and replaced.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** D-Link DNS-120 and DNR-202L and DNS-315L and DNS-320 and DNS-320L and DNS-320LW and DNS-321 and DNR-322L and DNS-323 and DNS-325 and DNS-326 and DNS-327L and DNR-326 and DNS-340L and DNS-343 and DNS-345 and DNS-726-4 and DNS-1100-4 and DNS-1200-05 and DNS-1550-04
- **version:** up to 20240814
- **component:** cgi_FMT_R5_SpareDsk_DiskMGR in /cgi-bin/hd_config.cgi

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-78

#### Top CWEs
- CWE-78 (Count: 25)
- CWE-77 (Count: 3)

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**CVE-2024-8133 is UNRELATED**

The provided content does not mention CVE-2024-8133. However, it does describe vulnerabilities in D-Link NAS devices related to command injection and information disclosure. Specifically, the content discusses:

**Vulnerabilities:**

*   **Command Injection (CVE-2024-3272 and reported in VulDB submission #396295):**
    *   **Root Cause:** The vulnerability exists in the `cgi_FMT_R5_SpareDsk_DiskMGR` function within the `/cgi-bin/hd_config.cgi` file. The `f_source_dev` variable, received from a POST request, is passed to the `sprintf` function, then used in a `system` command call without proper sanitization, leading to command injection.
    *   **Weakness:** Improper input validation and lack of sanitization of the `f_source_dev` variable.
    *   **Attack Vector:**  Sending a crafted POST request to `/cgi-bin/hd_config.cgi` with a malicious payload in the `f_source_dev` parameter.
    *   **Attacker Capabilities:** An attacker needs to be able to send HTTP POST requests to the device's web interface. This likely requires network access to the vulnerable device.
    *    **Impact:** Arbitrary command execution on the device.

*   **Information Disclosure (Report #3):**
    *   **Root Cause:** The document mentions "4 Information Disclosure Vulnerability Reports" affecting firmware version `DNS-320_A1_FW_2.02b01`, but does not provide details about the specific vulnerabilities.
    *   **Weakness:** Information disclosure due to unspecified vulnerabilities in the firmware.
    *   **Attack Vector:**  Vulnerabilities are unspecified but imply potentially accessible sensitive information.
    *   **Attacker Capabilities:**  Likely requires network access to the device
    *   **Impact:**  Potentially exposes sensitive information.

**Affected Products:**

The advisory lists numerous D-Link NAS devices affected including:
DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05, DNS-1550-04

**Additional Information:**

*   The vulnerabilities affect devices that have reached their End of Life (EOL) or End of Service Life (EOS), meaning they no longer receive security updates from D-Link.
*   D-Link recommends that users retire and replace these devices.
*   The advisory also references CVE-2024-3273, but no details are given in the provided text.
*   Links to the related GitHub repositories are provided, giving further detail regarding the vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.749 |
| 4 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.697 |
| 5 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.697 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.683 |
| 7 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.667 |
| 8 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | Variant | Allowed | sparse | 0.665 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.649 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |

