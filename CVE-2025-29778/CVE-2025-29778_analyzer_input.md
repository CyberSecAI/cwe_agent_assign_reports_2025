# Vulnerability Information: CVE-2025-29778

## Vulnerability Description
Kyverno is a policy engine designed for cloud native platform engineering teams. Prior to version 1.14.0-alpha.1, Kyverno **ignores subjectRegExp and IssuerRegExp while verifying artifacts sign with keyless mode**. It allows the attacker to deploy kubernetes resources with the artifacts that were signed by unexpected certificate. Deploying these unauthorized kubernetes resources can lead to full compromise of kubernetes cluster. Version 1.14.0-alpha.1 contains a patch for the issue.

### Vulnerability Description Key Phrases
- **weakness:** **ignores subjectRegExp and IssuerRegExp while verifying artifacts sign with keyless mode**
- **impact:** full compromise of kubernetes cluster
- **vector:** deploy kubernetes resources with the artifacts that were signed by unexpected certificate
- **attacker:** attacker
- **product:** Kyverno
- **version:** prior to version 1.14.0-alpha.1

## CVE Reference Links Content Summary
CVE-2025-29778 - Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

Kyverno did not consider the `subjectRegExp` and `issuerRegExp` fields when verifying artifact signatures in keyless mode. It only checked the `subject` and `issuer` fields.

**Weaknesses/vulnerabilities present:**

*   Insufficient input validation: Kyverno failed to validate the regular expressions provided in `subjectRegExp` and `issuerRegExp`.
*   Bypass of security checks: The lack of validation allowed attackers to deploy Kubernetes resources with artifacts signed by unexpected certificates.

**Impact of exploitation:**

Deploying unauthorized Kubernetes resources, potentially leading to a full compromise of the Kubernetes cluster.

**Attack vectors:**

1.  An attacker needs a private key for any certificate in the certificate chain trusted by cosign (e.g., a self-signed Root CA).
2.  Access to a container registry to push artifact images.
3.  Ability to deploy malicious artifacts to the Kubernetes cluster.

**Required attacker capabilities/position:**

*   Access to a certificate signing authority or the ability to create a trusted certificate.
*   Access to a container registry.
*   Kubernetes deployment privileges.

**Mitigation or fix:**

The issue was fixed by modifying the `matchSignatures` function in `pkg/cosign/cosign.go` to include `subjectRegExp` and `issuerRegExp` in the validation check.  The original code only checked if `subject` and `issuer` were empty. The fix now checks if `subject`, `issuer`, `subjectRegExp`, and `issuerRegExp` are all empty before skipping validation.  This change is present in commit `8777672`. The fix was cherry-picked into release 1.13.6 and 1.14.0.

**Additional Details:**

*   The vulnerability affected Kyverno versions v1.13.0 - v1.13.5.
*   Patched versions are v1.13.6 and v1.14.0.
*   The issue was initially reported as GHSA-46mp-8w32-6g94.
*   The provided content includes a proof-of-concept (PoC) demonstrating how to exploit the vulnerability.
*   The CVSS score is 5.8 (Moderate).
*   The vulnerability is related to CWE-285 (Improper Input Validation).
*   The fix was verified and implemented by Mohdcode.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.366 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.354 |
| 3 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.344 |
| 4 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.338 |
| 5 | 552 | Files or Directories Accessible to External Parties | Base | Allowed | sparse | 0.331 |
| 6 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.327 |
| 7 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.326 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.325 |
| 9 | 322 | Key Exchange without Entity Authentication | Base | Allowed | dense | 0.430 |
| 10 | 295 | Improper Certificate Validation | Base | Allowed | graph | 0.002 |

