{
  "cve_id": "CVE-2025-27100",
  "description": "lakeFS is an open-source tool that transforms your object storage into a Git-like repository. In affected versions an authenticated user can crash lakeFS by exhausting server memory. This is an authenticated denial-of-service issue. This problem has been patched in version 1.50.0. Users on versions 1.49.1 and below are affected. Users are advised to upgrade. Users unable to upgrade should either set the environment variable `LAKEFS_BLOCKSTORE_S3_DISABLE_PRE_SIGNED_MULTIPART` to `true` or configure the `disable_pre_signed_multipart` key to true in their config yaml.",
  "key_phrases": {
    "component": "",
    "rootcause": "",
    "vector": "",
    "weakness": "",
    "product": "lakeFS",
    "impact": "denial of service, exhausting server memory",
    "attacker": "authenticated user",
    "version": "1.49.1 and below"
  },
  "reference_content": "CVE-2025-27100\n\n**Root cause of vulnerability:**\nAn authenticated user can exhaust server memory.\n\n**Weaknesses/vulnerabilities present:**\nAuthenticated denial-of-service.\n\n**Impact of exploitation:**\nAn authenticated user can crash lakeFS.\n\n**Attack vectors:**\nNot explicitly stated, but requires an authenticated user.\n\n**Required attacker capabilities/position:**\nAuthenticated user.\n\n**Mitigation or fix:**\nOn S3 backends, configure `blockstore.s3.disable_pre_signed_multipart = true` or set the environment variable `LAKEFS_BLOCKSTORE_S3_DISABLE_PRE_SIGNED_MULTIPART` to `true`.\nThe vulnerability is patched in version 1.50.0. Versions 1.49.1 and below are affected.\n\n**Additional Notes:**\nThe content provides more detail than the official CVE description. Several code changes were made to address `gosec` findings, primarily related to safe casting and avoiding potential integer overflows. These changes do not directly address the core vulnerability but improve the overall security posture.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.9 | Base | Allowed | Primary CWE: The product allocates resources without limits, leading to denial of service. |\n| CWE-789 | Memory Allocation with Excessive Size Value | 0.7 | Variant | Allowed | Secondary Candidate: The vulnerability involves exhausting server memory, which suggests excessive memory allocation might be the underlying cause. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE, CWE-770 [Allocation of Resources Without Limits or Throttling], is a base CWE that has a parent-child relationship with CWE-400 [Uncontrolled Resource Consumption] and CWE-789 [Memory Allocation with Excessive Size Value]. CWE-789 is a more specific variant of CWE-770, focusing specifically on memory allocation. Because the vulnerability description mentions memory exhaustion, CWE-789 is considered as a secondary candidate. However, the root cause is likely the **lack of limits** on resource allocation (CWE-770) which then leads to excessive memory allocation as a consequence (CWE-789).\n\n```mermaid\ngraph TD\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe789[\"CWE-789: Memory Allocation with Excessive Size Value\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe789 -->|CHILDOF| cwe770\n    cwe770 -->|CHILDOF| cwe400\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe770 primary\n    class cwe789 secondary\n    class cwe400 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **lack of resource limits** (CWE-770), leading to excessive memory allocation, ultimately resulting in a denial-of-service condition.\n\nCWE-770 (Root Cause: **Allocation of Resources Without Limits or Throttling**) -> CWE-789 (Memory Allocation with Excessive Size Value) -> Denial of Service (Impact).\n\n## Summary of Analysis\nThe initial assessment focused on identifying the root cause of the denial-of-service vulnerability in lakeFS. The evidence from the vulnerability description and CVE summary clearly indicates that an authenticated user can exhaust server memory, leading to a crash. The primary CWE, CWE-770 [Allocation of Resources Without Limits or Throttling], accurately represents the underlying issue of the **lack of proper resource management**. While CWE-789 [Memory Allocation with Excessive Size Value] is a relevant secondary consideration due to the memory exhaustion aspect, CWE-770 captures the broader problem of unbounded resource allocation that leads to the memory issue.\n\nThe graph relationships highlight that CWE-789 is a child of CWE-770, indicating a more specific manifestation of the general resource management problem. The selected CWEs are at the optimal level of specificity because CWE-770 directly addresses the root cause, while CWE-789 provides additional context about the specific resource being exhausted (memory).",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-770 | Allocation of Resources Without Limits or Throttling | 0.9 | Base | Allowed | Primary CWE: The product allocates resources without limits, leading to denial of service. |\n| CWE-789 | Memory Allocation with Excessive Size Value | 0.7 | Variant | Allowed | Secondary Candidate: The vulnerability involves exhausting server memory, which suggests excessive memory allocation might be the underlying cause. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary CWE, CWE-770 [Allocation of Resources Without Limits or Throttling], is a base CWE that has a parent-child relationship with CWE-400 [Uncontrolled Resource Consumption] and CWE-789 [Memory Allocation with Excessive Size Value]. CWE-789 is a more specific variant of CWE-770, focusing specifically on memory allocation. Because the vulnerability description mentions memory exhaustion, CWE-789 is considered as a secondary candidate. However, the root cause is likely the **lack of limits** on resource allocation (CWE-770) which then leads to excessive memory allocation as a consequence (CWE-789).\n\n```mermaid\ngraph TD\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe789[\"CWE-789: Memory Allocation with Excessive Size Value\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe789 -->|CHILDOF| cwe770\n    cwe770 -->|CHILDOF| cwe400\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe770 primary\n    class cwe789 secondary\n    class cwe400 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **lack of resource limits** (CWE-770), leading to excessive memory allocation, ultimately resulting in a denial-of-service condition.\n\nCWE-770 (Root Cause: **Allocation of Resources Without Limits or Throttling**) -> CWE-789 (Memory Allocation with Excessive Size Value) -> Denial of Service (Impact).\n\n## Summary of Analysis\nThe initial assessment focused on identifying the root cause of the denial-of-service vulnerability in lakeFS. The evidence from the vulnerability description and CVE summary clearly indicates that an authenticated user can exhaust server memory, leading to a crash. The primary CWE, CWE-770 [Allocation of Resources Without Limits or Throttling], accurately represents the underlying issue of the **lack of proper resource management**. While CWE-789 [Memory Allocation with Excessive Size Value] is a relevant secondary consideration due to the memory exhaustion aspect, CWE-770 captures the broader problem of unbounded resource allocation that leads to the memory issue.\n\nThe graph relationships highlight that CWE-789 is a child of CWE-770, indicating a more specific manifestation of the general resource management problem. The selected CWEs are at the optimal level of specificity because CWE-770 directly addresses the root cause, while CWE-789 provides additional context about the specific resource being exhausted (memory).\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n**Chain starting from CWE-789:**\n- 789 (Memory Allocation with Excessive Size Value) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 160.34902614375557
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse"
      },
      "similarity": 156.75867905375455
    },
    {
      "metadata": {
        "doc_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "source": "sparse"
      },
      "similarity": 152.31418476866122
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 149.817111383316
    },
    {
      "metadata": {
        "doc_id": "94",
        "name": "Improper Control of Generation of Code ('Code Injection')",
        "source": "sparse"
      },
      "similarity": 148.67358406432606
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 147.47954380757895
    },
    {
      "metadata": {
        "doc_id": "212",
        "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
        "source": "sparse"
      },
      "similarity": 146.93060940261185
    },
    {
      "metadata": {
        "doc_id": "1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "source": "sparse"
      },
      "similarity": 146.58431744909905
    },
    {
      "metadata": {
        "doc_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "type": "Base",
        "original_content": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.37886447703364584,
            "graph": 2.7611148613428944
          }
        }
      },
      "similarity": 0.37886447703364584
    },
    {
      "doc_id": "789",
      "text": "The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated.",
      "score": 0.42407716932147366,
      "metadata": {
        "doc_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "type": "Variant",
        "extended_description": null,
        "alternate_terms": [
          "Stack Exhaustion"
        ],
        "original_content": "The product allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated.",
        "relationships": [
          {
            "source_id": "789",
            "target_id": "129",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "1284",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "476",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "789",
            "target_id": "770",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "770",
            "target_id": "789",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "476",
            "target_id": "789",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1325",
            "target_id": "789",
            "label": "PEEROF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "129",
            "target_id": "789",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1284",
            "target_id": "789",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "source": "graph",
        "sources": [
          "vector",
          "graph"
        ],
        "vector_score": 0.42407716932147366,
        "graph_score": 3.8784,
        "score_components": {
          "relationship_chain": 1.0,
          "explicit_mention": 1.0,
          "abstraction_path": 0.76,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.2,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "1284",
                  "789",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "1284"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "770",
                  "789",
                  "PARENTOF"
                ]
              ],
              "score": 0.76,
              "type": "abstraction_path_down",
              "source": "770"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "1284",
                  "789",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "1284"
            }
          }
        },
        "is_explicit": true,
        "abstraction_level": "variant",
        "position": "after",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "sparse",
            "graph"
          ],
          "retriever_count": 3,
          "normalized_scores": {
            "dense": 0.37739430798288426,
            "sparse": 145.89247249590306,
            "graph": 2.4966708677285894
          }
        }
      },
      "similarity": 2.4966708677285894
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-400",
      "CWE-789",
      "CWE-770"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}