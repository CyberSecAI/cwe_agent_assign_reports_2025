# Raw Retriever Results for CVE-2024-43801

# Raw Retriever Results for CVE-2024-43801
## Query
Jellyfin is an open source self hosted media server. The Jellyfin user profile image upload accepts SVG files, allowing for a stored XSS attack against an admin user via a specially crafted malicious SVG file. When viewed by an admin outside of the Jellyfin Web UI (e.g. via view image in a browser), this malicious SVG file could interact with the browsers LocalStorage and retrieve an AccessToken, which in turn can be used in an API call to elevate the target user to a Jellyfin administrator. The actual attack vector is unlikely to be exploited, as it requires specific actions by the administrator to view the SVG image outside of Jellyfins WebUI, i.e. it is not a passive attack. The underlying exploit mechanism is solved by PR #12490, which forces attached images (including the potential malicious SVG) to be treated as attachments and thus downloaded by browsers, rather than viewed. This prevents exploitation of the LocalStorage of the browser. This PR has been merged and the relevant code changes are included in release version 10.9.10. All users are advised to upgrade.

## Keyphrases
- **weakness**: 'stored XSS attack'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4472 | 0.5374 | 0.4769 | 0.4737 | 20 |
| Sparse | 310.5707 | 978.2564 | 859.6999 | 890.3806 | 11 |
| Graph | 1.5178 | 2.8960 | 1.9760 | 1.9536 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 2.8960 | Allowed |
| 2 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 2.5587 | Allowed |
| 3 | 23 | Relative Path Traversal | base | 2.4700 | Allowed |
| 4 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 5 | 183 | Permissive List of Allowed Inputs | base | 2.2100 | Allowed |
| 6 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.1912 | Allowed |
| 8 | 613 | Insufficient Session Expiration | base | 2.0930 | Allowed |
| 9 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 2.0400 | Allowed |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 11 | 611 | Improper Restriction of XML External Entity Reference | Base | 1.8671 | Allowed |
| 12 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 13 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 14 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 15 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | class | 1.7200 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.5374 | 0.5374 | Allowed |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.5100 | 0.5100 | Allowed |
| 3 | 82 | Improper Neutralization of Script in Attributes of IMG Tags in a Web Page | Variant | 0.5032 | 0.5032 | Allowed |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.4980 | 0.4980 | Allowed |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 0.4973 | 0.4973 | Allowed |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 0.4944 | 0.4944 | Allowed |
| 7 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | 0.4830 | 0.4830 | Allowed |
| 8 | 611 | Improper Restriction of XML External Entity Reference | Base | 0.4826 | 0.4826 | Allowed |
| 9 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | 0.4819 | 0.4819 | Allowed |
| 10 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | 0.4810 | 0.4810 | Allowed |
| 11 | 862 | Missing Authorization | Class | 0.4663 | 0.4663 | Allowed-with-Review |
| 12 | 863 | Incorrect Authorization | Class | 0.4655 | 0.4655 | Allowed-with-Review |
| 13 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4620 | 0.4620 | Allowed |
| 14 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4603 | 0.4603 | Allowed |
| 15 | 20 | Improper Input Validation | Class | 0.4561 | 0.4561 | Discouraged |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 611 | Improper Restriction of XML External Entity Reference | 978.2564 | 978.2564 | Allowed |
| 2 | 434 | Unrestricted Upload of File with Dangerous Type | 969.9309 | 969.9309 | Allowed |
| 3 | 23 | Relative Path Traversal | 930.0220 | 930.0220 | Allowed |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 928.8527 | 928.8527 | Allowed |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 915.1164 | 915.1164 | Allowed |
| 6 | 352 | Cross-Site Request Forgery (CSRF) | 890.3806 | 890.3806 | Allowed |
| 7 | 522 | Insufficiently Protected Credentials | 884.9746 | 884.9746 | Allowed-with-Review |
| 8 | 863 | Incorrect Authorization | 884.3237 | 884.3237 | Allowed-with-Review |
| 9 | 306 | Missing Authentication for Critical Function | 883.5948 | 883.5948 | Allowed |
| 10 | 285 | Improper Authorization | 880.6764 | 880.6764 | Discouraged |
| 11 | 347 | Improper Verification of Cryptographic Signature | 310.5707 | 310.5707 | Allowed |
