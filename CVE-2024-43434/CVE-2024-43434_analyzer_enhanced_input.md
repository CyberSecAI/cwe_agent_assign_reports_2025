## Vulnerability Description
The bulk message sending feature in Moodles Feedback modules non-respondents report had an **incorrect CSRF token check**, leading to a **CSRF vulnerability**.

### Vulnerability Description Key Phrases
- **rootcause:** **incorrect CSRF token check**
- **weakness:** **CSRF vulnerability**
- **product:** Moodles Feedback modules
- **component:** bulk message sending feature in non-respondents report

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "The bulk message sending feature for the Feedback module's non-respondents report had an incorrect CSRF token check.",
    "weaknesses": [
      "CSRF (Cross-Site Request Forgery)"
    ],
    "impact": "An attacker could potentially send bulk messages without the victim's consent or knowledge by exploiting the lack of proper CSRF token validation.",
    "attack_vectors": [
      "The vulnerability is exploitable via a crafted request sent to the affected Moodle instance, likely requiring the victim to interact with a malicious link or webpage."
    ],
      "required_attacker_capabilities": "The attacker needs to lure a logged-in user into clicking a malicious link or visiting a malicious webpage containing the crafted request."
  },
  "affected_versions": [
    "4.4 to 4.4.1",
    "4.3 to 4.3.5",
    "4.2 to 4.2.8",
    "4.1 to 4.1.11",
    "earlier unsupported versions"
  ],
  "fixed_versions": [
    "4.4.2",
    "4.3.6",
    "4.2.9",
    "4.1.12"
  ],
  "cve_id": "CVE-2024-43434"
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.171 |
| 2 | 601 | URL Redirection to Untrusted Site ('Open Redirect') | Base | Allowed | sparse | 0.153 |
| 3 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.149 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.148 |
| 5 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.148 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.147 |
| 7 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | sparse | 0.144 |
| 8 | 613 | Insufficient Session Expiration | Base | Allowed | sparse | 0.142 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.486 |
| 10 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-601: URL Redirection to Untrusted Site ('Open Redirect')

CWE-208: Observable Timing Discrepancy

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-346: Origin Validation Error

CWE-862: Missing Authorization

CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag

CWE-613: Insufficient Session Expiration

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-472: External Control of Assumed-Immutable Web Parameter