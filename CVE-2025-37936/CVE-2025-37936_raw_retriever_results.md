# Raw Retriever Results for CVE-2025-37936

# Raw Retriever Results for CVE-2025-37936
## Query
In the Linux kernel, the following vulnerability has been resolved perf/x86/intel KVM Mask PEBS_ENABLE loaded for guest with vCPUs value. When generating the MSR_IA32_PEBS_ENABLE value that will be loaded on VM-Entry to a KVM guest, mask the value with the vCPUs desired PEBS_ENABLE value. Consulting only the host kernels host vs. guest masks results in running the guest with PEBS enabled even when the guest doesnt want to use PEBS. Because KVM uses perf events to proxy the guest virtual PMU, simply looking at exclude_host cant differentiate between events created by host userspace, and events created by KVM on behalf of the guest. Running the guest with PEBS unexpectedly enabled typically manifests as crashes due to a near-infinite stream of #PFs. E.g. if the guest hasnt written MSR_IA32_DS_AREA, the CPU will hit page faults on address 0 when trying to record PEBS events. The issue is most easily reproduced by running `perf kvm top` from before commit 7b100989b4f6 (perf evlist Remove __evlist__add_default) (after which, `perf kvm top` effectively stopped using PEBS). The userspace side of perf creates a guest-only PEBS event, which intel_guest_get_msrs() misconstrues a guest-*owned* PEBS event. Arguably, this is a userspace bug, as enabling PEBS on guest-only events simply cannot work, and userspace can kill VMs in many other ways (there is no danger to the host). However, even if this is considered to be bad userspace behavior, theres zero downside to perf/KVM restricting PEBS to guest-owned events. Note, commit 854250329c02 (KVM x86/pmu Disable guest PEBS temporarily in two rare situations) fixed the case where host userspace is profiling KVM *and* userspace, but missed the case where userspace is profiling only KVM.

## Keyphrases
- **rootcause**: 'When generating the MSR_IA32_PEBS_ENABLE value that will be loaded on VM-Entry to a KVM guest', 'mask the value with the vCPUs desired PEBS_ENABLE value.'
- **weakness**: 'perf', 'x86', 'intel KVM Mask PEBS_ENABLE loaded for guest with vCPUs value'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4068 | 0.5228 | 0.4443 | 0.4457 | 20 |
| Sparse | 1217.4523 | 1646.4038 | 1354.4706 | 1328.3616 | 10 |
| Graph | 1.6848 | 2.8652 | 1.9605 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | base | 2.8652 | Allowed |
| 2 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.4700 | Allowed |
| 3 | 393 | Return of Wrong Status Code | base | 2.3998 | Allowed |
| 4 | 252 | Unchecked Return Value | base | 2.3400 | Allowed |
| 5 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.2100 | Allowed |
| 7 | 908 | Use of Uninitialized Resource | base | 2.2100 | Allowed |
| 8 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 9 | 754 | Improper Check for Unusual or Exceptional Conditions | class | 1.8256 | Allowed-with-Review |
| 10 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 1.6952 | Allowed |
| 13 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 14 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 15 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5228 | 0.5228 | Allowed |
| 2 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4809 | 0.4809 | Allowed |
| 3 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4748 | 0.4748 | Allowed |
| 4 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4745 | 0.4745 | Allowed |
| 5 | 1037 | Processor Optimization Removal or Modification of Security-critical Code | Base | 0.4732 | 0.4732 | Allowed |
| 6 | 1423 | Exposure of Sensitive Information caused by Shared Microarchitectural Predictor State that Influences Transient Execution | Base | 0.4707 | 0.4707 | Allowed |
| 7 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.4658 | 0.4658 | Allowed |
| 8 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4598 | 0.4598 | Allowed |
| 9 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | 0.4574 | 0.4574 | Allowed |
| 10 | 1262 | Improper Access Control for Register Interface | Base | 0.4554 | 0.4554 | Allowed |
| 11 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4361 | 0.4361 | Allowed-with-Review |
| 12 | 909 | Missing Initialization of Resource | Class | 0.4289 | 0.4289 | Allowed-with-Review |
| 13 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.4209 | 0.4209 | Allowed |
| 14 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 0.4127 | 0.4127 | Allowed |
| 15 | 667 | Improper Locking | Class | 0.4124 | 0.4124 | Allowed-with-Review |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 393 | Return of Wrong Status Code | 1646.4038 | 1646.4038 | Allowed |
| 2 | 909 | Missing Initialization of Resource | 1471.4643 | 1471.4643 | Allowed-with-Review |
| 3 | 754 | Improper Check for Unusual or Exceptional Conditions | 1401.7598 | 1401.7598 | Allowed-with-Review |
| 4 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 1371.7440 | 1371.7440 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1357.9319 | 1357.9319 | Allowed-with-Review |
| 6 | 789 | Memory Allocation with Excessive Size Value | 1298.7913 | 1298.7913 | Allowed |
| 7 | 125 | Out-of-bounds Read | 1284.2701 | 1284.2701 | Allowed |
| 8 | 755 | Improper Handling of Exceptional Conditions | 1260.6876 | 1260.6876 | Discouraged |
| 9 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 1234.2006 | 1234.2006 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | 1217.4523 | 1217.4523 | Allowed |
