# Vulnerability Information: CVE-2024-8775

## Vulnerability Description
A flaw was found in Ansible, where sensitive information stored in Ansible Vault files can be exposed in plaintext during the execution of a playbook. This occurs when using tasks such as include_vars to load vaulted variables without setting the no_log true parameter, resulting in sensitive data being printed in the playbook output or logs. This can lead to the unintentional disclosure of secrets like passwords or API keys, compromising security and potentially allowing unauthorized access or actions.

### Vulnerability Description Key Phrases
- **impact:** unintentional disclosure of secrets
- **vector:** using tasks like include_vars without no_log true
- **product:** Ansible

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-8775.

**Root cause of vulnerability:**
Improper handling of sensitive variables loaded from Ansible Vault files. Specifically, when using tasks like `include_vars` to load vaulted variables without setting the `no_log: true` parameter.

**Weaknesses/vulnerabilities present:**
Exposure of sensitive information in Ansible Vault files due to improper logging. Sensitive data, such as passwords or API keys, can be unintentionally exposed in plaintext in playbook output or logs.

**Impact of exploitation:**
The unintentional disclosure of secrets can compromise security, potentially allowing unauthorized access or actions.

**Attack vectors:**
A malicious actor could exploit this vulnerability by executing a playbook that includes tasks loading vaulted variables without proper logging protection.

**Required attacker capabilities/position:**
An attacker would need to be able to execute Ansible playbooks that use `include_vars` tasks or similar, and be able to view the playbook output or logs.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | sparse | 0.176 |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.148 |
| 3 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.148 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.141 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.138 |
| 6 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.136 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.135 |
| 8 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.135 |
| 9 | 526 | Cleartext Storage of Sensitive Information in an Environment Variable | Variant | Allowed | dense | 0.543 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.003 |

