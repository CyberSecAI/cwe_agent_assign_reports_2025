{
  "retriever": "dense",
  "query": "In the Linux kernel, the following vulnerability has been resolved eth bnxt always recalculate features after XDP clearing, fix null-deref Recalculate features when XDP is detached. Before # ip li set dev eth0 xdp obj xdp_dummy.bpf.o sec xdp # ip li set dev eth0 xdp off # ethtool -k eth0 | grep gro rx-gro-hw off [requested on] After # ip li set dev eth0 xdp obj xdp_dummy.bpf.o sec xdp # ip li set dev eth0 xdp off # ethtool -k eth0 | grep gro rx-gro-hw on The fact that HW-GRO doesnt get re-enabled automatically is just a minor annoyance. The real issue is that the features will randomly come back during another reconfiguration which just happens to invoke netdev_update_features(). The driver doesnt handle reconfiguring two things at a time very robustly. Starting with commit 98ba1d931f61 (bnxt_en Fix RSS logic in __bnxt_reserve_rings()) we only reconfigure the RSS hash table if the effective number of Rx rings has changed. If HW-GRO is enabled effective number of rings is 2x what user sees. So if we are in the bad state, with HW-GRO re-enablement pending after XDP off, and we lower the rings by / 2 - the HW-GRO rings doing 2x and the ethtool -L doing / 2 may cancel each other out, and the if (old_rx_rings != bp->hw_resc.resv_rx_rings && condition in __bnxt_reserve_rings() will be false. The RSS map wont get updated, and well crash with",
  "keyphrases": {
    "weakness": [
      "null dereference"
    ]
  },
  "timestamp": "2025-07-12 09:52:57",
  "cve_id": "CVE-2025-21682",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "type": "Base",
      "score": 0.48093820401497767
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "type": "Variant",
      "score": 0.47282613737198775
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "type": "Class",
      "score": 0.4579116305151865
    },
    {
      "cwe_id": "121",
      "name": "Stack-based Buffer Overflow",
      "type": "Variant",
      "score": 0.451393131533687
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "type": "Class",
      "score": 0.4508660158589618
    },
    {
      "cwe_id": "191",
      "name": "Integer Underflow (Wrap or Wraparound)",
      "type": "Base",
      "score": 0.4501429379423344
    },
    {
      "cwe_id": "1315",
      "name": "Improper Setting of Bus Controlling Capability in Fabric End-point",
      "type": "Base",
      "score": 0.450024362341262
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "type": "Base",
      "score": 0.4490603632027692
    },
    {
      "cwe_id": "1256",
      "name": "Improper Restriction of Software Interfaces to Hardware Features",
      "type": "Base",
      "score": 0.44745464185645156
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "type": "Base",
      "score": 0.4411016112149899
    },
    {
      "cwe_id": "77",
      "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')",
      "type": "Class",
      "score": 0.427456811524709
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "type": "Class",
      "score": 0.4241128048862509
    },
    {
      "cwe_id": "755",
      "name": "Improper Handling of Exceptional Conditions",
      "type": "Class",
      "score": 0.4230056960101599
    },
    {
      "cwe_id": "400",
      "name": "Uncontrolled Resource Consumption",
      "type": "Class",
      "score": 0.4227077039202546
    },
    {
      "cwe_id": "126",
      "name": "Buffer Over-read",
      "type": "Variant",
      "score": 0.422539685384233
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "type": "Base",
      "score": 0.4216123965819951
    },
    {
      "cwe_id": "252",
      "name": "Unchecked Return Value",
      "type": "Base",
      "score": 0.4198007595036824
    },
    {
      "cwe_id": "911",
      "name": "Improper Update of Reference Count",
      "type": "Base",
      "score": 0.41970765752844164
    },
    {
      "cwe_id": "1276",
      "name": "Hardware Child Block Incorrectly Connected to Parent System",
      "type": "Base",
      "score": 0.41764211522013467
    },
    {
      "cwe_id": "1317",
      "name": "Improper Access Control in Fabric Bridge",
      "type": "Base",
      "score": 0.41519453471327245
    }
  ]
}