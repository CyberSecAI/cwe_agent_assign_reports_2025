## Vulnerability Description
A Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in the AgentD process of Juniper Networks Junos OS allows an attacker who is already causing impact to established sessions which generates counter changes picked up by the AgentD process during telemetry polling, to move the AgentD process into a state where AgentD attempts to reap an already destroyed sensor. This reaping attempt then leads to **memory corruption** causing the FPC to crash which is a Denial of Service (DoS). The FPC will recover automatically without user intervention after the crash. This issue affects Junos OS * All versions before 21.4R3-S9 * From 22.2 before 22.2R3-S5, * From 22.3 before 22.3R3-S4, * From 22.4 before 22.4R3-S3, * From 23.2 before 23.2R2-S2, * From 23.4 before 23.4R2. This issue does not affect Junos OS Evolved.

### Vulnerability Description Key Phrases
- **rootcause:** **TOCTOU race condition**
- **weakness:** **memory corruption**
- **impact:** Denial of Service and memory corruption
- **product:** Juniper Networks Junos OS
- **version:** multiple versions
- **component:** AgentD process

## CVE Reference Links Content Summary
UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 2 | 787 | Out-of-bounds Write | Base | Allowed | alternate_terms | 1.000 |
| 3 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.874 |
| 4 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.874 |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.868 |
| 6 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.857 |
| 7 | 410 | Insufficient Resource Pool | Base | Allowed | sparse | 0.844 |
| 8 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.830 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.614 |
| 10 | 390 | Detection of Error Condition Without Action | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-787: Out-of-bounds Write

CWE-755: Improper Handling of Exceptional Conditions

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-400: Uncontrolled Resource Consumption

CWE-410: Insufficient Resource Pool

CWE-696: Incorrect Behavior Order

CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input

CWE-390: Detection of Error Condition Without Action