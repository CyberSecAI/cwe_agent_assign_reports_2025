{
  "retriever": "sparse",
  "query": "A Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in the AgentD process of Juniper Networks Junos OS allows an attacker who is already causing impact to established sessions which generates counter changes picked up by the AgentD process during telemetry polling, to move the AgentD process into a state where AgentD attempts to reap an already destroyed sensor. This reaping attempt then leads to memory corruption causing the FPC to crash which is a Denial of Service (DoS). The FPC will recover automatically without user intervention after the crash. This issue affects Junos OS * All versions before 21.4R3-S9 * From 22.2 before 22.2R3-S5, * From 22.3 before 22.3R3-S4, * From 22.4 before 22.4R3-S3, * From 23.2 before 23.2R2-S2, * From 23.4 before 23.4R2. This issue does not affect Junos OS Evolved.",
  "keyphrases": {
    "rootcause": [
      "TOCTOU race condition"
    ],
    "weakness": [
      "memory corruption"
    ]
  },
  "timestamp": "2025-07-13 18:13:49",
  "cve_id": "CVE-2024-47494",
  "result_count": 12,
  "results": [
    {
      "cwe_id": "787",
      "name": "Out-of-bounds Write",
      "score": 1000.0,
      "search_source": "alternate_term_match"
    },
    {
      "cwe_id": "755",
      "name": "Improper Handling of Exceptional Conditions",
      "score": 874.1604971057359,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "score": 873.7066444179786,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 868.1818651282542,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 867.8609354512726,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "400",
      "name": "Uncontrolled Resource Consumption",
      "score": 857.1754065393702,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "410",
      "name": "Insufficient Resource Pool",
      "score": 843.6420567786555,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "696",
      "name": "Incorrect Behavior Order",
      "score": 830.0953510409804,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "754",
      "name": "Improper Check for Unusual or Exceptional Conditions",
      "score": 813.366454865789,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "252",
      "name": "Unchecked Return Value",
      "score": 797.67806419721,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 785.5293322013031,
      "search_source": "rootcause:TOCTOU race condition"
    },
    {
      "cwe_id": "1286",
      "name": "Improper Validation of Syntactic Correctness of Input",
      "score": 742.1833150288072,
      "search_source": "weakness:memory corruption"
    }
  ]
}