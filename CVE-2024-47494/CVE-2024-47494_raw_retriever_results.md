# Raw Retriever Results for CVE-2024-47494

# Raw Retriever Results for CVE-2024-47494
## Query
A Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in the AgentD process of Juniper Networks Junos OS allows an attacker who is already causing impact to established sessions which generates counter changes picked up by the AgentD process during telemetry polling, to move the AgentD process into a state where AgentD attempts to reap an already destroyed sensor. This reaping attempt then leads to memory corruption causing the FPC to crash which is a Denial of Service (DoS). The FPC will recover automatically without user intervention after the crash. This issue affects Junos OS * All versions before 21.4R3-S9 * From 22.2 before 22.2R3-S5, * From 22.3 before 22.3R3-S4, * From 22.4 before 22.4R3-S3, * From 23.2 before 23.2R2-S2, * From 23.4 before 23.4R2. This issue does not affect Junos OS Evolved.

## Keyphrases
- **rootcause**: 'TOCTOU race condition'
- **weakness**: 'memory corruption'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5338 | 0.6139 | 0.5707 | 0.5706 | 20 |
| Sparse | 742.1833 | 1000.0000 | 846.1317 | 850.4087 | 12 |
| Graph | 1.6848 | 2.8652 | 2.1504 | 2.2100 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 390 | Detection of Error Condition Without Action | base | 2.8652 | Allowed |
| 2 | 787 | Out-of-bounds Write | base | 2.8210 | Allowed |
| 3 | 123 | Write-what-where Condition | base | 2.4232 | Allowed |
| 4 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 5 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 6 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 7 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 8 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 9 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 11 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 12 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 13 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2090 | Allowed |
| 14 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.6139 | 0.6139 | Allowed |
| 2 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.6116 | 0.6116 | Allowed |
| 3 | 400 | Uncontrolled Resource Consumption | Class | 0.6019 | 0.6019 | Discouraged |
| 4 | 696 | Incorrect Behavior Order | Class | 0.6015 | 0.6015 | Allowed-with-Review |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.5972 | 0.5972 | Allowed |
| 6 | 410 | Insufficient Resource Pool | Base | 0.5883 | 0.5883 | Allowed |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5864 | 0.5864 | Allowed-with-Review |
| 8 | 606 | Unchecked Input for Loop Condition | Base | 0.5861 | 0.5861 | Allowed |
| 9 | 121 | Stack-based Buffer Overflow | Variant | 0.5800 | 0.5800 | Allowed |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5797 | 0.5797 | Allowed |
| 11 | 755 | Improper Handling of Exceptional Conditions | Class | 0.5616 | 0.5616 | Discouraged |
| 12 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | 0.5612 | 0.5612 | Allowed-with-Review |
| 13 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5524 | 0.5524 | Discouraged |
| 14 | 617 | Reachable Assertion | Base | 0.5498 | 0.5498 | Allowed |
| 15 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5468 | 0.5468 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 787 | Out-of-bounds Write | 1000.0000 | 1000.0000 | Allowed |
| 2 | 755 | Improper Handling of Exceptional Conditions | 874.1605 | 874.1605 | Discouraged |
| 3 | 401 | Missing Release of Memory after Effective Lifetime | 873.7066 | 873.7066 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 868.1819 | 868.1819 | Allowed-with-Review |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 867.8609 | 867.8609 | Allowed |
| 6 | 400 | Uncontrolled Resource Consumption | 857.1754 | 857.1754 | Discouraged |
| 7 | 410 | Insufficient Resource Pool | 843.6421 | 843.6421 | Allowed |
| 8 | 696 | Incorrect Behavior Order | 830.0954 | 830.0954 | Allowed-with-Review |
| 9 | 754 | Improper Check for Unusual or Exceptional Conditions | 813.3665 | 813.3665 | Allowed-with-Review |
| 10 | 252 | Unchecked Return Value | 797.6781 | 797.6781 | Allowed |
| 11 | 770 | Allocation of Resources Without Limits or Throttling | 785.5293 | 785.5293 | Allowed |
| 12 | 1286 | Improper Validation of Syntactic Correctness of Input | 742.1833 | 742.1833 | Allowed |
