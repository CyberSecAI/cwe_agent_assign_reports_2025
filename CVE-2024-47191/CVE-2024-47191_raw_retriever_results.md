# Raw Retriever Results for CVE-2024-47191

# Raw Retriever Results for CVE-2024-47191
## Query
pam_oath.so in oath-toolkit 2.6.7 through 2.6.11 before 2.6.12 allows root privilege escalation because, in the context of PAM code running as root, it mishandles usersfile access, such as by calling fchown in the presence of a symlink.

## Keyphrases
- **rootcause**: 'mishandles usersfile access'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4109 | 0.4624 | 0.4301 | 0.4264 | 20 |
| Sparse | 230.5351 | 255.2370 | 242.0576 | 240.9715 | 10 |
| Graph | 1.3010 | 3.0550 | 1.8013 | 1.6598 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 3.0550 | Allowed |
| 2 | 363 | Race Condition Enabling Link Following | base | 2.8652 | Allowed |
| 3 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.3998 | Allowed |
| 4 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 5 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 6 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 9 | 250 | Execution with Unnecessary Privileges | Base | 1.6921 | Allowed |
| 10 | 842 | Placement of User into Incorrect Group | Base | 1.6876 | Allowed |
| 11 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 12 | 708 | Incorrect Ownership Assignment | Base | 1.6075 | Allowed |
| 13 | 73 | External Control of File Name or Path | Base | 1.5216 | Allowed |
| 14 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.5210 | Allowed |
| 15 | 266 | Incorrect Privilege Assignment | Base | 1.5074 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 250 | Execution with Unnecessary Privileges | Base | 0.4624 | 0.4624 | Allowed |
| 2 | 272 | Least Privilege Violation | Base | 0.4578 | 0.4578 | Allowed |
| 3 | 708 | Incorrect Ownership Assignment | Base | 0.4512 | 0.4512 | Allowed |
| 4 | 286 | Incorrect User Management | Class | 0.4496 | 0.4496 | Allowed-with-Review |
| 5 | 842 | Placement of User into Incorrect Group | Base | 0.4494 | 0.4494 | Allowed |
| 6 | 268 | Privilege Chaining | Base | 0.4492 | 0.4492 | Allowed |
| 7 | 267 | Privilege Defined With Unsafe Actions | Base | 0.4466 | 0.4466 | Allowed |
| 8 | 266 | Incorrect Privilege Assignment | Base | 0.4345 | 0.4345 | Allowed |
| 9 | 277 | Insecure Inherited Permissions | Variant | 0.4319 | 0.4319 | Allowed |
| 10 | 269 | Improper Privilege Management | Class | 0.4301 | 0.4301 | Discouraged |
| 11 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4227 | 0.4227 | Allowed |
| 12 | 620 | Unverified Password Change | Base | 0.4169 | 0.4169 | Allowed |
| 13 | 296 | Improper Following of a Certificate's Chain of Trust | Base | 0.4147 | 0.4147 | Allowed |
| 14 | 281 | Improper Preservation of Permissions | Base | 0.4146 | 0.4146 | Allowed |
| 15 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.4130 | 0.4130 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 250 | Execution with Unnecessary Privileges | 255.2370 | 255.2370 | Allowed |
| 2 | 287 | Improper Authentication | 250.7868 | 250.7868 | Discouraged |
| 3 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 245.1308 | 245.1308 | Allowed |
| 4 | 269 | Improper Privilege Management | 244.8158 | 244.8158 | Discouraged |
| 5 | 59 | Improper Link Resolution Before File Access ('Link Following') | 240.9761 | 240.9761 | Allowed |
| 6 | 732 | Incorrect Permission Assignment for Critical Resource | 240.9670 | 240.9670 | Allowed-with-Review |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 239.6517 | 239.6517 | Allowed-with-Review |
| 8 | 61 | UNIX Symbolic Link (Symlink) Following | 238.5836 | 238.5836 | Allowed |
| 9 | 863 | Incorrect Authorization | 233.8917 | 233.8917 | Allowed-with-Review |
| 10 | 427 | Uncontrolled Search Path Element | 230.5351 | 230.5351 | Allowed |
