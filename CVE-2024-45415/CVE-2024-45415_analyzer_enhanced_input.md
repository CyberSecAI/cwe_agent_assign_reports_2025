## Vulnerability Description
The HTTPD binary in multiple ZTE routers has a **stack-based buffer overflow** vulnerability in check_data_integrity function. This function is responsible for validating the checksum of data in post request. The checksum is sent encrypted in the request, the function decrypts it and stores the checksum on the stack without validating it. An unauthenticated attacker can get RCE as root by exploiting this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **The checksum is stored on the stack without validating it.**
- **weakness:** **stack-based buffer overflow**
- **impact:** RCE and remote code execution
- **attacker:** unauthenticated attacker
- **product:** ZTE routers
- **component:** check_data_integrity function in HTTPD binary

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The `check_data_integrity` function in the HTTPD binary of ZTE routers does not validate the length of the decrypted checksum before storing it on the stack.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow (CWE-121).
- **Impact of exploitation**: Unauthenticated attackers can achieve remote code execution (RCE) as root.
- **Attack vectors**: Sending a crafted POST request to the router's HTTP server.
- **Required attacker capabilities/position**: Network access to the router's HTTP server. The attacker does not require authentication.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.482 |
| 4 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.459 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.456 |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.449 |
| 7 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.429 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.424 |
| 9 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | dense | 0.543 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-121: Stack-based Buffer Overflow

CWE-295: Improper Certificate Validation

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-347: Improper Verification of Cryptographic Signature

CWE-20: Improper Input Validation

CWE-130: Improper Handling of Length Parameter Inconsistency

CWE-128: Wrap-around Error