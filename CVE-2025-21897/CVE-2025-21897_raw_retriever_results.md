# Raw Retriever Results for CVE-2025-21897

# Raw Retriever Results for CVE-2025-21897
## Query
In the Linux kernel, the following vulnerability has been resolved sched_ext Fix pick_task_scx() picking non-queued tasks when its called without balance() a6250aa251ea (sched_ext Handle cases where pick_task_scx() is called without preceding balance_scx()) added a workaround to handle the cases where pick_task_scx() is called without prececing balance_scx() which is due to a fair class bug where pick_taks_fair() may return NULL after a true return from balance_fair(). The workaround detects when pick_task_scx() is called without preceding balance_scx() and emulates SCX_RQ_BAL_KEEP and triggers kicking to avoid stalling. Unfortunately, the workaround code was testing whether @prev was on SCX to decide whether to keep the task running. This is incorrect as the task may be on SCX but no longer runnable. This could lead to a non-runnable task to be returned from pick_task_scx() which cause interesting confusions and failures. e.g. A common failure mode is the task ending up with (!on_rq && on_cpu) state which can cause potential wakers to busy loop, which can easily lead to deadlocks. Fix it by testing whether @prev has SCX_TASK_QUEUED set. This makes @prev_on_scx only used in one place. Open code the usage and improve the comment while at it.

## Keyphrases
- **weakness**: 'non-runnable task to be returned from pick_task_scx()'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4714 | 0.5242 | 0.4879 | 0.4826 | 20 |
| Sparse | 760.3993 | 822.6149 | 781.1553 | 779.5148 | 10 |
| Graph | 1.7680 | 2.7342 | 2.1029 | 2.1559 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 363 | Race Condition Enabling Link Following | base | 2.7342 | Allowed |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 2.3998 | Allowed |
| 3 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.3400 | Allowed |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.3296 | Allowed |
| 5 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 6 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 7 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 8 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 9 | 73 | External Control of File Name or Path | base | 2.2100 | Allowed |
| 10 | 368 | Context Switching Race Condition | base | 2.1762 | Allowed |
| 11 | 364 | Signal Handler Race Condition | Base | 2.1355 | Allowed |
| 12 | 415 | Double Free | variant | 2.0400 | Allowed |
| 13 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 2.0020 | Allowed |
| 15 | 770 | Allocation of Resources Without Limits or Throttling | Base | 1.8985 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5242 | 0.5242 | Allowed-with-Review |
| 2 | 833 | Deadlock | Base | 0.5148 | 0.5148 | Allowed |
| 3 | 366 | Race Condition within a Thread | Base | 0.5143 | 0.5143 | Allowed |
| 4 | 667 | Improper Locking | Class | 0.5136 | 0.5136 | Allowed-with-Review |
| 5 | 909 | Missing Initialization of Resource | Class | 0.5047 | 0.5047 | Allowed-with-Review |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4917 | 0.4917 | Allowed |
| 7 | 252 | Unchecked Return Value | Base | 0.4892 | 0.4892 | Allowed |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4873 | 0.4873 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4852 | 0.4852 | Allowed |
| 10 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4845 | 0.4845 | Allowed |
| 11 | 413 | Improper Resource Locking | Base | 0.4807 | 0.4807 | Allowed |
| 12 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4771 | 0.4771 | Allowed |
| 13 | 416 | Use After Free | Variant | 0.4766 | 0.4766 | Allowed |
| 14 | 754 | Improper Check for Unusual or Exceptional Conditions | Class | 0.4764 | 0.4764 | Allowed-with-Review |
| 15 | 606 | Unchecked Input for Loop Condition | Base | 0.4758 | 0.4758 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 822.6149 | 822.6149 | Allowed-with-Review |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | 790.0304 | 790.0304 | Allowed |
| 3 | 364 | Signal Handler Race Condition | 788.3588 | 788.3588 | Allowed |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 786.2584 | 786.2584 | Allowed |
| 5 | 59 | Improper Link Resolution Before File Access ('Link Following') | 779.5528 | 779.5528 | Allowed |
| 6 | 863 | Incorrect Authorization | 779.4768 | 779.4768 | Allowed-with-Review |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | 768.6613 | 768.6613 | Allowed |
| 8 | 203 | Observable Discrepancy | 768.3963 | 768.3963 | Allowed |
| 9 | 1333 | Inefficient Regular Expression Complexity | 767.8040 | 767.8040 | Allowed |
| 10 | 1390 | Weak Authentication | 760.3993 | 760.3993 | Allowed-with-Review |
