{
  "cve_id": "CVE-2024-12390",
  "description": "A vulnerability in binary-husky/gpt_academic version git 310122f allows for remote code execution. The application supports the extraction of user-provided RAR files without proper validation. The Python rarfile module, which supports symlinks, can be exploited to perform arbitrary file writes. This can lead to remote code execution by writing to sensitive files such as SSH keys, crontab files, or the applications own code.",
  "key_phrases": {
    "component": "",
    "rootcause": "improper file extraction validation",
    "vector": "",
    "weakness": "",
    "product": "binary-husky/gpt_academic",
    "impact": "arbitrary file writes, remote code execution",
    "attacker": "",
    "version": "git 310122f"
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.9 | Base | Allowed | Primary CWE |\n| CWE-61 | UNIX Symbolic Link (Symlink) Following | 0.7 | Compound | Allowed | Secondary Candidate |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.6 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE selected is CWE-59, which describes the **improper link resolution** that leads to the vulnerability. CWE-61 is a compound weakness that includes link following but is less specific than CWE-59 alone. CWE-22 is related to path traversal, which can be a consequence of link following, but it's not the root cause. The relationships between these CWEs helped to narrow down the most accurate classification. Specifically, CWE-59 is a more specific base weakness compared to the compound CWE-61, which is a composition of multiple weaknesses.\n\n```mermaid\ngraph TD\n    cwe59[\"CWE-59: Improper Link Resolution Before File Access\"]\n    cwe61[\"CWE-61: UNIX Symbolic Link (Symlink) Following\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n\n    cwe59 -->|CANFOLLOW| cwe73\n    cwe61 -->|REQUIRES| cwe386\n    cwe22 -->|CANFOLLOW| cwe73\n    cwe59 -->|PARENTOF| cwe61\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe59 primary\n    class cwe61,cwe22 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper file extraction validation** when handling RAR files. This leads to **improper link resolution (CWE-59)** because the application doesn't adequately prevent symbolic links from resolving to unintended resources. The **improper link resolution** can then lead to arbitrary file writes and ultimately remote code execution.\n  - **Root Cause:** **Improper file extraction validation**\n  - CWE-59: Improper Link Resolution Before File Access ('Link Following')\n  - Impact: Arbitrary file writes, Remote Code Execution\n\n## Summary of Analysis\nThe primary focus of the analysis was to identify the root cause of the vulnerability. The vulnerability description clearly states that the application supports the extraction of user-provided RAR files **without proper validation**, and the Python rarfile module supports symlinks, which can be exploited to perform arbitrary file writes. This points to **improper link resolution** as the core issue. The retriever results also highlighted CWE-59 as a strong candidate.\n\nThe decision to select CWE-59 was based on the following evidence:\n\n*   The vulnerability description explicitly mentions that the application supports the extraction of user-provided RAR files **without proper validation**.\n*   The Python rarfile module, which supports symlinks, can be exploited to perform arbitrary file writes.\n*   The retriever results ranked CWE-59 as a highly relevant CWE.\n\nCWE-61 was considered as a secondary candidate because it encompasses the broader concept of symlink following. However, CWE-59 is more specific to the **improper link resolution** aspect of the vulnerability, making it a more accurate classification.\n\nCWE-22 was considered, but it represents a consequence of the vulnerability (path traversal) rather than the root cause (**improper link resolution**).\n\nThe selected CWEs are at the optimal level of specificity because they directly address the **improper link resolution** that leads to the vulnerability.\n\nRelevant CWE Information:\n\n**CWE-59: Improper Link Resolution Before File Access ('Link Following')**\n\n*   How the vulnerability's details match the CWE's characteristics: The application processes RAR files containing symlinks, and it **does not properly prevent** these symlinks from resolving to unintended resources. This allows an attacker to write to arbitrary files.\n*   The security implications and potential impact: This can lead to arbitrary file writes and remote code execution.\n*   Any parent-child relationships or chain patterns that influenced your mapping: CWE-59 is a base weakness and can lead to CWE-73 (External Control of File Name or Path).\n*   Whether the weakness is primary or secondary in the vulnerability: This is the primary weakness.\n*   How the official MITRE mapping guidance influenced your decision: The mapping guidance allows the use of CWE-59 and states that it is at the Base level of abstraction, which is preferred.\n\n**CWE-61: UNIX Symbolic Link (Symlink) Following**\n\n*   How the vulnerability's details match the CWE's characteristics: The application does not sufficiently account for when a file is a symbolic link that resolves to a target outside of the intended control sphere.\n*   The security implications and potential impact: An attacker can cause the product to operate on unauthorized files.\n*   Any parent-child relationships or chain patterns that influenced your mapping: CWE-61 is a compound weakness.\n*   Whether the weakness is primary or secondary in the vulnerability: This is a secondary weakness.\n*   How the official MITRE mapping guidance influenced your decision: The mapping guidance allows the use of CWE-61, although it is attack-oriented.\n\n**CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')**\n\n*   How the vulnerability's details match the CWE's characteristics: While not the direct root cause, the ability to write to arbitrary files through symlink exploitation can lead to path traversal if an attacker crafts a symlink to point outside the intended directory.\n*   The security implications and potential impact: An attacker could potentially bypass restrictions and access unauthorized files or directories.\n*   Any parent-child relationships or chain patterns that influenced your mapping: CWE-22 is related to CWE-73 (External Control of File Name or Path).\n*   Whether the weakness is primary or secondary in the vulnerability: This is a secondary weakness.\n*   How the official MITRE mapping guidance influenced your decision: The mapping guidance allows the use of CWE-22 and states that it is at the Base level of abstraction, which is preferred.",
  "analysis_with_relationships": "# Summary\n\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-59 | Improper Link Resolution Before File Access ('Link Following') | 0.9 | Base | Allowed | Primary CWE |\n| CWE-61 | UNIX Symbolic Link (Symlink) Following | 0.7 | Compound | Allowed | Secondary Candidate |\n| CWE-22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 0.6 | Base | Allowed | Secondary Candidate |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE selected is CWE-59, which describes the **improper link resolution** that leads to the vulnerability. CWE-61 is a compound weakness that includes link following but is less specific than CWE-59 alone. CWE-22 is related to path traversal, which can be a consequence of link following, but it's not the root cause. The relationships between these CWEs helped to narrow down the most accurate classification. Specifically, CWE-59 is a more specific base weakness compared to the compound CWE-61, which is a composition of multiple weaknesses.\n\n```mermaid\ngraph TD\n    cwe59[\"CWE-59: Improper Link Resolution Before File Access\"]\n    cwe61[\"CWE-61: UNIX Symbolic Link (Symlink) Following\"]\n    cwe22[\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory\"]\n    cwe73[\"CWE-73: External Control of File Name or Path\"]\n\n    cwe59 -->|CANFOLLOW| cwe73\n    cwe61 -->|REQUIRES| cwe386\n    cwe22 -->|CANFOLLOW| cwe73\n    cwe59 -->|PARENTOF| cwe61\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe59 primary\n    class cwe61,cwe22 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper file extraction validation** when handling RAR files. This leads to **improper link resolution (CWE-59)** because the application doesn't adequately prevent symbolic links from resolving to unintended resources. The **improper link resolution** can then lead to arbitrary file writes and ultimately remote code execution.\n  - **Root Cause:** **Improper file extraction validation**\n  - CWE-59: Improper Link Resolution Before File Access ('Link Following')\n  - Impact: Arbitrary file writes, Remote Code Execution\n\n## Summary of Analysis\nThe primary focus of the analysis was to identify the root cause of the vulnerability. The vulnerability description clearly states that the application supports the extraction of user-provided RAR files **without proper validation**, and the Python rarfile module supports symlinks, which can be exploited to perform arbitrary file writes. This points to **improper link resolution** as the core issue. The retriever results also highlighted CWE-59 as a strong candidate.\n\nThe decision to select CWE-59 was based on the following evidence:\n\n*   The vulnerability description explicitly mentions that the application supports the extraction of user-provided RAR files **without proper validation**.\n*   The Python rarfile module, which supports symlinks, can be exploited to perform arbitrary file writes.\n*   The retriever results ranked CWE-59 as a highly relevant CWE.\n\nCWE-61 was considered as a secondary candidate because it encompasses the broader concept of symlink following. However, CWE-59 is more specific to the **improper link resolution** aspect of the vulnerability, making it a more accurate classification.\n\nCWE-22 was considered, but it represents a consequence of the vulnerability (path traversal) rather than the root cause (**improper link resolution**).\n\nThe selected CWEs are at the optimal level of specificity because they directly address the **improper link resolution** that leads to the vulnerability.\n\nRelevant CWE Information:\n\n**CWE-59: Improper Link Resolution Before File Access ('Link Following')**\n\n*   How the vulnerability's details match the CWE's characteristics: The application processes RAR files containing symlinks, and it **does not properly prevent** these symlinks from resolving to unintended resources. This allows an attacker to write to arbitrary files.\n*   The security implications and potential impact: This can lead to arbitrary file writes and remote code execution.\n*   Any parent-child relationships or chain patterns that influenced your mapping: CWE-59 is a base weakness and can lead to CWE-73 (External Control of File Name or Path).\n*   Whether the weakness is primary or secondary in the vulnerability: This is the primary weakness.\n*   How the official MITRE mapping guidance influenced your decision: The mapping guidance allows the use of CWE-59 and states that it is at the Base level of abstraction, which is preferred.\n\n**CWE-61: UNIX Symbolic Link (Symlink) Following**\n\n*   How the vulnerability's details match the CWE's characteristics: The application does not sufficiently account for when a file is a symbolic link that resolves to a target outside of the intended control sphere.\n*   The security implications and potential impact: An attacker can cause the product to operate on unauthorized files.\n*   Any parent-child relationships or chain patterns that influenced your mapping: CWE-61 is a compound weakness.\n*   Whether the weakness is primary or secondary in the vulnerability: This is a secondary weakness.\n*   How the official MITRE mapping guidance influenced your decision: The mapping guidance allows the use of CWE-61, although it is attack-oriented.\n\n**CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')**\n\n*   How the vulnerability's details match the CWE's characteristics: While not the direct root cause, the ability to write to arbitrary files through symlink exploitation can lead to path traversal if an attacker crafts a symlink to point outside the intended directory.\n*   The security implications and potential impact: An attacker could potentially bypass restrictions and access unauthorized files or directories.\n*   Any parent-child relationships or chain patterns that influenced your mapping: CWE-22 is related to CWE-73 (External Control of File Name or Path).\n*   Whether the weakness is primary or secondary in the vulnerability: This is a secondary weakness.\n*   How the official MITRE mapping guidance influenced your decision: The mapping guidance allows the use of CWE-22 and states that it is at the Base level of abstraction, which is preferred.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-59:**\n- 59 (Improper Link Resolution Before File Access ('Link Following')) - ROOT\n\n\n**Chain starting from CWE-73:**\n- 73 (External Control of File Name or Path) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "source": "sparse"
      },
      "similarity": 353.0017231834742
    },
    {
      "metadata": {
        "doc_id": "59",
        "name": "Improper Link Resolution Before File Access ('Link Following')",
        "source": "sparse"
      },
      "similarity": 348.6108979696367
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 342.24886166157563
    },
    {
      "metadata": {
        "doc_id": "88",
        "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
        "source": "sparse"
      },
      "similarity": 320.37189333240815
    },
    {
      "metadata": {
        "doc_id": "23",
        "name": "Relative Path Traversal",
        "source": "sparse"
      },
      "similarity": 316.8570812163735
    },
    {
      "metadata": {
        "doc_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "source": "sparse"
      },
      "similarity": 312.0057936910537
    },
    {
      "metadata": {
        "doc_id": "20",
        "name": "Improper Input Validation",
        "source": "sparse"
      },
      "similarity": 306.5143932229207
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 306.1761976855289
    },
    {
      "metadata": {
        "doc_id": "427",
        "name": "Uncontrolled Search Path Element",
        "type": "Base",
        "original_content": "The product uses a fixed or controlled search path to find resources, but one or more locations in that path can be under the control of unintended actors.",
        "keyphrase_source": "rootcause:improper file extraction validation",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5601567300487501,
            "graph": 1.5118329958228416
          }
        }
      },
      "similarity": 0.5601567300487501
    },
    {
      "doc_id": "98",
      "text": "CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')",
      "score": 2.4936000000000003,
      "metadata": {
        "doc_id": "98",
        "name": "Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')",
        "type": "variant",
        "original_content": "CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')",
        "relationships": [
          {
            "source_id": "98",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "473",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "456",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "425",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "426",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "94",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "829",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "706",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "94",
            "target_id": "98",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "829",
            "target_id": "98",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "706",
            "target_id": "98",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "473",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "456",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "425",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0,
          "peer_group": 0.63
        },
        "abstraction_factor": 1.2,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "94",
                  "98",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "94"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "94",
                  "98",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "94"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "98",
                  "94",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "94"
            },
            "peer_relationship": {
              "path": [
                [
                  "426",
                  "427",
                  "PEEROF"
                ],
                [
                  "98",
                  "426",
                  "CANALSOBE"
                ]
              ],
              "score": 0.63,
              "type": "peer_relationship",
              "source": "427"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.4936000000000003
          }
        }
      },
      "similarity": 2.4936000000000003
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-59",
      "CWE-73",
      "CWE-61",
      "CWE-22"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}