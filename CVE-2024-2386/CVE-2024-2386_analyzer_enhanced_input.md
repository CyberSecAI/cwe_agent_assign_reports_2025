## Vulnerability Description
The WordPress Plugin for Google Maps - WP MAPS plugin for WordPress is vulnerable to SQL Injection via the id parameter of the put_wpgm shortcode in all versions up to, and including, 4.6.1 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with contributor-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers with contributor-level access and above
- **product:** WordPress Plugin for Google Maps - WP MAPS plugin for WordPress
- **version:** all versions up to and including 4.6.1
- **component:** put_wpgm shortcode

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**CVE ID:** CVE-2024-2386

**Vulnerability Description:**
The WordPress Plugin for Google Maps – WP MAPS plugin is vulnerable to SQL Injection. The vulnerability lies in the `put_wpgm` shortcode, specifically with the 'id' parameter. The plugin fails to properly sanitize user-supplied input and doesn't use prepared statements, allowing an attacker to inject arbitrary SQL queries.

**Root Cause:**
- Insufficient sanitization of the `id` parameter within the `put_wpgm` shortcode.
- Lack of prepared statements in the SQL query, allowing for SQL injection.

**Weaknesses/Vulnerabilities Present:**
- SQL Injection (CWE-89)

**Impact of Exploitation:**
- Attackers with contributor-level access and above can inject SQL queries, potentially leading to:
  - Extraction of sensitive database information (e.g., user credentials, private data).
  - Modification or deletion of data.
  - Full database compromise.

**Attack Vectors:**
- The vulnerability is exposed via the `put_wpgm` shortcode. Attackers can exploit this by including the malicious `put_wpgm` shortcode on a post or page with a crafted `id` parameter.

**Required Attacker Capabilities/Position:**
- Authenticated access to the WordPress site.
- A user role of at least "Contributor" level or higher to be able to edit post content, and embed the shortcode with a malicious `id` parameter.

**Additional Information:**
- The vulnerability was found by Krzysztof Zając - CERT PL.
- The vulnerability is patched in version 4.6.2 of the plugin.
- The provided content also shows the changes made in the fix, including extensive changes to files to sanitize the input.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.629 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.597 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.564 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.555 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.553 |
| 7 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.546 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.544 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.439 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-863: Incorrect Authorization

CWE-862: Missing Authorization

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-502: Deserialization of Untrusted Data

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-425: Direct Request ('Forced Browsing')