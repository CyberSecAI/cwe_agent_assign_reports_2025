# Raw Retriever Results for CVE-2024-50338

# Raw Retriever Results for CVE-2024-50338
## Query
Git Credential Manager (GCM) is a secure Git credential helper built on .NET that runs on Windows, macOS, and Linux. The Git credential protocol is text-based over standard input/output, and consists of a series of lines of key-value pairs in the format `key=value`. Gits documentation restricts the use of the NUL (`\\0`) character and newlines to form part of the keys or values. When Git reads from standard input, it considers both LF and CRLF as newline characters for the credential protocol by virtue of calling `strbuf_getline` that calls to `strbuf_getdelim_strip_crlf`. Git also validates that a newline is not present in the value by checking for the presence of the line-feed character (LF, `\\n`), and errors if this is the case. This captures both LF and CRLF-type newlines. Git Credential Manager uses the .NET standard library `StreamReader` class to read the standard input stream line-by-line and parse the `key=value` credential protocol format. The implementation of the `ReadLineAsync` method considers LF, CRLF, and CR as valid line endings. This is means that .NET considers a single CR as a valid newline character, whereas Git does not. This mismatch of newline treatment between Git and GCM means that an attacker can craft a malicious remote URL. When a user clones or otherwise interacts with a malicious repository that requires authentication, the attacker can capture credentials for another Git remote. The attack is also heightened when cloning from repositories with submodules when using the `--recursive` clone option as the user is not able to inspect the submodule remote URLs beforehand. This issue has been patched in version 2.6.1 and all users are advised to upgrade. Users unable to upgrade should only interact with trusted remote repositories, and not clone with `--recursive` to allow inspection of any submodule URLs before cloning those submodules.

## Keyphrases
- **weakness**: 'mismatch of newline treatment between Git', 'GCM'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3731 | 0.4457 | 0.3977 | 0.3955 | 20 |
| Sparse | 1416.8428 | 1695.2482 | 1494.6990 | 1460.7544 | 10 |
| Graph | 1.0062 | 2.2100 | 1.6480 | 1.6144 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 117 | Improper Output Neutralization for Logs | base | 2.2100 | Allowed |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.2100 | Allowed |
| 3 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 2.1866 | Allowed |
| 4 | 427 | Uncontrolled Search Path Element | base | 2.1190 | Allowed |
| 5 | 494 | Download of Code Without Integrity Check | base | 1.7680 | Allowed |
| 6 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.7160 | Allowed |
| 7 | 184 | Incomplete List of Disallowed Inputs | base | 1.6848 | Allowed |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 1.6624 | Allowed |
| 9 | 41 | Improper Resolution of Path Equivalence | base | 1.6380 | Allowed |
| 10 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 1.6247 | Allowed |
| 11 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | 1.6041 | Allowed |
| 12 | 426 | Untrusted Search Path | base | 1.5210 | Allowed |
| 13 | 178 | Improper Handling of Case Sensitivity | base | 1.5210 | Allowed |
| 14 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 1.4626 | Allowed |
| 15 | 1392 | Use of Default Credentials | Base | 1.4451 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.4457 | 0.4457 | Allowed |
| 2 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.4381 | 0.4381 | Allowed |
| 3 | 522 | Insufficiently Protected Credentials | Class | 0.4203 | 0.4203 | Allowed-with-Review |
| 4 | 1392 | Use of Default Credentials | Base | 0.4190 | 0.4190 | Allowed |
| 5 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.4167 | 0.4167 | Allowed |
| 6 | 527 | Exposure of Version-Control Repository to an Unauthorized Control Sphere | Variant | 0.4124 | 0.4124 | Allowed |
| 7 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 0.4096 | 0.4096 | Allowed |
| 8 | 312 | Cleartext Storage of Sensitive Information | Base | 0.4062 | 0.4062 | Allowed |
| 9 | 256 | Plaintext Storage of a Password | Base | 0.4040 | 0.4040 | Allowed |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.4032 | 0.4032 | Allowed |
| 11 | 520 | .NET Misconfiguration: Use of Impersonation | Variant | 0.3879 | 0.3879 | Allowed |
| 12 | 603 | Use of Client-Side Authentication | Base | 0.3809 | 0.3809 | Allowed |
| 13 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 0.3797 | 0.3797 | Allowed |
| 14 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.3785 | 0.3785 | Allowed |
| 15 | 549 | Missing Password Field Masking | Base | 0.3780 | 0.3780 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 1695.2482 | 1695.2482 | Allowed |
| 2 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 1583.4336 | 1583.4336 | Allowed |
| 3 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 1569.3269 | 1569.3269 | Allowed |
| 4 | 1289 | Improper Validation of Unsafe Equivalence in Input | 1482.5203 | 1482.5203 | Allowed |
| 5 | 427 | Uncontrolled Search Path Element | 1481.1757 | 1481.1757 | Allowed |
| 6 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 1440.3332 | 1440.3332 | Allowed-with-Review |
| 7 | 1333 | Inefficient Regular Expression Complexity | 1434.0694 | 1434.0694 | Allowed |
| 8 | 116 | Improper Encoding or Escaping of Output | 1424.6824 | 1424.6824 | Allowed-with-Review |
| 9 | 287 | Improper Authentication | 1419.3571 | 1419.3571 | Discouraged |
| 10 | 347 | Improper Verification of Cryptographic Signature | 1416.8428 | 1416.8428 | Allowed |
