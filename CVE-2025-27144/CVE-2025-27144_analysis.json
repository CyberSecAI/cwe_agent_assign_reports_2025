{
  "cve_id": "CVE-2025-27144",
  "description": "Go JOSE provides an implementation of the Javascript Object Signing and Encryption set of standards in Go, including support for JSON Web Encryption (JWE), JSON Web Signature (JWS), and JSON Web Token (JWT) standards. In versions on the 4.x branch prior to version 4.0.5, when parsing compact JWS or JWE input, Go JOSE could use excessive memory. The code used strings.Split(token, .) to split JWT tokens, which is vulnerable to **excessive memory consumption** when processing maliciously crafted tokens with a large number of `.` characters. An attacker could exploit this by sending numerous malformed tokens, leading to memory exhaustion and a Denial of Service. Version 4.0.5 fixes this issue. As a workaround, applications could pre-validate that payloads passed to Go JOSE do not contain an excessive number of `.` characters.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "excessive memory consumption",
    "impact": "Denial of Service",
    "vector": "maliciously crafted tokens with a large number of `.` characters",
    "attacker": "",
    "product": "Go JOSE",
    "version": "4.x branch prior to version 4.0.5",
    "component": ""
  },
  "reference_content": "```text\nRoot cause of vulnerability:\nThe code used `strings.Split(token, \".\")` to split JWT tokens, which is vulnerable to excessive memory consumption when processing maliciously crafted tokens with a large number of '.' characters.\n\nWeaknesses/vulnerabilities present:\n- Excessive memory consumption during JWT token parsing.\n- Vulnerability to Denial of Service (DoS) attacks.\n\nImpact of exploitation:\nAn attacker could exploit this by sending numerous malformed tokens, leading to memory exhaustion and a Denial of Service.\n\nAttack vectors:\n- Sending numerous malformed JWT tokens with a large number of '.' characters.\n\nRequired attacker capabilities/position:\n- Network access to send crafted tokens. No authentication required.\n\nMitigation or fix:\n- Upgrade to version 4.0.5 or 3.0.4.\n- Applications can pre-validate payloads to ensure they do not contain an excessive number of '.' characters.\n\nCVE ID: CVE-2025-27144\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-789 | Memory Allocation with Excessive Size Value | 0.9 | Variant | Allowed | Primary CWE. The code allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated. |\n| CWE-400 | Uncontrolled Resource Consumption | 0.7 | Class | Discouraged | Secondary CWE. The vulnerability leads to excessive memory consumption, which is a form of uncontrolled resource consumption leading to DoS. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-789 (Memory Allocation with Excessive Size Value)**, which is a variant of **CWE-770 (Allocation of Resources Without Limits or Throttling)** and is related to **CWE-400 (Uncontrolled Resource Consumption)** as a consequence of the excessive memory allocation. **CWE-789** is a more specific variant of **CWE-770**, which is a child of **CWE-400**.\n\n```mermaid\ngraph TD\n    cwe789[\"CWE-789: Memory Allocation with Excessive Size Value\"]\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe789 -->|CHILDOF| cwe770\n    cwe770 -->|CHILDOF| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe789 primary\n    class cwe400 secondary\n    class cwe770 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the use of `strings.Split(token, \".\")` to split JWT tokens. This leads to **CWE-789 (Memory Allocation with Excessive Size Value)**, because an attacker can craft a token with a large number of '.' characters, leading to **excessive memory consumption** and, ultimately, **CWE-400 (Uncontrolled Resource Consumption)**, resulting in a Denial of Service (DoS).\n\n## Summary of Analysis\nThe analysis is based on the provided evidence, which includes the vulnerability description and the CVE reference summary. The key phrase \"**excessive memory consumption**\" directly points to memory allocation issues. The CVE reference summary confirms that the code splits JWT tokens in a way that is vulnerable to excessive memory consumption when processing maliciously crafted tokens.\n\nThe retriever results also indicate **CWE-789 (Memory Allocation with Excessive Size Value)** as a potential candidate, and after careful consideration, it is the most appropriate primary CWE. Other CWEs like **CWE-834 (Excessive Iteration)** and **CWE-674 (Uncontrolled Recursion)** are less relevant because the core issue is related to memory allocation rather than iteration or recursion. **CWE-400 (Uncontrolled Resource Consumption)** is also relevant as a consequence of the **excessive memory consumption**.\n\nThe selected CWEs are at the optimal level of specificity because **CWE-789** is a Variant-level CWE, providing a detailed description of the **memory allocation** issue, and **CWE-400** represents the broader impact of resource consumption.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-789 | Memory Allocation with Excessive Size Value | 0.9 | Variant | Allowed | Primary CWE. The code allocates memory based on an untrusted, large size value, but it does not ensure that the size is within expected limits, allowing arbitrary amounts of memory to be allocated. |\n| CWE-400 | Uncontrolled Resource Consumption | 0.7 | Class | Discouraged | Secondary CWE. The vulnerability leads to excessive memory consumption, which is a form of uncontrolled resource consumption leading to DoS. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is **CWE-789 (Memory Allocation with Excessive Size Value)**, which is a variant of **CWE-770 (Allocation of Resources Without Limits or Throttling)** and is related to **CWE-400 (Uncontrolled Resource Consumption)** as a consequence of the excessive memory allocation. **CWE-789** is a more specific variant of **CWE-770**, which is a child of **CWE-400**.\n\n```mermaid\ngraph TD\n    cwe789[\"CWE-789: Memory Allocation with Excessive Size Value\"]\n    cwe770[\"CWE-770: Allocation of Resources Without Limits or Throttling\"]\n    cwe400[\"CWE-400: Uncontrolled Resource Consumption\"]\n    \n    cwe789 -->|CHILDOF| cwe770\n    cwe770 -->|CHILDOF| cwe400\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe789 primary\n    class cwe400 secondary\n    class cwe770 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the use of `strings.Split(token, \".\")` to split JWT tokens. This leads to **CWE-789 (Memory Allocation with Excessive Size Value)**, because an attacker can craft a token with a large number of '.' characters, leading to **excessive memory consumption** and, ultimately, **CWE-400 (Uncontrolled Resource Consumption)**, resulting in a Denial of Service (DoS).\n\n## Summary of Analysis\nThe analysis is based on the provided evidence, which includes the vulnerability description and the CVE reference summary. The key phrase \"**excessive memory consumption**\" directly points to memory allocation issues. The CVE reference summary confirms that the code splits JWT tokens in a way that is vulnerable to excessive memory consumption when processing maliciously crafted tokens.\n\nThe retriever results also indicate **CWE-789 (Memory Allocation with Excessive Size Value)** as a potential candidate, and after careful consideration, it is the most appropriate primary CWE. Other CWEs like **CWE-834 (Excessive Iteration)** and **CWE-674 (Uncontrolled Recursion)** are less relevant because the core issue is related to memory allocation rather than iteration or recursion. **CWE-400 (Uncontrolled Resource Consumption)** is also relevant as a consequence of the **excessive memory consumption**.\n\nThe selected CWEs are at the optimal level of specificity because **CWE-789** is a Variant-level CWE, providing a detailed description of the **memory allocation** issue, and **CWE-400** represents the broader impact of resource consumption.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-400:**\n- 400 (Uncontrolled Resource Consumption) - ROOT\n\n\n**Chain starting from CWE-770:**\n- 770 (Allocation of Resources Without Limits or Throttling) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "834",
        "name": "Excessive Iteration",
        "source": "sparse"
      },
      "similarity": 788.3057383135313
    },
    {
      "metadata": {
        "doc_id": "789",
        "name": "Memory Allocation with Excessive Size Value",
        "source": "sparse"
      },
      "similarity": 690.979015371724
    },
    {
      "metadata": {
        "doc_id": "674",
        "name": "Uncontrolled Recursion",
        "source": "sparse"
      },
      "similarity": 679.0511260808009
    },
    {
      "metadata": {
        "doc_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "source": "sparse"
      },
      "similarity": 676.8434552391501
    },
    {
      "metadata": {
        "doc_id": "400",
        "name": "Uncontrolled Resource Consumption",
        "source": "sparse"
      },
      "similarity": 665.3533956355402
    },
    {
      "metadata": {
        "doc_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "source": "sparse"
      },
      "similarity": 658.6048562601148
    },
    {
      "metadata": {
        "doc_id": "770",
        "name": "Allocation of Resources Without Limits or Throttling",
        "source": "sparse"
      },
      "similarity": 649.323900842771
    },
    {
      "metadata": {
        "doc_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "source": "sparse"
      },
      "similarity": 649.0743513719433
    },
    {
      "metadata": {
        "doc_id": "1270",
        "name": "Generation of Incorrect Security Tokens",
        "type": "Base",
        "original_content": "The product implements a Security Token mechanism to differentiate what actions are allowed or disallowed when a transaction originates from an entity. However, the Security Tokens generated in the system are incorrect.",
        "keyphrase_source": "weakness:excessive memory consumption",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.4025193163606393
          }
        }
      },
      "similarity": 0.4025193163606393
    },
    {
      "doc_id": "410",
      "text": "CWE-410: Insufficient Resource Pool",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "410",
        "name": "Insufficient Resource Pool",
        "type": "base",
        "original_content": "CWE-410: Insufficient Resource Pool",
        "relationships": [
          {
            "source_id": "410",
            "target_id": "400",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "410",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "410",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "412",
            "target_id": "410",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "400",
            "target_id": "410",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "400",
                  "410",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "400"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "400",
                  "410",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "400"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "410",
                  "400",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "400"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-400",
      "CWE-770",
      "CWE-834",
      "CWE-674",
      "CWE-789"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}