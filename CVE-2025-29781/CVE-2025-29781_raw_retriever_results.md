# Raw Retriever Results for CVE-2025-29781

# Raw Retriever Results for CVE-2025-29781
## Query
The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. Baremetal Operator enables users to load Secret from arbitrary namespaces upon deployment of the namespace scoped Custom Resource `BMCEventSubscription`. Prior to versions 0.8.1 and 0.9.1, an adversary Kubernetes account with only namespace level roles (e.g. a tenant controlling a namespace) may create a `BMCEventSubscription` in his authorized namespace and then load Secrets from his unauthorized namespaces to his authorized namespace via the Baremetal Operator, causing Secret Leakage. The patch makes BMO refuse to read Secrets from other namespace than where the corresponding BMH resource is. The patch does not change the `BMCEventSubscription` API in BMO, but stricter validation will fail the request at admission time. It will also prevent the controller reading such Secrets, in case the BMCES CR has already been deployed. The issue exists for all versions of BMO, and is patched in BMO releases v0.9.1 and v0.8.1. Prior upgrading to patched BMO version, duplicate any existing Secret pointed to by `BMCEventSubscription`s `httpHeadersRef` to the same namespace where the corresponding BMH exists. After upgrade, remove the old Secrets. As a workaround, the operator can configure BMO RBAC to be namespace scoped, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces, and/or use `WATCH_NAMESPACE` configuration option to limit BMO to single namespace.

## Keyphrases
- **rootcause**: 'improper access control'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3989 | 0.4612 | 0.4253 | 0.4223 | 20 |
| Sparse | 967.8182 | 1158.6947 | 1045.3229 | 1030.3004 | 10 |
| Graph | 1.2262 | 2.8652 | 1.6025 | 1.4833 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 322 | Key Exchange without Entity Authentication | base | 2.8652 | Allowed |
| 2 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 2.6784 | Allowed |
| 3 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.0400 | Allowed |
| 4 | 306 | Missing Authentication for Critical Function | Base | 1.6213 | Allowed |
| 5 | 532 | Insertion of Sensitive Information into Log File | Base | 1.6184 | Allowed |
| 6 | 613 | Insufficient Session Expiration | base | 1.6016 | Allowed |
| 7 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 1.5870 | Allowed |
| 8 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.5768 | Allowed |
| 9 | 499 | Serializable Class Containing Sensitive Data | variant | 1.5024 | Allowed |
| 10 | 498 | Cloneable Class Containing Sensitive Information | variant | 1.5024 | Allowed |
| 11 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 1.4642 | Allowed |
| 12 | 73 | External Control of File Name or Path | base | 1.4602 | Allowed |
| 13 | 472 | External Control of Assumed-Immutable Web Parameter | base | 1.4004 | Allowed |
| 14 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | class | 1.3600 | Allowed-with-Review |
| 15 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.3600 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 277 | Insecure Inherited Permissions | Variant | 0.4612 | 0.4612 | Allowed |
| 2 | 286 | Incorrect User Management | Class | 0.4507 | 0.4507 | Allowed-with-Review |
| 3 | 863 | Incorrect Authorization | Class | 0.4504 | 0.4504 | Allowed-with-Review |
| 4 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.4474 | 0.4474 | Allowed |
| 5 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4443 | 0.4443 | Allowed |
| 6 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | 0.4412 | 0.4412 | Discouraged |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4395 | 0.4395 | Allowed |
| 8 | 285 | Improper Authorization | Class | 0.4376 | 0.4376 | Discouraged |
| 9 | 347 | Improper Verification of Cryptographic Signature | Base | 0.4363 | 0.4363 | Allowed |
| 10 | 862 | Missing Authorization | Class | 0.4307 | 0.4307 | Allowed-with-Review |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 0.4140 | 0.4140 | Allowed |
| 12 | 1230 | Exposure of Sensitive Information Through Metadata | Base | 0.4124 | 0.4124 | Allowed |
| 13 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4109 | 0.4109 | Allowed |
| 14 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 0.4091 | 0.4091 | Allowed |
| 15 | 668 | Exposure of Resource to Wrong Sphere | Class | 0.4081 | 0.4081 | Discouraged |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 1158.6947 | 1158.6947 | Allowed-with-Review |
| 2 | 863 | Incorrect Authorization | 1146.3452 | 1146.3452 | Allowed-with-Review |
| 3 | 532 | Insertion of Sensitive Information into Log File | 1101.5631 | 1101.5631 | Allowed |
| 4 | 668 | Exposure of Resource to Wrong Sphere | 1054.6584 | 1054.6584 | Discouraged |
| 5 | 306 | Missing Authentication for Critical Function | 1035.2510 | 1035.2510 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | 1025.3497 | 1025.3497 | Allowed |
| 7 | 285 | Improper Authorization | 1007.8558 | 1007.8558 | Discouraged |
| 8 | 347 | Improper Verification of Cryptographic Signature | 987.0243 | 987.0243 | Allowed |
| 9 | 732 | Incorrect Permission Assignment for Critical Resource | 968.6680 | 968.6680 | Allowed-with-Review |
| 10 | 1390 | Weak Authentication | 967.8182 | 967.8182 | Allowed-with-Review |
