## Vulnerability Description
A vulnerability, which was classified as problematic, was found in UPX up to 5.0.0. Affected is the function PackLinuxElf64un_DT_INIT of the file src/p_lx_elf.cpp. The manipulation leads to **heap-based buffer overflow**. It is possible to launch the attack on the local host. The exploit has been disclosed to the public and may be used. The patch is identified as e0b6ff192412f5bb5364c1948f4f6b27a0cd5ea2. It is recommended to apply a patch to fix this issue.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** UPX
- **version:** up to 5.0.0
- **component:** PackLinuxElf64un_DT_INIT of src/p_lx_elf.cpp

## CVE Reference Links Content Summary
CVE-2025-2849 is a placeholder, so I cannot verify if the content relates to it based on an official description. However, the provided content details two vulnerabilities found in UPX:

**Root cause of vulnerability:**

*   **SEGFAULT:** Occurs in `PackLinuxElf64::un_DT_INIT` at `src/p_lx_elf.cpp:7499`.
*   **Heap-buffer-overflow:** Occurs in `N_BELE_RTP::LEPolicy::get32` at `src/util/../bele_policy.h:174`.

**Weaknesses/vulnerabilities present:**

*   **SEGFAULT:**  A write memory access on an unknown address (zero page).
*   **Heap-buffer-overflow:** A read of size 4 overflows a heap buffer.

**Impact of exploitation:**

*   The provided content does not explicitly state the impact, but the vulnerabilities (SEGFAULT and heap-buffer-overflow) suggest potential for denial of service or potentially arbitrary code execution if exploited.

**Attack vectors:**

*   Decompressing a crafted file. The issue can be reproduced using `upx -df input/input1 -o /dev/null` and `upx -df input/input2 -o /dev/null` with a provided `input.zip` file.

**Required attacker capabilities/position:**

*   The attacker needs to be able to provide a crafted input file to UPX for decompression.

**Mitigation or fix:**

*   The provided content does not specify a fix, but a commit (e0b6ff1) is mentioned as addressing the issue with "More checking in unpack()". The commit modifies `p_lx_elf.cpp` to add checks for valid memory access and file offsets.

**Additional Details:**

*   The reports were generated using AddressSanitizer (ASAN).
*   UPX version used: 5.0.0-devel.15+git-1c5fae74
*   Host OS: Ubuntu 20.04.6 LTS
*   Host CPU architecture: x86\_64

This content provides significantly more detail than a typical CVE description would, including specific file names, line numbers, and ASAN reports.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.516 |
| 4 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.514 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.511 |
| 6 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.504 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.472 |
| 8 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.469 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.591 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-122: Heap-based Buffer Overflow

CWE-125: Out-of-bounds Read

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1241: Use of Predictable Algorithm in Random Number Generator

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-126: Buffer Over-read

CWE-121: Stack-based Buffer Overflow

CWE-128: Wrap-around Error