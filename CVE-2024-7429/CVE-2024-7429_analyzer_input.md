# Vulnerability Information: CVE-2024-7429

## Vulnerability Description
The Zotpress plugin for WordPress is vulnerable to unauthorized modification of data due to a **missing capability check** on the Zotpress_process_accounts_AJAX function in all versions up to, and including, 7.3.12. This makes it possible for authenticated attackers, with Contributor-level access and above, to reset the plugins settings.

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **impact:** unauthorized modification of data
- **attacker:** authenticated attackers with Contributor-level access and above
- **product:** Zotpress plugin for WordPress
- **version:** up to and including 7.3.12
- **component:** Zotpress_process_accounts_AJAX function

## CVE Reference Links Content Summary
### Summary of CVE-2024-7429

**Root cause of vulnerability:**
The Zotpress plugin for WordPress lacked proper authorization checks in the `Zotpress_process_accounts_AJAX` function. This function handles various plugin settings modifications.

**Weaknesses/vulnerabilities present:**
- Missing authorization check: The `Zotpress_process_accounts_AJAX` function didn't verify if the user had the necessary permissions to perform the requested actions, allowing unauthorized access to sensitive plugin settings.
- Improper Access Control

**Impact of exploitation:**
- An authenticated attacker with Contributor-level access or higher could reset the plugin's settings by exploiting the missing authorization check. This would allow a lower-privileged user to disrupt or modify the plugin's functionality on the WordPress site.
- The attacker could add, delete, and clear the cache of accounts. Additionally, they could set default accounts and styles, set a reference widget for CPT, and reset the plugin.
- The attacker could also add or remove item images

**Attack vectors:**
- The vulnerability is triggered via AJAX requests to the `Zotpress_process_accounts_AJAX` function.
- Attackers need to be authenticated WordPress users with at least Contributor-level access.

**Required attacker capabilities/position:**
- The attacker must be a registered user on the WordPress site with at least Contributor-level privileges.
- The attacker needs the ability to send crafted AJAX requests.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.398 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.387 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.370 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.354 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.337 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.335 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.326 |
| 8 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.318 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.466 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

