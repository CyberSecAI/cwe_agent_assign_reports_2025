## Vulnerability Description
A vulnerability in the /v1/runs API endpoint of lightning-ai/pytorch-lightning v2.2.4 allows attackers to exploit **path traversal** when extracting tar.gz files. When the LightningApp is running with the plugin_server, attackers can deploy malicious tar.gz plugins that embed arbitrary files with **path traversal** vulnerabilities. This can result in arbitrary files being written to any directory in the victims local file system, potentially leading to remote code execution.

### Vulnerability Description Key Phrases
- **weakness:** **path traversal**
- **impact:** arbitrary file write and remote code execution
- **product:** lightning-ai/pytorch-lightning
- **version:** v2.2.4
- **component:** /v1/runs API endpoint

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.458 |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.434 |
| 4 | 73 | External Control of File Name or Path | Base | Allowed | sparse | 0.361 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.353 |
| 6 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.349 |
| 7 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.346 |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.332 |
| 9 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | dense | 0.535 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-23: Relative Path Traversal

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-73: External Control of File Name or Path

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-36: Absolute Path Traversal

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')