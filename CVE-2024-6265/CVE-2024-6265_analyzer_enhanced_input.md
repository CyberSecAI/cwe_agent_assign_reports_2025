## Vulnerability Description
The UsersWP - Front-end login form, User Registration, User Profile & Members Directory plugin for WordPress plugin for WordPress is vulnerable to time-based SQL Injection via the uwp_sort_by parameter in all versions up to, and including, 1.2.10 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** unauthenticated attackers
- **product:** UsersWP - Front-end login form and User Registration and User Profile & Members Directory plugin for WordPress
- **version:** up to and including 1.2.10
- **component:** uwp_sort_by parameter

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2024-6265:

**1. Verification:**

*   The provided content directly relates to the specified CVE ID (CVE-2024-6265), as confirmed by the Wordfence description, which explicitly mentions "UsersWP â€“ Front-end login form, User Registration, User Profile & Members Directory plugin for WordPress <= 1.2.10 - Unauthenticated SQL Injection via 'uwp_sort_by'" and also indicates CVE-2024-6265. This is further supported by the Trac links showing code changes that address the vulnerability.

**2. Root Cause of Vulnerability:**

*   **Insufficient Input Sanitization:** The vulnerability stems from a lack of proper input sanitization and escaping of the `uwp_sort_by` parameter in the `class-uwp-settings-user-sorting.php` file.
*   **Lack of Prepared Statements:** The SQL query using this unsanitized input lacked sufficient preparation.

**3. Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The primary vulnerability is an SQL injection flaw. This occurs because the `uwp_sort_by` parameter, taken directly from user input (HTTP GET request), is directly incorporated into an SQL query without adequate sanitization or use of prepared statements.

**4. Impact of Exploitation:**

*   **Sensitive Data Exposure:** Successful exploitation of this vulnerability allows unauthenticated attackers to inject arbitrary SQL queries. This can lead to the extraction of sensitive data, including user credentials, private information, or other data stored in the database.
*   **Potential System Compromise:** In some cases, depending on the database configuration and user privileges, SQL injection can lead to further compromise of the system hosting the database.
*   **Time-Based SQL Injection:** The specific type of SQL injection is described as time-based. This implies an attacker might not be able to see the output of their queries directly, and would instead use techniques to induce timed responses from the server which reveal information.

**5. Attack Vectors:**

*   **Unauthenticated HTTP GET Request:** Attackers can exploit this vulnerability via an HTTP GET request by providing malicious SQL code within the `uwp_sort_by` parameter, typically on a user listing page.

**6. Required Attacker Capabilities/Position:**

*   **Unauthenticated Access:** The attacker does not need to have any prior user credentials or authenticated access to the WordPress site.
*   **Network Access:** The attacker needs network access to send HTTP requests to the WordPress site.

**Additional Information from the Provided Content:**

*   **Patch Information:** The vulnerability is addressed in version 1.2.11 of the plugin, which includes changes in `class-uwp-settings-user-sorting.php` and a change log documenting the fix.
*   **Specific Code Changes:**
    *   In `class-uwp-settings-user-sorting.php`, the `strip_tags` and `esc_sql` are replaced with `sanitize_key` and `esc_sql` in sanitizing the `uwp_sort_by` parameter.
    *   An additional check to make sure meta keys exist in `class-uwp-settings-user-sorting.php` before using them in the query
    *  A fix for a bug that resulted in incorrect listing counts of custom post types was also implemented.
*   **Affected Versions:** The vulnerability is present in all versions of the plugin up to and including 1.2.10.
*   **CVE Assignment:** The vulnerability has been officially assigned the CVE ID CVE-2024-6265.
*   **CVSS Score:** The vulnerability has a CVSS score of 9.8, classified as Critical.

**Summary of Changes in the Fixed Version:**

*   The `uwp_sort_by` parameter is now sanitized using `sanitize_key()` instead of `strip_tags()`
*   Added a check if a user-provided meta key exists before using it in the query.
*   Corrected incorrect listing count for GD post types

In conclusion, the provided information confirms an unauthenticated SQL injection vulnerability (CVE-2024-6265) in the UsersWP plugin, exploitable via the `uwp_sort_by` parameter. The vulnerability allows attackers to extract sensitive data from the database. Plugin versions up to and including 1.2.10 are vulnerable, and users should update to version 1.2.11 or later to remediate this security issue.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.572 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.529 |
| 4 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.528 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.512 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.510 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.510 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.505 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.494 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-863: Incorrect Authorization

CWE-502: Deserialization of Untrusted Data

CWE-862: Missing Authorization

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-471: Modification of Assumed-Immutable Data (MAID)