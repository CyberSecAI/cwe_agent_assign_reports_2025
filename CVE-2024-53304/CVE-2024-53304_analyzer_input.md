# Vulnerability Information: CVE-2024-53304

## Vulnerability Description
An issue in LRQA Nettitude PoshC2 after commit 09ee2cf allows unauthenticated attackers to connect to the C2 server and execute arbitrary commands via posing as an infected machine.

### Vulnerability Description Key Phrases
- **impact:** connect to C2 server and execute arbitrary commands
- **vector:** posing as infected machine
- **attacker:** unauthenticated attackers
- **product:** LRQA Nettitude PoshC2
- **version:** after commit 09ee2cf

## CVE Reference Links Content Summary
The content relates to CVE-2024-53304. It provides more detail than the official CVE description.

**Root cause of vulnerability:**

The vulnerability lies in PoshC2's `c2view.html` and `start_api.py` files. Specifically, it's an RCE (Remote Code Execution) vulnerability introduced in commits 09ee2cf5c81d2dab5e216bf5c969300664c9b28b and 123db87d331d49a8a9843720c773a925da40664b.

**Weaknesses/vulnerabilities present:**

*   Cross-Site Scripting (XSS) leading to Remote Code Execution.
*   Insecure deserialization or handling of user-supplied data.

**Impact of exploitation:**

Successful exploitation allows an attacker to execute arbitrary code on the PoshC2 server. The provided script attempts to deploy a reverse shell.

**Attack vectors:**

*   The script leverages an XSS vulnerability to inject a malicious script into the PoshC2 server.
*   The script uploads a payload (`poshc2.py`) to a specific directory on the server (`/opt/PoshC2/start_api.py`).
*   The payload is designed to download and execute a reverse shell.

**Required attacker capabilities/position:**

*   The attacker needs to be able to send malicious requests to the PoshC2 server.
*   The attacker needs to understand the PoshC2 architecture and the vulnerable endpoints.
*   The attacker needs to be able to craft a payload that exploits the XSS vulnerability and establishes a reverse shell.

**Mitigation or fix:**

The content does not explicitly mention a fix, but implies that updating PoshC2 beyond the vulnerable commits would be necessary. Proper input validation and sanitization are crucial to prevent XSS vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.045 |
| 2 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.045 |
| 3 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.044 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.044 |
| 5 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.043 |
| 6 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.043 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.043 |
| 8 | 824 | Access of Uninitialized Pointer | Base | Allowed | sparse | 0.043 |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | dense | 0.552 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

