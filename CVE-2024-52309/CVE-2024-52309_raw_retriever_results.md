# Raw Retriever Results for CVE-2024-52309

# Raw Retriever Results for CVE-2024-52309
## Query
SFTPGo is a full-featured and highly configurable SFTP, HTTP/S, FTP/S and WebDAV server - S3, Google Cloud Storage, Azure Blob. One powerful feature of SFTPGo is the ability to have the EventManager execute scripts or run applications in response to certain events. This feature is very common in all software similar to SFTPGo and is generally unrestricted. However, any SFTPGo administrator with permission to run a script has access to the underlying OS/container with the same permissions as the user running SFTPGo. This is unexpected for some SFTPGo administrators who think that there is a clear distinction between accessing the system shell and accessing the SFTPGo WebAdmin UI. To avoid this confusion, running system commands is disabled by default in 2.6.3, and an allow list has been added so that system administrators configuring SFTPGo must explicitly define which commands are allowed to be configured from the WebAdmin UI.

## Keyphrases
- **rootcause**: 'unrestricted access to underlying OS', 'container'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3219 | 0.4213 | 0.3572 | 0.3610 | 20 |
| Sparse | 756.7278 | 840.1072 | 789.8451 | 791.3549 | 11 |
| Graph | 1.3600 | 2.2519 | 1.6495 | 1.6320 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.2519 | Allowed |
| 2 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 3 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 2.0064 | Allowed |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 1.9527 | Allowed-with-Review |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 6 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 7 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 9 | 250 | Execution with Unnecessary Privileges | Base | 1.6447 | Allowed |
| 10 | 473 | PHP External Variable Modification | variant | 1.6320 | Allowed |
| 11 | 456 | Missing Initialization of a Variable | variant | 1.6320 | Allowed |
| 12 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.5024 | Allowed |
| 13 | 73 | External Control of File Name or Path | Base | 1.4909 | Allowed |
| 14 | 184 | Incomplete List of Disallowed Inputs | Base | 1.4882 | Allowed |
| 15 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 1.4548 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 0.4213 | 0.4213 | Allowed |
| 2 | 220 | Storage of File With Sensitive Data Under FTP Root | Variant | 0.4128 | 0.4128 | Allowed |
| 3 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | 0.3867 | 0.3867 | Allowed |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.3769 | 0.3769 | Allowed |
| 5 | 250 | Execution with Unnecessary Privileges | Base | 0.3727 | 0.3727 | Allowed |
| 6 | 427 | Uncontrolled Search Path Element | Base | 0.3718 | 0.3718 | Allowed |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.3716 | 0.3716 | Allowed |
| 8 | 219 | Storage of File with Sensitive Data Under Web Root | Variant | 0.3696 | 0.3696 | Allowed |
| 9 | 552 | Files or Directories Accessible to External Parties | Base | 0.3683 | 0.3683 | Allowed |
| 10 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.3679 | 0.3679 | Allowed |
| 11 | 277 | Insecure Inherited Permissions | Variant | 0.3541 | 0.3541 | Allowed |
| 12 | 553 | Command Shell in Externally Accessible Directory | Variant | 0.3526 | 0.3526 | Allowed |
| 13 | 285 | Improper Authorization | Class | 0.3304 | 0.3304 | Discouraged |
| 14 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.3304 | 0.3304 | Allowed |
| 15 | 306 | Missing Authentication for Critical Function | Base | 0.3297 | 0.3297 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 840.1072 | 840.1072 | Allowed-with-Review |
| 2 | 269 | Improper Privilege Management | 811.6225 | 811.6225 | Discouraged |
| 3 | 250 | Execution with Unnecessary Privileges | 795.9650 | 795.9650 | Allowed |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | 795.0968 | 795.0968 | Allowed-with-Review |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 794.3728 | 794.3728 | Allowed |
| 6 | 732 | Incorrect Permission Assignment for Critical Resource | 791.3549 | 791.3549 | Allowed-with-Review |
| 7 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 785.7065 | 785.7065 | Allowed |
| 8 | 668 | Exposure of Resource to Wrong Sphere | 775.3006 | 775.3006 | Discouraged |
| 9 | 266 | Incorrect Privilege Assignment | 772.3675 | 772.3675 | Allowed |
| 10 | 306 | Missing Authentication for Critical Function | 769.6741 | 769.6741 | Allowed |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | 756.7278 | 756.7278 | Allowed |
