# Raw Retriever Results for CVE-2024-42140

# Raw Retriever Results for CVE-2024-42140
## Query
In the Linux kernel, the following vulnerability has been resolved riscv kexec Avoid deadlock in kexec crash path If the kexec crash code is called in the interrupt context, the machine_kexec_mask_interrupts() function will trigger a deadlock while trying to acquire the irqdesc spinlock and then deactivate irqchip in irq_set_irqchip_state() function. Unlike arm64, riscv only requires irq_eoi handler to complete EOI and keeping irq_set_irqchip_state() will only leave this possible deadlock without any use. So we simply remove it.

## Keyphrases
- **rootcause**: 'deadlock in the interrupt context'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4203 | 0.4924 | 0.4434 | 0.4438 | 20 |
| Sparse | 337.0859 | 420.3792 | 358.2112 | 343.1485 | 10 |
| Graph | 1.4734 | 2.6104 | 1.8329 | 1.6879 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 663 | Use of a Non-reentrant Function in a Concurrent Context | base | 2.6104 | Allowed |
| 2 | 459 | Incomplete Cleanup | base | 2.3998 | Allowed |
| 3 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.3868 | Allowed |
| 4 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 5 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 6 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 7 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 9 | 833 | Deadlock | Base | 1.7003 | Allowed |
| 10 | 413 | Improper Resource Locking | Base | 1.6910 | Allowed |
| 11 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 12 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 13 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 15 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 1.5912 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4924 | 0.4924 | Allowed |
| 2 | 833 | Deadlock | Base | 0.4885 | 0.4885 | Allowed |
| 3 | 413 | Improper Resource Locking | Base | 0.4585 | 0.4585 | Allowed |
| 4 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4537 | 0.4537 | Allowed |
| 5 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4515 | 0.4515 | Allowed |
| 6 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | 0.4508 | 0.4508 | Allowed |
| 7 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.4465 | 0.4465 | Allowed |
| 8 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.4458 | 0.4458 | Allowed |
| 9 | 667 | Improper Locking | Class | 0.4453 | 0.4453 | Allowed-with-Review |
| 10 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4446 | 0.4446 | Allowed |
| 11 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4430 | 0.4430 | Allowed |
| 12 | 1037 | Processor Optimization Removal or Modification of Security-critical Code | Base | 0.4411 | 0.4411 | Allowed |
| 13 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.4402 | 0.4402 | Allowed |
| 14 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4311 | 0.4311 | Allowed |
| 15 | 1262 | Improper Access Control for Register Interface | Base | 0.4249 | 0.4249 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 420.3792 | 420.3792 | Allowed-with-Review |
| 2 | 833 | Deadlock | 401.8754 | 401.8754 | Allowed |
| 3 | 663 | Use of a Non-reentrant Function in a Concurrent Context | 369.0062 | 369.0062 | Allowed |
| 4 | 459 | Incomplete Cleanup | 352.5395 | 352.5395 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 344.6941 | 344.6941 | Allowed-with-Review |
| 6 | 364 | Signal Handler Race Condition | 341.6030 | 341.6030 | Allowed |
| 7 | 787 | Out-of-bounds Write | 338.6970 | 338.6970 | Allowed |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 338.2164 | 338.2164 | Allowed |
| 9 | 122 | Heap-based Buffer Overflow | 338.0152 | 338.0152 | Allowed |
| 10 | 674 | Uncontrolled Recursion | 337.0859 | 337.0859 | Allowed-with-Review |
