# Vulnerability Information: CVE-2024-10899

## Vulnerability Description
The The WooCommerce Product Table Lite plugin for WordPress is vulnerable to arbitrary shortcode execution in all versions up to, and including, 3.8.6. This is due to the software **allowing users to execute an action that does not properly validate a value before running do_shortcode**. This makes it possible for unauthenticated attackers to execute arbitrary shortcodes. The same id parameter is vulnerable to Reflected **Cross-Site Scripting** as well.

### Vulnerability Description Key Phrases
- **rootcause:** **allowing users to execute an action that does not properly validate a value before running do_shortcode**
- **weakness:** **Cross-Site Scripting**
- **impact:** arbitrary shortcode execution
- **attacker:** unauthenticated attackers
- **product:** WooCommerce Product Table Lite plugin for WordPress
- **version:** all versions up to and including 3.8.6

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-10899:

**1. Verification of CVE Relevance:**

The provided content, especially from the Wordfence article, explicitly mentions CVE-2024-10899 and describes vulnerabilities in "WooCommerce Product Table Lite <= 3.8.6" that align with the CVE description (although the CVE description is a placeholder here). The Wordfence article details an Unauthenticated Arbitrary Shortcode Execution and a Reflected Cross-Site Scripting (XSS) vulnerability, which are further supported by the identified vulnerable code from trac.wordpress.org.

**2. Root Cause of Vulnerability:**

*   **Arbitrary Shortcode Execution:** The plugin allows the execution of WordPress shortcodes via user-supplied input in the `$_REQUEST['id']` parameter without proper sanitization or validation. The plugin directly passes this parameter to `do_shortcode()` on line 1778 in `main.php`
*   **Reflected XSS:** The plugin uses the `$_REQUEST['id']` parameter which is user-controlled directly in the `do_shortcode()` without sanitation, leading to a potential reflected XSS vulnerability.

**3. Weaknesses/Vulnerabilities Present:**

*   **Unauthenticated Arbitrary Shortcode Execution:**  The plugin fails to sanitize and validate the `id` parameter before passing it to the `do_shortcode()` function.
*   **Reflected Cross-Site Scripting (XSS):** The plugin echoes unsanitized user input from the `id` parameter, allowing the injection of arbitrary JavaScript into the page

**4. Impact of Exploitation:**

*   **Arbitrary Shortcode Execution:** Unauthenticated attackers can execute arbitrary shortcodes, potentially leading to various malicious actions including:
    *   Inserting malicious content into pages.
    *   Redirecting users to external malicious sites.
    *   Data exfiltration.
*   **Reflected XSS:**  Unauthenticated attackers can inject malicious JavaScript code to steal cookies or other sensitive information of logged-in users or perform other malicious actions.

**5. Attack Vectors:**

*   **HTTP GET Request**: Unauthenticated attackers can exploit the vulnerability by sending a crafted HTTP GET request containing a malicious shortcode in the `id` parameter.
*   **Direct use of the AJAX endpoints:** The vulnerable code is reachable through `wc_ajax_wcpt_ajax` (and `wp_ajax_wcpt_ajax`) allowing a direct route for exploitation.

**6. Required Attacker Capabilities/Position:**

*   **Unauthenticated Access:** The attacker does not need to have any valid credentials on the WordPress site, making it a highly severe security risk.
*   **Network Access:** The attacker only needs to be able to send HTTP requests to the vulnerable website.

**Additional Information from the Content (Beyond CVE description):**

*   The provided code diffs in the changeset ([3190789](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3190789%40wc-product-table-lite&new=3190789%40wc-product-table-lite&sfp_email=&sfph_mail=)) show how the vulnerability was fixed in version 3.8.7. The fix consists of:
    *   Explicitly casting the `$_REQUEST['id']` parameter to an integer and ensuring the resulting integer is used to retrieve data.
    *   Adding a regular expression sanitization for the shortcode attributes, using `preg_replace('/[^a-zA-Z0-9\s=\-\_"\']/', '', $sc_attrs);`

*   The code before the fix in `main.php` (from [3.8.6 source](https://plugins.trac.wordpress.org/browser/wc-product-table-lite/tags/3.8.6/main.php#L1778)) shows the direct and unsafe usage of `$_REQUEST['id']` in the `do_shortcode` function call
```php
echo do_shortcode('[product_table id="' . $_REQUEST['id'] . '" ' . $sc_attrs . ' ]');
```

*   The changelog in `readme.txt` indicates that version 3.8.7 includes a security vulnerability fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.615 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.570 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.564 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.561 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.541 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.536 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.532 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.525 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.533 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |

