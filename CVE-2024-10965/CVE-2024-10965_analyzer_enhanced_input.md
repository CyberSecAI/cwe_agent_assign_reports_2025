## Vulnerability Description
A vulnerability classified as problematic was found in emqx neuron up to 2.10.0. Affected by this vulnerability is an unknown functionality of the file /api/v2/schema of the component JSON File Handler. The manipulation leads to information disclosure. The attack can be launched remotely. The patch is named c9ce39747e0372aaa2157b2b56174914a12c06d8. It is recommended to apply a patch to fix this issue.

### Vulnerability Description Key Phrases
- **impact:** information disclosure
- **vector:** manipulation of unknown functionality
- **product:** emqx neuron
- **version:** up to 2.10.0
- **component:** /api/v2/schema of the JSON File Handler

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
- The vulnerability stems from the `/api/v2/schema` endpoint which allows reading arbitrary JSON files on the system by providing a `plugin_name` parameter. This is due to the lack of proper validation on the input, allowing an attacker to specify the path of the json file.

**Weaknesses/vulnerabilities present:**
- **Arbitrary JSON File Read:** The primary vulnerability is the ability to read any JSON file on the system by manipulating the `plugin_name` parameter. This is due to the lack of validation/sanitization of the user-provided `plugin_name`.
- **Insecure Input Handling:** The application fails to validate or sanitize user-supplied input, specifically the `plugin_name`, allowing path traversal or direct file access.

**Impact of exploitation:**
- **Information Disclosure:** Exploitation of this vulnerability can lead to the leakage of sensitive information stored in JSON files accessible to the system. This may include configuration files, credentials, or other confidential data.

**Attack vectors:**
- **HTTP Request:** The attack vector is an HTTP GET request to the `/api/v2/schema` endpoint.
- **`plugin_name` parameter:**  The `plugin_name` parameter in the GET request is used to specify the path to the JSON file to be read.

**Required attacker capabilities/position:**
- **Network Access:** The attacker needs network access to the system hosting the vulnerable application to send the malicious HTTP request.
- **Knowledge of the API Endpoint:** The attacker needs to know the `/api/v2/schema` endpoint.
- **Ability to craft HTTP request:** The attacker needs the ability to craft an HTTP GET request to the vulnerable endpoint and provide a manipulated  `plugin_name` parameter.

**Additional details:**
- The issue was reported as "Arbitrary JSON File Read #2281".
- The fix involves a check to verify if the plugin schema file exists before attempting to read it. This is done by the addition of a new request type (`NEU_REQ_CHECK_SCHEMA`) to check if a schema exists and a new response type (`NEU_RESP_CHECK_SCHEMA`). The fix is implemented in commit `c9ce397` and merged in pull request #2282.
- The fix prevents the direct use of the plugin name to compose the schema file path.
- Code changes were made in `normal_handle.c`, `normal_handle.h`, `rest.c`, `adapter.c`, `msg_internal.h`, `manager.c`, `plugin_manager.c`, `plugin_manager.h`, `msg.h` and `test_http_api.py`

This vulnerability provides more details than the official CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.169 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.144 |
| 3 | 334 | Small Space of Random Values | Base | Allowed | sparse | 0.138 |
| 4 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.136 |
| 5 | 341 | Predictable from Observable State | Base | Allowed | sparse | 0.132 |
| 6 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.131 |
| 7 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.130 |
| 8 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.128 |
| 9 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | dense | 0.576 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-334: Small Space of Random Values

CWE-125: Out-of-bounds Read

CWE-341: Predictable from Observable State

CWE-208: Observable Timing Discrepancy

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-1241: Use of Predictable Algorithm in Random Number Generator

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-73: External Control of File Name or Path