## Vulnerability Description
Vite a frontend build tooling framework for javascript. In affected versions the contents of arbitrary files can be returned to the browser. `@fs` denies access to files outside of Vite serving allow list. Adding `?import&raw` to the URL bypasses this limitation and returns the file content if it exists. This issue has been patched in versions 5.4.6, 5.3.6, 5.2.14, 4.5.5, and 3.2.11. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **impact:** arbitrary file disclosure
- **vector:** Adding ?import&raw to the URL
- **product:** Vite
- **version:** before 5.4.6, 5.3.6, 5.2.14, 4.5.5, and 3.2.11

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-45811:

**Root Cause of Vulnerability:**
The vulnerability arises from the improper handling of `?import&raw` queries within Vite's file serving mechanism. Specifically, the `@fs` path, intended to restrict access to files outside the allowed list, is bypassed when this query parameter is added to the URL.

**Weaknesses/Vulnerabilities Present:**
- **Bypass of Access Controls:** The primary weakness is the ability to bypass the intended restrictions of `server.fs.deny` by using the `?import&raw` query parameter.
- **Information Disclosure:** This bypass allows an attacker to retrieve the contents of arbitrary files on the server's filesystem.

**Impact of Exploitation:**
- **Confidentiality Breach:** The primary impact is the disclosure of sensitive information. Attackers can read the content of files outside the intended serving scope, which could include configuration files, source code, or other sensitive data.
- **Potential for Further Attacks:** Depending on the nature of the exposed data, this vulnerability could be a stepping stone for further attacks.

**Attack Vectors:**
- **Network-based:** The vulnerability is exploited through network requests, specifically HTTP GET requests to the vulnerable Vite development server.
- **URL Manipulation:** Attackers must append the `?import&raw` query string to a crafted URL that includes the `@fs` path.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker must be able to make network requests to the Vite development server.
- **Understanding of Vite's URL Structure:** The attacker needs knowledge of the `@fs` path and the usage of the `?import&raw` parameter.
- **User Interaction:** Although the CVSS score indicates user interaction is required, this is misleading, as the interaction refers to a victim *visiting* the malicious webpage, thus triggering the request.

**Additional Details:**
- The vulnerability is triggered when requesting a file outside the allowed serving list using the `@fs` prefix.
- The proof of concept demonstrates how to bypass the intended 403 Forbidden error using the `?import&raw` parameter.
- The vulnerability affects Vite versions ranging from 3.2.10 up to 5.4.5.
- The fix involves ensuring proper validation and access control when handling the `?import&raw` parameter.
- The vulnerability is classified as CWE-200 (Information Exposure) and CWE-284 (Improper Access Control).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.159 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.157 |
| 3 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.157 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.155 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.154 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.154 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.153 |
| 8 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.151 |
| 9 | 24 | Path Traversal: '../filedir' | Variant | Allowed | dense | 0.446 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-116: Improper Encoding or Escaping of Output

CWE-863: Incorrect Authorization

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-23: Relative Path Traversal

CWE-24: Path Traversal: '../filedir'

CWE-494: Download of Code Without Integrity Check