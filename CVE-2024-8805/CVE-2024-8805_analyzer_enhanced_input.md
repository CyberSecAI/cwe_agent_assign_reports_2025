# Vulnerability Description

    BlueZ HID over GATT Profile **Improper Access Control** Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of BlueZ. Authentication is not required to exploit this vulnerability. The specific flaw exists within the implementation of the HID over GATT Profile. The issue results from the **lack of authorization** prior to allowing access to functionality. An attacker can leverage this vulnerability to execute code in the context of the current user. Was ZDI-CAN-25177.

    # Keyphrase-Specific CWE Analysis
    This vulnerability contains multiple keyphrases that may map to different CWEs. 
    Please analyze each keyphrase separately and determine the most appropriate CWE(s) for each.

    ## ROOTCAUSE: 'lack of authorization'

Relevant CWEs for this ROOTCAUSE:

### 1. CWE-620: Unverified Password Change (Score: 542.88)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

### 2. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 505.89)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 3. CWE-697: Incorrect Comparison (Score: 503.83)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 4. CWE-20: Improper Input Validation (Score: 503.21)

The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly....

### 5. CWE-285: Improper Authorization (Score: 495.45)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

## IMPACT: 'Remote Code Execution'

Relevant CWEs for this IMPACT:

### 1. CWE-620: Unverified Password Change (Score: 542.88)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

### 2. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 505.89)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 3. CWE-20: Improper Input Validation (Score: 503.21)

The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly....

### 4. CWE-787: Out-of-bounds Write (Score: 489.71)

The product writes data past the end, or before the beginning, of the intended buffer....

### 5. CWE-306: Missing Authentication for Critical Function (Score: 158.15)

The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....

## IMPACT: 'execute arbitrary code'

Relevant CWEs for this IMPACT:

### 1. CWE-620: Unverified Password Change (Score: 542.88)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

### 2. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 505.89)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 3. CWE-20: Improper Input Validation (Score: 503.21)

The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly....

### 4. CWE-787: Out-of-bounds Write (Score: 489.71)

The product writes data past the end, or before the beginning, of the intended buffer....

### 5. CWE-732: Incorrect Permission Assignment for Critical Resource (Score: 160.68)

The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors....

## ATTACKER: 'network-adjacent attackers'

Relevant CWEs for this ATTACKER:

### 1. CWE-620: Unverified Password Change (Score: 542.88)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

### 2. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 505.89)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 3. CWE-697: Incorrect Comparison (Score: 503.83)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 4. CWE-20: Improper Input Validation (Score: 503.21)

The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly....

### 5. CWE-321: Use of Hard-coded Cryptographic Key (Score: 161.83)

The use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered....

## PRODUCT: 'BlueZ'

Relevant CWEs for this PRODUCT:

### 1. CWE-620: Unverified Password Change (Score: 542.88)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

### 2. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 505.89)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 3. CWE-697: Incorrect Comparison (Score: 503.83)

The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses....

### 4. CWE-20: Improper Input Validation (Score: 503.21)

The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly....

### 5. CWE-787: Out-of-bounds Write (Score: 489.71)

The product writes data past the end, or before the beginning, of the intended buffer....

## COMPONENT: 'HID over GATT Profile'

Relevant CWEs for this COMPONENT:

### 1. CWE-620: Unverified Password Change (Score: 542.88)

When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....

### 2. CWE-1284: Improper Validation of Specified Quantity in Input (Score: 505.89)

The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....

### 3. CWE-20: Improper Input Validation (Score: 503.21)

The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly....

### 4. CWE-287: Improper Authentication (Score: 490.50)

When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....

### 5. CWE-306: Missing Authentication for Critical Function (Score: 158.15)

The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....

## ROOTCAUSE: 'Improper Access Control'

Relevant CWEs for this ROOTCAUSE:

### 1. CWE-20: Improper Input Validation (Score: 503.21)

The product receives input or data, but it does
        not validate or incorrectly validates that the input has the
        properties that are required to process the data safely and
        correctly....

### 2. CWE-285: Improper Authorization (Score: 495.45)

The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....

### 3. CWE-284: Improper Access Control (Score: 492.97)

The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor....

### 4. CWE-287: Improper Authentication (Score: 490.50)

When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....

### 5. CWE-787: Out-of-bounds Write (Score: 489.71)

The product writes data past the end, or before the beginning, of the intended buffer....


    # Analysis Instructions
    1. For each keyphrase, identify the most appropriate CWE(s) that represent the weakness.
    2. Consider how the different keyphrases might relate to each other in the vulnerability chain.
    3. Provide a final determination of primary CWE(s) and any secondary CWEs.
    4. Format your response using the standard analysis template.

    Please analyze how these different weaknesses interact and provide a comprehensive CWE classification.
    

# Complete CWE Specifications

CWE-620: Unverified Password Change

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-697: Incorrect Comparison

CWE-20: Improper Input Validation

CWE-285: Improper Authorization

CWE-284: Improper Access Control

CWE-287: Improper Authentication

CWE-787: Out-of-bounds Write

CWE-321: Use of Hard-coded Cryptographic Key

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-306: Missing Authentication for Critical Function