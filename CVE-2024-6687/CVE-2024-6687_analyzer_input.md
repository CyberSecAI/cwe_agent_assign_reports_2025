# Vulnerability Information: CVE-2024-6687

## Vulnerability Description
The CTT Expresso para WooCommerce plugin for WordPress is vulnerable to **sensitive information exposure** in all versions up to and including 3.2.12 via the /wp-content/uploads/cepw directory. The generated .pdf and log files are publicly accessible and contain sensitive information such as sender and receiver names, phone numbers, physical addresses, and email addresses

### Vulnerability Description Key Phrases
- **weakness:** **sensitive information exposure**
- **product:** CTT Expresso para WooCommerce plugin
- **version:** up to and including 3.2.12
- **component:** /wp-content/uploads/cepw directory

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The CTT Expresso para WooCommerce plugin creates a directory `/wp-content/uploads/cepw` to store generated PDF and log files. This directory was not protected from public access, leading to information exposure.

**Weaknesses/Vulnerabilities:**

- **Information Exposure:** The primary vulnerability is the exposure of sensitive information due to the lack of access control on the `/wp-content/uploads/cepw` directory.
- **Unprotected Directory:** The plugin fails to implement proper measures (like an index.php file or .htaccess file) to prevent direct listing or access to files within the uploads/cepw directory.

**Impact of Exploitation:**

- **Exposure of PII:** Attackers could access and view sensitive information contained in the PDF and log files, including:
    - Sender and receiver names
    - Phone numbers
    - Physical addresses
    - Email addresses

**Attack Vectors:**

- **Direct Access:** Attackers can directly access the vulnerable directory `/wp-content/uploads/cepw` via the web.

**Required Attacker Capabilities/Position:**

- **No special access required:** The attacker needs no authentication or special privileges and can access the directory from anywhere on the internet.

**Additional details from the provided content:**
- The vulnerability affects all versions of the plugin up to and including 3.2.12.
- The fix implemented in version 3.2.13 includes adding an `index.php` file to prevent directory listing and a `.htaccess` file with `Options -Indexes` to prevent file access.
- The `ctt-expresso-para-woocommerce.php` was modified to create an index.php and .htaccess file in the uploads directory.
- The changes also included sanitization of various user inputs.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.302 |
| 2 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.298 |
| 3 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.287 |
| 4 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.279 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.278 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.278 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.278 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.278 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.578 |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | Allowed | graph | 0.002 |

