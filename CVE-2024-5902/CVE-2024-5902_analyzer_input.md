# Vulnerability Information: CVE-2024-5902

## Vulnerability Description
The User Feedback - Create Interactive Feedback Form, User Surveys, and Polls in Seconds plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the name parameter in all versions up to, and including, 1.0.15 due to **insufficient input sanitization and output escaping**. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in feedback form responses that will execute whenever a high-privileged user tries to view them.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping**
- **weakness:** **cross-site scripting**
- **impact:** inject arbitrary web scripts
- **attacker:** unauthenticated attackers
- **product:** User Feedback - Create Interactive Feedback Form WordPress plugin
- **version:** up to and including 1.0.15
- **component:** name parameter

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-5902

**Root Cause of Vulnerability:**
- Insufficient input sanitization and output escaping of the `name` parameter in feedback form responses. This allows an attacker to inject malicious scripts.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize user-provided input, specifically the `name` parameter within feedback responses, before storing it in the database. Subsequently, when an administrator views the feedback, the unsanitized data is rendered, allowing malicious JavaScript code to execute within their browser.

**Impact of Exploitation:**
- **Arbitrary Script Execution:** Successful exploitation allows an attacker to inject and execute arbitrary JavaScript code within the browser of a high-privileged user (like an administrator) when they view feedback responses.
- **Account Compromise:** This can potentially lead to account compromise. Attackers can use the injected scripts to perform actions on behalf of the admin, like creating new admin accounts or injecting malicious code into the website, further compromising the website and its users.
- **Data Theft:** Malicious scripts can be used to steal sensitive data from the user viewing the feedback.
- **Website Defacement:** Attackers could modify the content of the WordPress admin panel.

**Attack Vectors:**
- **Unauthenticated HTTP POST Request:** An unauthenticated attacker can submit a crafted HTTP POST request to the plugin's REST API endpoint that handles feedback submission. The crafted request includes malicious JavaScript code within the 'name' parameter of the page_submitted object. The vulnerability is located in the /includes/frontend/class-userfeedback-frontend.php file, specifically in the `save_survey_response` function.
- **Vulnerable Parameter:** The specific parameter targeted for this attack is the "name" parameter within the "page_submitted" array. This parameter is not properly sanitized before being stored, leading to the XSS vulnerability.

**Required Attacker Capabilities/Position:**
- **No Authentication Required:** The attacker does not need to be logged in or have any special privileges on the WordPress site.
- **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable WordPress site.
- **Basic knowledge of web attacks:** Attacker needs to be able to craft an HTTP POST request with the malicious payload

**Additional Details:**
- The vulnerability exists in the User Feedback Lite plugin for WordPress, specifically in versions up to and including 1.0.15.
- The vulnerability was discovered by researcher zer0gh0st.
- The vulnerable code is located within the `save_survey_response` function in the `class-userfeedback-frontend.php` file.
- The plugin has been patched in version 1.0.16 and above by sanitizing the `name` parameter before storing it.
- The vulnerable code is found in the function responsible for handling survey submissions, indicating a flaw in the processing of user-supplied data.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.505 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.501 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.486 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.447 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.401 |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.383 |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.383 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.381 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.500 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

