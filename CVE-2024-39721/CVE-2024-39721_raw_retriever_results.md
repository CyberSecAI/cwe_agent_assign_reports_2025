# Raw Retriever Results for CVE-2024-39721

# Raw Retriever Results for CVE-2024-39721
## Query
An issue was discovered in Ollama before 0.1.34. The CreateModelHandler function uses os.Open to read a file until completion. The req.Path parameter is user-controlled and can be set to /dev/random, which is blocking, causing the goroutine to run infinitely (even after the HTTP request is aborted by the client).

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3148 | 0.3518 | 0.3297 | 0.3254 | 20 |
| Sparse | 92.3533 | 95.2410 | 93.6660 | 93.1343 | 10 |
| Graph | 1.3676 | 2.4700 | 1.8198 | 1.7264 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | base | 2.4700 | Allowed |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | base | 2.4700 | Allowed |
| 3 | 430 | Deployment of Wrong Handler | Base | 2.4515 | Allowed |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 2.3296 | Allowed |
| 5 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 6 | 433 | Unparsed Raw Web Content Delivery | variant | 2.0400 | Allowed |
| 7 | 431 | Missing Handler | Base | 1.8925 | Allowed |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 9 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 11 | 178 | Improper Handling of Case Sensitivity | base | 1.6848 | Allowed |
| 12 | 770 | Allocation of Resources Without Limits or Throttling | Base | 1.6438 | Allowed |
| 13 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 14 | 939 | Improper Authorization in Handler for Custom URL Scheme | Base | 1.5724 | Allowed |
| 15 | 1050 | Excessive Platform Resource Consumption within a Loop | Base | 1.5639 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 774 | Allocation of File Descriptors or Handles Without Limits or Throttling | Variant | 0.3518 | 0.3518 | Allowed |
| 2 | 939 | Improper Authorization in Handler for Custom URL Scheme | Base | 0.3494 | 0.3494 | Allowed |
| 3 | 430 | Deployment of Wrong Handler | Base | 0.3491 | 0.3491 | Allowed |
| 4 | 431 | Missing Handler | Base | 0.3452 | 0.3452 | Allowed |
| 5 | 1050 | Excessive Platform Resource Consumption within a Loop | Base | 0.3405 | 0.3405 | Allowed |
| 6 | 36 | Absolute Path Traversal | Base | 0.3372 | 0.3372 | Allowed |
| 7 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.3333 | 0.3333 | Allowed |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.3314 | 0.3314 | Allowed |
| 9 | 641 | Improper Restriction of Names for Files and Other Resources | Base | 0.3276 | 0.3276 | Allowed |
| 10 | 377 | Insecure Temporary File | Class | 0.3260 | 0.3260 | Allowed-with-Review |
| 11 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | 0.3248 | 0.3248 | Allowed |
| 12 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.3242 | 0.3242 | Allowed |
| 13 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.3238 | 0.3238 | Allowed |
| 14 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.3216 | 0.3216 | Allowed |
| 15 | 1088 | Synchronous Access of Remote Resource without Timeout | Base | 0.3215 | 0.3215 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 138 | Improper Neutralization of Special Elements | 95.2410 | 95.2410 | Discouraged |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 95.1264 | 95.1264 | Allowed |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | 94.7512 | 94.7512 | Allowed |
| 4 | 863 | Incorrect Authorization | 94.3686 | 94.3686 | Allowed-with-Review |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | 93.1587 | 93.1587 | Allowed |
| 6 | 319 | Cleartext Transmission of Sensitive Information | 93.1099 | 93.1099 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | 92.9491 | 92.9491 | Allowed |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 92.8976 | 92.8976 | Allowed |
| 9 | 789 | Memory Allocation with Excessive Size Value | 92.7038 | 92.7038 | Allowed |
| 10 | 24 | Path Traversal: '../filedir' | 92.3533 | 92.3533 | Allowed |
