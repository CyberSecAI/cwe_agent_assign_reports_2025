# Raw Retriever Results for CVE-2024-50001

# Raw Retriever Results for CVE-2024-50001
## Query
In the Linux kernel, the following vulnerability has been resolved net/mlx5 Fix error path in multi-packet WQE transmit Remove the erroneous unmap in case no DMA mapping was established The multi-packet WQE transmit code attempts to obtain a DMA mapping for the skb. This could fail, e.g. under memory pressure, when the IOMMU driver just cant allocate more memory for page tables. While the code tries to handle this in the path below the err_unmap label it erroneously unmaps one entry from the sqs FIFO list of active mappings. Since the current map attempt failed this unmap is removing some random DMA mapping that might still be required. If the PCI function now presents that IOVA, the IOMMU may assumes a rogue DMA access and e.g. on s390 puts the PCI function in error state. The erroneous behavior was seen in a stress-test environment that created memory pressure.

## Keyphrases
- **rootcause**: 'erroneous unmap in case no DMA mapping was established'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4704 | 0.5178 | 0.4883 | 0.4813 | 20 |
| Sparse | 211.0312 | 785.1487 | 658.5680 | 682.1536 | 11 |
| Graph | 1.6848 | 2.9952 | 2.0055 | 1.8425 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.9952 | Allowed |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.4700 | Allowed |
| 3 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 4 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 5 | 619 | Dangling Database Cursor ('Cursor Injection') | base | 2.2100 | Allowed |
| 6 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 7 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 8 | 129 | Improper Validation of Array Index | variant | 2.1936 | Allowed |
| 9 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 10 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 1.9169 | Allowed |
| 11 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 12 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 13 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 14 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 15 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5178 | 0.5178 | Allowed |
| 2 | 1190 | DMA Device Enabled Too Early in Boot Phase | Base | 0.5122 | 0.5122 | Allowed |
| 3 | 909 | Missing Initialization of Resource | Class | 0.5122 | 0.5122 | Allowed-with-Review |
| 4 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.5112 | 0.5112 | Allowed |
| 5 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.5090 | 0.5090 | Allowed |
| 6 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5061 | 0.5061 | Allowed |
| 7 | 1262 | Improper Access Control for Register Interface | Base | 0.4887 | 0.4887 | Allowed |
| 8 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4860 | 0.4860 | Allowed |
| 9 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4833 | 0.4833 | Allowed |
| 10 | 822 | Untrusted Pointer Dereference | Base | 0.4828 | 0.4828 | Allowed |
| 11 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.4798 | 0.4798 | Allowed |
| 12 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4798 | 0.4798 | Allowed |
| 13 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 0.4790 | 0.4790 | Allowed |
| 14 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4777 | 0.4777 | Allowed |
| 15 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4773 | 0.4773 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | 785.1487 | 785.1487 | Allowed |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 775.8430 | 775.8430 | Allowed |
| 3 | 404 | Improper Resource Shutdown or Release | 735.5864 | 735.5864 | Allowed-with-Review |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 695.7035 | 695.7035 | Allowed-with-Review |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | 688.9043 | 688.9043 | Allowed |
| 6 | 1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | 682.1536 | 682.1536 | Allowed |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | 673.8635 | 673.8635 | Allowed |
| 8 | 909 | Missing Initialization of Resource | 673.7705 | 673.7705 | Allowed-with-Review |
| 9 | 833 | Deadlock | 664.5078 | 664.5078 | Allowed |
| 10 | 125 | Out-of-bounds Read | 657.7360 | 657.7360 | Allowed |
| 11 | 667 | Improper Locking | 211.0312 | 211.0312 | Allowed-with-Review |
