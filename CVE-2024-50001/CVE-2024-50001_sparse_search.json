{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved net/mlx5 Fix error path in multi-packet WQE transmit Remove the erroneous unmap in case no DMA mapping was established The multi-packet WQE transmit code attempts to obtain a DMA mapping for the skb. This could fail, e.g. under memory pressure, when the IOMMU driver just cant allocate more memory for page tables. While the code tries to handle this in the path below the err_unmap label it erroneously unmaps one entry from the sqs FIFO list of active mappings. Since the current map attempt failed this unmap is removing some random DMA mapping that might still be required. If the PCI function now presents that IOVA, the IOMMU may assumes a rogue DMA access and e.g. on s390 puts the PCI function in error state. The erroneous behavior was seen in a stress-test environment that created memory pressure.",
  "keyphrases": {
    "rootcause": [
      "erroneous unmap in case no DMA mapping was established"
    ]
  },
  "timestamp": "2025-07-13 19:44:31",
  "cve_id": "CVE-2024-50001",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 785.1487015647956,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 775.8430242761553,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "404",
      "name": "Improper Resource Shutdown or Release",
      "score": 735.5863909635368,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 695.703548160631,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "score": 688.9042519990941,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "1250",
      "name": "Improper Preservation of Consistency Between Independent Representations of Shared State",
      "score": 682.1535623615874,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "score": 673.8634929249856,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "score": 673.7704532366662,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 664.5077546627792,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "score": 657.7360137551733,
      "search_source": "rootcause:erroneous unmap in case no DMA mapping was established"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 211.03118108324693,
      "search_source": "base_query"
    }
  ]
}