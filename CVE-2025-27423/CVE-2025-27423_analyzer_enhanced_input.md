## Vulnerability Description
Vim is an open source, command line text editor. Vim is distributed with the tar.vim plugin, that allows easy editing and viewing of (compressed or uncompressed) tar files. Starting with 9.1.0858, the tar.vim plugin uses the read ex command line to append below the cursor position, however the **is not sanitized and is taken literally from the tar archive**. This allows to execute shell commands via special crafted tar archives. Whether this really happens, depends on the shell being used (shell option, which is set using $SHELL). The issue has been fixed as of Vim patch v9.1.1164

### Vulnerability Description Key Phrases
- **rootcause:** **is not sanitized and is taken literally from the tar archive**
- **weakness:** **command injection**
- **impact:** execute shell commands
- **vector:** special crafted tar archives
- **product:** Vim
- **version:** 9.1.0858
- **component:** tar.vim plugin

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
The tar.vim plugin uses the ":read " ex command line to append content from tar archives without sanitization, allowing execution of shell commands via specially crafted tar files. This was introduced in commit 129a844 (Nov 11, 2024).

Weaknesses/vulnerabilities present:
Improper Input Validation (CWE-20).

Impact of exploitation:
High impact, potential for code execution.  A user must be convinced to edit a malicious file with Vim.

Attack vectors:
Local. Requires a user to open a specially crafted tar file with Vim. User interaction is required.

Required attacker capabilities/position:
The attacker needs to create a malicious tar file and convince a user to open it with Vim.

Mitigation or fix:
Update to Vim version 9.1.1164 or later. The issue was fixed in commit 334a13bff78aa0ad206bc436885f63e3a0bab399.

CVSS score: 7.1 (High)
CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.655 |
| 4 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.599 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.582 |
| 6 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.535 |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.534 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.529 |
| 9 | 29 | Path Traversal: '\..\filename' | Variant | Allowed | dense | 0.371 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-23: Relative Path Traversal

CWE-126: Buffer Over-read

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-29: Path Traversal: '\..\filename'

CWE-184: Incomplete List of Disallowed Inputs