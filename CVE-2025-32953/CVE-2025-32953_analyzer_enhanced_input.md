## Vulnerability Description
z80pack is a mature emulator of multiple platforms with 8080 and Z80 CPU. In version 1.38 and prior, the `makefile-ubuntu.yml` workflow file uses `actions/upload-artifact@v4` to upload the `z80pack-ubuntu` artifact. This artifact is a zip of the current directory, which includes the automatically generated `.git/config` file containing the runs GITHUB_TOKEN. Seeing as the artifact can be downloaded prior to the end of the workflow, there is a few seconds where an attacker can extract the token from the artifact and use it with the Github API to push malicious code or rewrite release commits in your repository. This issue has been fixed in commit bd95916.

### Vulnerability Description Key Phrases
- **component:** makefile-ubuntu.yml workflow file
- **product:** z80pack
- **impact:** push malicious code, rewrite release commits
- **attacker:** attacker
- **version:** 1.38 and prior

## CVE Reference Links Content Summary
```
- Root cause of vulnerability:
The `makefile-ubuntu.yml` workflow file uses `actions/upload-artifact@v4` to upload the `z80pack-ubuntu` artifact. This artifact is a zip of the current directory, which includes the automatically generated `.git/config` file containing the run's GITHUB_TOKEN.

- Weaknesses/vulnerabilities present:
Exposure of the GITHUB_TOKEN in workflow run artifact.

- Impact of exploitation:
An attacker can extract the token from the artifact and use it with the Github API to push malicious code or rewrite release commits in the repository.

- Attack vectors:
* Monitor for runs of the `makefile-ubuntu.yml` workflow.
* Once a run is found, wait for the artifact to be made available.
* Download and extract the GITHUB_TOKEN from it.
* Use the token with the Github API to push a new commit or update release tags.

- Required attacker capabilities/position:
An attacker needs to be able to access the uploaded artifact, which contains the GITHUB_TOKEN.

- Mitigation or fix:
Only add the files required to the artifact, instead of specifying the current directory. Make sure the artifact doesn't contain environment variables or the `.git/config` file.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.210 |
| 2 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.200 |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.200 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.199 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.197 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.196 |
| 7 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.195 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.191 |
| 9 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | dense | 0.361 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-59: Improper Link Resolution Before File Access ('Link Following')

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-23: Relative Path Traversal

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-427: Uncontrolled Search Path Element

CWE-306: Missing Authentication for Critical Function

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-494: Download of Code Without Integrity Check