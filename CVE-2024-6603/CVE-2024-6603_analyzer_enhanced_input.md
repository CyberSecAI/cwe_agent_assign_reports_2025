## Vulnerability Description
In an out-of-memory scenario an allocation could fail but free would have been called on the pointer afterwards leading to **memory corruption**. This vulnerability affects Firefox < 128, Firefox ESR < 115.13, Thunderbird < 115.13, and Thunderbird < 128.

### Vulnerability Description Key Phrases
- **weakness:** **memory corruption**
- **product:** Firefox and Firefox ESR and Thunderbird and Thunderbird
- **version:** < 128, < 115.13, < 115.13, < 128

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-6603:

**CVE-2024-6603: Memory corruption in thread creation**

*   **Root cause of vulnerability:** The vulnerability occurs in an out-of-memory (OOM) scenario during thread creation. An allocation may fail, but a subsequent `free` operation is still called on the pointer, leading to memory corruption.

*   **Weaknesses/vulnerabilities present:**  The core issue is a use-after-free condition. When memory allocation fails, the code doesn't properly handle the failure, and attempts to deallocate memory that was never successfully allocated. This causes memory corruption.

*   **Impact of exploitation:** Memory corruption can lead to various consequences, including program crashes, unexpected behavior, and potential security vulnerabilities like arbitrary code execution if the corrupted memory is manipulated by an attacker.

*   **Attack vectors:** The attack vector involves triggering an out-of-memory condition during thread creation within the application. This could be achieved by creating many threads or by otherwise exhausting system memory resources.

*   **Required attacker capabilities/position:** An attacker needs to be able to cause an out-of-memory condition while the vulnerable software is trying to create a new thread.  This could be from within the application itself, or by influencing system-level memory limits.

**Additional Notes:**

*   The provided content does not contain any information about specific exploitation techniques.
*   The impact of exploitation is rated as "moderate" in the advisory.
*   The vulnerability is resolved in Thunderbird 115.13 and Firefox 128, Firefox ESR 115.13, Thunderbird 128.
*   The bug report ([Bug 1895081](https://bugzilla.mozilla.org/show_bug.cgi?id=1895081)) is not publicly accessible, however, the advisory information still provides sufficient details for analysis.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 787 | Out-of-bounds Write | Base | Allowed | alternate_terms | 1.000 |
| 2 | 416 | Use After Free | Variant | Allowed | sparse | 0.250 |
| 3 | 908 | Use of Uninitialized Resource | Base | Allowed | sparse | 0.247 |
| 4 | 415 | Double Free | Variant | Allowed | sparse | 0.237 |
| 5 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.236 |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.230 |
| 7 | 457 | Use of Uninitialized Variable | Variant | Allowed | sparse | 0.219 |
| 8 | 704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | sparse | 0.218 |
| 9 | 590 | Free of Memory not on the Heap | Variant | Allowed | dense | 0.555 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.004 |



# Complete CWE Specifications

CWE-787: Out-of-bounds Write

CWE-416: Use After Free

CWE-908: Use of Uninitialized Resource

CWE-415: Double Free

CWE-909: Missing Initialization of Resource

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-457: Use of Uninitialized Variable

CWE-704: Incorrect Type Conversion or Cast

CWE-590: Free of Memory not on the Heap

CWE-123: Write-what-where Condition