{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved RDMA/mlx5 Fix mlx5_poll_one() cur_qp update flow When cur_qp isnt NULL, in order to avoid fetching the QP from the radix tree again we check if the next cqe QP is identical to the one we already have. The bug however is that we are checking if the QP is identical by checking the QP number inside the CQE against the QP number inside the mlx5_ib_qp, but thats wrong since the QP number from the CQE is from FW so it should be matched against mlx5_core_qp which is our FW QP number. Otherwise we could use the wrong QP when handling a CQE which could cause the kernel trace below. This issue is mainly noticeable over QPs 0 & 1, since for now they are the only QPs in our driver whereas the QP number inside mlx5_ib_qp doesnt match the QP number inside mlx5_core_qp.",
  "keyphrases": {
    "weakness": [
      "QP number mismatch"
    ]
  },
  "timestamp": "2025-07-14 10:11:30",
  "cve_id": "CVE-2025-22086",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "335",
      "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
      "score": 703.9620953991234,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 648.92163463046,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "476",
      "name": "NULL Pointer Dereference",
      "score": 615.9973312956323,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "score": 610.0121580632483,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "130",
      "name": "Improper Handling of Length Parameter Inconsistency",
      "score": 600.8312535764705,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 599.3261299150097,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 599.0711968244154,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "824",
      "name": "Access of Uninitialized Pointer",
      "score": 592.8890651072803,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 588.3919044421807,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "score": 586.6596933549527,
      "search_source": "weakness:QP number mismatch"
    },
    {
      "cwe_id": "1333",
      "name": "Inefficient Regular Expression Complexity",
      "score": 209.06955555332232,
      "search_source": "base_query"
    }
  ]
}