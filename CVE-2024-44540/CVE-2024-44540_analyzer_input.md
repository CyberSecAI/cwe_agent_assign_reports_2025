# Vulnerability Information: CVE-2024-44540

## Vulnerability Description
Ubiquiti AirMax firmware version firmware version 8 allows attackers with physical access to gain a privileged command shell via the UART Debugging Port.

### Vulnerability Description Key Phrases
- **impact:** gain a privileged command shell
- **attacker:** attackers with physical access
- **product:** Ubiquiti AirMax firmware
- **version:** 8
- **component:** UART Debugging Port

## CVE Reference Links Content Summary
The provided content is related to CVE-2024-44540.

**Root cause of vulnerability:**

The vulnerability stems from the ability to interrupt the normal boot process of Ubiquiti Airmax devices via the UART interface and gain access to the U-Boot bootloader. By modifying the `bootargs` variable in U-Boot, the system can be forced to execute `/bin/sh` instead of the regular `/init` process, resulting in a root shell without requiring authentication.

**Weaknesses/vulnerabilities present:**

- Unprotected access to the bootloader via the UART interface.
- Ability to modify boot parameters via the bootloader.
- Insecure boot process that allows for arbitrary command execution.

**Impact of exploitation:**

- Complete bypass of the login mechanism, granting root shell access.
- Ability to read and modify the device's configuration, including the user password hash.
- Ability to perform a factory reset or change the admin password.
- Potential to upload a modified firmware.
- Complete control over the vulnerable device.

**Attack vectors:**

- Physical access to the device to connect to the UART interface.

**Required attacker capabilities/position:**

- Physical access to the Ubiquiti Airmax device.
- Basic knowledge of electronics, serial communication, and U-Boot.
- Ability to identify UART pins (VCC, GND, TX, RX) on the deviceâ€™s PCB.
- Serial to USB adapter and a computer with a serial terminal program.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | Allowed | sparse | 0.050 |
| 2 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.047 |
| 3 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.044 |
| 4 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.042 |
| 5 | 912 | Hidden Functionality | Class | Allowed-with-Review | sparse | 0.042 |
| 6 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.042 |
| 7 | 489 | Active Debug Code | Base | Allowed | sparse | 0.041 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.041 |
| 9 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | dense | 0.529 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

