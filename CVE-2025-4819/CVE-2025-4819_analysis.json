{
  "cve_id": "CVE-2025-4819",
  "description": "A vulnerability classified as problematic has been found in y_project RuoYi 4.8.0. Affected is an unknown function of the file /monitor/online/batchForceLogout of the component Offline Logout. The manipulation of the argument ids leads to **improper authorization**. It is possible to launch the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. The exploit has been disclosed to the public and may be used.",
  "key_phrases": {
    "rootcause": "improper authorization",
    "weakness": "",
    "impact": "Offline Logout",
    "vector": "manipulation of argument ids",
    "attacker": "",
    "product": "y_project RuoYi",
    "version": "4.8.0",
    "component": "/monitor/online/batchForceLogout"
  },
  "reference_content": "## Analysis of CVE-2025-4819 Content\n\nBased on the provided content, this relates to a vulnerability in Ruoyi-v4.8.0.\n\n**Root cause of vulnerability:**\n\nThe vulnerability stems from a lack of proper permission verification when handling offline functionality. The code allows users to log off other users, including administrators, by manipulating session IDs.\n\n**Weaknesses/vulnerabilities present:**\n\n*   **Missing Authorization:** The application does not adequately verify if a user has the authority to log off another user.\n*   **Insecure Session Management:** The ability to log off other users by manipulating session IDs indicates a potential weakness in session management.\n*   **Design Flaw:** The design allows logging in as another user, which is inherently risky and contributes to the vulnerability.\n\n**Impact of exploitation:**\n\nSuccessful exploitation allows a regular user to force an administrator to log off, leading to unauthorized access and potential compromise of the system.\n\n**Attack vectors:**\n\n*   An attacker can capture a valid session ID of an administrator.\n*   The attacker can then use this session ID to trigger the offline function, effectively logging the administrator out.\n\n**Required attacker capabilities/position:**\n\n*   The attacker needs to be a regular user of the Ruoyi-v4.8.0 application.\n*   The attacker needs to be able to intercept or obtain a valid session ID of an administrator.\n\n**Mitigation or fix:**\n\n*   Implement proper authorization checks to ensure that only authorized users (e.g., administrators) can log off other users.\n*   Restrict the ability to log off users based on privilege level (e.g., allow administrators to log off lower-privileged users, but not vice versa).\n*   Review and strengthen session management practices to prevent session ID manipulation.\n*   Redesign the login/session handling to prevent logging in *as* another user.\n\n**More detail than official CVE description:**\n\nYes, the content provides significantly more detail than a typical CVE description. It includes a detailed explanation of the vulnerability, steps to reproduce it, and a proposed solution. It also includes screenshots illustrating the attack process.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name                                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :------------------------------------------------------------------------------ | :---------- | :---------------------- | :------------------------------ | :------------------------------ |\n| CWE-285   | Improper Authorization                                                        | 0.95        | Class                   | Primary                         | Discouraged                    |\n| CWE-863   | Incorrect Authorization                                                       | 0.75        | Class                   | Secondary                       | Allowed-with-Review            |\n| CWE-862   | Missing Authorization                                                       | 0.65        | Base                   | Secondary                       | Allowed                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE identified is CWE-285 Improper Authorization. This is a class-level CWE, and both CWE-863 Incorrect Authorization and CWE-862 Missing Authorization are children of CWE-285, offering more specific classifications. CWE-863 indicates an authorization check is present but flawed, while CWE-862 indicates a complete absence of authorization. These relationships helped refine the selection to address the **improper authorization** issue highlighted in the vulnerability description.\n\n```mermaid\ngraph TD\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n\n    cwe862 -->|CHILDOF| cwe285\n    cwe863 -->|CHILDOF| cwe285\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe285 primary\n    class cwe862,cwe863 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with **improper authorization** (CWE-285). An attacker can manipulate the 'ids' argument, leading to unauthorized offline logout. The **missing** or **incorrect** authorization check (CWE-862 or CWE-863) allows this manipulation, ultimately resulting in a regular user being able to force an administrator to log off, leading to unauthorized access and potential compromise of the system.\n\n## Summary of Analysis\nThe initial assessment identified **improper authorization** as the primary weakness. The retriever results and relationship analysis refined the selection, particularly the child relationships of CWE-285 (Improper Authorization). The vulnerability description and CVE content summary both point to an authorization issue, supporting the selection of CWE-285 as the primary CWE. Given the evidence, the final decision focuses on CWE-285, with consideration of CWE-863 and CWE-862 to represent the nuance of whether authorization was completely missing or implemented incorrectly.\n\nRelevant CWE Information:\n\n*   The vulnerability description states \"**improper authorization**\".\n*   The CVE Reference Links Content Summary states \"**Missing Authorization:** The application does not adequately verify if a user has the authority to log off another user.\"\n*   The CVE Reference Links Content Summary states \"The code allows users to log off other users, including administrators, by manipulating session IDs.\"\n\nBased on this evidence, CWE-285 is the most appropriate primary CWE because the root cause is **improper authorization**.\n\nCWE-863 (Incorrect Authorization) was considered as a more specific child of CWE-285. The evidence suggests that authorization checks might be present but flawed. Thus, it has been added as a secondary CWE.\n\nCWE-862 (Missing Authorization) was considered as a more specific child of CWE-285. The evidence suggests the application does not adequately verify if a user has the authority to log off another user. Thus, it has been added as a secondary CWE.\n\nCWE-306 (Missing Authentication for Critical Function) was considered but deemed less relevant, as the issue appears to be related to authorization (i.e., what an authenticated user can do) rather than authentication (i.e., verifying the user's identity). The documentation states that \"the application does not adequately verify if a user has the authority to log off another user\" which indicates that the user has already been authenticated, so it's not an authentication issue.\n\nCWE-79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')) was considered but deemed less relevant, as the issue is related to **improper authorization** rather than improper neutralization of input.\n\nCWE-89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) was considered but deemed less relevant, as the issue is related to **improper authorization** rather than SQL injection.\n\nCWE-78 (Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')) was considered but deemed less relevant, as the issue is related to **improper authorization** rather than OS command injection.\n\nCWE-284 (Improper Access Control) was considered, but as the guidance suggests, it should be avoided if a more specific child CWE like 285, 862, or 863 is appropriate. Since authorization issues are the core of the vulnerability, CWE-285, CWE-862 and CWE-863 are preferred.",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name                                                                        | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :------------------------------------------------------------------------------ | :---------- | :---------------------- | :------------------------------ | :------------------------------ |\n| CWE-285   | Improper Authorization                                                        | 0.95        | Class                   | Primary                         | Discouraged                    |\n| CWE-863   | Incorrect Authorization                                                       | 0.75        | Class                   | Secondary                       | Allowed-with-Review            |\n| CWE-862   | Missing Authorization                                                       | 0.65        | Base                   | Secondary                       | Allowed                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE identified is CWE-285 Improper Authorization. This is a class-level CWE, and both CWE-863 Incorrect Authorization and CWE-862 Missing Authorization are children of CWE-285, offering more specific classifications. CWE-863 indicates an authorization check is present but flawed, while CWE-862 indicates a complete absence of authorization. These relationships helped refine the selection to address the **improper authorization** issue highlighted in the vulnerability description.\n\n```mermaid\ngraph TD\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n\n    cwe862 -->|CHILDOF| cwe285\n    cwe863 -->|CHILDOF| cwe285\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe285 primary\n    class cwe862,cwe863 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain begins with **improper authorization** (CWE-285). An attacker can manipulate the 'ids' argument, leading to unauthorized offline logout. The **missing** or **incorrect** authorization check (CWE-862 or CWE-863) allows this manipulation, ultimately resulting in a regular user being able to force an administrator to log off, leading to unauthorized access and potential compromise of the system.\n\n## Summary of Analysis\nThe initial assessment identified **improper authorization** as the primary weakness. The retriever results and relationship analysis refined the selection, particularly the child relationships of CWE-285 (Improper Authorization). The vulnerability description and CVE content summary both point to an authorization issue, supporting the selection of CWE-285 as the primary CWE. Given the evidence, the final decision focuses on CWE-285, with consideration of CWE-863 and CWE-862 to represent the nuance of whether authorization was completely missing or implemented incorrectly.\n\nRelevant CWE Information:\n\n*   The vulnerability description states \"**improper authorization**\".\n*   The CVE Reference Links Content Summary states \"**Missing Authorization:** The application does not adequately verify if a user has the authority to log off another user.\"\n*   The CVE Reference Links Content Summary states \"The code allows users to log off other users, including administrators, by manipulating session IDs.\"\n\nBased on this evidence, CWE-285 is the most appropriate primary CWE because the root cause is **improper authorization**.\n\nCWE-863 (Incorrect Authorization) was considered as a more specific child of CWE-285. The evidence suggests that authorization checks might be present but flawed. Thus, it has been added as a secondary CWE.\n\nCWE-862 (Missing Authorization) was considered as a more specific child of CWE-285. The evidence suggests the application does not adequately verify if a user has the authority to log off another user. Thus, it has been added as a secondary CWE.\n\nCWE-306 (Missing Authentication for Critical Function) was considered but deemed less relevant, as the issue appears to be related to authorization (i.e., what an authenticated user can do) rather than authentication (i.e., verifying the user's identity). The documentation states that \"the application does not adequately verify if a user has the authority to log off another user\" which indicates that the user has already been authenticated, so it's not an authentication issue.\n\nCWE-79 (Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')) was considered but deemed less relevant, as the issue is related to **improper authorization** rather than improper neutralization of input.\n\nCWE-89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) was considered but deemed less relevant, as the issue is related to **improper authorization** rather than SQL injection.\n\nCWE-78 (Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')) was considered but deemed less relevant, as the issue is related to **improper authorization** rather than OS command injection.\n\nCWE-284 (Improper Access Control) was considered, but as the guidance suggests, it should be avoided if a more specific child CWE like 285, 862, or 863 is appropriate. Since authorization issues are the core of the vulnerability, CWE-285, CWE-862 and CWE-863 are preferred.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-89:**\n- 89 (Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Authorization",
        "match_reason": "term_in_phrase_whole_phrase"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 560.6940575465633
    },
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "source": "sparse"
      },
      "similarity": 555.7869755473886
    },
    {
      "metadata": {
        "doc_id": "927",
        "name": "Use of Implicit Intent for Sensitive Communication",
        "source": "sparse"
      },
      "similarity": 497.8331232009242
    },
    {
      "metadata": {
        "doc_id": "705",
        "name": "Incorrect Control Flow Scoping",
        "source": "sparse"
      },
      "similarity": 492.08268882798416
    },
    {
      "metadata": {
        "doc_id": "704",
        "name": "Incorrect Type Conversion or Cast",
        "source": "sparse"
      },
      "similarity": 459.95061678233697
    },
    {
      "metadata": {
        "doc_id": "125",
        "name": "Out-of-bounds Read",
        "source": "sparse"
      },
      "similarity": 450.9855936595285
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 449.7637741977139
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
        "keyphrase_source": "rootcause:improper authorization",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.5544048473415731,
            "graph": 2.5653650661896217
          }
        }
      },
      "similarity": 0.5544048473415731
    },
    {
      "doc_id": "184",
      "text": "CWE-184: Incomplete List of Disallowed Inputs",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "184",
        "name": "Incomplete List of Disallowed Inputs",
        "type": "base",
        "original_content": "CWE-184: Incomplete List of Disallowed Inputs",
        "relationships": [
          {
            "source_id": "184",
            "target_id": "692",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "78",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "79",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "1023",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "184",
            "target_id": "693",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "86",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "79",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "78",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "693",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "692",
            "target_id": "184",
            "label": "STARTSWITH",
            "properties": {
              "view_id": "709"
            }
          },
          {
            "source_id": "625",
            "target_id": "184",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "184",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "186",
            "target_id": "184",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1023",
            "target_id": "184",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "79",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "79"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "78",
                  "184",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "78"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "184",
                  "78",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "78"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-89",
      "CWE-862",
      "CWE-306",
      "CWE-79",
      "CWE-285",
      "CWE-78",
      "CWE-284"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}