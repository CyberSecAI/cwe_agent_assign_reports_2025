# Vulnerability Information: CVE-2024-0231

## Vulnerability Description
A **resource misdirection vulnerability** in GitLab CE/EE versions 12.0 prior to 17.0.5, 17.1 prior to 17.1.3, and 17.2 prior to 17.2.1 allows an attacker to craft a repository import in such a way as to misdirect commits.

### Vulnerability Description Key Phrases
- **rootcause:** **resource misdirection vulnerability**
- **impact:** misdirect commits
- **vector:** craft a repository import
- **attacker:** attacker
- **product:** GitLab CE/EE
- **version:** 12.0 prior to 17.0.5, 17.1 prior to 17.1.3, and 17.2 prior to 17.2.1

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

The vulnerability stems from a bypass in GitLab's security check that was designed to prevent the creation of tags or branches with names that match SHA1 or SHA256 commit hashes. While the check is in place during direct creation within GitLab, it's bypassed when a repository containing such tags or branches is imported from an external Git provider.

**Weaknesses/Vulnerabilities:**

*   **Bypass of Security Check:** The primary weakness is the failure to apply the SHA hash name check during the repository import process, leading to a security bypass.
*   **Inconsistent Enforcement:** The vulnerability highlights an inconsistency in how the security check is enforced. Direct creation is blocked, but imports are not.

**Impact of Exploitation:**

*   **Commit Manipulation:** An attacker could create a malicious tag or branch with the same name as a legitimate commit. This could be used to manipulate code in various ways:
    *   **CI/CD Pipeline Poisoning:** If a CI/CD pipeline is pinned to a commit, replacing it with a tag of the same name containing malicious code could compromise builds and deployments.
    *   **Code Manipulation:** Local user code that relies on checking out a specific commit using `git checkout` could be directed to the attacker's malicious code.

**Attack Vectors:**

*   **Repository Import:** The primary attack vector is importing a specially crafted repository from an external Git provider.

**Required Attacker Capabilities/Position:**

*   **External Git Repository Control:** The attacker needs control over an external Git repository to create the malicious tags or branches with SHA-like names.
*   **GitLab User with Import Privileges:** The attacker needs to have the ability to import a repository into a GitLab instance.

**Summary of Information:**

The provided content contains more detail than what would be included in a typical CVE description. It details the exact mechanism of the vulnerability and how it can be exploited, including a specific attack vector and impact scenario. The report also highlights the specific code change that the security check was added for.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.320 |
| 2 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.295 |
| 3 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.285 |
| 4 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.285 |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.278 |
| 6 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.278 |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.272 |
| 8 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | sparse | 0.271 |
| 9 | 527 | Exposure of Version-Control Repository to an Unauthorized Control Sphere | Variant | Allowed | dense | 0.582 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.002 |

