{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved i2c stm32f7 Do not prepare/unprepare clock during runtime suspend/resume In case there is any sort of clock controller attached to this I2C bus controller, for example Versaclock or even an AIC32x4 I2C codec, then an I2C transfer triggered from the clock controller clk_ops .prepare callback may trigger a deadlock on drivers/clk/clk.c prepare_lock mutex. This is because the clock controller first grabs the prepare_lock mutex and then performs the prepare operation, including its I2C access. The I2C access resumes this I2C bus controller via .runtime_resume callback, which calls clk_prepare_enable(), which attempts to grab the prepare_lock mutex again and deadlocks. Since the clock are already prepared since probe() and unprepared in remove(), use simple clk_enable()/clk_disable() calls to enable and disable the clock on runtime suspend and resume, to avoid hitting the prepare_lock mutex.",
  "keyphrases": {
    "rootcause": [
      "Do not prepare",
      "unprepare clock during runtime suspend",
      "resume"
    ]
  },
  "timestamp": "2025-07-12 05:25:10",
  "cve_id": "CVE-2024-49985",
  "result_count": 13,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 686.7886889351314,
      "search_source": "rootcause:Do not prepare"
    },
    {
      "cwe_id": "1247",
      "name": "Improper Protection Against Voltage and Clock Glitches",
      "score": 649.1426841262439,
      "search_source": "rootcause:unprepare clock during runtime suspend"
    },
    {
      "cwe_id": "1256",
      "name": "Improper Restriction of Software Interfaces to Hardware Features",
      "score": 615.0467783778561,
      "search_source": "rootcause:unprepare clock during runtime suspend"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 613.0605811115754,
      "search_source": "rootcause:Do not prepare"
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "score": 606.2109404092254,
      "search_source": "rootcause:Do not prepare"
    },
    {
      "cwe_id": "287",
      "name": "Improper Authentication",
      "score": 597.7059378593865,
      "search_source": "rootcause:Do not prepare"
    },
    {
      "cwe_id": "1250",
      "name": "Improper Preservation of Consistency Between Independent Representations of Shared State",
      "score": 597.3459924068476,
      "search_source": "rootcause:Do not prepare"
    },
    {
      "cwe_id": "337",
      "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
      "score": 597.3412145273358,
      "search_source": "rootcause:unprepare clock during runtime suspend"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 596.2297784698399,
      "search_source": "rootcause:Do not prepare"
    },
    {
      "cwe_id": "522",
      "name": "Insufficiently Protected Credentials",
      "score": 594.8836548190345,
      "search_source": "rootcause:Do not prepare"
    },
    {
      "cwe_id": "732",
      "name": "Incorrect Permission Assignment for Critical Resource",
      "score": 593.7343443321608,
      "search_source": "rootcause:unprepare clock during runtime suspend"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 592.7641123386911,
      "search_source": "rootcause:Do not prepare"
    },
    {
      "cwe_id": "256",
      "name": "Plaintext Storage of a Password",
      "score": 591.7398974637455,
      "search_source": "rootcause:unprepare clock during runtime suspend"
    }
  ]
}