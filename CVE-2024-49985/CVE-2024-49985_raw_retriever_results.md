# Raw Retriever Results for CVE-2024-49985

# Raw Retriever Results for CVE-2024-49985
## Query
In the Linux kernel, the following vulnerability has been resolved i2c stm32f7 Do not prepare/unprepare clock during runtime suspend/resume In case there is any sort of clock controller attached to this I2C bus controller, for example Versaclock or even an AIC32x4 I2C codec, then an I2C transfer triggered from the clock controller clk_ops .prepare callback may trigger a deadlock on drivers/clk/clk.c prepare_lock mutex. This is because the clock controller first grabs the prepare_lock mutex and then performs the prepare operation, including its I2C access. The I2C access resumes this I2C bus controller via .runtime_resume callback, which calls clk_prepare_enable(), which attempts to grab the prepare_lock mutex again and deadlocks. Since the clock are already prepared since probe() and unprepared in remove(), use simple clk_enable()/clk_disable() calls to enable and disable the clock on runtime suspend and resume, to avoid hitting the prepare_lock mutex.

## Keyphrases
- **rootcause**: 'Do not prepare', 'unprepare clock during runtime suspend', 'resume'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4236 | 0.4820 | 0.4473 | 0.4416 | 20 |
| Sparse | 591.7399 | 686.7887 | 610.1534 | 597.3460 | 13 |
| Graph | 1.0275 | 2.2100 | 1.6505 | 1.6351 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 2 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 3 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 4 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 5 | 125 | Out-of-bounds Read | base | 2.1190 | Allowed |
| 6 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 7 | 787 | Out-of-bounds Write | base | 1.7680 | Allowed |
| 8 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 1.6842 | Allowed |
| 9 | 413 | Improper Resource Locking | Base | 1.6841 | Allowed |
| 10 | 1231 | Improper Prevention of Lock Bit Modification | Base | 1.6382 | Allowed |
| 11 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |
| 12 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 1.6320 | Allowed |
| 13 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 1.5962 | Allowed |
| 14 | 1247 | Improper Protection Against Voltage and Clock Glitches | Base | 1.4767 | Allowed |
| 15 | 863 | Incorrect Authorization | class | 1.3648 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1247 | Improper Protection Against Voltage and Clock Glitches | Base | 0.4820 | 0.4820 | Allowed |
| 2 | 413 | Improper Resource Locking | Base | 0.4809 | 0.4809 | Allowed |
| 3 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4772 | 0.4772 | Allowed |
| 4 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.4758 | 0.4758 | Allowed |
| 5 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4672 | 0.4672 | Allowed |
| 6 | 1232 | Improper Lock Behavior After Power State Transition | Base | 0.4582 | 0.4582 | Allowed |
| 7 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.4523 | 0.4523 | Allowed |
| 8 | 1193 | Power-On of Untrusted Execution Core Before Enabling Fabric Access Control | Base | 0.4507 | 0.4507 | Allowed |
| 9 | 1234 | Hardware Internal or Debug Modes Allow Override of Locks | Base | 0.4484 | 0.4484 | Allowed |
| 10 | 833 | Deadlock | Base | 0.4472 | 0.4472 | Allowed |
| 11 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | Variant | 0.4359 | 0.4359 | Allowed |
| 12 | 1191 | On-Chip Debug and Test Interface With Improper Access Control | Base | 0.4354 | 0.4354 | Allowed |
| 13 | 1262 | Improper Access Control for Register Interface | Base | 0.4351 | 0.4351 | Allowed |
| 14 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.4338 | 0.4338 | Allowed |
| 15 | 1189 | Improper Isolation of Shared Resources on System-on-a-Chip (SoC) | Base | 0.4316 | 0.4316 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 686.7887 | 686.7887 | Allowed-with-Review |
| 2 | 1247 | Improper Protection Against Voltage and Clock Glitches | 649.1427 | 649.1427 | Allowed |
| 3 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | 615.0468 | 615.0468 | Allowed |
| 4 | 863 | Incorrect Authorization | 613.0606 | 613.0606 | Allowed-with-Review |
| 5 | 125 | Out-of-bounds Read | 606.2109 | 606.2109 | Allowed |
| 6 | 287 | Improper Authentication | 597.7059 | 597.7059 | Discouraged |
| 7 | 1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | 597.3460 | 597.3460 | Allowed |
| 8 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | 597.3412 | 597.3412 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 596.2298 | 596.2298 | Allowed-with-Review |
| 10 | 522 | Insufficiently Protected Credentials | 594.8837 | 594.8837 | Allowed-with-Review |
| 11 | 732 | Incorrect Permission Assignment for Critical Resource | 593.7343 | 593.7343 | Allowed-with-Review |
| 12 | 833 | Deadlock | 592.7641 | 592.7641 | Allowed |
| 13 | 256 | Plaintext Storage of a Password | 591.7399 | 591.7399 | Allowed |
