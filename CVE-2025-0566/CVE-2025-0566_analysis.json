{
  "cve_id": "CVE-2025-0566",
  "description": "A vulnerability classified as critical has been found in Tenda AC15 15.13.07.13. This affects the function formSetDevNetName of the file /goform/SetDevNetName. The manipulation of the argument mac leads to stack-based buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.",
  "key_phrases": {
    "component": "/goform/SetDevNetName formSetDevNetName function",
    "rootcause": "",
    "vector": "manipulation of the argument mac",
    "weakness": "stack-based buffer overflow, buffer overflow",
    "product": "Tenda AC15",
    "impact": "",
    "attacker": "",
    "version": "15.13.07.13"
  },
  "reference_content": "UNRELATED",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|--------------|------------------------------------------------------------------------------------------------------------------|------------|-----------------------|-----------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| CWE-121 | Stack-based Buffer Overflow | 1.0 | Variant | Allowed | Primary CWE. The vulnerability description explicitly states \"stack-based buffer overflow\" making this the most accurate primary CWE. |\n| CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | 0.7 | Base | Allowed-with-Review | Secondary candidate. While the description indicates a buffer overflow, the specifics of a copy operation without size checking aren't explicitly stated, lowering the confidence. |\n| CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 0.6 | Class | Discouraged | Secondary candidate. CWE-119 is a broader category. Although applicable, it's less specific than CWE-121, which directly identifies the stack-based nature of the overflow. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship that impacted the decision was the parent-child relationship between CWE-119 (Improper Restriction of Operations within the Bounds of a Memory Buffer) and CWE-121 (Stack-based Buffer Overflow). CWE-121 is a variant of CWE-119, making it a more specific and appropriate choice given the explicit mention of \"stack-based\" in the vulnerability description. CWE-120 (Buffer Copy without Checking Size of Input) can precede CWE-787 (Out-of-bounds Write), illustrating a potential chain. The abstraction levels guided the selection, favoring the variant level CWE-121 for its precision.\n\n```mermaid\ngraph TD\n    cwe121[\"CWE-121: Stack-based Buffer Overflow\"]\n    cwe119[\"CWE-119: Improper Restriction of Operations\"]\n    cwe120[\"CWE-120: Buffer Copy without Checking Size\"]\n    cwe787[\"CWE-787: Out-of-bounds Write\"]\n    \n    cwe121 -->|CHILDOF| cwe119\n    cwe120 -->|CANPRECEDE| cwe787\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe121 primary\n    class cwe119,cwe120 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper handling of the 'mac' argument** within the `/goform/SetDevNetName` function. This leads to a **stack-based buffer overflow (CWE-121)** when the input 'mac' exceeds the buffer's capacity. The overflow allows an attacker to overwrite data on the stack, potentially leading to arbitrary code execution.\n\n## Summary of Analysis\nThe analysis strongly indicates that CWE-121 (Stack-based Buffer Overflow) is the most appropriate primary CWE. This is based on the explicit mention of \"stack-based buffer overflow\" in the vulnerability description, providing direct evidence for this classification. The retriever results also list CWE-121 as a relevant CWE. The relationship analysis highlights that CWE-121 is a variant of the more general CWE-119, making it a more specific and accurate choice. The selection of CWE-121 is at the optimal level of specificity because it directly reflects the nature of the vulnerability as a stack-based buffer overflow, rather than a more general buffer overflow or memory corruption issue.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-121: Stack-based Buffer Overflow\n**Abstraction Level**: Variant\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')\n**Abstraction Level**: Base\n**Similarity Score**: 521.91\n**Source**: sparse\n\n**Description**:\nThe product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: There are some indications that this CWE ID might be misused and selected simply because it mentions \"buffer overflow\" - an increasingly vague term. This CWE entry is only appropriate for \"Buffer Copy\" operations (not buffer reads), in which where there is no \"Checking [the] Size of Input\", and (by implication of the copy) writing past the end of the buffer.\n\n## CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer\n**Abstraction Level**: Class\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-119 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available.\n\n## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\nCWE-78 was not selected because the vulnerability description does not indicate command injection, but rather a buffer overflow.\n\n## CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\nCWE-79 was not selected because the vulnerability is a buffer overflow, not a cross-site scripting issue.\n\n## CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\nCWE-89 was not selected because the vulnerability description does not indicate SQL injection, but rather a buffer overflow.\n\n## CWE-125: Out-of-bounds Read\nCWE-125 was not selected because the vulnerability is specifically a buffer overflow, not an out-of-bounds read.\n\n## CWE-128: Wrap-around Error and CWE-190: Integer Overflow or Wraparound\nCWE-128 and CWE-190 were not selected because the vulnerability involves a buffer overflow, not integer handling issues.\n\n## CWE-131: Incorrect Calculation of Buffer Size\nCWE-131 was not selected because the root cause is not explicitly stated as incorrect calculation.\n\n## CWE-134: Use of Externally-Controlled Format String\nCWE-134 was not selected because the root cause is not explicitly stated as an externally controlled format string.\n\n## CWE-425: Direct Request ('Forced Browsing') and CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\nCWE-425 and CWE-497 were not selected because the vulnerability description does not indicate authorization or information exposure issues.\n\n## CWE-674: Uncontrolled Recursion\nCWE-674 was not selected because the vulnerability description does not indicate uncontrolled recursion.\n\n## CWE-755: Improper Handling of Exceptional Conditions\nCWE-755 was not selected because the vulnerability description does not indicate exception handling issues.\n\n## CWE-790: Improper Filtering of Special Elements\nCWE-790 was not selected because the root cause is not explicitly stated as improper filtering.\n\n## CWE-822: Untrusted Pointer Dereference and CWE-823: Use of Out-of-range Pointer Offset\nCWE-822 and CWE-823 were not selected because the vulnerability description does not indicate pointer issues.\n\n## CWE-1339: Insufficient Precision or Accuracy of a Real Number\nCWE-1339 was not selected because the vulnerability description does not indicate real number precision or accuracy issues.",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|--------------|------------------------------------------------------------------------------------------------------------------|------------|-----------------------|-----------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| CWE-121 | Stack-based Buffer Overflow | 1.0 | Variant | Allowed | Primary CWE. The vulnerability description explicitly states \"stack-based buffer overflow\" making this the most accurate primary CWE. |\n| CWE-120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | 0.7 | Base | Allowed-with-Review | Secondary candidate. While the description indicates a buffer overflow, the specifics of a copy operation without size checking aren't explicitly stated, lowering the confidence. |\n| CWE-119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 0.6 | Class | Discouraged | Secondary candidate. CWE-119 is a broader category. Although applicable, it's less specific than CWE-121, which directly identifies the stack-based nature of the overflow. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship that impacted the decision was the parent-child relationship between CWE-119 (Improper Restriction of Operations within the Bounds of a Memory Buffer) and CWE-121 (Stack-based Buffer Overflow). CWE-121 is a variant of CWE-119, making it a more specific and appropriate choice given the explicit mention of \"stack-based\" in the vulnerability description. CWE-120 (Buffer Copy without Checking Size of Input) can precede CWE-787 (Out-of-bounds Write), illustrating a potential chain. The abstraction levels guided the selection, favoring the variant level CWE-121 for its precision.\n\n```mermaid\ngraph TD\n    cwe121[\"CWE-121: Stack-based Buffer Overflow\"]\n    cwe119[\"CWE-119: Improper Restriction of Operations\"]\n    cwe120[\"CWE-120: Buffer Copy without Checking Size\"]\n    cwe787[\"CWE-787: Out-of-bounds Write\"]\n    \n    cwe121 -->|CHILDOF| cwe119\n    cwe120 -->|CANPRECEDE| cwe787\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe121 primary\n    class cwe119,cwe120 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **improper handling of the 'mac' argument** within the `/goform/SetDevNetName` function. This leads to a **stack-based buffer overflow (CWE-121)** when the input 'mac' exceeds the buffer's capacity. The overflow allows an attacker to overwrite data on the stack, potentially leading to arbitrary code execution.\n\n## Summary of Analysis\nThe analysis strongly indicates that CWE-121 (Stack-based Buffer Overflow) is the most appropriate primary CWE. This is based on the explicit mention of \"stack-based buffer overflow\" in the vulnerability description, providing direct evidence for this classification. The retriever results also list CWE-121 as a relevant CWE. The relationship analysis highlights that CWE-121 is a variant of the more general CWE-119, making it a more specific and accurate choice. The selection of CWE-121 is at the optimal level of specificity because it directly reflects the nature of the vulnerability as a stack-based buffer overflow, rather than a more general buffer overflow or memory corruption issue.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-121: Stack-based Buffer Overflow\n**Abstraction Level**: Variant\n**Similarity Score**: 0.75\n**Source**: dense\n\n**Description**:\nA stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')\n**Abstraction Level**: Base\n**Similarity Score**: 521.91\n**Source**: sparse\n\n**Description**:\nThe product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: There are some indications that this CWE ID might be misused and selected simply because it mentions \"buffer overflow\" - an increasingly vague term. This CWE entry is only appropriate for \"Buffer Copy\" operations (not buffer reads), in which where there is no \"Checking [the] Size of Input\", and (by implication of the copy) writing past the end of the buffer.\n\n## CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer\n**Abstraction Level**: Class\n**Similarity Score**: 0.70\n**Source**: dense\n\n**Description**:\nThe product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.\n\n**Mapping Guidance**:\n- Usage: Discouraged\n- Rationale: CWE-119 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available.\n\n## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\nCWE-78 was not selected because the vulnerability description does not indicate command injection, but rather a buffer overflow.\n\n## CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\nCWE-79 was not selected because the vulnerability is a buffer overflow, not a cross-site scripting issue.\n\n## CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\nCWE-89 was not selected because the vulnerability description does not indicate SQL injection, but rather a buffer overflow.\n\n## CWE-125: Out-of-bounds Read\nCWE-125 was not selected because the vulnerability is specifically a buffer overflow, not an out-of-bounds read.\n\n## CWE-128: Wrap-around Error and CWE-190: Integer Overflow or Wraparound\nCWE-128 and CWE-190 were not selected because the vulnerability involves a buffer overflow, not integer handling issues.\n\n## CWE-131: Incorrect Calculation of Buffer Size\nCWE-131 was not selected because the root cause is not explicitly stated as incorrect calculation.\n\n## CWE-134: Use of Externally-Controlled Format String\nCWE-134 was not selected because the root cause is not explicitly stated as an externally controlled format string.\n\n## CWE-425: Direct Request ('Forced Browsing') and CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere\nCWE-425 and CWE-497 were not selected because the vulnerability description does not indicate authorization or information exposure issues.\n\n## CWE-674: Uncontrolled Recursion\nCWE-674 was not selected because the vulnerability description does not indicate uncontrolled recursion.\n\n## CWE-755: Improper Handling of Exceptional Conditions\nCWE-755 was not selected because the vulnerability description does not indicate exception handling issues.\n\n## CWE-790: Improper Filtering of Special Elements\nCWE-790 was not selected because the root cause is not explicitly stated as improper filtering.\n\n## CWE-822: Untrusted Pointer Dereference and CWE-823: Use of Out-of-range Pointer Offset\nCWE-822 and CWE-823 were not selected because the vulnerability description does not indicate pointer issues.\n\n## CWE-1339: Insufficient Precision or Accuracy of a Real Number\nCWE-1339 was not selected because the vulnerability description does not indicate real number precision or accuracy issues.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-125:**\n- 125 (Out-of-bounds Read) - ROOT\n\n\n**Chain starting from CWE-131:**\n- 131 (Incorrect Calculation of Buffer Size) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "119",
        "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Buffer Overflow",
        "match_reason": "exact_match_compound_part_1"
      },
      "similarity": 1000.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "190",
        "name": "Integer Overflow or Wraparound",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Overflow",
        "match_reason": "term_in_phrase_compound_part_0"
      },
      "similarity": 800.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Classic Buffer Overflow",
        "match_reason": "phrase_in_term_compound_part_1"
      },
      "similarity": 700.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "121",
        "name": "Stack-based Buffer Overflow",
        "source": "sparse"
      },
      "similarity": 403.51016865120977
    },
    {
      "metadata": {
        "doc_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "source": "sparse"
      },
      "similarity": 384.87282182094447
    },
    {
      "metadata": {
        "doc_id": "125",
        "name": "Out-of-bounds Read",
        "source": "sparse"
      },
      "similarity": 366.03749270617016
    },
    {
      "metadata": {
        "doc_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "source": "sparse"
      },
      "similarity": 363.9287549157139
    },
    {
      "metadata": {
        "doc_id": "674",
        "name": "Uncontrolled Recursion",
        "source": "sparse"
      },
      "similarity": 351.77392376797684
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "type": "Base",
        "original_content": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
        "keyphrase_source": "weakness:stack-based buffer overflow",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "dense": 0.6136174615698569
          }
        }
      },
      "similarity": 0.6136174615698569
    },
    {
      "doc_id": "128",
      "text": "CWE-128: Wrap-around Error",
      "score": 2.9120000000000004,
      "metadata": {
        "doc_id": "128",
        "name": "Wrap-around Error",
        "type": "base",
        "original_content": "CWE-128: Wrap-around Error",
        "relationships": [
          {
            "source_id": "128",
            "target_id": "190",
            "label": "PEEROF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "128",
            "target_id": "119",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "128",
            "target_id": "682",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "682",
            "target_id": "128",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "119",
            "target_id": "128",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0,
          "peer_group": 0.9
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward",
            "peer_relationship"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "119",
                  "128",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "119"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "119",
                  "128",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "119"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "128",
                  "119",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "119"
            },
            "peer_relationship": {
              "path": [
                [
                  "128",
                  "190",
                  "PEEROF"
                ]
              ],
              "score": 0.9,
              "type": "peer_relationship",
              "source": "190"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.9120000000000004
          }
        }
      },
      "similarity": 2.9120000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-125",
      "CWE-131",
      "CWE-787",
      "CWE-79",
      "CWE-790",
      "CWE-89",
      "CWE-1339",
      "CWE-120",
      "CWE-425",
      "CWE-128",
      "CWE-823",
      "CWE-674",
      "CWE-78",
      "CWE-755",
      "CWE-121",
      "CWE-190",
      "CWE-822",
      "CWE-119",
      "CWE-134",
      "CWE-497"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}