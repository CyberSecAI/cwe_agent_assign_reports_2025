## Vulnerability Description
Pimcore is an open source data and experience management platform. When a PortalUserObject is connected to a PimcoreUser and Use Pimcore Backend Password is set to true, the change password function in Portal Profile sets the new password. Prior to Pimcore portal engine versions 4.1.7 and 3.1.16, the password is then set without hashing so it can be read by everyone. Everyone who combines PortalUser to PimcoreUsers and change passwords via profile settings could be affected. Versions 4.1.7 and 3.1.16 of the Pimcore portal engine fix the issue.

### Vulnerability Description Key Phrases
- **weakness:** **sets the new password without hashing**
- **impact:** change passwords and read the password
- **attacker:** everyone
- **product:** Pimcore portal engine
- **version:** prior to 4.1.7 and 3.1.16
- **component:** change password function in Portal Profile

## CVE Reference Links Content Summary
```
{
  "Root cause of vulnerability": "The password is set without hashing in the change password function within the Portal Profile when 'Use Pimcore Backend Password' is enabled for a PortalUserObject connected to a PimcoreUser.",
  "Weaknesses/vulnerabilities present": [
    "Password stored in plaintext in the database",
      "Lack of password hashing before saving to database"
  ],
  "Impact of exploitation": "Exposure of Pimcore user passwords, potentially leading to unauthorized access.",
  "Attack vectors": "Changing the password via the Portal Profile when the 'Use Pimcore Backend Password' is enabled.",
  "Required attacker capabilities/position": "The attacker needs to have an account with a PortalUserObject linked to a PimcoreUser and the 'Use Pimcore Backend Password' setting enabled, and be able to access the portal profile to change the password."
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.503 |
| 2 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.492 |
| 3 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.492 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.491 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.488 |
| 6 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.488 |
| 7 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.487 |
| 8 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.483 |
| 9 | 620 | Unverified Password Change | Base | Allowed | dense | 0.482 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-306: Missing Authentication for Critical Function

CWE-328: Use of Weak Hash

CWE-287: Improper Authentication

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-256: Plaintext Storage of a Password

CWE-522: Insufficiently Protected Credentials

CWE-620: Unverified Password Change

CWE-613: Insufficient Session Expiration