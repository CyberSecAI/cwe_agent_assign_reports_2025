{
  "query": "In the Linux kernel, the following vulnerability has been resolved md fix deadlock between mddev_suspend and flush bio Deadlock occurs when mddev is being suspended while some flush bio is in progress. It is a complex issue. T1. the first flush is at the ending stage, it clears mddev->flush_bio and tries to submit data, but is blocked because mddev is suspended by T4. T2. the second flush sets mddev->flush_bio, and attempts to queue md_submit_flush_data(), which is already running (T1) and wont execute again if on the same CPU as T1. T3. the third flush inc active_io and tries to flush, but is blocked because mddev->flush_bio is not NULL (set by T2). T4. mddev_suspend() is called and waits for active_io dec to 0 which is inc by T3. T1T2T3T4 (flush 1)(flush 2)(third 3)(suspend) md_submit_flush_data mddev->flush_bio = NULL . . md_flush_request . mddev->flush_bio = bio . queue submit_flushes . . . .md_handle_request . . active_io + 1 . . md_flush_request . . wait !mddev->flush_bio . . . .mddev_suspend . . wait !active_io . . . submit_flushes . queue_work md_submit_flush_data . //md_submit_flush_data is already running (T1) . md_handle_request wait resume The root issue is non-atomic inc/dec of active_io during flush process. active_io is dec before md_submit_flush_data is queued, and inc soon after md_submit_flush_data() run. md_flush_request active_io + 1 sub",
  "count": 20,
  "results": [
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "abstraction": "Base",
      "score": 0.4751903237840246,
      "original_score": 0.4751903237840246,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 0.4158351382300569,
      "original_score": 0.4158351382300569,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1190",
      "name": "DMA Device Enabled Too Early in Boot Phase",
      "abstraction": "Base",
      "score": 0.4138462574500851,
      "original_score": 0.4138462574500851,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1264",
      "name": "Hardware Logic with Insecure De-Synchronization between Control and Data Channels",
      "abstraction": "Base",
      "score": 0.4107522215946394,
      "original_score": 0.4107522215946394,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "abstraction": "Base",
      "score": 0.4101752188807999,
      "original_score": 0.4101752188807999,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1342",
      "name": "Information Exposure through Microarchitectural State after Transient Execution",
      "abstraction": "Base",
      "score": 0.40644917144781156,
      "original_score": 0.40644917144781156,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "abstraction": "Class",
      "score": 0.4062263845192346,
      "original_score": 0.4062263845192346,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "765",
      "name": "Multiple Unlocks of a Critical Resource",
      "abstraction": "Base",
      "score": 0.4032284192521401,
      "original_score": 0.4032284192521401,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "score": 0.400939609585255,
      "original_score": 0.400939609585255,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 0.39801202933949864,
      "original_score": 0.39801202933949864,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "775",
      "name": "Missing Release of File Descriptor or Handle after Effective Lifetime",
      "abstraction": "Variant",
      "score": 0.3887376055089908,
      "original_score": 0.3887376055089908,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "score": 0.3886513453010617,
      "original_score": 0.3886513453010617,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1250",
      "name": "Improper Preservation of Consistency Between Independent Representations of Shared State",
      "abstraction": "Base",
      "score": 0.38711244707625725,
      "original_score": 0.38711244707625725,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1272",
      "name": "Sensitive Information Uncleared Before Debug/Power State Transition",
      "abstraction": "Base",
      "score": 0.3856032080975082,
      "original_score": 0.3856032080975082,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "764",
      "name": "Multiple Locks of a Critical Resource",
      "abstraction": "Base",
      "score": 0.3833058776876543,
      "original_score": 0.3833058776876543,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 0.3823527305078668,
      "original_score": 0.3823527305078668,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "773",
      "name": "Missing Reference to Active File Descriptor or Handle",
      "abstraction": "Variant",
      "score": 0.38135898712428135,
      "original_score": 0.38135898712428135,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "abstraction": "Base",
      "score": 0.381242767317418,
      "original_score": 0.381242767317418,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "459",
      "name": "Incomplete Cleanup",
      "abstraction": "Base",
      "score": 0.38010124627881836,
      "original_score": 0.38010124627881836,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "126",
      "name": "Buffer Over-read",
      "abstraction": "Variant",
      "score": 0.37655507569899566,
      "original_score": 0.37655507569899566,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.37655507569899566,
    "max": 0.4751903237840246,
    "mean": 0.3987838032341199,
    "median": 0.39337481742424474,
    "count": 20
  }
}