{
  "retriever": "dense",
  "query": "In the Linux kernel, the following vulnerability has been resolved md fix deadlock between mddev_suspend and flush bio Deadlock occurs when mddev is being suspended while some flush bio is in progress. It is a complex issue. T1. the first flush is at the ending stage, it clears mddev->flush_bio and tries to submit data, but is blocked because mddev is suspended by T4. T2. the second flush sets mddev->flush_bio, and attempts to queue md_submit_flush_data(), which is already running (T1) and wont execute again if on the same CPU as T1. T3. the third flush inc active_io and tries to flush, but is blocked because mddev->flush_bio is not NULL (set by T2). T4. mddev_suspend() is called and waits for active_io dec to 0 which is inc by T3. T1T2T3T4 (flush 1)(flush 2)(third 3)(suspend) md_submit_flush_data mddev->flush_bio = NULL . . md_flush_request . mddev->flush_bio = bio . queue submit_flushes . . . .md_handle_request . . active_io + 1 . . md_flush_request . . wait !mddev->flush_bio . . . .mddev_suspend . . wait !active_io . . . submit_flushes . queue_work md_submit_flush_data . //md_submit_flush_data is already running (T1) . md_handle_request wait resume The root issue is non-atomic inc/dec of active_io during flush process. active_io is dec before md_submit_flush_data is queued, and inc soon after md_submit_flush_data() run. md_flush_request active_io + 1 sub",
  "keyphrases": {
    "rootcause": [
      "non-atomic inc",
      "dec of active_io during flush process"
    ]
  },
  "timestamp": "2025-07-13 15:17:57",
  "cve_id": "CVE-2024-43855",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "type": "Base",
      "score": 0.4751903237840246
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "type": "Class",
      "score": 0.4158351382300569
    },
    {
      "cwe_id": "1190",
      "name": "DMA Device Enabled Too Early in Boot Phase",
      "type": "Base",
      "score": 0.4138462574500851
    },
    {
      "cwe_id": "1264",
      "name": "Hardware Logic with Insecure De-Synchronization between Control and Data Channels",
      "type": "Base",
      "score": 0.4107522215946394
    },
    {
      "cwe_id": "413",
      "name": "Improper Resource Locking",
      "type": "Base",
      "score": 0.4101752188807999
    },
    {
      "cwe_id": "1342",
      "name": "Information Exposure through Microarchitectural State after Transient Execution",
      "type": "Base",
      "score": 0.40644917144781156
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "type": "Class",
      "score": 0.4062263845192346
    },
    {
      "cwe_id": "765",
      "name": "Multiple Unlocks of a Critical Resource",
      "type": "Base",
      "score": 0.4032284192521401
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "type": "Base",
      "score": 0.400939609585255
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "type": "Class",
      "score": 0.39801202933949864
    },
    {
      "cwe_id": "775",
      "name": "Missing Release of File Descriptor or Handle after Effective Lifetime",
      "type": "Variant",
      "score": 0.3887376055089908
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "type": "Variant",
      "score": 0.3886513453010617
    },
    {
      "cwe_id": "1250",
      "name": "Improper Preservation of Consistency Between Independent Representations of Shared State",
      "type": "Base",
      "score": 0.38711244707625725
    },
    {
      "cwe_id": "1272",
      "name": "Sensitive Information Uncleared Before Debug/Power State Transition",
      "type": "Base",
      "score": 0.3856032080975082
    },
    {
      "cwe_id": "764",
      "name": "Multiple Locks of a Critical Resource",
      "type": "Base",
      "score": 0.3833058776876543
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "type": "Base",
      "score": 0.3823527305078668
    },
    {
      "cwe_id": "773",
      "name": "Missing Reference to Active File Descriptor or Handle",
      "type": "Variant",
      "score": 0.38135898712428135
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "type": "Base",
      "score": 0.381242767317418
    },
    {
      "cwe_id": "459",
      "name": "Incomplete Cleanup",
      "type": "Base",
      "score": 0.38010124627881836
    },
    {
      "cwe_id": "126",
      "name": "Buffer Over-read",
      "type": "Variant",
      "score": 0.37655507569899566
    }
  ]
}