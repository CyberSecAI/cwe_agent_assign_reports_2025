# Raw Retriever Results for CVE-2024-56326

# Raw Retriever Results for CVE-2024-56326
## Query
Jinja is an extensible templating engine. Prior to 3.1.5, An oversight in how the Jinja sandboxed environment detects calls to str.format allows an attacker that controls the content of a template to execute arbitrary Python code. To exploit the vulnerability, an attacker needs to control the content of a template. Whether that is the case depends on the type of application using Jinja. This vulnerability impacts users of applications which execute untrusted templates. Jinjas sandbox does catch calls to str.format and ensures they dont escape the sandbox. However, its possible to store a reference to a malicious strings format method, then pass that to a filter that calls it. No such filters are built-in to Jinja, but could be present through custom filters in an application. After the fix, such indirect calls are also handled by the sandbox. This vulnerability is fixed in 3.1.5.

## Keyphrases
- **rootcause**: 'oversight in how the Jinja sandboxed environment detects calls to str.format'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3916 | 0.5180 | 0.4152 | 0.4105 | 20 |
| Sparse | 253.2226 | 911.2798 | 735.3759 | 821.5443 | 12 |
| Graph | 1.3600 | 2.4071 | 1.7106 | 1.6320 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 2.4071 | Allowed |
| 2 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 2.3739 | Allowed |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.2677 | Allowed |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 2.0610 | Allowed-with-Review |
| 5 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 6 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 8 | 425 | Direct Request ('Forced Browsing') | base | 1.7680 | Allowed |
| 9 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 10 | 456 | Missing Initialization of a Variable | variant | 1.6320 | Allowed |
| 11 | 473 | PHP External Variable Modification | variant | 1.6320 | Allowed |
| 12 | 73 | External Control of File Name or Path | Base | 1.5095 | Allowed |
| 13 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 1.4840 | Allowed |
| 14 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 1.4544 | Allowed |
| 15 | 1333 | Inefficient Regular Expression Complexity | Base | 1.4472 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 0.5180 | 0.5180 | Allowed |
| 2 | 106 | Struts: Plug-in Framework not in Use | Variant | 0.4325 | 0.4325 | Allowed |
| 3 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 0.4297 | 0.4297 | Allowed |
| 4 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 0.4293 | 0.4293 | Allowed |
| 5 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.4253 | 0.4253 | Allowed |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.4237 | 0.4237 | Allowed |
| 7 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.4222 | 0.4222 | Allowed |
| 8 | 36 | Absolute Path Traversal | Base | 0.4193 | 0.4193 | Allowed |
| 9 | 134 | Use of Externally-Controlled Format String | Base | 0.4191 | 0.4191 | Allowed |
| 10 | 277 | Insecure Inherited Permissions | Variant | 0.4175 | 0.4175 | Allowed |
| 11 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.4035 | 0.4035 | Allowed-with-Review |
| 12 | 150 | Improper Neutralization of Escape, Meta, or Control Sequences | Variant | 0.4016 | 0.4016 | Allowed |
| 13 | 1333 | Inefficient Regular Expression Complexity | Base | 0.4015 | 0.4015 | Allowed |
| 14 | 184 | Incomplete List of Disallowed Inputs | Base | 0.3991 | 0.3991 | Allowed |
| 15 | 73 | External Control of File Name or Path | Base | 0.3977 | 0.3977 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 911.2798 | 911.2798 | Allowed |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | 862.4370 | 862.4370 | Allowed-with-Review |
| 3 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 831.7926 | 831.7926 | Allowed |
| 4 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 827.3986 | 827.3986 | Allowed |
| 5 | 1333 | Inefficient Regular Expression Complexity | 825.0046 | 825.0046 | Allowed |
| 6 | 184 | Incomplete List of Disallowed Inputs | 823.3744 | 823.3744 | Allowed |
| 7 | 863 | Incorrect Authorization | 819.7143 | 819.7143 | Allowed-with-Review |
| 8 | 653 | Improper Isolation or Compartmentalization | 811.3629 | 811.3629 | Allowed |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 806.2145 | 806.2145 | Allowed |
| 10 | 125 | Out-of-bounds Read | 798.9535 | 798.9535 | Allowed |
| 11 | 502 | Deserialization of Untrusted Data | 253.7555 | 253.7555 | Allowed |
| 12 | 116 | Improper Encoding or Escaping of Output | 253.2226 | 253.2226 | Allowed-with-Review |
