## Vulnerability Description
In Raptor RDF Syntax Library through 2.0.16, there is a **heap-based buffer over-read** when parsing triples with the nquads parser in raptor_ntriples_parse_term_internal().

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer over-read**
- **product:** Raptor RDF Syntax Library
- **version:** through 2.0.16
- **component:** raptor_ntriples_parse_term_internal()

## CVE Reference Links Content Summary
```
CVE-2024-57822: In Raptor RDF Syntax Library through 2.0.16, there is a heap-based buffer over-read when parsing triples with the nquads parser in raptor_ntriples_parse_term_internal().
CVE-2024-57823: In Raptor RDF Syntax Library through 2.0.16, there is an integer underflow when normalizing a URI with the turtle parser in raptor_uri_normalize_path().

Vulnerable packages: raptor2 2.0.15-4 (bookworm), 2.0.14-1.2 (bullseye)
Fixed packages: raptor2 2.0.16-6 (sid, trixie)

Impact: Heap-based buffer over-read and integer underflow.

Attack vectors:
- CVE-2024-57823: Running `utils/rapper -i turtle memcpy_int_underflow.poc` triggers the integer underflow. The PoC file `memcpy_int_underflow.poc` contains malicious input.
- CVE-2024-57822: Running `raptor-asan/utils/rapper -i nquads heap_read_overflow.poc` triggers the heap read overflow. The PoC file `heap_read_overflow.poc` contains malicious input.

Mitigation/Fix: Upgrade to raptor2 2.0.16-6.  A patch for CVE-2024-57823 involves removing the `#if defined(RAPTOR_DEBUG)` around `RAPTOR_FATAL` calls in `raptor_rfc2396.c`.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.215 |
| 2 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.183 |
| 3 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.182 |
| 4 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.175 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.172 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.165 |
| 7 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.154 |
| 8 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.154 |
| 9 | 127 | Buffer Under-read | Variant | Allowed | dense | 0.421 |
| 10 | 1339 | Insufficient Precision or Accuracy of a Real Number | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-126: Buffer Over-read

CWE-122: Heap-based Buffer Overflow

CWE-190: Integer Overflow or Wraparound

CWE-193: Off-by-one Error

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-125: Out-of-bounds Read

CWE-197: Numeric Truncation Error

CWE-130: Improper Handling of Length Parameter Inconsistency

CWE-127: Buffer Under-read

CWE-1339: Insufficient Precision or Accuracy of a Real Number