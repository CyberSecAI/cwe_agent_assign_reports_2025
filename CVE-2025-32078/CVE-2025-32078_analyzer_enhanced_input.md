## Vulnerability Description
**Improper Encoding or Escaping of Output** vulnerability in The Wikimedia Foundation Mediawiki - Version Compare Extension allows Cross-Site Scripting (XSS).This issue affects Mediawiki - Version Compare Extension from 1.39 through 1.43.

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Encoding or Escaping of Output**
- **weakness:** **Cross-Site Scripting, XSS**
- **product:** The Wikimedia Foundation Mediawiki - Version Compare Extension
- **version:** 1.39 through 1.43

## CVE Reference Links Content Summary
The content describes a Cross-Site Scripting (XSS) vulnerability and a potential Remote Code Execution (RCE) vulnerability in the `Special:VersionCompare` extension of MediaWiki. This aligns with the provided CVE ID.

**Root cause of vulnerability (XSS):**
*   The content highlights potential XSS vulnerabilities where user-supplied data, specifically in the `wikiid`, `servername`, `generator`, and extension name parameters, is not properly sanitized before being displayed, allowing for the injection of malicious JavaScript code.
*   The `version-compare-no-version` and `version-compare-same-extension-count-label` system messages are also vulnerable.

**Weaknesses/vulnerabilities present:**
*   **XSS:** The vulnerability allows an attacker to inject and execute arbitrary JavaScript code within the context of the vulnerable website.
*   **RCE:** The potential RCE vulnerability arises from the use of `file_get_contents()` with unsanitized user input.

**Impact of exploitation:**
*   **XSS:** Successful exploitation of the XSS vulnerability could allow attackers to steal user credentials, deface the website, or redirect users to malicious websites.
*   **RCE:**  RCE would allow an attacker to execute arbitrary commands on the server, potentially leading to complete compromise of the system.

**Attack vectors:**
*   **XSS:** The attacker can craft a malicious payload within the specified parameters and trick a user into visiting the `Special:VersionCompare` page, or the attacker could inject malicious code through crafted system messages.
*   **RCE:** The content suggests an attacker could exploit the `file_get_contents()` function, potentially by using PHP wrappers and extensions like `expect`, or by using decompression bombs.

**Required attacker capabilities/position:**
*   **XSS:** The attacker needs to be able to control the content of the `wikiid`, `servername`, `generator`, or extension name parameters, or set specific system messages. They may also need to be able to convince a user to visit a crafted URL.
*   **RCE:** The attacker needs the ability to influence the URL provided to `file_get_contents()`.

**Mitigation or fix:**
*   The content references several patches that address the XSS and RCE vulnerabilities. The patches are available in the Gerrit code review system.

**More detail than the official CVE description:**
*   The content provides detailed attack vectors, specific code locations, and provides example payloads for XSS. It also provides additional details and context.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.247 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.211 |
| 4 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.180 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.170 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.169 |
| 7 | 156 | Improper Neutralization of Whitespace | Variant | Allowed | sparse | 0.167 |
| 8 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | sparse | 0.163 |
| 9 | 838 | Inappropriate Encoding for Output Context | Base | Allowed | dense | 0.595 |
| 10 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-156: Improper Neutralization of Whitespace

CWE-942: Permissive Cross-domain Policy with Untrusted Domains

CWE-838: Inappropriate Encoding for Output Context

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')