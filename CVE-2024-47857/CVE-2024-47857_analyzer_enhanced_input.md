## Vulnerability Description
SSH Communication Security PrivX versions between 18.0-36.0 implement **insufficient validation on public key signatures** when using native SSH connections via a proxy port. This allows an existing PrivX account A to impersonate another existing PrivX account B and gain access to SSH target hosts to which the account B has access.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient validation on public key signatures**
- **impact:** impersonate PrivX account B
- **attacker:** existing PrivX account A
- **product:** PrivX
- **version:** 18.0-36.0
- **component:** native SSH connections via a proxy port

## CVE Reference Links Content Summary
## Analysis of CVE-2024-47857 based on provided content:

The provided content **IS RELATED** to CVE-2024-47857. The document `info.ssh.com_45e2918c_20250624_135533.html` specifically addresses a user impersonation vulnerability in PrivX, identified as CVE-2024-47857.

Here's a breakdown of the vulnerability details extracted from the content:

**Root cause of vulnerability:**

Insufficient validation on public key signatures when using native SSH connections via a proxy port.

**Weaknesses/vulnerabilities present:**

*   Improper validation of public key signatures.
*   Vulnerability exists in PrivX versions between 18.0-36.0.

**Impact of exploitation:**

An attacker can impersonate another PrivX user ("account B") and gain access to SSH target hosts to which "account B" has access.

**Attack vectors:**

*   Attacker must be a PrivX user ("account A") or possess a private key registered for "account A".
*   Attacker must be able to connect to `ssh-mitm` through the proxy port (1080) using HTTP connect or SOCKS5/4a.
*   Attacker must have knowledge of a public key registered for the target user ("account B").
*   Attacker needs an SSH client and specific knowledge.

**Required attacker capabilities/position:**

*   Existing PrivX user or possession of a valid private key for a PrivX user.
*   Network access to the PrivX proxy port.
*   Knowledge of the Secure Shell protocol and PrivX implementation.
*   Knowledge of the target user's public key.

**Mitigation or fix:**

*   Upgrade PrivX to version 35.3, 36.1, 37.0 or later.
*   If upgrading is not immediately possible, block the proxy port (1080) on PrivX nodes if the feature of connecting with a native ssh client via ProxyCommand is not used.

**Additional Details (more than official CVE description):**

*   The vulnerability was discovered through an internal code review.
*   The CVE score is 5.5 (Medium).
*   Attack complexity is high.
*   SSH web client based connections are not affected.
*   Native SSH client connections that do not use ProxyCommand are also unaffected.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.288 |
| 2 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.281 |
| 3 | 798 | Use of Hard-coded Credentials | Base | Allowed | sparse | 0.280 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.279 |
| 5 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.278 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.277 |
| 7 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.276 |
| 8 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.275 |
| 9 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | Allowed | dense | 0.502 |
| 10 | 259 | Use of Hard-coded Password | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-347: Improper Verification of Cryptographic Signature

CWE-522: Insufficiently Protected Credentials

CWE-798: Use of Hard-coded Credentials

CWE-287: Improper Authentication

CWE-321: Use of Hard-coded Cryptographic Key

CWE-863: Incorrect Authorization

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-290: Authentication Bypass by Spoofing

CWE-297: Improper Validation of Certificate with Host Mismatch

CWE-259: Use of Hard-coded Password