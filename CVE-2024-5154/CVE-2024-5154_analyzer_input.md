# Vulnerability Information: CVE-2024-5154

## Vulnerability Description
A flaw was found in cri-o. A malicious container can create a symbolic link to arbitrary files on the host via **directory traversal** (../). This flaw allows the container to read and write to arbitrary files on the host system.

### Vulnerability Description Key Phrases
- **weakness:** **directory traversal**
- **impact:** read and write to arbitrary files
- **attacker:** malicious container
- **product:** cri-o

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of CVE-2024-5154:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a flaw in `cri-o` (Container Runtime Interface - OCI), specifically in the way it handles container mounts. A malicious container can exploit this to create a symbolic link on the host file system. The vulnerability is related to how `cri-o` displays the mounts of a container on the host, allowing for directory traversal using "../" sequences.

**Weaknesses/Vulnerabilities Present:**

*   **Symlink Creation:** A malicious container is able to create a symlink to arbitrary files on the host.
*   **Directory Traversal:** The vulnerability is due to insufficient sanitization or validation of paths provided by the container, enabling directory traversal.

**Impact of Exploitation:**

*   **Arbitrary File Read/Write:** By creating a symlink, the container gains the capability to read and write to arbitrary files on the host system. This allows the attacker to potentially modify critical system files, escalate privileges, and compromise the host.

**Attack Vectors:**

*   **Malicious Container Image:** The attack vector is a malicious container image designed to exploit this vulnerability.
*   **Container Configuration:** The container configuration contributes to the exploit by mounting the malicious symlink.

**Required Attacker Capabilities/Position:**

*   **Ability to Deploy Malicious Container:** An attacker needs the ability to deploy a malicious container image within a system running a vulnerable version of cri-o.
*   **Crafted Container Image:** The attacker needs to craft a container image containing the exploit.
*   **Specific Container Configuration:** The attacker also needs to provide a specific container configuration that leverages the malicious symlink.

**Additional Notes:**
*   The vulnerability is described as allowing a malicious container to create a symbolic link to arbitrary files on the host via directory traversal (“../“), which allows the container to read and write to arbitrary files on the host system.
*   Red Hat has rated this as an "Important" security vulnerability
*   The vulnerability affects multiple versions of Red Hat OpenShift Container Platform
*   Patched versions of `cri-o` are available to remediate the issue (1.30.1, 1.29.5, and 1.28.7).
*   Workarounds are not available.
*   The provided Bugzilla entry confirms that the vulnerability allows symlink creation by a malicious container on the host (specifically, the reproducer created symlink: `/root/mtab -> /proc/mounts` ).
*   The github advisory also confirms the symlink creation on `/host/mtab`.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.321 |
| 3 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.287 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.271 |
| 5 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.256 |
| 6 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.248 |
| 7 | 24 | Path Traversal: '../filedir' | Variant | Allowed | sparse | 0.242 |
| 8 | 62 | UNIX Hard Link | Variant | Allowed | sparse | 0.240 |
| 9 | 25 | Path Traversal: '/../filedir' | Variant | Allowed | dense | 0.604 |
| 10 | 363 | Race Condition Enabling Link Following | Base | Allowed | graph | 0.002 |

