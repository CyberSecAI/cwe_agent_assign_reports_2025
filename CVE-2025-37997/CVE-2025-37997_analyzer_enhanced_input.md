## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved netfilter ipset fix region locking in hash types Region locking introduced in v5.6-rc4 contained three macros to handle the region locks ahash_bucket_start(), ahash_bucket_end() which gave back the start and end hash bucket values belonging to a given region lock and ahash_region() which should give back the region lock belonging to a given hash bucket. The latter was incorrect which can lead to a **race condition** between the garbage collector and adding new elements when a hash type of set is defined with timeouts.

### Vulnerability Description Key Phrases
- **weakness:** **race condition**
- **attacker:** garbage collector and adding new elements
- **product:** Linux kernel
- **component:** netfilter ipset

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.478 |
| 3 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | Variant | Allowed | sparse | 0.453 |
| 4 | 413 | Improper Resource Locking | Base | Allowed | sparse | 0.452 |
| 5 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.444 |
| 6 | 833 | Deadlock | Base | Allowed | sparse | 0.439 |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.428 |
| 8 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.426 |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | Allowed | dense | 0.496 |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-667: Improper Locking

CWE-1222: Insufficient Granularity of Address Regions Protected by Register Locks

CWE-413: Improper Resource Locking

CWE-476: NULL Pointer Dereference

CWE-833: Deadlock

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-407: Inefficient Algorithmic Complexity

CWE-1260: Improper Handling of Overlap Between Protected Memory Ranges

CWE-1325: Improperly Controlled Sequential Memory Allocation