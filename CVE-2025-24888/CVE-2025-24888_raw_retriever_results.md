# Raw Retriever Results for CVE-2025-24888

# Raw Retriever Results for CVE-2025-24888
## Query
The SecureDrop Client is a desktop application for journalists to communicate with sources and work with submissions on the SecureDrop Workstation. Prior to version 0.14.1, a malicious SecureDrop Server could obtain code execution on the SecureDrop Client virtual machine (`sd-app`). SecureDrop Server itself has multiple layers of built-in hardening, and is a dedicated physical machine exposed on the internet only via Tor hidden services for the Source and Journalist interfaces, and optionally via remote SSH access over another Tor hidden service. A newsrooms SecureDrop Workstation communicates only with its own dedicated SecureDrop Server. The SecureDrop Client runs in a dedicated Qubes virtual machine, named `sd-app`, as part of the SecureDrop Workstation. The private OpenPGP key used to decrypt submissions and replies is stored in a separate virtual machine and never accessed directly. The vulnerability lies in the code responsible for downloading replies. The filename of the reply is obtained from the `Content-Disposition` HTTP header and used to write the encrypted reply on disk. Note that filenames are generated and sanitized server-side, and files are downloaded in an encrypted format, so a remote attacker who has not achieved server compromise, such as one posing as a source, could not craft the HTTP response necessary for this attack. While the filename is later checked to guard against path traversal before being moved into the Clients data storage directory, the file has already been written to a potentially arbitrary location. In this case, `safe_move()` would detect the path traversal and fail, leaving the original downloaded file in the attacker-chosen directory. Code execution can be gained by writing an autostart file in `/home/user/.config/autostart/`. Version 0.14.1 fixes the issue. As of time of publication, there is no known evidence of exploitation in the wild. This attack requires a previously compromised SecureDrop Server.

## Keyphrases
- **weakness**: 'path traversal'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4520 | 0.5048 | 0.4732 | 0.4685 | 20 |
| Sparse | 476.8069 | 1434.8638 | 1296.6857 | 1366.4828 | 11 |
| Graph | 1.5210 | 2.5301 | 1.8191 | 1.6236 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.5301 | Allowed |
| 2 | 23 | Relative Path Traversal | base | 2.4700 | Allowed |
| 3 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 4 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 5 | 183 | Permissive List of Allowed Inputs | base | 2.2100 | Allowed |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 2.1066 | Allowed |
| 7 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0856 | Allowed |
| 8 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.6389 | Allowed |
| 11 | 427 | Uncontrolled Search Path Element | Base | 1.6083 | Allowed |
| 12 | 918 | Server-Side Request Forgery (SSRF) | Base | 1.6078 | Allowed |
| 13 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 1.5220 | Allowed |
| 14 | 73 | External Control of File Name or Path | Base | 1.5211 | Allowed |
| 15 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | 0.5048 | 0.5048 | Allowed |
| 2 | 427 | Uncontrolled Search Path Element | Base | 0.5021 | 0.5021 | Allowed |
| 3 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | 0.4985 | 0.4985 | Allowed |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4918 | 0.4918 | Allowed |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.4911 | 0.4911 | Allowed |
| 6 | 494 | Download of Code Without Integrity Check | Base | 0.4908 | 0.4908 | Allowed |
| 7 | 346 | Origin Validation Error | Class | 0.4857 | 0.4857 | Allowed-with-Review |
| 8 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4801 | 0.4801 | Allowed |
| 9 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.4769 | 0.4769 | Allowed |
| 10 | 319 | Cleartext Transmission of Sensitive Information | Base | 0.4750 | 0.4750 | Allowed |
| 11 | 378 | Creation of Temporary File With Insecure Permissions | Base | 0.4620 | 0.4620 | Allowed |
| 12 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | 0.4606 | 0.4606 | Discouraged |
| 13 | 602 | Client-Side Enforcement of Server-Side Security | Class | 0.4591 | 0.4591 | Allowed-with-Review |
| 14 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.4588 | 0.4588 | Allowed |
| 15 | 377 | Insecure Temporary File | Class | 0.4566 | 0.4566 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 1434.8638 | 1434.8638 | Allowed |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | 1413.0712 | 1413.0712 | Allowed |
| 3 | 23 | Relative Path Traversal | 1409.1623 | 1409.1623 | Allowed |
| 4 | 918 | Server-Side Request Forgery (SSRF) | 1378.8657 | 1378.8657 | Allowed |
| 5 | 295 | Improper Certificate Validation | 1367.3437 | 1367.3437 | Allowed |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 1366.4828 | 1366.4828 | Allowed-with-Review |
| 7 | 345 | Insufficient Verification of Data Authenticity | 1361.4262 | 1361.4262 | Discouraged |
| 8 | 321 | Use of Hard-coded Cryptographic Key | 1359.1084 | 1359.1084 | Allowed |
| 9 | 59 | Improper Link Resolution Before File Access ('Link Following') | 1355.4850 | 1355.4850 | Allowed |
| 10 | 863 | Incorrect Authorization | 1340.9270 | 1340.9270 | Allowed-with-Review |
| 11 | 306 | Missing Authentication for Critical Function | 476.8069 | 476.8069 | Allowed |
