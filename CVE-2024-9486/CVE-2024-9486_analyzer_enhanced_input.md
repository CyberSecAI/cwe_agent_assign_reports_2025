## Vulnerability Description
A security issue was discovered in the Kubernetes Image Builder versions <= v0.1.37 where **default credentials are enabled** during the image build process. Virtual machine images built using the Proxmox provider do not disable these default credentials, and nodes using the resulting images may be accessible via these default credentials. The credentials can be used to gain root access. Kubernetes clusters are only affected if their nodes use VM images created via the Image Builder project with its Proxmox provider.

### Vulnerability Description Key Phrases
- **rootcause:** **default credentials are enabled**
- **impact:** gain root access
- **product:** Kubernetes Image Builder
- **version:** <= v0.1.37

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability related to CVE-2024-9486:

**Root Cause of Vulnerability:**

The root cause is the failure to disable or remove default credentials for the `builder` account in VM images built using the Kubernetes Image Builder with the Proxmox provider. During the image build process, default credentials were set but not properly removed at the end.

**Weaknesses/Vulnerabilities Present:**

*   **Default Credentials:** The `builder` account in the generated VM images retains default credentials.
*   **Lack of Cleanup:** The image build process does not properly disable or remove the `builder` account or its credentials after image creation.

**Impact of Exploitation:**

*   **Unauthorized Access:** An attacker can gain unauthorized access to the affected virtual machines via SSH using the default `builder` credentials.
*   **Root Access:** The default credentials provide root access to the compromised VMs.
*   **Full System Compromise:** With root access, an attacker can fully compromise the affected nodes and potentially the entire cluster.

**Attack Vectors:**

*   **Network Access:** An attacker can exploit the vulnerability via network access, using SSH, to connect to the VMs using the known default credentials.

**Required Attacker Capabilities/Position:**

*   **Network Reachability:** The attacker must have network access to the affected virtual machines.
*   **Knowledge of Default Credentials:** The attacker needs to know or guess the default credentials for the 'builder' account

**Additional details:**

*   The vulnerability is specific to VM images built with the Proxmox provider using Kubernetes Image Builder versions <= v0.1.37.
*   The fix involves setting a randomly-generated password for the `builder` account during the build process, and then disabling the account after the build completes.
*   The fix was implemented in Image Builder master and released in v0.1.38.
*   The vulnerability is considered critical with a CVSS score of 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).
*   A temporary mitigation before upgrading is to disable the `builder` account using `usermod -L builder` on affected VMs.
*   The command `last builder` can be used to identify if the vulnerable `builder` account was used for logins.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.535 |
| 2 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.469 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.440 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.435 |
| 5 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.431 |
| 6 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.421 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.420 |
| 8 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.419 |
| 9 | 1392 | Use of Default Credentials | Base | Allowed | dense | 0.516 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-532: Insertion of Sensitive Information into Log File

CWE-306: Missing Authentication for Critical Function

CWE-1390: Weak Authentication

CWE-522: Insufficiently Protected Credentials

CWE-259: Use of Hard-coded Password

CWE-863: Incorrect Authorization

CWE-319: Cleartext Transmission of Sensitive Information

CWE-1392: Use of Default Credentials

CWE-322: Key Exchange without Entity Authentication