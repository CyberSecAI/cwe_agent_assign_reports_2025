# Vulnerability Information: CVE-2025-27787

## Vulnerability Description
Applio is a voice conversion tool. Versions 3.2.8-bugfix and prior are vulnerable to denial of service (DoS) in restart.py. `model_name` in train.py takes user input, and passes it to the `stop_train` function in restart.py, which uses it construct a path to a folder with `config.json`. That `config.json` is opened and the list of values under process_pids are read. Next all the process IDs listed in the JSON are killed. Using one of the arbitrary file writes, one can write to `logs/foobar` a `config.json` file, which contains a list of process IDs. Then one can access this endpoint to kill these processes. Since an attacker cant know what process is running on which process ID, they can send a list of hundreds of process IDs, which can kill the process that applio is using to run, as well as other, potentially important processes, which leads to DoS. Note that constructing a path with user input also enables **path traversal**. For example, by supplying ../../ in `model_name` one can access `config.json` freom locations two folders down on the server. As of time of publication, no known patches are available.

### Vulnerability Description Key Phrases
- **weakness:** **path traversal**
- **impact:** denial of service (DoS) and arbitrary file writes
- **product:** Applio
- **version:** 3.2.8-bugfix and prior
- **component:** restart.py

## CVE Reference Links Content Summary
## CVE-2025-27787: DoS in Applio

**Root cause of vulnerability:**

The `stop_train` function in `restart.py` constructs a path to a `config.json` file using user-supplied input (`model_name`). This file is then read to obtain a list of process IDs, which are subsequently killed.

**Weaknesses/vulnerabilities present:**

*   **Path Traversal:** The use of user input in constructing the file path allows for path traversal vulnerabilities (e.g., using “../../”).
*   **Denial of Service (DoS):** An attacker can manipulate the `config.json` file to include a list of arbitrary process IDs, potentially killing critical system processes and causing a denial of service.
*   **Unvalidated Input:** The `model_name` parameter is not properly validated, allowing an attacker to control the path to the `config.json` file.

**Impact of exploitation:**

Exploitation can lead to a denial of service by killing critical processes.

**Attack vectors:**

*   An attacker can write a malicious `config.json` file to a location accessible via the `model_name` parameter.
*   The attacker then calls the `stop_train` function with the crafted `model_name`, triggering the execution of `os.kill` on the provided process IDs.

**Required attacker capabilities/position:**

The attacker needs to be able to write to a location accessible by the application, and to call the `stop_train` function with a crafted `model_name`.

**Mitigation or fix:**

The advisory does not specify a fix, but suggests input validation and sanitization of the `model_name` parameter to prevent path traversal and arbitrary file access.

**Additional details (more detail than official CVE description):**

*   The vulnerability exists in versions up to and including 3.2.7 of Applio.
*   The vulnerable code is located in `tabs/settings/sections/restart.py` and `tabs/train/train.py`.
*   The advisory provides code snippets illustrating the vulnerable code.
*   The advisory details the coordinated disclosure timeline with the maintainer.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.987 |
| 3 | 73 | External Control of File Name or Path | Base | Allowed | sparse | 0.977 |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.964 |
| 5 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.950 |
| 6 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.941 |
| 7 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.936 |
| 8 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.936 |
| 9 | 214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | dense | 0.529 |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | graph | 0.003 |

