# Vulnerability Information: CVE-2025-30160

## Vulnerability Description
Redlib is an alternative private front-end to Reddit. A vulnerability has been identified in Redlib where an attacker can cause a denial-of-service (DOS) condition by submitting a specially crafted base2048-encoded DEFLATE decompression bomb to the restore_preferences form. This leads to excessive memory consumption and potential system instability, which can be exploited to disrupt Redlib instances. This vulnerability is fixed in 0.36.0.

### Vulnerability Description Key Phrases
- **impact:** denial-of-service (DOS) and memory consumption
- **vector:** specially crafted base2048-encoded DEFLATE decompression bomb
- **attacker:** attacker
- **product:** Redlib
- **component:** restore_preferences form

## CVE Reference Links Content Summary
## Analysis of CVE-2025-30160 based on provided content:

This content is directly related to CVE-2025-30160. It provides significantly more detail than a typical CVE description.

**Root cause of vulnerability:**

The vulnerability stems from the lack of size limits on the decompression of user-supplied data in the `restore_preferences` form. Specifically, a base2048-encoded DEFLATE decompression bomb can be submitted.

**Weaknesses/vulnerabilities present:**

*   **Uncontrolled Resource Consumption:** The application doesn't limit the amount of memory used during decompression.
*   **DEFLATE Bomb:**  Susceptibility to a DEFLATE decompression bomb, where a small compressed input expands to a very large uncompressed output.
*   **Lack of Input Validation:** The application doesn't validate the size of the input before decompression.

**Impact of exploitation:**

*   **Denial of Service (DoS):** Excessive memory consumption can lead to out-of-memory (OOM) conditions, OS-level resource exhaustion, and system crashes.
*   **System Instability:** Repeated exploitation can keep the target system in a degraded state.
*   **Disruption of Service:** Public instances of Redlib can be rendered unavailable.

**Attack vectors:**

*   **Network:** The vulnerability can be exploited remotely over the network.
*   **`restore_preferences` form:**  An attacker submits a malicious payload to the `/settings/encoded-restore` route.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the Redlib instance.
*   **No Privileges Required:** No authentication or special privileges are needed to exploit the vulnerability.

**Mitigation or fix:**

*   **Upgrade to v0.36.0:** The vulnerability is patched in version 0.36.0.
*   **Workarounds (until patching):**
    *   Implement request size limits at the web server or application level.
    *   Disable or restrict the `/settings/encoded-restore` route.
    *   Monitor server logs for unusually large requests and block offending IPs.
*   **Code Changes:** The fix involved adding a timeout to the decompression process and limiting the size of the input. (commits [15147ce](https://github.com/redlib-org/redlib/commit/15147cea8e42f6569a11603d661d71122f6a02dc) and [2e95e1f](https://github.com/redlib-org/redlib/commit/2e95e1fc6e2064ccfae87964b4860bda55eddb9a))

**CVSS Score:** 8.7 (High)

**CVE ID:** CVE-2025-30160

**CWEs:** CWE-400 (Uncontrolled Resource Consumption), CWE-502 (Deserialization Flaws - decompression bomb)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.127 |
| 2 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.125 |
| 3 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.123 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.121 |
| 5 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.119 |
| 6 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.118 |
| 7 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.118 |
| 8 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.118 |
| 9 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | dense | 0.519 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.002 |

