{
  "query": "A vulnerability in langgenius/dify v0.10.1 allows an attacker to take over any account, including administrator accounts, by exploiting a weak pseudo-random number generator (PRNG) used for generating password reset codes. The application uses `random.randint` for this purpose, which is not suitable for cryptographic use and can be cracked. An attacker with access to workflow tools can extract the PRNG output and predict future password reset codes, leading to a complete compromise of the application.",
  "keyphrases": {
    "rootcause": [
      "weak PRNG"
    ]
  },
  "timestamp": "2025-07-14T07:44:41.948123",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "335",
        "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 1.730064417309865,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) but does not correctly manage seeds....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "916",
        "name": "Use of Password Hash With Insufficient Computational Effort",
        "abstraction": "Base",
        "score": 1.7285829373530381,
        "description": "The product generates a hash for a password, but it uses a scheme that does not provide a sufficient level of computational effort that would make password cracking attacks infeasible or expensive....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "338",
        "name": "Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 1.7033150247133613,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not cryptographically strong....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "384",
        "name": "Session Fixation",
        "abstraction": "compound",
        "score": 1.7000000000000002,
        "description": "CWE-384: Session Fixation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "341",
        "name": "Predictable from Observable State",
        "abstraction": "Base",
        "score": 1.6962001606885397,
        "description": "A number or object is predictable based on observations that the attacker can make about the state of the system or network, such as time, process ID, etc....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "386",
        "name": "Symbolic Name not Mapping to Correct Object",
        "abstraction": "base",
        "score": 1.6744000000000003,
        "description": "CWE-386: Symbolic Name not Mapping to Correct Object...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "61",
        "name": "UNIX Symbolic Link (Symlink) Following",
        "abstraction": "compound",
        "score": 1.61,
        "description": "CWE-61: UNIX Symbolic Link (Symlink) Following...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "337",
        "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Variant",
        "score": 1.5402670061527632,
        "description": "A Pseudo-Random Number Generator (PRNG) is initialized from a predictable seed, such as the process ID or system time....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "760",
        "name": "Use of a One-Way Hash with a Predictable Salt",
        "abstraction": "Variant",
        "score": 1.533392599513889,
        "description": "The product uses a one-way cryptographic hash against an input that should not be reversible, such as a password, but the product uses a predictable salt as part of the input....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "339",
        "name": "Small Seed Space in PRNG",
        "abstraction": "Variant",
        "score": 1.4377560941328533,
        "description": "A Pseudo-Random Number Generator (PRNG) uses a relatively small seed space, which makes it more susceptible to brute force attacks....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "base",
        "score": 1.3676000000000001,
        "description": "CWE-476: NULL Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "variant",
        "score": 1.2624,
        "description": "CWE-416: Use After Free...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "abstraction": "Base",
        "score": 1.2243438412934493,
        "description": "The web application does not sufficiently verify inputs that are assumed to be immutable but are actually externally controllable, such as hidden form fields....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "340",
        "name": "Generation of Predictable Numbers or Identifiers",
        "abstraction": "Class",
        "score": 1.0825155733554985,
        "description": "The product uses a scheme that generates numbers or identifiers that are more predictable than required....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "abstraction": "class",
        "score": 1.0304000000000002,
        "description": "CWE-732: Incorrect Permission Assignment for Critical Resource...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "abstraction": "class",
        "score": 1.0304000000000002,
        "description": "CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "441",
        "name": "Unintended Proxy or Intermediary ('Confused Deputy')",
        "abstraction": "class",
        "score": 1.0304000000000002,
        "description": "CWE-441: Unintended Proxy or Intermediary ('Confused Deputy')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "346",
        "name": "Origin Validation Error",
        "abstraction": "class",
        "score": 1.0304000000000002,
        "description": "CWE-346: Origin Validation Error...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "343",
        "name": "Predictable Value Range from Previous Values",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-343: Predictable Value Range from Previous Values...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "342",
        "name": "Predictable Exact Value from Previous Values",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-342: Predictable Exact Value from Previous Values...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "338",
        "name": "Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 0.6243669121608175,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not cryptographically strong....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "335",
        "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 0.5837901669461325,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) but does not correctly manage seeds....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "337",
        "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Variant",
        "score": 0.5781086563979806,
        "description": "A Pseudo-Random Number Generator (PRNG) is initialized from a predictable seed, such as the process ID or system time....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "916",
        "name": "Use of Password Hash With Insufficient Computational Effort",
        "abstraction": "Base",
        "score": 0.5766203601175768,
        "description": "The product generates a hash for a password, but it uses a scheme that does not provide a sufficient level of computational effort that would make password cracking attacks infeasible or expensive....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "760",
        "name": "Use of a One-Way Hash with a Predictable Salt",
        "abstraction": "Variant",
        "score": 0.5562083239387099,
        "description": "The product uses a one-way cryptographic hash against an input that should not be reversible, such as a password, but the product uses a predictable salt as part of the input....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1241",
        "name": "Use of Predictable Algorithm in Random Number Generator",
        "abstraction": "Base",
        "score": 0.5555416089451382,
        "description": "The device uses an algorithm that is predictable and generates a pseudo-random number....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "620",
        "name": "Unverified Password Change",
        "abstraction": "Base",
        "score": 0.5542738974050566,
        "description": "When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1391",
        "name": "Use of Weak Credentials",
        "abstraction": "Class",
        "score": 0.5534183775022865,
        "description": "The product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "640",
        "name": "Weak Password Recovery Mechanism for Forgotten Password",
        "abstraction": "Base",
        "score": 0.5448032098968303,
        "description": "The product contains a mechanism for users to recover or change their passwords without knowing the original password, but the mechanism is weak....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "340",
        "name": "Generation of Predictable Numbers or Identifiers",
        "abstraction": "Class",
        "score": 0.5408900857348846,
        "description": "The product uses a scheme that generates numbers or identifiers that are more predictable than required....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "334",
        "name": "Small Space of Random Values",
        "abstraction": "Base",
        "score": 0.5380527236937966,
        "description": "The number of possible random values is smaller than needed by the product, making it more susceptible to brute force attacks....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "330",
        "name": "Use of Insufficiently Random Values",
        "abstraction": "Class",
        "score": 0.5280774598836473,
        "description": "The product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "759",
        "name": "Use of a One-Way Hash without a Salt",
        "abstraction": "Variant",
        "score": 0.5260010702984642,
        "description": "The product uses a one-way cryptographic hash against an input that should not be reversible, such as a password, but the product does not also use a salt as part of the input....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1240",
        "name": "Use of a Cryptographic Primitive with a Risky Implementation",
        "abstraction": "Base",
        "score": 0.5253799583230628,
        "description": "To fulfill the need for a cryptographic primitive, the product implements a cryptographic algorithm using a non-standard, unproven, or disallowed/non-compliant cryptographic implementation....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1393",
        "name": "Use of Default Password",
        "abstraction": "Base",
        "score": 0.5197408498026397,
        "description": "The product uses default passwords for potentially critical functionality....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "321",
        "name": "Use of Hard-coded Cryptographic Key",
        "abstraction": "Variant",
        "score": 0.5181081999934167,
        "description": "The use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "307",
        "name": "Improper Restriction of Excessive Authentication Attempts",
        "abstraction": "Base",
        "score": 0.5161842854809093,
        "description": "The product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "836",
        "name": "Use of Password Hash Instead of Password for Authentication",
        "abstraction": "Base",
        "score": 0.5160143382327536,
        "description": "The product records password hashes in a data store, receives a hash of a password from a client, and compares the supplied hash to the hash obtained from the data store....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1204",
        "name": "Generation of Weak Initialization Vector (IV)",
        "abstraction": "Base",
        "score": 0.5151967550925369,
        "description": "The product uses a cryptographic primitive that uses an Initialization\n\t\t\tVector (IV), but the product does not generate IVs that are\n\t\t\tsufficiently unpredictable or unique according to the expected\n...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "332",
        "name": "Insufficient Entropy in PRNG",
        "abstraction": "Variant",
        "score": 0.5126436412614013,
        "description": "The lack of entropy available for, or used by, a Pseudo-Random Number Generator (PRNG) can be a stability and security threat....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "338",
        "name": "Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 600.5774975174943,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not cryptographically strong....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "337",
        "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Variant",
        "score": 561.9546939523832,
        "description": "A Pseudo-Random Number Generator (PRNG) is initialized from a predictable seed, such as the process ID or system time....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "335",
        "name": "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Base",
        "score": 554.2687845396582,
        "description": "The product uses a Pseudo-Random Number Generator (PRNG) but does not correctly manage seeds....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "341",
        "name": "Predictable from Observable State",
        "abstraction": "Base",
        "score": 536.9703573363786,
        "description": "A number or object is predictable based on observations that the attacker can make about the state of the system or network, such as time, process ID, etc....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "340",
        "name": "Generation of Predictable Numbers or Identifiers",
        "abstraction": "Class",
        "score": 488.25823047489416,
        "description": "The product uses a scheme that generates numbers or identifiers that are more predictable than required....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "330",
        "name": "Use of Insufficiently Random Values",
        "abstraction": "Class",
        "score": 468.1005508649906,
        "description": "The product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "336",
        "name": "Same Seed in Pseudo-Random Number Generator (PRNG)",
        "abstraction": "Variant",
        "score": 460.2946761514484,
        "description": "A Pseudo-Random Number Generator (PRNG) uses the same seed each time the product is initialized....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "916",
        "name": "Use of Password Hash With Insufficient Computational Effort",
        "abstraction": "Base",
        "score": 451.7113237788567,
        "description": "The product generates a hash for a password, but it uses a scheme that does not provide a sufficient level of computational effort that would make password cracking attacks infeasible or expensive....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1391",
        "name": "Use of Weak Credentials",
        "abstraction": "Class",
        "score": 450.66718751657186,
        "description": "The product uses weak credentials (such as a default key or hard-coded password) that can be calculated, derived, reused, or guessed by an attacker....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "256",
        "name": "Plaintext Storage of a Password",
        "abstraction": "Base",
        "score": 431.1781907711526,
        "description": "Storing a password in plaintext may result in a system compromise....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "259",
        "name": "Use of Hard-coded Password",
        "abstraction": "Variant",
        "score": 141.57172232368498,
        "description": "The product contains a hard-coded password, which it uses for its own inbound authentication or for outbound communication to external components....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.5126436412614013,
      "max": 0.6243669121608175,
      "mean": 0.5441710440554022,
      "median": 0.5394714047143406,
      "count": 20
    },
    "sparse": {
      "min": 141.57172232368498,
      "max": 600.5774975174943,
      "mean": 467.7775650206831,
      "median": 468.1005508649906,
      "count": 11
    },
    "graph": {
      "min": 1.0062,
      "max": 1.730064417309865,
      "mean": 1.3712418827256632,
      "median": 1.4026780470664266,
      "count": 20
    }
  }
}