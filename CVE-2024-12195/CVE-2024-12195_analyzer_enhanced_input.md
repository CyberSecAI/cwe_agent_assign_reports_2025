## Vulnerability Description
The WP Project Manager Task, team, and project management plugin featuring kanban board and gantt charts plugin for WordPress is vulnerable to **SQL Injection** via the project_id parameter of the /wp-json/pm/v2/projects/2/task-lists REST API endpoint in all versions up to, and including, 2.6.16 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, who have been granted access to a project, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL Injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers
- **product:** WP Project Manager Task
- **version:** all versions up to and including 2.6.16
- **component:** /wp-json/pm/v2/projects/2/task-lists REST API endpoint

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-12195:

**1. Verification of CVE Relevance:**

The provided content directly mentions CVE-2024-12195 and its relation to an SQL Injection vulnerability in the "WP Project Manager" WordPress plugin.  The Wordfence analysis also confirms the CVE ID and provides a detailed description, so this content is relevant to the specified CVE.

**2. Root Cause of Vulnerability:**

*   **Insufficient Input Sanitization:** The plugin fails to properly sanitize user input, specifically the `project_id` parameter, before using it in an SQL query.
*   **Lack of Prepared Statements:** The plugin does not use prepared statements with parameterized queries, making it vulnerable to SQL injection when processing the unsanitized input.

**3. Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:**  The core vulnerability is an SQL injection flaw present in the `/wp-json/pm/v2/projects/2/task-lists` REST API endpoint.

**4. Impact of Exploitation:**

*   **Data Breach:**  An attacker can inject malicious SQL code to extract sensitive data from the WordPress database. This could include user credentials, project details, or other confidential information.

**5. Attack Vectors:**

*   **REST API Endpoint:** The vulnerability is accessed via the REST API endpoint `/wp-json/pm/v2/projects/2/task-lists` by manipulating the `project_id` parameter.
*   **Authenticated Attack:** Exploitation requires an attacker to be authenticated with at least "Subscriber" level access.

**6. Required Attacker Capabilities/Position:**

*   **Authentication:**  The attacker must have a valid user account with at least Subscriber access to a WordPress site using the vulnerable plugin.
*   **API Access:** The attacker needs to be able to make requests to the `/wp-json/pm/v2/projects/2/task-lists` REST API endpoint of the plugin.
*   **Knowledge of SQL:** The attacker must have knowledge of SQL syntax to craft a malicious SQL injection payload.

**Additional Details (Beyond the CVE Description):**

*   **Specific Endpoint:** The vulnerability is located within the `Task_List_Controller.php` file specifically when processing the  `project_id` parameter.
*   **Patch Information:** The vulnerability is resolved in version 2.6.17 of the plugin by enhancing input sanitization and resolving the underlying SQL security vulnerability. The plugin update also includes sanitization and integer validation of other parameters.

The information provided also includes a list of files modified in the plugin update, demonstrating the scope of the fix. The plugin developer has also incorporated fixes into other API endpoints that are subject to similar vulnerabilities. These include converting the `per_page`, `page`, `id`, and `milestone_id` parameters into integers using `intval()`, and sanitizing other parameters using functions like `sanitize_text_field()` and `sanitize_file_name()`. Additionally, a function `pm_validate_assignee` has been added to validate and sanitize assignees to prevent the injection of invalid user or role ID's.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.649 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.635 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.626 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.617 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.614 |
| 7 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.598 |
| 8 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.598 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.526 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-863: Incorrect Authorization

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-502: Deserialization of Untrusted Data

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-862: Missing Authorization

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-613: Insufficient Session Expiration