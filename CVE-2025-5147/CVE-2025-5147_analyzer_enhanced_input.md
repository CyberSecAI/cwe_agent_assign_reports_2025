## Vulnerability Description
A vulnerability was found in Netcore NBR1005GPEV2, NBR200V2 and B6V2 up to 20250508 and classified as critical. This issue affects the function tools_ping of the file /usr/bin/network_tools. The manipulation of the argument url leads to **command injection**. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **component:** tools_ping in /usr/bin/network_tools
- **weakness:** **command injection**
- **product:** Netcore NBR1005GPEV2, NBR200V2, and B6V2
- **version:** up to 20250508

## CVE Reference Links Content Summary
CVE-2025-5147 - PLACEHOLDER - Implement CVE description retrieval

The provided content details a command injection vulnerability in Netcore routers (NBR1005GPE, B6, and NBR200). Here's a breakdown of the information:

**Root cause of vulnerability:**

*   The vulnerability stems from a lack of input validation for the `url` parameter in the `tools_ping` function. The `system()` function is called with a string constructed using user-provided input without sanitization.

**Weaknesses/vulnerabilities present:**

*   Command Injection (specifically, a lack of input validation leading to arbitrary command execution).

**Impact of exploitation:**

*   Remote code execution on the router. The proof of concept demonstrates establishing a reverse shell.

**Attack vectors:**

*   Network: An attacker can send a crafted POST request to the `/ubus` endpoint of the vulnerable router.
*   Specifically, the request needs to be formatted as a JSON payload targeting the `network_tools` service and the `tools_ping` method, with a malicious command injected into the `url` parameter.

**Required attacker capabilities/position:**

*   Network access to the vulnerable router.
*   Ability to craft and send HTTP POST requests.
*   Understanding of the router's API and the `ubus` protocol.

**Mitigation or fix:**

*   Implement input validation and sanitization for the `url` parameter in the `tools_ping` function to prevent the injection of arbitrary commands. The report suggests checking for character legitimacy.

**Additional Details (more than official CVE description):**

*   **Affected Products:** NBR1005GPEV2, B6V2, NBR200V2
*   **Firmware Download Links:** Provided for the affected products.
*   **Technical Details:** The report provides a detailed analysis of the vulnerable code, including specific function calls (`sub_401EB8`, `tools_ping`) and the construction of the command string.
*   **POC:** A detailed proof-of-concept (POC) is included, demonstrating how to exploit the vulnerability with example HTTP requests.
*   **Architecture:** The firmware uses `uhttpd` + `ubus` architecture.
*   **Discoverer:** Exploo0Osion.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.423 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.396 |
| 5 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.346 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.339 |
| 7 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.339 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.329 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.663 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-99: Improper Control of Resource Identifiers ('Resource Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-117: Improper Output Neutralization for Logs

CWE-138: Improper Neutralization of Special Elements

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs