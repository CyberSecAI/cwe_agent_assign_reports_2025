## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved cxgb4 fix **memory leak** in cxgb4_init_ethtool_filters() error path In the for loop used to allocate the loc_array and bmap for each port, a **memory leak** is possible when the allocation for loc_array succeeds, but the allocation for bmap fails. This is because when the control flow goes to the label free_eth_finfo, only the allocations starting from (i-1)th iteration are freed. Fix that by freeing the loc_array in the bmap allocation error path.

### Vulnerability Description Key Phrases
- **weakness:** **memory leak**
- **product:** Linux kernel
- **component:** cxgb4

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.459 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.457 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.435 |
| 5 | 415 | Double Free | Variant | Allowed | sparse | 0.432 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.429 |
| 7 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.426 |
| 8 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.422 |
| 9 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | Allowed | dense | 0.467 |
| 10 | 364 | Signal Handler Race Condition | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-789: Memory Allocation with Excessive Size Value

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-415: Double Free

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-909: Missing Initialization of Resource

CWE-190: Integer Overflow or Wraparound

CWE-403: Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak')

CWE-364: Signal Handler Race Condition