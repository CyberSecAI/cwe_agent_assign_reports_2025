# Vulnerability Information: CVE-2024-46997

## Vulnerability Description
DataEase is an open source data visualization analysis tool. Prior to version 2.10.1, an attacker can achieve remote command execution by adding a carefully constructed h2 data source connection string. The vulnerability has been fixed in v2.10.1.

### Vulnerability Description Key Phrases
- **impact:** remote command execution
- **vector:** adding a carefully constructed h2 data source connection string
- **attacker:** attacker
- **product:** DataEase
- **version:** Prior to version 2.10.1

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The vulnerability stems from the lack of proper sanitization of the H2 database connection string within the DataEase application. Specifically, the application allows user-provided input to be directly incorporated into the JDBC connection string without proper validation or escaping, which allows execution of arbitrary SQL and Java code through the `INIT` parameter in the H2 connection string.
- **Weaknesses/vulnerabilities present:**
    - Improper Input Validation: The application fails to sanitize user-supplied connection string parameters, particularly the `INIT` parameter of the H2 JDBC connection string.
    - Code Injection: The vulnerability allows an attacker to inject and execute arbitrary SQL and Java code through the `INIT=RUNSCRIPT FROM` command in the H2 connection string.
    - Remote Command Execution: By crafting a malicious SQL script to create an alias for a Java function (e.g., `shellexec`), the attacker can then use that alias to execute operating system commands on the server.
- **Impact of exploitation:** An attacker can achieve remote command execution on the server where the vulnerable DataEase application is running, potentially leading to full system compromise, data breaches, or denial of service.
- **Attack vectors:**
    - The attacker exploits the vulnerability by sending a crafted POST request to the `/de2api/datasource/validate` endpoint.
    - This request includes a malicious H2 data source configuration containing the exploit.
    - The vulnerable application then processes this request, using the malicious configuration to create a database connection which, in turn, executes the attacker's commands.
- **Required attacker capabilities/position:**
    - The attacker needs network access to the vulnerable DataEase server.
    - The attacker needs to be able to send POST requests to the `/de2api/datasource/validate` endpoint.
    - The attacker doesn't need any special user privileges within the DataEase application.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.070 |
| 2 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.069 |
| 3 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.067 |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.067 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.066 |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.066 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.065 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.065 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.489 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

