# Raw Retriever Results for CVE-2024-42090

# Raw Retriever Results for CVE-2024-42090
## Query
In the Linux kernel, the following vulnerability has been resolved pinctrl fix deadlock in create_pinctrl() when handling -EPROBE_DEFER In create_pinctrl(), pinctrl_maps_mutex is acquired before calling add_setting(). If add_setting() returns -EPROBE_DEFER, create_pinctrl() calls pinctrl_free(). However, pinctrl_free() attempts to acquire pinctrl_maps_mutex, which is already held by create_pinctrl(), leading to a potential deadlock. This patch resolves the issue by releasing pinctrl_maps_mutex before calling pinctrl_free(), preventing the deadlock. This bug was discovered and resolved using Coverity Static Analysis Security Testing (SAST) by Synopsys, Inc.

## Keyphrases
- **rootcause**: 'pinctrl_maps_mutex acquired before calling add_setting()', 'add_setting() returns -EPROBE_DEFER'
- **weakness**: 'deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4304 | 0.5086 | 0.4580 | 0.4497 | 20 |
| Sparse | 271.0951 | 425.1931 | 318.2096 | 299.3009 | 14 |
| Graph | 1.5210 | 2.3998 | 1.7796 | 1.6885 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 663 | Use of a Non-reentrant Function in a Concurrent Context | base | 2.3998 | Allowed |
| 2 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.3868 | Allowed |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | base | 2.1190 | Allowed |
| 4 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 5 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 7 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 8 | 413 | Improper Resource Locking | Base | 1.6986 | Allowed |
| 9 | 833 | Deadlock | Base | 1.6937 | Allowed |
| 10 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 1.6922 | Allowed |
| 11 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 12 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 13 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 14 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 15 | 1231 | Improper Prevention of Lock Bit Modification | Base | 1.6523 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5086 | 0.5086 | Allowed |
| 2 | 413 | Improper Resource Locking | Base | 0.5052 | 0.5052 | Allowed |
| 3 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.4994 | 0.4994 | Allowed |
| 4 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4900 | 0.4900 | Allowed |
| 5 | 667 | Improper Locking | Class | 0.4779 | 0.4779 | Allowed-with-Review |
| 6 | 1191 | On-Chip Debug and Test Interface With Improper Access Control | Base | 0.4683 | 0.4683 | Allowed |
| 7 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4656 | 0.4656 | Allowed |
| 8 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | Variant | 0.4628 | 0.4628 | Allowed |
| 9 | 1232 | Improper Lock Behavior After Power State Transition | Base | 0.4568 | 0.4568 | Allowed |
| 10 | 1262 | Improper Access Control for Register Interface | Base | 0.4541 | 0.4541 | Allowed |
| 11 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4452 | 0.4452 | Allowed |
| 12 | 1247 | Improper Protection Against Voltage and Clock Glitches | Base | 0.4451 | 0.4451 | Allowed |
| 13 | 1189 | Improper Isolation of Shared Resources on System-on-a-Chip (SoC) | Base | 0.4424 | 0.4424 | Allowed |
| 14 | 1296 | Incorrect Chaining or Granularity of Debug Components | Base | 0.4383 | 0.4383 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4371 | 0.4371 | Allowed |

## Sparse Retriever Results (14)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 425.1931 | 425.1931 | Allowed-with-Review |
| 2 | 833 | Deadlock | 418.2809 | 418.2809 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 346.1639 | 346.1639 | Allowed-with-Review |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 306.7969 | 306.7969 | Allowed |
| 5 | 663 | Use of a Non-reentrant Function in a Concurrent Context | 304.3283 | 304.3283 | Allowed |
| 6 | 415 | Double Free | 300.7722 | 300.7722 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | 299.3432 | 299.3432 | Allowed |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 299.2586 | 299.2586 | Allowed |
| 9 | 287 | Improper Authentication | 298.9107 | 298.9107 | Discouraged |
| 10 | 59 | Improper Link Resolution Before File Access ('Link Following') | 298.7116 | 298.7116 | Allowed |
| 11 | 610 | Externally Controlled Reference to a Resource in Another Sphere | 298.2641 | 298.2641 | Discouraged |
| 12 | 755 | Improper Handling of Exceptional Conditions | 294.5118 | 294.5118 | Discouraged |
| 13 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 293.3040 | 293.3040 | Allowed |
| 14 | 770 | Allocation of Resources Without Limits or Throttling | 271.0951 | 271.0951 | Allowed |
