{
  "query": "In the Linux kernel, the following vulnerability has been resolved ila call nf_unregister_net_hooks() sooner syzbot found an use-after-free Read in ila_nf_input [1] Issue here is that ila_xlat_exit_net() frees the rhashtable, then call nf_unregister_net_hooks(). It should be done in the reverse way, with a synchronize_rcu(). This is a good match for a pre_exit() method. [1] BUG KASAN use-after-free in rht_key_hashfn include/linux/rhashtable.h159 [inline] BUG KASAN use-after-free in __rhashtable_lookup include/linux/rhashtable.h604 [inline] BUG KASAN use-after-free in rhashtable_lookup include/linux/rhashtable.h646 [inline] BUG KASAN use-after-free in rhashtable_lookup_fast+0x77a/0x9b0 include/linux/rhashtable.h672 Read of size 4 at addr ffff888064620008 by task ksoftirqd/0/16 CPU 0 UID 0 PID 16 Comm ksoftirqd/0 Not tainted 6.11.0-rc4-syzkaller-00238-g2ad6d23f465a #0 Hardware name Google Google Compute Engine/Google Compute Engine, BIOS Google 08/06/2024 Call Trace __dump_stack lib/dump_stack.c93 [inline] dump_stack_lvl+0x241/0x360 lib/dump_stack.c119 print_address_description mm/kasan/report.c377 [inline] print_report+0x169/0x550 mm/kasan/report.c488 kasan_report+0x143/0x180 mm/kasan/report.c601 rht_key_hashfn include/linux/rhashtable.h159 [inline] __rhashtable_lookup include/linux/rhashtable.h604 [inline] rhashtable_lookup include/linux/rhashtable.h646 [inline] rhashtable_lookup_fast+0x77a/0x9b0 include/linux/r",
  "count": 11,
  "results": [
    {
      "cwe_id": "416",
      "name": "Use After Free",
      "abstraction": "Variant",
      "score": 1000.0,
      "original_score": 1000.0,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "abstraction": "Class",
      "score": 713.9752318450314,
      "original_score": 713.9752318450314,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "415",
      "name": "Double Free",
      "abstraction": "Variant",
      "score": 673.565395826736,
      "original_score": 673.565395826736,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "abstraction": "Base",
      "score": 639.9143513027957,
      "original_score": 639.9143513027957,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "score": 633.7036873461199,
      "original_score": 633.7036873461199,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "abstraction": "Class",
      "score": 610.5617299717835,
      "original_score": 610.5617299717835,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "911",
      "name": "Improper Update of Reference Count",
      "abstraction": "Base",
      "score": 607.6232371714243,
      "original_score": 607.6232371714243,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "252",
      "name": "Unchecked Return Value",
      "abstraction": "Base",
      "score": 598.0763518901604,
      "original_score": 598.0763518901604,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "abstraction": "Base",
      "score": 572.9793550601205,
      "original_score": 572.9793550601205,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "366",
      "name": "Race Condition within a Thread",
      "abstraction": "Base",
      "score": 571.8175434161578,
      "original_score": 571.8175434161578,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "abstraction": "Base",
      "score": 183.15010073714615,
      "original_score": 183.15010073714615,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 183.15010073714615,
    "max": 1000.0,
    "mean": 618.6697258697706,
    "median": 610.5617299717835,
    "count": 11
  }
}