## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved fs/jfs Prevent integer overflow in AG size calculation The JFS filesystem calculates allocation group (AG) size using 1 2TB aggregates on 32-bit systems), this 32-bit shift operation causes **undefined behavior and improper AG sizing**. On 32-bit architectures - Left-shifting 1 by 32+ bits results in 0 due to integer overflow - This creates invalid AG sizes (0 or garbage values) in sbi->bmap->db_agsize - Subsequent block allocations would reference invalid AG structures - Could lead to - Filesystem corruption during extend operations - Kernel crashes due to invalid memory accesses - Security vulnerabilities via malformed on-disk structures Fix by casting to s64 before shifting bmp->db_agsize = (s64)1 << l2agsize This ensures 64-bit arithmetic even on 32-bit architectures. The cast matches the data type of db_agsize (s64) and follows similar patterns in JFS block calculation code. Found by Linux Verification Center (linuxtesting.org) with SVACE.

### Vulnerability Description Key Phrases
- **component:** fs/jfs
- **rootcause:** **undefined behavior and improper AG sizing**
- **vector:** malformed on-disk structures
- **weakness:** **integer overflow, left-shifting 1 by 32+ bits results in 0**
- **product:** Linux kernel
- **impact:** ['Filesystem corruption', 'Kernel crashes due to invalid memory accesses', 'security vulnerabilities']

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 2 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.727 |
| 3 | 194 | Unexpected Sign Extension | Variant | Allowed | sparse | 0.685 |
| 4 | 1335 | Incorrect Bitwise Shift of Integer | Base | Allowed | sparse | 0.665 |
| 5 | 704 | Incorrect Type Conversion or Cast | Class | Allowed-with-Review | sparse | 0.665 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.655 |
| 7 | 681 | Incorrect Conversion between Numeric Types | Base | Allowed | sparse | 0.617 |
| 8 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.585 |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | dense | 0.518 |
| 10 | 195 | Signed to Unsigned Conversion Error | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-190: Integer Overflow or Wraparound

CWE-197: Numeric Truncation Error

CWE-194: Unexpected Sign Extension

CWE-1335: Incorrect Bitwise Shift of Integer

CWE-704: Incorrect Type Conversion or Cast

CWE-125: Out-of-bounds Read

CWE-681: Incorrect Conversion between Numeric Types

CWE-755: Improper Handling of Exceptional Conditions

CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input

CWE-195: Signed to Unsigned Conversion Error