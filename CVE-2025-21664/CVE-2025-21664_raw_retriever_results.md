# Raw Retriever Results for CVE-2025-21664

# Raw Retriever Results for CVE-2025-21664
## Query
In the Linux kernel, the following vulnerability has been resolved dm thin make get_first_thin use rcu-safe list first function The documentation in rculist.h explains the absence of list_empty_rcu() and cautions programmers against relying on a list_empty() -> list_first() sequence in RCU safe code. This is because each of these functions performs its own READ_ONCE() of the list head. This can lead to a situation where the list_empty() sees a valid list entry, but the subsequent list_first() sees a different view of list head state after a modification. In the case of dm-thin, this author had a production box crash from a GP fault in the process_deferred_bios path. This function saw a valid list head in get_first_thin() but when it subsequently dereferenced that and turned it into a thin_c, it got the inside of the struct pool, since the list was now empty and referring to itself. The kernel on which this occurred printed both a warning about a refcount_t being saturated, and a UBSAN error for an out-of-bounds cpuid access in the queued spinlock, prior to the fault itself. When the resulting kdump was examined, it was possible to see another thread patiently waiting in thin_dtrs synchronize_rcu. The thin_dtr call managed to pull the thin_c out of the active thins list (and have it be the last entry in the active_thins list) at just the wrong moment which lead to this crash. Fortunately, the fix here is straight forward. Switch get_first_thin() function to use list_first_or_null_rcu() which performs just a single READ_ONCE() and returns NULL if the list is already empty. This was run against the devicemapper test suites thin-provisioning suites for delete and suspend and no regressions were observed.

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4078 | 0.4666 | 0.4254 | 0.4170 | 20 |
| Sparse | 428.6934 | 466.2512 | 441.4772 | 438.7025 | 10 |
| Graph | 1.6314 | 2.8210 | 1.9565 | 1.8917 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 125 | Out-of-bounds Read | base | 2.8210 | Allowed |
| 2 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 3 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 4 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 5 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 6 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 7 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 9 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 10 | 476 | NULL Pointer Dereference | Base | 2.0155 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | base | 1.7680 | Allowed |
| 12 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 13 | 787 | Out-of-bounds Write | base | 1.7680 | Allowed |
| 14 | 826 | Premature Release of Resource During Expected Lifetime | base | 1.6848 | Allowed |
| 15 | 1341 | Multiple Releases of Same Resource or Handle | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.4666 | 0.4666 | Allowed-with-Review |
| 2 | 667 | Improper Locking | Class | 0.4543 | 0.4543 | Allowed-with-Review |
| 3 | 366 | Race Condition within a Thread | Base | 0.4432 | 0.4432 | Allowed |
| 4 | 911 | Improper Update of Reference Count | Base | 0.4427 | 0.4427 | Allowed |
| 5 | 413 | Improper Resource Locking | Base | 0.4387 | 0.4387 | Allowed |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4380 | 0.4380 | Allowed-with-Review |
| 7 | 908 | Use of Uninitialized Resource | Base | 0.4341 | 0.4341 | Allowed |
| 8 | 822 | Untrusted Pointer Dereference | Base | 0.4324 | 0.4324 | Allowed |
| 9 | 606 | Unchecked Input for Loop Condition | Base | 0.4248 | 0.4248 | Allowed |
| 10 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4202 | 0.4202 | Allowed |
| 11 | 363 | Race Condition Enabling Link Following | Base | 0.4138 | 0.4138 | Allowed |
| 12 | 457 | Use of Uninitialized Variable | Variant | 0.4137 | 0.4137 | Allowed |
| 13 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4133 | 0.4133 | Allowed |
| 14 | 763 | Release of Invalid Pointer or Reference | Base | 0.4130 | 0.4130 | Allowed |
| 15 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.4120 | 0.4120 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 476 | NULL Pointer Dereference | 466.2512 | 466.2512 | Allowed |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | 452.9878 | 452.9878 | Allowed |
| 3 | 863 | Incorrect Authorization | 449.0868 | 449.0868 | Allowed-with-Review |
| 4 | 125 | Out-of-bounds Read | 444.3236 | 444.3236 | Allowed |
| 5 | 909 | Missing Initialization of Resource | 440.3563 | 440.3563 | Allowed-with-Review |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 437.0486 | 437.0486 | Allowed-with-Review |
| 7 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 433.7760 | 433.7760 | Allowed-with-Review |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 432.9479 | 432.9479 | Allowed |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | 429.3008 | 429.3008 | Allowed |
| 10 | 184 | Incomplete List of Disallowed Inputs | 428.6934 | 428.6934 | Allowed |
