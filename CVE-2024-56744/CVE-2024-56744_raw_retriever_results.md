# Raw Retriever Results for CVE-2024-56744

# Raw Retriever Results for CVE-2024-56744
## Query
In the Linux kernel, the following vulnerability has been resolved f2fs fix to avoid potential deadlock in f2fs_record_stop_reason() syzbot reports deadlock issue of f2fs as below ====================================================== WARNING possible circular locking dependency detected 6.12.0-rc3-syzkaller-00087-gc964ced77262 #0 Not tainted ------------------------------------------------------ kswapd0/79 is trying to acquire lock ffff888011824088 (&sbi->sb_lock){++++}-{33}, at f2fs_down_write fs/f2fs/f2fs.h2199 [inline] ffff888011824088 (&sbi->sb_lock){++++}-{33}, at f2fs_record_stop_reason+0x52/0x1d0 fs/f2fs/super.c4068 but task is already holding lock ffff88804bd92610 (sb_internal#2){.+.+}-{00}, at f2fs_evict_inode+0x662/0x15c0 fs/f2fs/inode.c842 which lock already depends on the new lock. the existing dependency chain (in reverse order) is -> #2 (sb_internal#2){.+.+}-{00} lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c5825 percpu_down_read include/linux/percpu-rwsem.h51 [inline] __sb_start_write include/linux/fs.h1716 [inline] sb_start_intwrite+0x4d/0x1c0 include/linux/fs.h1899 f2fs_evict_inode+0x662/0x15c0 fs/f2fs/inode.c842 evict+0x4e8/0x9b0 fs/inode.c725 f2fs_evict_inode+0x1a4/0x15c0 fs/f2fs/inode.c807 evict+0x4e8/0x9b0 fs/inode.c725 dispose_list fs/inode.c774 [inline] prune_icache_sb+0x239/0x2f0 fs/inode.c963 super_cache_scan+0x38c/0x4b0 fs/super.c223 do_shrink_slab+0x701/0x1160 mm/shrinker.c435 shrink_slab+0x1093/0x14d0 mm/shrinker.c662 shrink_one+0x43b/0x850 mm/vmscan.c4818 shrink_many mm/vmscan.c4879 [inline] lru_gen_shrink_node mm/vmscan.c4957 [inline] shrink_node+0x3799/0x3de0 mm/vmscan.c5937 kswapd_shrink_node mm/vmscan.c6765 [inline] balance_pgdat mm/vmscan.c6957 [inline] kswapd+0x1ca3/0x3700 mm/vmscan.c7226 kthread+0x2f0/0x390 kernel/kthread.c389 ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S244 -> #1 (fs_reclaim){+.+.}-{00} lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c5825 __fs_reclaim_acquire mm/page_alloc.c3834 [inline] fs_reclaim_acquire+0x88/0x130 mm/page_alloc.c3848 might_alloc include/linux/sched/mm.h318 [inline] prepare_alloc_pages+0x147/0x5b0 mm/page_alloc.c4493 __alloc_pages_noprof+0x16f/0x710 mm/page_alloc.c4722 alloc_pages_mpol_noprof+0x3e8/0x680 mm/mempolicy.c2265 alloc_pages_noprof mm/mempolicy.c2345 [inline] folio_alloc_noprof+0x128/0x180 mm/mempolicy.c2352 filemap_alloc_folio_noprof+0xdf/0x500 mm/filemap.c1010 do_read_cache_folio+0x2eb/0x850 mm/filemap.c3787 read_mapping_folio include/linux/pagemap.h1011 [inline] f2fs_commit_super+0x3c0/0x7d0 fs/f2fs/super.c4032 f2fs_record_stop_reason+0x13b/0x1d0 fs/f2fs/super.c4079 f2fs_handle_critical_error+0x2ac/0x5c0 fs/f2fs/super.c4174 f2fs_write_inode+0x35f/0x4d0 fs/f2fs/inode.c785 write_inode fs/fs-writeback.c1503 [inline] __writeback_single_inode+0x711/0x10d0 fs/fs-writeback.c1723 writeback_single_inode+0x1f3/0x660 fs/fs-writeback.c1779 sync_inode_metadata+0xc4/0x120 fs/fs-writeback.c2849 f2fs_release_file+0xa8/0x100 fs/f2fs/file.c1941 __fput+0x23f/0x880 fs/file_table.c431 task_work_run+0x24f/0x310 kernel/task_work.c228 resume_user_mode_work include/linux/resume_user_mode.h50 [inline] exit_to_user_mode_loop kernel/entry/common.c114 [inline] exit_to_user_mode_prepare include/linux/entry-common.h328 [inline] __syscall_exit_to_user_mode_work kernel/entry/common.c207 [inline] syscall_exit_to_user_mode+0x168/0x370 kernel/entry/common.c218 do_syscall_64+0x100/0x230 arch/x86/entry/common.c89 entry_SYSCALL_64_after_hwframe+0x77/0x7f ---truncated---

## Keyphrases
- **weakness**: 'deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5170 | 0.5963 | 0.5359 | 0.5274 | 20 |
| Sparse | 539.6738 | 863.2057 | 711.9015 | 764.5335 | 10 |
| Graph | 1.3010 | 2.1190 | 1.6621 | 1.6796 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 392 | Missing Report of Error Condition | base | 2.1190 | Allowed |
| 2 | 763 | Release of Invalid Pointer or Reference | base | 2.1190 | Allowed |
| 3 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 4 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 5 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 6 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 7 | 833 | Deadlock | Base | 1.7401 | Allowed |
| 8 | 590 | Free of Memory not on the Heap | variant | 1.7117 | Allowed |
| 9 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 10 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 11 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 12 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 13 | 609 | Double-Checked Locking | base | 1.5912 | Allowed |
| 14 | 908 | Use of Uninitialized Resource | Base | 1.5675 | Allowed |
| 15 | 476 | NULL Pointer Dereference | Base | 1.5640 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5963 | 0.5963 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.5952 | 0.5952 | Allowed-with-Review |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5786 | 0.5786 | Allowed-with-Review |
| 4 | 909 | Missing Initialization of Resource | Class | 0.5487 | 0.5487 | Allowed-with-Review |
| 5 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5389 | 0.5389 | Allowed |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.5345 | 0.5345 | Allowed |
| 7 | 416 | Use After Free | Variant | 0.5330 | 0.5330 | Allowed |
| 8 | 908 | Use of Uninitialized Resource | Base | 0.5292 | 0.5292 | Allowed |
| 9 | 190 | Integer Overflow or Wraparound | Base | 0.5286 | 0.5286 | Allowed |
| 10 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.5285 | 0.5285 | Allowed |
| 11 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5263 | 0.5263 | Allowed |
| 12 | 366 | Race Condition within a Thread | Base | 0.5250 | 0.5250 | Allowed |
| 13 | 911 | Improper Update of Reference Count | Base | 0.5250 | 0.5250 | Allowed |
| 14 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5208 | 0.5208 | Discouraged |
| 15 | 126 | Buffer Over-read | Variant | 0.5206 | 0.5206 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 863.2057 | 863.2057 | Allowed-with-Review |
| 2 | 833 | Deadlock | 837.6688 | 837.6688 | Allowed |
| 3 | 912 | Hidden Functionality | 781.4735 | 781.4735 | Allowed-with-Review |
| 4 | 763 | Release of Invalid Pointer or Reference | 774.8281 | 774.8281 | Allowed |
| 5 | 392 | Missing Report of Error Condition | 772.4862 | 772.4862 | Allowed |
| 6 | 288 | Authentication Bypass Using an Alternate Path or Channel | 756.5808 | 756.5808 | Allowed |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 635.0296 | 635.0296 | Allowed |
| 8 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 587.2353 | 587.2353 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 570.8329 | 570.8329 | Allowed-with-Review |
| 10 | 506 | Embedded Malicious Code | 539.6738 | 539.6738 | Allowed-with-Review |
