{
  "query": "In the Linux kernel, the following vulnerability has been resolved f2fs fix to avoid potential deadlock in f2fs_record_stop_reason() syzbot reports deadlock issue of f2fs as below ====================================================== WARNING possible circular locking dependency detected 6.12.0-rc3-syzkaller-00087-gc964ced77262 #0 Not tainted ------------------------------------------------------ kswapd0/79 is trying to acquire lock ffff888011824088 (&sbi->sb_lock){++++}-{33}, at f2fs_down_write fs/f2fs/f2fs.h2199 [inline] ffff888011824088 (&sbi->sb_lock){++++}-{33}, at f2fs_record_stop_reason+0x52/0x1d0 fs/f2fs/super.c4068 but task is already holding lock ffff88804bd92610 (sb_internal#2){.+.+}-{00}, at f2fs_evict_inode+0x662/0x15c0 fs/f2fs/inode.c842 which lock already depends on the new lock. the existing dependency chain (in reverse order) is -> #2 (sb_internal#2){.+.+}-{00} lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c5825 percpu_down_read include/linux/percpu-rwsem.h51 [inline] __sb_start_write include/linux/fs.h1716 [inline] sb_start_intwrite+0x4d/0x1c0 include/linux/fs.h1899 f2fs_evict_inode+0x662/0x15c0 fs/f2fs/inode.c842 evict+0x4e8/0x9b0 fs/inode.c725 f2fs_evict_inode+0x1a4/0x15c0 fs/f2fs/inode.c807 evict+0x4e8/0x9b0 fs/inode.c725 dispose_list fs/inode.c774 [inline] prune_icache_sb+0x239/0x2f0 fs/inode.c963 super_cache_scan+0x38c/0x4b0 fs/super.c223 do_shrink_slab+0x701/0x1160 mm/shrinker.c435 shrink_slab+0x1093/0x14d0 mm/shrinker.c662 shrink_one+0x43b/0x850 mm/vmscan.c4818 shrink_many mm/vmscan.c4879 [inline] lru_gen_shrink_node mm/vmscan.c4957 [inline] shrink_node+0x3799/0x3de0 mm/vmscan.c5937 kswapd_shrink_node mm/vmscan.c6765 [inline] balance_pgdat mm/vmscan.c6957 [inline] kswapd+0x1ca3/0x3700 mm/vmscan.c7226 kthread+0x2f0/0x390 kernel/kthread.c389 ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c147 ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S244 -> #1 (fs_reclaim){+.+.}-{00} lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c5825 __fs_reclaim_acquire mm/page_alloc.c3834 [inline] fs_reclaim_acquire+0x88/0x130 mm/page_alloc.c3848 might_alloc include/linux/sched/mm.h318 [inline] prepare_alloc_pages+0x147/0x5b0 mm/page_alloc.c4493 __alloc_pages_noprof+0x16f/0x710 mm/page_alloc.c4722 alloc_pages_mpol_noprof+0x3e8/0x680 mm/mempolicy.c2265 alloc_pages_noprof mm/mempolicy.c2345 [inline] folio_alloc_noprof+0x128/0x180 mm/mempolicy.c2352 filemap_alloc_folio_noprof+0xdf/0x500 mm/filemap.c1010 do_read_cache_folio+0x2eb/0x850 mm/filemap.c3787 read_mapping_folio include/linux/pagemap.h1011 [inline] f2fs_commit_super+0x3c0/0x7d0 fs/f2fs/super.c4032 f2fs_record_stop_reason+0x13b/0x1d0 fs/f2fs/super.c4079 f2fs_handle_critical_error+0x2ac/0x5c0 fs/f2fs/super.c4174 f2fs_write_inode+0x35f/0x4d0 fs/f2fs/inode.c785 write_inode fs/fs-writeback.c1503 [inline] __writeback_single_inode+0x711/0x10d0 fs/fs-writeback.c1723 writeback_single_inode+0x1f3/0x660 fs/fs-writeback.c1779 sync_inode_metadata+0xc4/0x120 fs/fs-writeback.c2849 f2fs_release_file+0xa8/0x100 fs/f2fs/file.c1941 __fput+0x23f/0x880 fs/file_table.c431 task_work_run+0x24f/0x310 kernel/task_work.c228 resume_user_mode_work include/linux/resume_user_mode.h50 [inline] exit_to_user_mode_loop kernel/entry/common.c114 [inline] exit_to_user_mode_prepare include/linux/entry-common.h328 [inline] __syscall_exit_to_user_mode_work kernel/entry/common.c207 [inline] syscall_exit_to_user_mode+0x168/0x370 kernel/entry/common.c218 do_syscall_64+0x100/0x230 arch/x86/entry/common.c89 entry_SYSCALL_64_after_hwframe+0x77/0x7f ---truncated---",
  "keyphrases": {
    "weakness": [
      "deadlock"
    ]
  },
  "timestamp": "2025-07-12T06:44:03.469814",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "392",
        "name": "Missing Report of Error Condition",
        "abstraction": "base",
        "score": 2.1189999999999998,
        "description": "CWE-392: Missing Report of Error Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "763",
        "name": "Release of Invalid Pointer or Reference",
        "abstraction": "base",
        "score": 2.1189999999999998,
        "description": "CWE-763: Release of Invalid Pointer or Reference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "456",
        "name": "Missing Initialization of a Variable",
        "abstraction": "variant",
        "score": 1.83936,
        "description": "CWE-456: Missing Initialization of a Variable...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "123",
        "name": "Write-what-where Condition",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-123: Write-what-where Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "364",
        "name": "Signal Handler Race Condition",
        "abstraction": "base",
        "score": 1.7550000000000001,
        "description": "CWE-364: Signal Handler Race Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "833",
        "name": "Deadlock",
        "abstraction": "Base",
        "score": 1.7400509977237055,
        "description": "The product contains multiple threads or executable segments that are waiting for each other to release a necessary lock, resulting in deadlock....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "590",
        "name": "Free of Memory not on the Heap",
        "abstraction": "variant",
        "score": 1.71168,
        "description": "CWE-590: Free of Memory not on the Heap...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1325",
        "name": "Improperly Controlled Sequential Memory Allocation",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1325: Improperly Controlled Sequential Memory Allocation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1265",
        "name": "Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1265: Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "386",
        "name": "Symbolic Name not Mapping to Correct Object",
        "abstraction": "base",
        "score": 1.6744000000000003,
        "description": "CWE-386: Symbolic Name not Mapping to Correct Object...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "662",
        "name": "Improper Synchronization",
        "abstraction": "class",
        "score": 1.6736000000000002,
        "description": "CWE-662: Improper Synchronization...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "609",
        "name": "Double-Checked Locking",
        "abstraction": "base",
        "score": 1.5912000000000004,
        "description": "CWE-609: Double-Checked Locking...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "908",
        "name": "Use of Uninitialized Resource",
        "abstraction": "Base",
        "score": 1.567463711705937,
        "description": "The product uses or accesses a resource that has not been initialized....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "Base",
        "score": 1.5640239281849024,
        "description": "The product dereferences a pointer that it expects to be valid but is NULL....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1285",
        "name": "Improper Validation of Specified Index, Position, or Offset in Input",
        "abstraction": "Base",
        "score": 1.5159915524204817,
        "description": "The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the spe...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "Variant",
        "score": 1.461830735499468,
        "description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a locati...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "912",
        "name": "Hidden Functionality",
        "abstraction": "class",
        "score": 1.3648,
        "description": "CWE-912: Hidden Functionality...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "129",
        "name": "Improper Validation of Array Index",
        "abstraction": "Variant",
        "score": 1.3382240004978483,
        "description": "The product uses untrusted input when calculating or using an array index, but the product does not validate or incorrectly validates the index to ensure the index references a valid position within t...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "134",
        "name": "Use of Externally-Controlled Format String",
        "abstraction": "base",
        "score": 1.3010400000000002,
        "description": "CWE-134: Use of Externally-Controlled Format String...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "833",
        "name": "Deadlock",
        "abstraction": "Base",
        "score": 0.5962789159547586,
        "description": "The product contains multiple threads or executable segments that are waiting for each other to release a necessary lock, resulting in deadlock....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "667",
        "name": "Improper Locking",
        "abstraction": "Class",
        "score": 0.595183244980609,
        "description": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "abstraction": "Class",
        "score": 0.578603998153264,
        "description": "The product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code ...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "909",
        "name": "Missing Initialization of Resource",
        "abstraction": "Class",
        "score": 0.5487051140123889,
        "description": "The product does not initialize a critical resource....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1285",
        "name": "Improper Validation of Specified Index, Position, or Offset in Input",
        "abstraction": "Base",
        "score": 0.538943624379518,
        "description": "The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the spe...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "abstraction": "Base",
        "score": 0.534531036388254,
        "description": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can ca...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "Variant",
        "score": 0.5330034716761809,
        "description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a locati...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "908",
        "name": "Use of Uninitialized Resource",
        "abstraction": "Base",
        "score": 0.5291885155099877,
        "description": "The product uses or accesses a resource that has not been initialized....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "190",
        "name": "Integer Overflow or Wraparound",
        "abstraction": "Base",
        "score": 0.5286337402114625,
        "description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "835",
        "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
        "abstraction": "Base",
        "score": 0.528503564881755,
        "description": "The product contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "191",
        "name": "Integer Underflow (Wrap or Wraparound)",
        "abstraction": "Base",
        "score": 0.5263434796952681,
        "description": "The product subtracts one value from another, such that the result is less than the minimum allowable integer value, which produces a value that is not equal to the correct result....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "366",
        "name": "Race Condition within a Thread",
        "abstraction": "Base",
        "score": 0.5250448801081685,
        "description": "If two threads of execution use a resource simultaneously, there exists the possibility that resources may be used while invalid, in turn making the state of execution undefined....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "911",
        "name": "Improper Update of Reference Count",
        "abstraction": "Base",
        "score": 0.5249816474089369,
        "description": "The product uses a reference count to manage a resource, but it does not update or incorrectly updates the reference count....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "119",
        "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
        "abstraction": "Class",
        "score": 0.5207612513889344,
        "description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected m...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "126",
        "name": "Buffer Over-read",
        "abstraction": "Variant",
        "score": 0.5206063055686577,
        "description": "The product reads from a buffer using buffer access mechanisms such as indexes or pointers that reference memory locations after the targeted buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 0.5187028419866668,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "122",
        "name": "Heap-based Buffer Overflow",
        "abstraction": "Variant",
        "score": 0.5184404449881207,
        "description": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine suc...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "Base",
        "score": 0.5175189573374832,
        "description": "The product dereferences a pointer that it expects to be valid but is NULL....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "Base",
        "score": 0.5172716614145079,
        "description": "The product reads data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "131",
        "name": "Incorrect Calculation of Buffer Size",
        "abstraction": "Base",
        "score": 0.5170284063395478,
        "description": "The product does not correctly calculate the size to be used when allocating a buffer, which could lead to a buffer overflow....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "667",
        "name": "Improper Locking",
        "abstraction": "Class",
        "score": 863.2056823186919,
        "description": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "833",
        "name": "Deadlock",
        "abstraction": "Base",
        "score": 837.6688310587255,
        "description": "The product contains multiple threads or executable segments that are waiting for each other to release a necessary lock, resulting in deadlock....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "912",
        "name": "Hidden Functionality",
        "abstraction": "Class",
        "score": 781.4734832135642,
        "description": "The product contains functionality that is not documented, not part of the specification, and not accessible through an interface or command sequence that is obvious to the product's users or administ...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "763",
        "name": "Release of Invalid Pointer or Reference",
        "abstraction": "Base",
        "score": 774.8280846178395,
        "description": "The product attempts to return a memory resource to the system, but it calls the wrong release function or calls the appropriate release function incorrectly....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "392",
        "name": "Missing Report of Error Condition",
        "abstraction": "Base",
        "score": 772.4862000988269,
        "description": "The product encounters an error but does not provide a status code or return value to indicate that an error has occurred....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "288",
        "name": "Authentication Bypass Using an Alternate Path or Channel",
        "abstraction": "Base",
        "score": 756.5807777027904,
        "description": "The product requires authentication, but the product has an alternate path or channel that does not require authentication....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "abstraction": "Base",
        "score": 635.0296253956536,
        "description": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can ca...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "835",
        "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
        "abstraction": "Base",
        "score": 587.2352770134313,
        "description": "The product contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "abstraction": "Class",
        "score": 570.8328740938457,
        "description": "The product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code ...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "506",
        "name": "Embedded Malicious Code",
        "abstraction": "Class",
        "score": 539.6738485285349,
        "description": "The product contains code that appears to be malicious in nature....",
        "mapping_usage": "Allowed-with-Review"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.5170284063395478,
      "max": 0.5962789159547586,
      "mean": 0.5359137551192236,
      "median": 0.5274235222885115,
      "count": 20
    },
    "sparse": {
      "min": 539.6738485285349,
      "max": 863.2056823186919,
      "mean": 711.9014684041905,
      "median": 764.5334889008086,
      "count": 10
    },
    "graph": {
      "min": 1.3010400000000002,
      "max": 2.1189999999999998,
      "mean": 1.662113246301617,
      "median": 1.6796000000000002,
      "count": 20
    }
  }
}