{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved vfs Dont evict inode under the inode lru traversing context The inode reclaiming process(See function prune_icache_sb) collects all reclaimable inodes and mark them with I_FREEING flag at first, at that time, other processes will be stuck if they try getting these inodes (See function find_inode_fast), then the reclaiming process destroy the inodes by function dispose_list(). Some filesystems(eg. ext4 with ea_inode feature, ubifs with xattr) may do inode lookup in the inode evicting callback function, if the inode lookup is operated under the inode lru traversing context, deadlock problems may happen. Case 1 In function ext4_evict_inode(), the ea inode lookup could happen if ea_inode feature is enabled, the lookup process will be stuck under the evicting context like this 1. File A has inode i_reg and an ea inode i_ea 2. getfattr(A, xattr_buf) // i_ea is added into lru // lru->i_ea 3. Then, following three processes running like this PA PB echo 2 > /proc/sys/vm/drop_caches shrink_slab prune_dcache_sb // i_reg is added into lru, lru->i_ea->i_reg prune_icache_sb list_lru_walk_one inode_lru_isolate i_ea->i_state |= I_FREEING // set inode state inode_lru_isolate __iget(i_reg) spin_unlock(&i_reg->i_lock) spin_unlock(lru_lock) rm file A i_",
  "keyphrases": {
    "rootcause": [
      "inode lookup in the inode evicting callback function"
    ]
  },
  "timestamp": "2025-07-12 04:18:38",
  "cve_id": "CVE-2024-45003",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "775",
      "name": "Missing Release of File Descriptor or Handle after Effective Lifetime",
      "score": 940.5898303870263,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "917",
      "name": "Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')",
      "score": 677.0128047845176,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "score": 635.7117333290822,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "79",
      "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "score": 622.0016621728889,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "379",
      "name": "Creation of Temporary File in Directory with Insecure Permissions",
      "score": 618.5129626395523,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 609.7686656064777,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "61",
      "name": "UNIX Symbolic Link (Symlink) Following",
      "score": 608.3413427383007,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 607.5771338724664,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "122",
      "name": "Heap-based Buffer Overflow",
      "score": 606.6202072963356,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "1333",
      "name": "Inefficient Regular Expression Complexity",
      "score": 606.1084061588039,
      "search_source": "rootcause:inode lookup in the inode evicting callback function"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 191.199009203079,
      "search_source": "base_query"
    }
  ]
}