# Raw Retriever Results for CVE-2024-45003

# Raw Retriever Results for CVE-2024-45003
## Query
In the Linux kernel, the following vulnerability has been resolved vfs Dont evict inode under the inode lru traversing context The inode reclaiming process(See function prune_icache_sb) collects all reclaimable inodes and mark them with I_FREEING flag at first, at that time, other processes will be stuck if they try getting these inodes (See function find_inode_fast), then the reclaiming process destroy the inodes by function dispose_list(). Some filesystems(eg. ext4 with ea_inode feature, ubifs with xattr) may do inode lookup in the inode evicting callback function, if the inode lookup is operated under the inode lru traversing context, deadlock problems may happen. Case 1 In function ext4_evict_inode(), the ea inode lookup could happen if ea_inode feature is enabled, the lookup process will be stuck under the evicting context like this 1. File A has inode i_reg and an ea inode i_ea 2. getfattr(A, xattr_buf) // i_ea is added into lru // lru->i_ea 3. Then, following three processes running like this PA PB echo 2 > /proc/sys/vm/drop_caches shrink_slab prune_dcache_sb // i_reg is added into lru, lru->i_ea->i_reg prune_icache_sb list_lru_walk_one inode_lru_isolate i_ea->i_state |= I_FREEING // set inode state inode_lru_isolate __iget(i_reg) spin_unlock(&i_reg->i_lock) spin_unlock(lru_lock) rm file A i_

## Keyphrases
- **rootcause**: 'inode lookup in the inode evicting callback function'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3831 | 0.4335 | 0.4063 | 0.4013 | 20 |
| Sparse | 191.1990 | 940.5898 | 611.2222 | 609.7687 | 11 |
| Graph | 1.5210 | 2.3998 | 1.9073 | 1.8974 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.3998 | Allowed |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 3 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 4 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 5 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 7 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | base | 2.1190 | Allowed |
| 8 | 379 | Creation of Temporary File in Directory with Insecure Permissions | base | 2.1190 | Allowed |
| 9 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | variant | 2.0400 | Allowed |
| 10 | 911 | Improper Update of Reference Count | Base | 2.0268 | Allowed |
| 11 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 12 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 13 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.6968 | Allowed |
| 14 | 1341 | Multiple Releases of Same Resource or Handle | base | 1.6848 | Allowed |
| 15 | 826 | Premature Release of Resource During Expected Lifetime | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4335 | 0.4335 | Allowed |
| 2 | 911 | Improper Update of Reference Count | Base | 0.4319 | 0.4319 | Allowed |
| 3 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.4288 | 0.4288 | Allowed |
| 4 | 667 | Improper Locking | Class | 0.4279 | 0.4279 | Allowed-with-Review |
| 5 | 763 | Release of Invalid Pointer or Reference | Base | 0.4241 | 0.4241 | Allowed |
| 6 | 909 | Missing Initialization of Resource | Class | 0.4235 | 0.4235 | Allowed-with-Review |
| 7 | 833 | Deadlock | Base | 0.4172 | 0.4172 | Allowed |
| 8 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4157 | 0.4157 | Allowed |
| 9 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4101 | 0.4101 | Allowed |
| 10 | 773 | Missing Reference to Active File Descriptor or Handle | Variant | 0.4035 | 0.4035 | Allowed |
| 11 | 590 | Free of Memory not on the Heap | Variant | 0.3992 | 0.3992 | Allowed |
| 12 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.3989 | 0.3989 | Allowed-with-Review |
| 13 | 910 | Use of Expired File Descriptor | Base | 0.3945 | 0.3945 | Allowed |
| 14 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.3909 | 0.3909 | Allowed |
| 15 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | 0.3896 | 0.3896 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | 940.5898 | 940.5898 | Allowed |
| 2 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | 677.0128 | 677.0128 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 635.7117 | 635.7117 | Allowed |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 622.0017 | 622.0017 | Allowed |
| 5 | 379 | Creation of Temporary File in Directory with Insecure Permissions | 618.5130 | 618.5130 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | 609.7687 | 609.7687 | Allowed |
| 7 | 61 | UNIX Symbolic Link (Symlink) Following | 608.3413 | 608.3413 | Allowed |
| 8 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 607.5771 | 607.5771 | Allowed |
| 9 | 122 | Heap-based Buffer Overflow | 606.6202 | 606.6202 | Allowed |
| 10 | 1333 | Inefficient Regular Expression Complexity | 606.1084 | 606.1084 | Allowed |
| 11 | 667 | Improper Locking | 191.1990 | 191.1990 | Allowed-with-Review |
