## Vulnerability Description
An attacker could, via a specially crafted multipart response, execute arbitrary JavaScript under the `resource//pdf.js` origin. This could allow them to access cross-origin PDF content. This access is limited to same site documents by the Site Isolation feature on desktop clients, but full cross-origin access is possible on Android versions. This vulnerability affects Firefox < 131, Firefox ESR < 128.3, Firefox ESR < 115.16, Thunderbird < 128.3, and Thunderbird < 131.

### Vulnerability Description Key Phrases
- **impact:** execute arbitrary JavaScript
- **vector:** specially crafted multipart response
- **attacker:** attacker
- **product:** Firefox and Firefox ESR and Thunderbird
- **version:** < 131 and < 128.3 and < 115.16 and < 128.3 and < 131

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-NVD-Other

#### Top CWEs
- CWE-NVD-Other (Count: 6)

## CVE Reference Links Content Summary
```
{
  "CVE-2024-9393": {
    "Root cause": "A vulnerability related to specially crafted multipart responses.",
    "Weaknesses": [
      "Cross-origin access to PDF content"
    ],
    "Impact": "An attacker can execute arbitrary JavaScript under the `resource://pdf.js` origin, potentially accessing cross-origin PDF content. On desktop, access is limited to same-site documents due to Site Isolation; however, full cross-origin access is possible on Android versions.",
    "Attack vectors": [
      "Specially crafted multipart response"
    ],
        "Required attacker capabilities/position": "The attacker needs to be able to deliver a malicious multipart response to the vulnerable application."

  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1007 | Insufficient Visual Distinction of Homoglyphs Presented to User | Base | Allowed | alternate_terms | 0.700 |
| 2 | 1021 | Improper Restriction of Rendered UI Layers or Frames | Base | Allowed | alternate_terms | 0.700 |
| 3 | 1022 | Use of Web Link to Untrusted Target with window.opener Access | Variant | Allowed | alternate_terms | 0.700 |
| 4 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.141 |
| 5 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.138 |
| 6 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.136 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.134 |
| 8 | 1385 | Missing Origin Validation in WebSockets | Variant | Allowed | sparse | 0.133 |
| 9 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | dense | 0.566 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1007: Insufficient Visual Distinction of Homoglyphs Presented to User

CWE-1021: Improper Restriction of Rendered UI Layers or Frames

CWE-1022: Use of Web Link to Untrusted Target with window.opener Access

CWE-787: Out-of-bounds Write

CWE-346: Origin Validation Error

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-1385: Missing Origin Validation in WebSockets

CWE-942: Permissive Cross-domain Policy with Untrusted Domains

CWE-494: Download of Code Without Integrity Check