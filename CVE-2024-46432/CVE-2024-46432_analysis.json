{
  "cve_id": "CVE-2024-46432",
  "description": "Tenda W18E V16.01.0.8(1625) is vulnerable to **Incorrect Access Control**. An attacker can send a specially crafted HTTP POST request to the setQuickCfgWifiAndLogin function, which allows unauthorized changes to WiFi configuration settings and administrative credentials.",
  "key_phrases": {
    "rootcause": "Incorrect Access Control",
    "weakness": "",
    "impact": "unauthorized changes to WiFi configuration settings and administrative credentials",
    "vector": "specially crafted HTTP POST request",
    "attacker": "",
    "product": "Tenda W18E",
    "version": "V16.01.0.8(1625)",
    "component": "setQuickCfgWifiAndLogin function"
  },
  "reference_content": null,
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-862 | Missing Authorization | 0.8 | Base | Allowed | Primary CWE: The application lacks authorization checks, allowing unauthorized access to functionality. |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Allowed | Secondary Candidate: Could be relevant if there's no authentication at all for the vulnerable function. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship influencing the decision is the differentiation between authentication (CWE-306) and authorization (CWE-862). Given the description states \"**Incorrect Access Control**\" that allows unauthorized changes, the vulnerability leans towards missing authorization checks rather than a complete lack of authentication. CWE-862 (Missing Authorization) is a child of CWE-284 (Improper Access Control) and is more specific, hence a better fit. CWE-306 could be a contributing factor if the function lacked authentication entirely, but the evidence is not strong enough to support this.\n\n```mermaid\ngraph TD\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    \n    cwe862 -->|CHILDOF| cwe284\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe862 primary\n    class cwe284,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **Incorrect Access Control**, specifically the **missing authorization** check in the `setQuickCfgWifiAndLogin` function (CWE-862). This allows an attacker to send a crafted HTTP POST request, leading to the impact of unauthorized changes to WiFi configuration and administrative credentials.\n\n## Summary of Analysis\nInitially, the description indicates \"**Incorrect Access Control**\" which could point to a variety of CWEs. However, the details of the vulnerability suggest a lack of authorization checks in the `setQuickCfgWifiAndLogin` function. This is supported by the ability to make unauthorized changes to WiFi settings and administrative credentials. The primary assessment is based on the vulnerability description key phrase \"**Incorrect Access Control**\" and the impact description \"unauthorized changes to WiFi configuration settings and administrative credentials\".\n\nCWE-862 (Missing Authorization) is chosen because it specifically addresses the scenario where an application does not check if the user is authorized to perform an action. The description does not explicitly mention a bypassed authentication, but a missing authorization.\n\nOther CWEs considered but not used:\n\n*   CWE-284: Improper Access Control - This is a high-level category and less specific than CWE-862.\n*   CWE-306: Missing Authentication for Critical Function - Could be relevant if there was absolutely no authentication, but the description points more towards missing authorization.\n*   CWE-863: Incorrect Authorization - This would apply if there was an authorization check, but it was flawed.\n*   CWE-425: Direct Request ('Forced Browsing') - Although a crafted HTTP POST request is mentioned, the core issue is the lack of authorization, not just direct access to a resource.\n*   CWE-472: External Control of Assumed-Immutable Web Parameter - Not applicable because the issue isn't about manipulating immutable parameters.\n*   CWE-639: Authorization Bypass Through User-Controlled Key - This is not applicable because the vulnerability description doesn't mention keys.\n\nThe selected CWE is at the optimal level of specificity because it directly addresses the root cause which is the missing authorization check.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-862 | Missing Authorization | 0.8 | Base | Allowed | Primary CWE: The application lacks authorization checks, allowing unauthorized access to functionality. |\n| CWE-306 | Missing Authentication for Critical Function | 0.6 | Base | Allowed | Secondary Candidate: Could be relevant if there's no authentication at all for the vulnerable function. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship influencing the decision is the differentiation between authentication (CWE-306) and authorization (CWE-862). Given the description states \"**Incorrect Access Control**\" that allows unauthorized changes, the vulnerability leans towards missing authorization checks rather than a complete lack of authentication. CWE-862 (Missing Authorization) is a child of CWE-284 (Improper Access Control) and is more specific, hence a better fit. CWE-306 could be a contributing factor if the function lacked authentication entirely, but the evidence is not strong enough to support this.\n\n```mermaid\ngraph TD\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    \n    cwe862 -->|CHILDOF| cwe284\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe862 primary\n    class cwe284,cwe306 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **Incorrect Access Control**, specifically the **missing authorization** check in the `setQuickCfgWifiAndLogin` function (CWE-862). This allows an attacker to send a crafted HTTP POST request, leading to the impact of unauthorized changes to WiFi configuration and administrative credentials.\n\n## Summary of Analysis\nInitially, the description indicates \"**Incorrect Access Control**\" which could point to a variety of CWEs. However, the details of the vulnerability suggest a lack of authorization checks in the `setQuickCfgWifiAndLogin` function. This is supported by the ability to make unauthorized changes to WiFi settings and administrative credentials. The primary assessment is based on the vulnerability description key phrase \"**Incorrect Access Control**\" and the impact description \"unauthorized changes to WiFi configuration settings and administrative credentials\".\n\nCWE-862 (Missing Authorization) is chosen because it specifically addresses the scenario where an application does not check if the user is authorized to perform an action. The description does not explicitly mention a bypassed authentication, but a missing authorization.\n\nOther CWEs considered but not used:\n\n*   CWE-284: Improper Access Control - This is a high-level category and less specific than CWE-862.\n*   CWE-306: Missing Authentication for Critical Function - Could be relevant if there was absolutely no authentication, but the description points more towards missing authorization.\n*   CWE-863: Incorrect Authorization - This would apply if there was an authorization check, but it was flawed.\n*   CWE-425: Direct Request ('Forced Browsing') - Although a crafted HTTP POST request is mentioned, the core issue is the lack of authorization, not just direct access to a resource.\n*   CWE-472: External Control of Assumed-Immutable Web Parameter - Not applicable because the issue isn't about manipulating immutable parameters.\n*   CWE-639: Authorization Bypass Through User-Controlled Key - This is not applicable because the vulnerability description doesn't mention keys.\n\nThe selected CWE is at the optimal level of specificity because it directly addresses the root cause which is the missing authorization check.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-862:**\n- 862 (Missing Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 253.38859351137586
    },
    {
      "metadata": {
        "doc_id": "425",
        "name": "Direct Request ('Forced Browsing')",
        "source": "sparse"
      },
      "similarity": 244.45313398784347
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 229.80384089973154
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 228.50678659307283
    },
    {
      "metadata": {
        "doc_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "source": "sparse"
      },
      "similarity": 227.3645911143259
    },
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "sparse"
      },
      "similarity": 224.7897329063057
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 223.54302774073423
    },
    {
      "metadata": {
        "doc_id": "78",
        "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
        "source": "sparse"
      },
      "similarity": 222.71616467888117
    },
    {
      "metadata": {
        "doc_id": "259",
        "name": "Use of Hard-coded Password",
        "type": "Variant",
        "original_content": "The product contains a hard-coded password, which it uses for its own inbound authentication or for outbound communication to external components.",
        "keyphrase_source": "rootcause:Incorrect Access Control",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.553915480898831,
            "graph": 2.2415342359050987
          }
        }
      },
      "similarity": 0.553915480898831
    },
    {
      "doc_id": "471",
      "text": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
      "score": 2.7196000000000002,
      "metadata": {
        "doc_id": "471",
        "name": "Modification of Assumed-Immutable Data (MAID)",
        "type": "base",
        "original_content": "CWE-471: Modification of Assumed-Immutable Data (MAID)",
        "relationships": [
          {
            "source_id": "471",
            "target_id": "621",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "607",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "602",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "473",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "472",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "425",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "291",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1321",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "1282",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "471",
            "target_id": "664",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "664",
            "target_id": "471",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "621",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "607",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "602",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "473",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "472",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "425",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "291",
            "target_id": "471",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1321",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1282",
            "target_id": "471",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.5599999999999999,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_up",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "425"
            },
            "abstraction_path_up": {
              "path": [
                [
                  "472",
                  "471",
                  "CHILDOF"
                ]
              ],
              "score": 0.5599999999999999,
              "type": "abstraction_path_up",
              "source": "472"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "425",
                  "471",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "425"
            }
          }
        },
        "abstraction_level": "base",
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.7196000000000002
          }
        }
      },
      "similarity": 2.7196000000000002
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-862",
      "CWE-639",
      "CWE-306",
      "CWE-472",
      "CWE-284",
      "CWE-425"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}