# Raw Retriever Results for CVE-2024-52293

# Raw Retriever Results for CVE-2024-52293
## Query
Craft is a content management system (CMS). Prior to 4.12.2 and 5.4.3, Craft is missing normalizePath in the function FileHelperabsolutePath could lead to Remote Code Execution on the server via twig SSTI. This is a sequel to CVE-2023-40035. This vulnerability is fixed in 4.12.2 and 5.4.3.

## Keyphrases
- **rootcause**: 'missing normalizePath in the function FileHelperabsolutePath'
- **weakness**: 'server-side template injection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4964 | 0.6133 | 0.5292 | 0.5212 | 20 |
| Sparse | 296.3178 | 1000.0000 | 376.3393 | 337.7133 | 14 |
| Graph | 1.3676 | 3.1356 | 1.7889 | 1.7170 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 94 | Improper Control of Generation of Code ('Code Injection') | base | 3.1356 | Allowed-with-Review |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 2.3069 | Allowed |
| 3 | 613 | Insufficient Session Expiration | base | 2.0930 | Allowed |
| 4 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 5 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 2.0400 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | base | 1.7680 | Allowed |
| 7 | 184 | Incomplete List of Disallowed Inputs | base | 1.7680 | Allowed |
| 8 | 59 | Improper Link Resolution Before File Access ('Link Following') | base | 1.7680 | Allowed |
| 9 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 1.7277 | Allowed |
| 10 | 36 | Absolute Path Traversal | Base | 1.7181 | Allowed |
| 11 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | 1.7159 | Allowed |
| 12 | 425 | Direct Request ('Forced Browsing') | Base | 1.6808 | Allowed |
| 13 | 473 | PHP External Variable Modification | variant | 1.6320 | Allowed |
| 14 | 456 | Missing Initialization of a Variable | variant | 1.6320 | Allowed |
| 15 | 73 | External Control of File Name or Path | Base | 1.5493 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | 0.6133 | 0.6133 | Allowed |
| 2 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | 0.5723 | 0.5723 | Allowed |
| 3 | 36 | Absolute Path Traversal | Base | 0.5684 | 0.5684 | Allowed |
| 4 | 24 | Path Traversal: '../filedir' | Variant | 0.5606 | 0.5606 | Allowed |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 0.5557 | 0.5557 | Allowed |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | 0.5481 | 0.5481 | Allowed |
| 7 | 425 | Direct Request ('Forced Browsing') | Base | 0.5347 | 0.5347 | Allowed |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.5281 | 0.5281 | Allowed |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5267 | 0.5267 | Allowed |
| 10 | 23 | Relative Path Traversal | Base | 0.5253 | 0.5253 | Allowed |
| 11 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 0.5172 | 0.5172 | Allowed |
| 12 | 50 | Path Equivalence: '//multiple/leading/slash' | Variant | 0.5100 | 0.5100 | Allowed |
| 13 | 73 | External Control of File Name or Path | Base | 0.5097 | 0.5097 | Allowed |
| 14 | 552 | Files or Directories Accessible to External Parties | Base | 0.5087 | 0.5087 | Allowed |
| 15 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.5066 | 0.5066 | Allowed |

## Sparse Retriever Results (14)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 1000.0000 | 1000.0000 | Allowed |
| 2 | 138 | Improper Neutralization of Special Elements | 363.0567 | 363.0567 | Discouraged |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | 345.6496 | 345.6496 | Allowed-with-Review |
| 4 | 862 | Missing Authorization | 342.5895 | 342.5895 | Allowed-with-Review |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 340.7835 | 340.7835 | Allowed |
| 6 | 502 | Deserialization of Untrusted Data | 340.2265 | 340.2265 | Allowed |
| 7 | 248 | Uncaught Exception | 339.0549 | 339.0549 | Allowed |
| 8 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | 336.3717 | 336.3717 | Allowed |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | 334.9752 | 334.9752 | Allowed |
| 10 | 121 | Stack-based Buffer Overflow | 333.4382 | 333.4382 | Allowed |
| 11 | 918 | Server-Side Request Forgery (SSRF) | 301.4904 | 301.4904 | Allowed |
| 12 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | 298.1739 | 298.1739 | Discouraged |
| 13 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 296.6217 | 296.6217 | Allowed |
| 14 | 184 | Incomplete List of Disallowed Inputs | 296.3178 | 296.3178 | Allowed |
