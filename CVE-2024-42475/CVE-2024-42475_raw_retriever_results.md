# Raw Retriever Results for CVE-2024-42475

# Raw Retriever Results for CVE-2024-42475
## Query
In the OAuth library for nim prior to version 0.11, the `state` values generated by the `generateState` function do not have sufficient entropy. These can be successfully guessed by an attacker allowing them to perform a CSRF vs a user, associating the users session with the attackers protected resources. While `state` isnt exactly a cryptographic value, it should be generated in a cryptographically secure way. `generateState` should be using a CSPRNG. Version 0.11 modifies the `generateState` function to generate `state` values of at least 128 bits of entropy while using a CSPRNG.

## Keyphrases
- **rootcause**: 'the state values generated by the generateState function do not have sufficient entropy'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4218 | 0.5608 | 0.4672 | 0.4654 | 20 |
| Sparse | 152.0885 | 687.0827 | 535.4155 | 536.9296 | 11 |
| Graph | 0.7936 | 2.2100 | 1.1430 | 0.9986 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 804 | Guessable CAPTCHA | base | 2.2100 | Allowed |
| 2 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | 1.7278 | Allowed |
| 3 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | 1.7161 | Allowed |
| 4 | 334 | Small Space of Random Values | Base | 1.7050 | Allowed |
| 5 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | 1.5168 | Allowed |
| 6 | 332 | Insufficient Entropy in PRNG | Variant | 1.3720 | Allowed |
| 7 | 330 | Use of Insufficiently Random Values | Class | 1.0552 | Discouraged |
| 8 | 344 | Use of Invariant Value in Dynamically Changing Context | base | 1.0062 | Allowed |
| 9 | 798 | Use of Hard-coded Credentials | base | 1.0062 | Allowed |
| 10 | 1392 | Use of Default Credentials | base | 1.0062 | Allowed |
| 11 | 1391 | Use of Weak Credentials | Class | 0.9909 | Allowed-with-Review |
| 12 | 6 | J2EE Misconfiguration: Insufficient Session-ID Length | variant | 0.9624 | Allowed |
| 13 | 341 | Predictable from Observable State | Base | 0.9269 | Allowed |
| 14 | 331 | Insufficient Entropy | Base | 0.8275 | Allowed |
| 15 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | 0.8164 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | 0.5608 | 0.5608 | Allowed |
| 2 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | Base | 0.5254 | 0.5254 | Allowed |
| 3 | 332 | Insufficient Entropy in PRNG | Variant | 0.5164 | 0.5164 | Allowed |
| 4 | 334 | Small Space of Random Values | Base | 0.4960 | 0.4960 | Allowed |
| 5 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | Variant | 0.4942 | 0.4942 | Allowed |
| 6 | 336 | Same Seed in Pseudo-Random Number Generator (PRNG) | Variant | 0.4896 | 0.4896 | Allowed |
| 7 | 331 | Insufficient Entropy | Base | 0.4854 | 0.4854 | Allowed |
| 8 | 339 | Small Seed Space in PRNG | Variant | 0.4842 | 0.4842 | Allowed |
| 9 | 341 | Predictable from Observable State | Base | 0.4783 | 0.4783 | Allowed |
| 10 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | 0.4743 | 0.4743 | Allowed |
| 11 | 333 | Improper Handling of Insufficient Entropy in TRNG | Variant | 0.4564 | 0.4564 | Allowed |
| 12 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | 0.4514 | 0.4514 | Allowed |
| 13 | 329 | Generation of Predictable IV with CBC Mode | Variant | 0.4383 | 0.4383 | Allowed |
| 14 | 759 | Use of a One-Way Hash without a Salt | Variant | 0.4310 | 0.4310 | Allowed |
| 15 | 323 | Reusing a Nonce, Key Pair in Encryption | Base | 0.4309 | 0.4309 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 687.0827 | 687.0827 | Allowed |
| 2 | 338 | Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) | 668.3244 | 668.3244 | Allowed |
| 3 | 330 | Use of Insufficiently Random Values | 624.8077 | 624.8077 | Discouraged |
| 4 | 1391 | Use of Weak Credentials | 578.9617 | 578.9617 | Allowed-with-Review |
| 5 | 337 | Predictable Seed in Pseudo-Random Number Generator (PRNG) | 554.6876 | 554.6876 | Allowed |
| 6 | 331 | Insufficient Entropy | 536.9296 | 536.9296 | Allowed |
| 7 | 1204 | Generation of Weak Initialization Vector (IV) | 530.0474 | 530.0474 | Allowed |
| 8 | 203 | Observable Discrepancy | 527.0266 | 527.0266 | Allowed |
| 9 | 201 | Insertion of Sensitive Information Into Sent Data | 515.1458 | 515.1458 | Allowed |
| 10 | 451 | User Interface (UI) Misrepresentation of Critical Information | 514.4681 | 514.4681 | Allowed-with-Review |
| 11 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 152.0885 | 152.0885 | Allowed-with-Review |
