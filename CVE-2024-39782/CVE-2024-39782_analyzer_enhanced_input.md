## Vulnerability Description
Multiple OS **command injection** vulnerabilities exist in the adm.cgi sch_reboot() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to a arbitrary code execution. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.A ****command injection** vulnerability** exists in the `restart_min` POST parameter.

### Vulnerability Description Key Phrases
- **rootcause:** **command injection vulnerability**
- **weakness:** **command injection**
- **impact:** arbitrary code execution
- **vector:** specially crafted HTTP request
- **product:** Wavlink AC3000 M33A8
- **version:** V5030.210505
- **component:** adm.cgi sch_reboot() functionality

## CVE Reference Links Content Summary
## Analysis of CVE-2024-39782 based on provided content:

This content **relates** to CVE-2024-39782, and provides significantly more detail than the placeholder CVE description.

**Root cause of vulnerability:**

The vulnerability stems from improper neutralization of special elements in commands passed to the `sch_reboot()` function within the `adm.cgi` binary of the Wavlink AC3000 router. Specifically, the `restart_hour`, `restart_min`, and `restart_week` POST parameters are not properly sanitized before being incorporated into a crontab entry.

**Weaknesses/vulnerabilities present:**

*   **Command Injection (CWE-77):** The lack of input validation allows an attacker to inject arbitrary commands into the crontab, leading to potential code execution.

**Impact of exploitation:**

Successful exploitation allows an attacker to execute arbitrary code on the router, potentially leading to complete system compromise.

**Attack vectors:**

*   An attacker can send a specially crafted HTTP POST request to the `adm.cgi` script with malicious values for the `restart_hour`, `restart_min`, or `restart_week` parameters.
*   The attacker needs to be authenticated to the router's web interface.

**Required attacker capabilities/position:**

*   Network access to the Wavlink AC3000 router.
*   Valid credentials for the router's web interface (authenticated access).
*   Understanding of crontab syntax to craft a malicious payload.

**Mitigation or fix:**

The report does not explicitly state a fix, but implies that proper input validation and sanitization of the `restart_hour`, `restart_min`, and `restart_week` parameters are necessary to prevent the vulnerability. The vendor was contacted and is working on patches, but the product has been discontinued.

**Specific CVE details:**

*   **CVE-2024-39781:** Relates to injection via the `restart_hour` parameter.
*   **CVE-2024-39782:** Relates to injection via the `restart_min` parameter.
*   **CVE-2024-39783:** Relates to injection via the `restart_week` parameter.

**Confirmed Vulnerable Versions:**

*   Wavlink AC3000 M33A8.V5030.210505

**CVSSv3 Score:** 9.1 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.385 |
| 4 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.373 |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.363 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.357 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.338 |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.332 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.623 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-134: Use of Externally-Controlled Format String

CWE-1287: Improper Validation of Specified Type of Input

CWE-790: Improper Filtering of Special Elements

CWE-138: Improper Neutralization of Special Elements

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs