## Vulnerability Description
A vulnerability classified as critical was found in D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04 up to 20240814. Affected by this vulnerability is the function cgi_FMT_Std2R5_2nd_DiskMGR of the file /cgi-bin/hd_config.cgi. The manipulation of the argument f_source_dev leads to **command injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. NOTE This vulnerability only affects products that are no longer supported by the maintainer. NOTE Vendor was contacted early and confirmed that the product is end-of-life. It should be retired and replaced.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** D-Link DNS-120 and DNR-202L and DNS-315L and DNS-320 and DNS-320L and DNS-320LW and DNS-321 and DNR-322L and DNS-323 and DNS-325 and DNS-326 and DNS-327L and DNR-326 and DNS-340L and DNS-343 and DNS-345 and DNS-726-4 and DNS-1100-4 and DNS-1200-05 and DNS-1550-04
- **version:** up to 20240814
- **component:** cgi_FMT_Std2R5_2nd_DiskMGR in /cgi-bin/hd_config.cgi

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-78

#### Top CWEs
- CWE-78 (Count: 10)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
*   The vulnerability stems from a command injection flaw in the `cgi_FMT_Std2R5_2nd_DiskMGR` function within the `/cgi-bin/hd_config.cgi` file of D-Link NAS devices.
*   The `f_source_dev` variable, obtained from a POST request, is incorporated into a command executed by the `system()` function. This is done via `sprintf` without proper sanitization.

**Weaknesses/Vulnerabilities Present:**
*   **Command Injection:** The primary vulnerability is command injection, which allows an attacker to execute arbitrary system commands.
*   **Lack of Input Sanitization:** The code doesn't sanitize or validate the input received in the `f_source_dev` parameter before using it in a system command.

**Impact of Exploitation:**
*   **Arbitrary Command Execution:** A successful exploit would give an attacker the ability to execute arbitrary commands on the affected device, potentially leading to:
    *   Complete system compromise
    *   Data theft
    *   Malware installation
    *   Denial-of-service

**Attack Vectors:**
*   **HTTP POST Request:** The vulnerability is triggered by sending a malicious POST request to `/cgi-bin/hd_config.cgi` and including a crafted payload in the `f_source_dev` parameter.
*   **Web Configuration Interface:** The vulnerable function is part of the device's web configuration interface.

**Required Attacker Capabilities/Position:**
*   **Network Access:** An attacker needs to have network access to the affected D-Link NAS device, potentially requiring:
    *   Being on the same local network
    *   Access through exposed ports/services on the internet, if the device is directly exposed.
*   **HTTP Knowledge:** The attacker must be able to craft and send HTTP POST requests.

**Additional Notes:**
*   The affected devices are end-of-life (EOL) and are no longer supported by D-Link, meaning no official patches will be released to address this issue.
*   D-Link recommends retiring and replacing the affected devices.
*   The vulnerability is present in all firmware versions of the affected models.
*   This vulnerability is tracked as [CVE-2024-3273](https://nvd.nist.gov/vuln/detail/CVE-2024-3273?ref=news.risky.biz).
*   The information provided by the VulDB community submission aligns with the information in the D-Link Security Advisory.
*   The vulnerability was reported by multiple sources, including VulDB CNA Team, Netsefish, and BuaaIOTTeam.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.728 |
| 4 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.686 |
| 5 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.660 |
| 6 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | sparse | 0.654 |
| 7 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | sparse | 0.648 |
| 8 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | Variant | Allowed | sparse | 0.646 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.656 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-346: Origin Validation Error

CWE-330: Use of Insufficiently Random Values

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

CWE-941: Incorrectly Specified Destination in a Communication Channel

CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action

CWE-121: Stack-based Buffer Overflow

CWE-322: Key Exchange without Entity Authentication