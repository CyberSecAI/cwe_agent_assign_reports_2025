## Vulnerability Description
rPGP is a pure Rust implementation of OpenPGP. Prior to 0.14.1, rPGP allows attackers to trigger **resource exhaustion vulnerabilities** in rpgp by providing crafted messages. This affects general message parsing and decryption with symmetric keys.

### Vulnerability Description Key Phrases
- **weakness:** **resource exhaustion vulnerabilities**
- **vector:** crafted messages
- **attacker:** attackers
- **product:** rPGP
- **version:** Prior to 0.14.1

## CVE Reference Links Content Summary
- **Root cause of vulnerability:**
  - Insufficient upper limits on the total reserved amount of memory when parsing long sequences of partial OpenPGP packets.
  - Excessive memory allocation for fixed-size OpenPGP packets with large length fields, even if less data is received.
  - Lack of restrictions on Argon2 parameters within the `Symmetric Key Encrypted Session Key` (SKESK) packet processing.
- **Weaknesses/vulnerabilities present:**
  - Resource exhaustion due to excessive memory allocation.
  - Denial of service (DoS) due to memory exhaustion.
  - Potential system instability due to memory exhaustion.
  - Long processing times due to excessive Argon2 computations.
- **Impact of exploitation:**
  - Out-of-memory conditions leading to program crashes.
  - System instability due to memory resource exhaustion.
  - Program unresponsiveness due to long computations.
- **Attack vectors:**
  - Network-based attack where an attacker sends crafted OpenPGP messages.
- **Required attacker capabilities/position:**
  - The attacker needs to be able to send crafted OpenPGP messages to a victim.
  - The attacker does not need knowledge of the symmetric secret used by the victim for the Argon2-based attack.

The provided content offers more detail than the basic CVE description by specifying the root causes, the vulnerable components (message parsing, symmetric key decryption with Argon2), and the different attack vectors.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.212 |
| 3 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.206 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.192 |
| 5 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.191 |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.186 |
| 7 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | Allowed | sparse | 0.175 |
| 8 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.174 |
| 9 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | dense | 0.443 |
| 10 | 476 | NULL Pointer Dereference | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-400: Uncontrolled Resource Consumption

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-789: Memory Allocation with Excessive Size Value

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-674: Uncontrolled Recursion

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-835: Loop with Unreachable Exit Condition ('Infinite Loop')

CWE-203: Observable Discrepancy

CWE-335: Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)

CWE-476: NULL Pointer Dereference