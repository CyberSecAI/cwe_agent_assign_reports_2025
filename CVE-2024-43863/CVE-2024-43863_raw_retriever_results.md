# Raw Retriever Results for CVE-2024-43863

# Raw Retriever Results for CVE-2024-43863
## Query
In the Linux kernel, the following vulnerability has been resolved drm/vmwgfx Fix a deadlock in dma buf fence polling Introduce a version of the fence ops that on release doesnt remove the fence from the pending list, and thus doesnt require a lock to fix poll->fence wait->fence unref deadlocks. vmwgfx overwrites the wait callback to iterate over the list of all fences and update their status, to do that it holds a lock to prevent the list modifcations from other threads. The fence destroy callback both deletes the fence and removes it from the list of pending fences, for which it holds a lock. dma buf polling cb unrefs a fence after its been signaled so the poll calls the wait, which signals the fences, which are being destroyed. The destruction tries to acquire the lock on the pending fences list which it can never get because its held by the wait from which it was called. Old bug, but not a lot of userspace apps were using dma-buf polling interfaces. Fix those, in particular this fixes KDE stalls/deadlock.

## Keyphrases
- **rootcause**: 'deadlock in dma buf fence polling'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4591 | 0.5390 | 0.4830 | 0.4755 | 20 |
| Sparse | 267.9119 | 927.3518 | 813.0401 | 850.5119 | 11 |
| Graph | 1.3388 | 2.3400 | 1.6757 | 1.6740 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.3400 | Allowed |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.3296 | Allowed |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 4 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 5 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 6 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 7 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 8 | 833 | Deadlock | Base | 1.7147 | Allowed |
| 9 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 10 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 11 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 12 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 13 | 476 | NULL Pointer Dereference | Base | 1.5377 | Allowed |
| 14 | 908 | Use of Uninitialized Resource | Base | 1.5363 | Allowed |
| 15 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.5272 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5390 | 0.5390 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.5257 | 0.5257 | Allowed-with-Review |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5076 | 0.5076 | Allowed-with-Review |
| 4 | 909 | Missing Initialization of Resource | Class | 0.5023 | 0.5023 | Allowed-with-Review |
| 5 | 122 | Heap-based Buffer Overflow | Variant | 0.4950 | 0.4950 | Allowed |
| 6 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4909 | 0.4909 | Allowed |
| 7 | 190 | Integer Overflow or Wraparound | Base | 0.4865 | 0.4865 | Allowed |
| 8 | 126 | Buffer Over-read | Variant | 0.4853 | 0.4853 | Allowed |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4834 | 0.4834 | Allowed |
| 10 | 787 | Out-of-bounds Write | Base | 0.4797 | 0.4797 | Allowed |
| 11 | 476 | NULL Pointer Dereference | Base | 0.4712 | 0.4712 | Allowed |
| 12 | 908 | Use of Uninitialized Resource | Base | 0.4697 | 0.4697 | Allowed |
| 13 | 413 | Improper Resource Locking | Base | 0.4692 | 0.4692 | Allowed |
| 14 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4692 | 0.4692 | Discouraged |
| 15 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4672 | 0.4672 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 927.3518 | 927.3518 | Allowed-with-Review |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | 919.5853 | 919.5853 | Allowed |
| 3 | 833 | Deadlock | 912.5480 | 912.5480 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 900.3269 | 900.3269 | Allowed-with-Review |
| 5 | 863 | Incorrect Authorization | 863.7543 | 863.7543 | Allowed-with-Review |
| 6 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 850.5119 | 850.5119 | Allowed |
| 7 | 319 | Cleartext Transmission of Sensitive Information | 832.2358 | 832.2358 | Allowed |
| 8 | 1390 | Weak Authentication | 827.7772 | 827.7772 | Allowed-with-Review |
| 9 | 184 | Incomplete List of Disallowed Inputs | 826.0647 | 826.0647 | Allowed |
| 10 | 401 | Missing Release of Memory after Effective Lifetime | 815.3727 | 815.3727 | Allowed |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | 267.9119 | 267.9119 | Allowed |
