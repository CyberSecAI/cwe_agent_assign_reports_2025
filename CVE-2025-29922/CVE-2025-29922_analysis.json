{
  "cve_id": "CVE-2025-29922",
  "description": "kcp is a Kubernetes-like control plane for form-factors and use-cases beyond Kubernetes and container workloads. Prior to 0.26.3, the identified vulnerability allows creating or deleting an object via the APIExport VirtualWorkspace in any arbitrary target workspace for pre-existing resources. By design, this should only be allowed when the workspace owner decides to give access to an API provider by creating an APIBinding. With this vulnerability, it is possible for an attacker to create and delete objects even if none of these requirements are satisfied, i.e. even if there is no APIBinding in that workspace at all or the workspace owner has created an APIBinding, but rejected a permission claim. A fix for this issue has been identified and has been published with kcp 0.26.3 and 0.27.0.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "create and delete objects",
    "vector": "",
    "attacker": "attacker",
    "product": "kcp",
    "version": "Prior to 0.26.3",
    "component": "APIExport VirtualWorkspace"
  },
  "reference_content": "CVE-2025-29922 - Unauthorized creation and deletion of objects in arbitrary workspaces through APIExport Virtual Workspace\n\n**Root cause of vulnerability:**\n\nThe `APIExport` Virtual Workspace allows managing objects in workspaces that bind to it, but the vulnerability allows creating or deleting objects in *any* target workspace, even without a valid APIBinding or accepted permission claim.\n\n**Weaknesses/vulnerabilities present:**\n\n*   Insufficient authorization checks within the `APIExport` Virtual Workspace.\n*   Bypassing of intended access control mechanisms related to APIBindings and permission claims.\n\n**Impact of exploitation:**\n\nAn attacker can create and delete objects in arbitrary workspaces, potentially leading to data breaches, denial of service, or unauthorized modification of system configurations.\n\n**Attack vectors:**\n\nExploitation occurs through the `APIExport` Virtual Workspace, allowing unauthorized object manipulation.\n\n**Required attacker capabilities/position:**\n\nThe attacker needs access to utilize the `APIExport` Virtual Workspace.\n\n**Mitigation or fix:**\n\n*   Upgrade to kcp 0.26.3 or 0.27.0, which include a fix for this issue.\n*   As a workaround, minimize the number of users with `apiexport/content` sub-resource access to `APIExport` resources.\n*   Implement filtering of incoming requests in a reverse proxy to enforce the authorizer logic from the referenced pull request.\n\n**Additional details (more than official CVE description):**\n\n*   The fix involves adding a `boundAPIAuthorizer` to the authorizer chain.\n*   The vulnerability is categorized as Critical with a CVSS score of 9.6.\n*   The vulnerability affects versions <= 0.26.1.\n*   The pull request addressing the issue is #3338.\n*   The vulnerability allows write access to APIBindings even from the virtual workspace, which is restricted to read-only access to prevent privilege escalation.\n*   The reporter of the vulnerability is xmudrii.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID    | CWE Name                                                                  | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| --------- | ------------------------------------------------------------------------- | ---------- | --------------------- | ------------------------------- | ------------------------------- |\n| CWE-863   | Incorrect Authorization                                                   | 1          | Class                 | Primary                         | Allowed-with-Review             |\n| CWE-862   | Missing Authorization                                                     | 0.7        | Class                 | Secondary                       | Allowed-with-Review             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-863 (Incorrect Authorization), which is a Class-level CWE. The secondary CWE is CWE-862 (Missing Authorization), also a Class-level CWE. CWE-863 is chosen because the description indicates that authorization checks are present but flawed, leading to the vulnerability. CWE-862 is considered as a weaker, but still plausible, alternative if the authorization checks are effectively absent in certain scenarios. Both CWEs are related to access control issues.\n\n```mermaid\ngraph TD\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n\n    cwe863 -->|CHILDOF| cwe285\n    cwe862 -->|CHILDOF| cwe285\n    cwe285 -->|CHILDOF| cwe284\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe863 primary\n    class cwe862 secondary\n    class cwe285,cwe284 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with an **incorrect authorization** mechanism (CWE-863) or a **missing authorization** (CWE-862). This allows an attacker to bypass intended access controls, leading to the **impact** of unauthorized object creation and deletion.\n\n## Summary of Analysis\nThe vulnerability description clearly indicates an authorization issue within the `APIExport` Virtual Workspace of the kcp system. The system **does not properly** restrict access to resources, allowing unauthorized actors to create and delete objects in arbitrary workspaces.\n\nThe primary selection of CWE-863 (Incorrect Authorization) is based on the description stating that access control mechanisms are present but **insufficient** (i.e., **incorrect**), which allows an attacker to bypass intended restrictions. The \"CVE Reference Links Content Summary\" supports this by stating \"Insufficient authorization checks within the `APIExport` Virtual Workspace.\"\n\nCWE-862 (Missing Authorization) is considered as a secondary option because the vulnerability could also be interpreted as a complete absence of authorization checks in certain scenarios.\n\nThe retriever results list both CWE-863 and CWE-862 as possible matches. The \"Privileges vs Permissions Guidance\" section reinforced the importance of selecting the right CWE based on whether the authorization logic is flawed (CWE-863) or completely missing (CWE-862).\n\nThe final decision prioritizes CWE-863 due to the evidence suggesting existing but flawed authorization mechanisms, while acknowledging CWE-862 as a plausible alternative in cases where authorization might be effectively absent. The chosen CWEs are at the Class level because more specific Base or Variant level CWEs are not supported by the available evidence.\n\nOther CWEs considered but not used:\n\n*   CWE-266: Incorrect Privilege Assignment - This was not selected because the vulnerability focuses on authorization related to resources, not on the assignment of privileges to users.\n*   CWE-285: Improper Authorization - It is a parent of CWE-863, therefore CWE-863 is more specific and more relevant.\n*   CWE-306: Missing Authentication for Critical Function - Authentication is not discussed as a weakness, authorization is.\n*   CWE-732: Incorrect Permission Assignment for Critical Resource - This CWE is about setting the wrong permissions initially, not about failing to check permissions during an operation.\n*   CWE-668: Exposure of Resource to Wrong Sphere - This is a high-level CWE and the authorization issues are better represented by CWE-863.",
  "analysis_with_relationships": "# Summary\n| CWE ID    | CWE Name                                                                  | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| --------- | ------------------------------------------------------------------------- | ---------- | --------------------- | ------------------------------- | ------------------------------- |\n| CWE-863   | Incorrect Authorization                                                   | 1          | Class                 | Primary                         | Allowed-with-Review             |\n| CWE-862   | Missing Authorization                                                     | 0.7        | Class                 | Secondary                       | Allowed-with-Review             |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary CWE is CWE-863 (Incorrect Authorization), which is a Class-level CWE. The secondary CWE is CWE-862 (Missing Authorization), also a Class-level CWE. CWE-863 is chosen because the description indicates that authorization checks are present but flawed, leading to the vulnerability. CWE-862 is considered as a weaker, but still plausible, alternative if the authorization checks are effectively absent in certain scenarios. Both CWEs are related to access control issues.\n\n```mermaid\ngraph TD\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe862[\"CWE-862: Missing Authorization\"]\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe284[\"CWE-284: Improper Access Control\"]\n\n    cwe863 -->|CHILDOF| cwe285\n    cwe862 -->|CHILDOF| cwe285\n    cwe285 -->|CHILDOF| cwe284\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe863 primary\n    class cwe862 secondary\n    class cwe285,cwe284 tertiary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with an **incorrect authorization** mechanism (CWE-863) or a **missing authorization** (CWE-862). This allows an attacker to bypass intended access controls, leading to the **impact** of unauthorized object creation and deletion.\n\n## Summary of Analysis\nThe vulnerability description clearly indicates an authorization issue within the `APIExport` Virtual Workspace of the kcp system. The system **does not properly** restrict access to resources, allowing unauthorized actors to create and delete objects in arbitrary workspaces.\n\nThe primary selection of CWE-863 (Incorrect Authorization) is based on the description stating that access control mechanisms are present but **insufficient** (i.e., **incorrect**), which allows an attacker to bypass intended restrictions. The \"CVE Reference Links Content Summary\" supports this by stating \"Insufficient authorization checks within the `APIExport` Virtual Workspace.\"\n\nCWE-862 (Missing Authorization) is considered as a secondary option because the vulnerability could also be interpreted as a complete absence of authorization checks in certain scenarios.\n\nThe retriever results list both CWE-863 and CWE-862 as possible matches. The \"Privileges vs Permissions Guidance\" section reinforced the importance of selecting the right CWE based on whether the authorization logic is flawed (CWE-863) or completely missing (CWE-862).\n\nThe final decision prioritizes CWE-863 due to the evidence suggesting existing but flawed authorization mechanisms, while acknowledging CWE-862 as a plausible alternative in cases where authorization might be effectively absent. The chosen CWEs are at the Class level because more specific Base or Variant level CWEs are not supported by the available evidence.\n\nOther CWEs considered but not used:\n\n*   CWE-266: Incorrect Privilege Assignment - This was not selected because the vulnerability focuses on authorization related to resources, not on the assignment of privileges to users.\n*   CWE-285: Improper Authorization - It is a parent of CWE-863, therefore CWE-863 is more specific and more relevant.\n*   CWE-306: Missing Authentication for Critical Function - Authentication is not discussed as a weakness, authorization is.\n*   CWE-732: Incorrect Permission Assignment for Critical Resource - This CWE is about setting the wrong permissions initially, not about failing to check permissions during an operation.\n*   CWE-668: Exposure of Resource to Wrong Sphere - This is a high-level CWE and the authorization issues are better represented by CWE-863.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-732:**\n- 732 (Incorrect Permission Assignment for Critical Resource) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 248.38641533604044
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 233.15187069783738
    },
    {
      "metadata": {
        "doc_id": "1390",
        "name": "Weak Authentication",
        "source": "sparse"
      },
      "similarity": 231.16143205414608
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 227.03917415643315
    },
    {
      "metadata": {
        "doc_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "source": "sparse"
      },
      "similarity": 226.27040750078402
    },
    {
      "metadata": {
        "doc_id": "668",
        "name": "Exposure of Resource to Wrong Sphere",
        "source": "sparse"
      },
      "similarity": 225.1139152171885
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 224.2425815442891
    },
    {
      "metadata": {
        "doc_id": "862",
        "name": "Missing Authorization",
        "source": "sparse"
      },
      "similarity": 223.91328214219723
    },
    {
      "metadata": {
        "doc_id": "1327",
        "name": "Binding to an Unrestricted IP Address",
        "type": "Base",
        "original_content": "The product assigns the address 0.0.0.0 for a database server, a cloud service/instance, or any computing resource that communicates remotely.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.499009855401565,
            "graph": 1.6112245168092092
          }
        }
      },
      "similarity": 0.499009855401565
    },
    {
      "doc_id": "350",
      "text": "CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action",
      "score": 2.5507200000000005,
      "metadata": {
        "doc_id": "350",
        "name": "Reliance on Reverse DNS Resolution for a Security-Critical Action",
        "type": "variant",
        "original_content": "CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action",
        "relationships": [
          {
            "source_id": "350",
            "target_id": "923",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "350",
            "target_id": "807",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "350",
            "target_id": "290",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "923",
            "target_id": "350",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "807",
            "target_id": "350",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "290",
            "target_id": "350",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "abstraction_path": 0.6080000000000001,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.2,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "abstraction_path_down",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "923",
                  "350",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "923"
            },
            "abstraction_path_down": {
              "path": [
                [
                  "1390",
                  "290",
                  "PARENTOF"
                ],
                [
                  "290",
                  "350",
                  "PARENTOF"
                ]
              ],
              "score": 0.6080000000000001,
              "type": "abstraction_path_down",
              "source": "1390"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "923",
                  "350",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "923"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "350",
                  "923",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "923"
            }
          }
        },
        "abstraction_level": "variant",
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.5507200000000005
          }
        }
      },
      "similarity": 2.5507200000000005
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-732",
      "CWE-862",
      "CWE-306",
      "CWE-285",
      "CWE-668",
      "CWE-284",
      "CWE-266"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}