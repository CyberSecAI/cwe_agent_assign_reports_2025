# Vulnerability Information: CVE-2024-11122

## Vulnerability Description
A vulnerability, which was classified as critical, has been found in ???????????? Lingdang CRM up to 8.6.4.3. Affected by this issue is some unknown functionality of the file /crm/wechatSession/index.php?msgid=1&operation=upload. The manipulation of the argument file leads to **unrestricted upload**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **unrestricted upload**
- **product:** ???????? Lingdang CRM
- **version:** up to 8.6.4.3
- **component:** /crm/wechatSession/index.php?msgid=1&operation=upload

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

*   The vulnerability lies in the `/crm/wechatSession/index.php` file of Lingdang CRM.
*   The application does not properly validate uploaded files allowing an attacker to upload arbitrary files.

**Weaknesses/Vulnerabilities Present:**

*   **Unrestricted File Upload:** The application allows users to upload files without proper validation, including file type, content, or size restrictions. This is a classic vulnerability, leading to arbitrary file upload.
*  **Lack of authentication:** The vulnerability can be exploited without any special permissions.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** An attacker can upload a malicious PHP file, which can then be executed by the server, leading to complete control of the system. This allows the attacker to perform any actions, such as accessing sensitive data, creating new accounts, installing malware, etc.

**Attack Vectors:**

*   **HTTP POST Request:** The attacker crafts a malicious HTTP POST request to `/crm/wechatSession/index.php` with `operation=upload` and a crafted multipart form containing the malicious file.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the vulnerable Lingdang CRM instance.
*   **No authentication:** The vulnerability can be exploited without any special permissions.
*   **Knowledge of Target:** The attacker should know the target URL.

**Additional Details:**

*   The vulnerability is present in Lingdang CRM version 8.6.4.3 and earlier.
*   The provided Proof of Concept (POC) demonstrates how to upload a PHP file containing `<?php phpinfo();?>` which, if successful, will allow the attacker to view php information and confirms the vulnerability.
*  The `token` and `msgid` parameters appear to be required but their validation does not prevent the exploit.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.507 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.499 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.485 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.424 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.405 |
| 6 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.403 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.398 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.391 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.580 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |

