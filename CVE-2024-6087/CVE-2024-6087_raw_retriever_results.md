# Raw Retriever Results for CVE-2024-6087

# Raw Retriever Results for CVE-2024-6087
## Query
An improper access control vulnerability exists in lunary-ai/lunary at the latest commit (a761d83) on the main branch. The vulnerability allows an attacker to use the auth tokens issued by the invite user functionality to obtain valid JWT tokens. These tokens can be used to compromise target users upon registration for their own arbitrary organizations. The attacker can invite a target email, obtain a one-time use token, retract the invite, and later use the token to reset the password of the target user, leading to full account takeover.

## Keyphrases
- **rootcause**: 'improper access control'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4784 | 0.5262 | 0.4943 | 0.4919 | 20 |
| Sparse | 153.2342 | 515.6489 | 437.7832 | 491.2448 | 12 |
| Graph | 1.0601 | 2.3998 | 1.5222 | 1.4917 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.3998 | Allowed |
| 2 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 3 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 4 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6252 | Allowed |
| 6 | 267 | Privilege Defined With Unsafe Actions | Base | 1.6217 | Allowed |
| 7 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 8 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 9 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 1.5037 | Allowed |
| 10 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 1.4970 | Allowed |
| 11 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 1.4863 | Allowed |
| 12 | 352 | Cross-Site Request Forgery (CSRF) | compound | 1.2880 | Allowed |
| 13 | 1275 | Sensitive Cookie with Improper SameSite Attribute | variant | 1.2624 | Allowed |
| 14 | 322 | Key Exchange without Entity Authentication | base | 1.2262 | Allowed |
| 15 | 257 | Storing Passwords in a Recoverable Format | base | 1.1794 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.5262 | 0.5262 | Allowed |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5141 | 0.5141 | Allowed |
| 3 | 267 | Privilege Defined With Unsafe Actions | Base | 0.5090 | 0.5090 | Allowed |
| 4 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.5086 | 0.5086 | Allowed |
| 5 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.5054 | 0.5054 | Allowed |
| 6 | 1270 | Generation of Incorrect Security Tokens | Base | 0.5001 | 0.5001 | Allowed |
| 7 | 285 | Improper Authorization | Class | 0.4987 | 0.4987 | Discouraged |
| 8 | 287 | Improper Authentication | Class | 0.4974 | 0.4974 | Discouraged |
| 9 | 863 | Incorrect Authorization | Class | 0.4971 | 0.4971 | Allowed-with-Review |
| 10 | 472 | External Control of Assumed-Immutable Web Parameter | Base | 0.4945 | 0.4945 | Allowed |
| 11 | 305 | Authentication Bypass by Primary Weakness | Base | 0.4893 | 0.4893 | Allowed |
| 12 | 532 | Insertion of Sensitive Information into Log File | Base | 0.4888 | 0.4888 | Allowed |
| 13 | 862 | Missing Authorization | Class | 0.4883 | 0.4883 | Allowed-with-Review |
| 14 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4869 | 0.4869 | Allowed |
| 15 | 306 | Missing Authentication for Critical Function | Base | 0.4844 | 0.4844 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1390 | Weak Authentication | 515.6489 | 515.6489 | Allowed-with-Review |
| 2 | 287 | Improper Authentication | 515.0846 | 515.0846 | Discouraged |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | 503.2861 | 503.2861 | Allowed |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | 499.6740 | 499.6740 | Allowed |
| 5 | 1391 | Use of Weak Credentials | 494.8547 | 494.8547 | Allowed-with-Review |
| 6 | 306 | Missing Authentication for Critical Function | 494.2389 | 494.2389 | Allowed |
| 7 | 522 | Insufficiently Protected Credentials | 488.2507 | 488.2507 | Allowed-with-Review |
| 8 | 863 | Incorrect Authorization | 485.7410 | 485.7410 | Allowed-with-Review |
| 9 | 807 | Reliance on Untrusted Inputs in a Security Decision | 475.0411 | 475.0411 | Allowed |
| 10 | 798 | Use of Hard-coded Credentials | 474.8722 | 474.8722 | Allowed |
| 11 | 321 | Use of Hard-coded Cryptographic Key | 153.4718 | 153.4718 | Allowed |
| 12 | 290 | Authentication Bypass by Spoofing | 153.2342 | 153.2342 | Allowed |
