# Vulnerability Information: CVE-2024-7418

## Vulnerability Description
The The Post Grid - Shortcode, Gutenberg Blocks and Elementor Addon for Post Grid plugin for WordPress is vulnerable to **Sensitive Information Exposure** in all versions up to, and including, 7.7.11 via the post_query_guten and post_query functions. This makes it possible for authenticated attackers, with contributor-level access and above, to extract information from posts that are not public (i.e. draft, future, etc..).

### Vulnerability Description Key Phrases
- **weakness:** **Sensitive Information Exposure**
- **impact:** extract information from posts that are not public
- **attacker:** authenticated attackers
- **product:** The Post Grid - Shortcode, Gutenberg Blocks and Elementor Addon for Post Grid plugin for WordPress
- **version:** all versions up to and including 7.7.11
- **component:** post_query_guten and post_query functions

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-7418:

**1. Verification of CVE Relevance:**

Yes, the provided content relates to CVE-2024-7418. The Wordfence description explicitly mentions this CVE and describes the vulnerability as "Sensitive Information Exposure" in "The Post Grid" plugin, making it possible for authenticated attackers to extract information from non-public posts. This aligns with the description of CVE-2024-7418 in the provided Wordfence analysis. The provided Trac change logs also show the removal of the post status filtering mechanism.

**2. Root Cause of Vulnerability:**

The root cause is the plugin's improper handling of post status when querying and displaying posts. Specifically:
   - The plugin was previously using the `Fns::available_user_post_status()` function to determine which posts to display based on their status, allowing users to potentially view non-published posts.
   - The vulnerable code is located in the `post_query_guten` function within `BlockBase.php` and the `post_query` function in `rtTPGElementorQuery.php`.
   - The vulnerability was fixed by removing this function call and hardcoding the post status to "publish", effectively preventing access to posts in other states like 'draft' or 'future'.

**3. Weaknesses/Vulnerabilities Present:**

   - **Information Disclosure:** The primary vulnerability is the exposure of sensitive information. Authenticated users with contributor-level access could access posts that should not have been public, as their status wasn't properly checked during queries.
  - The plugin used `Fns::available_user_post_status()` to get the post status from user input instead of limiting it to only 'publish' status, leading to information disclosure.

**4. Impact of Exploitation:**

   - **Unauthorized Access to Non-Public Content:** Attackers can potentially view post content that is in draft, future, or other non-public states, which may include sensitive information intended to be private or not yet ready for public consumption.

**5. Attack Vectors:**

   - The vulnerability is present in the `post_query_guten` and `post_query` functions, which are used when displaying posts via Gutenberg blocks or Elementor widgets.
  - An attacker with Contributor+ access can modify the parameters when displaying a post or use the blocks directly and be able to see non published posts.

**6. Required Attacker Capabilities/Position:**

   - **Authenticated Access:** An attacker needs to have an account on the WordPress site with at least Contributor-level permissions or above.
   - No special privileges or settings are required, simply the ability to edit posts or use the plugin's components.

**Additional Notes:**

- The provided Trac change logs detail the specific code modifications that were made to fix the vulnerability including removing  `Fns::available_user_post_status()` calls and settings the `post_status` to 'publish'.
- The Wordfence analysis indicates that the vulnerability was patched in version 7.7.12 of the plugin.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.388 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.364 |
| 3 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.357 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.356 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.351 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.344 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.344 |
| 8 | 668 | Exposure of Resource to Wrong Sphere | Class | Discouraged | sparse | 0.339 |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | dense | 0.527 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.003 |

