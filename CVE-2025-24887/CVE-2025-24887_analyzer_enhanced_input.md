## Vulnerability Description
OpenCTI is an open-source cyber threat intelligence platform. In versions starting from 6.4.8 to before 6.4.10, the **allow/deny lists can be bypassed**, allowing a user to change attributes that are intended to be unmodifiable by the user. It is possible to toggle the `external` flag on/off and change the own token value for a user. It is also possible to edit attributes that are not in the allow list, such as `otp_qr` and `otp_activated`. If external users exist in the OpenCTI setup and the information about these users identities is sensitive, the above vulnerabilities can be used to enumerate existing user accounts as a standard low privileged user. This issue has been patched in version 6.4.10.

### Vulnerability Description Key Phrases
- **weakness:** **allow/deny lists can be bypassed**
- **product:** OpenCTI
- **impact:** change attributes, enumerate user accounts
- **attacker:** user
- **version:** from 6.4.8 to before 6.4.10

## CVE Reference Links Content Summary
Root cause of vulnerability:
The allow/deny lists for user attribute updates in the user profile can be bypassed, allowing users to modify attributes they shouldn't be able to.

Weaknesses/vulnerabilities present:
- CWE-284: Improper Access Control
- CWE-657: Improper Access Control

Impact of exploitation:
- Ability to toggle the `external` flag on/off for a user.
- Ability to change the user's own token value.
- Ability to edit attributes not on the allow list (e.g., `otp_qr`, `otp_activated`).
- Potential enumeration of existing user accounts if external users with sensitive information exist.
- No identified privilege escalation issues due to schema validation checks in the latest version.

Attack vectors:
Network

Attack complexity:
Low

Privileges required:
Low

User interaction:
None

Required attacker capabilities/position:
A standard low-privileged user.

Mitigation or fix:
Update to version >= 6.4.10.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

This content provides more detail than the official CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | alternate_terms | 0.800 |
| 2 | 183 | Permissive List of Allowed Inputs | Base | Allowed | alternate_terms | 0.700 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.714 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.697 |
| 5 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.681 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.667 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.666 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.663 |
| 9 | 15 | External Control of System or Configuration Setting | Base | Allowed | dense | 0.575 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-184: Incomplete List of Disallowed Inputs

CWE-183: Permissive List of Allowed Inputs

CWE-863: Incorrect Authorization

CWE-1390: Weak Authentication

CWE-285: Improper Authorization

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-306: Missing Authentication for Critical Function

CWE-15: External Control of System or Configuration Setting

CWE-434: Unrestricted Upload of File with Dangerous Type