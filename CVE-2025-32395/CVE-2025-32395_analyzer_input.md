# Vulnerability Information: CVE-2025-32395

## Vulnerability Description
Vite is a frontend tooling framework for javascript. Prior to 6.2.6, 6.1.5, 6.0.15, 5.4.18, and 4.5.13, the contents of arbitrary files can be returned to the browser if the dev server is running on Node or Bun. HTTP 1.1 spec (RFC 9112) does not allow # in request-target. Although an attacker can send such a request. For those requests with an invalid request-line (it includes request-target), the spec recommends to reject them with 400 or 301. The same can be said for HTTP 2. On Node and Bun, those requests are not rejected internally and is passed to the user land. For those requests, the value of http.IncomingMessage.url contains #. Vite assumed req.url wont contain # when checking server.fs.deny, allowing those kinds of requests to bypass the check. Only apps explicitly exposing the Vite dev server to the network (using --host or server.host config option) and running the Vite dev server on runtimes that are not Deno (e.g. Node, Bun) are affected. This vulnerability is fixed in 6.2.6, 6.1.5, 6.0.15, 5.4.18, and 4.5.13.

### Vulnerability Description Key Phrases
- **rootcause:** **improper request-target handling**
- **impact:** bypass server.fs.deny check
- **product:** Vite
- **version:** prior to 6.2.6, 6.1.5, 6.0.15, 5.4.18, and 4.5.13

## CVE Reference Links Content Summary
## Analysis of CVE-2025-32395 based on provided content:

**1. Verification:**

The provided content details a security vulnerability in Vite (versions >=6.2.0, <=6.2.5, >=6.1.0, <=6.1.4, >=6.0.0, <=6.0.14, >=5.0.0, <=5.4.17, <=4.5.12) related to bypassing the `server.fs.deny` check due to improper handling of requests with `#` in the `request-target`. This aligns with the CVE description, which is now available as CVE-2025-32395.

**2. Extracted Information:**

*   **Root cause of vulnerability:** HTTP 1.1 spec does not allow `#` in the `request-target`, but Node.js and Bun allow those requests. Vite assumed `req.url` won't contain `#` when checking `server.fs.deny`. Deno handles these requests differently, not including `#` in `req.url`.
*   **Weaknesses/vulnerabilities present:** Improper input validation, specifically failing to sanitize or reject requests containing `#` in the request target.  Bypass of file access restrictions (`server.fs.deny`).
*   **Impact of exploitation:** Arbitrary files can be returned to the browser. This could lead to sensitive information disclosure.
*   **Attack vectors:** Network-based attack. An attacker can send a crafted HTTP request with `#` in the request target to bypass the `server.fs.deny` check and access arbitrary files.
*   **Required attacker capabilities/position:** The attacker needs network access to the Vite dev server (if it's exposed). No authentication is required.
*   **Mitigation or fix:** Upgrade to a patched version of Vite (>=6.2.6, >=6.1.5, >=6.0.15, >=5.4.18, >=4.5.13).

**3. CVSS Score:**

*   CVSS v4: 6.0/10
*   Attack Vector: Network
*   Attack Complexity: Low
*   Attack Requirements: Present
*   Privileges Required: None
*   User interaction: Passive
*   Confidentiality: High
*   Integrity: None
*   Availability: None

**4. Additional Details:**

The content provides a proof-of-concept (PoC) demonstrating how to read `/etc/passwd` using a crafted request. It also details the relevant RFC specifications regarding the use of `#` in HTTP requests. The advisory credits @do9gy-msec and @sw0rd1ight for reporting the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 1.066 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 1.065 |
| 3 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 1.060 |
| 4 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 1.042 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 1.025 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 1.024 |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 1.023 |
| 8 | 23 | Relative Path Traversal | Base | Allowed | sparse | 1.015 |
| 9 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | Allowed | dense | 0.500 |
| 10 | 410 | Insufficient Resource Pool | Base | Allowed | graph | 0.002 |

