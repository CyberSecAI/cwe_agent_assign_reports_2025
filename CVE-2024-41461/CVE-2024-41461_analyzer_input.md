# Vulnerability Information: CVE-2024-41461

## Vulnerability Description
Tenda FH1201 v1.2.0.14 was discovered to contain a **stack-based buffer overflow** vulnerability via the list1 parameter at ip/goform/DhcpListClient.

### Vulnerability Description Key Phrases
- **weakness:** **stack-based buffer overflow**
- **product:** Tenda FH1201
- **version:** v1.2.0.14
- **component:** ip/goform/DhcpListClient

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 244)
- CWE-120 (Count: 45)

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
- A stack buffer overflow vulnerability exists in the `DhcpListClient` function of Tenda FH1201 firmware version 1.2.0.14. The vulnerability occurs because the function doesn't validate the length of the `list1` parameter before copying it to the stack.

**Weaknesses/vulnerabilities present:**
- Stack buffer overflow: The lack of bounds checking on the `list1` parameter allows an attacker to write beyond the allocated buffer on the stack.

**Impact of exploitation:**
- Code execution: Overwriting the stack can lead to control of the program flow, potentially allowing an attacker to execute arbitrary code.
- Denial of service: A stack overflow can crash the affected device, resulting in a denial of service.

**Attack vectors:**
- HTTP POST request: The vulnerability is triggered through an HTTP POST request to the `/goform/DhcpListClient` endpoint.
- Malicious payload: The attacker includes a long string (e.g., 2000 bytes of "a") in the `list1` parameter.

**Required attacker capabilities/position:**
- Network access: The attacker needs to be able to send HTTP requests to the router on the network.
- Basic understanding of HTTP requests and parameters.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.223 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.158 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.154 |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.148 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.148 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.140 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.561 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

