# Vulnerability Information: CVE-2024-39760

## Vulnerability Description
Multiple OS **command injection** vulnerabilities exist in the login.cgi set_sys_init() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary code execution. An attacker can make an unauthenticated HTTP request to trigger these vulnerabilities.A **command injection** vulnerability exists within the `restart_min_value` POST parameter.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **impact:** arbitrary code execution
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Wavlink AC3000 M33A8
- **version:** V5030.210505
- **component:** login.cgi set_sys_init() functionality

## CVE Reference Links Content Summary
## Analysis of CVE-2024-39760 based on provided content:

This content is directly related to CVE-2024-39760, along with CVE-2024-39759 and CVE-2024-39761. It provides significantly more detail than a standard CVE description.

**Root cause of vulnerability:**

The `login.cgi` binary lacks authentication checks, and improperly handles user-supplied input in the `set_sys_init()` function when processing the `restart_hour_value`, `restart_min_value`, and `restart_week_value` POST parameters.

**Weaknesses/vulnerabilities present:**

*   **CWE-77 - Improper Neutralization of Special Elements used in a Command (‘Command Injection’):** The vulnerability allows for arbitrary command execution via crafted HTTP POST requests.
*   Lack of input validation and sanitization in the `set_sys_init()` function.
*   Missing authentication checks in the `login.cgi` binary.

**Impact of exploitation:**

*   **Arbitrary code execution:** An attacker can execute arbitrary commands on the affected device.
*   **System compromise:** Full system compromise is possible.

**Attack vectors:**

*   **Unauthenticated HTTP request:** The vulnerability can be exploited without authentication.
*   Specifically crafted HTTP POST requests to `login.cgi` with manipulated `restart_hour_value`, `restart_min_value`, or `restart_week_value` parameters.
*   The crafted parameters are ultimately used to construct a crontab entry, leading to command execution.

**Required attacker capabilities/position:**

*   Network access to the vulnerable device.
*   Ability to send HTTP POST requests.
*   Understanding of crontab syntax to craft a malicious payload.

**Mitigation or fix:**

The report does not specify a fix, but implies that proper input validation and authentication checks within the `login.cgi` binary are necessary to mitigate the vulnerability. The vendor was contacted and is working on patches, but the product has been discontinued.

**Additional Details:**

*   **Affected Product:** Wavlink AC3000 M33A8.V5030.210505
*   **CVSSv3 Score:** 10.0 (Critical)
*   The vulnerability leverages the interaction between the `login.cgi` binary, the `sch_reboot.sh` script, and the system's crontab functionality.
*   The report details the specific code locations and functions involved in the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.346 |
| 4 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.332 |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.322 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.293 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.292 |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.290 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.620 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

