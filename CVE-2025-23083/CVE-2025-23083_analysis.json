{
  "cve_id": "CVE-2025-23083",
  "description": "With the aid of the diagnostics_channel utility, an event can be hooked into whenever a worker thread is created. This is not limited only to workers but also exposes internal workers, where an instance of them can be fetched, and its constructor can be grabbed and reinstated for malicious usage. This vulnerability affects Permission Model users (--permission) on Node.js v20, v22, and v23.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "expose internal workers",
    "impact": "grab constructor and reinstate for malicious usage",
    "vector": "",
    "attacker": "",
    "product": "Node.js",
    "version": [
      "v20",
      "v22",
      "and v23"
    ],
    "component": ""
  },
  "reference_content": "## Analysis of CVE-2025-23083 based on provided content:\n\nThe provided content **is relevant** to CVE-2025-23083. It provides detailed information about the vulnerability.\n\n**Root cause of vulnerability:**\n\nThe vulnerability is a worker permission bypass via an InternalWorker leak in diagnostics. An event can be hooked into whenever a worker thread is created, exposing internal workers. An instance of these internal workers can be fetched, and its constructor can be grabbed and reinstated for malicious usage.\n\n**Weaknesses/vulnerabilities present:**\n\n*   Worker permission bypass\n*   InternalWorker leak in diagnostics\n*   Improper access control\n\n**Impact of exploitation:**\n\nThe vulnerability affects Permission Model users (--permission) on Node.js v20, v22, and v23. It affects all users in active release lines: 20.x, 22.x, 23.x.\n\n**Attack vectors:**\n\nExploitation involves using the `diagnostics_channel` utility to hook into worker thread creation events, gaining access to internal workers, and reinstating their constructors for malicious purposes.\n\n**Required attacker capabilities/position:**\n\nThe content does not specify the required attacker capabilities or position.\n\n**Mitigation or fix:**\n\nThe content indicates that updates are available for the 23.x, 22.x, 20.x, and 18.x Node.js release lines to address this issue.  The fix was implemented by RafaelGSS.\n\n**Additional details (more than official CVE description):**\n\n*   The vulnerability was reported by leodog896.\n*   The content provides specific version numbers affected (v20, v22, v23).\n*   It clarifies that the vulnerability impacts users utilizing the Permission Model.\n*   It details the mechanism of exploitation using the `diagnostics_channel` utility.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name                                                                | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :------- | :---------------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-863  | Incorrect Authorization                                                 | 0.9        | Class                 | Allowed-with-Review             | Primary CWE                     |\n| CWE-668 | Exposure of Resource to Wrong Sphere                                                 | 0.7        | Class                 | Discouraged             | Secondary Candidate                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\n\nThe primary relationship considered was the parent-child relationship between CWE-863 (Incorrect Authorization) and its potential children which are more specific. However, based on the provided information, there isn't enough evidence to pinpoint a more specific child of CWE-863. The other relevant relationship is between CWE-668 (Exposure of Resource to Wrong Sphere), which could be a consequence of the **incorrect authorization**, but it is a Class level of abstraction.\n\n```mermaid\ngraph TD\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe668[\"CWE-668: Exposure of Resource to Wrong Sphere\"]\n    \n    cwe668 -->|CANPRECEDE| cwe863\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe863 primary\n    class cwe668 secondary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with an **InternalWorker leak** due to **improper access control** in the diagnostics channel. This leads to a worker permission bypass, as internal workers can be accessed and their constructors reinstated for malicious purposes. The **root cause** is the **incorrect authorization** that allows access to internal workers.\n\n## Summary of Analysis\n\nThe primary assessment is based on the evidence that the vulnerability allows access to internal workers, bypassing intended permission restrictions. This aligns with **CWE-863 (Incorrect Authorization)**, as the system **fails to correctly perform authorization checks** when an actor (through diagnostics channel) attempts to access a restricted resource (internal workers). The evidence for this is \"worker permission bypass via an InternalWorker leak in diagnostics\" and \"expose internal workers\".\n\nCWE-668 (Exposure of Resource to Wrong Sphere) was considered as a secondary candidate, because the **exposure of internal workers** to the diagnostics channel could be viewed as exposing a resource to the wrong control sphere. However, since the underlying issue is the authorization failure that enables this exposure, CWE-863 is the more direct and appropriate classification.\n\nThe selected CWEs are at the Class level due to the lack of more granular information. If there were details about the specific authorization mechanism that failed, a more specific Base or Variant CWE could have been selected.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-863: Incorrect Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 1762.01\n**Source**: sparse\n\n**Description**:\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name                                                                | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :------- | :---------------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-863  | Incorrect Authorization                                                 | 0.9        | Class                 | Allowed-with-Review             | Primary CWE                     |\n| CWE-668 | Exposure of Resource to Wrong Sphere                                                 | 0.7        | Class                 | Discouraged             | Secondary Candidate                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.8\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\n\nThe primary relationship considered was the parent-child relationship between CWE-863 (Incorrect Authorization) and its potential children which are more specific. However, based on the provided information, there isn't enough evidence to pinpoint a more specific child of CWE-863. The other relevant relationship is between CWE-668 (Exposure of Resource to Wrong Sphere), which could be a consequence of the **incorrect authorization**, but it is a Class level of abstraction.\n\n```mermaid\ngraph TD\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe668[\"CWE-668: Exposure of Resource to Wrong Sphere\"]\n    \n    cwe668 -->|CANPRECEDE| cwe863\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe863 primary\n    class cwe668 secondary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with an **InternalWorker leak** due to **improper access control** in the diagnostics channel. This leads to a worker permission bypass, as internal workers can be accessed and their constructors reinstated for malicious purposes. The **root cause** is the **incorrect authorization** that allows access to internal workers.\n\n## Summary of Analysis\n\nThe primary assessment is based on the evidence that the vulnerability allows access to internal workers, bypassing intended permission restrictions. This aligns with **CWE-863 (Incorrect Authorization)**, as the system **fails to correctly perform authorization checks** when an actor (through diagnostics channel) attempts to access a restricted resource (internal workers). The evidence for this is \"worker permission bypass via an InternalWorker leak in diagnostics\" and \"expose internal workers\".\n\nCWE-668 (Exposure of Resource to Wrong Sphere) was considered as a secondary candidate, because the **exposure of internal workers** to the diagnostics channel could be viewed as exposing a resource to the wrong control sphere. However, since the underlying issue is the authorization failure that enables this exposure, CWE-863 is the more direct and appropriate classification.\n\nThe selected CWEs are at the Class level due to the lack of more granular information. If there were details about the specific authorization mechanism that failed, a more specific Base or Variant CWE could have been selected.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-863: Incorrect Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 1762.01\n**Source**: sparse\n\n**Description**:\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-668:**\n- 668 (Exposure of Resource to Wrong Sphere) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 336.05914959098675
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 331.8396928005251
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 325.779833231925
    },
    {
      "metadata": {
        "doc_id": "834",
        "name": "Excessive Iteration",
        "source": "sparse"
      },
      "similarity": 312.7211332089351
    },
    {
      "metadata": {
        "doc_id": "1333",
        "name": "Inefficient Regular Expression Complexity",
        "source": "sparse"
      },
      "similarity": 310.3852855677937
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 310.34799952324863
    },
    {
      "metadata": {
        "doc_id": "522",
        "name": "Insufficiently Protected Credentials",
        "source": "sparse"
      },
      "similarity": 309.18078487444853
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 307.96846456664
    },
    {
      "metadata": {
        "doc_id": "421",
        "name": "Race Condition During Access to Alternate Channel",
        "type": "Base",
        "original_content": "The product opens an alternate channel to communicate with an authorized user, but the channel is accessible to other actors.",
        "keyphrase_source": "weakness:expose internal workers",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.4517641033835987,
            "graph": 1.6877184507110727
          }
        }
      },
      "similarity": 0.4517641033835987
    },
    {
      "doc_id": "212",
      "text": "CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "212",
        "name": "Improper Removal of Sensitive Information Before Storage or Transfer",
        "type": "base",
        "original_content": "CWE-212: Improper Removal of Sensitive Information Before Storage or Transfer",
        "relationships": [
          {
            "source_id": "212",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "212",
            "target_id": "1258",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "212",
            "target_id": "201",
            "label": "CANPRECEDE",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "212",
            "target_id": "669",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1003"
            }
          },
          {
            "source_id": "212",
            "target_id": "669",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "669",
            "target_id": "212",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "212",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "201",
            "target_id": "212",
            "label": "CANFOLLOW",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1258",
            "target_id": "212",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "201",
                  "212",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "201"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "201",
                  "212",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "201"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "212",
                  "201",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "201"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-668"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}