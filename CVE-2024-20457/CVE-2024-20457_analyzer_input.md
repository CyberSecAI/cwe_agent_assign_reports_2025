# Vulnerability Information: CVE-2024-20457

## Vulnerability Description
A vulnerability in the logging component of Cisco Unified Communications Manager IM &amp Presence Service (Unified CM IM&ampP) could allow an authenticated, remote attacker to view sensitive information in clear text on an affected system. This vulnerability is due to the **storage of unencrypted credentials in certain logs**. An attacker could exploit this vulnerability by accessing the logs on an affected system and obtaining credentials that they may not normally have access to. A successful exploit could allow the attacker to access sensitive information from the device.

### Vulnerability Description Key Phrases
- **rootcause:** **storage of unencrypted credentials in certain logs**
- **impact:** view sensitive information in clear text
- **vector:** accessing the logs
- **attacker:** authenticated remote attacker
- **product:** Cisco Unified Communications Manager IM & Presence Service (Unified CM IM&P)
- **component:** logging component

## CVE Reference Links Content Summary
Based on the provided documents, here's a breakdown of the vulnerability described in CVE-2024-20457:

**Root Cause of Vulnerability:**
- The vulnerability is due to the storage of unencrypted credentials within certain logs of the Cisco Unified Communications Manager IM & Presence Service (Unified CM IM&P) when running the External Database Merge Tool.

**Weaknesses/Vulnerabilities Present:**
- **Information Disclosure:** Sensitive information, specifically credentials, are stored in clear text in logs, which should be encrypted.
- **Lack of Encryption:** The failure to encrypt stored credentials represents a significant weakness in the system's security.

**Impact of Exploitation:**
- **Unauthorized Access to Sensitive Information:** A successful exploit could allow an attacker to access and view credentials that they would not normally have access to.
- **Potential for Further Compromise:** The leaked credentials could be used for further malicious activities and/or access to other systems.

**Attack Vectors:**
- **Remote Access:** The vulnerability can be exploited remotely.
- **Log Access:** An attacker needs to gain access to the affected system's logs.

**Required Attacker Capabilities/Position:**
- **Authentication:** The attacker must be an authenticated user on the affected system, which means that they must have valid credentials to access the system, though not necessarily the credentials stored in the logs.
- **Log Access:** The attacker needs to be able to access the log files where the credentials are stored.

**Additional Information:**
- **Affected Products:** The vulnerability affects Cisco Unified CM IM&P when it runs the External Database Merge Tool.
- **No Workarounds:**  There are no workarounds available to mitigate this vulnerability.
- **Fixed Releases:** The vulnerability is addressed in specific releases of the affected software, including:
  - 12.5(1)SU9 for 12.5(1) and earlier versions
  - 14SU5 for version 14
  - 15SU2 for version 15

The vulnerability has a CVSS base score of 6.5 (Medium), with a vector string of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.809 |
| 2 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.642 |
| 3 | 538 | Insertion of Sensitive Information into Externally-Accessible File or Directory | Base | Allowed | sparse | 0.625 |
| 4 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.613 |
| 5 | 248 | Uncaught Exception | Base | Allowed | sparse | 0.597 |
| 6 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.573 |
| 7 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.561 |
| 8 | 311 | Missing Encryption of Sensitive Data | Class | Discouraged | sparse | 0.559 |
| 9 | 778 | Insufficient Logging | Base | Allowed | dense | 0.554 |
| 10 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | graph | 0.002 |

