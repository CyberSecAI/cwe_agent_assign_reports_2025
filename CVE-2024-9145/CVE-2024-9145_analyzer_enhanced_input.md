## Vulnerability Description
Wiz Code Visual Studio Code extension in versions 1.0.0 up to 1.5.3 and Wiz (legacy) Visual Studio Code extension in versions 0.13.0 up to 0.17.8 are vulnerable to local **command injection** if the user opens a maliciously crafted Dockerfile located in a path that has been marked as a trusted folder within Visual Studio Code, and initiates a manual scan of the file.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **vector:** maliciously crafted Dockerfile
- **product:** Wiz Code Visual Studio Code extension
- **version:** 1.0.0 to 1.5.3

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**

The vulnerability stems from a local command injection flaw within the Wiz Visual Studio Code Extension. This flaw is triggered when the extension processes a maliciously crafted Docker image file. Specifically, the vulnerability occurs when the extension attempts to pull a base image before scanning the dockerfile if the pull feature isn't disabled and an attacker can control the docker image name.

**Weaknesses/vulnerabilities present:**

*   **Command Injection:** The core vulnerability is a command injection flaw. This means that the extension, when handling a malicious Docker image file, executes user-controlled input as a system command.
*   **Lack of Input Sanitization:** The extension fails to properly sanitize or validate the input related to the docker image name before passing it to a command execution context.

**Impact of exploitation:**

*   **Local Command Execution:** Successful exploitation allows an attacker to execute arbitrary commands on the developer's workstation. This could lead to various malicious activities, including:
    *   Data exfiltration (stealing source code, secrets, credentials)
    *   Malware installation
    *   System compromise
    *   Lateral movement to other systems within the network.

**Attack vectors:**

*   **Maliciously Crafted Docker Image File:** The primary attack vector is a specially crafted Docker image file. This file must contain malicious input that, when processed by the vulnerable extension, leads to command injection.
*   **Trusted Folder Requirement:** The victim needs to open the malicious Docker image file from a folder marked as "trusted" within Visual Studio Code.

**Required attacker capabilities/position:**

*   **Ability to create a malicious Docker image file:** The attacker needs to craft a Dockerfile with the malicious command to be injected
*   **Social engineering/malware distribution:** The attacker needs to trick the user into opening the malicious file with the vulnerable extension.
*  **Trusted Folder:**  The attacker must convince the victim to open the malicious dockerfile from a folder marked as trusted in VS Code.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.343 |
| 4 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.332 |
| 5 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.331 |
| 6 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.329 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.329 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.327 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.507 |
| 10 | 190 | Integer Overflow or Wraparound | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-121: Stack-based Buffer Overflow

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-20: Improper Input Validation

CWE-427: Uncontrolled Search Path Element

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-138: Improper Neutralization of Special Elements

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-190: Integer Overflow or Wraparound