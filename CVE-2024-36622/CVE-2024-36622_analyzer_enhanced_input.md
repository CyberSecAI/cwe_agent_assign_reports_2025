## Vulnerability Description
In RaspAP raspap-webgui 3.0.9 and earlier, a **command injection** vulnerability exists in the clearlog.php script. The vulnerability is due to **improper sanitization of user input** passed via the logfile parameter.

### Vulnerability Description Key Phrases
- **rootcause:** **improper sanitization of user input**
- **weakness:** **command injection**
- **product:** RaspAP raspap-webgui
- **version:** 3.0.9 and earlier
- **component:** clearlog.php script

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-36622:

**1. Verification of CVE Relevance:**

The provided content includes a GitHub Gist specifically referencing "CVE-2024-36622" and states that the vulnerability is in the `clearlog.php` script of raspap-webgui version 3.0.9 and earlier, due to improper sanitization of the `logfile` parameter. This aligns with the CVE description that there is a command injection vulnerability in `clearlog.php`.

**2. Extracted Information:**

*   **Root Cause:** The vulnerability stems from the lack of proper sanitization of user-supplied input passed through the `logfile` parameter in the `clearlog.php` script. Specifically, the `escapeshellcmd()` function does not prevent command injection and is later replaced by `escapeshellarg()`, with the addition of a regex to check if the logfile path is valid.
*   **Weaknesses/Vulnerabilities:**
    *   **OS Command Injection:** The `clearlog.php` script executes a system command (`sudo truncate -s 0 $logfile`) with user-controlled input.
    *   **Insufficient Input Sanitization:** The use of `escapeshellcmd` was inadequate to prevent command injection as it did not escape all potentially dangerous characters.
*   **Impact of Exploitation:** An attacker could execute arbitrary OS commands with root privileges on the system, potentially leading to complete system compromise. The attacker can truncate any log file that the system has access to via the "sudo truncate -s 0 " command.
*   **Attack Vectors:**
    *   The primary attack vector is via a POST request to the `clearlog.php` script with a malicious `logfile` parameter.
*   **Required Attacker Capabilities/Position:**
    *   The attacker would need to be able to send HTTP POST requests to the web application.
    *   The attacker needs to have access to the web application interface, which is likely authenticated.

**3. Additional Details:**

*   The commit `c98d2b0c15942b4829d31dec615b9b40cc6faa14` addresses this vulnerability by replacing `escapeshellcmd()` with `escapeshellarg()` and adding a regex check to ensure that the supplied path starts with `/var/log` or `/tmp`.
*   The vulnerability exists in version 3.0.9 and earlier.

In summary, the provided content details a command injection vulnerability in `clearlog.php` due to inadequate input sanitization, which is resolved in the provided commit by using `escapeshellarg()` and path validation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.267 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.224 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.223 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.215 |
| 7 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.211 |
| 8 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.209 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.527 |
| 10 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-116: Improper Encoding or Escaping of Output

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-790: Improper Filtering of Special Elements

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')