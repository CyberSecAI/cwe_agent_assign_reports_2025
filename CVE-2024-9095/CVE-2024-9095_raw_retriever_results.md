# Raw Retriever Results for CVE-2024-9095

# Raw Retriever Results for CVE-2024-9095
## Query
In lunary-ai/lunary version v1.4.28, the /bigquery API route lacks proper access control, allowing any logged-in user to create a Datastream to Google BigQuery and export the entire database. This includes sensitive data such as password hashes and secret API keys. The route is protected by a config check (`config.DATA_WAREHOUSE_EXPORTS_ALLOWED`), but it does not verify the users access level or implement any access control middleware. This vulnerability can lead to the extraction of sensitive data, disruption of services, credential compromise, and service integrity breaches.

## Keyphrases
- **rootcause**: 'lacks proper access control'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4042 | 0.4544 | 0.4240 | 0.4205 | 20 |
| Sparse | 146.4096 | 511.7289 | 440.9062 | 460.7224 | 11 |
| Graph | 1.0062 | 3.6400 | 1.4621 | 1.2285 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | base | 3.6400 | Allowed |
| 2 | 202 | Exposure of Sensitive Information Through Data Queries | Base | 2.3889 | Allowed |
| 3 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 4 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 1.6381 | Allowed |
| 5 | 532 | Insertion of Sensitive Information into Log File | Base | 1.6358 | Allowed |
| 6 | 306 | Missing Authentication for Critical Function | Base | 1.5849 | Allowed |
| 7 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 8 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 1.5056 | Allowed |
| 9 | 322 | Key Exchange without Entity Authentication | base | 1.3572 | Allowed |
| 10 | 312 | Cleartext Storage of Sensitive Information | base | 1.3104 | Allowed |
| 11 | 257 | Storing Passwords in a Recoverable Format | base | 1.1466 | Allowed |
| 12 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.1466 | Allowed |
| 13 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.0584 | Allowed |
| 14 | 285 | Improper Authorization | Class | 1.0296 | Discouraged |
| 15 | 863 | Incorrect Authorization | Class | 1.0286 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 922 | Insecure Storage of Sensitive Information | Class | 0.4544 | 0.4544 | Allowed-with-Review |
| 2 | 612 | Improper Authorization of Index Containing Sensitive Information | Base | 0.4539 | 0.4539 | Allowed |
| 3 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | 0.4451 | 0.4451 | Allowed-with-Review |
| 4 | 202 | Exposure of Sensitive Information Through Data Queries | Base | 0.4438 | 0.4438 | Allowed |
| 5 | 532 | Insertion of Sensitive Information into Log File | Base | 0.4407 | 0.4407 | Allowed |
| 6 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4354 | 0.4354 | Allowed |
| 7 | 306 | Missing Authentication for Critical Function | Base | 0.4310 | 0.4310 | Allowed |
| 8 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4306 | 0.4306 | Allowed |
| 9 | 598 | Use of GET Request Method With Sensitive Query Strings | Variant | 0.4295 | 0.4295 | Allowed |
| 10 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | 0.4278 | 0.4278 | Discouraged |
| 11 | 1230 | Exposure of Sensitive Information Through Metadata | Base | 0.4133 | 0.4133 | Allowed |
| 12 | 863 | Incorrect Authorization | Class | 0.4114 | 0.4114 | Allowed-with-Review |
| 13 | 522 | Insufficiently Protected Credentials | Class | 0.4112 | 0.4112 | Allowed-with-Review |
| 14 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4109 | 0.4109 | Allowed |
| 15 | 285 | Improper Authorization | Class | 0.4097 | 0.4097 | Discouraged |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 306 | Missing Authentication for Critical Function | 511.7289 | 511.7289 | Allowed |
| 2 | 863 | Incorrect Authorization | 483.1392 | 483.1392 | Allowed-with-Review |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | 474.0127 | 474.0127 | Allowed |
| 4 | 522 | Insufficiently Protected Credentials | 472.7230 | 472.7230 | Allowed-with-Review |
| 5 | 285 | Improper Authorization | 469.8830 | 469.8830 | Discouraged |
| 6 | 862 | Missing Authorization | 460.7224 | 460.7224 | Allowed-with-Review |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | 458.6199 | 458.6199 | Allowed |
| 8 | 284 | Improper Access Control | 457.6614 | 457.6614 | Discouraged |
| 9 | 532 | Insertion of Sensitive Information into Log File | 457.6302 | 457.6302 | Allowed |
| 10 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 457.4383 | 457.4383 | Allowed |
| 11 | 1390 | Weak Authentication | 146.4096 | 146.4096 | Allowed-with-Review |
