# Raw Retriever Results for CVE-2025-3522

# Raw Retriever Results for CVE-2025-3522
## Query
Thunderbird processes the X-Mozilla-External-Attachment-URL header to handle attachments which can be hosted externally. When an email is opened, Thunderbird accesses the specified URL to determine file size, and navigates to it when the user clicks the attachment. Because the URL is not validated or sanitized, it can reference internal resources like chrome// or SMB share file// links, potentially leading to hashed Windows credential leakage and opening the door to more serious security issues. This vulnerability affects Thunderbird < 137.0.2 and Thunderbird < 128.9.2.

## Keyphrases
- **rootcause**: 'improper URL sanitization'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4432 | 0.5641 | 0.4682 | 0.4620 | 20 |
| Sparse | 422.4410 | 464.8777 | 443.7653 | 442.5254 | 10 |
| Graph | 1.3010 | 2.4700 | 1.8762 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 2.4700 | Allowed |
| 2 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | base | 2.3998 | Allowed |
| 3 | 184 | Incomplete List of Disallowed Inputs | base | 2.2100 | Allowed |
| 4 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 5 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 6 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 7 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 8 | 822 | Untrusted Pointer Dereference | base | 2.2100 | Allowed |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.1190 | Allowed |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 11 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 12 | 125 | Out-of-bounds Read | base | 1.7680 | Allowed |
| 13 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 14 | 129 | Improper Validation of Array Index | variant | 1.6320 | Allowed |
| 15 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 1.6320 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1022 | Use of Web Link to Untrusted Target with window.opener Access | Variant | 0.5641 | 0.5641 | Allowed |
| 2 | 610 | Externally Controlled Reference to a Resource in Another Sphere | Class | 0.5030 | 0.5030 | Discouraged |
| 3 | 451 | User Interface (UI) Misrepresentation of Critical Information | Class | 0.4857 | 0.4857 | Allowed-with-Review |
| 4 | 830 | Inclusion of Web Functionality from an Untrusted Source | Variant | 0.4842 | 0.4842 | Allowed |
| 5 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | 0.4806 | 0.4806 | Allowed |
| 6 | 356 | Product UI does not Warn User of Unsafe Actions | Base | 0.4725 | 0.4725 | Allowed |
| 7 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4708 | 0.4708 | Allowed |
| 8 | 618 | Exposed Unsafe ActiveX Method | Variant | 0.4706 | 0.4706 | Allowed |
| 9 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.4686 | 0.4686 | Allowed |
| 10 | 40 | Path Traversal: '\\UNC\share\name\' (Windows UNC Share) | Variant | 0.4664 | 0.4664 | Allowed |
| 11 | 611 | Improper Restriction of XML External Entity Reference | Base | 0.4576 | 0.4576 | Allowed |
| 12 | 427 | Uncontrolled Search Path Element | Base | 0.4567 | 0.4567 | Allowed |
| 13 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | 0.4542 | 0.4542 | Allowed |
| 14 | 403 | Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak') | Base | 0.4498 | 0.4498 | Allowed |
| 15 | 787 | Out-of-bounds Write | Base | 0.4495 | 0.4495 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 464.8777 | 464.8777 | Allowed |
| 2 | 610 | Externally Controlled Reference to a Resource in Another Sphere | 462.6034 | 462.6034 | Discouraged |
| 3 | 451 | User Interface (UI) Misrepresentation of Critical Information | 454.7494 | 454.7494 | Allowed-with-Review |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 451.1114 | 451.1114 | Allowed |
| 5 | 787 | Out-of-bounds Write | 444.4137 | 444.4137 | Allowed |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 440.6370 | 440.6370 | Allowed-with-Review |
| 7 | 116 | Improper Encoding or Escaping of Output | 437.2972 | 437.2972 | Allowed-with-Review |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | 436.3048 | 436.3048 | Allowed |
| 9 | 201 | Insertion of Sensitive Information Into Sent Data | 423.2174 | 423.2174 | Allowed |
| 10 | 356 | Product UI does not Warn User of Unsafe Actions | 422.4410 | 422.4410 | Allowed |
