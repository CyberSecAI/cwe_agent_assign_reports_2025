## Vulnerability Description
Thunderbird processes the X-Mozilla-External-Attachment-URL header to handle attachments which can be hosted externally. When an email is opened, Thunderbird accesses the specified URL to determine file size, and navigates to it when the user clicks the attachment. Because the URL is not validated or sanitized, it can reference internal resources like chrome// or SMB share file// links, potentially leading to hashed Windows credential leakage and opening the door to more serious security issues. This vulnerability affects Thunderbird < 137.0.2 and Thunderbird < 128.9.2.

### Vulnerability Description Key Phrases
- **rootcause:** **improper URL sanitization**
- **impact:** hashed Windows credential leakage
- **product:** Thunderbird
- **version:** < 137.0.2 and Thunderbird < 128.9.2

## CVE Reference Links Content Summary
## CVE-2025-3522 Analysis

The provided content directly relates to CVE-2025-3522. It's a Mozilla Foundation Security Advisory detailing vulnerabilities fixed in Thunderbird. The content provides more detail than a typical CVE description.

**Root cause of vulnerability:**

Thunderbird processes the `X-Mozilla-External-Attachment-URL` header to handle externally hosted attachments. It accesses the specified URL to determine file size and navigates to it when clicked.

**Weaknesses/vulnerabilities present:**

*   The URL is not validated or sanitized.
*   Allows referencing internal resources like `chrome://` or SMB share `file://` links.

**Impact of exploitation:**

*   Hashed Windows credential leakage.
*   Potential for more serious security issues.

**Attack vectors:**

*   Crafted email with a malicious `X-Mozilla-External-Attachment-URL` header.

**Required attacker capabilities/position:**

*   Ability to send a crafted email to a Thunderbird user.

**Mitigation or fix:**

*   The vulnerability is fixed in Thunderbird 128.9.2 and 137.0.2.
*   (Implied) Proper validation and sanitization of the `X-Mozilla-External-Attachment-URL` header.

**References:**

*   [Bug 1955372](https://bugzilla.mozilla.org/show_bug.cgi?id=1955372)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.465 |
| 2 | 610 | Externally Controlled Reference to a Resource in Another Sphere | Class | Discouraged | sparse | 0.463 |
| 3 | 451 | User Interface (UI) Misrepresentation of Critical Information | Class | Allowed-with-Review | sparse | 0.455 |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.451 |
| 5 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.444 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.441 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.437 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.436 |
| 9 | 1022 | Use of Web Link to Untrusted Target with window.opener Access | Variant | Allowed | dense | 0.564 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-610: Externally Controlled Reference to a Resource in Another Sphere

CWE-451: User Interface (UI) Misrepresentation of Critical Information

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-787: Out-of-bounds Write

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-116: Improper Encoding or Escaping of Output

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-1022: Use of Web Link to Untrusted Target with window.opener Access

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')