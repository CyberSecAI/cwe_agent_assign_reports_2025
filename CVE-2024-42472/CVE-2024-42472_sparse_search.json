{
  "retriever": "sparse",
  "query": "Flatpak is a Linux application sandboxing and distribution framework. Prior to versions 1.14.0 and 1.15.10, a malicious or compromised Flatpak app using persistent directories could access and write files outside of what it would otherwise have access to, which is an attack on integrity and confidentiality. When `persistent=subdir` is used in the application permissions (represented as `--persist=subdir` in the command-line interface), that means that an application which otherwise doesnt have access to the real user home directory will see an empty home directory with a writeable subdirectory `subdir`. Behind the scenes, this directory is actually a bind mount and the data is stored in the per-application directory as `~/.var/app/$APPID/subdir`. This allows existing apps that are not aware of the per-application directory to still work as intended without general home directory access. However, the application does have write access to the application directory `~/.var/app/$APPID` where this directory is stored. If the source directory for the `persistent`/`--persist` option is replaced by a symlink, then the next time the application is started, the bind mount will follow the symlink and mount whatever it points to into the sandbox. Partial protection against this vulnerability can be provided by patching Flatpak using the patches in commits ceec2ffc and 98f79773. However, this leaves a race condition that could be exploited by two instances of a malicious app running i",
  "keyphrases": {
    "rootcause": [
      "race condition"
    ],
    "weakness": [
      "symlink following"
    ]
  },
  "timestamp": "2025-07-12 03:45:42",
  "cve_id": "CVE-2024-42472",
  "result_count": 14,
  "results": [
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 1340.2737575885512,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "22",
      "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
      "score": 1297.8222333126448,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "61",
      "name": "UNIX Symbolic Link (Symlink) Following",
      "score": 1296.428949180784,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "59",
      "name": "Improper Link Resolution Before File Access ('Link Following')",
      "score": 1280.4556222290887,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "99",
      "name": "Improper Control of Resource Identifiers ('Resource Injection')",
      "score": 1269.6287890871836,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "184",
      "name": "Incomplete List of Disallowed Inputs",
      "score": 1266.206556540685,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 1242.3128810309593,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "277",
      "name": "Insecure Inherited Permissions",
      "score": 1239.1860320769802,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "732",
      "name": "Incorrect Permission Assignment for Critical Resource",
      "score": 1230.0926196983178,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "427",
      "name": "Uncontrolled Search Path Element",
      "score": 1218.761608423943,
      "search_source": "rootcause:race condition"
    },
    {
      "cwe_id": "23",
      "name": "Relative Path Traversal",
      "score": 1140.4117668736696,
      "search_source": "weakness:symlink following"
    },
    {
      "cwe_id": "64",
      "name": "Windows Shortcut Following (.LNK)",
      "score": 800.0,
      "search_source": "alternate_term_match"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 405.7443681990884,
      "search_source": "base_query"
    },
    {
      "cwe_id": "923",
      "name": "Improper Restriction of Communication Channel to Intended Endpoints",
      "score": 405.2821656411507,
      "search_source": "base_query"
    }
  ]
}