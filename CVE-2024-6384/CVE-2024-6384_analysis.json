{
  "cve_id": "CVE-2024-6384",
  "description": "Hot backup files may be downloaded by underprivileged users, if they are capable of acquiring a unique backup identifier. This issue affects MongoDB Enterprise Server v6.0 versions prior to 6.0.16, MongoDB Enterprise Server v7.0 versions prior to 7.0.11 and MongoDB Enterprise Server v7.3 versions prior to 7.3.3",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "download Hot backup files",
    "vector": "acquiring a unique backup identifier",
    "attacker": "underprivileged users",
    "product": "MongoDB Enterprise Server",
    "version": [
      "v6.0 versions prior to 6.0.16",
      "v7.0 versions prior to 7.0.11",
      "v7.3 versions prior to 7.3.3"
    ],
    "component": ""
  },
  "reference_content": "Based on the provided information, here's an analysis of CVE-2024-6384:\n\n**Root Cause of Vulnerability:**\nThe vulnerability stems from improper authorization in MongoDB Enterprise Server where \"hot\" backup files can be downloaded by underprivileged users.\n\n**Weaknesses/Vulnerabilities Present:**\n- **Improper Authorization (CWE-285):** The system fails to properly restrict access to backup files, allowing users with insufficient privileges to download them.\n- **Information Disclosure:** The vulnerability allows unauthorized access to potentially sensitive data contained within the backup files.\n\n**Impact of Exploitation:**\n- **Sensitive Information Disclosure:** An attacker who can obtain a unique backup identifier can download backup files. These backup files may contain sensitive data.\n\n**Attack Vectors:**\n- The attack vector is network-based (AV:N).\n- The attacker needs to acquire a unique backup identifier. The method of acquiring the backup identifier is not specified in the provided content.\n\n**Required Attacker Capabilities/Position:**\n- The attacker must have low privileges (PR:L).\n- The attacker does not require user interaction (UI:N).\n- The attacker needs to acquire a unique backup identifier.\n- The attack requires high attack complexity (AC:H)\n\n**Affected Product Versions:**\n- MongoDB Enterprise Server 6.0 versions prior to 6.0.16\n- MongoDB Enterprise Server 7.0 versions prior to 7.0.11\n- MongoDB Enterprise Server 7.3 versions prior to 7.3.3\n\n**CVSS Score:**\n5.3 (MEDIUM) - CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N\n\n**Additional Notes:**\n- The NetApp advisory indicates that some NetApp products incorporate vulnerable versions of MongoDB, but it also states that the specific products listed are \"Not Affected\".\n- The vulnerability is fixed in MongoDB Enterprise Server versions 6.0.16, 7.0.11, and 7.3.3.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n\n| CWE ID  | CWE Name                                                                     | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :--------------------------------------------------------------------------- | :---------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-285   | Improper Authorization                                                       | 1         | Base                  | Primary                         | Allowed                         |\n| CWE-530   | Exposure of Backup File to an Unauthorized Control Sphere                   | 0.75      | Variant               | Secondary                       | Allowed                         |\n| CWE-200   | Exposure of Sensitive Information to an Unauthorized Actor                  | 0.5      | Class                 | Secondary                       | Discouraged                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\n\nThe primary weakness is **CWE-285 Improper Authorization**, which is a base-level CWE detailing a failure to properly authorize access to a resource. The secondary weakness, **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere**, is a variant that represents the specific case of exposing backup files. **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** is a class-level CWE that represents the general impact of the vulnerability.\n\n```mermaid\ngraph TD\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe530[\"CWE-530: Exposure of Backup File to an Unauthorized Control Sphere\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n\n    cwe530 -->|CHILDOF| cwe668[\"CWE-668: Exposure of Resource to Wrong Sphere\"]\n    cwe285 -->|CANPRECEDE| cwe200\n    cwe530 -->|PEEROF| cwe285\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe285 primary\n    class cwe530 secondary\n    class cwe200 tertiary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with **CWE-285 Improper Authorization**, which allows underprivileged users to download hot backup files if they can acquire a unique backup identifier. This leads to **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere**, and ultimately to **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor**, as the backup files may contain sensitive data.\n\n## Summary of Analysis\n\nThe analysis is based on the provided evidence, which clearly indicates an authorization issue. The vulnerability description states that \"Hot backup files may be downloaded by underprivileged users, if they are capable of acquiring a unique backup identifier.\" This aligns directly with **CWE-285 Improper Authorization**, as the system **fails to properly restrict access** to backup files based on user privileges.\n\nThe **CVE Reference Links Content Summary** section confirms this, stating that \"The vulnerability stems from **improper authorization** in MongoDB Enterprise Server where 'hot' backup files can be downloaded by underprivileged users.\"\n\nThe selection of **CWE-285 Improper Authorization** as the primary CWE is based on its direct relevance to the **root cause** of the vulnerability. **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere** is a more specific variant that describes the particular type of resource being exposed. **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** is a more general CWE that describes the potential impact of the vulnerability, but it is not the root cause.\n\nThe relationships between these CWEs are also relevant. **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere** is a child of **CWE-668 Exposure of Resource to Wrong Sphere**, which is a more general CWE that describes the exposure of a resource to the wrong control sphere. **CWE-285 Improper Authorization** can precede **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor**, as the authorization failure leads to the exposure of sensitive information.\n\nThe selected CWEs are at the optimal level of specificity. **CWE-285 Improper Authorization** is a base-level CWE that accurately describes the root cause of the vulnerability. **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere** is a variant that provides additional context about the specific type of resource being exposed. **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** is a class-level CWE that describes the general impact of the vulnerability.\n\nThe retriever results also support the selection of these CWEs. **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere** is ranked 9th with a score of 0.553. **CWE-285 Improper Authorization** is not listed in retriever results, because it was not provided.\nOther CWEs were considered but not selected because they were not as directly relevant to the root cause of the vulnerability. For example, **CWE-306 Missing Authentication for Critical Function** was considered, but it was not selected because the vulnerability is related to authorization, not authentication.\n\n**CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** was considered, but was ultimately selected as a tertiary issue since it is an impact of the **improper authorization** and exposure of the backup files, not the root cause. The mapping guidance for **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** discourages its usage as it's a technical impact, not a root cause error.",
  "analysis_with_relationships": "# Summary\n\n| CWE ID  | CWE Name                                                                     | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :--------------------------------------------------------------------------- | :---------- | :-------------------- | :------------------------------ | :------------------------------ |\n| CWE-285   | Improper Authorization                                                       | 1         | Base                  | Primary                         | Allowed                         |\n| CWE-530   | Exposure of Backup File to an Unauthorized Control Sphere                   | 0.75      | Variant               | Secondary                       | Allowed                         |\n| CWE-200   | Exposure of Sensitive Information to an Unauthorized Actor                  | 0.5      | Class                 | Secondary                       | Discouraged                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.85\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\n\nThe primary weakness is **CWE-285 Improper Authorization**, which is a base-level CWE detailing a failure to properly authorize access to a resource. The secondary weakness, **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere**, is a variant that represents the specific case of exposing backup files. **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** is a class-level CWE that represents the general impact of the vulnerability.\n\n```mermaid\ngraph TD\n    cwe285[\"CWE-285: Improper Authorization\"]\n    cwe530[\"CWE-530: Exposure of Backup File to an Unauthorized Control Sphere\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n\n    cwe530 -->|CHILDOF| cwe668[\"CWE-668: Exposure of Resource to Wrong Sphere\"]\n    cwe285 -->|CANPRECEDE| cwe200\n    cwe530 -->|PEEROF| cwe285\n\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe285 primary\n    class cwe530 secondary\n    class cwe200 tertiary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with **CWE-285 Improper Authorization**, which allows underprivileged users to download hot backup files if they can acquire a unique backup identifier. This leads to **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere**, and ultimately to **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor**, as the backup files may contain sensitive data.\n\n## Summary of Analysis\n\nThe analysis is based on the provided evidence, which clearly indicates an authorization issue. The vulnerability description states that \"Hot backup files may be downloaded by underprivileged users, if they are capable of acquiring a unique backup identifier.\" This aligns directly with **CWE-285 Improper Authorization**, as the system **fails to properly restrict access** to backup files based on user privileges.\n\nThe **CVE Reference Links Content Summary** section confirms this, stating that \"The vulnerability stems from **improper authorization** in MongoDB Enterprise Server where 'hot' backup files can be downloaded by underprivileged users.\"\n\nThe selection of **CWE-285 Improper Authorization** as the primary CWE is based on its direct relevance to the **root cause** of the vulnerability. **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere** is a more specific variant that describes the particular type of resource being exposed. **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** is a more general CWE that describes the potential impact of the vulnerability, but it is not the root cause.\n\nThe relationships between these CWEs are also relevant. **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere** is a child of **CWE-668 Exposure of Resource to Wrong Sphere**, which is a more general CWE that describes the exposure of a resource to the wrong control sphere. **CWE-285 Improper Authorization** can precede **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor**, as the authorization failure leads to the exposure of sensitive information.\n\nThe selected CWEs are at the optimal level of specificity. **CWE-285 Improper Authorization** is a base-level CWE that accurately describes the root cause of the vulnerability. **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere** is a variant that provides additional context about the specific type of resource being exposed. **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** is a class-level CWE that describes the general impact of the vulnerability.\n\nThe retriever results also support the selection of these CWEs. **CWE-530 Exposure of Backup File to an Unauthorized Control Sphere** is ranked 9th with a score of 0.553. **CWE-285 Improper Authorization** is not listed in retriever results, because it was not provided.\nOther CWEs were considered but not selected because they were not as directly relevant to the root cause of the vulnerability. For example, **CWE-306 Missing Authentication for Critical Function** was considered, but it was not selected because the vulnerability is related to authorization, not authentication.\n\n**CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** was considered, but was ultimately selected as a tertiary issue since it is an impact of the **improper authorization** and exposure of the backup files, not the root cause. The mapping guidance for **CWE-200 Exposure of Sensitive Information to an Unauthorized Actor** discourages its usage as it's a technical impact, not a root cause error.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-306:**\n- 306 (Missing Authentication for Critical Function) - ROOT\n\n\n**Chain starting from CWE-285:**\n- 285 (Improper Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "1007",
        "name": "Insufficient Visual Distinction of Homoglyphs Presented to User",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Homograph Attack",
        "match_reason": "phrase_in_term_compound_part_2"
      },
      "similarity": 700.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "119",
        "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: memory safety",
        "match_reason": "phrase_in_term_compound_part_2"
      },
      "similarity": 700.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "300",
        "name": "Channel Accessible by Non-Endpoint",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Monkey-in-the-Middle",
        "match_reason": "phrase_in_term_compound_part_2"
      },
      "similarity": 700.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "522",
        "name": "Insufficiently Protected Credentials",
        "source": "sparse"
      },
      "similarity": 95.41464973543675
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 92.99365780680351
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "sparse"
      },
      "similarity": 91.82810655343032
    },
    {
      "metadata": {
        "doc_id": "295",
        "name": "Improper Certificate Validation",
        "source": "sparse"
      },
      "similarity": 91.55100877090624
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 91.43875827150727
    },
    {
      "metadata": {
        "doc_id": "530",
        "name": "Exposure of Backup File to an Unauthorized Control Sphere",
        "type": "Variant",
        "original_content": "A backup file is stored in a directory or archive that is made accessible to unauthorized actors.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.552672686803231,
            "graph": 1.087459386722239
          }
        }
      },
      "similarity": 0.552672686803231
    },
    {
      "doc_id": "226",
      "text": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "226",
        "name": "Sensitive Information in Resource Not Removed Before Reuse",
        "type": "base",
        "original_content": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
        "relationships": [
          {
            "source_id": "226",
            "target_id": "244",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1342",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1301",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1272",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1239",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "201",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "212",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "459",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "459",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "244",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "212",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "201",
            "target_id": "226",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1301",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1272",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "201"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "201"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "226",
                  "201",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "201"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-306",
      "CWE-285",
      "CWE-668",
      "CWE-200",
      "CWE-530"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}