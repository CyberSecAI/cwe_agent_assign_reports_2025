# Vulnerability Information: CVE-2024-6384

## Vulnerability Description
Hot backup files may be downloaded by underprivileged users, if they are capable of acquiring a unique backup identifier. This issue affects MongoDB Enterprise Server v6.0 versions prior to 6.0.16, MongoDB Enterprise Server v7.0 versions prior to 7.0.11 and MongoDB Enterprise Server v7.3 versions prior to 7.3.3

### Vulnerability Description Key Phrases
- **impact:** download Hot backup files
- **vector:** acquiring a unique backup identifier
- **attacker:** underprivileged users
- **product:** MongoDB Enterprise Server
- **version:** v6.0 versions prior to 6.0.16 and v7.0 versions prior to 7.0.11 and v7.3 versions prior to 7.3.3

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-6384:

**Root Cause of Vulnerability:**
The vulnerability stems from improper authorization in MongoDB Enterprise Server where "hot" backup files can be downloaded by underprivileged users.

**Weaknesses/Vulnerabilities Present:**
- **Improper Authorization (CWE-285):** The system fails to properly restrict access to backup files, allowing users with insufficient privileges to download them.
- **Information Disclosure:** The vulnerability allows unauthorized access to potentially sensitive data contained within the backup files.

**Impact of Exploitation:**
- **Sensitive Information Disclosure:** An attacker who can obtain a unique backup identifier can download backup files. These backup files may contain sensitive data.

**Attack Vectors:**
- The attack vector is network-based (AV:N).
- The attacker needs to acquire a unique backup identifier. The method of acquiring the backup identifier is not specified in the provided content.

**Required Attacker Capabilities/Position:**
- The attacker must have low privileges (PR:L).
- The attacker does not require user interaction (UI:N).
- The attacker needs to acquire a unique backup identifier.
- The attack requires high attack complexity (AC:H)

**Affected Product Versions:**
- MongoDB Enterprise Server 6.0 versions prior to 6.0.16
- MongoDB Enterprise Server 7.0 versions prior to 7.0.11
- MongoDB Enterprise Server 7.3 versions prior to 7.3.3

**CVSS Score:**
5.3 (MEDIUM) - CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N

**Additional Notes:**
- The NetApp advisory indicates that some NetApp products incorporate vulnerable versions of MongoDB, but it also states that the specific products listed are "Not Affected".
- The vulnerability is fixed in MongoDB Enterprise Server versions 6.0.16, 7.0.11, and 7.3.3.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1007 | Insufficient Visual Distinction of Homoglyphs Presented to User | Base | Allowed | alternate_terms | 0.700 |
| 2 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.700 |
| 3 | 300 | Channel Accessible by Non-Endpoint | Class | Discouraged | alternate_terms | 0.700 |
| 4 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.095 |
| 5 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.093 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.092 |
| 7 | 295 | Improper Certificate Validation | Base | Allowed | sparse | 0.092 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.091 |
| 9 | 530 | Exposure of Backup File to an Unauthorized Control Sphere | Variant | Allowed | dense | 0.553 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |

