## Vulnerability Description
Netty, an asynchronous, event-driven network application framework, has a vulnerability starting in version 4.1.91.Final and prior to version 4.1.118.Final. When a special crafted packet is received via SslHandler it doesnt correctly handle validation of such a packet in all cases which can lead to a native crash. Version 4.1.118.Final contains a patch. As workaround its possible to either disable the usage of the native SSLEngine or change the code manually.

### Vulnerability Description Key Phrases
- **weakness:** **improper validation**
- **impact:** native crash
- **vector:** special crafted packet
- **product:** Netty
- **version:** 4.1.91.Final to 4.1.118.Final
- **component:** SslHandler

## CVE Reference Links Content Summary
```
Root cause of vulnerability:
SslHandler doesn't correctly validate packets, leading to a native crash when using a native SSLEngine.

Weaknesses/vulnerabilities present:
Incorrect handling of validation of specially crafted packets received via SslHandler.

Impact of exploitation:
Native crash.

Attack vectors:
Receiving a special crafted packet via SslHandler.

Required attacker capabilities/position:
Network access.

Mitigation or fix:
- Disable the usage of the native SSLEngine.
- Change the code from: `SslContext context = ...; SslHandler handler = context.newHandler(....);` to: `SslContext context = ...; SSLEngine engine = context.newEngine(....); SslHandler handler = new SslHandler(engine, ....);`

Affected versions:
4.1.91.Final <= 4.1.117.Final

Patched versions:
>= 4.1.118.Final

CVSS score: 7.5 (High)
CVSS vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 378 | Creation of Temporary File With Insecure Permissions | Base | Allowed | sparse | 0.469 |
| 2 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.400 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.389 |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.380 |
| 5 | 346 | Origin Validation Error | Class | Allowed-with-Review | sparse | 0.378 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.371 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.371 |
| 8 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.369 |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | dense | 0.522 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-378: Creation of Temporary File With Insecure Permissions

CWE-674: Uncontrolled Recursion

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-346: Origin Validation Error

CWE-1390: Weak Authentication

CWE-116: Improper Encoding or Escaping of Output

CWE-1333: Inefficient Regular Expression Complexity

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')