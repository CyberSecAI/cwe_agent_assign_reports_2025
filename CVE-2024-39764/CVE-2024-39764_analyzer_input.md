# Vulnerability Information: CVE-2024-39764

## Vulnerability Description
Multiple **OS command injection** vulnerabilities exist in the internet.cgi set_add_routing() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to arbitrary command execution. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.A command injection vulnerability exists in the `dest` POST parameter.

### Vulnerability Description Key Phrases
- **weakness:** **OS command injection**
- **impact:** arbitrary command execution
- **vector:** specially crafted HTTP request
- **attacker:** attacker
- **product:** Wavlink AC3000
- **version:** M33A8.V5030.210505
- **component:** internet.cgi set_add_routing() functionality

## CVE Reference Links Content Summary
CVE-2024-39764

**Root cause of vulnerability:**
Improper neutralization of special elements in commands, specifically command injection vulnerabilities in the `internet.cgi` script's `set_add_routing()` function. The script does not properly sanitize user-supplied input from HTTP POST parameters before using them in system commands executed via `popen`.

**Weaknesses/vulnerabilities present:**
- CWE-77 - Improper Neutralization of Special Elements used in a Command (‘Command Injection’)
- OS Command Injection

**Impact of exploitation:**
Arbitrary command execution on the affected device.

**Attack vectors:**
- Network-accessible HTTP POST requests to the `internet.cgi` script with crafted parameters (`dest`, `hostnet`, `netmask`, `gateway`, `interface`, `custom_interface`, `comment`).
- Authenticated access is required (session cookie check), but the vulnerability exists after successful authentication.

**Required attacker capabilities/position:**
- Network access to the Wavlink AC3000 router.
- Valid session cookie (authenticated user).
- Ability to craft malicious HTTP POST requests.

**Mitigation or fix:**
The report states the product has been discontinued, but patches were being worked on as of late 2024. No specific mitigation is provided in the report beyond patching.

**Additional Details (more detail than official CVE description):**

*   **Affected Product:** Wavlink AC3000 M33A8.V5030.210505
*   **Vulnerable Function:** `set_add_routing()` in `internet.cgi`
*   **Specific Parameters Vulnerable:** `dest`, `hostnet`, `netmask`, `gateway`, `interface`, `custom_interface`, and `comment` HTTP POST parameters.
*   The report details the specific code locations where the vulnerabilities exist and how the input is used in system commands.
*   Multiple CVEs are associated with this report: CVE-2024-39762, CVE-2024-39763, CVE-2024-39764, CVE-2024-39765. Each CVE corresponds to a specific parameter that is vulnerable to command injection.
*   CVSSv3 Score: 9.1 (Critical)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 0.800 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.355 |
| 4 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.342 |
| 5 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.340 |
| 6 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.321 |
| 7 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.318 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.307 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.630 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |

