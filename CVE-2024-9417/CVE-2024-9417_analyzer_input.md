# Vulnerability Information: CVE-2024-9417

## Vulnerability Description
The Hash Form - Drag & Drop Form Builder plugin for WordPress is vulnerable to limited file uploads due to a **misconfigured file type validation** in the handleUpload function in all versions up to, and including, 1.1.9. This makes it possible for unauthenticated attackers to upload files that are excluded from both the allowedExtensions and unallowed_extensions arrays on the affected sites server, including files that may contain **cross-site scripting**.

### Vulnerability Description Key Phrases
- **rootcause:** **misconfigured file type validation**
- **weakness:** **cross-site scripting**
- **impact:** limited file uploads and upload files
- **attacker:** unauthenticated attackers
- **product:** Hash Form - Drag & Drop Form Builder plugin for WordPress
- **version:** all versions up to and including 1.1.9
- **component:** handleUpload function

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a misconfigured file type validation within the `handleUpload` function of the Hash Form â€“ Drag & Drop Form Builder plugin. Specifically, the logic for checking allowed and disallowed file extensions was flawed.

**Weaknesses/Vulnerabilities:**

*   **Inadequate File Extension Check:** The code checks if an extension is in `$unallowed_extensions`. However, it fails to properly prevent upload of files that are neither explicitly allowed or disallowed. This means that if a file extension is not in the allowed extensions array, it was still being uploaded if it was not explicitly in the disallowed array.
*   **Unauthenticated File Upload:** The vulnerability allows unauthenticated users to upload files.
*   **Limited File Upload:** It's a "limited" file upload vulnerability because it doesn't allow for *any* file, but files which are not in the allowed or disallowed lists can be uploaded.

**Impact of Exploitation:**

*   **Cross-Site Scripting (XSS):** Attackers can upload files with malicious content (e.g., SVG files containing XSS payloads), potentially leading to XSS attacks when the uploaded file is accessed.
*   **Arbitrary file upload:** The vulnerability may be leveraged to upload files to the server that the website administrator did not intend to allow.

**Attack Vectors:**

*   **Network:** The attack can be performed remotely by sending a crafted HTTP request.
*   **Unauthenticated:** No authentication is required to exploit this vulnerability.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to send HTTP requests to the affected WordPress site.
*   The attacker does not need any special privileges or to be logged in.

**Technical Details:**

*   The vulnerable code is located in the `HashFormUploader.php` file, specifically within the `handleUpload` function.
*   The vulnerability exists because the check was intended to prevent uploads of disallowed extensions, and only allow allowed extensions. However the logic only explicitly blocked disallowed extensions.
*   The fix involves a change in logic to correctly block disallowed extensions while also ensuring that if the allowed extensions list is defined, only extensions in that list are allowed.

**Additional Notes:**

* The vulnerability is present in versions <= 1.1.9 of the plugin.
* The patched version is 1.2.0.
* The Wordfence article highlights the vulnerability and provides a link to the relevant code changes in the WordPress plugin repository.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.452 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.424 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.412 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.409 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.406 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.402 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.400 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.400 |
| 9 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | Allowed | dense | 0.509 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

