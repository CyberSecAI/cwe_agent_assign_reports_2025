{
  "query": "OpenFGA is a high-performance and flexible authorization/permission engine built for developers and inspired by Google Zanzibar. OpenFGA < v1.8.4 (Helm chart < openfga-0.2.22, docker < v.1.8.4) are vulnerable to authorization bypass when certain Check and ListObject calls are executed. Users on OpenFGA v1.8.4 or previous, specifically under the following conditions are affected by this authorization bypass vulnerability 1. Calling Check API or ListObjects with a model that has a relation directly assignable to both public access AND userset with the same type. 2. A type bound public access tuple is assigned to an object. 3. userset tuple is not assigned to the same object. and 4. Check requests user field is a userset that has the same type as the type bound public access tuples user type. Users are advised to upgrade to v1.8.5 which is backwards compatible. There are no known workarounds for this vulnerability.",
  "keyphrases": {
    "weakness": [
      "authorization bypass"
    ]
  },
  "timestamp": "2025-07-12T10:58:30.428669",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 1.687320488828504,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 1.604710439068408,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "266",
        "name": "Incorrect Privilege Assignment",
        "abstraction": "Base",
        "score": 1.418240309623775,
        "description": "A product incorrectly assigns a privilege to a particular actor, creating an unintended sphere of control for that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1299",
        "name": "Missing Protection Mechanism for Alternate Hardware Interface",
        "abstraction": "base",
        "score": 1.1793600000000002,
        "description": "CWE-1299: Missing Protection Mechanism for Alternate Hardware Interface...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1191",
        "name": "On-Chip Debug and Test Interface With Improper Access Control",
        "abstraction": "base",
        "score": 1.1466,
        "description": "CWE-1191: On-Chip Debug and Test Interface With Improper Access Control...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 1.0576916809524464,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "284",
        "name": "Improper Access Control",
        "abstraction": "pillar",
        "score": 1.056,
        "description": "CWE-284: Improper Access Control...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "286",
        "name": "Incorrect User Management",
        "abstraction": "Class",
        "score": 1.0518782746007858,
        "description": "The product does not properly manage a user within its environment....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 1.0455642332701667,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "862",
        "name": "Missing Authorization",
        "abstraction": "Class",
        "score": 1.0334944477236019,
        "description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "1274",
        "name": "Improper Access Control for Volatile Memory Containing Boot Code",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1274: Improper Access Control for Volatile Memory Containing Boot Code...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "749",
        "name": "Exposed Dangerous Method or Function",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-749: Exposed Dangerous Method or Function...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1334",
        "name": "Unauthorized Error Injection Can Degrade Hardware Redundancy",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1334: Unauthorized Error Injection Can Degrade Hardware Redundancy...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1323",
        "name": "Improper Management of Sensitive Trace Data",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1323: Improper Management of Sensitive Trace Data...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1320",
        "name": "Improper Protection for Outbound Error Messages and Alert Signals",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1320: Improper Protection for Outbound Error Messages and Alert Signals...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1317",
        "name": "Improper Access Control in Fabric Bridge",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1317: Improper Access Control in Fabric Bridge...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1316",
        "name": "Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1316: Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1315",
        "name": "Improper Setting of Bus Controlling Capability in Fabric End-point",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1315: Improper Setting of Bus Controlling Capability in Fabric End-point...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1313",
        "name": "Hardware Allows Activation of Test or Debug Logic at Runtime",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1313: Hardware Allows Activation of Test or Debug Logic at Runtime...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1312",
        "name": "Missing Protection for Mirrored Regions in On-Chip Fabric Firewall",
        "abstraction": "base",
        "score": 1.0062,
        "description": "CWE-1312: Missing Protection for Mirrored Regions in On-Chip Fabric Firewall...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 0.5088155179187495,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "612",
        "name": "Improper Authorization of Index Containing Sensitive Information",
        "abstraction": "Base",
        "score": 0.48767335034650705,
        "description": "The product creates a search index of private or sensitive documents, but it does not properly limit index access to actors who are authorized to see the original information....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 0.4857726972714668,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "286",
        "name": "Incorrect User Management",
        "abstraction": "Class",
        "score": 0.48535994251550946,
        "description": "The product does not properly manage a user within its environment....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 0.479041555946747,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "267",
        "name": "Privilege Defined With Unsafe Actions",
        "abstraction": "Base",
        "score": 0.47761803699028393,
        "description": "A particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "842",
        "name": "Placement of User into Incorrect Group",
        "abstraction": "Base",
        "score": 0.46248889165627555,
        "description": "The product or the administrator places a user into an incorrect group....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "204",
        "name": "Observable Response Discrepancy",
        "abstraction": "Base",
        "score": 0.45650948654967116,
        "description": "The product provides different responses to incoming requests in a way that reveals internal state information to an unauthorized actor outside of the intended control sphere....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "305",
        "name": "Authentication Bypass by Primary Weakness",
        "abstraction": "Base",
        "score": 0.45433564229399154,
        "description": "The authentication algorithm is sound, but the implemented mechanism can be bypassed as the result of a separate weakness that is primary to the authentication error....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "359",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
        "abstraction": "Base",
        "score": 0.45147924083641944,
        "description": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have t...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "862",
        "name": "Missing Authorization",
        "abstraction": "Class",
        "score": 0.4448403432114501,
        "description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "266",
        "name": "Incorrect Privilege Assignment",
        "abstraction": "Base",
        "score": 0.44455889624052425,
        "description": "A product incorrectly assigns a privilege to a particular actor, creating an unintended sphere of control for that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1390",
        "name": "Weak Authentication",
        "abstraction": "Class",
        "score": 0.4428910807751099,
        "description": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "708",
        "name": "Incorrect Ownership Assignment",
        "abstraction": "Base",
        "score": 0.4424958690171171,
        "description": "The product assigns an owner to a resource, but the owner is outside of the intended control sphere....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1220",
        "name": "Insufficient Granularity of Access Control",
        "abstraction": "Base",
        "score": 0.44059726048660247,
        "description": "The product implements access controls via a policy or other feature with the intention to disable or restrict accesses (reads and/or writes) to assets in a system from untrusted agents. However, impl...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "277",
        "name": "Insecure Inherited Permissions",
        "abstraction": "Variant",
        "score": 0.43919280925608783,
        "description": "A product defines a set of insecure permissions that are inherited by objects that are created by the program....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "129",
        "name": "Improper Validation of Array Index",
        "abstraction": "Variant",
        "score": 0.4386828998244548,
        "description": "The product uses untrusted input when calculating or using an array index, but the product does not validate or incorrectly validates the index to ensure the index references a valid position within t...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 0.4367721616081554,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "480",
        "name": "Use of Incorrect Operator",
        "abstraction": "Base",
        "score": 0.4364601933461762,
        "description": "The product accidentally uses the wrong operator, which changes the logic in security-relevant ways....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "279",
        "name": "Incorrect Execution-Assigned Permissions",
        "abstraction": "Variant",
        "score": 0.43584624205700817,
        "description": "While it is executing, the product sets the permissions of an object in a way that violates the intended permissions that have been specified by the user....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "285",
        "name": "Improper Authorization",
        "abstraction": "Class",
        "score": 829.0512316290723,
        "description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "863",
        "name": "Incorrect Authorization",
        "abstraction": "Class",
        "score": 806.1231209647336,
        "description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "284",
        "name": "Improper Access Control",
        "abstraction": "Pillar",
        "score": 800.0,
        "description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "abstraction": "Base",
        "score": 782.4485438543252,
        "description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "862",
        "name": "Missing Authorization",
        "abstraction": "Class",
        "score": 756.9133755939597,
        "description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "abstraction": "Base",
        "score": 745.8856892458125,
        "description": "The code transmits data to another actor, but a portion of the data includes sensitive information that should not be accessible to that actor....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "306",
        "name": "Missing Authentication for Critical Function",
        "abstraction": "Base",
        "score": 741.8309847012147,
        "description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "287",
        "name": "Improper Authentication",
        "abstraction": "Class",
        "score": 741.5160260885863,
        "description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "abstraction": "Base",
        "score": 733.1592456740078,
        "description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "668",
        "name": "Exposure of Resource to Wrong Sphere",
        "abstraction": "Class",
        "score": 726.8194600420826,
        "description": "The product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "1336",
        "name": "Improper Neutralization of Special Elements Used in a Template Engine",
        "abstraction": "Base",
        "score": 722.3951009696347,
        "description": "The product uses a template engine to insert or process externally-influenced input, but it does not neutralize or incorrectly neutralizes special elements or syntax that can be interpreted as templat...",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.43584624205700817,
      "max": 0.5088155179187495,
      "mean": 0.4575716059074154,
      "median": 0.44815979202393474,
      "count": 20
    },
    "sparse": {
      "min": 722.3951009696347,
      "max": 829.0512316290723,
      "mean": 762.3766162512209,
      "median": 745.8856892458125,
      "count": 11
    },
    "graph": {
      "min": 1.0062,
      "max": 1.687320488828504,
      "mean": 1.1171429937033843,
      "median": 1.019847223861801,
      "count": 20
    }
  }
}