# Raw Retriever Results for CVE-2024-53088

# Raw Retriever Results for CVE-2024-53088
## Query
In the Linux kernel, the following vulnerability has been resolved i40e fix race condition by adding filters intermediate sync state Fix a race condition in the i40e driver that leads to MAC/VLAN filters becoming corrupted and leaking. Address the issue that occurs under heavy load when multiple threads are concurrently modifying MAC/VLAN filters by setting mac and port VLAN. 1. Thread T0 allocates a filter in i40e_add_filter() within i40e_ndo_set_vf_port_vlan(). 2. Thread T1 concurrently frees the filter in __i40e_del_filter() within i40e_ndo_set_vf_mac(). 3. Subsequently, i40e_service_task() calls i40e_sync_vsi_filters(), which refers to the already freed filter memory, causing corruption. Reproduction steps 1. Spawn multiple VFs. 2. Apply a concurrent heavy load by running parallel operations to change MAC addresses on the VFs and change port VLANs on the host. 3. Observe errors in dmesg Error I40E_AQ_RC_ENOSPC adding RX filters on VF XX, please set promiscuous on manually for VF XX. Exact code for stable reproduction Intel cant open-source now. The fix involves implementing a new intermediate filter state, I40E_FILTER_NEW_SYNC, for the time when a filter is on a tmp_add_list. These filters cannot be deleted from the hash list directly but must be removed using the full process.

## Keyphrases
- **rootcause**: 'race condition'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4275 | 0.4770 | 0.4458 | 0.4418 | 20 |
| Sparse | 738.6565 | 1000.0000 | 817.0223 | 793.2711 | 10 |
| Graph | 1.6848 | 3.2188 | 2.1307 | 2.1476 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 3.2188 | Allowed |
| 2 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 3 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 4 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 5 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | base | 2.2100 | Allowed |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.2100 | Allowed |
| 8 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 2.2100 | Allowed |
| 9 | 183 | Permissive List of Allowed Inputs | base | 2.1762 | Allowed |
| 10 | 368 | Context Switching Race Condition | base | 2.1762 | Allowed |
| 11 | 184 | Incomplete List of Disallowed Inputs | base | 2.1190 | Allowed |
| 12 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 13 | 415 | Double Free | variant | 2.0400 | Allowed |
| 14 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.0400 | Allowed |
| 15 | 129 | Improper Validation of Array Index | variant | 1.8394 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1331 | Improper Isolation of Shared Resources in Network On Chip (NoC) | Base | 0.4770 | 0.4770 | Allowed |
| 2 | 794 | Incomplete Filtering of Multiple Instances of Special Elements | Variant | 0.4703 | 0.4703 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4672 | 0.4672 | Allowed-with-Review |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4647 | 0.4647 | Allowed |
| 5 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4607 | 0.4607 | Allowed |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4593 | 0.4593 | Allowed |
| 7 | 366 | Race Condition within a Thread | Base | 0.4538 | 0.4538 | Allowed |
| 8 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4501 | 0.4501 | Allowed |
| 9 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4445 | 0.4445 | Allowed |
| 10 | 606 | Unchecked Input for Loop Condition | Base | 0.4435 | 0.4435 | Allowed |
| 11 | 782 | Exposed IOCTL with Insufficient Access Control | Variant | 0.4401 | 0.4401 | Allowed |
| 12 | 400 | Uncontrolled Resource Consumption | Class | 0.4388 | 0.4388 | Discouraged |
| 13 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4338 | 0.4338 | Discouraged |
| 14 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4325 | 0.4325 | Allowed |
| 15 | 792 | Incomplete Filtering of One or More Instances of Special Elements | Variant | 0.4311 | 0.4311 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 875.2354 | 875.2354 | Allowed |
| 3 | 667 | Improper Locking | 872.3691 | 872.3691 | Allowed-with-Review |
| 4 | 364 | Signal Handler Race Condition | 855.6223 | 855.6223 | Allowed |
| 5 | 184 | Incomplete List of Disallowed Inputs | 828.5915 | 828.5915 | Allowed |
| 6 | 833 | Deadlock | 757.9508 | 757.9508 | Allowed |
| 7 | 754 | Improper Check for Unusual or Exceptional Conditions | 751.4375 | 751.4375 | Allowed-with-Review |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | 745.2761 | 745.2761 | Allowed |
| 9 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 745.0838 | 745.0838 | Allowed-with-Review |
| 10 | 789 | Memory Allocation with Excessive Size Value | 738.6565 | 738.6565 | Allowed |
