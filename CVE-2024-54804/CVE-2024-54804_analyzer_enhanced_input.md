## Vulnerability Description
Netgear WNR854T 1.5.2 (North America) is vulnerable to **Command Injection**. An attacker can send a specially crafted request to post.cgi, updating the nvram parameter wan_hostname and forcing a reboot. This will result in command injection.

### Vulnerability Description Key Phrases
- **weakness:** **Command Injection**
- **vector:** specially crafted request
- **product:** Netgear WNR854T
- **version:** 1.5.2
- **component:** post.cgi

## CVE Reference Links Content Summary
CVE-2024-54804

**Root cause of vulnerability:**
The vulnerability is an authenticated command injection affecting the router’s WAN hostname configuration. It exists within the sysinit binary (`/bin/sysinit`) which processes the `wan_hostname` NVRAM parameter during system initialization. The root cause is the absence of input validation or sanitization for the `wan_hostname` parameter when constructing a shell command.

**Weaknesses/vulnerabilities present:**
- Command Injection
- Lack of input validation/sanitization

**Impact of exploitation:**
- Complete compromise of the router
- Potential for malicious activities like modifying network settings or creating boot loops.

**Attack vectors:**
- Log into the web administration interface and modify the WAN hostname setting.
- Send a specially crafted HTTP POST request to the router’s `/post.cgi` endpoint.

**Required attacker capabilities/position:**
- Authentication to the router’s administrative interface.

**Mitigation or fix:**
Not specified in the content.

**Additional Details:**
The exploit payload format is `wan_hostname=;command_to_execute #`. The semicolon (`;`) terminates the original command, allowing injection of an arbitrary command, while the hash symbol (`#`) comments out any trailing portions of the original command string.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.252 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.245 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.236 |
| 6 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.235 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.233 |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.228 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.559 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-1287: Improper Validation of Specified Type of Input

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-790: Improper Filtering of Special Elements

CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs