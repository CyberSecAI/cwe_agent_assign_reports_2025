# Vulnerability Information: CVE-2024-47823

## Vulnerability Description
Livewire is a full-stack framework for Laravel that allows for dynamic UI components without leaving PHP. In livewire/livewire prior to `2.12.7` and `v3.5.2`, the **file extension of an uploaded file is guessed based on the MIME type**. As a result, the actual file extension from the file name is not validated. An attacker can therefore bypass the validation by uploading a file with a valid MIME type (e.g., `image/png`) and a .php file extension. If the following criteria are met, the attacker can carry out an RCE attack 1. Filename is composed of the original file name using `$file->getClientOriginalName()`. 2. Files stored directly on your server in a public storage disk. 3. Webserver is configured to execute .php files. This issue has been addressed in release versions `2.12.7` and `3.5.2`. All users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **file extension of an uploaded file is guessed based on the MIME type**
- **impact:** RCE and remote code execution
- **vector:** uploading a file with a valid MIME type (e.g. image/png) and a .php file extension
- **attacker:** attacker
- **product:** livewire/livewire
- **version:** prior to 2.12.7 and v3.5.2

## CVE Reference Links Content Summary
```
{
  "vulnerability_details": {
    "root_cause": "The file extension of an uploaded file was being guessed based on the MIME type instead of using the actual file extension from the file name.",
    "weaknesses": [
      "MIME type validation bypass",
      "Insecure file handling"
    ],
    "impact": "Remote Code Execution (RCE). An attacker could upload a file with a valid MIME type (e.g., `image/png`) but with a malicious file extension (e.g., `.php`) and execute it on the remote server if the server was configured to execute PHP files and the filename was constructed using `$file->getClientOriginalName()`.",
    "attack_vectors": "Uploading a file with a manipulated file extension and a valid MIME type.",
      "required_capabilities": "Attacker needs to be able to upload files to the server, and the server needs to be configured to execute php files, also the server code must use `$file->getClientOriginalName()` when storing the file."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 1.029 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.926 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.926 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.918 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.905 |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.898 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.897 |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.896 |
| 9 | 646 | Reliance on File Name or Extension of Externally-Supplied File | Variant | Allowed | dense | 0.576 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

