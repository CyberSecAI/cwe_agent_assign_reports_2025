# Raw Retriever Results for CVE-2024-46689

# Raw Retriever Results for CVE-2024-46689
## Query
In the Linux kernel, the following vulnerability has been resolved soc qcom cmd-db Map shared memory as WC, not WB Linux does not write into cmd-db region. This region of memory is write protected by XPU. XPU may sometime falsely detect clean cache eviction as write into the write protected region leading to secure interrupt which causes an endless loop somewhere in Trust Zone. The only reason it is working right now is because Qualcomm Hypervisor maps the same region as Non-Cacheable memory in Stage 2 translation tables. The issue manifests if we want to use another hypervisor (like Xen or KVM), which does not know anything about those specific mappings. Changing the mapping of cmd-db memory from MEMREMAP_WB to MEMREMAP_WT/WC removes dependency on correct mappings in Stage 2 tables. This patch fixes the issue by updating the mapping to MEMREMAP_WC. I tested this on SA8155P with Xen.

## Keyphrases
- **rootcause**: 'improper cache-write protection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5184 | 0.5911 | 0.5408 | 0.5382 | 20 |
| Sparse | 201.5718 | 755.0794 | 612.7967 | 632.0042 | 11 |
| Graph | 1.6848 | 2.7950 | 2.0157 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.7950 | Allowed |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.7742 | Allowed |
| 3 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 2.6100 | Allowed |
| 4 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 2.5319 | Allowed |
| 5 | 619 | Dangling Database Cursor ('Cursor Injection') | base | 2.2100 | Allowed |
| 6 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 8 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 2.1161 | Allowed |
| 9 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 10 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 13 | 590 | Free of Memory not on the Heap | variant | 1.7117 | Allowed |
| 14 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7052 | Allowed-with-Review |
| 15 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.5911 | 0.5911 | Allowed |
| 2 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.5689 | 0.5689 | Allowed |
| 3 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.5643 | 0.5643 | Allowed |
| 4 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.5584 | 0.5584 | Allowed |
| 5 | 1262 | Improper Access Control for Register Interface | Base | 0.5576 | 0.5576 | Allowed |
| 6 | 1191 | On-Chip Debug and Test Interface With Improper Access Control | Base | 0.5504 | 0.5504 | Allowed |
| 7 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.5482 | 0.5482 | Allowed |
| 8 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5464 | 0.5464 | Allowed |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5461 | 0.5461 | Allowed |
| 10 | 1189 | Improper Isolation of Shared Resources on System-on-a-Chip (SoC) | Base | 0.5417 | 0.5417 | Allowed |
| 11 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.5348 | 0.5348 | Allowed |
| 12 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 0.5278 | 0.5278 | Allowed |
| 13 | 1332 | Improper Handling of Faults that Lead to Instruction Skips | Base | 0.5264 | 0.5264 | Allowed |
| 14 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.5252 | 0.5252 | Allowed |
| 15 | 413 | Improper Resource Locking | Base | 0.5252 | 0.5252 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 404 | Improper Resource Shutdown or Release | 755.0794 | 755.0794 | Allowed-with-Review |
| 2 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 718.0960 | 718.0960 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 656.1264 | 656.1264 | Allowed-with-Review |
| 4 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | 656.0633 | 656.0633 | Allowed |
| 5 | 61 | UNIX Symbolic Link (Symlink) Following | 636.8124 | 636.8124 | Allowed |
| 6 | 667 | Improper Locking | 632.0042 | 632.0042 | Allowed-with-Review |
| 7 | 863 | Incorrect Authorization | 627.3376 | 627.3376 | Allowed-with-Review |
| 8 | 125 | Out-of-bounds Read | 621.0904 | 621.0904 | Allowed |
| 9 | 787 | Out-of-bounds Write | 618.3803 | 618.3803 | Allowed |
| 10 | 190 | Integer Overflow or Wraparound | 618.2025 | 618.2025 | Allowed |
| 11 | 754 | Improper Check for Unusual or Exceptional Conditions | 201.5718 | 201.5718 | Allowed-with-Review |
