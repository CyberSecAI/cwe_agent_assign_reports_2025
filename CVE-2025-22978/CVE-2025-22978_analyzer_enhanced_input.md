## Vulnerability Description
eladmin <=2.7 is vulnerable to CSV Injection in the exception log download module.

### Vulnerability Description Key Phrases
- **weakness:** **CSV injection**
- **product:** eladmin
- **version:** <= 2.7
- **component:** exception log download module

## CVE Reference Links Content Summary
CVE-2025-22978: PLACEHOLDER - Implement CVE description retrieval

The provided content **relates** to a vulnerability.

**Root cause of vulnerability:**
The vulnerability is due to the lack of filtering formulas when inserting logs, specifically in the exception log download module (eladmin-2.7\eladmin-2.7\eladmin-logging\src\main\java\me\zhengjie\rest\SysLogController.java).

**Weaknesses/vulnerabilities present:**
CSV/XLSX injection.

**Impact of exploitation:**
May lead to information leakage and other issues arising from formula parsing.

**Attack vectors:**
Clicking on a crafted formula within a downloaded log file. The attacker can inject formulas into the log, which are then parsed when the log is viewed, potentially leading to information disclosure.

**Required attacker capabilities/position:**
The attacker needs to be able to trigger the creation of an exception log containing a malicious formula.  The issue description implies the attacker can influence the log content.

**Mitigation or fix:**
Filter out formulas when inserting the logs. The issue references [https://owasp.org/www-community/attacks/CSV_Injection](https://owasp.org/www-community/attacks/CSV_Injection) as a resource for understanding the vulnerability and potential mitigations.

**Additional details (more than official CVE description):**
- Affected version: <= 2.7
- The vulnerability is reproducible by logging in with a specific username.
- The vulnerability allows reading the first two lines of a column when the formula is parsed.
- The issue is demonstrated with screenshots showing the injected formula and the resulting data retrieval.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | alternate_terms | 1.000 |
| 2 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.097 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.095 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.094 |
| 5 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.091 |
| 6 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.089 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.086 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.085 |
| 9 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | dense | 0.563 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-1236: Improper Neutralization of Formula Elements in a CSV File

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-138: Improper Neutralization of Special Elements

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')