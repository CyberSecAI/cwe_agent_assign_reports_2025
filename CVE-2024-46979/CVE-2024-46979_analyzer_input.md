# Vulnerability Information: CVE-2024-46979

## Vulnerability Description
XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Its possible to get access to notification filters of any user by using a URL such as `xwiki/bin/get/XWiki/Notifications/Code/NotificationFilterPreferenceLivetableResults?outputSyntax=plain&type=custom&user=`. This vulnerability impacts all versions of XWiki since 13.2-rc-1. The filters do not provide much information (they mainly contain references which are public data in XWiki), though some info could be used in combination with other vulnerabilities. This vulnerability has been patched in XWiki 14.10.21, 15.5.5, 15.10.1, 16.0RC1. The patch consists in checking the rights of the user when sending the data. Users are advised to upgrade. Its possible to workaround the vulnerability by applying manually the patch its possible for an administrator to edit directly the document `XWiki.Notifications.Code.NotificationFilterPreferenceLivetableResults` to apply the same changes as in the patch. See commit c8c6545f9bde6f5aade994aa5b5903a67b5c2582.

### Vulnerability Description Key Phrases
- **impact:** access notification filters of any user
- **product:** XWiki Platform
- **version:** since 13.2-rc-1

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-46979:

**Root Cause of Vulnerability:**

The vulnerability stems from a lack of proper authorization checks in the `NotificationFilterPreferenceLivetableResults` endpoint. Specifically, the code did not verify if the requesting user had the necessary permissions to access the notification filters of other users.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure Direct Object Reference (IDOR):** The application directly uses user-supplied input (the `user` parameter in the URL) to access user-specific notification filter data without proper authorization.
*   **Data Leakage:**  Due to the missing access control, an attacker can retrieve the notification filters of any user.

**Impact of Exploitation:**

*   **Confidentiality Breach:** An attacker can access sensitive notification filter information of other users. The filters contain information that, while mostly public references, could reveal some user preferences and, potentially when combined with other vulnerabilities, be used for further attacks.
*  **Limited Scope:** While a data leak is possible, the leaked information by itself is not very sensitive, reducing the impact of the vulnerability.

**Attack Vectors:**

*   **Network:** The attack is performed via HTTP requests over the network.
*   **Direct URL Manipulation:** An attacker crafts a specific URL with the desired target username in the `user` parameter.

**Required Attacker Capabilities/Position:**

*   **No privileges required:** The attacker doesn't need to have any specific privileges or be an authenticated user to exploit the vulnerability.
*   **Knowledge of the Target System:** An attacker needs to know the format of the vulnerable URL and the target usernames in the XWiki system.

**Additional Information:**

*   The vulnerability affects XWiki versions starting from 13.2-rc-1.
*   Patches have been released in versions 14.10.21, 15.5.5, 15.10.1, and 16.0-rc-1.
*   The patch involves adding a check for the user's rights before sending notification filter data.
*   A workaround is available for administrators to apply the patch manually by editing the `XWiki.Notifications.Code.NotificationFilterPreferenceLivetableResults` document.
*   The vulnerability was reported on Intigriti by Mete.
*   The issue is tracked in Jira as XWIKI-20336.
*   The severity is rated as "Moderate" with a CVSS score of 5.3.
*   The code changes can be viewed in the provided commit [c8c6545](https://github.com/xwiki/xwiki-platform/commit/c8c6545f9bde6f5aade994aa5b5903a67b5c2582)

This analysis provides more details than the official CVE description which is a placeholder.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1022 | Use of Web Link to Untrusted Target with window.opener Access | Variant | Allowed | alternate_terms | 0.700 |
| 2 | 427 | Uncontrolled Search Path Element | Base | Allowed | alternate_terms | 0.700 |
| 3 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | alternate_terms | 0.700 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.360 |
| 5 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | sparse | 0.322 |
| 6 | 552 | Files or Directories Accessible to External Parties | Base | Allowed | sparse | 0.317 |
| 7 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.294 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.289 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.557 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

