# Vulnerability Information: CVE-2024-6579

## Vulnerability Description
The Web and WooCommerce Addons for WPBakery Builder plugin for WordPress is vulnerable to unauthorized plugin settings modification due to a **missing capability check** on several plugin functions in all versions up to, and including, 1.4.5. This makes it possible for authenticated attackers, with Subscriber-level access and above, to change some of the plugin settings.

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **impact:** change plugin settings
- **attacker:** authenticated attackers with Subscriber-level access and above
- **product:** Web and WooCommerce Addons for WPBakery Builder
- **version:** up to 1.4.5

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-6579:

**Root Cause of Vulnerability:**
The vulnerability stems from a missing authorization check on several plugin functions within the "Web and WooCommerce Addons for WPBakery Builder" WordPress plugin. Specifically, there's a lack of capability checks within the plugin's code which allows unauthorized access.

**Weaknesses/Vulnerabilities Present:**
- **Missing Authorization/Capability Check:** The primary weakness is the absence of proper authorization checks before executing certain plugin functions. This allows authenticated users, even with low privileges (Subscriber level and above), to modify plugin settings, which should typically be restricted to administrators or other high-privilege roles.

**Impact of Exploitation:**
- **Plugin Settings Modification:** The main impact is that attackers with at least a Subscriber level account can modify the plugin's settings. The content does not specify what settings can be modified and what the impact of changing those settings would be. However, as a general rule, modifying plugin settings could impact the website's functionality and integrity, leading to data manipulation or denial of service.

**Attack Vectors:**
- **Network:** The vulnerability is exploited over the network via a web request.
- **Authenticated Access:** The attacker must have an authenticated account on the WordPress site with at least subscriber-level privileges.

**Required Attacker Capabilities/Position:**
- **WordPress Account:** The attacker must have an account on the WordPress site.
- **Subscriber Level Access (or higher):** The attacker needs to have at least Subscriber-level privileges on the WordPress site.
- **Network Connectivity:** The attacker needs to be able to send requests to the WordPress website.

**Additional Notes:**
- The provided links point to specific lines of code in the plugin's file that lack proper authorization checks, confirming the vulnerability's location and nature.
- The vulnerability has been patched in version 1.4.6 of the plugin.
- The Wordfence article highlights the importance of proper authorization checks in plugin development to prevent such vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.489 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.483 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.424 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.405 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.402 |
| 6 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.396 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.387 |
| 8 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.366 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.520 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

