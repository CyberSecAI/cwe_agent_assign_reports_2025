{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved dma-debug fix a possible deadlock on radix_lock radix_lock() shouldnt be held while holding dma_hash_entry[idx].lock otherwise, theres a possible deadlock scenario when dma debug API is called holding rq_lock() CPU0 CPU1 CPU2 dma_free_attrs() check_unmap() add_dma_entry() __schedule() //out (A) rq_lock() get_hash_bucket() (A) dma_entry_hash check_sync() (A) radix_lock() (W) dma_entry_hash dma_entry_free() (W) radix_lock() // CPU2s one (W) rq_lock() CPU1 situation can happen when it extending radix tree and it tries to wake up kswapd via wake_all_kswapd(). CPU2 situation can happen while perf_event_task_sched_out() (i.e. dma sync operation is called while deleting perf_event using etm and etr tmc which are Arm Coresight hwtracing driver backends). To remove this possible situation, call dma_entry_free() after put_hash_bucket() in check_unmap().",
  "keyphrases": {
    "rootcause": [
      "dma-debug fix a possible deadlock"
    ],
    "weakness": [
      "deadlock"
    ]
  },
  "timestamp": "2025-07-13 18:01:40",
  "cve_id": "CVE-2024-47143",
  "result_count": 12,
  "results": [
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 509.14882129415264,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 504.5659272698069,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 473.52644632415365,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "score": 469.99143573463675,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 442.00944870814885,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "1251",
      "name": "Mirrored Regions with Different Values",
      "score": 420.7756000439013,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "807",
      "name": "Reliance on Untrusted Inputs in a Security Decision",
      "score": 407.0835766574322,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "663",
      "name": "Use of a Non-reentrant Function in a Concurrent Context",
      "score": 397.20294656897335,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "122",
      "name": "Heap-based Buffer Overflow",
      "score": 397.1337221380071,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "674",
      "name": "Uncontrolled Recursion",
      "score": 393.6140292773122,
      "search_source": "rootcause:dma-debug fix a possible deadlock"
    },
    {
      "cwe_id": "125",
      "name": "Out-of-bounds Read",
      "score": 345.9518477462616,
      "search_source": "weakness:deadlock"
    },
    {
      "cwe_id": "787",
      "name": "Out-of-bounds Write",
      "score": 122.30859201846351,
      "search_source": "base_query"
    }
  ]
}