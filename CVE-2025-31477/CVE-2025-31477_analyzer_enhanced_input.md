## Vulnerability Description
The Tauri shell plugin allows access to the system shell. Prior to 2.2.1, the Tauri shell plugin exposes functionality to execute code and open programs on the system. The open endpoint of this plugin is designed to allow open functionality with the system opener (e.g. xdg-open on Linux). This was meant to be restricted to a reasonable number of protocols like https or mailto by default. This default restriction was not functional due to **improper validation of the allowed protocols**, allowing for potentially dangerous protocols like file//, smb//, or nfs// and others to be opened by the system registered protocol handler. By passing untrusted user input to the open endpoint these potentially dangerous protocols can be abused to gain remote code execution on the system. This either requires direct exposure of the endpoint to application users or code execution in the frontend of a Tauri application. This vulnerability is fixed in 2.2.1.

### Vulnerability Description Key Phrases
- **component:** open endpoint
- **rootcause:** **improper validation of the allowed protocols**
- **product:** Tauri shell plugin
- **impact:** ['execute code', 'open programs on the system', 'remote code execution']
- **version:** prior to 2.2.1

## CVE Reference Links Content Summary
The provided content describes a fix for a vulnerability in the Tauri shell plugin related to the `open` functionality.

*   **Root cause of vulnerability:** The plugin previously skipped validation when the `open` configuration was not set, potentially allowing unchecked input.
*   **Weaknesses/vulnerabilities present:** The vulnerability allowed for unchecked input to be used, which could lead to arbitrary code execution or other malicious actions.
*   **Impact of exploitation:**  The exploitation could have resulted in the execution of arbitrary code or other malicious actions.
*   **Attack vectors:** The attack vector is through the `open` functionality of the shell plugin.
*   **Mitigation or fix:** The fix applies a default open validation regex (`^((mailto:\w+)|(tel:\w+)|(https?://\w+)).+`) when the open configuration is not set, preventing unchecked input. The scope is no longer validated for Rust calls via `ShellExt::shell()`.
*   **More detail than the official CVE description:** The content provides specifics of the vulnerability and the applied fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.913 |
| 2 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.904 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.902 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.871 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.863 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.859 |
| 7 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.859 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.858 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.490 |
| 10 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-306: Missing Authentication for Critical Function

CWE-184: Incomplete List of Disallowed Inputs

CWE-863: Incorrect Authorization

CWE-285: Improper Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type