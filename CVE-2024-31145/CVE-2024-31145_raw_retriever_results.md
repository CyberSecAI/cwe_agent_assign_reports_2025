# Raw Retriever Results for CVE-2024-31145

# Raw Retriever Results for CVE-2024-31145
## Query
Certain PCI devices in a system might be assigned Reserved Memory Regions (specified via Reserved Memory Region Reporting, RMRR) for Intel VT-d or Unity Mapping ranges for AMD-Vi. These are typically used for platform tasks such as legacy USB emulation. Since the precise purpose of these regions is unknown, once a device associated with such a region is active, the mappings of these regions need to remain continuouly accessible by the device. In the logic establishing these mappings, error handling was flawed, resulting in such mappings to potentially remain in place when they should have been removed again. Respective guests would then gain access to memory regions which they arent supposed to have access to.

## Keyphrases
- **rootcause**: 'error handling was flawed'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4642 | 0.5501 | 0.5019 | 0.4991 | 20 |
| Sparse | 159.8937 | 563.7907 | 479.3064 | 495.1874 | 11 |
| Graph | 1.4040 | 2.5343 | 1.7798 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 2.5343 | Allowed |
| 2 | 619 | Dangling Database Cursor ('Cursor Injection') | base | 2.2100 | Allowed |
| 3 | 609 | Double-Checked Locking | base | 2.2100 | Allowed |
| 4 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 2.1331 | Allowed |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | base | 2.1190 | Allowed |
| 6 | 1262 | Improper Access Control for Register Interface | Base | 1.6874 | Allowed |
| 7 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 1.6857 | Allowed |
| 8 | 843 | Access of Resource Using Incompatible Type ('Type Confusion') | base | 1.6848 | Allowed |
| 9 | 128 | Wrap-around Error | base | 1.6848 | Allowed |
| 10 | 131 | Incorrect Calculation of Buffer Size | base | 1.6848 | Allowed |
| 11 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 1.6848 | Allowed |
| 12 | 190 | Integer Overflow or Wraparound | base | 1.6848 | Allowed |
| 13 | 193 | Off-by-one Error | base | 1.6848 | Allowed |
| 14 | 839 | Numeric Range Comparison Without Minimum Check | base | 1.6848 | Allowed |
| 15 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 1.6772 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.5501 | 0.5501 | Allowed |
| 2 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 0.5439 | 0.5439 | Allowed |
| 3 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.5394 | 0.5394 | Allowed |
| 4 | 1262 | Improper Access Control for Register Interface | Base | 0.5378 | 0.5378 | Allowed |
| 5 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.5302 | 0.5302 | Allowed |
| 6 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | Base | 0.5255 | 0.5255 | Allowed |
| 7 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.5251 | 0.5251 | Allowed |
| 8 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.5138 | 0.5138 | Allowed |
| 9 | 1423 | Exposure of Sensitive Information caused by Shared Microarchitectural Predictor State that Influences Transient Execution | Base | 0.5019 | 0.5019 | Allowed |
| 10 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | Variant | 0.5016 | 0.5016 | Allowed |
| 11 | 1209 | Failure to Disable Reserved Bits | Base | 0.4967 | 0.4967 | Allowed |
| 12 | 1252 | CPU Hardware Not Configured to Support Exclusivity of Write and Execute Operations | Base | 0.4913 | 0.4913 | Allowed |
| 13 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4853 | 0.4853 | Allowed |
| 14 | 909 | Missing Initialization of Resource | Class | 0.4760 | 0.4760 | Allowed-with-Review |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4750 | 0.4750 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1316 | Fabric-Address Map Allows Programming of Unwarranted Overlaps of Protected and Unprotected Ranges | 563.7907 | 563.7907 | Allowed |
| 2 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | 547.9895 | 547.9895 | Allowed |
| 3 | 863 | Incorrect Authorization | 521.2276 | 521.2276 | Allowed-with-Review |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 521.0658 | 521.0658 | Allowed |
| 5 | 404 | Improper Resource Shutdown or Release | 498.6849 | 498.6849 | Allowed-with-Review |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 495.1874 | 495.1874 | Allowed-with-Review |
| 7 | 755 | Improper Handling of Exceptional Conditions | 493.4268 | 493.4268 | Discouraged |
| 8 | 1251 | Mirrored Regions with Different Values | 493.0971 | 493.0971 | Allowed |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | 489.2557 | 489.2557 | Allowed |
| 10 | 287 | Improper Authentication | 488.7511 | 488.7511 | Discouraged |
| 11 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | 159.8937 | 159.8937 | Allowed |
