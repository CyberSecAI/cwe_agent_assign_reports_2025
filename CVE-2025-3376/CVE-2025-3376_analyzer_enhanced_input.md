## Vulnerability Description
A vulnerability was found in PCMan FTP Server 2.0.7. It has been declared as critical. This vulnerability affects unknown code of the component CONF Command Handler. The manipulation leads to **buffer overflow**. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** CONF Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3376 Content

This content **RELATES** to a vulnerability in PCMan FTP Server, specifically a remote buffer overflow in the 'CONF' command. It provides a detailed exploit script.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the handling of the 'CONF' command in PCMan FTP Server version 2.0.7. The server does not properly validate the size of the input provided with the 'CONF' command, allowing an attacker to send a larger-than-expected buffer, overwriting adjacent memory regions.

**Weaknesses/vulnerabilities present:**

*   **Buffer Overflow:** The core vulnerability is a buffer overflow.
*   **Lack of Input Validation:** The server fails to validate the length of the input received via the 'CONF' command.

**Impact of exploitation:**

Successful exploitation allows an attacker to overwrite the execution flow of the program, potentially leading to arbitrary code execution. The script aims to redirect execution to a shellcode payload.

**Attack vectors:**

*   **Remote:** The vulnerability is exploitable remotely via the FTP protocol.
*   **'CONF' Command:** The attack is launched by sending a specially crafted 'CONF' command to the FTP server.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs network access to the target PCMan FTP Server.
*   **FTP Client:** The attacker needs an FTP client to send the malicious 'CONF' command.
*   **Shellcode Knowledge:** The attacker needs to be able to create shellcode compatible with the target architecture (x86 in this case).

**Mitigation or fix:**

The provided content does not mention a specific fix. However, the general mitigation would involve:

*   **Input Validation:** Implement robust input validation for the 'CONF' command to ensure the input size does not exceed the buffer's capacity.
*   **Buffer Overflow Protection:** Employ buffer overflow protection mechanisms (e.g., stack canaries, Address Space Layout Randomization (ASLR), Data Execution Prevention (DEP)).
*   **Update:** Upgrade to a patched version of PCMan FTP Server if available.

**Additional Details (More than official CVE description):**

*   **Specific Version:** The exploit is tested against version 2.0.7 of PCMan FTP Server.
*   **Tested OS:** The exploit was tested on Windows XP SP3.
*   **Exploit Details:** The script includes the offset (2006), EIP overwrite value (0x74e32fd9 - JMP ESP), and a shellcode payload generated using `msfvenom`.
*   **Bad Characters:** The script handles bad characters (\x00, \x0a, \x0d) during shellcode generation.
*   **Connection Details:** The script attempts to connect to 192.168.176.131 on port 21.
*   **Exploit Steps:** The script demonstrates the steps to establish an FTP connection, authenticate anonymously, send the malicious 'CONF' command, and close the connection.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.358 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.338 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.305 |
| 7 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.297 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.293 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.603 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-125: Out-of-bounds Read

CWE-117: Improper Output Neutralization for Logs

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-121: Stack-based Buffer Overflow

CWE-128: Wrap-around Error