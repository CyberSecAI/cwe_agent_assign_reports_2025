# Vulnerability Information: CVE-2024-10810

## Vulnerability Description
A vulnerability was found in code-projects E-Health Care System 1.0. It has been classified as critical. Affected is an unknown function of the file Doctor/app_request.php. The manipulation of the argument app_id leads to **sql injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** code-projects E-Health Care System
- **version:** 1
- **component:** Doctor/app_request.php

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-89

#### Top CWEs
- CWE-89 (Count: 202)
- CWE-74 (Count: 21)
- CWE-79 (Count: 15)

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**CVE ID:** CVE-2024-10810

**Vulnerability:** SQL Injection

**Root Cause:**
The application fails to sanitize the `app_id` parameter before using it in an SQL query within the `app_request.php` file. Specifically, the code directly concatenates the user-supplied `app_id` parameter into the SQL query without any input validation or sanitization.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The primary vulnerability is an SQL injection, stemming from the lack of input sanitization.

**Impact of Exploitation:**
- **Data Breach:** Attackers can exploit this vulnerability to retrieve sensitive information from the database, including table names, database names, and user information. As shown in the POC, the attacker can retrieve the table names, database name ('online\_health\_care'), and the database user ('root@localhost').
- **Potential for further attacks:** This initial access can be used to further compromise the system, potentially leading to data modification or deletion.

**Attack Vectors:**
- **HTTP GET Request:** The attacker can inject malicious SQL code through the `app_id` parameter in a GET request to `app_request.php`.

**Required Attacker Capabilities/Position:**
- The attacker only needs the ability to send HTTP requests to the vulnerable application and knowledge of the vulnerable parameter. No prior authentication or access is explicitly needed for the provided PoC.

**Additional details:**

- The vulnerability exists in the `app_request.php` file.
- The vulnerable parameter is `app_id`.
- The application in question is an E-Health Care System written in PHP, using CSS, Javascript, and MySQL.
- The provided proof of concept (PoC) demonstrates how an attacker can use a crafted URL to retrieve database information.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.410 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.346 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.344 |
| 5 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.339 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.330 |
| 7 | 1241 | Use of Predictable Algorithm in Random Number Generator | Base | Allowed | sparse | 0.329 |
| 8 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.327 |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | dense | 0.570 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

