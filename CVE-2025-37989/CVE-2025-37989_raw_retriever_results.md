# Raw Retriever Results for CVE-2025-37989

# Raw Retriever Results for CVE-2025-37989
## Query
In the Linux kernel, the following vulnerability has been resolved net phy leds fix memory leak A network restart test on a router led to an out-of-memory condition, which was traced to a memory leak in the PHY LED trigger code. The root cause is misuse of the devm API. The registration function (phy_led_triggers_register) is called from phy_attach_direct, not phy_probe, and the unregister function (phy_led_triggers_unregister) is called from phy_detach, not phy_remove. This means the register and unregister functions can be called multiple times for the same PHY device, but devm-allocated memory is not freed until the driver is unbound. This also prevents kmemleak from detecting the leak, as the devm API internally stores the allocated pointer. Fix this by replacing devm_kzalloc/devm_kcalloc with standard kzalloc/kcalloc, and add the corresponding kfree calls in the unregister path.

## Keyphrases
- **rootcause**: 'misuse of the devm API'
- **weakness**: 'memory leak'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4409 | 0.5448 | 0.4647 | 0.4590 | 20 |
| Sparse | 653.7524 | 1000.0000 | 733.2093 | 712.2588 | 12 |
| Graph | 1.6016 | 4.3290 | 2.0640 | 1.7882 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | base | 4.3290 | Allowed |
| 2 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 3 | 129 | Improper Validation of Array Index | variant | 2.6784 | Allowed |
| 4 | 123 | Write-what-where Condition | base | 2.4700 | Allowed |
| 5 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 6 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 7 | 789 | Memory Allocation with Excessive Size Value | Variant | 2.1426 | Allowed |
| 8 | 911 | Improper Update of Reference Count | Base | 2.0412 | Allowed |
| 9 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 10 | 416 | Use After Free | Variant | 1.8084 | Allowed |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 1341 | Multiple Releases of Same Resource or Handle | base | 1.6848 | Allowed |
| 13 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 14 | 826 | Premature Release of Resource During Expected Lifetime | base | 1.6848 | Allowed |
| 15 | 562 | Return of Stack Variable Address | base | 1.6848 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5448 | 0.5448 | Allowed |
| 2 | 909 | Missing Initialization of Resource | Class | 0.5339 | 0.5339 | Allowed-with-Review |
| 3 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4779 | 0.4779 | Allowed |
| 4 | 911 | Improper Update of Reference Count | Base | 0.4747 | 0.4747 | Allowed |
| 5 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4694 | 0.4694 | Allowed |
| 6 | 908 | Use of Uninitialized Resource | Base | 0.4674 | 0.4674 | Allowed |
| 7 | 126 | Buffer Over-read | Variant | 0.4649 | 0.4649 | Allowed |
| 8 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | 0.4638 | 0.4638 | Allowed |
| 9 | 763 | Release of Invalid Pointer or Reference | Base | 0.4599 | 0.4599 | Allowed |
| 10 | 416 | Use After Free | Variant | 0.4596 | 0.4596 | Allowed |
| 11 | 1262 | Improper Access Control for Register Interface | Base | 0.4584 | 0.4584 | Allowed |
| 12 | 667 | Improper Locking | Class | 0.4533 | 0.4533 | Allowed-with-Review |
| 13 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4508 | 0.4508 | Allowed-with-Review |
| 14 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4503 | 0.4503 | Discouraged |
| 15 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4471 | 0.4471 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 401 | Missing Release of Memory after Effective Lifetime | 1000.0000 | 1000.0000 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 756.5163 | 756.5163 | Allowed-with-Review |
| 3 | 415 | Double Free | 731.7173 | 731.7173 | Allowed |
| 4 | 789 | Memory Allocation with Excessive Size Value | 728.4291 | 728.4291 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 719.1622 | 719.1622 | Allowed |
| 6 | 364 | Signal Handler Race Condition | 712.8991 | 712.8991 | Allowed |
| 7 | 476 | NULL Pointer Dereference | 711.6185 | 711.6185 | Allowed |
| 8 | 20 | Improper Input Validation | 709.5568 | 709.5568 | Discouraged |
| 9 | 667 | Improper Locking | 709.4757 | 709.4757 | Allowed-with-Review |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 706.2087 | 706.2087 | Allowed |
| 11 | 909 | Missing Initialization of Resource | 659.1751 | 659.1751 | Allowed-with-Review |
| 12 | 125 | Out-of-bounds Read | 653.7524 | 653.7524 | Allowed |
