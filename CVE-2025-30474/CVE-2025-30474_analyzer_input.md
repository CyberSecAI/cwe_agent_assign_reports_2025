# Vulnerability Information: CVE-2025-30474

## Vulnerability Description
**Exposure of Sensitive Information to an Unauthorized Actor** vulnerability in Apache Commons VFS. The FtpFileObject class can throw an exception when a file is not found, revealing the original URI in its message, which may include a password. The fix is to mask the password in the exception message This issue affects Apache Commons VFS before 2.10.0. Users are recommended to upgrade to version 2.10.0, which fixes the issue.

### Vulnerability Description Key Phrases
- **weakness:** **Exposure of Sensitive Information to an Unauthorized Actor**
- **impact:** throw an exception when a file is not found
- **product:** Apache Commons VFS
- **version:** before 2.10.0
- **component:** FtpFileObject class

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on CVE-2025-30474:

**CVE ID:** CVE-2025-30474

**CVE Description:** (Based on the content) Exposure of Sensitive Information to an Unauthorized Actor vulnerability in Apache Commons VFS. The FtpFileObject class can throw an exception when a file is not found, revealing the original URI in its message, which may include a password.

**Analysis:**

The content from `lists.apache.org_7760fb1b_20250624_173634.html` and `www.openwall.com_ff0141a7_20250624_205948.html` directly relates to CVE-2025-30474.  The email from Gary D. Gregory details the vulnerability, affected versions, and a fix.

**Extracted Information:**

*   **Root cause of vulnerability:** The `FtpFileObject` class throws an exception that includes the original URI when a file is not found. This URI may contain a password.
*   **Weaknesses/vulnerabilities present:** Exposure of sensitive information (passwords) in error messages.
*   **Impact of exploitation:** Unauthorized disclosure of passwords used in FTP URIs.
*   **Attack vectors:**  Attempting to access a non-existent file via FTP using a URI containing a password.
*   **Required attacker capabilities/position:** An attacker needs to be able to trigger an attempt to access a file via FTP with a password in the URI.  No special privileges are required to trigger the vulnerability, only the ability to initiate the connection.
*   **Mitigation or fix:** Upgrade to Apache Commons VFS version 2.10.0 or later, which masks the password in the exception message.
*   **Credit:** Marek Å unda (finder)
*   **References:**
    *   [https://issues.apache.org/jira/browse/VFS-169](https://issues.apache.org/jira/browse/VFS-169)
    *   [https://commons.apache.org/](https://commons.apache.org/)
    *   [https://www.cve.org/CVERecord?id=CVE-2025-30474](https://www.cve.org/CVERecord?id=CVE-2025-30474)

**Other Content:**

The other provided content (from `commons.apache.org`, `issues.apache.org`, and `lists.openwall.net`) is either general information about Apache Commons, the issue tracker, or mailing list archives and is not directly related to the specifics of the vulnerability itself.

**Detail compared to official CVE description:**

The provided content *is* the detailed description of the vulnerability. It provides more detail than a typical CVE description would, including the specific class involved (`FtpFileObject`) and the nature of the fix (masking the password).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.480 |
| 2 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.461 |
| 3 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.460 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.455 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.433 |
| 6 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.430 |
| 7 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.423 |
| 8 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.423 |
| 9 | 220 | Storage of File With Sensitive Data Under FTP Root | Variant | Allowed | dense | 0.545 |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | Allowed | graph | 0.002 |

