{
  "cve_id": "CVE-2025-48066",
  "description": "wire-webapp is the web application for the open-source messaging service Wire. A **bug fix caused a regression** causing an issue with function to delete local data. Instructing the client to delete its local database on user logout does not result in deletion. This is the case for both temporary clients (marking the device as a public computer on login) and regular clients instructing the deletion of all personal information and conversations upon logout. Access to the machine is required to access the data. If encryption-at-rest is used, cryptographic material cant be exported. The underlying issue has been fixed with wire-webapp version 2025-05-14-production.0. In order to mitigate potential impact, the database must be manually deleted on devices where the option This is a public computer was used prior to log in or a log out with the request to delete local data with the affected versions has happened before.",
  "key_phrases": {
    "rootcause": "bug fix caused a regression",
    "weakness": "",
    "impact": "delete local data does not result in deletion",
    "vector": "",
    "attacker": "",
    "product": "wire-webapp",
    "version": "prior to 2025-05-14-production.0",
    "component": ""
  },
  "reference_content": "```text\nCVE-2025-48066\n```\n```text\n**Description:**\nA recently added bug fix caused a regression causing an issue with function to delete local data.\n\n**Impact:**\nInstructing the client to delete its local database on user logout does not result in deletion. This is the case for both temporary clients (marking the device as a public computer on login) and regular clients instructing the deletion of all personal information and conversations upon logout. Access to the machine is required to access the data. If encryption-at-rest is used, cryptographic material can't be exported.\n\n**Patches:**\nThe underlying issue has been fixed with wire-webapp version 2025-05-14-production.0\n\n**Workarounds:**\nIn order to mitigate potential impact, the database must be manually deleted on devices\n* where the option \"This is a public computer\" was used prior to log in or\n* a log out with the request to delete local data with the affected versions has happened before.\n\n**Severity:**\nModerate\nCVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N\n```",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID  | CWE Name                                                                                                 | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :--------------------------------------------------------------------------------------------------------- | :--------- | :---------------------- | :------------------------------ | :------------------------------ |\n| CWE-664   | Improper Control of a Resource Through its Lifetime \\[CWE Description: The program does not properly control the creation, usage, transfer, or destruction of a system resource.\\] | 0.85       | Class                   | Primary                           | Allowed-with-Review           |\n| CWE-754   | Improper Check for Unusual or Exceptional Conditions \\[CWE Description: The software does not check for unusual or exceptional conditions.\\]                                        | 0.75       | Base                      | Secondary                         | Allowed                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.80\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\n\nThe primary selection is CWE-664, a Class-level CWE indicating a general failure to manage resources properly. While broad, it encapsulates the core issue. A more specific Base CWE is not evident from the description. CWE-754 is related as the **bug fix caused a regression**, implying a failure to properly handle exceptional conditions during the logout and data deletion process. This suggests a chain where **improper error handling** (CWE-754) leads to **improper resource management** (CWE-664), but these details cannot be precisely mapped based on the available evidence.\n\n```mermaid\ngraph TD\n    cwe664[\"CWE-664: Improper Control of a Resource Through its Lifetime\"]\n    cwe754[\"CWE-754: Improper Check for Unusual or Exceptional Conditions\"]\n    \n    cwe754 -->|CANPRECEDE| cwe664\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe664 primary\n    class cwe754 secondary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with a **bug fix causing a regression** (likely related to error handling during the fix). This **regression** results in a failure to delete local data upon logout. The chain can be described as:\n\n1.  **ROOTCAUSE:** Bug fix introduces regression (likely CWE-754)\n2.  **WEAKNESS:** Failure to delete local data (CWE-664)\n3.  **IMPACT:** Sensitive data remains on the device after logout\n\n## Summary of Analysis\n\nThe primary CWE is CWE-664 because the vulnerability results in the client not deleting local data, which is a failure to control the resource (local data) through its lifetime. The evidence from the \"Vulnerability Description\" indicates: \"Instructing the client to delete its local database on user logout does not result in deletion.\" This directly relates to **improper resource control** as the data is not being deleted as expected. The \"**bug fix caused a regression**\" indicates that an **exceptional condition** during the fix was not properly handled which then led to the resource control issue.\n\nThe retriever results suggested several CWEs. CWE-201 (Insertion of Sensitive Information Into Sent Data) was considered but rejected as the vulnerability isn't about sending sensitive data, but rather failing to delete it. CWE-1390 (Weak Authentication) and CWE-863 (Incorrect Authorization) were also considered, but the issue is not directly related to authentication or authorization mechanisms. The focus is on the failure to properly delete local data, making CWE-664 a more appropriate fit. CWE-367 (Time-of-check Time-of-use (TOCTOU) Race Condition) and CWE-22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) were not relevant based on the vulnerability description.\n\nThe selection of CWE-664 is at the Class level because there isn't enough evidence to pinpoint a more specific Base or Variant CWE related to resource management. The evidence supports the general failure to manage the resource's lifetime.",
  "analysis_with_relationships": "# Summary\n| CWE ID  | CWE Name                                                                                                 | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :--------------------------------------------------------------------------------------------------------- | :--------- | :---------------------- | :------------------------------ | :------------------------------ |\n| CWE-664   | Improper Control of a Resource Through its Lifetime \\[CWE Description: The program does not properly control the creation, usage, transfer, or destruction of a system resource.\\] | 0.85       | Class                   | Primary                           | Allowed-with-Review           |\n| CWE-754   | Improper Check for Unusual or Exceptional Conditions \\[CWE Description: The software does not check for unusual or exceptional conditions.\\]                                        | 0.75       | Base                      | Secondary                         | Allowed                     |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.80\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\n\nThe primary selection is CWE-664, a Class-level CWE indicating a general failure to manage resources properly. While broad, it encapsulates the core issue. A more specific Base CWE is not evident from the description. CWE-754 is related as the **bug fix caused a regression**, implying a failure to properly handle exceptional conditions during the logout and data deletion process. This suggests a chain where **improper error handling** (CWE-754) leads to **improper resource management** (CWE-664), but these details cannot be precisely mapped based on the available evidence.\n\n```mermaid\ngraph TD\n    cwe664[\"CWE-664: Improper Control of a Resource Through its Lifetime\"]\n    cwe754[\"CWE-754: Improper Check for Unusual or Exceptional Conditions\"]\n    \n    cwe754 -->|CANPRECEDE| cwe664\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe664 primary\n    class cwe754 secondary\n```\n\n## Vulnerability Chain\n\nThe vulnerability chain starts with a **bug fix causing a regression** (likely related to error handling during the fix). This **regression** results in a failure to delete local data upon logout. The chain can be described as:\n\n1.  **ROOTCAUSE:** Bug fix introduces regression (likely CWE-754)\n2.  **WEAKNESS:** Failure to delete local data (CWE-664)\n3.  **IMPACT:** Sensitive data remains on the device after logout\n\n## Summary of Analysis\n\nThe primary CWE is CWE-664 because the vulnerability results in the client not deleting local data, which is a failure to control the resource (local data) through its lifetime. The evidence from the \"Vulnerability Description\" indicates: \"Instructing the client to delete its local database on user logout does not result in deletion.\" This directly relates to **improper resource control** as the data is not being deleted as expected. The \"**bug fix caused a regression**\" indicates that an **exceptional condition** during the fix was not properly handled which then led to the resource control issue.\n\nThe retriever results suggested several CWEs. CWE-201 (Insertion of Sensitive Information Into Sent Data) was considered but rejected as the vulnerability isn't about sending sensitive data, but rather failing to delete it. CWE-1390 (Weak Authentication) and CWE-863 (Incorrect Authorization) were also considered, but the issue is not directly related to authentication or authorization mechanisms. The focus is on the failure to properly delete local data, making CWE-664 a more appropriate fit. CWE-367 (Time-of-check Time-of-use (TOCTOU) Race Condition) and CWE-22 (Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')) were not relevant based on the vulnerability description.\n\nThe selection of CWE-664 is at the Class level because there isn't enough evidence to pinpoint a more specific Base or Variant CWE related to resource management. The evidence supports the general failure to manage the resource's lifetime.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-1390:**\n- 1390 (Weak Authentication) - ROOT\n\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 887.0218208746787
    },
    {
      "metadata": {
        "doc_id": "1390",
        "name": "Weak Authentication",
        "source": "sparse"
      },
      "similarity": 858.4404870597713
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 855.8497953410792
    },
    {
      "metadata": {
        "doc_id": "367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
        "source": "sparse"
      },
      "similarity": 830.9411354690592
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 823.9269385437035
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 822.567402252494
    },
    {
      "metadata": {
        "doc_id": "287",
        "name": "Improper Authentication",
        "source": "sparse"
      },
      "similarity": 821.1429311073036
    },
    {
      "metadata": {
        "doc_id": "321",
        "name": "Use of Hard-coded Cryptographic Key",
        "source": "sparse"
      },
      "similarity": 818.4829051064164
    },
    {
      "metadata": {
        "doc_id": "359",
        "name": "Exposure of Private Personal Information to an Unauthorized Actor",
        "type": "Base",
        "original_content": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have the implicit consent of the person about whom the information is collected.",
        "keyphrase_source": "rootcause:bug fix caused a regression",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.40297977932634244,
            "graph": 1.4509208890285636
          }
        }
      },
      "similarity": 0.40297977932634244
    },
    {
      "doc_id": "73",
      "text": "CWE-73: External Control of File Name or Path",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "type": "base",
        "original_content": "CWE-73: External Control of File Name or Path",
        "relationships": [
          {
            "source_id": "73",
            "target_id": "114",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "59",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "41",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "20",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "73",
            "target_id": "610",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "642",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "99",
            "target_id": "73",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "642",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "610",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "59",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "41",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "114",
            "target_id": "73",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "22"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "22"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "73",
                  "22",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "22"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-1390",
      "CWE-863",
      "CWE-22",
      "CWE-201",
      "CWE-664",
      "CWE-367",
      "CWE-754"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}