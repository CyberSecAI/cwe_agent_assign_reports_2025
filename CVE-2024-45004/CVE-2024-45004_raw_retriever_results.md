# Raw Retriever Results for CVE-2024-45004

# Raw Retriever Results for CVE-2024-45004
## Query
In the Linux kernel, the following vulnerability has been resolved KEYS trusted dcp fix leak of blob encryption key Trusted keys unseal the key blob on load, but keep the sealed payload in the blob field so that every subsequent read (export) will simply convert this field to hex and send it to userspace. With DCP-based trusted keys, we decrypt the blob encryption key (BEK) in the Kernel due hardware limitations and then decrypt the blob payload. BEK decryption is done in-place which means that the trusted key blob field is modified and it consequently holds the BEK in plain text. Every subsequent read of that key thus send the plain text BEK instead of the encrypted BEK to userspace. This issue only occurs when importing a trusted DCP-based key and then exporting it again. This should rarely happen as the common use cases are to either create a new trusted key and export it, or import a key blob and then just use it without exporting it again. Fix this by performing BEK decryption and encryption in a dedicated buffer. Further always wipe the plain text BEK buffer to prevent leaking the key via uninitialized memory.

## Keyphrases
- **rootcause**: 'uninitialized memory'
- **weakness**: 'Trusted keys unseal the key blob on load'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4530 | 0.5026 | 0.4744 | 0.4770 | 20 |
| Sparse | 933.2911 | 1002.4455 | 971.8170 | 975.8860 | 10 |
| Graph | 1.0062 | 2.8652 | 1.5015 | 1.4254 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 208 | Observable Timing Discrepancy | base | 2.8652 | Allowed |
| 2 | 203 | Observable Discrepancy | base | 2.3998 | Allowed |
| 3 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | base | 2.1190 | Allowed |
| 4 | 295 | Improper Certificate Validation | base | 2.1190 | Allowed |
| 5 | 385 | Covert Timing Channel | base | 1.7680 | Allowed |
| 6 | 1231 | Improper Prevention of Lock Bit Modification | Base | 1.6080 | Allowed |
| 7 | 1291 | Public Key Re-Use for Signing both Debug and Production Code | Base | 1.6059 | Allowed |
| 8 | 301 | Reflection Attack in an Authentication Protocol | base | 1.5210 | Allowed |
| 9 | 322 | Key Exchange without Entity Authentication | base | 1.5210 | Allowed |
| 10 | 1394 | Use of Default Cryptographic Key | Base | 1.4860 | Allowed |
| 11 | 522 | Insufficiently Protected Credentials | class | 1.3648 | Allowed-with-Review |
| 12 | 523 | Unprotected Transport of Credentials | base | 1.3104 | Allowed |
| 13 | 257 | Storing Passwords in a Recoverable Format | base | 1.1466 | Allowed |
| 14 | 259 | Use of Hard-coded Password | variant | 1.0584 | Allowed |
| 15 | 321 | Use of Hard-coded Cryptographic Key | Variant | 1.0494 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1394 | Use of Default Cryptographic Key | Base | 0.5026 | 0.5026 | Allowed |
| 2 | 1231 | Improper Prevention of Lock Bit Modification | Base | 0.5006 | 0.5006 | Allowed |
| 3 | 1291 | Public Key Re-Use for Signing both Debug and Production Code | Base | 0.4903 | 0.4903 | Allowed |
| 4 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | 0.4893 | 0.4893 | Allowed-with-Review |
| 5 | 316 | Cleartext Storage of Sensitive Information in Memory | Variant | 0.4885 | 0.4885 | Allowed |
| 6 | 1326 | Missing Immutable Root of Trust in Hardware | Base | 0.4883 | 0.4883 | Allowed |
| 7 | 321 | Use of Hard-coded Cryptographic Key | Variant | 0.4857 | 0.4857 | Allowed |
| 8 | 822 | Untrusted Pointer Dereference | Base | 0.4815 | 0.4815 | Allowed |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4791 | 0.4791 | Allowed |
| 10 | 349 | Acceptance of Extraneous Untrusted Data With Trusted Data | Base | 0.4783 | 0.4783 | Allowed |
| 11 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4758 | 0.4758 | Allowed |
| 12 | 1258 | Exposure of Sensitive System Information Due to Uncleared Debug Information | Base | 0.4677 | 0.4677 | Allowed |
| 13 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4665 | 0.4665 | Allowed |
| 14 | 1323 | Improper Management of Sensitive Trace Data | Base | 0.4650 | 0.4650 | Allowed |
| 15 | 1243 | Sensitive Non-Volatile Information Not Protected During Debug | Base | 0.4589 | 0.4589 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 1002.4455 | 1002.4455 | Allowed-with-Review |
| 2 | 295 | Improper Certificate Validation | 999.9729 | 999.9729 | Allowed |
| 3 | 203 | Observable Discrepancy | 995.2500 | 995.2500 | Allowed |
| 4 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 979.7967 | 979.7967 | Allowed |
| 5 | 522 | Insufficiently Protected Credentials | 976.2873 | 976.2873 | Allowed-with-Review |
| 6 | 321 | Use of Hard-coded Cryptographic Key | 975.4847 | 975.4847 | Allowed |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | 965.9241 | 965.9241 | Allowed |
| 8 | 532 | Insertion of Sensitive Information into Log File | 945.2199 | 945.2199 | Allowed |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 944.4983 | 944.4983 | Allowed |
| 10 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | 933.2911 | 933.2911 | Allowed |
