{
  "query": "In lunary-ai/lunary version 1.2.4, an account takeover vulnerability exists due to the exposure of password recovery tokens in API responses. Specifically, when a user initiates the password reset process, the recovery token is included in the response of the `GET /v1/users/me/org` endpoint, which lists all users in a team. This allows any authenticated user to capture the recovery token of another user and subsequently change that users password without consent, effectively taking over the account. The issue lies in the inclusion of the `recovery_token` attribute in the users object returned by the API.",
  "count": 20,
  "results": [
    {
      "cwe_id": "620",
      "name": "Unverified Password Change",
      "abstraction": "Base",
      "score": 0.5198274539360876,
      "original_score": 0.5198274539360876,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "640",
      "name": "Weak Password Recovery Mechanism for Forgotten Password",
      "abstraction": "Base",
      "score": 0.5086566033166837,
      "original_score": 0.5086566033166837,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "257",
      "name": "Storing Passwords in a Recoverable Format",
      "abstraction": "Base",
      "score": 0.4879878099562242,
      "original_score": 0.4879878099562242,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "90",
      "name": "Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')",
      "abstraction": "Base",
      "score": 0.47422144069577726,
      "original_score": 0.47422144069577726,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "549",
      "name": "Missing Password Field Masking",
      "abstraction": "Base",
      "score": 0.4725513967460773,
      "original_score": 0.4725513967460773,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "359",
      "name": "Exposure of Private Personal Information to an Unauthorized Actor",
      "abstraction": "Base",
      "score": 0.4693768809994376,
      "original_score": 0.4693768809994376,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "836",
      "name": "Use of Password Hash Instead of Password for Authentication",
      "abstraction": "Base",
      "score": 0.46790508979235085,
      "original_score": 0.46790508979235085,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "305",
      "name": "Authentication Bypass by Primary Weakness",
      "abstraction": "Base",
      "score": 0.46524950433746787,
      "original_score": 0.46524950433746787,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "307",
      "name": "Improper Restriction of Excessive Authentication Attempts",
      "abstraction": "Base",
      "score": 0.46373522691528,
      "original_score": 0.46373522691528,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "922",
      "name": "Insecure Storage of Sensitive Information",
      "abstraction": "Class",
      "score": 0.45448361339529164,
      "original_score": 0.45448361339529164,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "1270",
      "name": "Generation of Incorrect Security Tokens",
      "abstraction": "Base",
      "score": 0.4509375841301577,
      "original_score": 0.4509375841301577,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "abstraction": "Base",
      "score": 0.4506967367284678,
      "original_score": 0.4506967367284678,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "204",
      "name": "Observable Response Discrepancy",
      "abstraction": "Base",
      "score": 0.4500120997318898,
      "original_score": 0.4500120997318898,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "294",
      "name": "Authentication Bypass by Capture-replay",
      "abstraction": "Base",
      "score": 0.44906620274203496,
      "original_score": 0.44906620274203496,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "288",
      "name": "Authentication Bypass Using an Alternate Path or Channel",
      "abstraction": "Base",
      "score": 0.4480554578123463,
      "original_score": 0.4480554578123463,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "645",
      "name": "Overly Restrictive Account Lockout Mechanism",
      "abstraction": "Base",
      "score": 0.44443299384920476,
      "original_score": 0.44443299384920476,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "916",
      "name": "Use of Password Hash With Insufficient Computational Effort",
      "abstraction": "Base",
      "score": 0.4433764582043279,
      "original_score": 0.4433764582043279,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "302",
      "name": "Authentication Bypass by Assumed-Immutable Data",
      "abstraction": "Base",
      "score": 0.4402339760613581,
      "original_score": 0.4402339760613581,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "472",
      "name": "External Control of Assumed-Immutable Web Parameter",
      "abstraction": "Base",
      "score": 0.44022104725961125,
      "original_score": 0.44022104725961125,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "303",
      "name": "Incorrect Implementation of Authentication Algorithm",
      "abstraction": "Base",
      "score": 0.4399601567640945,
      "original_score": 0.4399601567640945,
      "mapping_usage": "Allowed"
    }
  ],
  "statistics": {
    "min": 0.4399601567640945,
    "max": 0.5198274539360876,
    "mean": 0.46204938666870854,
    "median": 0.4527105987627247,
    "count": 20
  }
}