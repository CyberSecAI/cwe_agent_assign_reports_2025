# Raw Retriever Results for CVE-2024-5133

# Raw Retriever Results for CVE-2024-5133
## Query
In lunary-ai/lunary version 1.2.4, an account takeover vulnerability exists due to the exposure of password recovery tokens in API responses. Specifically, when a user initiates the password reset process, the recovery token is included in the response of the `GET /v1/users/me/org` endpoint, which lists all users in a team. This allows any authenticated user to capture the recovery token of another user and subsequently change that users password without consent, effectively taking over the account. The issue lies in the inclusion of the `recovery_token` attribute in the users object returned by the API.

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4399 | 0.5198 | 0.4620 | 0.4527 | 20 |
| Sparse | 176.6715 | 185.9644 | 182.0703 | 183.4300 | 10 |
| Graph | 1.4080 | 2.4700 | 1.8612 | 1.8505 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.4700 | Allowed |
| 2 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 4 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | base | 2.2100 | Allowed |
| 5 | 798 | Use of Hard-coded Credentials | base | 2.1762 | Allowed |
| 6 | 209 | Generation of Error Message Containing Sensitive Information | base | 2.1762 | Allowed |
| 7 | 499 | Serializable Class Containing Sensitive Data | variant | 2.0400 | Allowed |
| 8 | 498 | Cloneable Class Containing Sensitive Information | variant | 2.0400 | Allowed |
| 9 | 259 | Use of Hard-coded Password | variant | 1.9147 | Allowed |
| 10 | 257 | Storing Passwords in a Recoverable Format | Base | 1.8993 | Allowed |
| 11 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.8018 | Allowed |
| 12 | 640 | Weak Password Recovery Mechanism for Forgotten Password | Base | 1.7290 | Allowed-with-Review |
| 13 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6961 | Allowed |
| 14 | 549 | Missing Password Field Masking | Base | 1.6233 | Allowed |
| 15 | 321 | Use of Hard-coded Cryptographic Key | variant | 1.5691 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 620 | Unverified Password Change | Base | 0.5198 | 0.5198 | Allowed |
| 2 | 640 | Weak Password Recovery Mechanism for Forgotten Password | Base | 0.5086 | 0.5086 | Allowed-with-Review |
| 3 | 257 | Storing Passwords in a Recoverable Format | Base | 0.4879 | 0.4879 | Allowed |
| 4 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4742 | 0.4742 | Allowed |
| 5 | 549 | Missing Password Field Masking | Base | 0.4725 | 0.4725 | Allowed |
| 6 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4693 | 0.4693 | Allowed |
| 7 | 836 | Use of Password Hash Instead of Password for Authentication | Base | 0.4679 | 0.4679 | Allowed |
| 8 | 305 | Authentication Bypass by Primary Weakness | Base | 0.4652 | 0.4652 | Allowed |
| 9 | 307 | Improper Restriction of Excessive Authentication Attempts | Base | 0.4637 | 0.4637 | Allowed |
| 10 | 922 | Insecure Storage of Sensitive Information | Class | 0.4544 | 0.4544 | Allowed-with-Review |
| 11 | 1270 | Generation of Incorrect Security Tokens | Base | 0.4509 | 0.4509 | Allowed |
| 12 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.4506 | 0.4506 | Allowed |
| 13 | 204 | Observable Response Discrepancy | Base | 0.4500 | 0.4500 | Allowed |
| 14 | 294 | Authentication Bypass by Capture-replay | Base | 0.4490 | 0.4490 | Allowed |
| 15 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | 0.4480 | 0.4480 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 287 | Improper Authentication | 185.9644 | 185.9644 | Discouraged |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | 184.9712 | 184.9712 | Allowed |
| 3 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | 184.0284 | 184.0284 | Discouraged |
| 4 | 863 | Incorrect Authorization | 183.9895 | 183.9895 | Allowed-with-Review |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | 183.4495 | 183.4495 | Allowed |
| 6 | 306 | Missing Authentication for Critical Function | 183.4104 | 183.4104 | Allowed |
| 7 | 1390 | Weak Authentication | 182.8534 | 182.8534 | Allowed-with-Review |
| 8 | 522 | Insufficiently Protected Credentials | 178.6324 | 178.6324 | Allowed-with-Review |
| 9 | 208 | Observable Timing Discrepancy | 176.7325 | 176.7325 | Allowed |
| 10 | 256 | Plaintext Storage of a Password | 176.6715 | 176.6715 | Allowed |
