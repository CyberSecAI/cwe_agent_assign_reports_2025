## Vulnerability Description
In lunary-ai/lunary version 1.2.4, an account takeover vulnerability exists due to the exposure of password recovery tokens in API responses. Specifically, when a user initiates the password reset process, the recovery token is included in the response of the `GET /v1/users/me/org` endpoint, which lists all users in a team. This allows any authenticated user to capture the recovery token of another user and subsequently change that users password without consent, effectively taking over the account. The issue lies in the inclusion of the `recovery_token` attribute in the users object returned by the API.

### Vulnerability Description Key Phrases
- **impact:** account takeover
- **vector:** password recovery tokens in API responses
- **attacker:** any authenticated user
- **product:** lunary-ai/lunary
- **version:** 1.2.4
- **component:** GET /v1/users/me/org endpoint

## CVE Reference Links Content Summary
UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.186 |
| 2 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.185 |
| 3 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.184 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.184 |
| 5 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.183 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.183 |
| 7 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.183 |
| 8 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.179 |
| 9 | 620 | Unverified Password Change | Base | Allowed | dense | 0.520 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-287: Improper Authentication

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-863: Incorrect Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-306: Missing Authentication for Critical Function

CWE-1390: Weak Authentication

CWE-522: Insufficiently Protected Credentials

CWE-620: Unverified Password Change

CWE-226: Sensitive Information in Resource Not Removed Before Reuse