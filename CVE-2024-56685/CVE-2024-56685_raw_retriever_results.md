# Raw Retriever Results for CVE-2024-56685

# Raw Retriever Results for CVE-2024-56685
## Query
In the Linux kernel, the following vulnerability has been resolved ASoC mediatek Check num_codecs is not zero to avoid panic during probe Following commit 13f58267cda3 (ASoC soc.h dont create dummy Component via COMP_DUMMY()), COMP_DUMMY() became an array with zero length, and only gets populated with the dummy struct after the card is registered. Since the sound card drivers probe happens before the card registration, accessing any of the members of a dummy component during probe will result in undefined behavior. This can be observed in the mt8188 and mt8195 machine sound drivers. By omitting a dai link subnode in the sound cards node in the Devicetree, the default uninitialized dummy codec is used, and when its dai_name pointer gets passed to strcmp() it results in a null pointer dereference and a kernel panic. In addition to that, set_card_codec_info() in the generic helpers file, mtk-soundcard-driver.c, will populate a dai link with a dummy codec when a dai link node is present in DT but with no codec property. The result is that at probe time, a dummy codec can either be uninitialized with num_codecs = 0, or be an initialized dummy codec, with num_codecs = 1 and dai_name = snd-soc-dummy-dai. In order to accommodate for both situations, check that num_codecs is not zero before accessing the codecs fields but still check for the codecs dai name against snd-soc-dummy-dai as needed. While at it, also drop the check that dai_name is not null in the mt8192 driver, introduced in commit 4d4e1b6319e5 (ASoC mediatek mt8192 Check existence of dai_name before dereferencing), as it is actually redundant given the preceding num_codecs != 0 check.

## Keyphrases
- **rootcause**: 'accessing members of dummy component during probe before registration'
- **weakness**: 'array with zero length', 'null pointer dereference', 'undefined behavior'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4181 | 0.4881 | 0.4476 | 0.4566 | 20 |
| Sparse | 1145.3795 | 1333.5865 | 1250.3393 | 1236.0084 | 11 |
| Graph | 1.7173 | 2.7972 | 2.2055 | 2.1446 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 822 | Untrusted Pointer Dereference | Base | 2.7972 | Allowed |
| 2 | 476 | NULL Pointer Dereference | Base | 2.7939 | Allowed |
| 3 | 823 | Use of Out-of-range Pointer Offset | Base | 2.7930 | Allowed |
| 4 | 125 | Out-of-bounds Read | Base | 2.7846 | Allowed |
| 5 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.6784 | Allowed |
| 6 | 129 | Improper Validation of Array Index | variant | 2.6784 | Allowed |
| 7 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 8 | 787 | Out-of-bounds Write | base | 2.2100 | Allowed |
| 9 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.0792 | Allowed |
| 12 | 456 | Missing Initialization of a Variable | variant | 2.0400 | Allowed |
| 13 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 14 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4881 | 0.4881 | Allowed |
| 2 | 822 | Untrusted Pointer Dereference | Base | 0.4765 | 0.4765 | Allowed |
| 3 | 457 | Use of Uninitialized Variable | Variant | 0.4693 | 0.4693 | Allowed |
| 4 | 823 | Use of Out-of-range Pointer Offset | Base | 0.4684 | 0.4684 | Allowed |
| 5 | 1189 | Improper Isolation of Shared Resources on System-on-a-Chip (SoC) | Base | 0.4670 | 0.4670 | Allowed |
| 6 | 909 | Missing Initialization of Resource | Class | 0.4668 | 0.4668 | Allowed-with-Review |
| 7 | 476 | NULL Pointer Dereference | Base | 0.4668 | 0.4668 | Allowed |
| 8 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4616 | 0.4616 | Allowed |
| 9 | 908 | Use of Uninitialized Resource | Base | 0.4605 | 0.4605 | Allowed |
| 10 | 1191 | On-Chip Debug and Test Interface With Improper Access Control | Base | 0.4567 | 0.4567 | Allowed |
| 11 | 126 | Buffer Over-read | Variant | 0.4566 | 0.4566 | Allowed |
| 12 | 1248 | Semiconductor Defects in Hardware Logic with Security-Sensitive Implications | Base | 0.4290 | 0.4290 | Allowed |
| 13 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4284 | 0.4284 | Discouraged |
| 14 | 1192 | Improper Identifier for IP Block used in System-On-Chip (SOC) | Base | 0.4263 | 0.4263 | Allowed |
| 15 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4255 | 0.4255 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 476 | NULL Pointer Dereference | 1333.5865 | 1333.5865 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | 1323.5895 | 1323.5895 | Allowed |
| 3 | 125 | Out-of-bounds Read | 1290.2970 | 1290.2970 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1263.5471 | 1263.5471 | Allowed-with-Review |
| 5 | 908 | Use of Uninitialized Resource | 1254.4504 | 1254.4504 | Allowed |
| 6 | 1390 | Weak Authentication | 1236.0084 | 1236.0084 | Allowed-with-Review |
| 7 | 909 | Missing Initialization of Resource | 1234.9739 | 1234.9739 | Allowed-with-Review |
| 8 | 824 | Access of Uninitialized Pointer | 1228.9244 | 1228.9244 | Allowed |
| 9 | 252 | Unchecked Return Value | 1222.9720 | 1222.9720 | Allowed |
| 10 | 667 | Improper Locking | 1220.0041 | 1220.0041 | Allowed-with-Review |
| 11 | 665 | Improper Initialization | 1145.3795 | 1145.3795 | Discouraged |
