## Vulnerability Description
51l3nc3, member of the AXIS OS Bug Bounty Program, has found that the VAPIX API managedoverlayimages.cgi was vulnerable to a **race condition** attack allowing for an attacker to block access to the overlay configuration page in the web interface of the Axis device. This flaw can only be exploited after authenticating with an operator- or administrator-privileged service account. Axis has released patched AXIS OS versions for the highlighted flaw. Please refer to the Axis security advisory for more information and solution.

### Vulnerability Description Key Phrases
- **rootcause:** **race condition**
- **impact:** block access to overlay configuration page
- **attacker:** attacker
- **product:** AXIS OS
- **component:** VAPIX API managedoverlayimages.cgi

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: A race condition vulnerability exists in the `managedoverlayimages.cgi` endpoint of the VAPIX API.
- **Weaknesses/vulnerabilities present**: Race condition, allowing an attacker to block access to the overlay configuration page.
- **Impact of exploitation**: An attacker can block access to the overlay configuration page in the web interface of the Axis device.
- **Attack vectors**: Exploitation is achieved through the VAPIX API's `managedoverlayimages.cgi` endpoint.
- **Required attacker capabilities/position**: The attacker must authenticate to the Axis device with an operator- or administrator-privileged service account.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.515 |
| 3 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.490 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.457 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.449 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.447 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.446 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.444 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.525 |
| 10 | 322 | Key Exchange without Entity Authentication | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-285: Improper Authorization

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-863: Incorrect Authorization

CWE-306: Missing Authentication for Critical Function

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-322: Key Exchange without Entity Authentication