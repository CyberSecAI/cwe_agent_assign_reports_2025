# Vulnerability Information: CVE-2024-5826

## Vulnerability Description
In the latest version of vanna-ai/vanna, the `vanna.ask` function is vulnerable to remote code execution due to **prompt injection**. The root cause is the **lack of a sandbox when executing LLM-generated code**, allowing an attacker to manipulate the code executed by the `exec` function in `src/vanna/base/base.py`. This vulnerability can be exploited by an attacker to achieve remote code execution on the app backend server, potentially gaining full control of the server.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of a sandbox when executing LLM-generated code**
- **weakness:** **prompt injection**
- **impact:** remote code execution
- **vector:** manipulating code executed by exec function
- **attacker:** attacker
- **product:** vanna-ai/vanna
- **version:** latest version
- **component:** vanna.ask function

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | Allowed | alternate_terms | 1.000 |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.515 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.494 |
| 4 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.486 |
| 5 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.485 |
| 6 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.480 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.480 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.478 |
| 9 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | dense | 0.544 |
| 10 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | graph | 0.003 |

