## Vulnerability Description
A flaw was found in Booth, a cluster ticket manager. **If a specially-crafted hash is passed** to gcry_md_get_algo_dlen(), it may allow an invalid HMAC to be accepted by the Booth server.

### Vulnerability Description Key Phrases
- **weakness:** **If a specially-crafted hash is passed**
- **impact:** allow an invalid HMAC to be accepted
- **product:** Booth
- **component:** gcry_md_get_algo_dlen()

## CVE Reference Links Content Summary
```
{
  "CVE-2024-3049": {
    "description": "The Booth cluster ticket manager is vulnerable to accepting invalid HMAC due to a specially crafted hash being passed to `gcry_md_get_algo_dlen()`. This could allow unauthorized access or resource manipulation in a multi-site cluster environment.",
    "root_cause": "The vulnerability lies in the `gcry_md_get_algo_dlen()` function, which returns 0 for an unknown or specially crafted hash. This value is then used in a memcmp operation, allowing an attacker to potentially bypass the HMAC check.",
    "weaknesses": [
      "Improper validation of cryptographic hash algorithm.",
      "Use of a function that returns 0 instead of an error for an unsupported hash.",
       "Insufficient checks before performing memcmp operations using the result of a cryptographic function.",
       "Lack of proper error handling and validation of the result of gcry_md_get_algo_dlen()."
    ],
    "impact": "An attacker can bypass the HMAC authentication, potentially leading to unauthorized access and resource manipulation in a multi-site cluster environment. This could result in the cluster running resources at a wrong site, potentially causing service disruption or other critical issues.",
    "attack_vectors": "The attack vector involves sending a specially crafted hash to the Booth server. If the server doesn't properly validate the hash algorithm and uses its output in HMAC verification, an attacker can cause a zero-length comparison allowing them to forge an valid signature.",
    "required_capabilities": "The attacker needs to be able to communicate with the Booth server over the network and must have the ability to send specially crafted hashes."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.239 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.227 |
| 3 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.222 |
| 4 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.222 |
| 5 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.221 |
| 6 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.218 |
| 7 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.218 |
| 8 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.217 |
| 9 | 759 | Use of a One-Way Hash without a Salt | Variant | Allowed | dense | 0.525 |
| 10 | 567 | Unsynchronized Access to Shared Data in a Multithreaded Context | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-1390: Weak Authentication

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-319: Cleartext Transmission of Sensitive Information

CWE-328: Use of Weak Hash

CWE-674: Uncontrolled Recursion

CWE-190: Integer Overflow or Wraparound

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-407: Inefficient Algorithmic Complexity

CWE-759: Use of a One-Way Hash without a Salt

CWE-567: Unsynchronized Access to Shared Data in a Multithreaded Context