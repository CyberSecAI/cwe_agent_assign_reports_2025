# Vulnerability Information: CVE-2024-9287

## Vulnerability Description
A vulnerability has been found in the CPython `venv` module and CLI where path names provided when creating a virtual environment were not quoted properly, allowing the creator to inject commands into virtual environment activation scripts (ie source venv/bin/activate). This means that attacker-controlled virtual environments are able to run commands when the virtual environment is activated. Virtual environments which are not created by an attacker or which arent activated before being used (ie ./venv/bin/python) are not affected.

### Vulnerability Description Key Phrases
- **rootcause:** **improper escaping of user input**
- **weakness:** **command injection**
- **impact:** execute arbitrary commands
- **attacker:** virtual environment creator
- **product:** CPython
- **component:** venv module and CLI

## CVE Reference Links Content Summary
```
{
  "CVE-2024-9287": [
    {
      "Root cause of vulnerability": "The `venv` module in CPython did not properly quote path names when creating virtual environment activation scripts.",
      "Weaknesses/vulnerabilities present": "Command injection vulnerability due to improper quoting of paths in activation scripts.",
      "Impact of exploitation": "An attacker who controls the path names provided when creating a virtual environment can inject and execute arbitrary commands when a user activates the virtual environment.",
      "Attack vectors": "An attacker creates a virtual environment with a malicious path name and then tricks a victim into activating the environment.",
      "Required attacker capabilities/position": "The attacker needs to be able to create a virtual environment with a controllable path name. The victim must then activate this virtual environment.  Downstream projects that automatically initialize and activate `venv` at a controllable path (e.g. read from repo configuration file) are also vulnerable."
    },
    {
        "Root cause of vulnerability": "Template strings in venv activation scripts were not properly quoted.",
        "Weaknesses/vulnerabilities present": "The vulnerability is present in how the venv module generates activation scripts for different shells (bash, csh, bat, fish).",
        "Impact of exploitation": "Allows command injection by crafting malicious paths to the venv, leading to arbitrary code execution when the activation script is run.",
         "Attack vectors": "An attacker crafts a malicious path name for the venv when the environment is created, such that when the activation script is sourced or executed, it will perform unintended commands. Activation scripts are typically executed when the user 'activates' the venv",
        "Required attacker capabilities/position": "An attacker needs control over the name and path of the virtual environment being created. The attack is only successful if the victim activates the virtual environment."
    }
  ]
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.422 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.421 |
| 5 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.420 |
| 6 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.418 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.409 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.407 |
| 9 | 214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | dense | 0.547 |
| 10 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | graph | 0.002 |

