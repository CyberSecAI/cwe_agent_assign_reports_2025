# Vulnerability Information: CVE-2025-32955

## Vulnerability Description
Harden-Runner is a CI/CD security agent that works like an EDR for GitHub Actions runners. Versions from 0.12.0 to before 2.12.0 are vulnerable to `disable-sudo` bypass. Harden-Runner includes a policy option `disable-sudo` to prevent the GitHub Actions runner user from using sudo. This is implemented by removing the runner user from the sudoers file. However, this control can be bypassed as the runner user, being part of the docker group, can interact with the Docker daemon to launch privileged containers or access the host filesystem. This allows the attacker to regain root access or restore the sudoers file, effectively bypassing the restriction. This issue has been patched in version 2.12.0.

### Vulnerability Description Key Phrases
- **weakness:** **disable-sudo bypass**
- **product:** Harden-Runner
- **impact:** access the host filesystem, regain root access, restore the sudoers file
- **version:** from 0.12.0 to before 2.12.0

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
The 'disable-sudo' policy in Harden-Runner, which removes the runner user from the sudoers file, can be bypassed. This is because the runner user is part of the docker group, allowing interaction with the Docker daemon to launch privileged containers or access the host filesystem.

Weaknesses/vulnerabilities present:
- The 'disable-sudo' policy can be bypassed.
- Privilege escalation via Docker.

Impact of exploitation:
An attacker with the ability to run malicious code on a runner configured with `disable-sudo: true` can escalate privileges to root using Docker, defeating the intended security control.

Attack vectors:
An attacker needs the ability to run their malicious code on the runner. This could be achieved through:
- Supply chain attacks (e.g., similar to tj-actions).
- Exploiting a Pwn Request vulnerability.

Required attacker capabilities/position:
Ability to run malicious code on the runner.

Mitigation or fix:
The vulnerability has been fixed in Harden-Runner version `v2.12.0`.  Users should migrate to the stronger `disable-sudo-and-containers` policy. This setting:
- Disables sudo access.
- Removes access to dockerd and containerd sockets.
- Uninstalls Docker from the runner entirely, preventing container-based privilege escalation paths.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 214 | Invocation of Process Using Visible Sensitive Information | Base | Allowed | sparse | 0.669 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.598 |
| 3 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.598 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.593 |
| 5 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.589 |
| 6 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.581 |
| 7 | 250 | Execution with Unnecessary Privileges | Base | Allowed | sparse | 0.580 |
| 8 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.576 |
| 9 | 277 | Insecure Inherited Permissions | Variant | Allowed | dense | 0.462 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

