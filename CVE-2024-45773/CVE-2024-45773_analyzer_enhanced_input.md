## Vulnerability Description
A **use-after-free vulnerability** involving upgradeToRocket requests can cause the application to crash or potentially result in code execution or other undesirable effects. This issue affects Facebook Thrift prior to v2024.09.09.00.

### Vulnerability Description Key Phrases
- **rootcause:** **use-after-free vulnerability**
- **impact:** cause the application to crash and code execution
- **vector:** upgradeToRocket requests
- **product:** Facebook Thrift
- **version:** prior to v2024.09.09.00

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A use-after-free vulnerability exists in Facebook Thrift related to `upgradeToRocket` requests.
- **Weaknesses/vulnerabilities present:** Use-after-free vulnerability.
- **Impact of exploitation:**  The vulnerability can lead to application crashes, potential code execution, or other undefined behavior.
- **Attack vectors:** The vulnerability is triggered through  `upgradeToRocket` requests.
- **Required attacker capabilities/position:** The attacker needs to be able to send specially crafted or malicious `upgradeToRocket` requests to trigger the use-after-free condition.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 416 | Use After Free | Variant | Allowed | alternate_terms | 0.800 |
| 2 | 763 | Release of Invalid Pointer or Reference | Base | Allowed | sparse | 0.273 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.192 |
| 4 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.185 |
| 5 | 415 | Double Free | Variant | Allowed | sparse | 0.185 |
| 6 | 911 | Improper Update of Reference Count | Base | Allowed | sparse | 0.179 |
| 7 | 665 | Improper Initialization | Class | Discouraged | sparse | 0.175 |
| 8 | 364 | Signal Handler Race Condition | Base | Allowed | sparse | 0.174 |
| 9 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | dense | 0.516 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-416: Use After Free

CWE-763: Release of Invalid Pointer or Reference

CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

CWE-667: Improper Locking

CWE-415: Double Free

CWE-911: Improper Update of Reference Count

CWE-665: Improper Initialization

CWE-364: Signal Handler Race Condition

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-123: Write-what-where Condition