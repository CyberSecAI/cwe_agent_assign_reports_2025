## Vulnerability Description
Nextcloud Server is a self hosted personal cloud system. After setting up a user or administrator defined external storage with fixed credentials, the API returns them and adds them into the frontend again, allowing to read them in plain text when an attacker already has access to an active session of a user. It is recommended that the Nextcloud Server is upgraded to 28.0.12, 29.0.9 or 30.0.2 and Nextcloud Enterprise Server is upgraded to 25.0.13.14, 26.0.13.10, 27.1.11.10, 28.0.12, 29.0.9 or 30.0.2.

### Vulnerability Description Key Phrases
- **weakness:** **obtain credentials in plain text**
- **impact:** view credentials in plain text
- **attacker:** attacker with access to active session
- **product:** Nextcloud Server

## CVE Reference Links Content Summary
Based on the provided content, here's the breakdown of the vulnerability:

**Root cause of vulnerability:**
The vulnerability stems from the fact that when a user or administrator sets up an external storage with fixed credentials (e.g., password), the API incorrectly returns these credentials and includes them in the frontend. This exposes sensitive information that should not be accessible on the client side.

**Weaknesses/vulnerabilities present:**
- **Information Disclosure:** The primary vulnerability is the disclosure of sensitive credentials (passwords) in plain text via the API response. This is a classic example of exposing sensitive information.
- **Lack of Proper Handling of Sensitive Data:** The system does not properly handle the storage and transmission of sensitive data. The password should not be directly returned via API or displayed in the frontend.

**Impact of exploitation:**
- An attacker who has already gained access to an active user session can read the plaintext credentials of external storages.
- This could lead to further compromise, as the attacker can use the exposed passwords to access the external storages, potentially leading to data breaches or unauthorized modifications.

**Attack vectors:**
- The attack vector is primarily network-based, exploiting the API to retrieve the sensitive data. 

**Required attacker capabilities/position:**
- An attacker needs to have access to an active session of a legitimate user or administrator. This implies the attacker has already compromised the user session, possibly via social engineering, session hijacking, or other attacks.
- The attacker would need the ability to interact with the Nextcloud API to retrieve the exposed credentials.

**Additional details:**

- The fix for this vulnerability involves setting the password parameter as "sensitive" in the code. This prevents the password from being included in API responses.
- The vulnerability affects multiple versions of Nextcloud Server and Nextcloud Enterprise Server, with specific patch versions mentioned.
- The issue was reported by the Bundesamt f√ºr Sicherheit in der Informationstechnik (BSI) and mgm-sp.

The provided content clearly relates to CVE-2024-52523, detailing the vulnerability, its impact, and the fix applied.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.658 |
| 2 | 209 | Generation of Error Message Containing Sensitive Information | Base | Allowed | sparse | 0.576 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.547 |
| 4 | 256 | Plaintext Storage of a Password | Base | Allowed | sparse | 0.544 |
| 5 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.544 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.543 |
| 7 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.536 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.517 |
| 9 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | dense | 0.458 |
| 10 | 117 | Improper Output Neutralization for Logs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-532: Insertion of Sensitive Information into Log File

CWE-209: Generation of Error Message Containing Sensitive Information

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-256: Plaintext Storage of a Password

CWE-522: Insufficiently Protected Credentials

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-1390: Weak Authentication

CWE-862: Missing Authorization

CWE-312: Cleartext Storage of Sensitive Information

CWE-117: Improper Output Neutralization for Logs