# Vulnerability Information: CVE-2024-6569

## Vulnerability Description
The Campaign Monitor for WordPress plugin for WordPress is vulnerable to Full Path Disclosure in all versions up to, and including, 2.8.15. This is due the plugin **not properly restricting direct access to /forms/views/admin/create.php** and display_errors being enabled. This makes it possible for unauthenticated attackers to retrieve the full path of the web application, which can be used to aid other attacks. The information displayed is not useful on its own, and requires another vulnerability to be present for damage to an affected website.

### Vulnerability Description Key Phrases
- **rootcause:** **not properly restricting direct access to /forms/views/admin/create.php**
- **impact:** Full Path Disclosure
- **attacker:** unauthenticated attackers
- **product:** Campaign Monitor for WordPress plugin for WordPress
- **version:** all versions up to, and including, 2.8.15

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-6569

**Root Cause of Vulnerability:**
The vulnerability stems from the plugin not properly restricting direct access to the `/forms/views/admin/create.php` file. Additionally, `display_errors` was enabled, which resulted in the full path of the web application being exposed.

**Weaknesses/Vulnerabilities Present:**
*   **Full Path Disclosure:** The plugin exposes the server's full file path due to misconfiguration and lack of access control on `create.php`.
*   **Lack of Access Control:** The `create.php` file could be accessed directly without authentication.

**Impact of Exploitation:**
*   **Information Disclosure:** An unauthenticated attacker can retrieve the full server path of the web application. While this information is not immediately damaging on its own, it can be used to aid in further attacks by providing internal path details.
*  **Aiding other attacks**: The path disclosure by itself is not critical, but the information gained could help an attacker in other attacks.

**Attack Vectors:**
*   **Direct File Access:** The attacker directly accesses the `/forms/views/admin/create.php` file via a web request.
*   **Unauthenticated Access:**  The attacker doesn't need to authenticate to exploit the vulnerability.

**Required Attacker Capabilities/Position:**
*   **Network Access:** The attacker needs network access to the WordPress site.
*   **No Authentication Required:** The attacker does not need any credentials to exploit this vulnerability.

**Additional Details:**
*   The vulnerability affects all versions of the plugin up to and including 2.8.15.
*   The issue was fixed in version 2.8.16 by adding a security check to the affected files.
*   The vulnerability was reported by stealthcopter.
*  The fix included adding `include_once '../../../security-check.php';` to the vulnerable files.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.612 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.607 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.606 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.605 |
| 5 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.599 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.592 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.589 |
| 8 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.579 |
| 9 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | dense | 0.548 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.003 |

