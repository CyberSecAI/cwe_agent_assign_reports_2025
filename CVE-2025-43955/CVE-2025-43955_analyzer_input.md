# Vulnerability Information: CVE-2025-43955

## Vulnerability Description
TwsCachedXPathAPI in Convertigo through 8.3.4 **does not restrict the use of commons-jxpath APIs**.

### Vulnerability Description Key Phrases
- **rootcause:** **does not restrict the use of commons-jxpath APIs**
- **product:** Convertigo
- **version:** through 8.3.4
- **component:** TwsCachedXPathAPI

## CVE Reference Links Content Summary
CVE-2025-43955: PLACEHOLDER - Implement CVE description retrieval

The content is **RELEVANT** and details an Expression Injection Vulnerability in convertigo. Here's the extracted information:

**Root cause of vulnerability:**

Convertigo uses `TwsCachedXPathAPI` to process XPath queries. The `selectList` and `selectNode` methods within this class execute XPath queries using the commons-jxpath library without essential security configurations. This allows excessively powerful expression parsing and evaluation, including the ability to access and invoke various methods.

**Weaknesses/vulnerabilities present:**

*   Expression Injection
*   Lack of security configurations in XPath processing.

**Impact of exploitation:**

*   Remote Code Execution (RCE)

**Attack vectors:**

*   Crafting malicious XPath expressions.

**Required attacker capabilities/position:**

*   Ability to control the XPath expression used in queries.

**Mitigation or fix:**

The recommended mitigation involves setting an empty function library for the `JXPathContext` to prevent function calls. The provided code snippets demonstrate the fix:

```java
	public Node selectNode(Node contextNode, String xpath) {
		Node node;
		try {
+                       JXPathContext context = JXPathContext.newContext(contextNode);
+                       context.setFunctions(new FunctionLibrary()); // Set empty function library to prevent calling functions
-			node = (Node) JXPathContext.newContext(contextNode).selectSingleNode(xpath);
			node = (Node) context.selectSingleNode(xpath);
		} catch (Exception e) {
			node = null;
		}
		return node;
	}
```

```java
@SuppressWarnings("unchecked")
	public List<Node> selectList(Node contextNode, String xpath) {
		@SuppressWarnings("rawtypes")
		List nodes;
		try {
+                       JXPathContext context = JXPathContext.newContext(contextNode);
+                       context.setFunctions(new FunctionLibrary()); // Set empty function library to prevent calling functions
-			nodes = JXPathContext.newContext(contextNode).selectNodes(xpath);
			nodes = (List) context.selectNodes(xpath);
			int i = 0;
			for (Object node: nodes) {
				if (node instanceof Number) {
					Number num = (Number) node;
					if (num.intValue() == num.doubleValue()) {
						node = Integer.toString(num.intValue());
					} else {
						node = Double.toString(num.doubleValue());
					}
				} else if (node instanceof Boolean) {
					node = node.toString();
				}

				if (node instanceof String) {
					Document doc =  contextNode instanceof Document ? (Document)contextNode : contextNode.getOwnerDocument();
					node = doc.createTextNode((String) node);
					nodes.set(i, node);
				}
				i++;
			}
		} catch (Exception e) {
			nodes = Collections.emptyList();
		}
		return (List<Node>) nodes;
	}
```

**Vulnerable modules:**

*   Connectors
*   Sequences
*   XML Mapping Engine

The content provides more detail than a typical CVE description, including code examples and specific mitigation steps.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 648 | Incorrect Use of Privileged APIs | Base | Allowed | sparse | 0.146 |
| 2 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | Allowed | sparse | 0.132 |
| 3 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.125 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.124 |
| 5 | 942 | Permissive Cross-domain Policy with Untrusted Domains | Variant | Allowed | sparse | 0.121 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.120 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.120 |
| 8 | 379 | Creation of Temporary File in Directory with Insecure Permissions | Base | Allowed | sparse | 0.120 |
| 9 | 643 | Improper Neutralization of Data within XPath Expressions ('XPath Injection') | Base | Allowed | dense | 0.479 |
| 10 | 827 | Improper Control of Document Type Definition | Variant | Allowed | graph | 0.002 |

