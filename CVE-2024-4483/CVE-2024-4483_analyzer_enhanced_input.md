## Vulnerability Description
The Email Encoder WordPress plugin before 2.2.2 does not escape the WP_Email_Encoder_Bundle_options[protection_text] parameter before outputting it back in an attribute in an admin page, leading to a Stored Cross-Site Scripting

### Vulnerability Description Key Phrases
- **weakness:** **cross-site scripting**
- **product:** Email Encoder WordPress plugin
- **version:** before 2.2.2

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The plugin does not properly sanitize or escape the `WP_Email_Encoder_Bundle_options[protection_text]` parameter before outputting it on an admin page. This allows for the injection of arbitrary HTML and JavaScript code.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability due to improper output encoding/escaping.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code that will execute in the browsers of other users who access the affected admin page. This could lead to session hijacking, account compromise, and other malicious activities.
- **Attack vectors:** An attacker needs to be logged in as an administrator or have admin-level privileges to modify the plugin's settings, specifically the `WP_Email_Encoder_Bundle_options[protection_text]` parameter. The malicious payload is stored in the database. The XSS is triggered when a victim visits the admin page containing the vulnerable output.
- **Required attacker capabilities/position:** The attacker must have administrative access to the WordPress dashboard to modify the plugin settings.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.324 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.277 |
| 3 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.275 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.246 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.246 |
| 6 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.229 |
| 7 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.225 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.213 |
| 9 | 172 | Encoding Error | Class | Allowed-with-Review | dense | 0.499 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-116: Improper Encoding or Escaping of Output

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-862: Missing Authorization

CWE-138: Improper Neutralization of Special Elements

CWE-172: Encoding Error

CWE-73: External Control of File Name or Path