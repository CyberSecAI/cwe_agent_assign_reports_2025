## Vulnerability Description
In Splunk Enterprise versions below 9.2.2, 9.1.5, and 9.0.10 and Splunk Cloud Platform versions below 9.1.2312.200, a low-privileged user that does not hold the admin or power Splunk roles could create notifications in Splunk Web Bulletin Messages that all users on the instance receive.

### Vulnerability Description Key Phrases
- **impact:** create notifications in Splunk Web Bulletin Messages
- **attacker:** low-privileged user
- **product:** Splunk Enterprise and Splunk Cloud Platform
- **version:** below 9.2.2, 9.1.5, and 9.0.10 and below 9.1.2312.200

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-36989:

**Root cause of vulnerability:**
- The vulnerability is caused by a lack of access control within the Splunk Web Bulletin Messages system. This allows low-privileged users, who do not have "admin" or "power" roles, to create and send notifications to all users on the Splunk instance.

**Weaknesses/vulnerabilities present:**
- **Missing Access Control:** The core weakness is the insufficient access control mechanism for the Splunk Web Bulletin Messages. Low-privileged users can send notifications, which should be restricted to higher privileged roles.

**Impact of exploitation:**
- **Information Disclosure (Low):** Malicious actors can use the vulnerability to send links to users which could direct them to websites that may contain malicious material or attempt to phish credentials.
- **Integrity (High):** Attackers can modify the content displayed to all users through notifications, potentially injecting malicious content or misleading information through a seemingly trusted source, which all users receive.

**Attack vectors:**
- **Network:** The attack is performed over the network, requiring network access to the Splunk web interface.
- **Web Interface:** Exploitation occurs through the Splunk Web interface using the Bulletin Messages system.

**Required attacker capabilities/position:**
- **Low-Privilege User:** The attacker must have a valid user account on the Splunk instance, but does not need elevated ("admin" or "power") privileges.
- **Network Access:** The attacker needs network connectivity to the Splunk instance web interface.

**Additional details:**

- The advisory notes that notifications can contain web links, which could result in users navigating to external sites or unintentionally executing searches.
- Splunk has rated this vulnerability as Medium severity (6.5) with a CVSS vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
- The provided Splunk detection logic searches for unauthorized notification input and is configured to look for potentially malicious activity related to this vulnerability.
- The detection is considered "experimental" indicating it is not fully tested or officially supported.
- The fix involves upgrading to Splunk Enterprise versions 9.2.2, 9.1.5, 9.0.10 or higher or Splunk Cloud Platform to versions 9.1.2312.200 or higher.
- A potential workaround involves disabling Splunk Web, but this may limit functionality.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.099 |
| 2 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.092 |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.090 |
| 4 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.090 |
| 5 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.087 |
| 6 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.087 |
| 7 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.087 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.086 |
| 9 | 842 | Placement of User into Incorrect Group | Base | Allowed | dense | 0.417 |
| 10 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-285: Improper Authorization

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-269: Improper Privilege Management

CWE-284: Improper Access Control

CWE-400: Uncontrolled Resource Consumption

CWE-23: Relative Path Traversal

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-842: Placement of User into Incorrect Group

CWE-1272: Sensitive Information Uncleared Before Debug/Power State Transition