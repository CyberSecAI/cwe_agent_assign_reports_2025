## Vulnerability Description
Directus is a real-time API and App dashboard for managing SQL database content. When relying on blocking access to localhost using the default `0.0.0.0` filter a user may bypass this block by using other registered loopback devices (like `127.0.0.2` - `127.127.127.127`). This issue has been addressed in release versions 10.13.3 and 11.1.0. Users are advised to upgrade. Users unable to upgrade may block this bypass by manually adding the `127.0.0.0/8` CIDR range which will block access to any `127.X.X.X` ip instead of just `127.0.0.1`.

### Vulnerability Description Key Phrases
- **rootcause:** **default 0.0.0.0 filter bypass**
- **impact:** bypass access block
- **vector:** using other registered loopback devices
- **attacker:** user
- **product:** Directus

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-46990:

**Root Cause of Vulnerability:**
The vulnerability stems from an insufficient IP address filtering mechanism in the `is-denied-ip.ts` file. The default blocklist only included `0.0.0.0`, which is not sufficient to block all loopback addresses. It fails to consider other loopback addresses within the `127.0.0.0/8` CIDR range (e.g. `127.0.0.2` - `127.255.255.254`), allowing a bypass of the intended loopback access restriction.

**Weaknesses/Vulnerabilities Present:**
- **Inadequate Input Validation:** The IP address filter only checked for an exact match against `0.0.0.0` instead of validating against the entire loopback range.
- **SSRF bypass:** The vulnerability allows an attacker to bypass intended restrictions of localhost access, potentially leading to Server Side Request Forgery (SSRF) attacks.

**Impact of Exploitation:**
- **SSRF:** An attacker could potentially craft requests targeting internal services accessible on loopback addresses. This could expose internal services and potentially lead to further attacks.
- **Confidentiality:** While the direct impact on data confidentiality is rated as "low", the vulnerability can lead to unauthorized access to internal services, which could expose sensitive data.

**Attack Vectors:**
- **Network:** The vulnerability is exploitable over the network, meaning the attacker can be remote.

**Required Attacker Capabilities/Position:**
- **Low privileges:** The attacker requires low privileges within the system to exploit this vulnerability.
- **Network access:** The attacker needs to be able to send requests to the vulnerable application.
- **No user interaction:** No user interaction is needed to trigger the vulnerability

**Additional details:**
- The vulnerability is fixed in versions `10.13.3` and `11.1.0`.
- A workaround was suggested to manually block the `127.0.0.0/8` CIDR range.
- The vulnerability was reported by user `r3dpower`.
- The CVSS score is 5.0, with a base metric string of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 290 | Authentication Bypass by Spoofing | Base | Allowed | sparse | 0.553 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.523 |
| 3 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.521 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.518 |
| 5 | 1385 | Missing Origin Validation in WebSockets | Variant | Allowed | sparse | 0.514 |
| 6 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.504 |
| 7 | 420 | Unprotected Alternate Channel | Base | Allowed | sparse | 0.499 |
| 8 | 1389 | Incorrect Parsing of Numbers with Different Radices | Base | Allowed | sparse | 0.498 |
| 9 | 1327 | Binding to an Unrestricted IP Address | Base | Allowed | dense | 0.465 |
| 10 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-290: Authentication Bypass by Spoofing

CWE-863: Incorrect Authorization

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1385: Missing Origin Validation in WebSockets

CWE-287: Improper Authentication

CWE-420: Unprotected Alternate Channel

CWE-1389: Incorrect Parsing of Numbers with Different Radices

CWE-1327: Binding to an Unrestricted IP Address

CWE-350: Reliance on Reverse DNS Resolution for a Security-Critical Action