## Vulnerability Description
An issue was discovered in SeaCMS <=12.9 which allows remote attackers to execute arbitrary code via admin_ping.php.

### Vulnerability Description Key Phrases
- **impact:** execute arbitrary code
- **attacker:** remote attackers
- **product:** SeaCMS
- **version:** <=12.9
- **component:** admin_ping.php

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability lies in the `admin_ping.php` file of SeaCMS v12.9.
- The script takes user-provided `weburl` and `token` parameters and directly concatenates them into a string, which is then written into the `ping.php` file. This process lacks any sanitization or filtering.

**Weaknesses/Vulnerabilities Present:**

- **Remote Code Execution (RCE):** Due to the unsanitized input being directly written to a PHP file, an attacker can inject malicious code that will be executed when `ping.php` is accessed.
- **Lack of Input Sanitization:** The core issue is the failure to sanitize or validate user-supplied parameters before incorporating them into a critical system file.

**Impact of Exploitation:**

- **Arbitrary Command Execution:**  An attacker can execute arbitrary system commands on the server where SeaCMS is installed.
- **System Compromise:** Successful exploitation can lead to complete server compromise, potentially enabling data theft, malware installation, or further attacks on other systems.

**Attack Vectors:**

- **HTTP POST Request:** The vulnerability is exploited by sending a crafted POST request to the vulnerable `admin_ping.php` endpoint.
- **Malicious Input:** The attacker injects malicious PHP code within the `weburl` and/or `token` parameters of the POST request.

**Required Attacker Capabilities/Position:**

- **Authentication:**  The attacker needs to be authenticated as an administrator within the SeaCMS system to access and use the `admin_ping.php` script.
- **Network Access:** The attacker needs to have network access to the server hosting the vulnerable SeaCMS installation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.042 |
| 2 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.033 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.033 |
| 4 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.033 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.032 |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.032 |
| 7 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.032 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.031 |
| 9 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | dense | 0.581 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-502: Deserialization of Untrusted Data

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-790: Improper Filtering of Special Elements

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')