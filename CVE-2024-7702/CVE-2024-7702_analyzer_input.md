# Vulnerability Information: CVE-2024-7702

## Vulnerability Description
The Contact Form by Bit Form Multi Step Form, Calculation Contact Form, Payment Contact Form & Custom Contact Form builder plugin for WordPress is vulnerable to generic SQL Injection via the entryID parameter in versions 2.0 to 2.13.9 due to **insufficient escaping on the user-supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Administrator-level access and above, to append additional SQL queries to already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user-supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers with Administrator-level access and above
- **product:** ['Bit Form Multi Step Form' and 'Calculation Contact Form' and 'Payment Contact Form & Custom Contact Form builder plugin']
- **version:** 2.0 to 2.13.9
- **component:** entryID parameter

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-89

#### Top CWEs
- CWE-89 (Count: 12)

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-7702:

**1. Verification of CVE Relevance:**

*   The provided content from Wordfence explicitly mentions **CVE-2024-7702**, along with a description of a vulnerability in the "Contact Form by Bit Form" plugin. The vulnerability is identified as an **SQL Injection** flaw in the `getLogHistory` function.
*  The code from `plugins.trac.wordpress.org` shows the `getLogHistory` function at line 968, which is also referenced by wordfence.
* This confirms the content is related to the specified CVE.

**2. Root Cause of Vulnerability:**

*   The root cause is an **improper neutralization of special elements used in an SQL command**, leading to a **SQL Injection** vulnerability.
*   Specifically, the `entryID` parameter within the `getLogHistory` function is not properly sanitized or escaped before being used in a SQL query. This allows attackers to inject malicious SQL code.

**3. Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The core weakness is the lack of proper input sanitization and parameterized queries in the `getLogHistory` function. The code is vulnerable to generic SQL Injection
*   The Wordfence description indicates "insufficient escaping on the user-supplied parameter and lack of sufficient preparation on the existing SQL query."

**4. Impact of Exploitation:**

*   **Data Exposure:** Successful exploitation allows attackers to extract sensitive information from the database. This could include user data, form submission data, or potentially other sensitive information stored in the WordPress database.
*   **Data Modification or Deletion:** Depending on the attacker's SQL injection payload, they might also be able to modify or delete data in the database.

**5. Attack Vectors:**

*   **Network:** The attack vector is over the network, using HTTP requests to the WordPress site.
*   **Specific Parameter:** The vulnerability is triggered through the `entryID` parameter when calling the `getLogHistory` AJAX action.
*   **Authenticated Access:** The attacker needs to be authenticated as an administrator or higher privileged user.

**6. Required Attacker Capabilities/Position:**

*   **Administrator Level Access:** The attacker must have administrator-level access or higher to the WordPress site.
*   **Understanding of WordPress AJAX:** The attacker needs to know how WordPress AJAX requests are structured.

**Additional Notes from the provided Content:**

*   **Affected Versions:** The vulnerability affects "Contact Form by Bit Form" plugin versions 2.0 up to 2.13.9.
*   **Patched Version:** The vulnerability is fixed in version 2.13.10 and above.
*   The Trac link in the Wordfence report points to the `getLogHistory` function within the provided `AdminAjax.php` file, further solidifying the accuracy of the report.

In summary, CVE-2024-7702 is a critical SQL Injection vulnerability present in the "Contact Form by Bit Form" plugin. It allows an authenticated attacker with admin-level access to potentially steal sensitive information or perform other malicious actions in the database due to improper sanitization of user input in the `getLogHistory` function.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.597 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.594 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.545 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.542 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.526 |
| 7 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | sparse | 0.520 |
| 8 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.518 |
| 9 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | dense | 0.494 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

