## Vulnerability Description
In phpipam/phpipam version 1.5.1, the Secure attribute for sensitive cookies in HTTPS sessions is not set. This could cause the user agent to send those cookies in plaintext over an HTTP session, potentially exposing sensitive information. The issue is fixed in version 1.7.0.

### Vulnerability Description Key Phrases
- **weakness:** **missing Secure attribute for sensitive cookies**
- **product:** phpipam/phpipam
- **impact:** expose sensitive information, send cookies in plaintext over an HTTP session
- **version:** 1.5.1

## CVE Reference Links Content Summary
## Analysis of CVE-2024-10718 related content

The provided content relates to a security fix in phpipam, specifically addressing cookies being set without the `Secure` attribute. This directly corresponds to a vulnerability that could allow for man-in-the-middle attacks.

**Root cause of vulnerability:**

Cookies were being set without the `Secure` attribute.

**Weaknesses/vulnerabilities present:**

*   **Missing Secure Cookie Attribute:** The absence of the `Secure` attribute on cookies allows them to be transmitted over insecure HTTP connections, making them vulnerable to interception by attackers.

**Impact of exploitation:**

*   **Man-in-the-Middle (MitM) Attacks:** An attacker could intercept the cookie and potentially hijack a user's session.

**Attack vectors:**

*   **Network Sniffing:** An attacker on the same network as the user could sniff the HTTP traffic and steal the cookie.
*   **Unsecured Wi-Fi Networks:**  Exploitation is easier on public or unsecured Wi-Fi networks.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs to be in a position to intercept network traffic between the user and the server.
*   **No special privileges required:** The attack does not require any specific privileges on the target system.

**Mitigation or fix:**

*   **Setting the Secure Attribute:** The fix involves setting the `Secure` attribute when setting cookies, ensuring they are only transmitted over HTTPS connections. The code changes include adding `$this->isHttps()` to the `setcookie_samesite` function calls.
*   **Updated `setcookie_samesite` function:** The `setcookie_samesite` function was updated to accept a `$secure` parameter and include the "Secure;" header when appropriate.
*   **jQuery Upgrade:** jQuery was upgraded to version 3.7.1.

**More detail than official CVE description:**

Yes, the content provides specific code changes and details about the affected files (class.Table.php, class.User.php, global\_functions.php, index.php) and lines of code, which is more detailed than a typical CVE description. It also explains *how* the fix was implemented.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | sparse | 0.428 |
| 2 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | sparse | 0.330 |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.288 |
| 4 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | sparse | 0.285 |
| 5 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.279 |
| 6 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.273 |
| 7 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.258 |
| 8 | 472 | External Control of Assumed-Immutable Web Parameter | Base | Allowed | sparse | 0.253 |
| 9 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | Allowed | dense | 0.576 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute

CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-312: Cleartext Storage of Sensitive Information

CWE-319: Cleartext Transmission of Sensitive Information

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')

CWE-472: External Control of Assumed-Immutable Web Parameter

CWE-1275: Sensitive Cookie with Improper SameSite Attribute

CWE-226: Sensitive Information in Resource Not Removed Before Reuse