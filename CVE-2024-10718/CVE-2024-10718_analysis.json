{
  "cve_id": "CVE-2024-10718",
  "description": "In phpipam/phpipam version 1.5.1, the Secure attribute for sensitive cookies in HTTPS sessions is not set. This could cause the user agent to send those cookies in plaintext over an HTTP session, potentially exposing sensitive information. The issue is fixed in version 1.7.0.",
  "key_phrases": {
    "component": "",
    "rootcause": "",
    "vector": "",
    "weakness": "missing Secure attribute for sensitive cookies",
    "product": "phpipam/phpipam",
    "impact": "expose sensitive information, send cookies in plaintext over an HTTP session",
    "attacker": "",
    "version": "1.5.1"
  },
  "reference_content": "## Analysis of CVE-2024-10718 related content\n\nThe provided content relates to a security fix in phpipam, specifically addressing cookies being set without the `Secure` attribute. This directly corresponds to a vulnerability that could allow for man-in-the-middle attacks.\n\n**Root cause of vulnerability:**\n\nCookies were being set without the `Secure` attribute.\n\n**Weaknesses/vulnerabilities present:**\n\n*   **Missing Secure Cookie Attribute:** The absence of the `Secure` attribute on cookies allows them to be transmitted over insecure HTTP connections, making them vulnerable to interception by attackers.\n\n**Impact of exploitation:**\n\n*   **Man-in-the-Middle (MitM) Attacks:** An attacker could intercept the cookie and potentially hijack a user's session.\n\n**Attack vectors:**\n\n*   **Network Sniffing:** An attacker on the same network as the user could sniff the HTTP traffic and steal the cookie.\n*   **Unsecured Wi-Fi Networks:**  Exploitation is easier on public or unsecured Wi-Fi networks.\n\n**Required attacker capabilities/position:**\n\n*   **Network Access:** The attacker needs to be in a position to intercept network traffic between the user and the server.\n*   **No special privileges required:** The attack does not require any specific privileges on the target system.\n\n**Mitigation or fix:**\n\n*   **Setting the Secure Attribute:** The fix involves setting the `Secure` attribute when setting cookies, ensuring they are only transmitted over HTTPS connections. The code changes include adding `$this->isHttps()` to the `setcookie_samesite` function calls.\n*   **Updated `setcookie_samesite` function:** The `setcookie_samesite` function was updated to accept a `$secure` parameter and include the \"Secure;\" header when appropriate.\n*   **jQuery Upgrade:** jQuery was upgraded to version 3.7.1.\n\n**More detail than official CVE description:**\n\nYes, the content provides specific code changes and details about the affected files (class.Table.php, class.User.php, global\\_functions.php, index.php) and lines of code, which is more detailed than a typical CVE description. It also explains *how* the fix was implemented.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | 1.0 | Variant | Allowed | Primary CWE. The **missing Secure attribute for sensitive cookies** is the root cause. |\n| CWE-319 | Cleartext Transmission of Sensitive Information | 0.7 | Base | Allowed | Secondary candidate. The impact of the missing attribute is transmitting sensitive information in cleartext. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship that influenced my decision was the parent-child relationship between CWE-319 (Cleartext Transmission of Sensitive Information) and CWE-614 (Sensitive Cookie in HTTPS Session Without 'Secure' Attribute). CWE-614 is a specific variant of CWE-319, focusing on the case where sensitive cookies are transmitted without the Secure attribute. The vulnerability description explicitly mentions the **missing Secure attribute for sensitive cookies**, making CWE-614 the more specific and appropriate choice as the primary CWE.\n\n```mermaid\ngraph TD\n    cwe614[\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\n    cwe319[\"CWE-319: Cleartext Transmission of Sensitive Information\"]\n    \n    cwe614 -->|CHILDOF| cwe319\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe614 primary\n    class cwe319 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing Secure attribute for sensitive cookies** (CWE-614), which leads to the potential **exposure of sensitive information** and **transmission of cookies in plaintext over an HTTP session** (CWE-319). The root cause is the **missing Secure attribute**, and the impact is the potential for cleartext transmission and interception of sensitive data.\n\n## Summary of Analysis\nMy analysis is primarily based on the provided evidence, which includes the vulnerability description and CVE Reference Links Content Summary. The vulnerability description explicitly mentions the **missing Secure attribute for sensitive cookies**, making CWE-614 a direct and accurate match. The CVE Reference Links Content Summary confirms this, stating that \"Cookies were being set without the `Secure` attribute.\" The provided code changes, specifically adding `$this->isHttps()` to the `setcookie_samesite` function calls, further support this classification.\n\nThe hierarchical relationship between CWE-614 and CWE-319 reinforces the selection of CWE-614 as the primary CWE. While CWE-319 describes the general problem of cleartext transmission, CWE-614 provides a more specific and relevant classification for this vulnerability. The retriever scores also support this decision, with CWE-614 having the highest score.\n\nI considered other CWEs from the Retriever Results, such as CWE-1004 (Sensitive Cookie Without 'HttpOnly' Flag), but this CWE is not applicable since the vulnerability description does not mention the HttpOnly flag. Similarly, CWE-201 (Insertion of Sensitive Information Into Sent Data) and CWE-312 (Cleartext Storage of Sensitive Information) are not as relevant as CWE-614, as they do not specifically address the issue of **missing Secure attribute for cookies**. CWE-327 (Use of a Broken or Risky Cryptographic Algorithm) is also not applicable, as the vulnerability does not involve any cryptographic algorithms.\n\nMy selected CWEs are at the optimal level of specificity because they accurately capture the root cause and potential impact of the vulnerability. CWE-614 directly addresses the **missing Secure attribute for sensitive cookies**, and CWE-319 describes the potential consequence of cleartext transmission.\n\nRelevant CWE Information:\n\n*   **CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute**\n    *   Technical Explanation: This CWE occurs when a web application sets a cookie containing sensitive information but fails to set the \"Secure\" attribute. As a result, the cookie can be transmitted over insecure HTTP connections, making it vulnerable to interception by attackers.\n    *   Security Implications: Attackers can intercept the cookie and potentially hijack a user's session, gaining unauthorized access to sensitive data and functionality.\n    *   Relationship Analysis: CWE-614 is a variant of CWE-319 (Cleartext Transmission of Sensitive Information), representing a specific case where sensitive cookies are transmitted in cleartext due to the **missing Secure attribute**.\n    *   Mapping Guidance: The MITRE mapping guidance ALLOWED for this CWE, since it is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n*   **CWE-319: Cleartext Transmission of Sensitive Information**\n    *   Technical Explanation: This CWE occurs when a product transmits sensitive data in cleartext over a communication channel that can be sniffed by unauthorized actors.\n    *   Security Implications: Attackers can intercept the sensitive data, potentially gaining access to confidential information, user credentials, or other sensitive resources.\n    *   Relationship Analysis: CWE-319 is a parent of CWE-614 (Sensitive Cookie in HTTPS Session Without 'Secure' Attribute), representing a more general case of cleartext transmission.\n    *   Mapping Guidance: The MITRE mapping guidance ALLOWED for this CWE, since it is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | 1.0 | Variant | Allowed | Primary CWE. The **missing Secure attribute for sensitive cookies** is the root cause. |\n| CWE-319 | Cleartext Transmission of Sensitive Information | 0.7 | Base | Allowed | Secondary candidate. The impact of the missing attribute is transmitting sensitive information in cleartext. |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary relationship that influenced my decision was the parent-child relationship between CWE-319 (Cleartext Transmission of Sensitive Information) and CWE-614 (Sensitive Cookie in HTTPS Session Without 'Secure' Attribute). CWE-614 is a specific variant of CWE-319, focusing on the case where sensitive cookies are transmitted without the Secure attribute. The vulnerability description explicitly mentions the **missing Secure attribute for sensitive cookies**, making CWE-614 the more specific and appropriate choice as the primary CWE.\n\n```mermaid\ngraph TD\n    cwe614[\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\n    cwe319[\"CWE-319: Cleartext Transmission of Sensitive Information\"]\n    \n    cwe614 -->|CHILDOF| cwe319\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    class cwe614 primary\n    class cwe319 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing Secure attribute for sensitive cookies** (CWE-614), which leads to the potential **exposure of sensitive information** and **transmission of cookies in plaintext over an HTTP session** (CWE-319). The root cause is the **missing Secure attribute**, and the impact is the potential for cleartext transmission and interception of sensitive data.\n\n## Summary of Analysis\nMy analysis is primarily based on the provided evidence, which includes the vulnerability description and CVE Reference Links Content Summary. The vulnerability description explicitly mentions the **missing Secure attribute for sensitive cookies**, making CWE-614 a direct and accurate match. The CVE Reference Links Content Summary confirms this, stating that \"Cookies were being set without the `Secure` attribute.\" The provided code changes, specifically adding `$this->isHttps()` to the `setcookie_samesite` function calls, further support this classification.\n\nThe hierarchical relationship between CWE-614 and CWE-319 reinforces the selection of CWE-614 as the primary CWE. While CWE-319 describes the general problem of cleartext transmission, CWE-614 provides a more specific and relevant classification for this vulnerability. The retriever scores also support this decision, with CWE-614 having the highest score.\n\nI considered other CWEs from the Retriever Results, such as CWE-1004 (Sensitive Cookie Without 'HttpOnly' Flag), but this CWE is not applicable since the vulnerability description does not mention the HttpOnly flag. Similarly, CWE-201 (Insertion of Sensitive Information Into Sent Data) and CWE-312 (Cleartext Storage of Sensitive Information) are not as relevant as CWE-614, as they do not specifically address the issue of **missing Secure attribute for cookies**. CWE-327 (Use of a Broken or Risky Cryptographic Algorithm) is also not applicable, as the vulnerability does not involve any cryptographic algorithms.\n\nMy selected CWEs are at the optimal level of specificity because they accurately capture the root cause and potential impact of the vulnerability. CWE-614 directly addresses the **missing Secure attribute for sensitive cookies**, and CWE-319 describes the potential consequence of cleartext transmission.\n\nRelevant CWE Information:\n\n*   **CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute**\n    *   Technical Explanation: This CWE occurs when a web application sets a cookie containing sensitive information but fails to set the \"Secure\" attribute. As a result, the cookie can be transmitted over insecure HTTP connections, making it vulnerable to interception by attackers.\n    *   Security Implications: Attackers can intercept the cookie and potentially hijack a user's session, gaining unauthorized access to sensitive data and functionality.\n    *   Relationship Analysis: CWE-614 is a variant of CWE-319 (Cleartext Transmission of Sensitive Information), representing a specific case where sensitive cookies are transmitted in cleartext due to the **missing Secure attribute**.\n    *   Mapping Guidance: The MITRE mapping guidance ALLOWED for this CWE, since it is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n*   **CWE-319: Cleartext Transmission of Sensitive Information**\n    *   Technical Explanation: This CWE occurs when a product transmits sensitive data in cleartext over a communication channel that can be sniffed by unauthorized actors.\n    *   Security Implications: Attackers can intercept the sensitive data, potentially gaining access to confidential information, user credentials, or other sensitive resources.\n    *   Relationship Analysis: CWE-319 is a parent of CWE-614 (Sensitive Cookie in HTTPS Session Without 'Secure' Attribute), representing a more general case of cleartext transmission.\n    *   Mapping Guidance: The MITRE mapping guidance ALLOWED for this CWE, since it is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-327:**\n- 327 (Use of a Broken or Risky Cryptographic Algorithm) - ROOT\n\n\n**Chain starting from CWE-319:**\n- 319 (Cleartext Transmission of Sensitive Information) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "614",
        "name": "Sensitive Cookie in HTTPS Session Without 'Secure' Attribute",
        "source": "sparse"
      },
      "similarity": 428.1459966303321
    },
    {
      "metadata": {
        "doc_id": "1004",
        "name": "Sensitive Cookie Without 'HttpOnly' Flag",
        "source": "sparse"
      },
      "similarity": 329.5692636200196
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 288.12220586048693
    },
    {
      "metadata": {
        "doc_id": "312",
        "name": "Cleartext Storage of Sensitive Information",
        "source": "sparse"
      },
      "similarity": 284.74078157658795
    },
    {
      "metadata": {
        "doc_id": "319",
        "name": "Cleartext Transmission of Sensitive Information",
        "source": "sparse"
      },
      "similarity": 279.2497790395426
    },
    {
      "metadata": {
        "doc_id": "327",
        "name": "Use of a Broken or Risky Cryptographic Algorithm",
        "source": "sparse"
      },
      "similarity": 272.7283050450946
    },
    {
      "metadata": {
        "doc_id": "113",
        "name": "Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')",
        "source": "sparse"
      },
      "similarity": 257.65293753737194
    },
    {
      "metadata": {
        "doc_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "source": "sparse"
      },
      "similarity": 253.23989648754244
    },
    {
      "metadata": {
        "doc_id": "1275",
        "name": "Sensitive Cookie with Improper SameSite Attribute",
        "type": "Variant",
        "original_content": "The SameSite attribute for sensitive cookies is not set, or an insecure value is used.",
        "keyphrase_source": "weakness:missing Secure attribute for sensitive cookies",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.576280796621274,
            "graph": 0.9730421915323362
          }
        }
      },
      "similarity": 0.576280796621274
    },
    {
      "doc_id": "226",
      "text": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "226",
        "name": "Sensitive Information in Resource Not Removed Before Reuse",
        "type": "base",
        "original_content": "CWE-226: Sensitive Information in Resource Not Removed Before Reuse",
        "relationships": [
          {
            "source_id": "226",
            "target_id": "244",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1342",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1301",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1272",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "1239",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "201",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "212",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "226",
            "target_id": "459",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "459",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "244",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "212",
            "target_id": "226",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "201",
            "target_id": "226",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1342",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1301",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1272",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1194"
            }
          },
          {
            "source_id": "1239",
            "target_id": "226",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "201"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "201",
                  "226",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "201"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "226",
                  "201",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "201"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-327",
      "CWE-319",
      "CWE-201",
      "CWE-1004",
      "CWE-614",
      "CWE-312"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}