# Raw Retriever Results for CVE-2024-50271

# Raw Retriever Results for CVE-2024-50271
## Query
In the Linux kernel, the following vulnerability has been resolved signal restore the override_rlimit logic Prior to commit d64696905554 (Reimplement RLIMIT_SIGPENDING on top of ucounts) UCOUNT_RLIMIT_SIGPENDING rlimit was not enforced for a class of signals. However now its enforced unconditionally, even if override_rlimit is set. This behavior change caused production issues. For example, if the limit is reached and a process receives a SIGSEGV signal, sigqueue_alloc fails to allocate the necessary resources for the signal delivery, preventing the signal from being delivered with siginfo. This prevents the process from correctly identifying the fault address and handling the error. From the user-space perspective, applications are unaware that the limit has been reached and that the siginfo is effectively corrupted. This can lead to unpredictable behavior and crashes, as we observed with java applications. Fix this by passing override_rlimit into inc_rlimit_get_ucounts() and skip the comparison to max there if override_rlimit is set. This effectively restores the old behavior.

## Keyphrases
- **rootcause**: 'UCOUNT_RLIMIT_SIGPENDING rlimit was not enforced for a class of signals'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4234 | 0.5268 | 0.4523 | 0.4498 | 20 |
| Sparse | 245.7761 | 860.9606 | 755.2326 | 788.3660 | 11 |
| Graph | 1.6848 | 2.6784 | 2.0037 | 2.0397 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 789 | Memory Allocation with Excessive Size Value | variant | 2.6784 | Allowed |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | base | 2.3998 | Allowed |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | Base | 2.2799 | Allowed |
| 4 | 123 | Write-what-where Condition | base | 2.2100 | Allowed |
| 5 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 6 | 772 | Missing Release of Resource after Effective Lifetime | base | 2.2100 | Allowed |
| 7 | 479 | Signal Handler Use of a Non-reentrant Function | Variant | 2.1703 | Allowed |
| 8 | 364 | Signal Handler Race Condition | Base | 2.1591 | Allowed |
| 9 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 10 | 415 | Double Free | variant | 2.0400 | Allowed |
| 11 | 911 | Improper Update of Reference Count | Base | 2.0394 | Allowed |
| 12 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.9094 | Allowed |
| 13 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 14 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 15 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 364 | Signal Handler Race Condition | Base | 0.5268 | 0.5268 | Allowed |
| 2 | 828 | Signal Handler with Functionality that is not Asynchronous-Safe | Variant | 0.5041 | 0.5041 | Allowed |
| 3 | 479 | Signal Handler Use of a Non-reentrant Function | Variant | 0.4865 | 0.4865 | Allowed |
| 4 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4691 | 0.4691 | Allowed |
| 5 | 911 | Improper Update of Reference Count | Base | 0.4671 | 0.4671 | Allowed |
| 6 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.4566 | 0.4566 | Allowed |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4552 | 0.4552 | Allowed |
| 8 | 194 | Unexpected Sign Extension | Variant | 0.4551 | 0.4551 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4550 | 0.4550 | Allowed-with-Review |
| 10 | 909 | Missing Initialization of Resource | Class | 0.4547 | 0.4547 | Allowed-with-Review |
| 11 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4449 | 0.4449 | Allowed |
| 12 | 190 | Integer Overflow or Wraparound | Base | 0.4359 | 0.4359 | Allowed |
| 13 | 413 | Improper Resource Locking | Base | 0.4349 | 0.4349 | Allowed |
| 14 | 432 | Dangerous Signal Handler not Disabled During Sensitive Operations | Base | 0.4345 | 0.4345 | Allowed |
| 15 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4334 | 0.4334 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 364 | Signal Handler Race Condition | 860.9606 | 860.9606 | Allowed |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | 854.5278 | 854.5278 | Allowed |
| 3 | 828 | Signal Handler with Functionality that is not Asynchronous-Safe | 831.5811 | 831.5811 | Allowed |
| 4 | 401 | Missing Release of Memory after Effective Lifetime | 802.1950 | 802.1950 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 797.2304 | 797.2304 | Allowed |
| 6 | 863 | Incorrect Authorization | 788.3660 | 788.3660 | Allowed-with-Review |
| 7 | 125 | Out-of-bounds Read | 785.9647 | 785.9647 | Allowed |
| 8 | 415 | Double Free | 781.5280 | 781.5280 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 779.8129 | 779.8129 | Allowed-with-Review |
| 10 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 779.6160 | 779.6160 | Allowed |
| 11 | 789 | Memory Allocation with Excessive Size Value | 245.7761 | 245.7761 | Allowed |
