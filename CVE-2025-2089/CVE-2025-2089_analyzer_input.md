# Vulnerability Information: CVE-2025-2089

## Vulnerability Description
A vulnerability has been found in StarSea99 starsea-mall 1.0/2.X and classified as critical. Affected by this vulnerability is the function updateUserInfo of the file /personal/updateInfo of the component com.siro.mall.controller.mall.UserController. The manipulation of the argument userId leads to **improper access controls**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **rootcause:** **improper access controls**
- **vector:** manipulation of userId argument
- **product:** StarSea99 starsea-mall
- **version:** 1.0/2.X
- **component:** /personal/updateInfo of com.siro.mall.controller.mall.UserController

## CVE Reference Links Content Summary
CVE-2025-2089: starsea-mall 1.0 任意用户登录漏洞

**Root cause of vulnerability:**

The vulnerability stems from flawed logic in the `updateInfo` method within the `com.siro.mall.controller.mall.UserController` package. Specifically, the code updates user information based on an ID retrieved from the session, but then retrieves data using the ID provided in the request (userId parameter), leading to a mismatch and allowing access to another user's account. The session ID is also overwritten with the attacker-controlled `userId`.

**Weaknesses/vulnerabilities present:**

*   Insecure update logic: The application updates user information based on a session ID but retrieves data based on a potentially attacker-controlled `userId` parameter.
*   Session ID manipulation: The session ID is overwritten with the attacker-controlled `userId`.

**Impact of exploitation:**

Successful exploitation allows an attacker to gain access to and control other users' accounts, effectively achieving arbitrary user login.

**Attack vectors:**

*   Network: An attacker can intercept and modify the `userId` parameter in network requests (e.g., using a proxy like Burp Suite) to target different user accounts.

**Required attacker capabilities/position:**

*   Network access to the application.
*   Ability to intercept and modify network traffic (e.g., using a proxy).
*   Basic understanding of web application request/response structure.

**Mitigation or fix:**

The vulnerability should be fixed by ensuring that the user ID used for both updating and retrieving user information is consistent and securely obtained from the session, preventing manipulation through request parameters.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.477 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.451 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.390 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.388 |
| 5 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.383 |
| 6 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.382 |
| 7 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.380 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.378 |
| 9 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | Allowed | dense | 0.574 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

