## Vulnerability Description
Weak password hashing using MD5 in funzioni.php in HotelDruid before 1.32 allows an attacker to obtain plaintext passwords from hash values.

### Vulnerability Description Key Phrases
- **rootcause:** **weak password hashing**
- **impact:** obtain plaintext passwords
- **attacker:** attacker
- **product:** HotelDruid
- **version:** before 1.32
- **component:** funzioni.php

## CVE Reference Links Content Summary
Based on the provided information, here's a breakdown of the vulnerability described in relation to CVE-2024-23091:

**Root Cause of Vulnerability:**
- The vulnerability stems from the use of the MD5 hashing algorithm for storing user passwords within the `funzioni.php` file of HotelDruid.

**Weaknesses/Vulnerabilities Present:**
- **Use of MD5:** MD5 is a cryptographically weak hash function prone to collision, preimage, and brute-force attacks. This makes it unsuitable for password hashing.
- **Lack of Salt (Prior to v1.32):** Older versions of the software did not use salt when hashing passwords. This makes them vulnerable to dictionary and rainbow table attacks.
- **Weak Salting (Post v1.32):** While versions after 1.32 use a salt, the fundamental weakness of MD5 still leaves passwords vulnerable to attacks. The salt implementation involves a loop that concatenates a portion of the salt with the password and hashes it multiple times, but it still uses MD5 as the base algorithm, which is the core problem.

**Impact of Exploitation:**
- An attacker who gains access to the hashed passwords can perform brute-force attacks to recover the original plaintext passwords.
- Successful exploitation could lead to unauthorized access to user accounts and sensitive information within the application.

**Attack Vectors:**
- An attacker needs access to the database where the hashed passwords are stored.
- With access to the database, the attacker can attempt to crack the MD5 hashes using techniques like brute-force, dictionary attacks, and rainbow table lookups.

**Required Attacker Capabilities/Position:**
- The attacker needs to have gained unauthorized access to the database or system where HotelDruid stores the hashed passwords.

**Additional Notes:**
- The vulnerability was reported by Cnetsec.
- The affected component is `funzioni.php`.
- The affected versions are all versions prior to 1.32. While later versions attempt to use salting, the core vulnerability is the use of MD5 itself.
- The recommended solution is to replace MD5 with a stronger hashing algorithm such as bcrypt, argon2, or scrypt.
- The content provides more specific details than the official CVE description placeholder.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.243 |
| 2 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | sparse | 0.223 |
| 3 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.179 |
| 4 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.175 |
| 5 | 836 | Use of Password Hash Instead of Password for Authentication | Base | Allowed | sparse | 0.152 |
| 6 | 312 | Cleartext Storage of Sensitive Information | Base | Allowed | sparse | 0.149 |
| 7 | 912 | Hidden Functionality | Class | Allowed-with-Review | sparse | 0.147 |
| 8 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.147 |
| 9 | 760 | Use of a One-Way Hash with a Predictable Salt | Variant | Allowed | dense | 0.552 |
| 10 | 208 | Observable Timing Discrepancy | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-328: Use of Weak Hash

CWE-916: Use of Password Hash With Insufficient Computational Effort

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-330: Use of Insufficiently Random Values

CWE-836: Use of Password Hash Instead of Password for Authentication

CWE-312: Cleartext Storage of Sensitive Information

CWE-912: Hidden Functionality

CWE-319: Cleartext Transmission of Sensitive Information

CWE-760: Use of a One-Way Hash with a Predictable Salt

CWE-208: Observable Timing Discrepancy