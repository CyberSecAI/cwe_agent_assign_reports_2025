# Raw Retriever Results for CVE-2024-10131

# Raw Retriever Results for CVE-2024-10131
## Query
The `add_llm` function in `llm_app.py` in infiniflow/ragflow version 0.11.0 contains a remote code execution (RCE) vulnerability. The function uses user-supplied input `req[llm_factory]` and `req[llm_name]` to dynamically instantiate classes from various model dictionaries. This approach allows an attacker to potentially execute arbitrary code due to the lack of comprehensive input validation or sanitization. An attacker could provide a malicious value for llm_factory that, when used as an index to these model dictionaries, results in the execution of arbitrary code.

## Keyphrases
- **rootcause**: 'lack of comprehensive input validation', 'sanitization'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4023 | 0.5807 | 0.4295 | 0.4200 | 20 |
| Sparse | 400.8736 | 700.0000 | 460.7725 | 442.2271 | 11 |
| Graph | 1.4891 | 2.2100 | 1.8152 | 1.7244 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | base | 2.2100 | Allowed |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 2.2100 | Allowed |
| 3 | 41 | Improper Resolution of Path Equivalence | base | 2.2100 | Allowed |
| 4 | 129 | Improper Validation of Array Index | variant | 2.1936 | Allowed |
| 5 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.0228 | Allowed-with-Review |
| 7 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | base | 2.0228 | Allowed |
| 8 | 116 | Improper Encoding or Escaping of Output | class | 1.7824 | Allowed-with-Review |
| 9 | 476 | NULL Pointer Dereference | base | 1.7680 | Allowed |
| 10 | 425 | Direct Request ('Forced Browsing') | base | 1.7680 | Allowed |
| 11 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 1.6807 | Allowed-with-Review |
| 12 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.6630 | Allowed |
| 13 | 73 | External Control of File Name or Path | Base | 1.6429 | Allowed |
| 14 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 1.6358 | Allowed |
| 15 | 456 | Missing Initialization of a Variable | variant | 1.6320 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.5807 | 0.5807 | Allowed |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | 0.4601 | 0.4601 | Allowed-with-Review |
| 3 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | 0.4483 | 0.4483 | Allowed-with-Review |
| 4 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | 0.4407 | 0.4407 | Allowed |
| 5 | 830 | Inclusion of Web Functionality from an Untrusted Source | Variant | 0.4384 | 0.4384 | Allowed |
| 6 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | 0.4334 | 0.4334 | Allowed |
| 7 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | 0.4316 | 0.4316 | Allowed |
| 8 | 676 | Use of Potentially Dangerous Function | Base | 0.4307 | 0.4307 | Allowed |
| 9 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | 0.4272 | 0.4272 | Allowed |
| 10 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | 0.4264 | 0.4264 | Allowed |
| 11 | 294 | Authentication Bypass by Capture-replay | Base | 0.4135 | 0.4135 | Allowed |
| 12 | 73 | External Control of File Name or Path | Base | 0.4095 | 0.4095 | Allowed |
| 13 | 20 | Improper Input Validation | Class | 0.4090 | 0.4090 | Discouraged |
| 14 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4083 | 0.4083 | Allowed |
| 15 | 790 | Improper Filtering of Special Elements | Class | 0.4076 | 0.4076 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 116 | Improper Encoding or Escaping of Output | 700.0000 | 700.0000 | Allowed-with-Review |
| 2 | 20 | Improper Input Validation | 461.7769 | 461.7769 | Discouraged |
| 3 | 138 | Improper Neutralization of Special Elements | 455.1349 | 455.1349 | Discouraged |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | 450.1217 | 450.1217 | Allowed |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | 443.4615 | 443.4615 | Allowed-with-Review |
| 6 | 502 | Deserialization of Untrusted Data | 442.2271 | 442.2271 | Allowed |
| 7 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 434.9018 | 434.9018 | Allowed |
| 8 | 787 | Out-of-bounds Write | 428.8176 | 428.8176 | Allowed |
| 9 | 470 | Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection') | 428.3859 | 428.3859 | Allowed |
| 10 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 422.7963 | 422.7963 | Discouraged |
| 11 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 400.8736 | 400.8736 | Allowed |
