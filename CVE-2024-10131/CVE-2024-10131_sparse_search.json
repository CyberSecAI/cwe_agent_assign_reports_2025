{
  "retriever": "sparse",
  "query": "The `add_llm` function in `llm_app.py` in infiniflow/ragflow version 0.11.0 contains a remote code execution (RCE) vulnerability. The function uses user-supplied input `req[llm_factory]` and `req[llm_name]` to dynamically instantiate classes from various model dictionaries. This approach allows an attacker to potentially execute arbitrary code due to the lack of comprehensive input validation or sanitization. An attacker could provide a malicious value for llm_factory that, when used as an index to these model dictionaries, results in the execution of arbitrary code.",
  "keyphrases": {
    "rootcause": [
      "lack of comprehensive input validation",
      "sanitization"
    ]
  },
  "timestamp": "2025-07-12 23:54:10",
  "cve_id": "CVE-2024-10131",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "116",
      "name": "Improper Encoding or Escaping of Output",
      "score": 700.0,
      "search_source": "alternate_term_match"
    },
    {
      "cwe_id": "20",
      "name": "Improper Input Validation",
      "score": 461.77687368577153,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "138",
      "name": "Improper Neutralization of Special Elements",
      "score": 455.1348727991804,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 450.1216994301784,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "94",
      "name": "Improper Control of Generation of Code ('Code Injection')",
      "score": 443.4615261391697,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "502",
      "name": "Deserialization of Untrusted Data",
      "score": 442.2271018510123,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "78",
      "name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
      "score": 434.90177723982885,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "787",
      "name": "Out-of-bounds Write",
      "score": 428.8176225266508,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "470",
      "name": "Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')",
      "score": 428.3859283653438,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "score": 422.7962981352849,
      "search_source": "rootcause:lack of comprehensive input validation"
    },
    {
      "cwe_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "score": 400.8735533360143,
      "search_source": "rootcause:sanitization"
    }
  ]
}