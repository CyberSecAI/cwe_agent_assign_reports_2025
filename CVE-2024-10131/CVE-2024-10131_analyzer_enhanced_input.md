## Vulnerability Description
The `add_llm` function in `llm_app.py` in infiniflow/ragflow version 0.11.0 contains a remote code execution (RCE) vulnerability. The function uses user-supplied input `req[llm_factory]` and `req[llm_name]` to dynamically instantiate classes from various model dictionaries. This approach allows an attacker to potentially execute arbitrary code due to the **lack of comprehensive input validation or sanitization**. An attacker could provide a malicious value for llm_factory that, when used as an index to these model dictionaries, results in the execution of arbitrary code.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of comprehensive input validation or sanitization**
- **impact:** potentially execute arbitrary code and remote code execution
- **vector:** malicious value for llm_factory
- **attacker:** attacker
- **product:** infiniflow/ragflow
- **version:** 0.11.0
- **component:** add_llm function in llm_app.py

## CVE Reference Links Content Summary
UNRELATED

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | alternate_terms | 0.700 |
| 2 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.462 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.455 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.450 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.443 |
| 6 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.442 |
| 7 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.435 |
| 8 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.429 |
| 9 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | Allowed | dense | 0.581 |
| 10 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-116: Improper Encoding or Escaping of Output

CWE-20: Improper Input Validation

CWE-138: Improper Neutralization of Special Elements

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-502: Deserialization of Untrusted Data

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-787: Out-of-bounds Write

CWE-1427: Improper Neutralization of Input Used for LLM Prompting

CWE-770: Allocation of Resources Without Limits or Throttling