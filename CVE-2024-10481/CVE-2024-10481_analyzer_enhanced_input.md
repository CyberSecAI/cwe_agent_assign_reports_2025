## Vulnerability Description
A **CSRF vulnerability** exists in comfyanonymous/comfyui versions up to v0.2.2. This vulnerability allows attackers to host malicious websites that, when visited by authenticated ComfyUI users, can perform arbitrary API requests on behalf of the user. This can be exploited to perform actions such as uploading arbitrary files via the `/upload/image` endpoint. The **lack of CSRF protections** on API endpoints like `/upload/image`, `/prompt`, and `/history` leaves users vulnerable to unauthorized actions, which could be combined with other vulnerabilities such as stored-XSS to further compromise user sessions.

### Vulnerability Description Key Phrases
- **rootcause:** **lack of CSRF protections**
- **weakness:** **CSRF vulnerability**
- **product:** comfyanonymous/comfyui
- **impact:** arbitrary API requests on behalf of the user, perform actions such as uploading arbitrary files
- **attacker:** attackers
- **version:** up to v0.2.2

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.559 |
| 2 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.546 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.514 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.495 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.495 |
| 6 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.492 |
| 7 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.489 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.486 |
| 9 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | dense | 0.556 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-862: Missing Authorization

CWE-306: Missing Authentication for Critical Function

CWE-23: Relative Path Traversal

CWE-285: Improper Authorization

CWE-863: Incorrect Authorization

CWE-425: Direct Request ('Forced Browsing')

CWE-471: Modification of Assumed-Immutable Data (MAID)