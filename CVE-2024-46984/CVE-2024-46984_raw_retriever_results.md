# Raw Retriever Results for CVE-2024-46984

# Raw Retriever Results for CVE-2024-46984
## Query
The reference validator is a tool to perform advanced validation of FHIR resources for TI applications and interoperability standards. The profile location routine in the referencevalidator commons package is vulnerable to `XML External Entities` attack due to insecure defaults of the used Woodstox WstxInputFactory. A malicious XML resource can lead to network requests issued by referencevalidator and thus to a `Server Side Request Forgery` attack. The vulnerability impacts applications which use referencevalidator to process XML resources from untrusted sources. The problem has been patched with the 2.5.1 version of the referencevalidator. Users are strongly recommended to update to this version or a more recent one. A pre-processing or manual analysis of input XML resources on existence of DTD definitions or external entities can mitigate the problem.

## Keyphrases
- **rootcause**: 'insecure defaults of the used Woodstox WstxInputFactory'
- **weakness**: 'XML External Entities'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4918 | 0.6153 | 0.5241 | 0.5149 | 20 |
| Sparse | 214.2531 | 813.1025 | 651.8443 | 680.4489 | 12 |
| Graph | 0.9360 | 2.8430 | 1.5385 | 1.5210 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | 2.8430 | Allowed |
| 2 | 1333 | Inefficient Regular Expression Complexity | base | 2.3296 | Allowed |
| 3 | 322 | Key Exchange without Entity Authentication | base | 2.2100 | Allowed |
| 4 | 827 | Improper Control of Document Type Definition | Variant | 2.1725 | Allowed |
| 5 | 347 | Improper Verification of Cryptographic Signature | base | 2.1190 | Allowed |
| 6 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 2.0400 | Allowed |
| 7 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | 1.8024 | Allowed |
| 8 | 112 | Missing XML Validation | Base | 1.6478 | Allowed |
| 9 | 611 | Improper Restriction of XML External Entity Reference | Base | 1.5246 | Allowed |
| 10 | 41 | Improper Resolution of Path Equivalence | base | 1.5210 | Allowed |
| 11 | 178 | Improper Handling of Case Sensitivity | base | 1.5210 | Allowed |
| 12 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | class | 1.1920 | Allowed-with-Review |
| 13 | 941 | Incorrectly Specified Destination in a Communication Channel | base | 1.0062 | Allowed |
| 14 | 940 | Improper Verification of Source of a Communication Channel | base | 1.0062 | Allowed |
| 15 | 420 | Unprotected Alternate Channel | base | 1.0062 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 611 | Improper Restriction of XML External Entity Reference | Base | 0.6153 | 0.6153 | Allowed |
| 2 | 112 | Missing XML Validation | Base | 0.5929 | 0.5929 | Allowed |
| 3 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | Base | 0.5911 | 0.5911 | Allowed |
| 4 | 1289 | Improper Validation of Unsafe Equivalence in Input | Base | 0.5533 | 0.5533 | Allowed |
| 5 | 827 | Improper Control of Document Type Definition | Variant | 0.5369 | 0.5369 | Allowed |
| 6 | 610 | Externally Controlled Reference to a Resource in Another Sphere | Class | 0.5299 | 0.5299 | Discouraged |
| 7 | 643 | Improper Neutralization of Data within XPath Expressions ('XPath Injection') | Base | 0.5250 | 0.5250 | Allowed |
| 8 | 106 | Struts: Plug-in Framework not in Use | Variant | 0.5234 | 0.5234 | Allowed |
| 9 | 652 | Improper Neutralization of Data within XQuery Expressions ('XQuery Injection') | Base | 0.5178 | 0.5178 | Allowed |
| 10 | 185 | Incorrect Regular Expression | Class | 0.5166 | 0.5166 | Allowed-with-Review |
| 11 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.5132 | 0.5132 | Allowed |
| 12 | 110 | Struts: Validator Without Form Field | Variant | 0.5024 | 0.5024 | Allowed |
| 13 | 1288 | Improper Validation of Consistency within Input | Base | 0.5008 | 0.5008 | Allowed |
| 14 | 297 | Improper Validation of Certificate with Host Mismatch | Variant | 0.4985 | 0.4985 | Allowed |
| 15 | 706 | Use of Incorrectly-Resolved Name or Reference | Class | 0.4979 | 0.4979 | Allowed-with-Review |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 611 | Improper Restriction of XML External Entity Reference | 813.1025 | 813.1025 | Allowed |
| 2 | 1333 | Inefficient Regular Expression Complexity | 729.0981 | 729.0981 | Allowed |
| 3 | 347 | Improper Verification of Cryptographic Signature | 693.7429 | 693.7429 | Allowed |
| 4 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 690.2954 | 690.2954 | Allowed-with-Review |
| 5 | 776 | Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion') | 686.4737 | 686.4737 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | 681.9600 | 681.9600 | Allowed |
| 7 | 918 | Server-Side Request Forgery (SSRF) | 678.9379 | 678.9379 | Allowed |
| 8 | 502 | Deserialization of Untrusted Data | 677.6997 | 677.6997 | Allowed |
| 9 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | 672.3873 | 672.3873 | Allowed |
| 10 | 639 | Authorization Bypass Through User-Controlled Key | 668.5122 | 668.5122 | Allowed |
| 11 | 138 | Improper Neutralization of Special Elements | 615.6684 | 615.6684 | Discouraged |
| 12 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 214.2531 | 214.2531 | Allowed |
