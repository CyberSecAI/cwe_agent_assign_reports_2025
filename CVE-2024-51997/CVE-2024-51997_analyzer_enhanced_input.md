## Vulnerability Description
Trustee is a set of tools and components for attesting confidential guests and providing secrets to them. The ART (**Attestation Results Token**) token, generated by AS, could be manipulated by MITM attacker, but the verifier (CoCo Verification Demander like KBS) could still verify it successfully. In the payload of ART token, the jwk could be replaced by attacker with his own pub key. Then attacker can use his own corresponding private key to sign the crafted ART token. Based on current code implementation (v0.8.0), such replacement and modification can not be detected. This issue has been addressed in version 0.8.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **ART token manipulation**
- **impact:** execute arbitrary code
- **vector:** MITM attack
- **attacker:** attacker
- **product:** Trustee
- **version:** v0.8.0
- **component:** ART token

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The Attestation Results Token (ART), generated by the AS, can be manipulated by a Man-in-the-Middle (MITM) attacker. Specifically, the 'jwk' field within the token's payload can be replaced with the attacker's public key. The attacker can then sign the modified ART token using their corresponding private key. The verifier, like KBS, fails to detect this replacement due to the current code implementation.
- **Weaknesses/vulnerabilities present:**
    - Lack of proper verification of the 'jwk' field in the ART token.
    - Vulnerability to MITM attacks.
    - Inability to detect modifications to the ART token's payload, specifically the 'jwk'.
- **Impact of exploitation:**
    -  Compromised integrity of the ART token, allowing arbitrary modifications to its payload without detection.
    - Potential compromise of confidentiality if the "tee-pubkey" field is used to encrypt other secrets or wrap other keys, potentially compromising secure channels between TEE/enclave and relying parties.
    - Further consequences depending on how the payload fields are used after successful authentication of the ART token.
- **Attack vectors:** Man-in-the-Middle (MITM) attack.
- **Required attacker capabilities/position:**
    - The attacker needs to be positioned as a MITM, capable of intercepting the ART token.
    - The attacker needs to be able to replace the 'jwk' field within the token with their own public key.
    - The attacker needs to possess the corresponding private key to sign the modified ART token.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.574 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.571 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.559 |
| 4 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.551 |
| 5 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 0.549 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.543 |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.541 |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.538 |
| 9 | 1270 | Generation of Incorrect Security Tokens | Base | Allowed | dense | 0.473 |
| 10 | 259 | Use of Hard-coded Password | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1390: Weak Authentication

CWE-863: Incorrect Authorization

CWE-287: Improper Authentication

CWE-321: Use of Hard-coded Cryptographic Key

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-347: Improper Verification of Cryptographic Signature

CWE-1270: Generation of Incorrect Security Tokens

CWE-259: Use of Hard-coded Password