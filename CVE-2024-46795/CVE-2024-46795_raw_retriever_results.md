# Raw Retriever Results for CVE-2024-46795

# Raw Retriever Results for CVE-2024-46795
## Query
In the Linux kernel, the following vulnerability has been resolved ksmbd unset the binding mark of a reused connection Steve French reported null pointer dereference error from sha256 lib. cifs.ko can send session setup requests on reused connection. If reused connection is used for binding session, conn->binding can still remain true and generate_preauth_hash() will not set sess->Preauth_HashValue and it will be NULL. It is used as a material to create an encryption key in ksmbd_gen_smb311_encryptionkey. ->Preauth_HashValue cause null pointer dereference error from crypto_shash_update(). BUG kernel NULL pointer dereference, address 0000000000000000 #PF supervisor read access in kernel mode #PF error_code(0x0000) - not-present page PGD 0 P4D 0 Oops 0000 [#1] PREEMPT SMP PTI CPU 8 PID 429254 Comm kworker/839 Hardware name LENOVO 20MAS08500/20MAS08500, BIOS N2CET69W (1.52 ) Workqueue ksmbd-io handle_ksmbd_work [ksmbd] RIP 0010lib_sha256_base_do_update.isra.0+0x11e/0x1d0 [sha256_ssse3] ? show_regs+0x6d/0x80 ? __die+0x24/0x80 ? page_fault_oops+0x99/0x1b0 ? do_user_addr_fault+0x2ee/0x6b0 ? exc_page_fault+0x83/0x1b0 ? asm_exc_page_fault+0x27/0x30 ? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3] ? lib_sha256_base_do_update.isra.0+0x11e/0x1d0 [sha256_ssse3] ? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3] ? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3] _sha256_update+0x77/0xa0 [sha256_ssse3] sha256_avx2_update+0x15/0x30 [sha256_ssse3] crypt

## Keyphrases
- **rootcause**: 'null pointer dereference'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5626 | 0.6086 | 0.5775 | 0.5715 | 20 |
| Sparse | 159.7195 | 649.0629 | 505.4929 | 524.7035 | 11 |
| Graph | 1.3572 | 2.8562 | 2.0009 | 1.7281 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | Base | 2.8562 | Allowed |
| 2 | 252 | Unchecked Return Value | Base | 2.8421 | Allowed |
| 3 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.7342 | Allowed |
| 4 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.6784 | Allowed |
| 5 | 822 | Untrusted Pointer Dereference | Base | 2.5380 | Allowed |
| 6 | 824 | Access of Uninitialized Pointer | Base | 2.5243 | Allowed |
| 7 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 8 | 787 | Out-of-bounds Write | base | 2.2100 | Allowed |
| 9 | 908 | Use of Uninitialized Resource | Base | 1.9619 | Allowed |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | 1.7619 | Allowed |
| 11 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6943 | Allowed |
| 12 | 825 | Expired Pointer Dereference | base | 1.6848 | Allowed |
| 13 | 416 | Use After Free | variant | 1.6320 | Allowed |
| 14 | 782 | Exposed IOCTL with Insufficient Access Control | variant | 1.6320 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.6016 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 476 | NULL Pointer Dereference | Base | 0.6086 | 0.6086 | Allowed |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.6070 | 0.6070 | Allowed |
| 3 | 822 | Untrusted Pointer Dereference | Base | 0.6040 | 0.6040 | Allowed |
| 4 | 909 | Missing Initialization of Resource | Class | 0.5916 | 0.5916 | Allowed-with-Review |
| 5 | 667 | Improper Locking | Class | 0.5875 | 0.5875 | Allowed-with-Review |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5813 | 0.5813 | Allowed-with-Review |
| 7 | 126 | Buffer Over-read | Variant | 0.5804 | 0.5804 | Allowed |
| 8 | 131 | Incorrect Calculation of Buffer Size | Base | 0.5777 | 0.5777 | Allowed |
| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5755 | 0.5755 | Discouraged |
| 10 | 190 | Integer Overflow or Wraparound | Base | 0.5718 | 0.5718 | Allowed |
| 11 | 665 | Improper Initialization | Class | 0.5712 | 0.5712 | Discouraged |
| 12 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5707 | 0.5707 | Allowed |
| 13 | 252 | Unchecked Return Value | Base | 0.5686 | 0.5686 | Allowed |
| 14 | 911 | Improper Update of Reference Count | Base | 0.5686 | 0.5686 | Allowed |
| 15 | 908 | Use of Uninitialized Resource | Base | 0.5678 | 0.5678 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 476 | NULL Pointer Dereference | 649.0629 | 649.0629 | Allowed |
| 2 | 824 | Access of Uninitialized Pointer | 570.2465 | 570.2465 | Allowed |
| 3 | 822 | Untrusted Pointer Dereference | 561.0315 | 561.0315 | Allowed |
| 4 | 252 | Unchecked Return Value | 547.3567 | 547.3567 | Allowed |
| 5 | 665 | Improper Initialization | 533.0273 | 533.0273 | Discouraged |
| 6 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 524.7035 | 524.7035 | Allowed-with-Review |
| 7 | 908 | Use of Uninitialized Resource | 519.2167 | 519.2167 | Allowed |
| 8 | 787 | Out-of-bounds Write | 512.4169 | 512.4169 | Allowed |
| 9 | 909 | Missing Initialization of Resource | 495.6240 | 495.6240 | Allowed-with-Review |
| 10 | 823 | Use of Out-of-range Pointer Offset | 488.0168 | 488.0168 | Allowed |
| 11 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 159.7195 | 159.7195 | Allowed |
