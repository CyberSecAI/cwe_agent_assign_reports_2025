# Vulnerability Information: CVE-2025-23204

## Vulnerability Description
API Platform Core is a system to create hypermedia-driven REST and GraphQL APIs. Starting in version 3.3.8, a security check that gets called after GraphQl resolvers is always replaced by another one as theres no break in a clause. As this falls back to `security`, the impact is there only when theres only a security after resolver and none inside security. Version 3.3.15 contains a patch for the issue.

### Vulnerability Description Key Phrases
- **rootcause:** **security check gets called after GraphQl resolvers is always replaced**
- **product:** API Platform Core
- **version:** 3.3.8

## CVE Reference Links Content Summary
CVE-2025-23204

**Root cause of vulnerability:**

A security check that gets called after GraphQL resolvers is always replaced by another one because there's no `break` statement in the relevant code block.

**Weaknesses/vulnerabilities present:**

Logic error in the `AccessCheckerProvider.php` file, specifically within the `provide` method. The lack of a `break` statement causes the security check to fall back to a default security check even when it shouldn't.

**Impact of exploitation:**

The impact is limited to scenarios where only a security after resolver is defined and no security check is present within the security logic itself.

**Attack vectors:**

Exploitation involves crafting a GraphQL request that triggers the security after resolver.

**Required attacker capabilities/position:**

An attacker needs to be able to send GraphQL requests to the application.

**Mitigation or fix:**

The fix involves adding a `break` statement after the `securityAfterResolver` check in the `AccessCheckerProvider.php` file. This ensures that the correct security check is executed.  The pull request #6444 implements this fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.438 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.436 |
| 3 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.410 |
| 4 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.404 |
| 5 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.401 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.395 |
| 7 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.384 |
| 8 | 1251 | Mirrored Regions with Different Values | Base | Allowed | sparse | 0.384 |
| 9 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | dense | 0.443 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

