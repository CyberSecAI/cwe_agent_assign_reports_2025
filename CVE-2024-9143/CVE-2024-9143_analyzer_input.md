# Vulnerability Information: CVE-2024-9143

## Vulnerability Description
Issue summary Use of the low-level GF(2^m) elliptic curve APIs with untrusted explicit values for the field polynomial can lead to **out-of-bounds memory reads or writes**. Impact summary Out of bound memory writes can lead to an application crash or even a possibility of a remote code execution, however, in all the protocols involving Elliptic Curve Cryptography that were aware of, either only named curves are supported, or, if explicit curve parameters are supported, they specify an X9.62 encoding of binary (GF(2^m)) curves that cant represent problematic input values. Thus the likelihood of existence of a vulnerable application is low. In particular, the X9.62 encoding is used for ECC keys in X.509 certificates, so problematic inputs cannot occur in the context of processing X.509 certificates. Any problematic use-cases would have to be using an exotic curve encoding. The affected APIs include EC_GROUP_new_curve_GF2m(), EC_GROUP_new_from_params(), and various supporting BN_GF2m_*() functions. Applications working with exotic explicit binary (GF(2^m)) curve parameters, that make it possible to represent invalid field polynomials with a zero constant term, via the above or similar APIs, may terminate abruptly as a result of reading or writing outside of array bounds. Remote code execution cannot easily be ruled out. The FIPS modules in 3.3, 3.2, 3.1 and 3.0 are not affected by this issue.

### Vulnerability Description Key Phrases
- **rootcause:** **use of low-level GF(2^m) elliptic curve APIs with untrusted explicit values**
- **weakness:** **out-of-bounds memory reads or writes**
- **impact:** application crash, remote code execution
- **product:** FIPS modules
- **version:** 3.3, 3.2, 3.1 and 3.0
- **component:** EC_GROUP_new_curve_GF2m(), EC_GROUP_new_from_params(), BN_GF2m_*() functions

## CVE Reference Links Content Summary
```
{
  "vulnerability": {
    "root_cause": "The `BN_GF2m_poly2arr()` function in OpenSSL does not properly validate the input polynomial, allowing an attacker to provide an invalid polynomial with a zero constant term. This leads to an out-of-bounds memory access in the `BN_GF2m_mod_arr()` function, which relies on the polynomial having a non-zero constant term.",
    "weaknesses": [
      "Improper input validation",
      "Out-of-bounds memory access"
    ],
    "impact": "Successful exploitation can lead to a denial of service (application crash) and potentially remote code execution. However, the likelihood of exploitation is low because the vulnerability is only present when using explicit curve parameters that do not conform to the X9.62 standard.",
    "attack_vectors": "An attacker would need to supply specially crafted, invalid GF(2^m) parameters to the vulnerable OpenSSL APIs `EC_GROUP_new_curve_GF2m()`, `EC_GROUP_new_from_params()`, or other functions that use `BN_GF2m_*()`, specifically crafting a polynomial with a zero constant term.",
    "required_capabilities": "The attacker needs to be able to supply explicit elliptic curve parameters. This is generally not possible when using named curves which are usually used with X.509 certificates and TLS.",
	"additional_details": "The vulnerability exists in OpenSSL versions 3.3, 3.2, 3.1, 3.0, 1.1.1 and 1.0.2. Patches for this issue are included in the upcoming releases of each affected branch. The vulnerability was reported by Google OSS-Fuzz-Gen on 16th September 2024. The fix implemented in the vulnerable function now returns a failure when the constant term is zero, the leading exponent exceeds `OPENSSL_ECC_MAX_FIELD_BITS` or if there is not enough space to pad the array with the `-1` sentinel value. Tests were also added to check for correct handling of invalid GF2m field parameters."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 1.188 |
| 2 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 1.072 |
| 3 | 203 | Observable Discrepancy | Base | Allowed | sparse | 1.064 |
| 4 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 1.049 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 1.047 |
| 6 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 1.039 |
| 7 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 1.030 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 1.028 |
| 9 | 823 | Use of Out-of-range Pointer Offset | Base | Allowed | dense | 0.566 |
| 10 | 170 | Improper Null Termination | Base | Allowed | graph | 0.002 |

