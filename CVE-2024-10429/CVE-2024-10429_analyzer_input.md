# Vulnerability Information: CVE-2024-10429

## Vulnerability Description
A vulnerability classified as critical has been found in WAVLINK WN530H4, WN530HG4 and WN572HG3 up to 20221028. Affected is the function set_ipv6 of the file internet.cgi. The manipulation of the argument IPv6OpMode/IPv6IPAddr/IPv6WANIPAddr/IPv6GWAddr leads to **command injection**. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** WAVLINK WN530H4 and WN530HG4 and WN572HG3
- **version:** up to 20221028
- **component:** set_ipv6 in internet.cgi

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-10429:

**Root Cause of Vulnerability:**
The vulnerability stems from a command injection flaw in the `set_ipv6` function within the `internet.cgi` component of Wavlink WN530H4, WN530HG4, and WN572HG3 network devices. The function improperly handles user-supplied input.

**Weaknesses/Vulnerabilities Present:**
- **Command Injection (CWE-77):** The `set_ipv6` function does not properly sanitize or neutralize special elements in the `IPv6OpMode`, `IPv6IPAddr`, `IPv6WANIPAddr`, and `IPv6GWAddr` parameters, which allows an attacker to inject and execute arbitrary system commands.

**Impact of Exploitation:**
Successful exploitation of this vulnerability allows an attacker to execute arbitrary code on the affected device, potentially leading to:
- Complete compromise of the device.
- Data breaches, where confidential data can be accessed, modified, or deleted.
- Device unavailability due to denial-of-service attacks.

**Attack Vectors:**
- **Remote Exploitation:** The vulnerability can be exploited remotely.
- **HTTP Requests:** Attackers can send crafted HTTP requests to the `internet.cgi` file, manipulating the vulnerable parameters within the `set_ipv6` function.

**Required Attacker Capabilities/Position:**
- **Authentication:** The attacker needs to be authenticated on the affected device to exploit this vulnerability. This implies that the vulnerability cannot be exploited by unauthenticated users.
- **Network Access:** The attacker must have network access to the device to send malicious requests.

**Additional Details:**
- The affected devices are WAVLINK WN530H4, WN530HG4, and WN572HG3 with firmware versions up to 20221028.
- The vendor has been contacted regarding this vulnerability but has not responded.
- A proof-of-concept exploit is publicly available.
- The vulnerability is tracked as CVE-2024-10429 and has a CVSS base score of 7.2.
- This vulnerability is classified under MITRE ATT&CK as T1202.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.485 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.455 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.429 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.396 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.394 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.382 |
| 9 | 134 | Use of Externally-Controlled Format String | Base | Allowed | dense | 0.616 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

