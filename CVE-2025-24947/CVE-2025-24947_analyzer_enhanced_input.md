## Vulnerability Description
A **hash collision** vulnerability (in the hash table used to manage connections) in LSQUIC (aka LiteSpeed QUIC) before 4.2.0 allows remote attackers to cause a considerable CPU load on the server (a Hash DoS attack) by initiating connections with colliding Source Connection IDs (SCIDs). This is caused by XXH32 usage.

### Vulnerability Description Key Phrases
- **rootcause:** **hash collision**
- **impact:** cause a considerable CPU load on the server and DoS attack and Hash DoS
- **vector:** initiating connections with colliding Source Connection IDs (SCIDs)
- **attacker:** remote attackers
- **product:** LSQUIC (aka LiteSpeed QUIC)
- **version:** before 4.2.0

## CVE Reference Links Content Summary
**1. Does the content relate to the CVE?**

Yes, the content directly relates to CVE-2025-24947, which concerns a Hash Denial-of-Service (DoS) attack in QUIC implementations, specifically in the lsquic library.

**2. If yes, extract the relevant information:**

*   **Root cause of vulnerability:** The vulnerability stems from the use of weak hash functions within QUIC implementations when handling Source Connection IDs (SCIDs). Specifically, the lsquic library used a hash function (lsquic\_hash) that was susceptible to collision attacks. Attackers could craft malicious SCIDs to trigger collisions, leading to a denial-of-service condition.
*   **Weaknesses/vulnerabilities present:** The weakness is the use of a hash table indexed by the peer's SCID to manage connections and the use of a hash function that allows for easy collision creation.
*   **Impact of exploitation:** Exploitation results in a Hash Denial-of-Service (DoS) attack, causing significant slowdowns in vulnerable servers. The attacker can force the server to spend its resources inserting and looking up colliding connection IDs. Some experimental results showed a 300x slowdown.
*   **Attack vectors:** An attacker can create malicious SCIDs that collide within the hash function used by the vulnerable server. The server uses the SCID to index the connection, and these collisions cause the server to spend a lot of time looking up connections.
*   **Required attacker capabilities/position:** The attacker needs to be able to initiate QUIC connections and specify the SCID. They need to craft the SCIDs to cause collisions within the hash table used by the vulnerable server.
*   **Mitigation or fix:** The fix involved switching the hash function to rapidhash with a stronger random seed.

**3. More detail than CVE description:**

Yes, the content provides significantly more detail than a typical CVE description. It includes:
*   A detailed technical explanation of hash table vulnerabilities.
*   An explanation of the QUIC protocol and how the vulnerability arises within it.
*   Examples of the impact of the vulnerability and experimental results.
*   A timeline of the disclosure and fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.351 |
| 2 | 328 | Use of Weak Hash | Base | Allowed | sparse | 0.327 |
| 3 | 916 | Use of Password Hash With Insufficient Computational Effort | Base | Allowed | sparse | 0.281 |
| 4 | 682 | Incorrect Calculation | Pillar | Discouraged | sparse | 0.264 |
| 5 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.263 |
| 6 | 301 | Reflection Attack in an Authentication Protocol | Base | Allowed | sparse | 0.263 |
| 7 | 294 | Authentication Bypass by Capture-replay | Base | Allowed | sparse | 0.263 |
| 8 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.260 |
| 9 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | Allowed | dense | 0.519 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-407: Inefficient Algorithmic Complexity

CWE-328: Use of Weak Hash

CWE-916: Use of Password Hash With Insufficient Computational Effort

CWE-682: Incorrect Calculation

CWE-674: Uncontrolled Recursion

CWE-301: Reflection Attack in an Authentication Protocol

CWE-294: Authentication Bypass by Capture-replay

CWE-330: Use of Insufficiently Random Values

CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')