{
  "query": "In the Linux kernel, the following vulnerability has been resolved bpf Fail verification for sign-extension of packet data/data_end/data_meta syzbot reported a kernel crash due to commit 1f1e864b6555 (bpf Handle sign-extenstin ctx member accesses). The reason is due to sign-extension of 32-bit load for packet data/data_end/data_meta uapi field. The original code looks like r2 = *(s32 *)(r1 + 76) /* load __sk_buff->data */ r3 = *(u32 *)(r1 + 80) /* load __sk_buff->data_end */ r0 = r2 r0 += 8 if r3 > r0 goto +1 ... Note that __sk_buff->data load has 32-bit sign extension. After verification and convert_ctx_accesses(), the final asm code looks like r2 = *(u64 *)(r1 +208) r2 = (s32)r2 r3 = *(u64 *)(r1 +80) r0 = r2 r0 += 8 if r3 > r0 goto pc+1 ... Note that r2 = (s32)r2 may make the kernel __sk_buff->data address invalid which may cause runtime failure. Currently, in C code, typically we have void *data = (void *)(long)skb->data void *data_end = (void *)(long)skb->data_end ... and it will generate r2 = *(u64 *)(r1 +208) r3 = *(u64 *)(r1 +80) r0 = r2 r0 += 8 if r3 > r0 goto pc+1 If we allow sign-extension, void *data = (void *)(long)(int)skb->data void *data_end = (void *)(long)skb->data_end ... the generated code looks like r2 = *(u64 *)(r1 +208) r2 >= 32 r3 = *(u64 *)(r1 +80) r0 = r2 r0 += 8 if r3 > r0 goto pc+1 and this will cause verification failure since r2 data */ this patch added additional checking in is_valid_access() callback function for packet data/data_end/data_meta access. If those accesses are with sign-extenstion, the verification will fail. [1] https//lore.kernel.org/bpf/000000000000c90eee061d236d37@google.com/",
  "keyphrases": {
    "rootcause": [
      "sign-extension of 32-bit load for packet data",
      "data_end",
      "data_meta uapi field"
    ]
  },
  "timestamp": "2025-07-12T04:59:40.264350",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "base",
        "score": 3.8870000000000005,
        "description": "CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "364",
        "name": "Signal Handler Race Condition",
        "abstraction": "base",
        "score": 2.4232000000000005,
        "description": "CWE-364: Signal Handler Race Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "170",
        "name": "Improper Null Termination",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-170: Improper Null Termination...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "123",
        "name": "Write-what-where Condition",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-123: Write-what-where Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "129",
        "name": "Improper Validation of Array Index",
        "abstraction": "variant",
        "score": 2.1936,
        "description": "CWE-129: Improper Validation of Array Index...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "259",
        "name": "Use of Hard-coded Password",
        "abstraction": "variant",
        "score": 2.172,
        "description": "CWE-259: Use of Hard-coded Password...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "836",
        "name": "Use of Password Hash Instead of Password for Authentication",
        "abstraction": "base",
        "score": 2.1189999999999998,
        "description": "CWE-836: Use of Password Hash Instead of Password for Authentication...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "681",
        "name": "Incorrect Conversion between Numeric Types",
        "abstraction": "base",
        "score": 2.1112,
        "description": "CWE-681: Incorrect Conversion between Numeric Types...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "456",
        "name": "Missing Initialization of a Variable",
        "abstraction": "variant",
        "score": 2.04,
        "description": "CWE-456: Missing Initialization of a Variable...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "231",
        "name": "Improper Handling of Extra Values",
        "abstraction": "variant",
        "score": 2.04,
        "description": "CWE-231: Improper Handling of Extra Values...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 1.8700677793508498,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "472",
        "name": "External Control of Assumed-Immutable Web Parameter",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-472: External Control of Assumed-Immutable Web Parameter...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1265",
        "name": "Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-1265: Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1325",
        "name": "Improperly Controlled Sequential Memory Allocation",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-1325: Improperly Controlled Sequential Memory Allocation...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "134",
        "name": "Use of Externally-Controlled Format String",
        "abstraction": "base",
        "score": 1.6848000000000003,
        "description": "CWE-134: Use of Externally-Controlled Format String...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "386",
        "name": "Symbolic Name not Mapping to Correct Object",
        "abstraction": "base",
        "score": 1.6744000000000003,
        "description": "CWE-386: Symbolic Name not Mapping to Correct Object...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1285",
        "name": "Improper Validation of Specified Index, Position, or Offset in Input",
        "abstraction": "Base",
        "score": 1.6469633848472616,
        "description": "The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the spe...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "191",
        "name": "Integer Underflow (Wrap or Wraparound)",
        "abstraction": "Base",
        "score": 1.6369844403819929,
        "description": "The product subtracts one value from another, such that the result is less than the minimum allowable integer value, which produces a value that is not equal to the correct result....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "457",
        "name": "Use of Uninitialized Variable",
        "abstraction": "variant",
        "score": 1.6320000000000003,
        "description": "CWE-457: Use of Uninitialized Variable...",
        "mapping_usage": "Allowed"
      }
    ],
    "dense": [
      {
        "cwe_id": "1285",
        "name": "Improper Validation of Specified Index, Position, or Offset in Input",
        "abstraction": "Base",
        "score": 0.5925572146108131,
        "description": "The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the spe...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "194",
        "name": "Unexpected Sign Extension",
        "abstraction": "Variant",
        "score": 0.5923558505957927,
        "description": "The product performs an operation on a number that causes it to be sign extended when it is transformed into a larger data type. When the original number is negative, this can produce unexpected value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 0.5698691906629281,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "191",
        "name": "Integer Underflow (Wrap or Wraparound)",
        "abstraction": "Base",
        "score": 0.5623706081226661,
        "description": "The product subtracts one value from another, such that the result is less than the minimum allowable integer value, which produces a value that is not equal to the correct result....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
        "abstraction": "Class",
        "score": 0.5558292806738281,
        "description": "The product contains a concurrent code sequence that requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code ...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "126",
        "name": "Buffer Over-read",
        "abstraction": "Variant",
        "score": 0.5553722396856529,
        "description": "The product reads from a buffer using buffer access mechanisms such as indexes or pointers that reference memory locations after the targeted buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "909",
        "name": "Missing Initialization of Resource",
        "abstraction": "Class",
        "score": 0.5546453922881898,
        "description": "The product does not initialize a critical resource....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "190",
        "name": "Integer Overflow or Wraparound",
        "abstraction": "Base",
        "score": 0.5498884698741455,
        "description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "122",
        "name": "Heap-based Buffer Overflow",
        "abstraction": "Variant",
        "score": 0.5472767135125141,
        "description": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine suc...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "409",
        "name": "Improper Handling of Highly Compressed Data (Data Amplification)",
        "abstraction": "Base",
        "score": 0.541381792786899,
        "description": "The product does not handle or incorrectly handles a compressed input with a very high compression ratio that produces a large output....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "119",
        "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
        "abstraction": "Class",
        "score": 0.5397445559777196,
        "description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected m...",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "Base",
        "score": 0.53372693550098,
        "description": "The product reads data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "252",
        "name": "Unchecked Return Value",
        "abstraction": "Base",
        "score": 0.5333583793836194,
        "description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "131",
        "name": "Incorrect Calculation of Buffer Size",
        "abstraction": "Base",
        "score": 0.532967118173406,
        "description": "The product does not correctly calculate the size to be used when allocating a buffer, which could lead to a buffer overflow....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "121",
        "name": "Stack-based Buffer Overflow",
        "abstraction": "Variant",
        "score": 0.5328321651350927,
        "description": "A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function)....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "416",
        "name": "Use After Free",
        "abstraction": "Variant",
        "score": 0.5327306073076417,
        "description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a locati...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "805",
        "name": "Buffer Access with Incorrect Length Value",
        "abstraction": "Base",
        "score": 0.5311711695844755,
        "description": "The product uses a sequential operation to read or write a buffer, but it uses an incorrect length value that causes it to access memory that is outside of the bounds of the buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1264",
        "name": "Hardware Logic with Insecure De-Synchronization between Control and Data Channels",
        "abstraction": "Base",
        "score": 0.5264654249910605,
        "description": "The hardware logic for error handling and security checks can incorrectly forward data before the security check is complete....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "823",
        "name": "Use of Out-of-range Pointer Offset",
        "abstraction": "Base",
        "score": 0.5264321225206718,
        "description": "The product performs pointer arithmetic on a valid pointer, but it uses an offset that can point outside of the intended range of valid memory locations for the resulting pointer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "130",
        "name": "Improper Handling of Length Parameter Inconsistency",
        "abstraction": "Base",
        "score": 0.5258951329966048,
        "description": "The product parses a formatted message or structure, but it does not handle or incorrectly handles a length field that is inconsistent with the actual length of the associated data....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "Base",
        "score": 1279.7176968396686,
        "description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "26",
        "name": "Path Traversal: '/dir/../filename'",
        "abstraction": "Variant",
        "score": 1050.6524932919506,
        "description": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize \"/dir/../filename\" sequences that can resolve to a location th...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "321",
        "name": "Use of Hard-coded Cryptographic Key",
        "abstraction": "Variant",
        "score": 1030.1812235186546,
        "description": "The use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "194",
        "name": "Unexpected Sign Extension",
        "abstraction": "Variant",
        "score": 851.6714872146505,
        "description": "The product performs an operation on a number that causes it to be sign extended when it is transformed into a larger data type. When the original number is negative, this can produce unexpected value...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "836",
        "name": "Use of Password Hash Instead of Password for Authentication",
        "abstraction": "Base",
        "score": 832.4385515387175,
        "description": "The product records password hashes in a data store, receives a hash of a password from a client, and compares the supplied hash to the hash obtained from the data store....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "328",
        "name": "Use of Weak Hash",
        "abstraction": "Base",
        "score": 831.7017535851007,
        "description": "The product uses an algorithm that produces a digest (output value) that does not meet security expectations for a hash function that allows an adversary to reasonably determine the original input (pr...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1390",
        "name": "Weak Authentication",
        "abstraction": "Class",
        "score": 816.4178281920113,
        "description": "The product uses an authentication mechanism to restrict access to specific users or identities, but the mechanism does not sufficiently prove that the claimed identity is correct....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "Base",
        "score": 812.5382553797838,
        "description": "The product reads data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "347",
        "name": "Improper Verification of Cryptographic Signature",
        "abstraction": "Base",
        "score": 806.4418225797933,
        "description": "The product does not verify, or incorrectly verifies, the cryptographic signature for data....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 771.5061489993545,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.5258951329966048,
      "max": 0.5925572146108131,
      "mean": 0.546843518219235,
      "median": 0.5405631743823094,
      "count": 20
    },
    "sparse": {
      "min": 771.5061489993545,
      "max": 1279.7176968396686,
      "mean": 908.3267261139687,
      "median": 832.0701525619091,
      "count": 10
    },
    "graph": {
      "min": 1.6320000000000003,
      "max": 3.8870000000000005,
      "mean": 2.027000780229005,
      "median": 1.955033889675425,
      "count": 20
    }
  }
}