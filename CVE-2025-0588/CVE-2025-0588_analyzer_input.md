# Vulnerability Information: CVE-2025-0588

## Vulnerability Description
In affected versions of Octopus Server it was possible for a user with sufficient access to set custom headers in all server responses. By submitting a specifically crafted referrer header the user could ensure that all subsequent server responses would return 500 errors rendering the site mostly unusable. The user would be able to subsequently set and unset the referrer header to control the denial of service state with a valid CSRF token whilst new CSRF tokens could not be generated.

### Vulnerability Description Key Phrases
- **vector:** submitting a specifically crafted referrer header
- **product:** Octopus Server
- **impact:** denial of service, server responses would return 500 errors rendering the site mostly unusable
- **attacker:** user with sufficient access
- **version:** affected versions

## CVE Reference Links Content Summary
## CVE-2025-0588 Analysis

This content **relates** to CVE-2025-0588.

**Root cause of vulnerability:**

A user with sufficient access could set custom headers in all server responses. By submitting a specifically crafted referrer header, the user could cause all subsequent server responses to return 500 errors.

**Weaknesses/vulnerabilities present:**

*   Improper input validation (specifically of the Referrer header)
*   Denial of Service (DoS)
*   Potential for CSRF exploitation (controlling the DoS state with a CSRF token, but new tokens cannot be generated during the DoS)

**Impact of exploitation:**

Rendering the Octopus Server mostly unusable by causing 500 errors on all requests.

**Attack vectors:**

*   A user with sufficient access submitting a crafted `Referrer` header.

**Required attacker capabilities/position:**

*   User with sufficient access to set custom headers.

**Mitigation or fix:**

*   Upgrade Octopus Server to version 2024.4.7091 or higher.
*   Alternatively, upgrade to 2024.3.13097 or greater if unable to upgrade to 2024.4.7132. Specific upgrade paths are provided for older versions (2020.x, 2021.x, 2022.x, 2023.x, 2024.1.x, 2024.2.x, 2024.3.x, 2024.4.x).

**Additional Details (more than official CVE description):**

*   Discovery Date: 18 NOV 2024
*   Patch Release Date: 22 JAN 2025
*   Advisory Release Date: 10 FEB 2025
*   CVSS Score: 5.9
*   The vulnerability was found by Edward Prior (@JankhJankh).
*   No known mitigation other than upgrading.
*   The Octopus Deploy security team is not aware of any public announcements or malicious use of the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 293 | Using Referer Field for Authentication | Variant | Allowed | alternate_terms | 0.800 |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.146 |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.137 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.135 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.133 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.132 |
| 7 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.131 |
| 8 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.130 |
| 9 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | Allowed | dense | 0.478 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.003 |

