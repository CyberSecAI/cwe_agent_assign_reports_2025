# Vulnerability Information: CVE-2025-3540

## Vulnerability Description
A vulnerability classified as critical was found in H3C Magic NX15, Magic NX30 Pro, Magic NX400 and Magic R3010 up to V100R014. Affected by this vulnerability is the function FCGI_WizardProtoProcess of the file /api/wizard/getCapability of the component HTTP POST Request Handler. The manipulation leads to **command injection**. The attack can only be initiated within the local network. The exploit has been disclosed to the public and may be used. It is recommended to upgrade the affected component.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** H3C Magic NX15, Magic NX30 Pro, Magic NX400 and Magic R3010
- **version:** up to V100R014
- **component:** FCGI_WizardProtoProcess of the file /api/wizard/getCapability of the component HTTP POST Request Handler

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis related to CVE-2025-3540 (PLACEHOLDER - Implement CVE description retrieval):

**The content is RELEVANT.** It details a security vulnerability in H3C Magic series home routers. While the CVE description is a placeholder, the document provides substantial information about a command injection vulnerability.

Here's the extracted information:

*   **Root cause of vulnerability:** The document states that H3C Magic home routers have an "unauthorized command injection risk." Attackers can send special requests under specific networking conditions to gain control of the device.
*   **Weaknesses/vulnerabilities present:** Command Injection.
*   **Impact of exploitation:**  The attack could render the user's network unavailable. However, the document notes the devices do not actively collect or store sensitive user information, so data leakage is not expected.
*   **Attack vectors:** The vulnerability requires the attacker to be on the local network (wired or wireless). Wireless access requires cracking the Wi-Fi password.
*   **Required attacker capabilities/position:**  The attacker needs to be on the local network, either physically connected via Ethernet or within wireless range and able to crack the Wi-Fi password.
*   **Mitigation or fix:**
    *   Enable anti-蹭网 (anti-leeching) functionality to prevent attackers from brute-forcing the wireless password.
    *   Enable Wi-Fi access control and add suspicious devices to a blacklist.
    *   Enable a guest network for others to connect, avoiding the disclosure of the main wireless password.
    *   Upgrade to the fixed versions:
        *   Magic BE18000路由器: R005
        *   Magic NX15 路由器: R014L01
        *   Magic NX400路由器: R014L01
        *   Magic NX30Pro路由器: R008L01
        *   Magic R3010 路由器: R008L01
*   **CVE IDs:** CVE-2025-2725, CVE-2025-2726, CVE-2025-2727, CVE-2025-2728, CVE-2025-2729, CVE-2025-2730, CVE-2025-2731, CVE-2025-2732, NVDB-TEMP-CNVDB-2025008766
*   **Vulnerability Level:** Medium

**More Detail than Official CVE Description:** This document provides significantly more detail than a typical CVE description. It includes affected products, versions, a detailed explanation of the vulnerability, attack vectors, mitigation steps, and references to other vulnerability IDs.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.534 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.498 |
| 5 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.435 |
| 6 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.428 |
| 7 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.424 |
| 8 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.422 |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | dense | 0.612 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

