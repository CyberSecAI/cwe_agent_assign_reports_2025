## Vulnerability Description
The Newsletters plugin for WordPress is vulnerable to Full Path Disclosure in all versions up to, and including, 4.9.9. This is due the plugin **not preventing direct access to the /vendor/mobiledetect/mobiledetectlib/export/exportToJSON.php**. This makes it possible for unauthenticated attackers to retrieve the full path of the web application, which can be used to aid other attacks. The information displayed is not useful on its own, and requires another vulnerability to be present for damage to an affected website.

### Vulnerability Description Key Phrases
- **rootcause:** **not preventing direct access to the /vendor/mobiledetect/mobiledetectlib/export/exportToJSON.php**
- **impact:** Full Path Disclosure
- **attacker:** unauthenticated attackers
- **product:** Newsletters plugin for WordPress
- **version:** all versions up to and including 4.9.9

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability stems from the Newsletters plugin not restricting direct access to the `exportToJSON.php` file located within the `/vendor/mobiledetect/mobiledetectlib/export/` directory.

**Weaknesses/Vulnerabilities:**

- **Full Path Disclosure:** The primary vulnerability is the exposure of the full server path when the `exportToJSON.php` file is accessed directly. This is due to the lack of access controls on the file.

**Impact of Exploitation:**

- An attacker can gain knowledge of the full file path of the WordPress installation. Although this information, in itself, isn't directly harmful, it serves as a reconnaissance step for more complex attacks, providing crucial information about the server environment.

**Attack Vectors:**

- **Direct URL Access:** Attackers can exploit this vulnerability by directly accessing the `exportToJSON.php` file via a web browser or automated script.

**Required Attacker Capabilities/Position:**

-   **Unauthenticated Access:** The attacker does not require any authentication to exploit this vulnerability.
-   **Network Access:** The attacker only requires network access to the web application to send the malicious request to the vulnerable file.

**Additional Notes:**

- The provided Wordfence content indicates that the vulnerability is present in Newsletters plugin versions up to and including 4.9.9.
- Version 4.9.9.1 includes a fix for this vulnerability, along with other minor changes.
- The file `/vendor/mobiledetect/mobiledetectlib/export/exportToJSON.php` itself is an export script designed to create a JSON file based on the Mobile Detect library.
- The fix involves an update to the plugin that includes a change to the `exportToJSON.php` file, although the provided diff does not indicate any specific change to remediate the full path disclosure vulnerability but rather seems to simply remove the `realpath()` function call on the file output strings in lines 63 and 66. The fix likely involves additional changes outside this file not included in the provided content, which prevents direct access to the file and thus prevents the full path disclosure.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.586 |
| 2 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.571 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.565 |
| 4 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.564 |
| 5 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.557 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.552 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.546 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.545 |
| 9 | 36 | Absolute Path Traversal | Base | Allowed | dense | 0.527 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-862: Missing Authorization

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-306: Missing Authentication for Critical Function

CWE-425: Direct Request ('Forced Browsing')

CWE-863: Incorrect Authorization

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-502: Deserialization of Untrusted Data

CWE-36: Absolute Path Traversal

CWE-471: Modification of Assumed-Immutable Data (MAID)