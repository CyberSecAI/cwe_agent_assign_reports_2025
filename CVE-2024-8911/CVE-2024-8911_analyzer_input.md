# Vulnerability Information: CVE-2024-8911

## Vulnerability Description
The LatePoint plugin for WordPress is vulnerable to Arbitrary User Password Change via SQL Injection in versions up to, and including, 5.0.11. This is due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to change user passwords and potentially take over administrator accounts. Note that changing a WordPress users password is only possible if the Use WordPress users as customers setting is enabled, which is disabled by default. Without this setting enabled, only the passwords of plugin customers, which are stored and managed in a separate database table, can be modified.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** Arbitrary User Password Change
- **attacker:** unauthenticated attackers
- **product:** LatePoint plugin for WordPress
- **version:** up to and including 5.0.11

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-8911

**Root Cause:**
*   The LatePoint plugin for WordPress has insufficient escaping of user-supplied parameters and lacks sufficient preparation in existing SQL queries. This makes the plugin vulnerable to SQL Injection.

**Weaknesses/Vulnerabilities:**
*   **SQL Injection:** The primary vulnerability is a SQL injection flaw stemming from inadequate sanitization of user input when constructing SQL queries.

**Impact of Exploitation:**
*   **Arbitrary User Password Change:** Unauthenticated attackers can exploit the SQL injection vulnerability to change user passwords, potentially gaining access to user accounts.
*   **Administrator Account Takeover:** By changing the password of an administrator account, attackers can gain full control over the WordPress site.
*   **Customer Data Modification:** Even if "Use WordPress users as customers" is disabled, attackers can still modify passwords of customers stored in the plugin's separate database table.

**Attack Vectors:**
*   **Unauthenticated Attackers:** The vulnerability can be exploited by remote attackers without prior authentication to the WordPress site.
*   **SQL Injection via User Parameters:** Attackers manipulate user-supplied parameters to inject malicious SQL code.

**Required Attacker Capabilities/Position:**
*   **Network Access:** Attackers require network access to the WordPress site.
*   **No Authentication Required:** Attackers do not need to authenticate to the WordPress site.

**Additional Notes:**
*   The vulnerability is present in LatePoint plugin versions up to and including 5.0.11.
*   A patch is available in version 5.0.12 and later.
*   Changing a WordPress user's password is only possible if the "Use WordPress users as customers" setting is enabled. By default this setting is disabled. If disabled, attackers can still change the passwords of plugin customers stored in the plugin's separate table.
*   Wordfence blocked 91 attacks targeting this vulnerability in the past 24 hours.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.776 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.739 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.733 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.716 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.702 |
| 7 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.688 |
| 8 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.686 |
| 9 | 620 | Unverified Password Change | Base | Allowed | dense | 0.549 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |

