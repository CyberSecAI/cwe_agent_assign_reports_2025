# Vulnerability Information: CVE-2025-32969

## Vulnerability Description
XWiki is a generic wiki platform. In versions starting from 1.8 and prior to 15.10.16, 16.4.6, and 16.10.1, it is possible for a remote unauthenticated user to escape from the HQL execution context and perform a blind SQL injection to execute arbitrary SQL statements on the database backend, including when Prevent unregistered users from viewing pages, regardless of the page rights and Prevent unregistered users from editing pages, regardless of the page rights options are enabled. Depending on the used database backend, the attacker may be able to not only obtain confidential information such as password hashes from the database, but also execute UPDATE/INSERT/DELETE queries. This issue has been patched in versions 16.10.1, 16.4.6 and 15.10.16. There is no known workaround, other than upgrading XWiki.

### Vulnerability Description Key Phrases
- **weakness:** **SQL injection, blind SQL injection**
- **product:** XWiki
- **impact:** ['execute arbitrary SQL statements', 'execute UPDATE/INSERT/DELETE queries', 'obtain confidential information', 'execute SQL queries']
- **attacker:** remote unauthenticated user
- **version:** 1.8 to 15.10.16, 16.4.6, and 16.10.1

## CVE Reference Links Content Summary
## Analysis of CVE-2025-32969 based on provided content:

The provided content details a SQL injection vulnerability in the REST API query endpoint of XWiki Platform. This directly relates to CVE-2025-32969 as indicated by the references to the GitHub security advisory (GHSA-f69v-xrj8-rhxf) and the CVE ID itself. The content provides significantly more detail than a placeholder CVE description would.

**Root cause of vulnerability:**

The vulnerability stems from insufficient sanitization of user-supplied input in the `/rest/wikis/xwiki/query` endpoint, allowing an attacker to escape the HQL execution context and inject arbitrary SQL commands.

**Weaknesses/vulnerabilities present:**

*   SQL Injection (CWE-564)
*   Insufficient input validation
*   Lack of proper escaping of user-provided data within HQL queries.

**Impact of exploitation:**

Successful exploitation allows a remote, unauthenticated attacker to:

*   Execute arbitrary SQL statements on the database backend.
*   Potentially obtain sensitive information like password hashes.
*   Modify or delete data within the database (UPDATE/INSERT/DELETE queries).

**Attack vectors:**

*   Network-accessible REST API endpoint (`/rest/wikis/xwiki/query`).
*   Crafted HTTP GET requests with malicious query parameters.
*   Example queries are provided for MySQL/MariaDB and PostgreSQL.

**Required attacker capabilities/position:**

*   No authentication required (unauthenticated attacker).
*   Network access to the XWiki instance.
*   Knowledge of SQL injection techniques and database-specific syntax.

**Mitigation or fix:**

*   Upgrade to patched versions: 16.10.1, 16.4.6, or 15.10.16.
*   No known workaround other than upgrading.

**Additional details:**

*   The vulnerability was reported by Sergey Anufrienko from Kaspersky ICS-CERT.
*   The vulnerability affects versions >= 1.8.
*   CVSS v3 score: 9.7 (Critical)
*   CVSS v4 score is also provided with detailed metrics.
*   The issue is linked to another related issue (XWIKI-22718) concerning SQL injection in the script query API.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.797 |
| 3 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.718 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.717 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.714 |
| 6 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.713 |
| 7 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.696 |
| 8 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.691 |
| 9 | 202 | Exposure of Sensitive Information Through Data Queries | Base | Allowed | dense | 0.604 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

