# Vulnerability Information: CVE-2025-47274

## Vulnerability Description
ToolHive is a utility designed to simplify the deployment and management of Model Context Protocol (MCP) servers. Due to the ordering of code used to start an MCP server container, versions of ToolHive prior to 0.0.33 inadvertently **store secrets in the run config files** which are used to restart stopped containers. This means that an attacker who has access to the home folder of the user who starts the MCP server can read secrets without needing access to the secrets store itself. This only applies to secrets which were used in containers whose run configs exist at a point in time - other secrets remaining inaccessible. ToolHive 0.0.33 fixes the issue. Some workarounds are available. Stop and delete any running MCP servers, or manually remove any runconfigs from `$HOME/Library/Application Support/toolhive/runconfigs/` (macOS) or `$HOME/.state/toolhive/runconfigs/` (Linux).

### Vulnerability Description Key Phrases
- **weakness:** **store secrets in the run config files**
- **impact:** read secrets
- **attacker:** attacker who has access to the home folder of the user
- **product:** ToolHive
- **version:** prior to 0.0.33

## CVE Reference Links Content Summary
```text
Root cause of vulnerability:
Due to the ordering of code used to start an MCP server container, secrets are inadvertently stored in the run config files which are used to restart stopped containers.

Weaknesses/vulnerabilities present:
- Secrets are stored in the run config files.
- The run config files are used to restart stopped containers.
- An attacker with access to the home folder of the user who starts the MCP server can read secrets without needing access to the secrets store itself.

Impact of exploitation:
An attacker who has access to the home folder of the user who starts the MCP server can read secrets.

Attack vectors:
The attacker needs access to the home folder of the user who starts the MCP server.

Required attacker capabilities/position:
The attacker needs access to the home folder of the user who starts the MCP server.

Mitigation or fix:
ToolHive v0.0.33
Workarounds:
1. Stop and delete any running MCP servers.
2. Manually remove any runconfigs from `$HOME/Library/Application Support/toolhive/runconfigs/` (macOS) or `$HOME/.state/toolhive/runconfigs/` (Linux)
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.697 |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.686 |
| 3 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.678 |
| 4 | 552 | Files or Directories Accessible to External Parties | Base | Allowed | sparse | 0.670 |
| 5 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.659 |
| 6 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.657 |
| 7 | 257 | Storing Passwords in a Recoverable Format | Base | Allowed | sparse | 0.641 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.638 |
| 9 | 277 | Insecure Inherited Permissions | Variant | Allowed | dense | 0.490 |
| 10 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | graph | 0.002 |

