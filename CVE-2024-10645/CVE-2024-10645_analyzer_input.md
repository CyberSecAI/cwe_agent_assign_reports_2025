# Vulnerability Information: CVE-2024-10645

## Vulnerability Description
The Blogger 301 Redirect plugin for WordPress is vulnerable to blind **time-based SQL Injection** via the br parameter in all versions up to, and including, 2.5.3 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL Injection**
- **impact:** extract sensitive information from the database and information disclosure
- **vector:** br parameter
- **attacker:** unauthenticated attackers
- **product:** Blogger 301 Redirect plugin for WordPress
- **version:** up to 2.5.3

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-10645

**Vulnerable Software:** Blogger 301 Redirect WordPress plugin (versions <= 2.5.3)

**Root Cause:**
*   The plugin is vulnerable to SQL injection due to insufficient sanitization of the `br` parameter in the URL.
*   The plugin does not properly escape user-supplied input before using it in a SQL query.
*   The existing SQL query lacks sufficient preparation which allows attackers to inject malicious SQL code.

**Weaknesses/Vulnerabilities:**
*   **Unauthenticated SQL Injection:** The vulnerability can be exploited by unauthenticated users.
*   **Blind Time-Based SQL Injection:** Attackers can use time-based techniques to extract data without seeing the query results directly.
*   **Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')**

**Impact of Exploitation:**
*   Attackers can inject arbitrary SQL queries into the database.
*   Potential for extracting sensitive information from the database.
*   The vulnerability has a CVSS score of 7.5 (High), indicating a significant risk.

**Attack Vectors:**
*   The vulnerability is triggered through a crafted request using the `br` parameter in the URL.
*   The vulnerable code is within the `redirect_to()` function of the plugin.
*   The specific line of code that is vulnerable can be seen in the trac browser link provided.

**Required Attacker Capabilities/Position:**
*   The attacker does not need to be authenticated.
*   The attacker only needs to send a specially crafted URL to the vulnerable site.
*   No special skills are required beyond understanding how to craft a URL with the injection.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.540 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.482 |
| 4 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.477 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.469 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.465 |
| 7 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.462 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.457 |
| 9 | 601 | URL Redirection to Untrusted Site ('Open Redirect') | Base | Allowed | dense | 0.483 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.003 |

