# Vulnerability Information: CVE-2024-48914

## Vulnerability Description
Vendure is an open-source headless commerce platform. Prior to versions 3.0.5 and 2.3.3, a vulnerability in Vendures asset server plugin allows an attacker to craft a request which is able to traverse the server file system and retrieve the contents of arbitrary files, including sensitive data such as configuration files, environment variables, and other critical data stored on the server. In the same code path is an additional vector for crashing the server via a malformed URI. Patches are available in versions 3.0.5 and 2.3.3. Some workarounds are also available. One may use object storage rather than the local file system, e.g. MinIO or S3, or define middleware which detects and blocks requests with urls containing `/../`.

### Vulnerability Description Key Phrases
- **impact:** retrieve the contents of arbitrary files
- **vector:** craft a request
- **attacker:** attacker
- **product:** Vendure
- **version:** Prior to versions 3.0.5 and 2.3.3
- **component:** asset server plugin

## CVE Reference Links Content Summary
Based on the provided information, this content is related to **CVE-2024-48914**.

**Root cause of vulnerability:**
The vulnerability stems from the usage of `decodeURIComponent(req.path)` directly in `path.join` without any path normalization. This allows path traversal attacks.

**Weaknesses/vulnerabilities present:**
1.  **Path Traversal:** The application does not properly sanitize user-provided paths, allowing an attacker to access files outside of the intended directory.
2. **Denial of Service (DoS):**  Malformed URI characters in the asset URL can crash the server due to an error in `decodeURIComponent`.

**Impact of exploitation:**
1.  **Path Traversal:** An attacker can read arbitrary files on the server, including sensitive data like configuration files and credentials.
2.  **DoS:** Malformed requests can crash the server, making the service unavailable to users.

**Attack vectors:**
1. **Path Traversal:** Sending a crafted HTTP request with a URL containing path traversal sequences (e.g., `../`) in the asset path. For example: `http://localhost:3000/assets/../package.json`
2. **DoS:** Sending a crafted HTTP request with a malformed URI (e.g., `%80`) in the asset path. For example: `http://localhost:3000/assets/%80package.json`

**Required attacker capabilities/position:**
The attacker needs to be able to send HTTP requests to the server. No prior authentication or special privileges are required. The attacker can be on the network (remote).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.219 |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.216 |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | Allowed | sparse | 0.214 |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.212 |
| 5 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.211 |
| 6 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.210 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.210 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.206 |
| 9 | 502 | Deserialization of Untrusted Data | Base | Allowed | dense | 0.500 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.003 |

