# Vulnerability Information: CVE-2024-7156

## Vulnerability Description
A vulnerability was found in TOTOLINK A3700R 9.1.2u.5822_B20200513 and classified as problematic. Affected by this issue is some unknown functionality of the file /cgi-bin/ExportSettings.sh of the component apmib Configuration Handler. The manipulation leads to information disclosure. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. VDB-272570 is the identifier assigned to this vulnerability. NOTE The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **impact:** information disclosure
- **product:** TOTOLINK A3700R
- **version:** 9.1.2u.5822_B20200513
- **component:** /cgi-bin/ExportSettings.sh

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Root Cause:**
- The vulnerability stems from the lack of access control in the `/cgi-bin/ExportSettings.sh` script of the TOTOLINK A3700R router firmware.

**Weaknesses/Vulnerabilities Present:**
- **Authentication Bypass:** The `/cgi-bin/ExportSettings.sh` script can be accessed without authentication.
- **Information Disclosure:** The script allows downloading of the `apmib` configuration file (Config--xxxxxxxx.dat) without proper authorization.
- **Sensitive Data Exposure:** The `apmib` configuration file contains sensitive information, including usernames and passwords, which can be extracted after decoding.

**Impact of Exploitation:**
- An attacker can gain access to the router's configuration, including administrative credentials (username/password).
- This access could allow the attacker to take control of the device, change its settings, and potentially use it in further attacks, including network access.

**Attack Vectors:**
- The attack vector is a direct HTTP request to the `/cgi-bin/ExportSettings.sh` endpoint of the router's web interface.

**Required Attacker Capabilities/Position:**
- The attacker needs network access to the vulnerable TOTOLINK A3700R router. This could be from within the local network, or if the router's web interface is exposed to the internet, remotely.
- The attacker does not need to authenticate.

**Additional Notes:**
- The `apmib` configuration file is named `Config--xxxxxxxx.dat` where `xxxxxxxx` is a variable string.
- The vulnerability is present in version A3700R V9.1.2u.5822\_B20200513.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.194 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.188 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.157 |
| 4 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.154 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.154 |
| 6 | 334 | Small Space of Random Values | Base | Allowed | sparse | 0.152 |
| 7 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.152 |
| 8 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | sparse | 0.152 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.644 |
| 10 | 787 | Out-of-bounds Write | Base | Allowed | graph | 0.002 |

