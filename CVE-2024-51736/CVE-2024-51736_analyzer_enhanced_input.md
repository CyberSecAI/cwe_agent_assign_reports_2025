## Vulnerability Description
Symphony process is a module for the Symphony PHP framework which executes commands in sub-processes. On Windows, when an executable file named `cmd.exe` is located in the current working directory it will be called by the `Process` class when preparing command arguments, leading to possible hijacking. This issue has been addressed in release versions 5.4.46, 6.4.14, and 7.1.7. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **impact:** execute commands
- **product:** Symphony PHP framework
- **component:** Symphony process module

## CVE Reference Links Content Summary
Based on the provided information, this content is related to CVE-2024-51736.

Here's a breakdown of the relevant details:

**Root Cause of Vulnerability:**
- On Windows, the `Process` class in Symfony could be tricked into executing a malicious `cmd.exe` located in the current working directory instead of the system's `cmd.exe`. This is due to how the `Process` class prepares command arguments on Windows.

**Weaknesses/Vulnerabilities:**
- The vulnerability is a command execution hijack, where a local attacker can cause arbitrary code to execute.
- The vulnerability stems from the fact that the Process class does not use the absolute path when calling cmd.exe and will use a local `cmd.exe` if available.

**Impact of Exploitation:**
- An attacker could potentially achieve arbitrary code execution by placing a malicious `cmd.exe` in a directory where a vulnerable application executes.
- This could lead to a complete compromise of the system if the application runs with sufficient privileges.

**Attack Vectors:**
- The attack vector is local, meaning the attacker needs to be able to place a malicious `cmd.exe` file in a directory where a vulnerable application is running.

**Required Attacker Capabilities/Position:**
- The attacker needs local access to the system.
- The attacker needs to be able to write files to the current working directory of the vulnerable application, or any directory which may be searched for executables.

**Additional Information:**
- The affected versions of `symfony/process` are: <5.4.46, >=6, <6.4.14, and >=7, <7.1.7.
- Patched versions are 5.4.46, 6.4.14, and 7.1.7.
- The fix involves the `Process` class now using the absolute path to `cmd.exe`.
- The vulnerability is assigned a "Low" severity score.
- The CVSS score is CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N, with local attack vector.
- The vulnerability is categorized under CWE-77 (Improper Neutralization of Special Elements used in a Command).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 427 | Uncontrolled Search Path Element | Base | Allowed | sparse | 0.452 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.417 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.414 |
| 6 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.413 |
| 7 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.398 |
| 8 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.397 |
| 9 | 114 | Process Control | Class | Allowed-with-Review | dense | 0.511 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-427: Uncontrolled Search Path Element

CWE-116: Improper Encoding or Escaping of Output

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-502: Deserialization of Untrusted Data

CWE-114: Process Control

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')