## Vulnerability Description
The Meks Video Importer plugin for WordPress is vulnerable to unauthorized API key modification due to a **missing capability check** on the ajax_save_settings function in all versions up to, and including, 1.0.11. This makes it possible for authenticated attackers, with Subscriber-level access and above, to modify the plugins API keys

### Vulnerability Description Key Phrases
- **rootcause:** **missing capability check**
- **impact:** unauthorized API key modification
- **attacker:** authenticated attackers with Subscriber-level access and above
- **product:** Meks Video Importer WordPress plugin
- **version:** up to and including 1.0.11
- **component:** ajax_save_settings function

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-6599:

**Root Cause of Vulnerability:**
The vulnerability stems from a missing authorization check within the `ajax_save_settings` function of the Meks Video Importer plugin. This function is responsible for saving and verifying API keys for YouTube and Vimeo.

**Weaknesses/Vulnerabilities Present:**
- **Missing Authorization Check:** The primary weakness is the lack of a capability check in the `ajax_save_settings` function. This allows any authenticated user, even those with minimal privileges like a subscriber, to access and modify the plugin's API keys.
- **Insecure API Key Modification:** The plugin does not properly restrict who can modify the stored API keys.

**Impact of Exploitation:**
- **Unauthorized API Key Modification:** An attacker with low-level access (Subscriber+) can modify the YouTube or Vimeo API keys.
- **Potential for Malicious Use:** By changing the API keys, attackers could potentially:
    - Redirect API calls to their own accounts or services.
    - Impersonate the site owner's YouTube/Vimeo account when fetching videos.
    - Potentially disrupt video imports for the site.

**Attack Vectors:**
- **Network:** The vulnerability is triggered via an AJAX request to the `ajax_save_settings` function.
- **Authentication:** The attacker needs to be an authenticated user on the WordPress site.

**Required Attacker Capabilities/Position:**
- **Authenticated User:** The attacker must have an account on the WordPress site, with at least subscriber-level privileges.
- **Knowledge of AJAX Endpoint:** The attacker needs to know the name of the AJAX action (`mvi_save_youtube_settings` or `mvi_save_vimeo_settings`) and how to structure the request to modify the API keys.

**Additional Notes:**
- The Wordfence article mentions that CVE-2024-38733 may be a duplicate of this issue.
- The provided code snippets point to the vulnerable code locations within the `class.meks-video-importer-youtube.php` and `class.meks-video-importer-vimeo.php` files.
- The vulnerability was patched in version 1.0.13 of the plugin.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.406 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.378 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.372 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.355 |
| 5 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.347 |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.339 |
| 7 | 284 | Improper Access Control | Pillar | Discouraged | sparse | 0.330 |
| 8 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.327 |
| 9 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | dense | 0.465 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-862: Missing Authorization

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-863: Incorrect Authorization

CWE-285: Improper Authorization

CWE-306: Missing Authentication for Critical Function

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-284: Improper Access Control

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-613: Insufficient Session Expiration