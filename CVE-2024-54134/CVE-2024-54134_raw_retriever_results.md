# Raw Retriever Results for CVE-2024-54134

# Raw Retriever Results for CVE-2024-54134
## Query
A publish-access account was compromised for `@solana/web3.js`, a JavaScript library that is commonly used by Solana dapps. This allowed an attacker to publish unauthorized and malicious packages that were modified, allowing them to steal private key material and drain funds from dapps, like bots, that handle private keys directly. This issue should not affect non-custodial wallets, as they generally do not expose private keys during transactions. This is not an issue with the Solana protocol itself, but with a specific JavaScript client library and only appears to affect projects that directly handle private keys and that updated within the window of 320pm UTC and 825pm UTC on Tuesday, December 3, 2024. These two unauthorized versions (1.95.6 and 1.95.7) were caught within hours and have since been unpublished. All Solana app developers should upgrade to version 1.95.8. Developers that suspect they might be compromised should rotate any suspect authority keys, including multisigs, program authorities, server keypairs, and so on.

## Keyphrases
- **rootcause**: 'compromised publish-access account'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4997 | 0.5478 | 0.5141 | 0.5153 | 20 |
| Sparse | 232.1963 | 791.3447 | 694.0759 | 726.3196 | 11 |
| Graph | 1.0719 | 2.2100 | 1.6964 | 1.7013 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 2 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | base | 2.2100 | Allowed |
| 3 | 209 | Generation of Error Message Containing Sensitive Information | base | 2.1762 | Allowed |
| 4 | 202 | Exposure of Sensitive Information Through Data Queries | base | 2.0452 | Allowed |
| 5 | 499 | Serializable Class Containing Sensitive Data | variant | 2.0400 | Allowed |
| 6 | 498 | Cloneable Class Containing Sensitive Information | variant | 2.0400 | Allowed |
| 7 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.8018 | Allowed |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 9 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 10 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.7064 | Allowed |
| 11 | 201 | Insertion of Sensitive Information Into Sent Data | Base | 1.6963 | Allowed |
| 12 | 306 | Missing Authentication for Critical Function | Base | 1.6607 | Allowed |
| 13 | 347 | Improper Verification of Cryptographic Signature | Base | 1.6317 | Allowed |
| 14 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 1.5402 | Allowed |
| 15 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.5024 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 347 | Improper Verification of Cryptographic Signature | Base | 0.5478 | 0.5478 | Allowed |
| 2 | 863 | Incorrect Authorization | Class | 0.5415 | 0.5415 | Allowed-with-Review |
| 3 | 306 | Missing Authentication for Critical Function | Base | 0.5218 | 0.5218 | Allowed |
| 4 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5214 | 0.5214 | Allowed |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.5205 | 0.5205 | Allowed |
| 6 | 295 | Improper Certificate Validation | Base | 0.5162 | 0.5162 | Allowed |
| 7 | 287 | Improper Authentication | Class | 0.5157 | 0.5157 | Discouraged |
| 8 | 522 | Insufficiently Protected Credentials | Class | 0.5155 | 0.5155 | Allowed-with-Review |
| 9 | 285 | Improper Authorization | Class | 0.5153 | 0.5153 | Discouraged |
| 10 | 862 | Missing Authorization | Class | 0.5153 | 0.5153 | Allowed-with-Review |
| 11 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 0.5153 | 0.5153 | Allowed |
| 12 | 346 | Origin Validation Error | Class | 0.5110 | 0.5110 | Allowed-with-Review |
| 13 | 277 | Insecure Inherited Permissions | Variant | 0.5095 | 0.5095 | Allowed |
| 14 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.5074 | 0.5074 | Allowed |
| 15 | 116 | Improper Encoding or Escaping of Output | Class | 0.5037 | 0.5037 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | 791.3447 | 791.3447 | Allowed |
| 2 | 863 | Incorrect Authorization | 790.3015 | 790.3015 | Allowed-with-Review |
| 3 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | 751.4454 | 751.4454 | Discouraged |
| 4 | 285 | Improper Authorization | 734.2335 | 734.2335 | Discouraged |
| 5 | 1390 | Weak Authentication | 729.2958 | 729.2958 | Allowed-with-Review |
| 6 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | 726.3196 | 726.3196 | Allowed |
| 7 | 522 | Insufficiently Protected Credentials | 723.4154 | 723.4154 | Allowed-with-Review |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 723.2967 | 723.2967 | Allowed-with-Review |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | 717.3227 | 717.3227 | Allowed |
| 10 | 532 | Insertion of Sensitive Information into Log File | 715.6626 | 715.6626 | Allowed |
| 11 | 287 | Improper Authentication | 232.1963 | 232.1963 | Discouraged |
