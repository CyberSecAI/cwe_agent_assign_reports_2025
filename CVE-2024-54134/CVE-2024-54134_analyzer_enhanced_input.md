## Vulnerability Description
A publish-access account was compromised for `@solana/web3.js`, a JavaScript library that is commonly used by Solana dapps. This allowed an attacker to publish unauthorized and malicious packages that were modified, allowing them to steal private key material and drain funds from dapps, like bots, that handle private keys directly. This issue should not affect non-custodial wallets, as they generally do not expose private keys during transactions. This is not an issue with the Solana protocol itself, but with a specific JavaScript client library and only appears to affect projects that directly handle private keys and that updated within the window of 320pm UTC and 825pm UTC on Tuesday, December 3, 2024. These two unauthorized versions (1.95.6 and 1.95.7) were caught within hours and have since been unpublished. All Solana app developers should upgrade to version 1.95.8. Developers that suspect they might be compromised should rotate any suspect authority keys, including multisigs, program authorities, server keypairs, and so on.

### Vulnerability Description Key Phrases
- **rootcause:** **compromised publish-access account**
- **impact:** publish unauthorized and malicious packages
- **product:** @solana/web3.js
- **version:** 1.95.6 and 1.95.7

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:** A compromised publish-access account for the `@solana/web3.js` npm package allowed an attacker to publish malicious versions of the library.

**Weaknesses/Vulnerabilities:**
*   **Compromised Account:** An attacker gained control of a publish-access account for the npm package.
*   **Malicious Code Injection:** The attacker injected malicious code into the library that exfiltrated private key material.
*  **Supply Chain Vulnerability**: The vulnerability lies in the supply chain of the software. Attackers did not directly target vulnerable software but rather compromised the software update mechanism.

**Impact of Exploitation:**
*   **Private Key Theft:** The malicious code stole private key material from applications using the compromised library versions.
*   **Fund Draining:** Stolen private keys could be used to drain funds from affected applications like bots that directly handle private keys.
* **Data Breach**: The attack resulted in unauthorized access and exfiltration of confidential information (private keys).
* **Financial Loss**: Affected users could face monetary loss due to the compromised private keys.

**Attack Vectors:**
*   **Network:** The attacker distributed the malicious code via the npm package repository, which is accessible over the network.
*   **Supply Chain Attack**: The attacker didn't directly target vulnerable systems, but rather targeted a software update mechanism.

**Required Attacker Capabilities/Position:**
*   **Compromised Account Access:** The attacker needed access to a legitimate publish-access account for the `@solana/web3.js` npm package.
*   **Code Injection Ability**: The attacker must be able to modify the code of the library to add the malicious logic for key exfiltration.
* **Network Access:**  The attacker needs network access to push the malicious package to the npm registry.

**Additional Details:**

*   The vulnerability affects versions 1.95.6 and 1.95.7 of the `@solana/web3.js` library.
*   The malicious versions were live between 3:20 PM UTC and 8:25 PM UTC on December 3, 2024.
*   The vulnerability primarily affects applications that directly handle private keys, such as bots.
*   Non-custodial wallets are generally not affected, as they typically do not expose private keys during transactions.
*   Users are advised to upgrade to version 1.95.8 and rotate any potentially compromised authority keys.

The CVSS v4 base score of 8.3 is also provided, along with the base metrics.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.791 |
| 2 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.790 |
| 3 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.751 |
| 4 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.734 |
| 5 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.729 |
| 6 | 335 | Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG) | Base | Allowed | sparse | 0.726 |
| 7 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 0.723 |
| 8 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 0.723 |
| 9 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | dense | 0.548 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-863: Incorrect Authorization

CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

CWE-285: Improper Authorization

CWE-1390: Weak Authentication

CWE-335: Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)

CWE-522: Insufficiently Protected Credentials

CWE-327: Use of a Broken or Risky Cryptographic Algorithm

CWE-347: Improper Verification of Cryptographic Signature

CWE-226: Sensitive Information in Resource Not Removed Before Reuse