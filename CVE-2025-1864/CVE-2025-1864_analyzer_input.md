# Vulnerability Information: CVE-2025-1864

## Vulnerability Description
**Improper Restriction of Operations within the Bounds of a Memory Buffer** vulnerability in radareorg radare2 allows **Overflow Buffers**.This issue affects radare2 before <5.9.9.

### Vulnerability Description Key Phrases
- **rootcause:** **Improper Restriction of Operations within the Bounds of a Memory Buffer**
- **weakness:** **Overflow Buffers**
- **product:** radareorg radare2
- **version:** before <5.9.9

## CVE Reference Links Content Summary
## Analysis of CVE-2025-1864 based on provided content:

**CVE ID:** CVE-2025-1864

**Relates to CVE:** YES

**Root cause of vulnerability:**

The vulnerability is an improper restriction of operations within the bounds of a memory buffer, leading to overflow buffers in radareorg radare2. The root cause is a missing security patch in the `magic_file_check_mem()` function that was present in the `file/file` project and fixed in commit `6713ca4`.

**Weaknesses/vulnerabilities present:**

*   CWE-119: Improper Restriction of Operations within Bounds.
*   Buffer Overflow

**Impact of exploitation:**

The CVSS v4 score indicates a Critical severity (10.0/10) with High impact to Confidentiality, Integrity, and Availability.  The subsequent system impact metrics also show High impact across all three areas.

**Attack vectors:**

*   Network (Attack Vector)
*   Low Attack Complexity
*   No Privileges Required
*   No User Interaction

**Required attacker capabilities/position:**

The attacker requires no privileges and no user interaction to exploit the vulnerability. The attack can be launched remotely over the network.

**Mitigation or fix:**

*   Upgrade radare2 to version `<5.9.9`.
*   The fix involves applying the patch from `file/file@6713ca4` to radare2.
*   rizinorg/rizin backported the fix in commit `f833c7a` and `e0a4096`.

**Additional Details (more than official CVE description):**

*   The vulnerability was initially identified and fixed in the `file/file` project.
*   The pull request #23981 in radareorg/radare2 implements the fix.
*   The EPSS score is 0.061% (19th percentile), estimating a low probability of exploitation within the next 30 days.
*   The vulnerability has been assigned CVE-2025-1864 and GHSA-qp2x-2vj2-93c6.
*   The fix has also been applied to the rizin project.
*   The vulnerability affects the `magic` library.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 2 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | sparse | 0.310 |
| 3 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.262 |
| 4 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.245 |
| 5 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.232 |
| 6 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | sparse | 0.230 |
| 7 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.229 |
| 8 | 787 | Out-of-bounds Write | Base | Allowed | sparse | 0.223 |
| 9 | 788 | Access of Memory Location After End of Buffer | Base | Discouraged | dense | 0.606 |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | graph | 0.003 |

