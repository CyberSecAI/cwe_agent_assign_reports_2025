# Vulnerability Information: CVE-2025-3726

## Vulnerability Description
A vulnerability was found in PCMan FTP Server 2.0.7. It has been rated as critical. Affected by this issue is some unknown functionality of the component CD Command Handler. The manipulation leads to **buffer overflow**. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** PCMan FTP Server
- **version:** 2.0.7
- **component:** CD Command Handler

## CVE Reference Links Content Summary
## Analysis of CVE-2025-3726 Content - fitoxs.com_7b9b65b0_20250624_175337.html

This content **RELATES** to a vulnerability in PCMan FTP Server. It provides details beyond what a standard CVE description would typically offer.

**Root cause of vulnerability:**

The vulnerability is a buffer overflow in the `MDIR` command handling of PCMan FTP Server version 2.0.7.

**Weaknesses/vulnerabilities present:**

*   **Buffer Overflow:** The `MDIR` command does not properly validate the length of the input, allowing an attacker to send a payload larger than the allocated buffer.
*   **Remote Exploitation:** The vulnerability is exploitable remotely, as it can be triggered by sending a crafted `MDIR` command to the FTP server.

**Impact of exploitation:**

Successful exploitation allows the attacker to overwrite the instruction pointer (EIP) and potentially execute arbitrary code on the target system. The provided exploit aims to achieve shell access.

**Attack vectors:**

*   Sending a specially crafted `MDIR` command to the FTP server.

**Required attacker capabilities/position:**

*   Network access to the target FTP server.
*   Ability to send arbitrary commands to the FTP server.
*   Knowledge of the buffer overflow offset (2006 bytes) and the address of a suitable jump instruction (0x74e32fd9 - JMP ESP).

**Mitigation or fix:**

The content does not explicitly mention a fix, but implies that proper input validation and buffer size checks in the `MDIR` command handling would mitigate the vulnerability.

**Additional Details (more than official CVE description):**

*   **Exploit Details:** The content includes a complete Perl exploit script.
*   **Offset and EIP:** The exploit specifies the buffer overflow offset (2006 bytes) and the EIP address (0x74e32fd9) used for exploitation.
*   **Payload:** The exploit includes the shellcode payload.
*   **Tested Environment:** The exploit was tested on Windows XP SP3.
*   **Bad Characters:** The exploit defines bad characters (\x00\x0a\x0d) to be avoided in the payload.
*   **Connection Details:** The exploit script shows how to connect to the FTP server and send the malicious command.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.383 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.369 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.323 |
| 7 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.321 |
| 8 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.315 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.605 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

