# Raw Retriever Results for CVE-2024-39554

# Raw Retriever Results for CVE-2024-39554
## Query
A Concurrent Execution using Shared Resource with Improper Synchronization (Race Condition) vulnerability the Routing Protocol Daemon (rpd) of Juniper Networks Junos OS and Juniper Networks Junos OS Evolved allows an unauthenticated, network-based attacker to inject incremental routing updates when BGP multipath is enabled, causing rpd to crash and restart, resulting in a Denial of Service (DoS). Since this is a timing issue (race condition), the successful exploitation of this vulnerability is outside the attackers control. However, continued receipt and processing of this packet may create a sustained Denial of Service (DoS) condition. On all Junos OS and Junos OS Evolved platforms with BGP multipath enabled, a specific multipath calculation removes the original next hop from the multipath lead routes nexthop-set. When this change happens, multipath relies on certain internal timing to record the update. Under certain circumstance and with specific timing, this could result in an rpd crash. This issue only affects systems with BGP multipath enabled. This issue affects Junos OS * All versions of 21.1 * from 21.2 before 21.2R3-S7, * from 21.4 before 21.4R3-S6, * from 22.1 before 22.1R3-S5, * from 22.2 before 22.2R3-S3, * from 22.3 before 22.3R3-S2, * from 22.4 before 22.4R3, * from 23.2 before 23.2R2. Junos OS Evolved * All versions of 21.1-EVO, * All versions of 21.2-EVO, * from 21.4-EVO before 21.4R3-S6-EVO,

## Keyphrases
- **rootcause**: 'concurrent execution using shared resource with improper synchronization (race condition)'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5400 | 0.6001 | 0.5662 | 0.5662 | 20 |
| Sparse | 463.6030 | 1775.8839 | 1439.6907 | 1451.0650 | 11 |
| Graph | 1.4784 | 2.8444 | 1.8883 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 410 | Insufficient Resource Pool | Base | 2.8444 | Allowed |
| 2 | 252 | Unchecked Return Value | Base | 2.5066 | Allowed |
| 3 | 1286 | Improper Validation of Syntactic Correctness of Input | base | 2.3998 | Allowed |
| 4 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 5 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2090 | Allowed |
| 6 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0659 | Allowed |
| 7 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 8 | 129 | Improper Validation of Array Index | variant | 1.8394 | Allowed |
| 9 | 400 | Uncontrolled Resource Consumption | Class | 1.7743 | Discouraged |
| 10 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 11 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 12 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 1.6848 | Allowed |
| 13 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 14 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6443 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 410 | Insufficient Resource Pool | Base | 0.6001 | 0.6001 | Allowed |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5945 | 0.5945 | Allowed |
| 3 | 606 | Unchecked Input for Loop Condition | Base | 0.5928 | 0.5928 | Allowed |
| 4 | 400 | Uncontrolled Resource Consumption | Class | 0.5873 | 0.5873 | Discouraged |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5872 | 0.5872 | Allowed-with-Review |
| 6 | 696 | Incorrect Behavior Order | Class | 0.5780 | 0.5780 | Allowed-with-Review |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5765 | 0.5765 | Allowed |
| 8 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.5720 | 0.5720 | Allowed |
| 9 | 755 | Improper Handling of Exceptional Conditions | Class | 0.5685 | 0.5685 | Discouraged |
| 10 | 121 | Stack-based Buffer Overflow | Variant | 0.5668 | 0.5668 | Allowed |
| 11 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5656 | 0.5656 | Discouraged |
| 12 | 1250 | Improper Preservation of Consistency Between Independent Representations of Shared State | Base | 0.5557 | 0.5557 | Allowed |
| 13 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.5552 | 0.5552 | Allowed |
| 14 | 617 | Reachable Assertion | Base | 0.5536 | 0.5536 | Allowed |
| 15 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5526 | 0.5526 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 755 | Improper Handling of Exceptional Conditions | 1775.8839 | 1775.8839 | Discouraged |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1713.3515 | 1713.3515 | Allowed-with-Review |
| 3 | 1286 | Improper Validation of Syntactic Correctness of Input | 1632.9538 | 1632.9538 | Allowed |
| 4 | 252 | Unchecked Return Value | 1612.1295 | 1612.1295 | Allowed |
| 5 | 400 | Uncontrolled Resource Consumption | 1460.9049 | 1460.9049 | Discouraged |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | 1451.0650 | 1451.0650 | Allowed |
| 7 | 269 | Improper Privilege Management | 1442.4429 | 1442.4429 | Discouraged |
| 8 | 664 | Improper Control of a Resource Through its Lifetime | 1439.6214 | 1439.6214 | Discouraged |
| 9 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | 1433.1308 | 1433.1308 | Allowed |
| 10 | 703 | Improper Check or Handling of Exceptional Conditions | 1411.5106 | 1411.5106 | Discouraged |
| 11 | 410 | Insufficient Resource Pool | 463.6030 | 463.6030 | Allowed |
