# Raw Retriever Results for CVE-2025-22119

# Raw Retriever Results for CVE-2025-22119
## Query
In the Linux kernel, the following vulnerability has been resolved wifi cfg80211 init wiphy_work before allocating rfkill fails syzbort reported a uninitialize wiphy_work_lock in cfg80211_dev_free. [1] After rfkill allocation fails, the wiphy release process will be performed, which will cause cfg80211_dev_free to access the uninitialized wiphy_work related data. Move the initialization of wiphy_work to before rfkill initialization to avoid this issue. [1] INFO trying to register non-static key. The code is fine but needs lockdep annotation, or maybe you didnt initialize this object before use? turning off the locking correctness validator. CPU 0 UID 0 PID 5935 Comm syz-executor550 Not tainted 6.14.0-rc6-syzkaller-00103-g4003c9e78778 #0 Hardware name QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014 Call Trace __dump_stack lib/dump_stack.c94 [inline] dump_stack_lvl+0x116/0x1f0 lib/dump_stack.c120 assign_lock_key kernel/locking/lockdep.c983 [inline] register_lock_class+0xc39/0x1240 kernel/locking/lockdep.c1297 __lock_acquire+0x135/0x3c40 kernel/locking/lockdep.c5103 lock_acquire.part.0+0x11b/0x380 kernel/locking/lockdep.c5851 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h110 [inline] _raw_spin_lock_irqsave+0x3a/0x60 kernel/locking/spinlock.c162 cfg80211_dev_free+0x30/0x3d0 net/wireless/core.c1196 device_release+0xa1/0x240 drivers/base/core.c2568 kobject_cleanup lib/kobject.c689 [inline] kobject_release lib/kobject.c720 [inline] kref_put include/linux/kref.h65 [inline] kobject_put+0x1e4/0x5a0 lib/kobject.c737 put_device+0x1f/0x30 drivers/base/core.c3774 wiphy_free net/wireless/core.c1224 [inline] wiphy_new_nm+0x1c1f/0x2160 net/wireless/core.c562 ieee80211_alloc_hw_nm+0x1b7a/0x2260 net/mac80211/main.c835 mac80211_hwsim_new_radio+0x1d6/0x54e0 drivers/net/wireless/virtual/mac80211_hwsim.c5185 hwsim_new_radio_nl+0xb42/0x12b0 drivers/net/wireless/virtual/mac80211_hwsim.c6242 genl_family_rcv_msg_doit+0x202/0x2f0 net/netlink/genetlink.c1115 genl_family_rcv_msg net/netlink/genetlink.c1195 [inline] genl_rcv_msg+0x565/0x800 net/netlink/genetlink.c1210 netlink_rcv_skb+0x16b/0x440 net/netlink/af_netlink.c2533 genl_rcv+0x28/0x40 net/netlink/genetlink.c1219 netlink_unicast_kernel net/netlink/af_netlink.c1312 [inline] netlink_unicast+0x53c/0x7f0 net/netlink/af_netlink.c1338 netlink_sendmsg+0x8b8/0xd70 net/netlink/af_netlink.c1882 sock_sendmsg_nosec net/socket.c718 [inline] __sock_sendmsg net/socket.c733 [inline] ____sys_sendmsg+0xaaf/0xc90 net/socket.c2573 ___sys_sendmsg+0x135/0x1e0 net/socket.c2627 __sys_sendmsg+0x16e/0x220 net/socket.c2659 do_syscall_x64 arch/x86/entry/common.c52 [inline] do_syscall_64+0xcd/0x250 arch/x86/entry/common.c83 Close https//syzkaller.appspot.com/bug?extid=aaf0488c83d1d5f4f029

## Keyphrases
- **rootcause**: 'uninitialized wiphy_work_lock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5147 | 0.5649 | 0.5330 | 0.5290 | 20 |
| Sparse | 702.4716 | 825.4285 | 747.6209 | 751.3161 | 10 |
| Graph | 1.4170 | 2.8652 | 1.9271 | 1.7693 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 2 | 476 | NULL Pointer Dereference | Base | 2.8382 | Allowed |
| 3 | 123 | Write-what-where Condition | base | 2.4700 | Allowed |
| 4 | 129 | Improper Validation of Array Index | variant | 2.2704 | Allowed |
| 5 | 390 | Detection of Error Condition Without Action | base | 2.2100 | Allowed |
| 6 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.2100 | Allowed |
| 7 | 789 | Memory Allocation with Excessive Size Value | variant | 2.0400 | Allowed |
| 8 | 416 | Use After Free | Variant | 1.8399 | Allowed |
| 9 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 10 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 1.7705 | Allowed-with-Review |
| 11 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 12 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 13 | 415 | Double Free | Variant | 1.6824 | Allowed |
| 14 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6383 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.5649 | 0.5649 | Allowed-with-Review |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5516 | 0.5516 | Allowed-with-Review |
| 3 | 667 | Improper Locking | Class | 0.5492 | 0.5492 | Allowed-with-Review |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5470 | 0.5470 | Allowed |
| 5 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.5442 | 0.5442 | Allowed |
| 6 | 476 | NULL Pointer Dereference | Base | 0.5419 | 0.5419 | Allowed |
| 7 | 908 | Use of Uninitialized Resource | Base | 0.5371 | 0.5371 | Allowed |
| 8 | 413 | Improper Resource Locking | Base | 0.5369 | 0.5369 | Allowed |
| 9 | 121 | Stack-based Buffer Overflow | Variant | 0.5346 | 0.5346 | Allowed |
| 10 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.5291 | 0.5291 | Allowed |
| 11 | 833 | Deadlock | Base | 0.5289 | 0.5289 | Allowed |
| 12 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.5285 | 0.5285 | Allowed |
| 13 | 416 | Use After Free | Variant | 0.5263 | 0.5263 | Allowed |
| 14 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5243 | 0.5243 | Discouraged |
| 15 | 415 | Double Free | Variant | 0.5227 | 0.5227 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 909 | Missing Initialization of Resource | 825.4285 | 825.4285 | Allowed-with-Review |
| 2 | 476 | NULL Pointer Dereference | 782.4234 | 782.4234 | Allowed |
| 3 | 401 | Missing Release of Memory after Effective Lifetime | 769.2664 | 769.2664 | Allowed |
| 4 | 667 | Improper Locking | 765.4962 | 765.4962 | Allowed-with-Review |
| 5 | 415 | Double Free | 759.5198 | 759.5198 | Allowed |
| 6 | 911 | Improper Update of Reference Count | 743.1124 | 743.1124 | Allowed |
| 7 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 716.4473 | 716.4473 | Allowed-with-Review |
| 8 | 674 | Uncontrolled Recursion | 708.7872 | 708.7872 | Allowed-with-Review |
| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 703.2560 | 703.2560 | Discouraged |
| 10 | 502 | Deserialization of Untrusted Data | 702.4716 | 702.4716 | Allowed |
