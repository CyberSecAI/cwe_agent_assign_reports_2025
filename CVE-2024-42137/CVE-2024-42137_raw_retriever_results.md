# Raw Retriever Results for CVE-2024-42137

# Raw Retriever Results for CVE-2024-42137
## Query
In the Linux kernel, the following vulnerability has been resolved Bluetooth qca Fix BT enable failure again for QCA6390 after warm reboot Commit 272970be3dab (Bluetooth hci_qca Fix driver shutdown on closed serdev) will cause below regression issue BT cant be enabled after below steps cold boot -> enable BT -> disable BT -> warm reboot -> BT enable failure if property enable-gpios is not configured within DT|ACPI for QCA6390. The commit is to fix a use-after-free issue within qca_serdev_shutdown() by adding condition to avoid the serdev is flushed or wrote after closed but also introduces this regression issue regarding above steps since the VSC is not sent to reset controller during warm reboot. Fixed by sending the VSC to reset controller within qca_serdev_shutdown() once BT was ever enabled, and the use-after-free issue is also fixed by this change since the serdev is still opened before it is flushed or wrote. Verified by the reported machine Dell XPS 13 9310 laptop over below two kernel commits commit e00fc2700a3f (Bluetooth btusb Fix triggering coredump implementation for QCA) of bluetooth-next tree. commit b23d98d46d28 (Bluetooth btusb Fix triggering coredump implementation for QCA) of linus mainline tree.

## Keyphrases
- **rootcause**: 'missing VSC reset during warm reboot'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4362 | 0.4949 | 0.4568 | 0.4526 | 20 |
| Sparse | 702.0051 | 818.4187 | 744.5070 | 740.9746 | 10 |
| Graph | 1.7680 | 3.3566 | 2.2544 | 2.2100 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 123 | Write-what-where Condition | base | 3.3566 | Allowed |
| 2 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 2.8652 | Allowed-with-Review |
| 3 | 364 | Signal Handler Race Condition | base | 2.8652 | Allowed |
| 4 | 129 | Improper Validation of Array Index | variant | 2.6784 | Allowed |
| 5 | 416 | Use After Free | Variant | 2.4585 | Allowed |
| 6 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | base | 2.2100 | Allowed |
| 7 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | base | 2.2100 | Allowed |
| 8 | 128 | Wrap-around Error | base | 2.2100 | Allowed |
| 9 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.2100 | Allowed |
| 10 | 193 | Off-by-one Error | base | 2.2100 | Allowed |
| 11 | 839 | Numeric Range Comparison Without Minimum Check | base | 2.2100 | Allowed |
| 12 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 2.2100 | Allowed |
| 13 | 613 | Insufficient Session Expiration | base | 2.2100 | Allowed |
| 14 | 456 | Missing Initialization of a Variable | variant | 2.1936 | Allowed |
| 15 | 195 | Signed to Unsigned Conversion Error | variant | 2.0400 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4949 | 0.4949 | Allowed |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4836 | 0.4836 | Allowed-with-Review |
| 3 | 909 | Missing Initialization of Resource | Class | 0.4788 | 0.4788 | Allowed-with-Review |
| 4 | 416 | Use After Free | Variant | 0.4728 | 0.4728 | Allowed |
| 5 | 833 | Deadlock | Base | 0.4716 | 0.4716 | Allowed |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4667 | 0.4667 | Allowed |
| 7 | 908 | Use of Uninitialized Resource | Base | 0.4657 | 0.4657 | Allowed |
| 8 | 20 | Improper Input Validation | Class | 0.4643 | 0.4643 | Discouraged |
| 9 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4568 | 0.4568 | Discouraged |
| 10 | 121 | Stack-based Buffer Overflow | Variant | 0.4550 | 0.4550 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4501 | 0.4501 | Allowed |
| 12 | 787 | Out-of-bounds Write | Base | 0.4490 | 0.4490 | Allowed |
| 13 | 459 | Incomplete Cleanup | Base | 0.4474 | 0.4474 | Allowed |
| 14 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.4446 | 0.4446 | Allowed |
| 15 | 667 | Improper Locking | Class | 0.4440 | 0.4440 | Allowed-with-Review |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 818.4187 | 818.4187 | Allowed-with-Review |
| 2 | 833 | Deadlock | 780.1667 | 780.1667 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 768.0611 | 768.0611 | Allowed-with-Review |
| 4 | 287 | Improper Authentication | 766.9282 | 766.9282 | Discouraged |
| 5 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 756.8818 | 756.8818 | Discouraged |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | 725.0674 | 725.0674 | Allowed |
| 7 | 415 | Double Free | 712.0215 | 712.0215 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | 710.0614 | 710.0614 | Allowed |
| 9 | 863 | Incorrect Authorization | 705.4584 | 705.4584 | Allowed-with-Review |
| 10 | 400 | Uncontrolled Resource Consumption | 702.0051 | 702.0051 | Discouraged |
