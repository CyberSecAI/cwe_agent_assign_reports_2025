# Vulnerability Information: CVE-2024-8624

## Vulnerability Description
The MDTF - Meta Data and Taxonomies Filter plugin for WordPress is vulnerable to SQL Injection via the meta_key attribute of the mdf_select_title shortcode in all versions up to, and including, 1.3.3.3 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Contributor-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **sql injection**
- **impact:** extract sensitive information from the database
- **vector:** meta_key attribute of the mdf_select_title shortcode
- **attacker:** authenticated attackers with Contributor-level access and above
- **product:** MDTF - Meta Data and Taxonomies Filter plugin for WordPress
- **version:** all versions up to and including 1.3.3.3
- **component:** mdf_select_title shortcode

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-8624:

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient escaping of the user-supplied `meta_key` parameter within the 'mdf_select_title' shortcode, coupled with a lack of proper preparation in the existing SQL query within the "MDTF â€“ Meta Data and Taxonomies Filter" WordPress plugin.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The primary vulnerability is a SQL Injection flaw, arising from the direct inclusion of the unescaped `meta_key` parameter within an SQL query.

**Impact of Exploitation:**
- **Sensitive Information Disclosure:** Attackers can exploit the SQL injection to extract sensitive data from the WordPress database.

**Attack Vectors:**
- The vulnerability is triggered through the 'mdf_select_title' shortcode, using the 'meta_key' parameter.

**Required Attacker Capabilities/Position:**
- **Authentication:** Attackers must have at least Contributor-level access to the WordPress site.
- **Ability to use Shortcodes:** Attackers must be able to utilize shortcodes, which is generally available to users with Contributor-level permissions or higher.

**Additional Details:**
- The vulnerable code is located in the `core.php` file of the plugin.
- The vulnerable versions include all versions up to and including 1.3.3.3.
- The patched version is 1.3.3.4
- The fix involved using `$wpdb->prepare` to sanitize the input, preventing the SQL Injection vulnerability by properly escaping the `meta_key` parameter before embedding it in the SQL query.

The Wordfence article provides a good description of the vulnerability and confirms the CVE details. The Trac changeset shows the code change that was made to resolve the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.584 |
| 3 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.556 |
| 4 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.543 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.538 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.530 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.519 |
| 8 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.517 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.501 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |

