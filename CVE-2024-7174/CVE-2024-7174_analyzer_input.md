# Vulnerability Information: CVE-2024-7174

## Vulnerability Description
A vulnerability, which was classified as critical, was found in TOTOLINK A3600R 4.1.2cu.5182_B20201102. This affects the function setdeviceName of the file /cgi-bin/cstecgi.cgi. The manipulation of the argument deviceMac/deviceName leads to **buffer overflow**. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The associated identifier of this vulnerability is VDB-272595. NOTE The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **weakness:** **buffer overflow**
- **product:** TOTOLINK A3600R
- **version:** 4.1.2cu.5182_B20201102
- **component:** /cgi-bin/cstecgi.cgi

## CVE Reference Links Content Summary
The provided content describes a vulnerability in TOTOLINK A3600R router firmware. Here's a breakdown:

**Root cause of vulnerability:**
- The `setDeviceName` function in the A3600R firmware is vulnerable due to insufficient input sanitization. Specifically, the `deviceMac` and `deviceName` parameters received from POST requests are not properly validated before being used in a `system` call, which can execute arbitrary commands.

**Weaknesses/vulnerabilities present:**
- **Buffer Overflow:** The initial description in the VulDB submission mentions a buffer overflow in the `deviceMac` and `deviceName` parameters. The github description focuses more on the Command Injection aspect of the issue.
- **Command Injection:** User-controlled input within the `deviceMac` and `deviceName` parameters is directly passed to the `system` function, allowing for execution of arbitrary commands.

**Impact of exploitation:**
- An attacker can execute arbitrary commands on the router's operating system. This could lead to:
    - Complete compromise of the device.
    - Potential for data theft.
    - Installation of malware.
    - Use of the router in botnet.

**Attack vectors:**
- A crafted POST request to the `/cgi-bin/cstecgi.cgi` endpoint with malicious input in the `deviceName` and `deviceMac` parameters.

**Required attacker capabilities/position:**
- Network access to the vulnerable router.
- The attacker needs to be able to send HTTP POST requests to the router.
- No mention of Authentication in the details, suggesting it might not be required, or it can be bypassed.

**Additional Details:**
- The provided proof-of-concept (POC) code demonstrates how to exploit the command injection vulnerability by including shell commands in the `deviceName` parameter.
- The vulnerability is located in `/cgi-bin/cstecgi.cgi`
- The vulnerable firmware version is A3600R V4.1.2cu.5182\_B20201102.
- The vulnerability is in the `setDeviceName` function.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | alternate_terms | 0.700 |
| 4 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.518 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.499 |
| 6 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.463 |
| 7 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.459 |
| 8 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.449 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.658 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |

