{
  "query": "nimiq/core-rs-albatross is a Rust implementation of the Nimiq Proof-of-Stake protocol based on the Albatross consensus algorithm. The `nimiq-network-libp2p` subcrate of nimiq/core-rs-albatross is vulnerable to a Denial of Service (DoS) attack due to uncontrolled memory allocation. Specifically, the implementation of the `Discovery` network message handling allocates a buffer based on a length value provided by the peer, without enforcing an upper bound. Since this length is a `u32`, a peer can trigger allocations of up to 4 GB, potentially leading to memory exhaustion and node crashes. As Discovery messages are regularly exchanged for peer discovery, this vulnerability can be exploited repeatedly. The patch for this vulnerability is formally released as part of v1.1.0. The patch implements a limit to the discovery message size of 1 MB and also resizes the message buffer size incrementally as the data is read. No known workarounds are available.",
  "count": 20,
  "results": [
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "abstraction": "Base",
      "score": 0.525340781731807,
      "original_score": 0.525340781731807,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1325",
      "name": "Improperly Controlled Sequential Memory Allocation",
      "abstraction": "Base",
      "score": 0.5177508167911333,
      "original_score": 0.5177508167911333,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "789",
      "name": "Memory Allocation with Excessive Size Value",
      "abstraction": "Variant",
      "score": 0.5147210463128229,
      "original_score": 0.5147210463128229,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "abstraction": "Variant",
      "score": 0.49807547322371576,
      "original_score": 0.49807547322371576,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "abstraction": "Base",
      "score": 0.4843460443170123,
      "original_score": 0.4843460443170123,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "126",
      "name": "Buffer Over-read",
      "abstraction": "Variant",
      "score": 0.4728729385163189,
      "original_score": 0.4728729385163189,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "121",
      "name": "Stack-based Buffer Overflow",
      "abstraction": "Variant",
      "score": 0.46431151322333764,
      "original_score": 0.46431151322333764,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "131",
      "name": "Incorrect Calculation of Buffer Size",
      "abstraction": "Base",
      "score": 0.46192927882248813,
      "original_score": 0.46192927882248813,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "835",
      "name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
      "abstraction": "Base",
      "score": 0.4608376817994041,
      "original_score": 0.4608376817994041,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1285",
      "name": "Improper Validation of Specified Index, Position, or Offset in Input",
      "abstraction": "Base",
      "score": 0.4603337131175022,
      "original_score": 0.4603337131175022,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "407",
      "name": "Inefficient Algorithmic Complexity",
      "abstraction": "Class",
      "score": 0.4543051318374943,
      "original_score": 0.4543051318374943,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "400",
      "name": "Uncontrolled Resource Consumption",
      "abstraction": "Class",
      "score": 0.4536027668335502,
      "original_score": 0.4536027668335502,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "409",
      "name": "Improper Handling of Highly Compressed Data (Data Amplification)",
      "abstraction": "Base",
      "score": 0.4528051640436497,
      "original_score": 0.4528051640436497,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1333",
      "name": "Inefficient Regular Expression Complexity",
      "abstraction": "Base",
      "score": 0.4500352360037192,
      "original_score": 0.4500352360037192,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "190",
      "name": "Integer Overflow or Wraparound",
      "abstraction": "Base",
      "score": 0.44949330080652883,
      "original_score": 0.44949330080652883,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "674",
      "name": "Uncontrolled Recursion",
      "abstraction": "Class",
      "score": 0.4484283685731403,
      "original_score": 0.4484283685731403,
      "mapping_usage": "Allowed-with-Review"
    },
    {
      "cwe_id": "617",
      "name": "Reachable Assertion",
      "abstraction": "Base",
      "score": 0.44837256369491774,
      "original_score": 0.44837256369491774,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "1331",
      "name": "Improper Isolation of Shared Resources in Network On Chip (NoC)",
      "abstraction": "Base",
      "score": 0.44771758282424057,
      "original_score": 0.44771758282424057,
      "mapping_usage": "Allowed"
    },
    {
      "cwe_id": "119",
      "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
      "abstraction": "Class",
      "score": 0.44659785452040013,
      "original_score": 0.44659785452040013,
      "mapping_usage": "Discouraged"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "abstraction": "Class",
      "score": 0.4463409209558298,
      "original_score": 0.4463409209558298,
      "mapping_usage": "Allowed-with-Review"
    }
  ],
  "statistics": {
    "min": 0.4463409209558298,
    "max": 0.525340781731807,
    "mean": 0.46791090889745063,
    "median": 0.45731942247749824,
    "count": 20
  }
}