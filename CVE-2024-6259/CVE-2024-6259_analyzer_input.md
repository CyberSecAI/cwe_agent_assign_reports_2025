# Vulnerability Information: CVE-2024-6259

## Vulnerability Description
BT HCI adv_ext_report **Improper discarding** in adv_ext_report

### Vulnerability Description Key Phrases
- **rootcause:** **Improper discarding**
- **product:** BT HCI
- **component:** adv_ext_report

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: An improper discarding routine in `bt_hci_le_adv_ext_report` within `/subsys/bluetooth/host/scan.c` leads to a heap overflow. Specifically, the `net_buf_pull` function is used without checking if sufficient data remains in the buffer.
- **Weaknesses/vulnerabilities present**:
    - Heap overflow due to missing length check before pulling data from a buffer.
    - Improper handling of buffer length.
    - Underwrap of the buffer length.
- **Impact of exploitation**: Exploitation could lead to instability (i.e., crash) or denial of service attacks.
- **Attack vectors**: Adjacent network.
- **Required attacker capabilities/position**: Attacker needs to be in an adjacent network to exploit the vulnerability by sending a crafted Bluetooth advertising report. No specific user interaction is required. The attacker does not require any privileges.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 617 | Reachable Assertion | Base | Allowed | sparse | 0.047 |
| 2 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.039 |
| 3 | 415 | Double Free | Variant | Allowed | sparse | 0.035 |
| 4 | 413 | Improper Resource Locking | Base | Allowed | sparse | 0.034 |
| 5 | 836 | Use of Password Hash Instead of Password for Authentication | Base | Allowed | sparse | 0.032 |
| 6 | 694 | Use of Multiple Resources with Duplicate Identifier | Base | Allowed | sparse | 0.030 |
| 7 | 922 | Insecure Storage of Sensitive Information | Class | Allowed-with-Review | sparse | 0.029 |
| 8 | 833 | Deadlock | Base | Allowed | sparse | 0.028 |
| 9 | 1422 | Exposure of Sensitive Information caused by Incorrect Data Forwarding during Transient Execution | Base | Allowed | dense | 0.409 |
| 10 | 805 | Buffer Access with Incorrect Length Value | Base | Allowed | graph | 0.003 |

