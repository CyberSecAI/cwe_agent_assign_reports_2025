## Vulnerability Description
The Youzify - BuddyPress Community, User Profile, Social Network & Membership Plugin for WordPress plugin for WordPress is vulnerable to SQL Injection via the order_by shortcode attribute in all versions up to, and including, 1.2.5 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Contributor-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **SQL injection**
- **impact:** extract sensitive information from the database
- **attacker:** authenticated attackers
- **product:** Youzify - BuddyPress Community and User Profile and Social Network & Membership Plugin for WordPress
- **version:** all versions up to and including 1.2.5
- **component:** order_by shortcode attribute

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-4742:

**Root Cause of Vulnerability:**
- The vulnerability is due to insufficient escaping of user-supplied input in the `order_by` shortcode attribute within the Youzify plugin. Specifically, the plugin fails to properly sanitize this parameter before using it in a SQL query. This allows an attacker to inject arbitrary SQL code.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The primary vulnerability is SQL Injection, caused by the lack of proper input sanitization and preparation of SQL queries. The `order_by` attribute is directly incorporated into the SQL query without proper escaping or sanitization, allowing for SQL injection.

**Impact of Exploitation:**
- An attacker can execute arbitrary SQL queries, potentially leading to:
  - **Data Extraction:** The attacker can extract sensitive information from the database, including user credentials, personal data, and other confidential information.
  - **Data Manipulation:** An attacker might modify data, delete records, or add malicious content to the database.
  - **Loss of Confidentiality, Integrity and Availability:** As indicated by the CVSS score of 9.8, this vulnerability allows for a complete loss of these three security pillars.

**Attack Vectors:**
- The attack vector is through the `order_by` shortcode attribute of the `youzify_verified_users` shortcode. This means that anywhere this shortcode is utilized, an attacker can potentially exploit the vulnerability.
- The attacker must be able to use the shortcode.

**Required Attacker Capabilities/Position:**
- **Authenticated Access:** The attacker needs to have at least "Contributor" level access to the WordPress site. This is not a privilege escalation vulnerability. Any logged-in user with this level of access or greater can exploit the vulnerability.
- **Shortcode Usage:** The attacker needs to be able to insert and utilize the vulnerable shortcode (i.e. youzify_verified_users) on the site.

**Additional Notes:**
- The Wordfence article notes that the vulnerability was found by Peter Thaleikis.
- The vulnerability affects all versions of the Youzify plugin up to and including 1.2.5. It has been patched in version 1.2.6.
- The provided code snippet from `youzify-account-verification-functions.php` does not contain the vulnerable code. It provides account verification functions, but the SQL injection vulnerability exists in the `youzify_verified_users_shortcode` function.
- The `order_by` parameter in shortcode is used in the SQL query without proper sanitization, which leads to SQL injection vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.583 |
| 3 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.555 |
| 4 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.552 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.545 |
| 6 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.526 |
| 7 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.523 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.514 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.454 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-863: Incorrect Authorization

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-862: Missing Authorization

CWE-502: Deserialization of Untrusted Data

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')

CWE-613: Insufficient Session Expiration