## Vulnerability Description
Applio is a voice conversion tool. Versions 3.2.8-bugfix and prior are vulnerable to arbitrary file write in train.py. This issue may lead to writing arbitrary files on the Applio server. It can also be used in conjunction with an unsafe deserialization to achieve remote code execution. As of time of publication, no known patches are available.

### Vulnerability Description Key Phrases
- **component:** train.py
- **weakness:** **unsafe deserialization, arbitrary file write**
- **product:** Applio
- **impact:** remote code execution
- **version:** 3.2.8-bugfix and prior

## CVE Reference Links Content Summary
```
* **Root cause of vulnerability:**
    * The vulnerability is within the `Applio` project.
    * The code takes user-supplied input in `folder_name_input` and files in `bin_file_upload`, `config_file_upload` and passes that input to `create_folder_and_move_files` function. `folder_name_input` is used to construct a path on [line 295](https://github.com/IAHispano/Applio/blob/d7d685fefd0c58e29e1d84d668613056791544a7/tabs/inference/inference.py#L295) and then copy the uploaded files. There is no check if the file is copied the expected, static `custom_embedder_root` path.
* **Weaknesses/vulnerabilities present:**
    * Arbitrary file write
* **Impact of exploitation:**
    * Writing arbitrary files on the applio server. It can also be used in conjunction with any of the unsafe deserialisations to achieve remote code execution.
* **Attack vectors:**
    * Exploitation involves providing crafted input for the `folder_name_input` parameter.
* **Required attacker capabilities/position:**
    * The user running the application has write access to a given path.
* **Mitigation or fix:**
    * Not provided
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.372 |
| 2 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.313 |
| 3 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.310 |
| 4 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.310 |
| 5 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.309 |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | Allowed | sparse | 0.309 |
| 7 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.302 |
| 8 | 732 | Incorrect Permission Assignment for Critical Resource | Class | Allowed-with-Review | sparse | 0.300 |
| 9 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | dense | 0.513 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-502: Deserialization of Untrusted Data

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-918: Server-Side Request Forgery (SSRF)

CWE-23: Relative Path Traversal

CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')

CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition

CWE-61: UNIX Symbolic Link (Symlink) Following

CWE-732: Incorrect Permission Assignment for Critical Resource

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')