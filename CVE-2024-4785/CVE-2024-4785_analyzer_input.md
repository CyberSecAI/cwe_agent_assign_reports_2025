# Vulnerability Information: CVE-2024-4785

## Vulnerability Description
BT **Missing Check** in LL_CONNECTION_UPDATE_IND Packet Leads to Division by Zero

### Vulnerability Description Key Phrases
- **rootcause:** **Missing Check**
- **weakness:** **division by zero**
- **component:** LL_CONNECTION_UPDATE_IND Packet

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** The vulnerability stems from a missing validation check in the `llcp_pdu_decode_conn_update_ind` function within the Zephyr Bluetooth controller. This function decodes the `LL_CONNECTION_UPDATE_IND` packet, but fails to validate if the `Interval` field is zero before using it.
- **Weaknesses/vulnerabilities present:**
    - **CWE-20:** Improper Input Validation. The system fails to validate the received connection interval value.
    - **CWE-369:** Division by Zero. The lack of validation leads to a division by zero error.
- **Impact of exploitation:** A malicious BLE device can send a crafted `LL_CONNECTION_UPDATE_IND` packet with the `Interval` field set to zero. When the peripheral (victim) processes this packet, it leads to a division-by-zero error during the connection parameter update process, resulting in a crash of the BLE controller. This denial-of-service can disrupt the device's normal operations and potentially brick the device, requiring a reset.
- **Attack vectors:** The attack vector is adjacent. An attacker needs to be within Bluetooth range of the vulnerable device to send the malicious BLE packet.
- **Required attacker capabilities/position:** The attacker needs to be a malicious BLE device capable of sending crafted `LL_CONNECTION_UPDATE_IND` packets, and be within the Bluetooth communication range. No prior authentication or privileges are needed. The attacker only needs to be able to send the malicious packet when the peripheral device is in a specific state. Specifically, when the peripheral is processing a Central-initiated Connection Parameters Request.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 194 | Unexpected Sign Extension | Variant | Allowed | sparse | 0.085 |
| 2 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.084 |
| 3 | 369 | Divide By Zero | Base | Allowed | sparse | 0.082 |
| 4 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.080 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.078 |
| 6 | 1335 | Incorrect Bitwise Shift of Integer | Base | Allowed | sparse | 0.077 |
| 7 | 824 | Access of Uninitialized Pointer | Base | Allowed | sparse | 0.076 |
| 8 | 394 | Unexpected Status Code or Return Value | Base | Allowed | sparse | 0.076 |
| 9 | 606 | Unchecked Input for Loop Condition | Base | Allowed | dense | 0.484 |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | graph | 0.002 |

