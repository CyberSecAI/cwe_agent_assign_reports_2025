# Raw Retriever Results for CVE-2024-40627

# Raw Retriever Results for CVE-2024-40627
## Query
Fastapi OPA is an opensource fastapi middleware which includes auth flow. HTTP `OPTIONS` requests are always allowed by `OpaMiddleware`, even when they lack authentication, and are passed through directly to the application. `OpaMiddleware` allows all HTTP `OPTIONS` requests without evaluating it against any policy. If an application provides different responses to HTTP `OPTIONS` requests based on an entity existing (such as to indicate whether an entity is writable on a system level), an unauthenticated attacker could discover which entities exist within an application. This issue has been addressed in release version 2.0.1. All users are advised to upgrade. There are no known workarounds for this vulnerability.

## Keyphrases
- **weakness**: 'allow unauthenticated OPTIONS requests'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3736 | 0.4091 | 0.3891 | 0.3874 | 20 |
| Sparse | 166.4921 | 528.3131 | 463.8874 | 486.3802 | 11 |
| Graph | 1.0062 | 2.2100 | 1.4648 | 1.4844 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 2 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 4 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 1.6653 | Allowed |
| 5 | 305 | Authentication Bypass by Primary Weakness | Base | 1.6568 | Allowed |
| 6 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6555 | Allowed |
| 7 | 306 | Missing Authentication for Critical Function | Base | 1.6123 | Allowed |
| 8 | 204 | Observable Response Discrepancy | Base | 1.5778 | Allowed |
| 9 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 10 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |
| 11 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 1.4478 | Allowed |
| 12 | 322 | Key Exchange without Entity Authentication | base | 1.3572 | Allowed |
| 13 | 942 | Permissive Cross-domain Policy with Untrusted Domains | variant | 1.2864 | Allowed |
| 14 | 350 | Reliance on Reverse DNS Resolution for a Security-Critical Action | variant | 1.1587 | Allowed |
| 15 | 1295 | Debug Messages Revealing Unnecessary Information | base | 1.1466 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 303 | Incorrect Implementation of Authentication Algorithm | Base | 0.4091 | 0.4091 | Allowed |
| 2 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | 0.4061 | 0.4061 | Allowed |
| 3 | 204 | Observable Response Discrepancy | Base | 0.4037 | 0.4037 | Allowed |
| 4 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.4020 | 0.4020 | Allowed |
| 5 | 305 | Authentication Bypass by Primary Weakness | Base | 0.4015 | 0.4015 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.3987 | 0.3987 | Allowed |
| 7 | 306 | Missing Authentication for Critical Function | Base | 0.3969 | 0.3969 | Allowed |
| 8 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.3962 | 0.3962 | Allowed |
| 9 | 1385 | Missing Origin Validation in WebSockets | Variant | 0.3937 | 0.3937 | Allowed |
| 10 | 863 | Incorrect Authorization | Class | 0.3931 | 0.3931 | Allowed-with-Review |
| 11 | 639 | Authorization Bypass Through User-Controlled Key | Base | 0.3817 | 0.3817 | Allowed |
| 12 | 294 | Authentication Bypass by Capture-replay | Base | 0.3815 | 0.3815 | Allowed |
| 13 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | 0.3808 | 0.3808 | Allowed |
| 14 | 285 | Improper Authorization | Class | 0.3804 | 0.3804 | Discouraged |
| 15 | 346 | Origin Validation Error | Class | 0.3788 | 0.3788 | Allowed-with-Review |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 863 | Incorrect Authorization | 528.3131 | 528.3131 | Allowed-with-Review |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | 502.6955 | 502.6955 | Allowed |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | 500.5922 | 500.5922 | Allowed |
| 4 | 1390 | Weak Authentication | 494.3417 | 494.3417 | Allowed-with-Review |
| 5 | 306 | Missing Authentication for Critical Function | 492.9024 | 492.9024 | Allowed |
| 6 | 204 | Observable Response Discrepancy | 486.3802 | 486.3802 | Allowed |
| 7 | 918 | Server-Side Request Forgery (SSRF) | 483.2556 | 483.2556 | Allowed |
| 8 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 483.1703 | 483.1703 | Allowed |
| 9 | 203 | Observable Discrepancy | 482.4513 | 482.4513 | Allowed |
| 10 | 138 | Improper Neutralization of Special Elements | 482.1675 | 482.1675 | Discouraged |
| 11 | 285 | Improper Authorization | 166.4921 | 166.4921 | Discouraged |
