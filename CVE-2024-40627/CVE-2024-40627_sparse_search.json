{
  "retriever": "sparse",
  "query": "Fastapi OPA is an opensource fastapi middleware which includes auth flow. HTTP `OPTIONS` requests are always allowed by `OpaMiddleware`, even when they lack authentication, and are passed through directly to the application. `OpaMiddleware` allows all HTTP `OPTIONS` requests without evaluating it against any policy. If an application provides different responses to HTTP `OPTIONS` requests based on an entity existing (such as to indicate whether an entity is writable on a system level), an unauthenticated attacker could discover which entities exist within an application. This issue has been addressed in release version 2.0.1. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
  "keyphrases": {
    "weakness": [
      "allow unauthenticated OPTIONS requests"
    ]
  },
  "timestamp": "2025-07-12 03:13:03",
  "cve_id": "CVE-2024-40627",
  "result_count": 11,
  "results": [
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 528.313148992482,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "201",
      "name": "Insertion of Sensitive Information Into Sent Data",
      "score": 502.6955169667332,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "score": 500.59215386783353,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "1390",
      "name": "Weak Authentication",
      "score": 494.34165747220135,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "306",
      "name": "Missing Authentication for Critical Function",
      "score": 492.9024085098681,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "204",
      "name": "Observable Response Discrepancy",
      "score": 486.3802474092505,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "918",
      "name": "Server-Side Request Forgery (SSRF)",
      "score": 483.2555779622605,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "88",
      "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')",
      "score": 483.17032529359244,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "203",
      "name": "Observable Discrepancy",
      "score": 482.45131416678294,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "138",
      "name": "Improper Neutralization of Special Elements",
      "score": 482.16745955040346,
      "search_source": "weakness:allow unauthenticated OPTIONS requests"
    },
    {
      "cwe_id": "285",
      "name": "Improper Authorization",
      "score": 166.4920783165604,
      "search_source": "base_query"
    }
  ]
}