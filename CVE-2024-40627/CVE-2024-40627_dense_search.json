{
  "retriever": "dense",
  "query": "Fastapi OPA is an opensource fastapi middleware which includes auth flow. HTTP `OPTIONS` requests are always allowed by `OpaMiddleware`, even when they lack authentication, and are passed through directly to the application. `OpaMiddleware` allows all HTTP `OPTIONS` requests without evaluating it against any policy. If an application provides different responses to HTTP `OPTIONS` requests based on an entity existing (such as to indicate whether an entity is writable on a system level), an unauthenticated attacker could discover which entities exist within an application. This issue has been addressed in release version 2.0.1. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
  "keyphrases": {
    "weakness": [
      "allow unauthenticated OPTIONS requests"
    ]
  },
  "timestamp": "2025-07-12 03:13:02",
  "cve_id": "CVE-2024-40627",
  "result_count": 20,
  "results": [
    {
      "cwe_id": "303",
      "name": "Incorrect Implementation of Authentication Algorithm",
      "type": "Base",
      "score": 0.40905945984998754
    },
    {
      "cwe_id": "650",
      "name": "Trusting HTTP Permission Methods on the Server Side",
      "type": "Variant",
      "score": 0.40607061939955036
    },
    {
      "cwe_id": "204",
      "name": "Observable Response Discrepancy",
      "type": "Base",
      "score": 0.4037180788175218
    },
    {
      "cwe_id": "444",
      "name": "Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')",
      "type": "Base",
      "score": 0.401971970566879
    },
    {
      "cwe_id": "305",
      "name": "Authentication Bypass by Primary Weakness",
      "type": "Base",
      "score": 0.4014952022652384
    },
    {
      "cwe_id": "770",
      "name": "Allocation of Resources Without Limits or Throttling",
      "type": "Base",
      "score": 0.39870728133940603
    },
    {
      "cwe_id": "306",
      "name": "Missing Authentication for Critical Function",
      "type": "Base",
      "score": 0.3968823412574632
    },
    {
      "cwe_id": "918",
      "name": "Server-Side Request Forgery (SSRF)",
      "type": "Base",
      "score": 0.3961979069052799
    },
    {
      "cwe_id": "1385",
      "name": "Missing Origin Validation in WebSockets",
      "type": "Variant",
      "score": 0.3936731101943035
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "type": "Class",
      "score": 0.39306360661542467
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "type": "Base",
      "score": 0.38168983558001957
    },
    {
      "cwe_id": "294",
      "name": "Authentication Bypass by Capture-replay",
      "type": "Base",
      "score": 0.38153017755231333
    },
    {
      "cwe_id": "288",
      "name": "Authentication Bypass Using an Alternate Path or Channel",
      "type": "Base",
      "score": 0.38083810729516504
    },
    {
      "cwe_id": "285",
      "name": "Improper Authorization",
      "type": "Class",
      "score": 0.38043348761508905
    },
    {
      "cwe_id": "346",
      "name": "Origin Validation Error",
      "type": "Class",
      "score": 0.37881003570654814
    },
    {
      "cwe_id": "939",
      "name": "Improper Authorization in Handler for Custom URL Scheme",
      "type": "Base",
      "score": 0.3768788433886021
    },
    {
      "cwe_id": "290",
      "name": "Authentication Bypass by Spoofing",
      "type": "Base",
      "score": 0.37640405333548776
    },
    {
      "cwe_id": "1390",
      "name": "Weak Authentication",
      "type": "Class",
      "score": 0.375994403670735
    },
    {
      "cwe_id": "208",
      "name": "Observable Timing Discrepancy",
      "type": "Base",
      "score": 0.37527606537165037
    },
    {
      "cwe_id": "287",
      "name": "Improper Authentication",
      "type": "Class",
      "score": 0.37356731035538604
    }
  ]
}