## Vulnerability Description
Lobe Chat is an open-source LLMs/AI chat framework. In affected versions if an attacker can successfully authenticate through SSO/Access Code, they can obtain the real backend API Key by modifying the base URL to their own attack URL on the frontend and setting up a server-side request. This issue has been addressed in version 0.162.25. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **impact:** obtain the real backend API Key
- **vector:** modifying the base URL to their own attack URL on the frontend and setting up a server-side request
- **attacker:** attacker
- **product:** Lobe Chat
- **version:** before 0.162.25

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The vulnerability stems from the ability to modify the base URL in the frontend and configure requests to be made server-side, without a proper outbound traffic whitelist. This allows an attacker to redirect requests containing sensitive API keys to their own server.
- **Weaknesses/vulnerabilities present**:
    - Lack of outbound traffic whitelisting, allowing requests to be sent to arbitrary URLs.
    - Insecure configuration allowing the frontend to modify the base URL.
    - API key exposed in request headers.
- **Impact of exploitation**: An attacker can obtain the backend API key, which could potentially allow them to perform unauthorized actions on the server side or access sensitive data.
- **Attack vectors**:
    - The attacker must have network access to the application and be able to make requests to it.
    - The attacker also needs to successfully authenticate via SSO or Access Code.
- **Required attacker capabilities/position**:
    - Network access to the LobeChat instance.
    - Valid user credentials that allow authentication via SSO or Access Code.
    - Ability to modify settings in the frontend to point the base URL to an attacker-controlled server.
    - Ability to receive and inspect HTTP request headers at the attacker-controlled server.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.143 |
| 2 | 1390 | Weak Authentication | Class | Allowed-with-Review | sparse | 0.140 |
| 3 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.133 |
| 4 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.131 |
| 5 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.131 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.128 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.126 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.126 |
| 9 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | dense | 0.485 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-1390: Weak Authentication

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-918: Server-Side Request Forgery (SSRF)

CWE-287: Improper Authentication

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-306: Missing Authentication for Critical Function

CWE-138: Improper Neutralization of Special Elements

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-613: Insufficient Session Expiration