# Vulnerability Information: CVE-2024-47546

## Vulnerability Description
GStreamer is a library for constructing graphs of media-handling components. An **integer underflow** has been detected in extract_cc_from_data function within qtdemux.c. In the FOURCC_c708 case, the subtraction atom_length - 8 may result in an underflow if atom_length is less than 8. When that subtraction underflows, *cclen ends up being a large number, and then cclen is passed to g_memdup2 leading to an out-of-bounds (OOB) read. This vulnerability is fixed in 1.24.10.

### Vulnerability Description Key Phrases
- **weakness:** **integer underflow**
- **impact:** out-of-bounds (OOB) read
- **product:** GStreamer
- **version:** prior to 1.24.10
- **component:** extract_cc_from_data function within qtdemux.c

## CVE Reference Links Content Summary
```
{
  "CVE-2024-47546": {
    "description": "Integer underflow in MP4/MOV demuxer that can lead to out-of-bounds reads.",
    "root_cause": "An integer underflow vulnerability exists in the `extract_cc_from_data` function within `qtdemux.c`. Specifically, when processing CEA708 closed caption data (`FOURCC_c708`), the code calculates the data length by subtracting 8 from the atom length (`atom_length - 8`). If `atom_length` is less than 8, this operation underflows, resulting in a large positive value for `*cclen`.",
    "vulnerabilities": [
      "Integer underflow",
      "Out-of-bounds read"
    ],
    "impact": "The integer underflow leads to an out-of-bounds read when `g_memdup2` is called with the underflowed size. This can result in reading up to 4GB of process memory, potentially causing a segmentation fault (SEGV) and application crash.",
    "attack_vectors": [
      "Maliciously crafted MP4/MOV files containing CEA708 closed caption data with a small `atom_length` value"
    ],
    "required_capabilities": "The attacker needs to provide a specially crafted MP4/MOV file that triggers the integer underflow in the `extract_cc_from_data` function."
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 191 | Integer Underflow (Wrap or Wraparound) | Base | Allowed | alternate_terms | 1.000 |
| 2 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.417 |
| 3 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.407 |
| 4 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.397 |
| 5 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | sparse | 0.390 |
| 6 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.382 |
| 7 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.375 |
| 8 | 124 | Buffer Underwrite ('Buffer Underflow') | Base | Allowed | sparse | 0.371 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.486 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.002 |

