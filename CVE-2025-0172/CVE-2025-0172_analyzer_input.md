# Vulnerability Information: CVE-2025-0172

## Vulnerability Description
A vulnerability has been found in code-projects Chat System 1.0 and classified as critical. Affected by this vulnerability is an unknown functionality of the file /admin/deleteroom.php. The manipulation of the argument id leads to **sql injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **product:** code-projects Chat System
- **version:** 1.0
- **component:** /admin/deleteroom.php

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-89

#### Top CWEs
- CWE-89 (Count: 94)
- CWE-74 (Count: 29)
- CWE-79 (Count: 26)

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
The root cause is the lack of proper sanitization or parameterization of the `id` parameter in the `/admin/deleteroom.php` script. This allows an attacker to inject malicious SQL code directly into the database query.

**Weaknesses/vulnerabilities present:**
- **SQL Injection:** The primary vulnerability is SQL injection, where untrusted user input is directly incorporated into SQL queries. Specifically a Time-Based Blind SQL Injection is possible.
- **Lack of Input Sanitization:** The code fails to sanitize or validate the `id` parameter received through the `$_POST` array.

**Impact of exploitation:**
- **Database Manipulation:** An attacker can use SQL injection to modify or delete data in the database (as the provided code already does).
- **Information Disclosure:** Using time-based SQL injection, an attacker can infer information from the database by causing delays in the response. This can be used to extract sensitive information.
- **Potential for Further Attacks:** Successful SQL injection may serve as a stepping stone for more severe attacks, such as privilege escalation or complete system compromise.

**Attack vectors:**
- **HTTP POST Request:** The attack vector is through an HTTP POST request to `/admin/deleteroom.php`, with a maliciously crafted `id` parameter.

**Required attacker capabilities/position:**
- **Network Access:** The attacker needs network access to the web server hosting the vulnerable application.
- **Knowledge of Vulnerable Endpoint:** The attacker needs to know the vulnerable endpoint `/admin/deleteroom.php` and that the `id` parameter is vulnerable.
- **HTTP Request Manipulation:** The attacker needs the ability to craft and send HTTP POST requests.

**Technical Details:**
- The vulnerable code is within `/admin/deleteroom.php`:
```php
<?php
	include('../conn.php');

	if (isset($_POST['del'])){
		$id=$_POST['id'];

		mysqli_query($conn,"delete from `chatroom` where chatroomid='$id'");
		mysqli_query($conn,"delete from `chat` where chatroomid='$id'");
		mysqli_query($conn,"delete from `chat_member` where chatroomid='$id'");
	}
?>
```
- The provided proof of concept (POC) demonstrates a time-based blind SQL injection using `sleep(5)`:
```
POST /admin/deleteroom.php HTTP/1.1
Host: 127.0.0.1:7777
...
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
...
Content-Length: 24
...

id=4' or sleep(5)#&del=1
```
- This injected payload will cause a 5-second delay in the MySQL query execution, multiplied by the 3 `delete` queries being executed. There is also an additional delay from the webserver, leading to a ~30 second total delay, confirming the presence of the SQL injection vulnerability.

The provided information is more detailed than what is usually in a CVE description, and includes a code snippet, a full proof of concept, and also provides the context of the vulnerable application.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.429 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.369 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.350 |
| 5 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.342 |
| 6 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.342 |
| 7 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.337 |
| 8 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.331 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.583 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

