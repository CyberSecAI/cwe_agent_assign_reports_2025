## Vulnerability Description
A vulnerability, which was classified as critical, was found in rizinorg rizin up to 0.8.0. This affects the function rz_utf8_encode in the library /librz/util/utf8.c. The manipulation leads to **heap-based buffer overflow**. An attack has to be approached locally. The exploit has been disclosed to the public and may be used. It is recommended to apply a patch to fix this issue.

### Vulnerability Description Key Phrases
- **weakness:** **heap-based buffer overflow**
- **product:** rizinorg rizin
- **version:** up to 0.8.0
- **component:** rz_utf8_encode function in /librz/util/utf8.c

## CVE Reference Links Content Summary
CVE-2025-1788: PLACEHOLDER - Implement CVE description retrieval

The provided content details a heap-buffer-overflow vulnerability in the rizin disassembler (CVE-2025-1788 is referenced as being closed by pull request #4919). Here's a breakdown of the information:

*   **Root cause:** The vulnerability is a heap-buffer-overflow occurring in the `rz_utf8_encode` function within `librz/util/utf8.c`.
*   **Weaknesses/vulnerabilities present:** Heap-buffer-overflow.
*   **Impact of exploitation:** Segment fault, leading to a crash.
*   **Attack vectors:** Running `rz-bin -z -N":<dH" $poc` with a specially crafted input file (`rz-bin-poc-01.zip`).
*   **Required attacker capabilities/position:** An attacker needs to be able to execute commands on the system and provide a malicious input file.
*   **Mitigation or fix:** The issue was addressed and closed by pull request #4919. The pull request description indicates a significant refactoring of string, regex, and byte search functionality, including fixes for the heap-buffer-overflow.

The content provides more detail than a typical CVE description, including the specific function involved, the command-line arguments to trigger the vulnerability, and the stack trace from the AddressSanitizer (ASan).

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.438 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.424 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.417 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.406 |
| 7 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.406 |
| 8 | 197 | Numeric Truncation Error | Base | Allowed | sparse | 0.403 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.578 |
| 10 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer

CWE-190: Integer Overflow or Wraparound

CWE-125: Out-of-bounds Read

CWE-122: Heap-based Buffer Overflow

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-193: Off-by-one Error

CWE-197: Numeric Truncation Error

CWE-121: Stack-based Buffer Overflow

CWE-128: Wrap-around Error