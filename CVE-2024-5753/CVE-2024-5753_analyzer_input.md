# Vulnerability Information: CVE-2024-5753

## Vulnerability Description
vanna-ai/vanna version v0.3.4 is vulnerable to **SQL injection** in some file-critical functions such as `pg_read_file()`. This vulnerability allows unauthenticated remote users to read arbitrary local files on the victim server, including sensitive files like `/etc/passwd`, by exploiting the exposed SQL queries via a Python Flask API.

### Vulnerability Description Key Phrases
- **weakness:** **SQL injection**
- **impact:** read arbitrary local files
- **attacker:** unauthenticated remote users
- **product:** vanna-ai/vanna
- **version:** v0.3.4
- **component:** pg_read_file()

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.246 |
| 3 | 74 | Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection') | Class | Discouraged | sparse | 0.232 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.228 |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.224 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.222 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.222 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.220 |
| 9 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | dense | 0.555 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |

