## Vulnerability Description
Zabbix allows to configure SMS notifications. AT **command injection** occurs on Zabbix Server because there is **no validation of Number field** on Web nor on Zabbix server side. Attacker can run test of SMS providing specially crafted phone number and execute additional AT commands on modem.

### Vulnerability Description Key Phrases
- **rootcause:** **no validation of Number field**
- **weakness:** **command injection**
- **impact:** execute AT commands
- **vector:** specially crafted phone number
- **attacker:** attacker
- **product:** Zabbix Server

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from a lack of input validation on the "Number" field used for configuring SMS notifications within Zabbix. Specifically, neither the web frontend nor the Zabbix server validate this field, allowing for the injection of arbitrary AT commands.

**Weaknesses/Vulnerabilities:**
- **Command Injection (CWE-77):** Malicious AT commands can be injected into the "Number" field.
- The lack of input validation allows for the injection of special elements used in a command

**Impact of Exploitation:**
- **AT Command Injection:** An attacker can execute arbitrary AT commands on the GSM modem connected to the Zabbix server.
- **Varying Impact:** The impact varies depending on the modem's manufacturer and capabilities.
- **Potentially Severe:** In a worst-case scenario, a modem may allow for FTP connections, which could be exploited to update the modem's firmware. This could lead to remote code execution (RCE), Server-Side Request Forgery (SSRF), etc.

**Attack Vectors:**
- The attacker crafts a specially crafted phone number containing malicious AT commands.
- The attacker uses the Zabbix web frontend or possibly a direct request to the Zabbix server to submit the crafted number when testing SMS notifications.
- The injected AT commands are then executed on the GSM modem when the Zabbix server sends an SMS test using this number.

**Required Attacker Capabilities/Position:**
- The attacker needs to have access to the Zabbix web interface or be able to communicate directly with the Zabbix server.
- The attacker requires the ability to configure SMS notifications within Zabbix and to provide a custom phone number for SMS testing.
- The attacker would likely need some knowledge of AT commands.

**Additional Details:**
- **CVSS Score:** 3.0 (Low Severity)
- **CVSS Vector:** AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:L/A:N (Network access, High attack complexity, High privileges, No user interaction required, Scope changed, No confidentiality impact, Low integrity impact, No availability impact)
- **Affected Versions:** 5.0.42, 6.0.30, 6.4.15, 7.0.0rc2
- **Fixed Versions:** 5.0.43rc1, 6.0.31rc1, 6.4.16rc1, 7.0.0rc3
- **Components Affected:** Frontend and Server
- **Mitigation:** Upgrade Zabbix Server and Frontend to patched versions.

This content provides more details than the typical CVE description, particularly regarding the specific attack vector, affected components and versions, and the range of potential impacts based on modem functionality.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.244 |
| 4 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.243 |
| 5 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.229 |
| 6 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.228 |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | Base | Allowed | sparse | 0.227 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.225 |
| 9 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | dense | 0.402 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-20: Improper Input Validation

CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')

CWE-306: Missing Authentication for Critical Function

CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-790: Improper Filtering of Special Elements

CWE-73: External Control of File Name or Path