# Raw Retriever Results for CVE-2025-37843

# Raw Retriever Results for CVE-2025-37843
## Query
In the Linux kernel, the following vulnerability has been resolved PCI pciehp Avoid unnecessary device replacement check Hot-removal of nested PCI hotplug ports suffers from a long-standing race condition which can lead to a deadlock A parent hotplug port acquires pci_lock_rescan_remove(), then waits for pciehp to unbind from a child hotplug port. Meanwhile that child hotplug port tries to acquire pci_lock_rescan_remove() as well in order to remove its own children. The deadlock only occurs if the parent acquires pci_lock_rescan_remove() first, not if the child happens to acquire it first. Several workarounds to avoid the issue have been proposed and discarded over the years, e.g. https//lore.kernel.org/r/4c882e25194ba8282b78fe963fec8faae7cf23eb.1529173804.git.lukas@wunner.de/ A proper fix is being worked on, but needs more time as it is nontrivial and necessarily intrusive. Recent commit 9d573d19547b (PCI pciehp Detect device replacement during system sleep) provokes more frequent occurrence of the deadlock when removing more than one Thunderbolt device during system sleep. The commit sought to detect device replacement, but also triggered on device removal. Differentiating reliably between replacement and removal is impossible because pci_get_dsn() returns 0 both if the device was removed, as well as if it was replaced with one lacking a Device Serial Number. Avoid the more frequent occurrence of the deadlock by checking whether the hotplug port itself was hot-removed. If so, theres no sense in checking whether its child device was replaced. This works because the ->resume_noirq() callback is invoked in top-down order for the entire hierarchy A parent hotplug port detecting device replacement (or removal) marks all children as removed using pci_dev_set_disconnected() and a child hotplug port can then reliably detect being removed.

## Keyphrases
- **rootcause**: 'race condition'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4509 | 0.5210 | 0.4722 | 0.4648 | 20 |
| Sparse | 1044.2309 | 1185.4733 | 1102.1524 | 1103.6786 | 10 |
| Graph | 1.4870 | 2.8652 | 1.7900 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 2 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.3764 | Allowed |
| 3 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.2100 | Allowed |
| 4 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.1190 | Allowed |
| 5 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 7 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 8 | 833 | Deadlock | Base | 1.7060 | Allowed |
| 9 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 11 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 12 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 1.6779 | Allowed |
| 13 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 15 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | 1.6090 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.5210 | 0.5210 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.5085 | 0.5085 | Allowed-with-Review |
| 3 | 1256 | Improper Restriction of Software Interfaces to Hardware Features | Base | 0.5028 | 0.5028 | Allowed |
| 4 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4935 | 0.4935 | Allowed-with-Review |
| 5 | 1299 | Missing Protection Mechanism for Alternate Hardware Interface | Base | 0.4844 | 0.4844 | Allowed |
| 6 | 413 | Improper Resource Locking | Base | 0.4830 | 0.4830 | Allowed |
| 7 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4810 | 0.4810 | Allowed |
| 8 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4760 | 0.4760 | Allowed |
| 9 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4751 | 0.4751 | Allowed |
| 10 | 909 | Missing Initialization of Resource | Class | 0.4701 | 0.4701 | Allowed-with-Review |
| 11 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.4596 | 0.4596 | Discouraged |
| 12 | 1338 | Improper Protections Against Hardware Overheating | Base | 0.4594 | 0.4594 | Allowed |
| 13 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4585 | 0.4585 | Allowed |
| 14 | 1272 | Sensitive Information Uncleared Before Debug/Power State Transition | Base | 0.4561 | 0.4561 | Allowed |
| 15 | 908 | Use of Uninitialized Resource | Base | 0.4555 | 0.4555 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 1185.4733 | 1185.4733 | Allowed-with-Review |
| 2 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 1171.9679 | 1171.9679 | Allowed-with-Review |
| 3 | 833 | Deadlock | 1123.0495 | 1123.0495 | Allowed |
| 4 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 1120.4341 | 1120.4341 | Allowed |
| 5 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 1114.1830 | 1114.1830 | Allowed |
| 6 | 863 | Incorrect Authorization | 1093.1743 | 1093.1743 | Allowed-with-Review |
| 7 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 1062.5336 | 1062.5336 | Allowed |
| 8 | 59 | Improper Link Resolution Before File Access ('Link Following') | 1055.9872 | 1055.9872 | Allowed |
| 9 | 306 | Missing Authentication for Critical Function | 1050.4906 | 1050.4906 | Allowed |
| 10 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | 1044.2309 | 1044.2309 | Allowed-with-Review |
