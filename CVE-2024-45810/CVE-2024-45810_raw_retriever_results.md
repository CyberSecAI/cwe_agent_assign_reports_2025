# Raw Retriever Results for CVE-2024-45810

# Raw Retriever Results for CVE-2024-45810
## Query
Envoy is a cloud-native high-performance edge/middle/service proxy. Envoy will crash when the http async client is handling `sendLocalReply` under some circumstance, e.g., websocket upgrade, and requests mirroring. The http async client will crash during the `sendLocalReply()` in http async client, one reason is http async client is duplicating the status code, another one is the destroy of router is called at the destructor of the async stream, while the stream is deferred deleted at first. There will be problems that the stream decoder is destroyed but its reference is called in `router.onDestroy()`, causing segment fault. This will impact ext_authz if the `upgrade` and `connection` header are allowed, and request mirrorring. This issue has been addressed in versions 1.31.2, 1.30.6, 1.29.9, and 1.28.7. Users are advised to upgrade. There are no known workarounds for this vulnerability.

## Keyphrases
- **weakness**: 'improper object destruction'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4056 | 0.4721 | 0.4317 | 0.4263 | 20 |
| Sparse | 224.2973 | 749.4184 | 627.2913 | 645.2755 | 11 |
| Graph | 1.5795 | 2.9250 | 1.8907 | 1.7680 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 2.9250 | Allowed |
| 2 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 3 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.2100 | Allowed |
| 4 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | base | 2.2100 | Allowed |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 2.2100 | Allowed |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.1190 | Allowed |
| 7 | 129 | Improper Validation of Array Index | variant | 2.0400 | Allowed |
| 8 | 823 | Use of Out-of-range Pointer Offset | base | 1.7680 | Allowed |
| 9 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | base | 1.7680 | Allowed |
| 10 | 41 | Improper Resolution of Path Equivalence | base | 1.7680 | Allowed |
| 11 | 494 | Download of Code Without Integrity Check | base | 1.7680 | Allowed |
| 12 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 13 | 184 | Incomplete List of Disallowed Inputs | base | 1.6848 | Allowed |
| 14 | 472 | External Control of Assumed-Immutable Web Parameter | base | 1.6744 | Allowed |
| 15 | 613 | Insufficient Session Expiration | base | 1.6744 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | 0.4721 | 0.4721 | Allowed |
| 2 | 444 | Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling') | Base | 0.4692 | 0.4692 | Allowed |
| 3 | 770 | Allocation of Resources Without Limits or Throttling | Base | 0.4637 | 0.4637 | Allowed |
| 4 | 441 | Unintended Proxy or Intermediary ('Confused Deputy') | Class | 0.4598 | 0.4598 | Allowed-with-Review |
| 5 | 346 | Origin Validation Error | Class | 0.4581 | 0.4581 | Allowed-with-Review |
| 6 | 789 | Memory Allocation with Excessive Size Value | Variant | 0.4486 | 0.4486 | Allowed |
| 7 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.4466 | 0.4466 | Allowed |
| 8 | 204 | Observable Response Discrepancy | Base | 0.4373 | 0.4373 | Allowed |
| 9 | 918 | Server-Side Request Forgery (SSRF) | Base | 0.4368 | 0.4368 | Allowed |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | 0.4355 | 0.4355 | Allowed |
| 11 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4171 | 0.4171 | Allowed |
| 12 | 121 | Stack-based Buffer Overflow | Variant | 0.4156 | 0.4156 | Allowed |
| 13 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.4123 | 0.4123 | Allowed |
| 14 | 551 | Incorrect Behavior Order: Authorization Before Parsing and Canonicalization | Base | 0.4120 | 0.4120 | Allowed |
| 15 | 617 | Reachable Assertion | Base | 0.4115 | 0.4115 | Allowed |

## Sparse Retriever Results (11)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 770 | Allocation of Resources Without Limits or Throttling | 749.4184 | 749.4184 | Allowed |
| 2 | 789 | Memory Allocation with Excessive Size Value | 733.0755 | 733.0755 | Allowed |
| 3 | 674 | Uncontrolled Recursion | 680.4428 | 680.4428 | Allowed-with-Review |
| 4 | 201 | Insertion of Sensitive Information Into Sent Data | 676.7770 | 676.7770 | Allowed |
| 5 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 649.6551 | 649.6551 | Allowed |
| 6 | 1333 | Inefficient Regular Expression Complexity | 645.2755 | 645.2755 | Allowed |
| 7 | 407 | Inefficient Algorithmic Complexity | 639.3069 | 639.3069 | Allowed-with-Review |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | 638.6452 | 638.6452 | Allowed-with-Review |
| 9 | 1390 | Weak Authentication | 632.9789 | 632.9789 | Allowed-with-Review |
| 10 | 863 | Incorrect Authorization | 630.3320 | 630.3320 | Allowed-with-Review |
| 11 | 409 | Improper Handling of Highly Compressed Data (Data Amplification) | 224.2973 | 224.2973 | Allowed |
