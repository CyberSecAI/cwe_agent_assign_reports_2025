# Raw Retriever Results for CVE-2025-31491

# Raw Retriever Results for CVE-2025-31491
## Query
AutoGPT is a platform that allows users to create, deploy, and manage continuous artificial intelligence agents that automate complex workflows. Prior to 0.6.1, AutoGPT allows of leakage of cross-domain cookies and protected headers in requests redirect. AutoGPT uses a wrapper around the requests python library, located in autogpt_platform/backend/backend/util/request.py. In this wrapper, redirects are specifically NOT followed for the first request. If the wrapper is used with allow_redirects set to True (which is the default), any redirect is not followed by the initial request, but rather re-requested by the wrapper using the new location. However, there is a fundamental flaw in manually re-requesting the new location it does not account for security-sensitive headers which should not be sent cross-origin, such as the Authorization and Proxy-Authorization header, and cookies. For example in autogpt_platform/backend/backend/blocks/github/_api.py, an Authorization header is set when retrieving data from the GitHub API. However, if GitHub suffers from an open redirect vulnerability (such as the made-up example of https//api.github.com/repos/{owner}/{repo}/issues/comments/{comment_id}/../../../../../redirect/?url=https//joshua.hu/), and the script can be coerced into visiting it with the Authorization header, the GitHub credentials in the Authorization header will be leaked. This allows leaking auth headers and private cookies. This vulnerability is fixed in 0.6.1.

## Keyphrases
- **weakness**: 'improper header handling', 'open redirect'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3600 | 0.4418 | 0.3898 | 0.3896 | 20 |
| Sparse | 1000.0000 | 1419.6511 | 1120.7920 | 1075.7032 | 12 |
| Graph | 1.3747 | 4.3290 | 1.8827 | 1.6405 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 201 | Insertion of Sensitive Information Into Sent Data | base | 4.3290 | Allowed |
| 2 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.8652 | Allowed |
| 3 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 2.7754 | Allowed |
| 4 | 494 | Download of Code Without Integrity Check | base | 2.2100 | Allowed |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | 1.8579 | Allowed |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | base | 1.7680 | Allowed |
| 7 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 1.7680 | Allowed |
| 8 | 81 | Improper Neutralization of Script in an Error Message Web Page | variant | 1.6968 | Allowed |
| 9 | 565 | Reliance on Cookies without Validation and Integrity Checking | Base | 1.6596 | Allowed |
| 10 | 639 | Authorization Bypass Through User-Controlled Key | Base | 1.6490 | Allowed |
| 11 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 1.6320 | Allowed |
| 12 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 1.6242 | Allowed |
| 13 | 1426 | Improper Validation of Generative AI Output | Base | 1.5857 | Discouraged |
| 14 | 202 | Exposure of Sensitive Information Through Data Queries | base | 1.5210 | Allowed |
| 15 | 209 | Generation of Error Message Containing Sensitive Information | base | 1.5210 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1426 | Improper Validation of Generative AI Output | Base | 0.4418 | 0.4418 | Discouraged |
| 2 | 784 | Reliance on Cookies without Validation and Integrity Checking in a Security Decision | Variant | 0.4288 | 0.4288 | Allowed |
| 3 | 601 | URL Redirection to Untrusted Site ('Open Redirect') | Base | 0.4277 | 0.4277 | Allowed |
| 4 | 359 | Exposure of Private Personal Information to an Unauthorized Actor | Base | 0.4189 | 0.4189 | Allowed |
| 5 | 565 | Reliance on Cookies without Validation and Integrity Checking | Base | 0.4126 | 0.4126 | Allowed |
| 6 | 1286 | Improper Validation of Syntactic Correctness of Input | Base | 0.4062 | 0.4062 | Allowed |
| 7 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | Base | 0.4002 | 0.4002 | Allowed |
| 8 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | 0.4002 | 0.4002 | Allowed |
| 9 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | 0.3933 | 0.3933 | Allowed |
| 10 | 352 | Cross-Site Request Forgery (CSRF) | Compound | 0.3929 | 0.3929 | Allowed |
| 11 | 863 | Incorrect Authorization | Class | 0.3863 | 0.3863 | Allowed-with-Review |
| 12 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | 0.3707 | 0.3707 | Allowed |
| 13 | 1249 | Application-Level Admin Tool with Inconsistent View of Underlying Operating System | Base | 0.3682 | 0.3682 | Allowed |
| 14 | 862 | Missing Authorization | Class | 0.3673 | 0.3673 | Allowed-with-Review |
| 15 | 291 | Reliance on IP Address for Authentication | Variant | 0.3665 | 0.3665 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 212 | Improper Removal of Sensitive Information Before Storage or Transfer | 1419.6511 | 1419.6511 | Allowed |
| 2 | 201 | Insertion of Sensitive Information Into Sent Data | 1302.4718 | 1302.4718 | Allowed |
| 3 | 863 | Incorrect Authorization | 1126.6740 | 1126.6740 | Allowed-with-Review |
| 4 | 639 | Authorization Bypass Through User-Controlled Key | 1125.0306 | 1125.0306 | Allowed |
| 5 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | 1097.9209 | 1097.9209 | Allowed |
| 6 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | 1085.3755 | 1085.3755 | Allowed |
| 7 | 93 | Improper Neutralization of CRLF Sequences ('CRLF Injection') | 1066.0309 | 1066.0309 | Allowed |
| 8 | 138 | Improper Neutralization of Special Elements | 1061.3354 | 1061.3354 | Discouraged |
| 9 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | 1061.2084 | 1061.2084 | Allowed |
| 10 | 352 | Cross-Site Request Forgery (CSRF) | 1052.4507 | 1052.4507 | Allowed |
| 11 | 285 | Improper Authorization | 1051.3548 | 1051.3548 | Discouraged |
| 12 | 601 | URL Redirection to Untrusted Site ('Open Redirect') | 1000.0000 | 1000.0000 | Allowed |
