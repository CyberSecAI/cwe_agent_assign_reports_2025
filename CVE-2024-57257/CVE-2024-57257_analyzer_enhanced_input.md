## Vulnerability Description
A **stack consumption** issue in sqfs_size in Das U-Boot before 2025.01-rc1 occurs via a crafted squashfs filesystem with deep symlink nesting.

### Vulnerability Description Key Phrases
- **rootcause:** **stack consumption**
- **vector:** crafted squashfs filesystem with deep symlink nesting
- **product:** Das U-Boot
- **version:** before 2025.01-rc1
- **component:** sqfs_size

## CVE Reference Links Content Summary
```
- Root cause of vulnerability: Stack overflow in U-Bootâ€™s SquashFS symlink resolution function
- Weaknesses/vulnerabilities present: Stack overflow
- Impact of exploitation:  An attacker capable of modifying ext4 or SquashFS filesystem data structures can exploit multiple memory corruption vulnerabilities in U-Boot.  For systems that rely on verified boot, these vulnerabilities allow an attacker to bypass the chain of trust and achieve code execution by exploiting these issues.
- Attack vectors: An attacker capable of modifying ext4 or SquashFS filesystem data structures.
- Mitigation or fix: Upgrade to version v2025.01-rc1 or newer.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.139 |
| 2 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.131 |
| 3 | 400 | Uncontrolled Resource Consumption | Class | Discouraged | sparse | 0.123 |
| 4 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | sparse | 0.120 |
| 5 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.117 |
| 6 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.116 |
| 7 | 696 | Incorrect Behavior Order | Class | Allowed-with-Review | sparse | 0.115 |
| 8 | 407 | Inefficient Algorithmic Complexity | Class | Allowed-with-Review | sparse | 0.114 |
| 9 | 1325 | Improperly Controlled Sequential Memory Allocation | Base | Allowed | dense | 0.516 |
| 10 | 129 | Improper Validation of Array Index | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-674: Uncontrolled Recursion

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-400: Uncontrolled Resource Consumption

CWE-789: Memory Allocation with Excessive Size Value

CWE-121: Stack-based Buffer Overflow

CWE-401: Missing Release of Memory after Effective Lifetime

CWE-696: Incorrect Behavior Order

CWE-407: Inefficient Algorithmic Complexity

CWE-1325: Improperly Controlled Sequential Memory Allocation

CWE-129: Improper Validation of Array Index