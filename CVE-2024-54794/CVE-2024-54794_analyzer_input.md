# Vulnerability Information: CVE-2024-54794

## Vulnerability Description
The script input feature of SpagoBI 3.5.1 allows arbitrary code execution.

### Vulnerability Description Key Phrases
- **impact:** arbitrary code execution
- **product:** SpagoBI
- **version:** 3.5.1
- **component:** script input feature

## CVE Reference Links Content Summary
```text
**Root cause of vulnerability:**
The vulnerability lies in the "script input" feature of Engineering Ingegneria Informatica SpagoBI version 3.5.1, specifically within the Groovy script execution functionality. The web application fails to properly sanitize or validate user-supplied input provided through the script input form.

**Weaknesses/vulnerabilities present:**
The primary vulnerability is Command Injection. This occurs when an attacker, through a specially crafted Groovy script, can inject operating system commands into the application.

**Impact of exploitation:**
Successful exploitation allows the attacker to execute arbitrary code on the machine hosting the SpagoBI web application. This could lead to complete system compromise, including data theft, server control, and potential lateral movement within the network.

**Attack vectors:**
The attack vector involves a logged-in attacker submitting a malicious Groovy script through the script input form within the web application.

**Required attacker capabilities/position:**
The attacker must:
1.  Have valid access to the SpagoBI web application, likely requiring a registered account and proper authentication.
2.  Possess the permissions or privileges within the application to access and interact with the "script input" feature, and the ability to write and submit Groovy scripts.
3.  Have knowledge of the web application's internal workings and the Groovy scripting language.

**Mitigation or fix:**
1.  Disable the script input form.
2.  Update to the latest version of SpagoBI.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 915 | Improperly Controlled Modification of Dynamically-Determined Object Attributes | Base | Allowed | sparse | 0.022 |
| 2 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.021 |
| 3 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.021 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.020 |
| 5 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.020 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.020 |
| 7 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.020 |
| 8 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.019 |
| 9 | 564 | SQL Injection: Hibernate | Variant | Allowed | dense | 0.477 |
| 10 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | Variant | Allowed | graph | 0.002 |

