# Vulnerability Information: CVE-2025-5321

## Vulnerability Description
A vulnerability classified as critical was found in aimhubio aim up to 3.29.1. This vulnerability affects the function RestrictedPythonQuery of the file /aim/storage/query.py of the component run_view Object Handler. The manipulation of the argument Abfrage leads to erweiterte Rechte. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **component:** RestrictedPythonQuery, run_view Object Handler
- **product:** aimhubio aim
- **impact:** erweiterte Rechte
- **version:** up to 3.29.1

## CVE Reference Links Content Summary
CVE-2025-5321: The content is related to a Remote Code Execution (RCE) vulnerability in Aim, an experiment tracking tool. It provides more detail than a typical CVE description would.

**Root cause of vulnerability:**

The vulnerability stems from the `RestrictedPythonQuery` class, which creates a restricted Python sandbox. An unsanitized `run_view` object is passed into the sandbox environment as part of the local namespace, exposing dangerous internal objects. Specifically, the `QueryRunSequenceCollection` class instantiates a `run_view` object and passes it to the sandbox via `self.query.check()`. This `run_view` object allows traversal to internal database sessions and ultimately to modules like `sys` and `os`.

**Weaknesses/vulnerabilities present:**

*   **Unsanitized Input:** The `run_view` object is not properly sanitized before being passed into the sandbox.
*   **Insecure Deserialization/Object Access:** The complex `run_view` object provides access to internal database sessions and system modules.
*   **Sandbox Escape:** The ability to access `sys` and `os` allows an attacker to escape the intended sandbox environment.

**Impact of exploitation:**

Remote Code Execution (RCE) on the server. An attacker can execute arbitrary OS commands.

**Attack vectors:**

*   The vulnerability can be triggered via API endpoints:
    *   `/api/runs/search/metric/`
    *   `/api/runs/search/run`
*   The `q` parameter in these endpoints accepts user-supplied query expressions that are evaluated inside the sandbox.
*   An attacker can craft a malicious query to traverse the `run_view` object and execute system commands.

**Required attacker capabilities/position:**

*   An attacker needs to be able to send requests to the Aim API endpoints.
*   No authentication is explicitly mentioned as a requirement in the provided text, suggesting the vulnerability might be exploitable without authentication.

**Mitigation or fix:**

The content does not provide specific mitigation or fix details. However, it implies that sanitizing the `run_view` object or restricting access to sensitive modules within the sandbox would be necessary to address the vulnerability.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.166 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.163 |
| 3 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.140 |
| 4 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.135 |
| 5 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.134 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.133 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.133 |
| 8 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.133 |
| 9 | 269 | Improper Privilege Management | Class | Discouraged | dense | 0.511 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.003 |

