# Vulnerability Information: CVE-2024-41117

## Vulnerability Description
streamlit-geospatial is a streamlit multipage app for geospatial applications. Prior to commit c4f81d9616d40c60584e36abb15300853a66e489, the `vis_params` variable on line 115 in `pages/10__Earth_Engine_Datasets.py` takes user input, which is later used in the `eval()` function on line 126, leading to remote code execution. Commit c4f81d9616d40c60584e36abb15300853a66e489 fixes this issue.

### Vulnerability Description Key Phrases
- **rootcause:** **improper input validation**
- **impact:** remote code execution
- **product:** streamlit-geospatial
- **version:** prior to commit c4f81d9616d40c60584e36abb15300853a66e489
- **component:** vis_params variable

## CVE Reference Links Content Summary
The provided content relates to CVE-2024-41117.

**Root cause of vulnerability:**
The application uses the `eval()` function to process user-supplied input in the `vis_params` variable without proper sanitization in the file `pages/10_üåç_Earth_Engine_Datasets.py`.

**Weaknesses/vulnerabilities present:**
- Remote Code Execution (RCE) due to the use of `eval()` on unsanitized user input.

**Impact of exploitation:**
- Attackers can execute arbitrary code on the server hosting the application. This may lead to complete system compromise, data theft, or denial of service.

**Attack vectors:**
-  The application's web interface allows users to enter visualization parameters as a dictionary. This input is then processed by the `eval()` function.

**Required attacker capabilities/position:**
- The attacker needs to access the application's web interface and have the ability to input data into the "Enter visualization parameters as a dictionary" field.

**Additional Details:**
- The vulnerability is present in the file `pages/10_üåç_Earth_Engine_Datasets.py` on line 126.
- The vulnerability can be exploited by entering malicious code as visualization parameters, which the application then executes via `eval()`.
- The fix involves replacing `eval()` with `json.loads()` after sanitizing the input

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | sparse | 0.251 |
| 2 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.249 |
| 3 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.235 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.232 |
| 5 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.226 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.221 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.218 |
| 8 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.217 |
| 9 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | dense | 0.382 |
| 10 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | graph | 0.003 |

