# Vulnerability Information: CVE-2025-25685

## Vulnerability Description
An issue was discovered in GL-INet Beryl AX GL-MT3000 v4.7.0. Attackers are able to download arbitrary files from the devices file system via adding symbolic links on an external drive used as a samba share.

### Vulnerability Description Key Phrases
- **impact:** download arbitrary files
- **vector:** adding symbolic links on samba share
- **attacker:** Attackers
- **product:** GL-INet Beryl AX GL-MT3000
- **version:** v4.7.0

## CVE Reference Links Content Summary
## Analysis of CVE-2025-25685 Content

This content **relates** to CVE-2025-25685. It provides more detail than the official CVE description (which is currently a placeholder).

**Root cause of vulnerability:**

The vulnerability stems from the lack of validation when handling symlinks within the Samba share accessed through the GL-MT300 router's mobile app.

**Weaknesses/vulnerabilities present:**

*   **Arbitrary File Read:** The ability to read arbitrary files on the router by leveraging symlinks.
*   **Unvalidated Input:** The router doesn't properly sanitize or validate file paths when accessed via the Samba share.

**Impact of exploitation:**

An attacker can read sensitive files from the router, such as `/etc/passwd`, potentially gaining access to user credentials and other system information.

**Attack vectors:**

1.  Create a directory on an ext4 USB device.
2.  Create a symbolic link within that directory pointing to a sensitive file (e.g., `/etc/passwd`).
3.  Plug the USB device into the router.
4.  Create a Samba share for the directory on the router's admin panel.
5.  Access the Samba share via the GL-MT300 mobile app and save the symbolic link file to a mobile device.
6.  Use `adb shell` (Android Debug Bridge) to access the file on the mobile device, which resolves the symlink and reveals the contents of the target file on the router.

**Required attacker capabilities/position:**

*   Physical access to the router to plug in the USB device.
*   Access to the router's admin panel to create the Samba share.
*   Access to the GL-MT300 mobile app.
*   Android device with USB debugging enabled and `adb` access from a computer.
*   Knowledge of Linux commands (e.g., `ln -s`, `find`, `cat`).

**Mitigation or fix:**

The article does not explicitly state a fix, but implies that proper validation of file paths and handling of symlinks within the Samba share is required. The author notes that adding `"unix extensions = yes"` and `"wide links = yes"` to the routerâ€™s `smb.conf` would *enable* symlink creation, which is undesirable.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | Allowed | sparse | 0.073 |
| 2 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | sparse | 0.066 |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.060 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.058 |
| 5 | 345 | Insufficient Verification of Data Authenticity | Class | Discouraged | sparse | 0.057 |
| 6 | 259 | Use of Hard-coded Password | Variant | Allowed | sparse | 0.057 |
| 7 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.057 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.056 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.596 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

