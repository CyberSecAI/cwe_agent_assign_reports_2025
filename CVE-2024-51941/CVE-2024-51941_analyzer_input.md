# Vulnerability Information: CVE-2024-51941

## Vulnerability Description
A remote code injection vulnerability exists in the Ambari Metrics and AMS Alerts feature, allowing authenticated users to inject and execute arbitrary code. The vulnerability occurs when processing alert definitions, where malicious input can be injected into the alert script execution path. An attacker with authenticated access can exploit this vulnerability to execute arbitrary commands on the server. The issue has been fixed in the latest versions of Ambari.

### Vulnerability Description Key Phrases
- **impact:** execute arbitrary commands and execute arbitrary code and remote code injection and script execution
- **attacker:** authenticated users
- **product:** Ambari Metrics and AMS Alerts

## CVE Reference Links Content Summary
CVE-2024-51941 relates to Apache Ambari. Here's the extracted information from the provided content:

**Root cause of vulnerability:**

A remote code injection vulnerability exists in the Ambari Metrics and AMS Alerts feature.

**Weaknesses/vulnerabilities present:**

Remote code injection.

**Impact of exploitation:**

An attacker with authenticated access can execute arbitrary commands on the server.

**Attack vectors:**

Processing alert definitions where malicious input can be injected into the alert script execution path.

**Required attacker capabilities/position:**

Authenticated user.

**Mitigation or fix:**

The issue has been fixed in the latest versions of Ambari. Affected versions are through 2.7.8. Fix versions include 3.0.0 and 2.7.9.

**Additional Information:**

*   The vulnerability is tracked as AMBARI-26202.
*   Credit for finding the vulnerability goes to 4ra1n and reporting by h4cking2thegate@...il.com.
*   The vulnerability is described as "important" in severity.

The content from lists.apache.org provides the initial vulnerability announcement. The content from issues.apache.org confirms the fix versions and links to the GitHub pull request.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.146 |
| 2 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.137 |
| 3 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.136 |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.134 |
| 5 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.133 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.131 |
| 7 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.130 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.128 |
| 9 | 95 | Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') | Variant | Allowed | dense | 0.530 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |

