# Raw Retriever Results for CVE-2024-50110

# Raw Retriever Results for CVE-2024-50110
## Query
In the Linux kernel, the following vulnerability has been resolved xfrm fix one more kernel-infoleak in algo dumping During fuzz testing, the following issue was discovered BUG KMSAN kernel-infoleak in _copy_to_iter+0x598/0x2a30 _copy_to_iter+0x598/0x2a30 __skb_datagram_iter+0x168/0x1060 skb_copy_datagram_iter+0x5b/0x220 netlink_recvmsg+0x362/0x1700 sock_recvmsg+0x2dc/0x390 __sys_recvfrom+0x381/0x6d0 __x64_sys_recvfrom+0x130/0x200 x64_sys_call+0x32c8/0x3cc0 do_syscall_64+0xd8/0x1c0 entry_SYSCALL_64_after_hwframe+0x79/0x81 Uninit was stored to memory at copy_to_user_state_extra+0xcc1/0x1e00 dump_one_state+0x28c/0x5f0 xfrm_state_walk+0x548/0x11e0 xfrm_dump_sa+0x1e0/0x840 netlink_dump+0x943/0x1c40 __netlink_dump_start+0x746/0xdb0 xfrm_user_rcv_msg+0x429/0xc00 netlink_rcv_skb+0x613/0x780 xfrm_netlink_rcv+0x77/0xc0 netlink_unicast+0xe90/0x1280 netlink_sendmsg+0x126d/0x1490 __sock_sendmsg+0x332/0x3d0 ____sys_sendmsg+0x863/0xc30 ___sys_sendmsg+0x285/0x3e0 __x64_sys_sendmsg+0x2d6/0x560 x64_sys_call+0x1316/0x3cc0 do_syscall_64+0xd8/0x1c0 entry_SYSCALL_64_after_hwframe+0x79/0x81 Uninit was created at __kmalloc+0x571/0xd30 attach_auth+0x106/0x3e0 xfrm_add_sa+0x2aa0/0x4230 xfrm_user_rcv_msg+0x832/0xc00 netlink_rcv_skb+0x613/0x780 xfrm_netlink_rcv+0x77/0xc0 netlink_unicast+0xe90/0x1280 netlink_sendmsg+0x126d/0x1490 __sock_sendmsg+0x332/0x3d0 ____sys_sendmsg+0x863/0xc30 ___sys_sendmsg+0x285/0x3e0 __x64_sys_sendmsg+0x2d6/0x560 x64_sys_call+0x1316/0x3cc0 do_syscall_64+0xd8/0x1c0 entry_SYSCALL_64_after_hwframe+0x79/0x81 Bytes 328-379 of 732 are uninitialized Memory access of size 732 starts at ffff88800e18e000 Data copied to user address 00007ff30f48aff0 CPU 2 PID 18167 Comm syz-executor.0 Not tainted 6.8.11 #1 Hardware name QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014 Fixes copying of xfrm algorithms where some random data of the structure fields can end up in userspace. Padding in structures may be filled with random (possibly sensitve) data and should never be given directly to user-space. A similar issue was resolved in the commit 8222d5910dae (xfrm Zero padding when dumping algos and encap) Found by Linux Verification Center (linuxtesting.org) with Syzkaller.

## Keyphrases
- **rootcause**: 'Uninitialized memory being copied to user space when dumping xfrm algorithms.'
- **weakness**: 'Padding in structures may contain random', 'sensitive data', 'which should not be exposed to user space.'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.5739 | 0.6662 | 0.6018 | 0.6024 | 20 |
| Sparse | 551.7744 | 714.2722 | 609.7217 | 605.8497 | 12 |
| Graph | 1.6848 | 2.3868 | 1.9746 | 1.9204 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 2 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 3 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 4 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 5 | 823 | Use of Out-of-range Pointer Offset | base | 2.2100 | Allowed |
| 6 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | base | 2.2100 | Allowed |
| 8 | 226 | Sensitive Information in Resource Not Removed Before Reuse | base | 2.1190 | Allowed |
| 9 | 190 | Integer Overflow or Wraparound | Base | 2.0894 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 2.0014 | Allowed |
| 11 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 12 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 13 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 14 | 562 | Return of Stack Variable Address | base | 1.7680 | Allowed |
| 15 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 1.6992 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 909 | Missing Initialization of Resource | Class | 0.6662 | 0.6662 | Allowed-with-Review |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.6268 | 0.6268 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.6264 | 0.6264 | Allowed-with-Review |
| 4 | 190 | Integer Overflow or Wraparound | Base | 0.6227 | 0.6227 | Allowed |
| 5 | 667 | Improper Locking | Class | 0.6184 | 0.6184 | Allowed-with-Review |
| 6 | 126 | Buffer Over-read | Variant | 0.6168 | 0.6168 | Allowed |
| 7 | 908 | Use of Uninitialized Resource | Base | 0.6145 | 0.6145 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | 0.6138 | 0.6138 | Allowed |
| 9 | 191 | Integer Underflow (Wrap or Wraparound) | Base | 0.6135 | 0.6135 | Allowed |
| 10 | 122 | Heap-based Buffer Overflow | Variant | 0.6119 | 0.6119 | Allowed |
| 11 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | 0.5930 | 0.5930 | Discouraged |
| 12 | 416 | Use After Free | Variant | 0.5901 | 0.5901 | Allowed |
| 13 | 476 | NULL Pointer Dereference | Base | 0.5869 | 0.5869 | Allowed |
| 14 | 121 | Stack-based Buffer Overflow | Variant | 0.5800 | 0.5800 | Allowed |
| 15 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.5777 | 0.5777 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 909 | Missing Initialization of Resource | 714.2722 | 714.2722 | Allowed-with-Review |
| 2 | 125 | Out-of-bounds Read | 654.6607 | 654.6607 | Allowed |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 629.6896 | 629.6896 | Allowed-with-Review |
| 4 | 226 | Sensitive Information in Resource Not Removed Before Reuse | 613.8146 | 613.8146 | Allowed |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | 608.8275 | 608.8275 | Allowed |
| 6 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | 606.2574 | 606.2574 | Discouraged |
| 7 | 770 | Allocation of Resources Without Limits or Throttling | 605.4420 | 605.4420 | Allowed |
| 8 | 476 | NULL Pointer Dereference | 595.8297 | 595.8297 | Allowed |
| 9 | 401 | Missing Release of Memory after Effective Lifetime | 592.7322 | 592.7322 | Allowed |
| 10 | 327 | Use of a Broken or Risky Cryptographic Algorithm | 587.1766 | 587.1766 | Allowed-with-Review |
| 11 | 400 | Uncontrolled Resource Consumption | 556.1840 | 556.1840 | Discouraged |
| 12 | 203 | Observable Discrepancy | 551.7744 | 551.7744 | Allowed |
