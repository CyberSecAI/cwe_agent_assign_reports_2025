# Vulnerability Information: CVE-2024-11962

## Vulnerability Description
A vulnerability classified as critical was found in code-projects Simple Car Rental System 1.0. Affected by this vulnerability is an unknown functionality of the file /login.php. The manipulation of the argument uname leads to **sql injection**. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.

### Vulnerability Description Key Phrases
- **weakness:** **sql injection**
- **attacker:** remote attacker
- **product:** code-projects Simple Car Rental System
- **version:** 1
- **component:** /login.php

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

*   The vulnerability stems from insufficient user input sanitization in the `login.php` file of the "Simple Car Rental System In PHP With Source Code". Specifically, the `uname` parameter is directly used in SQL queries without proper cleaning or validation.

**Weaknesses/vulnerabilities present:**

*   **SQL Injection:** The primary vulnerability is a SQL injection flaw. This occurs because user-supplied data is directly incorporated into SQL queries, allowing an attacker to manipulate those queries.
*   **Lack of Input Sanitization:** The code fails to validate and sanitize user-supplied input for the `uname` parameter before using it in SQL queries.

**Impact of exploitation:**

*   **Unauthorized Database Access:** Attackers can gain unauthorized access to the database.
*   **Sensitive Data Leakage:** Attackers can extract sensitive information stored in the database.
*   **Data Tampering:** Attackers can modify or delete data.
*   **Comprehensive System Control:** Successful exploitation could potentially lead to full control of the system.
*   **Service Interruption:** Attackers might cause service disruption or denial of service.

**Attack vectors:**

*   The attack vector is via a crafted HTTP POST request to the `/login.php` endpoint.
*   The vulnerable parameter is `uname`.

**Required attacker capabilities/position:**

*   The attacker needs the ability to send HTTP POST requests to the server hosting the vulnerable application.
*   No login is required to exploit this vulnerability

**Technical details:**

*   The vulnerability is located in the `login.php` file
*   The vulnerability type is time-based blind SQL injection.
*   The provided proof-of-concept (POC) shows how to inject a `SLEEP` command using the `uname` parameter, demonstrating time-based blind SQL injection:
    ```
    uname=admin' AND (SELECT 2333 FROM (SELECT(SLEEP(5)))XVEL) AND 'GbIS'='GbIS&pass=adnubadmin&login=Login Here
    ```
* The SQLMAP tool can be used to extract information from the database using the vulnerability.
*  The vulnerable software is identified as the "Simple Car Rental System In PHP With Source Code" version 1.0.
*  The vulnerable file is `login.php`.

**Suggested remediation:**

*   Use prepared statements with parameter binding to prevent SQL injection.
*   Implement strict input validation and filtering to ensure data conforms to the expected format.
*   Apply the principle of least privilege to database user permissions.
*   Conduct regular security audits to identify and fix potential vulnerabilities.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 1.000 |
| 2 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.406 |
| 3 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.350 |
| 4 | 117 | Improper Output Neutralization for Logs | Base | Allowed | sparse | 0.332 |
| 5 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.330 |
| 6 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.328 |
| 7 | 99 | Improper Control of Resource Identifiers ('Resource Injection') | Class | Allowed-with-Review | sparse | 0.325 |
| 8 | 705 | Incorrect Control Flow Scoping | Class | Allowed-with-Review | sparse | 0.310 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.588 |
| 10 | 73 | External Control of File Name or Path | Base | Allowed | graph | 0.002 |

