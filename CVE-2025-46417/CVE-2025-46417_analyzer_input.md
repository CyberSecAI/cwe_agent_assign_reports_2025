# Vulnerability Information: CVE-2025-46417

## Vulnerability Description
The **unsafe globals** in Picklescan before 0.0.25 do not include ssl. Consequently, ssl.get_server_certificate can exfiltrate data via DNS after **deserialization**.

### Vulnerability Description Key Phrases
- **rootcause:** **unsafe globals**
- **weakness:** **deserialization**
- **impact:** exfiltrate data via DNS
- **vector:** deserialization
- **product:** Picklescan
- **version:** before 0.0.25

## CVE Reference Links Content Summary
**Based on content from github.com_ceef3d0b_20250624_193648.html:**

*   **Root cause of vulnerability:** The vulnerability stems from a bypass of picklescan's blacklist, allowing for the exfiltration of sensitive information during model deserialization. This bypass is achieved by exploiting the `ssl.get_server_certificate` function within a pickle payload. Since `ssl` is a standard Python library, it's often not blacklisted by security scanners.
*   **Weaknesses/vulnerabilities present:**
    *   Bypass of picklescan's blacklist.
    *   Exfiltration of sensitive data via DNS resolution.
    *   Use of `ssl.get_server_certificate` to trigger DNS requests.
    *   Deserialization of malicious pickle payloads.
*   **Impact of exploitation:**
    *   Evade detection from picklescan.
    *   Exfiltrate sensitive local files to an attacker-controlled DNS server.
*   **Attack vectors:**
    *   Crafting a malicious pickle payload.
    *   Embedding exfiltrated data in subdomains of a crafted FQDN.
    *   Triggering DNS resolution via `ssl.get_server_certificate`.
*   **Required attacker capabilities/position:**
    *   Ability to craft a malicious pickle payload.
    *   Control over a DNS server to receive exfiltrated data.
*   **Mitigation or fix:** The affected version is `< 0.0.25` and the patched version is `0.0.25`.

**More Detail than CVE description:** This content provides detailed information on the root cause, attack vectors, and impact of the vulnerability, including a Proof of Concept (PoC) and the fix.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.113 |
| 2 | 356 | Product UI does not Warn User of Unsafe Actions | Base | Allowed | sparse | 0.102 |
| 3 | 915 | Improperly Controlled Modification of Dynamically-Determined Object Attributes | Base | Allowed | sparse | 0.098 |
| 4 | 1392 | Use of Default Credentials | Base | Allowed | sparse | 0.098 |
| 5 | 330 | Use of Insufficiently Random Values | Class | Discouraged | sparse | 0.094 |
| 6 | 183 | Permissive List of Allowed Inputs | Base | Allowed | sparse | 0.093 |
| 7 | 267 | Privilege Defined With Unsafe Actions | Base | Allowed | sparse | 0.091 |
| 8 | 917 | Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection') | Base | Allowed | sparse | 0.090 |
| 9 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | dense | 0.491 |
| 10 | 804 | Guessable CAPTCHA | Base | Allowed | graph | 0.002 |

