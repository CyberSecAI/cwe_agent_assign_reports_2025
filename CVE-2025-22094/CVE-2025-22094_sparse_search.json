{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved powerpc/perf Fix ref-counting on the PMU vpa_pmu Commit 176cda0619b6 (powerpc/perf Add perf interface to expose vpa counters) introduced vpa_pmu to expose Book3s-HV nested APIv2 provided L1L2 context switch latency counters to L1 user-space via perf-events. However the newly introduced PMU named vpa_pmu doesnt assign ownership of the PMU to the module vpa_pmu. Consequently the module vpa_pmu can be unloaded while one of the perf-events are still active, which can lead to kernel oops and panic of the form below on a Pseries-LPAR BUG Kernel NULL pointer dereference on read at 0x00000058 NIP [c000000000506cb8] event_sched_out+0x40/0x258 LR [c00000000050e8a4] __perf_remove_from_context+0x7c/0x2b0 Call Trace [c00000025fc3fc30] [c00000025f8457a8] 0xc00000025f8457a8 (unreliable) [c00000025fc3fc80] [fffffffffffffee0] 0xfffffffffffffee0 [c00000025fc3fcd0] [c000000000501e70] event_function+0xa8/0x120 Kernel panic - not syncing Aiee, killing interrupt handler! Fix this by adding the module ownership to vpa_pmu so that the module vpa_pmu is ref-counted and prevented from being unloaded when perf-events are initialized.",
  "keyphrases": {
    "rootcause": [
      "improper ref-counting"
    ],
    "weakness": [
      "Kernel NULL pointer dereference"
    ]
  },
  "timestamp": "2025-07-12 10:02:24",
  "cve_id": "CVE-2025-22094",
  "result_count": 14,
  "results": [
    {
      "cwe_id": "393",
      "name": "Return of Wrong Status Code",
      "score": 618.913818083278,
      "search_source": "rootcause:improper ref-counting"
    },
    {
      "cwe_id": "911",
      "name": "Improper Update of Reference Count",
      "score": 605.7133878780858,
      "search_source": "rootcause:improper ref-counting"
    },
    {
      "cwe_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 604.110902283878,
      "search_source": "rootcause:improper ref-counting"
    },
    {
      "cwe_id": "822",
      "name": "Untrusted Pointer Dereference",
      "score": 600.0852556723975,
      "search_source": "weakness:Kernel NULL pointer dereference"
    },
    {
      "cwe_id": "476",
      "name": "NULL Pointer Dereference",
      "score": 596.7996974978593,
      "search_source": "weakness:Kernel NULL pointer dereference"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 588.3846413837281,
      "search_source": "rootcause:improper ref-counting"
    },
    {
      "cwe_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "score": 586.7895638121192,
      "search_source": "rootcause:improper ref-counting"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "score": 580.1027552644769,
      "search_source": "rootcause:improper ref-counting"
    },
    {
      "cwe_id": "1284",
      "name": "Improper Validation of Specified Quantity in Input",
      "score": 574.8902009031689,
      "search_source": "rootcause:improper ref-counting"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 573.6427170381605,
      "search_source": "rootcause:improper ref-counting"
    },
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 564.637002691289,
      "search_source": "weakness:Kernel NULL pointer dereference"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "score": 561.7112927150287,
      "search_source": "weakness:Kernel NULL pointer dereference"
    },
    {
      "cwe_id": "787",
      "name": "Out-of-bounds Write",
      "score": 559.3817387035058,
      "search_source": "weakness:Kernel NULL pointer dereference"
    },
    {
      "cwe_id": "908",
      "name": "Use of Uninitialized Resource",
      "score": 556.3682451469459,
      "search_source": "weakness:Kernel NULL pointer dereference"
    }
  ]
}