# Vulnerability Information: CVE-2025-22094

## Vulnerability Description
In the Linux kernel, the following vulnerability has been resolved powerpc/perf Fix ref-counting on the PMU vpa_pmu Commit 176cda0619b6 (powerpc/perf Add perf interface to expose vpa counters) introduced vpa_pmu to expose Book3s-HV nested APIv2 provided L1L2 context switch latency counters to L1 user-space via perf-events. However the newly introduced PMU named vpa_pmu doesnt assign ownership of the PMU to the module vpa_pmu. Consequently the module vpa_pmu can be unloaded while one of the perf-events are still active, which can lead to kernel oops and panic of the form below on a Pseries-LPAR BUG **Kernel NULL pointer dereference** on read at 0x00000058 NIP [c000000000506cb8] event_sched_out+0x40/0x258 LR [c00000000050e8a4] __perf_remove_from_context+0x7c/0x2b0 Call Trace [c00000025fc3fc30] [c00000025f8457a8] 0xc00000025f8457a8 (unreliable) [c00000025fc3fc80] [fffffffffffffee0] 0xfffffffffffffee0 [c00000025fc3fcd0] [c000000000501e70] event_function+0xa8/0x120 Kernel panic - not syncing Aiee, killing interrupt handler! Fix this by adding the module ownership to vpa_pmu so that the module vpa_pmu is ref-counted and prevented from being unloaded when perf-events are initialized.

### Vulnerability Description Key Phrases
- **rootcause:** **improper ref-counting**
- **weakness:** **Kernel NULL pointer dereference**
- **impact:** kernel oops and panic
- **product:** Linux kernel
- **component:** powerpc/perf vpa_pmu

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 393 | Return of Wrong Status Code | Base | Allowed | sparse | 0.619 |
| 2 | 911 | Improper Update of Reference Count | Base | Allowed | sparse | 0.606 |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | Allowed-with-Review | sparse | 0.604 |
| 4 | 822 | Untrusted Pointer Dereference | Base | Allowed | sparse | 0.600 |
| 5 | 476 | NULL Pointer Dereference | Base | Allowed | sparse | 0.597 |
| 6 | 667 | Improper Locking | Class | Allowed-with-Review | sparse | 0.588 |
| 7 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.587 |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.580 |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | Allowed | dense | 0.522 |
| 10 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | Variant | Allowed | graph | 0.003 |

