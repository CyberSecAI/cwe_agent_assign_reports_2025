{
  "method": "sparse_rootcause_1",
  "query": "In the Linux kernel, the following vulnerability has been resolved powerpc/perf Fix ref-counting on the PMU vpa_pmu Commit 176cda0619b6 (powerpc/perf Add perf interface to expose vpa counters) introduced vpa_pmu to expose Book3s-HV nested APIv2 provided L1L2 context switch latency counters to L1 user-space via perf-events. However the newly introduced PMU named vpa_pmu doesnt assign ownership of the PMU to the module vpa_pmu. Consequently the module vpa_pmu can be unloaded while one of the perf-events are still active, which can lead to kernel oops and panic of the form below on a Pseries-LPAR BUG Kernel NULL pointer dereference on read at 0x00000058 NIP [c000000000506cb8] event_sched_out+0x40/0x258 LR [c00000000050e8a4] __perf_remove_from_context+0x7c/0x2b0 Call Trace [c00000025fc3fc30] [c00000025f8457a8] 0xc00000025f8457a8 (unreliable) [c00000025fc3fc80] [fffffffffffffee0] 0xfffffffffffffee0 [c00000025fc3fcd0] [c000000000501e70] event_function+0xa8/0x120 Kernel panic - not syncing Aiee, killing interrupt handler! Fix this by adding the module ownership to vpa_pmu so that the module vpa_pmu is ref-counted and prevented from being unloaded when perf-events are initialized.",
  "keyphrases": {
    "rootcause": "improper ref-counting"
  },
  "timestamp": "2025-07-14T10:12:55.948557",
  "results_count": 10,
  "results_summary": [
    {
      "doc_id": "393",
      "name": "Return of Wrong Status Code",
      "score": 618.913818083278
    },
    {
      "doc_id": "911",
      "name": "Improper Update of Reference Count",
      "score": 605.7133878780858
    },
    {
      "doc_id": "362",
      "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
      "score": 604.110902283878
    },
    {
      "doc_id": "667",
      "name": "Improper Locking",
      "score": 588.3846413837281
    },
    {
      "doc_id": "639",
      "name": "Authorization Bypass Through User-Controlled Key",
      "score": 586.7895638121192
    }
  ]
}