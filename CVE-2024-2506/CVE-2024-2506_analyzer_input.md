# Vulnerability Information: CVE-2024-2506

## Vulnerability Description
The Popup Builder - Create highly converting, mobile friendly marketing popups. plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the custom JS functionality in all versions up to, and including, 4.2.7 due to **insufficient input sanitization and output escaping on user supplied attributes**. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping on user supplied attributes**
- **weakness:** **cross-site scripting**
- **impact:** inject arbitrary web scripts
- **attacker:** authenticated attackers
- **product:** Popup Builder - Create highly converting WordPress plugin
- **version:** all versions up to 4.2.7

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of CVE-2024-2506:

**1. Verification of CVE Relevance:**

   - The provided content from Wordfence directly references CVE-2024-2506.
   - The description from Wordfence matches the CVE description provided, indicating that the content is relevant to this CVE.

**2. Extracted Information:**

   - **Root Cause of Vulnerability:**
     - Insufficient input sanitization and output escaping within the "custom JS functionality" of the Popup Builder plugin.
   - **Weaknesses/Vulnerabilities Present:**
     - Stored Cross-Site Scripting (XSS) vulnerability.
   - **Impact of Exploitation:**
     - Attackers can inject arbitrary web scripts into pages. These scripts will execute whenever a user accesses the injected pages, potentially leading to:
       - Cookie theft
       - Session hijacking
       - Redirection to malicious sites
       - Defacement of the web site.
   - **Attack Vectors:**
     - Injecting malicious JavaScript code via the custom JS functionality of the plugin.
   - **Required Attacker Capabilities/Position:**
      - Authenticated attacker with contributor-level access or higher.
      - Access to the WordPress admin panel of the target website.

**Additional details and considerations:**

*   The Wordfence description explicitly mentions that the vulnerability is due to insufficient input sanitization and output escaping.
*   The affected versions are all versions up to, and including, 4.2.7 of the Popup Builder plugin.
*   The vulnerability has been patched in version 4.3.0.
*   The WordPress.org Trac changeset provides code-level details on specific files modified to fix the vulnerabilities, particularly focusing on sanitization and escaping contexts. These changes involve:
    * Replacing hardcoded text domains (e.g., 'SG\_POPUP\_TEXT\_DOMAIN') with 'popup-builder'
    * Sanitizing or escaping output in several files
    * Use of `wp_json_encode` instead of `json_encode`
    * Proper use of `esc_url` and `esc_html` in relevant contexts.
    * Ensuring nonce verification on actions.
    * Using `gmdate()` over `date()` for database inserts.
*   The Wordfence analysis provides the CVSS vector string, CVSS score, and information about the researcher and dates of publication and update. This highlights the severity of the issue and provides context for its evaluation.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.578 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.542 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.513 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.493 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.435 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.414 |
| 7 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.406 |
| 8 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.404 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.471 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |

