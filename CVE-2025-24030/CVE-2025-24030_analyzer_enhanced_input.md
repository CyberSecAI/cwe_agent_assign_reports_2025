## Vulnerability Description
Envoy Gateway is an open source project for managing Envoy Proxy as a standalone or Kubernetes-based application gateway. A user with access to the Kubernetes cluster can use a **path traversal attack** to execute Envoy Admin interface commands on proxies managed by any version of Envoy Gateway prior to 1.2.6. The admin interface can be used to terminate the Envoy process and extract the Envoy configuration (possibly containing confidential data). Version 1.2.6 fixes the issue. As a workaround, the `EnvoyProxy` API can be used to apply a bootstrap config patch that restricts access strictly to the prometheus stats endpoint. Find below an example of such a bootstrap patch.

### Vulnerability Description Key Phrases
- **weakness:** **path traversal attack**
- **product:** Envoy Gateway
- **impact:** execute Envoy Admin interface commands, terminate the Envoy process, extract the Envoy configuration
- **attacker:** user with access to the Kubernetes cluster
- **version:** prior to 1.2.6

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on information relevant to CVE-2025-24030, and any additional context it provides.

**Content from github.com_d9ebcbed_20250624_191239.html**

*   **Vulnerability:** Envoy Admin Interface Exposed through prometheus metrics endpoint (GHSA-j777-63hf-hx76) - **MORE DETAIL THAN CVE DESCRIPTION**
    *   **Root cause of vulnerability:** A path traversal attack can be used to execute Envoy Admin interface commands via the Prometheus metrics endpoint. The admin interface can be used to terminate the Envoy process and extract the Envoy configuration.
    *   **Weaknesses/vulnerabilities present:** Path Traversal (CWE-419 is listed), and the admin interface can be used to extract sensitive information such as the Envoy configuration.
    *   **Impact of exploitation:**
        *   Ability to execute Envoy Admin interface commands.
        *   Termination of the Envoy process.
        *   Extraction of the Envoy configuration, potentially containing confidential data.
    *   **Attack vectors:**
        *   A user with access to a Kubernetes cluster where Envoy Gateway is installed.
        *   Using a path traversal attack on the Prometheus metrics endpoint.
        *   Example command: `curl --path-as-is http://<Proxy-Service-ClusterIP>:19001/stats/prometheus/../../config_dump`
    *   **Required attacker capabilities/position:** Access to the Kubernetes cluster where Envoy Gateway is installed.
    *   **Mitigation or fix:**
        *   Upgrade to Envoy Gateway version 1.2.6 or later.
        *   Workaround: Apply a bootstrap config patch to restrict access strictly to the Prometheus stats endpoint. Example provided in the content.

**Content from www.envoyproxy.io_3d0e5f67_20250624_191241.html**

*   **Relevance:** Provides detailed information about the Envoy administration interface and its functionalities.
*   **Details**:
    *   Describes the administration interface, its endpoints, and potential risks.
    *   Highlights the importance of securing access to the administration interface, recommending a secure network or localhost access.
    *   Provides documentation on endpoints like `/config_dump` which can be used to extract configuration data.
    *   Details about `/stats/prometheus` endpoint are provided, which is related to the vulnerability.

**Content from www.envoyproxy.io_f7e6afaa_20250624_191239.html**

*   **Relevance:** Configuration best practices for Envoy, specifically focusing on edge proxy configurations.
*   **Details:**
    *   Provides configuration recommendations for edge proxies, including setting `normalize_path` and `merge_slashes` to mitigate path confusion vulnerabilities.
    *   Recommends settings for the `path_with_escaped_slashes_action` configuration option.
    *   Includes example YAML configurations demonstrating the recommended settings.

**Overall:**

The provided content from `github.com_d9ebcbed_20250624_191239.html` directly addresses the vulnerability, providing a detailed description, impact, attack vector, and mitigation. The other content from `www.envoyproxy.io` provides related context by explaining the Envoy admin interface, its functionalities, and best practices for configuration, which relate to the overall security considerations of Envoy deployments.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 697 | Incorrect Comparison | Pillar | Discouraged | sparse | 0.625 |
| 3 | 287 | Improper Authentication | Class | Discouraged | sparse | 0.596 |
| 4 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.594 |
| 5 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.585 |
| 6 | 923 | Improper Restriction of Communication Channel to Intended Endpoints | Class | Allowed-with-Review | sparse | 0.570 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.566 |
| 8 | 285 | Improper Authorization | Class | Discouraged | sparse | 0.550 |
| 9 | 941 | Incorrectly Specified Destination in a Communication Channel | Base | Allowed | dense | 0.468 |
| 10 | 613 | Insufficient Session Expiration | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-697: Incorrect Comparison

CWE-287: Improper Authentication

CWE-863: Incorrect Authorization

CWE-23: Relative Path Traversal

CWE-923: Improper Restriction of Communication Channel to Intended Endpoints

CWE-306: Missing Authentication for Critical Function

CWE-285: Improper Authorization

CWE-941: Incorrectly Specified Destination in a Communication Channel

CWE-613: Insufficient Session Expiration