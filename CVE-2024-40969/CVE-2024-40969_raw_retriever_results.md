# Raw Retriever Results for CVE-2024-40969

# Raw Retriever Results for CVE-2024-40969
## Query
In the Linux kernel, the following vulnerability has been resolved f2fs dont set RO when shutting down f2fs Shutdown does not check the error of thaw_super due to readonly, which causes a deadlock like below. f2fs_ioc_shutdown(F2FS_GOING_DOWN_FULLSYNC) issue_discard_thread - bdev_freeze - freeze_super - f2fs_stop_checkpoint() - f2fs_handle_critical_error - sb_start_write - set RO - waiting - bdev_thaw - thaw_super_locked - return -EINVAL, if sb_rdonly() - f2fs_stop_discard_thread -> wait for kthread_stop(discard_thread)

## Keyphrases
- **rootcause**: 'Shutdown does not check the error of thaw_super due to readonly'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4085 | 0.4821 | 0.4243 | 0.4169 | 20 |
| Sparse | 59.4214 | 279.1762 | 216.4969 | 240.4423 | 12 |
| Graph | 1.3216 | 2.2100 | 1.6932 | 1.6848 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 619 | Dangling Database Cursor ('Cursor Injection') | base | 2.2100 | Allowed |
| 2 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 3 | 129 | Improper Validation of Array Index | variant | 1.8394 | Allowed |
| 4 | 456 | Missing Initialization of a Variable | variant | 1.8394 | Allowed |
| 5 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 6 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 7 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 8 | 590 | Free of Memory not on the Heap | variant | 1.7117 | Allowed |
| 9 | 833 | Deadlock | Base | 1.6994 | Allowed |
| 10 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 11 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 12 | 413 | Improper Resource Locking | Base | 1.6812 | Allowed |
| 13 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 14 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 15 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 833 | Deadlock | Base | 0.4821 | 0.4821 | Allowed |
| 2 | 667 | Improper Locking | Class | 0.4546 | 0.4546 | Allowed-with-Review |
| 3 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.4526 | 0.4526 | Allowed-with-Review |
| 4 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.4379 | 0.4379 | Allowed |
| 5 | 413 | Improper Resource Locking | Base | 0.4349 | 0.4349 | Allowed |
| 6 | 908 | Use of Uninitialized Resource | Base | 0.4329 | 0.4329 | Allowed |
| 7 | 909 | Missing Initialization of Resource | Class | 0.4277 | 0.4277 | Allowed-with-Review |
| 8 | 1351 | Improper Handling of Hardware Behavior in Exceptionally Cold Environments | Base | 0.4224 | 0.4224 | Allowed |
| 9 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.4207 | 0.4207 | Allowed |
| 10 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4180 | 0.4180 | Allowed |
| 11 | 1326 | Missing Immutable Root of Trust in Hardware | Base | 0.4158 | 0.4158 | Allowed |
| 12 | 366 | Race Condition within a Thread | Base | 0.4122 | 0.4122 | Allowed |
| 13 | 775 | Missing Release of File Descriptor or Handle after Effective Lifetime | Variant | 0.4107 | 0.4107 | Allowed |
| 14 | 416 | Use After Free | Variant | 0.4098 | 0.4098 | Allowed |
| 15 | 911 | Improper Update of Reference Count | Base | 0.4097 | 0.4097 | Allowed |

## Sparse Retriever Results (12)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 833 | Deadlock | 279.1762 | 279.1762 | Allowed |
| 2 | 667 | Improper Locking | 259.8003 | 259.8003 | Allowed-with-Review |
| 3 | 404 | Improper Resource Shutdown or Release | 254.0302 | 254.0302 | Allowed-with-Review |
| 4 | 909 | Missing Initialization of Resource | 246.1336 | 246.1336 | Allowed-with-Review |
| 5 | 863 | Incorrect Authorization | 243.0587 | 243.0587 | Allowed-with-Review |
| 6 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 241.4029 | 241.4029 | Allowed |
| 7 | 252 | Unchecked Return Value | 239.4817 | 239.4817 | Allowed |
| 8 | 401 | Missing Release of Memory after Effective Lifetime | 239.1309 | 239.1309 | Allowed |
| 9 | 352 | Cross-Site Request Forgery (CSRF) | 238.7631 | 238.7631 | Allowed |
| 10 | 754 | Improper Check for Unusual or Exceptional Conditions | 237.9712 | 237.9712 | Allowed-with-Review |
| 11 | 400 | Uncontrolled Resource Consumption | 59.5921 | 59.5921 | Discouraged |
| 12 | 61 | UNIX Symbolic Link (Symlink) Following | 59.4214 | 59.4214 | Allowed |
