{
  "retriever": "sparse",
  "query": "In the Linux kernel, the following vulnerability has been resolved f2fs dont set RO when shutting down f2fs Shutdown does not check the error of thaw_super due to readonly, which causes a deadlock like below. f2fs_ioc_shutdown(F2FS_GOING_DOWN_FULLSYNC) issue_discard_thread - bdev_freeze - freeze_super - f2fs_stop_checkpoint() - f2fs_handle_critical_error - sb_start_write - set RO - waiting - bdev_thaw - thaw_super_locked - return -EINVAL, if sb_rdonly() - f2fs_stop_discard_thread -> wait for kthread_stop(discard_thread)",
  "keyphrases": {
    "rootcause": [
      "Shutdown does not check the error of thaw_super due to readonly"
    ]
  },
  "timestamp": "2025-07-13 12:44:48",
  "cve_id": "CVE-2024-40969",
  "result_count": 12,
  "results": [
    {
      "cwe_id": "833",
      "name": "Deadlock",
      "score": 279.1762292174809,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "667",
      "name": "Improper Locking",
      "score": 259.80034531019385,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "404",
      "name": "Improper Resource Shutdown or Release",
      "score": 254.03019513317827,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "909",
      "name": "Missing Initialization of Resource",
      "score": 246.13363208892258,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "863",
      "name": "Incorrect Authorization",
      "score": 243.05865788479872,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "367",
      "name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
      "score": 241.40292201903208,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "252",
      "name": "Unchecked Return Value",
      "score": 239.48165944858408,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "401",
      "name": "Missing Release of Memory after Effective Lifetime",
      "score": 239.13092083328104,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "352",
      "name": "Cross-Site Request Forgery (CSRF)",
      "score": 238.76306808723675,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "754",
      "name": "Improper Check for Unusual or Exceptional Conditions",
      "score": 237.97117083713505,
      "search_source": "rootcause:Shutdown does not check the error of thaw_super due to readonly"
    },
    {
      "cwe_id": "400",
      "name": "Uncontrolled Resource Consumption",
      "score": 59.59205409527481,
      "search_source": "base_query"
    },
    {
      "cwe_id": "61",
      "name": "UNIX Symbolic Link (Symlink) Following",
      "score": 59.42143064533877,
      "search_source": "base_query"
    }
  ]
}