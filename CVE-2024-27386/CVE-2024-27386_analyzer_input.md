# Vulnerability Information: CVE-2024-27386

## Vulnerability Description
A vulnerability was discovered in the slsi_handle_nan_rx_event_log_ind function in Samsung Mobile Processor Exynos 1380 and Exynos 1480 related to **no input validation check on tag_len** for tx coming from userspace, which can lead to heap overwrite.

### Vulnerability Description Key Phrases
- **rootcause:** **no input validation check on tag_len**
- **impact:** heap overwrite
- **product:** Samsung Mobile Processor Exynos 1380 and Exynos 1480
- **component:** slsi_handle_nan_rx_event_log_ind function

## CVE Reference Links Content Summary
Based on the provided content, here's an analysis of CVE-2024-27386:

**Root cause of vulnerability:**
- The vulnerability lies in the `slsi_handle_nan_rx_event_log_ind()` function within the Samsung Mobile Processor.
- The function fails to perform input validation on the `tag_len` parameter when handling data received from userspace.

**Weaknesses/vulnerabilities present:**
- Lack of input validation: The primary weakness is the absence of a check on the `tag_len` value. This allows a malicious actor to potentially provide an arbitrary length for tag\_len.
- Heap overflow: By providing an excessively large value for tag\_len, it becomes possible to cause a heap-based buffer overflow.

**Impact of exploitation:**
- The exploitation of this vulnerability can lead to a heap overwrite, potentially resulting in a crash, arbitrary code execution or privilege escalation.

**Attack vectors:**
- The attack vector is through userspace interaction with the vulnerable function.
- An attacker can send malicious input with a manipulated `tag_len` value.

**Required attacker capabilities/position:**
- An attacker needs to have the capability to interact with the `slsi_handle_nan_rx_event_log_ind()` function from userspace.
- The attacker needs to have the ability to manipulate the `tag_len` parameter.

**Affected Products:**
- Exynos 1380
- Exynos 1480

**Severity:**
- Medium

**Reported Date:**
- 2024-01-31

**Acknowledgement:**
- jiayy

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.232 |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | Allowed | sparse | 0.217 |
| 3 | 190 | Integer Overflow or Wraparound | Base | Allowed | sparse | 0.215 |
| 4 | 20 | Improper Input Validation | Class | Discouraged | sparse | 0.213 |
| 5 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.213 |
| 6 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.206 |
| 7 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.205 |
| 8 | 909 | Missing Initialization of Resource | Class | Allowed-with-Review | sparse | 0.205 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | dense | 0.593 |
| 10 | 170 | Improper Null Termination | Base | Allowed | graph | 0.003 |

