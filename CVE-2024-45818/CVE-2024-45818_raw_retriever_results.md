# Raw Retriever Results for CVE-2024-45818

# Raw Retriever Results for CVE-2024-45818
## Query
The hypervisor contains code to accelerate VGA memory accesses for HVM guests, when the (virtual) VGA is in standard mode. Locking involved there has an unusual discipline, leaving a lock acquired past the return from the function that acquired it. This behavior results in a problem when emulating an instruction with two memory accesses, both of which touch VGA memory (plus some further constraints which arent relevant here). When emulating the 2nd access, the lock that is already being held would be attempted to be re-acquired, resulting in a deadlock. This deadlock was already found when the code was first introduced, but was analysed incorrectly and the fix was incomplete. Analysis in light of the new finding cannot find a way to make the existing locking discipline work. In staging, this logic has all been removed because it was discovered to be accidentally disabled since Xen 4.7. Therefore, we are fixing the locking problem by backporting the removal of most of the feature. Note that even with the feature disabled, the lock would still be acquired for any accesses to the VGA MMIO region.

## Keyphrases
- **weakness**: 'deadlock'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4337 | 0.5232 | 0.4643 | 0.4603 | 20 |
| Sparse | 795.1760 | 993.8138 | 838.9494 | 808.6908 | 10 |
| Graph | 1.4821 | 2.2100 | 1.6969 | 1.6796 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 476 | NULL Pointer Dereference | base | 2.2100 | Allowed |
| 2 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 3 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |
| 4 | 123 | Write-what-where Condition | base | 1.7680 | Allowed |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | class | 1.7680 | Allowed-with-Review |
| 6 | 364 | Signal Handler Race Condition | base | 1.7550 | Allowed |
| 7 | 833 | Deadlock | Base | 1.6875 | Allowed |
| 8 | 1265 | Unintended Reentrant Invocation of Non-reentrant Code Via Nested Calls | base | 1.6848 | Allowed |
| 9 | 1325 | Improperly Controlled Sequential Memory Allocation | base | 1.6848 | Allowed |
| 10 | 252 | Unchecked Return Value | base | 1.6848 | Allowed |
| 11 | 386 | Symbolic Name not Mapping to Correct Object | base | 1.6744 | Allowed |
| 12 | 662 | Improper Synchronization | class | 1.6736 | Discouraged |
| 13 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 1.6653 | Allowed |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | compound | 1.6100 | Allowed |
| 15 | 1262 | Improper Access Control for Register Interface | Base | 1.6096 | Allowed |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1274 | Improper Access Control for Volatile Memory Containing Boot Code | Base | 0.5232 | 0.5232 | Allowed |
| 2 | 591 | Sensitive Data Storage in Improperly Locked Memory | Variant | 0.5130 | 0.5130 | Allowed |
| 3 | 1342 | Information Exposure through Microarchitectural State after Transient Execution | Base | 0.4873 | 0.4873 | Allowed |
| 4 | 833 | Deadlock | Base | 0.4873 | 0.4873 | Allowed |
| 5 | 1262 | Improper Access Control for Register Interface | Base | 0.4838 | 0.4838 | Allowed |
| 6 | 1421 | Exposure of Sensitive Information in Shared Microarchitectural Structures during Transient Execution | Base | 0.4834 | 0.4834 | Allowed |
| 7 | 1222 | Insufficient Granularity of Address Regions Protected by Register Locks | Variant | 0.4762 | 0.4762 | Allowed |
| 8 | 1257 | Improper Access Control Applied to Mirrored or Aliased Memory Regions | Base | 0.4744 | 0.4744 | Allowed |
| 9 | 1260 | Improper Handling of Overlap Between Protected Memory Ranges | Base | 0.4725 | 0.4725 | Allowed |
| 10 | 667 | Improper Locking | Class | 0.4664 | 0.4664 | Allowed-with-Review |
| 11 | 1233 | Security-Sensitive Hardware Controls with Missing Lock Bit Protection | Base | 0.4542 | 0.4542 | Allowed |
| 12 | 1281 | Sequence of Processor Instructions Leads to Unexpected Behavior | Base | 0.4490 | 0.4490 | Allowed |
| 13 | 1264 | Hardware Logic with Insecure De-Synchronization between Control and Data Channels | Base | 0.4486 | 0.4486 | Allowed |
| 14 | 413 | Improper Resource Locking | Base | 0.4451 | 0.4451 | Allowed |
| 15 | 832 | Unlock of a Resource that is not Locked | Base | 0.4424 | 0.4424 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 667 | Improper Locking | 993.8138 | 993.8138 | Allowed-with-Review |
| 2 | 833 | Deadlock | 942.8168 | 942.8168 | Allowed |
| 3 | 1390 | Weak Authentication | 819.9885 | 819.9885 | Allowed-with-Review |
| 4 | 909 | Missing Initialization of Resource | 816.1037 | 816.1037 | Allowed-with-Review |
| 5 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 810.0314 | 810.0314 | Allowed-with-Review |
| 6 | 754 | Improper Check for Unusual or Exceptional Conditions | 807.3501 | 807.3501 | Allowed-with-Review |
| 7 | 863 | Incorrect Authorization | 805.8286 | 805.8286 | Allowed-with-Review |
| 8 | 755 | Improper Handling of Exceptional Conditions | 801.1633 | 801.1633 | Discouraged |
| 9 | 125 | Out-of-bounds Read | 797.2221 | 797.2221 | Allowed |
| 10 | 287 | Improper Authentication | 795.1760 | 795.1760 | Discouraged |
