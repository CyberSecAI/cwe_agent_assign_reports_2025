# Vulnerability Information: CVE-2024-48286

## Vulnerability Description
Linksys E3000 1.0.06.002_US is vulnerable to **command injection** via the diag_ping_start function.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **product:** Linksys E3000
- **version:** 1.0.06.002_US
- **component:** diag_ping_start function

## CVE Reference Links Content Summary
The provided content describes a command execution vulnerability in a Linksys E3000 router.

**Root cause of vulnerability:** The vulnerability stems from insufficient input sanitization in the `diag_ping_start` function within the router's httpd server.

**Weaknesses/vulnerabilities present:**
- **Command Injection:** The `ping_ip` parameter, received from HTTP requests, is directly incorporated into a command executed by the router. Lack of sanitization allows an attacker to inject arbitrary commands through this parameter.

**Impact of exploitation:**
- **Remote Code Execution (RCE):** Successful exploitation allows an attacker to execute arbitrary commands on the router, potentially gaining full control.
- **Router compromise:** An attacker could use the vulnerability to compromise the router and potentially use it to access the local network or other connected devices.
- **Rebooting the router:** The provided PoC demonstrates the ability to reboot the router, causing a denial of service.

**Attack vectors:**
- **HTTP Requests:** The attack is performed via HTTP requests to the `/apply.cgi` endpoint.
- **`ping_ip` Parameter:** The malicious command is injected into the `ping_ip` parameter.

**Required attacker capabilities/position:**
- **Network Access:** The attacker must have network access to the router's web interface (e.g., being on the same network or having access through port forwarding).
- **No Authentication Bypass Required:** The attacker must be able to send a request with a valid `session_id` cookie, this PoC assumes that they already are authenticated.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.093 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.092 |
| 5 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.091 |
| 6 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.086 |
| 7 | 1236 | Improper Neutralization of Formula Elements in a CSV File | Base | Allowed | sparse | 0.086 |
| 8 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.084 |
| 9 | 134 | Use of Externally-Controlled Format String | Base | Allowed | dense | 0.552 |
| 10 | 123 | Write-what-where Condition | Base | Allowed | graph | 0.002 |

