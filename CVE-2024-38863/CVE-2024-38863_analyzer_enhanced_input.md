## Vulnerability Description
**Exposure of CSRF tokens in query parameters** on specific requests in Checkmk GmbHs Checkmk versions <2.3.0p18, <2.2.0p35 and <2.1.0p48 could lead to a leak of the token to facilitate targeted phishing attacks.

### Vulnerability Description Key Phrases
- **rootcause:** **Exposure of CSRF tokens in query parameters**
- **impact:** leak of the token and phishing
- **product:** Checkmk GmbHs Checkmk
- **version:** versions <2.3.0p18 and <2.2.0p35 and <2.1.0p48

## CVE Reference Links Content Summary
- **Root cause of vulnerability**: The CSRF token was mistakenly included as a query parameter in certain URLs when navigating Checkmk.
- **Weaknesses/vulnerabilities present**: CSRF token leakage via URL parameters, specifically the `csrf_token=` parameter. This can lead to the token being saved in bookmarks or shared unintentionally.
- **Impact of exploitation**: The leaked token, while not an immediate security threat, could potentially enable phishing attacks targeting the specific user for the duration of the token's validity. A successful phishing attack could allow an attacker to impersonate the user and perform actions as that user.
- **Attack vectors**:
    - Unintentional exposure via sharing bookmarks or URLs containing the CSRF token.
    - Phishing attacks targeting users with leaked CSRF tokens.
- **Required attacker capabilities/position**:
    - The attacker needs to acquire a leaked CSRF token. This can happen through social engineering (phishing) or via leaked bookmarks.
    - The attacker needs to target a user within the validity of the leaked token (session duration).
    - The attacker needs to trick the user into visiting a malicious site with the user's valid CSRF token, which allows the attacker to perform actions on the user's behalf.

The provided information includes a CVSS score (2.0 Low), and details specific affected versions of Checkmk. It also provides mitigations and confirms the issue was found during internal review.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 598 | Use of GET Request Method With Sensitive Query Strings | Variant | Allowed | sparse | 0.278 |
| 2 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.247 |
| 3 | 943 | Improper Neutralization of Special Elements in Data Query Logic | Class | Allowed-with-Review | sparse | 0.244 |
| 4 | 532 | Insertion of Sensitive Information into Log File | Base | Allowed | sparse | 0.234 |
| 5 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.231 |
| 6 | 319 | Cleartext Transmission of Sensitive Information | Base | Allowed | sparse | 0.230 |
| 7 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.227 |
| 8 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.223 |
| 9 | 614 | Sensitive Cookie in HTTPS Session Without 'Secure' Attribute | Variant | Allowed | dense | 0.515 |
| 10 | 1275 | Sensitive Cookie with Improper SameSite Attribute | Variant | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-598: Use of GET Request Method With Sensitive Query Strings

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-943: Improper Neutralization of Special Elements in Data Query Logic

CWE-532: Insertion of Sensitive Information into Log File

CWE-138: Improper Neutralization of Special Elements

CWE-319: Cleartext Transmission of Sensitive Information

CWE-201: Insertion of Sensitive Information Into Sent Data

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute

CWE-1275: Sensitive Cookie with Improper SameSite Attribute