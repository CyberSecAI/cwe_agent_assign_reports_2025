## Vulnerability Description
cashbook v4.0.3 has an **arbitrary file read vulnerability** in /api/entry/flow/invoice/show?invoice=.

### Vulnerability Description Key Phrases
- **weakness:** **arbitrary file read vulnerability**
- **product:** cashbook
- **version:** v4.0.3
- **component:** /api/entry/flow/invoice/show?invoice=

## CVE Reference Links Content Summary
CVE-2025-27980: PLACEHOLDER - Implement CVE description retrieval

The content discusses an arbitrary file read vulnerability in cashbook v4.0.3. Here's a breakdown of the information:

**Root cause of vulnerability:**
The vulnerability is due to a lack of input validation on the `invoice` parameter in the URL `https://cashbook.oldmoon.top/api/entry/flow/invoice/show?invoice=.. /.. /.. /.. /.. /.. /etc/passwd`. The application directly returns the content of the file specified by this parameter without proper sanitization.

**Weaknesses/vulnerabilities present:**
*   Arbitrary File Read
*   Lack of Input Validation
*   Path Traversal

**Impact of exploitation:**
An attacker can read any file on the server that the application has access to, potentially exposing sensitive information like `/etc/passwd`.

**Attack vectors:**
*   Crafting a malicious URL with a path traversal sequence (`../`) to access arbitrary files.  Example: `https://cashbook.oldmoon.top/api/entry/flow/invoice/show?invoice=.. /.. /.. /.. /.. /.. /etc/passwd`

**Required attacker capabilities/position:**
*   Network access to the vulnerable application.
*   Ability to craft and send HTTP requests.

**Mitigation or fix:**
The blog post does not provide specific mitigation steps, but the vulnerability can be fixed by implementing proper input validation and sanitization of the `invoice` parameter to prevent path traversal attacks.  Specifically, the application should not allow directory traversal characters (like "..") in the input.

The content provides more detail than a placeholder CVE description would. It gives a specific example of a vulnerable URL and explains how the vulnerability can be exploited.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.079 |
| 2 | 269 | Improper Privilege Management | Class | Discouraged | sparse | 0.072 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.072 |
| 4 | 610 | Externally Controlled Reference to a Resource in Another Sphere | Class | Discouraged | sparse | 0.071 |
| 5 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 0.070 |
| 6 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.070 |
| 7 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.069 |
| 8 | 1391 | Use of Weak Credentials | Class | Allowed-with-Review | sparse | 0.069 |
| 9 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | dense | 0.488 |
| 10 | 385 | Covert Timing Channel | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

CWE-269: Improper Privilege Management

CWE-138: Improper Neutralization of Special Elements

CWE-610: Externally Controlled Reference to a Resource in Another Sphere

CWE-208: Observable Timing Discrepancy

CWE-94: Improper Control of Generation of Code ('Code Injection')

CWE-306: Missing Authentication for Critical Function

CWE-1391: Use of Weak Credentials

CWE-639: Authorization Bypass Through User-Controlled Key

CWE-385: Covert Timing Channel