# Vulnerability Information: CVE-2024-5479

## Vulnerability Description
The Easy Pixels plugin for WordPress is vulnerable to Stored Cross-Site Scripting via plugin settings in all versions up to, and including, 2.13 due to **insufficient input sanitization and output escaping**. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient input sanitization and output escaping**
- **weakness:** **cross-site scripting**
- **impact:** inject arbitrary web scripts
- **attacker:** unauthenticated attackers
- **product:** Easy Pixels WordPress plugin
- **version:** up to and including 2.13
- **component:** plugin settings

## CVE Reference Links Content Summary
### CVE-2024-5479
Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The root cause is insufficient input sanitization and output escaping within the Easy Pixels plugin's settings.

**Vulnerabilities:**
- **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize user-supplied input when saving plugin settings. This allows an attacker to inject malicious scripts that are then stored in the database and executed in a user's browser when they view the affected page.

**Impact of Exploitation:**
- **Arbitrary Script Execution:** Successful exploitation allows attackers to execute arbitrary JavaScript in the context of a user's browser.
- **Malicious Actions:** This can lead to a wide range of malicious activities, including:
    - Redirecting users to malicious sites.
    - Stealing user session cookies.
    - Defacing website content.
    - Performing actions on behalf of the user.

**Attack Vectors:**
- The primary attack vector is through the plugin's settings. An unauthenticated attacker can inject malicious JavaScript code into the plugin settings (e.g., tracking codes) via a POST request that updates the plugin options.

**Required Attacker Capabilities/Position:**
- **Unauthenticated Access:** The attacker does not need to be authenticated to exploit the vulnerability.
- **Network Access:** The attacker must be able to send POST requests to the vulnerable endpoint.

**Additional Details:**

- The vulnerability is present in all versions of the Easy Pixels plugin up to and including version 2.13.
- The plugin's admin settings page at `/admin/easyPixelsAdmin.php` and the main plugin file `easyPixels.php` are implicated as the areas where the unsanitized input is handled.
- The plugin settings are stored in the database without proper sanitization.
- The vulnerability is triggered when the stored malicious scripts are rendered on a page, affecting any user who visits the injected page.
- There is no known patch available, and the suggested remediation is to uninstall the plugin.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.477 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.472 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.432 |
| 4 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.409 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.363 |
| 6 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.338 |
| 7 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.331 |
| 8 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.330 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | dense | 0.579 |
| 10 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | graph | 0.002 |

