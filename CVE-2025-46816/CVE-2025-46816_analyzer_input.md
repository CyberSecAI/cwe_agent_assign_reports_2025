# Vulnerability Information: CVE-2025-46816

## Vulnerability Description
goshs is a SimpleHTTPServer written in Go. Starting in version 0.3.4 and prior to version 1.0.5, running goshs without arguments makes it possible for anyone to execute commands on the server. The function `dispatchReadPump` does not checks the option cli `-c`, thus allowing anyone to execute arbitrary command through the use of websockets. Version 1.0.5 fixes the issue.

### Vulnerability Description Key Phrases
- **rootcause:** **dispatchReadPump does not checks the option cli -c**
- **impact:** execute arbitrary command and execute commands
- **vector:** websockets
- **product:** goshs
- **version:** 0.3.4 to 1.0.4
- **component:** SimpleHTTPServer

## CVE Reference Links Content Summary
## CVE-2025-46816 Analysis

Here's an analysis of the provided content related to CVE-2025-46816, extracted and formatted according to the guidelines:

**1. Verification:**

The content directly references CVE-2025-46816 and details a security vulnerability in the `goshs` project. Therefore, it is relevant to the specified CVE.

**2. Extracted Information:**

*   **Root cause of vulnerability:** The `dispatchReadPump` function in `ws/client.go` does not check for the `-c` cli option, allowing arbitrary command execution via websockets.
*   **Weaknesses/vulnerabilities present:** Lack of input validation/sanitization, specifically regarding command execution triggered through websocket messages.  The CWE identified is CWE-284: Improper Access Control.
*   **Impact of exploitation:**  Allows anyone to execute commands on the server running a vulnerable version of `goshs`. This could lead to complete system compromise (High Confidentiality, High Integrity, Low Availability).
*   **Attack vectors:**  Exploitation occurs via sending a JSON payload containing a command through a websocket connection to the `goshs` server.  The provided PoC uses `websocat`.
*   **Required attacker capabilities/position:**  An attacker needs network access to the `goshs` server's websocket endpoint (port 8000 in the PoC). No authentication is required.
*   **Mitigation or fix:** The commit `1602209` addresses the issue by adding a check for `cliEnabled` before executing commands and passing the CLI object to the `NewHub` function.  Updating to version 1.0.5 (patched version) resolves the vulnerability.
*   **Affected versions:** v0.3.4 - 1.0.4
*   **Patched versions:** 1.0.5
*   **CVSS Score:** 9.4 (Critical)
    *   Attack Vector: Network
    *   Attack Complexity: Low
    *   Privileges Required: None
    *   User Interaction: None
    *   Scope: Unchanged
    *   Confidentiality: High
    *   Integrity: High
    *   Availability: Low

**3. Additional Details:**

The provided content includes a detailed description of the vulnerability, a proof-of-concept (PoC) for exploitation, and information about the fix implemented in the patched version. The commit details show the specific code changes made to address the vulnerability. The CVSS vector is also provided.

This content provides more detail than the placeholder CVE description.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | sparse | 0.387 |
| 2 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.387 |
| 3 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | sparse | 0.374 |
| 4 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.373 |
| 5 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | sparse | 0.372 |
| 6 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.369 |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.366 |
| 8 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | sparse | 0.366 |
| 9 | 650 | Trusting HTTP Permission Methods on the Server Side | Variant | Allowed | dense | 0.347 |
| 10 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | graph | 0.002 |

