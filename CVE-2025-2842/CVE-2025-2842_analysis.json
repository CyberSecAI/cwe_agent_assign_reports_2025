{
  "cve_id": "CVE-2025-2842",
  "description": "A flaw was found in the Tempo Operator. When the Jaeger UI Monitor Tab functionality is enabled in a Tempo instance managed by the Tempo Operator, the Operator creates a ClusterRoleBinding for the Service Account of the Tempo instance to grant the cluster-monitoring-view ClusterRole. This can be exploited if a user has create permissions on TempoStack and get permissions on Secret in a namespace (for example, a user has ClusterAdmin permissions for a specific namespace), as the user can read the token of the Tempo service account and therefore has access to see all cluster metrics.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "",
    "impact": "access all cluster metrics",
    "vector": "",
    "attacker": "user with create permissions on TempoStack and get permissions on Secret in a namespace",
    "product": "Tempo Operator",
    "version": "",
    "component": "Jaeger UI Monitor Tab functionality"
  },
  "reference_content": "Here's an analysis of the provided content, focusing on the information relevant to CVE-2025-2842:\n\n**1. Content from access.redhat.com_aaadff0b_20250624_122140.html**\n\n*   **Relevance:** Yes, this content relates to CVE-2025-2842. The document is a Red Hat Security Advisory (RHSA-2025:3740) that lists CVE-2025-2842.\n\n*   **Content:**\n    *   **Vulnerability:** The advisory references CVE-2025-2842.\n    *   **Product:** Red Hat OpenShift distributed tracing platform (Tempo)\n    *   **Description:** Bug fixes are included in the updated release.\n    *   **Impact:** The advisory indicates an Important severity.\n\n**2. Content from bugzilla.redhat.com**\n\n*   **Relevance:** Yes, this content is directly related to CVE-2025-2842.\n\n*   **Content:**\n    *   **Vulnerability:** Tempo Operator Token Exposition leads to read sensitive data.\n    *   **Root cause:** When the Jaeger UI Monitor Tab functionality is enabled in a Tempo instance managed by the Tempo Operator, the operator creates a ClusterRoleBinding for the Service Account of the Tempo instance to grant the cluster-monitoring-view ClusterRole.\n    *   **Impact of exploitation:** A user with 'create' permissions on TempoStack and 'get' permissions on Secret in a namespace can read the token of the Tempo service account and therefore has access to see all cluster metrics.\n    *   **Required attacker capabilities/position:** A user must have 'create' permissions on TempoStack and 'get' permissions on Secret in a namespace.\n    *   **Severity:** Medium\n\n**3. Other Content**\n\n*   All other provided content from `access.redhat.com` are not directly related to the CVE and are therefore labeled as UNRELATED.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-266 | Incorrect Privilege Assignment | 0.8 | Base | Primary | Allowed |\n| CWE-863 | Incorrect Authorization | 0.6 | Class | Secondary | Allowed-with-Review |\n| CWE-732 | Incorrect Permission Assignment for Critical Resource | 0.5 | Class | Secondary | Allowed-with-Review |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship influencing the selection is the parent-child relationship. CWE-266 \"Incorrect Privilege Assignment\" is a base CWE and a child of the class CWE-269 \"Improper Privilege Management\". The vulnerability description indicates the Operator assigns the Tempo instance's service account with cluster-monitoring-view ClusterRole which is an incorrect privilege assignment. This makes CWE-266 a better fit than its parent, CWE-269.\n\nCWE-863 \"Incorrect Authorization\" and CWE-732 \"Incorrect Permission Assignment for Critical Resource\" are also considered because the vulnerability involves incorrect access control, but they are deemed less specific than CWE-266, which focuses on the **incorrect privilege assignment** itself.\n\n```mermaid\ngraph TD\n    cwe266[\"CWE-266: Incorrect Privilege Assignment\"]\n    cwe269[\"CWE-269: Improper Privilege Management\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe732[\"CWE-732: Incorrect Permission Assignment for Critical Resource\"]\n\n    cwe266 -->|CHILDOF| cwe269\n    cwe863 -->|PEEROF| cwe266\n    cwe732 -->|PEEROF| cwe266\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe266 primary\n    class cwe863,cwe732 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **incorrect privilege assignment** (CWE-266) by the Tempo Operator when enabling the Jaeger UI Monitor Tab. This allows a user with specific permissions ('create' on TempoStack and 'get' on Secret) to read the Tempo service account token, leading to unauthorized access to all cluster metrics.\n\nCWE-266 (Incorrect Privilege Assignment) -> User with specific permissions gains access to service account token -> Unauthorized access to all cluster metrics.\n\n## Summary of Analysis\nThe analysis is primarily based on the provided vulnerability description and CVE reference links content summary, focusing on the root cause identified in the bugzilla.redhat.com content: \"When the Jaeger UI Monitor Tab functionality is enabled in a Tempo instance managed by the Tempo Operator, the operator creates a ClusterRoleBinding for the Service Account of the Tempo instance to grant the cluster-monitoring-view ClusterRole.\"\n\nThe graph relationships influenced the selection by highlighting the hierarchical structure and peer relationships between relevant CWEs. This aided in identifying the most specific and appropriate CWE to represent the vulnerability.\n\nCWE-266 is at the optimal level of specificity because it directly addresses the **incorrect privilege assignment**, which is the root cause of the vulnerability. While CWE-863 and CWE-732 are related to authorization and permission issues, they are less specific to the initial **incorrect privilege assignment**.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-266: Incorrect Privilege Assignment\n**Abstraction Level**: Base\n**Similarity Score**: 0.78\n**Source**: dense\n\n**Description**:\nA product incorrectly assigns a privilege to a particular actor, creating an unintended sphere of control for that actor.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-863: Incorrect Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 1840.53\n**Source**: sparse\n\n**Description**:\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-732: Incorrect Permission Assignment for Critical Resource\n**Abstraction Level**: Class\n**Similarity Score**: 1745.53\n**Source**: sparse\n\n**Description**:\nThe product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: While the name itself indicates an assignment of permissions for resources, this is often misused for vulnerabilities in which \"permissions\" are not checked, which is an \"authorization\" weakness (CWE-285 or descendants) within CWE's model [REF-1287].\n\n## Technical Explanation for Selected CWEs:\n\n*   **CWE-266: Incorrect Privilege Assignment**\n\n    *   **Match:** The Tempo Operator **incorrectly assigns** the `cluster-monitoring-view` ClusterRole to the Tempo instance's service account, granting it broader access than intended.\n    *   **Security Implications:** This allows unauthorized users with specific permissions to access sensitive cluster metrics.\n    *   **Relationships:** Child of CWE-269 (Improper Privilege Management).\n    *   **Usage:** The MITRE mapping guidance allows for the use of CWE-266.\n    *   **Primary/Secondary:** Primary, as this is the root cause of the vulnerability.\n*   **CWE-863: Incorrect Authorization**\n\n    *   **Match:** The **authorization** check is present, but it is **incorrect**, leading to unauthorized access to cluster metrics.\n    *   **Security Implications:** A user is able to read the token of the Tempo service account.\n    *   **Relationships:** Class-level CWE, potentially related to more specific authorization flaws.\n    *   **Usage:** Allowed-with-Review.\n    *   **Primary/Secondary:** Secondary, as a potential consequence of the privilege assignment.\n*   **CWE-732: Incorrect Permission Assignment for Critical Resource**\n\n    *   **Match:** The ClusterRoleBinding for the service account can be considered an **incorrect permission assignment** for a critical resource, allowing unauthorized access.\n    *   **Security Implications:** Access to all cluster metrics.\n    *   **Relationships:** Class-level CWE.\n    *   **Usage:** Allowed-with-Review, but the guidance notes potential for misuse if \"permissions\" are not checked.\n    *   **Primary/Secondary:** Secondary, as it's a related aspect but not the primary root cause.\n\n## CWEs Considered but Not Used:\n\n*   **CWE-269: Improper Privilege Management:** While related, CWE-266 provides a more specific description of the vulnerability.\n*   **CWE-285: Improper Authorization:** This is more generic than the specific issue of privilege assignment.\n*   **CWE-306: Missing Authentication for Critical Function:** Authentication is not missing, but the authorization based on the assigned privileges is flawed.\n*   **CWE-732: Incorrect Permission Assignment for Critical Resource:** While related to permission issues, it is more accurately described as a privilege assignment issue.",
  "analysis_with_relationships": "# Summary\n| CWE ID | CWE Name | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n|---|---|---|---|---|---|\n| CWE-266 | Incorrect Privilege Assignment | 0.8 | Base | Primary | Allowed |\n| CWE-863 | Incorrect Authorization | 0.6 | Class | Secondary | Allowed-with-Review |\n| CWE-732 | Incorrect Permission Assignment for Critical Resource | 0.5 | Class | Secondary | Allowed-with-Review |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.7\n*   **Evidence Strength:** MEDIUM\n\n## Relationship Analysis\nThe primary relationship influencing the selection is the parent-child relationship. CWE-266 \"Incorrect Privilege Assignment\" is a base CWE and a child of the class CWE-269 \"Improper Privilege Management\". The vulnerability description indicates the Operator assigns the Tempo instance's service account with cluster-monitoring-view ClusterRole which is an incorrect privilege assignment. This makes CWE-266 a better fit than its parent, CWE-269.\n\nCWE-863 \"Incorrect Authorization\" and CWE-732 \"Incorrect Permission Assignment for Critical Resource\" are also considered because the vulnerability involves incorrect access control, but they are deemed less specific than CWE-266, which focuses on the **incorrect privilege assignment** itself.\n\n```mermaid\ngraph TD\n    cwe266[\"CWE-266: Incorrect Privilege Assignment\"]\n    cwe269[\"CWE-269: Improper Privilege Management\"]\n    cwe863[\"CWE-863: Incorrect Authorization\"]\n    cwe732[\"CWE-732: Incorrect Permission Assignment for Critical Resource\"]\n\n    cwe266 -->|CHILDOF| cwe269\n    cwe863 -->|PEEROF| cwe266\n    cwe732 -->|PEEROF| cwe266\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n    class cwe266 primary\n    class cwe863,cwe732 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **incorrect privilege assignment** (CWE-266) by the Tempo Operator when enabling the Jaeger UI Monitor Tab. This allows a user with specific permissions ('create' on TempoStack and 'get' on Secret) to read the Tempo service account token, leading to unauthorized access to all cluster metrics.\n\nCWE-266 (Incorrect Privilege Assignment) -> User with specific permissions gains access to service account token -> Unauthorized access to all cluster metrics.\n\n## Summary of Analysis\nThe analysis is primarily based on the provided vulnerability description and CVE reference links content summary, focusing on the root cause identified in the bugzilla.redhat.com content: \"When the Jaeger UI Monitor Tab functionality is enabled in a Tempo instance managed by the Tempo Operator, the operator creates a ClusterRoleBinding for the Service Account of the Tempo instance to grant the cluster-monitoring-view ClusterRole.\"\n\nThe graph relationships influenced the selection by highlighting the hierarchical structure and peer relationships between relevant CWEs. This aided in identifying the most specific and appropriate CWE to represent the vulnerability.\n\nCWE-266 is at the optimal level of specificity because it directly addresses the **incorrect privilege assignment**, which is the root cause of the vulnerability. While CWE-863 and CWE-732 are related to authorization and permission issues, they are less specific to the initial **incorrect privilege assignment**.\n\nRelevant CWE Information:\n\n# Enhanced Context (25 CWEs)\nThe following CWEs were identified as potentially relevant to this vulnerability:\n\n## CWE-266: Incorrect Privilege Assignment\n**Abstraction Level**: Base\n**Similarity Score**: 0.78\n**Source**: dense\n\n**Description**:\nA product incorrectly assigns a privilege to a particular actor, creating an unintended sphere of control for that actor.\n\n**Mapping Guidance**:\n- Usage: Allowed\n- Rationale: This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n\n## CWE-863: Incorrect Authorization\n**Abstraction Level**: Class\n**Similarity Score**: 1840.53\n**Source**: sparse\n\n**Description**:\nThe product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: This CWE entry is a Class and might have Base-level children that would be more appropriate\n\n## CWE-732: Incorrect Permission Assignment for Critical Resource\n**Abstraction Level**: Class\n**Similarity Score**: 1745.53\n**Source**: sparse\n\n**Description**:\nThe product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.\n\n**Mapping Guidance**:\n- Usage: Allowed-with-Review\n- Rationale: While the name itself indicates an assignment of permissions for resources, this is often misused for vulnerabilities in which \"permissions\" are not checked, which is an \"authorization\" weakness (CWE-285 or descendants) within CWE's model [REF-1287].\n\n## Technical Explanation for Selected CWEs:\n\n*   **CWE-266: Incorrect Privilege Assignment**\n\n    *   **Match:** The Tempo Operator **incorrectly assigns** the `cluster-monitoring-view` ClusterRole to the Tempo instance's service account, granting it broader access than intended.\n    *   **Security Implications:** This allows unauthorized users with specific permissions to access sensitive cluster metrics.\n    *   **Relationships:** Child of CWE-269 (Improper Privilege Management).\n    *   **Usage:** The MITRE mapping guidance allows for the use of CWE-266.\n    *   **Primary/Secondary:** Primary, as this is the root cause of the vulnerability.\n*   **CWE-863: Incorrect Authorization**\n\n    *   **Match:** The **authorization** check is present, but it is **incorrect**, leading to unauthorized access to cluster metrics.\n    *   **Security Implications:** A user is able to read the token of the Tempo service account.\n    *   **Relationships:** Class-level CWE, potentially related to more specific authorization flaws.\n    *   **Usage:** Allowed-with-Review.\n    *   **Primary/Secondary:** Secondary, as a potential consequence of the privilege assignment.\n*   **CWE-732: Incorrect Permission Assignment for Critical Resource**\n\n    *   **Match:** The ClusterRoleBinding for the service account can be considered an **incorrect permission assignment** for a critical resource, allowing unauthorized access.\n    *   **Security Implications:** Access to all cluster metrics.\n    *   **Relationships:** Class-level CWE.\n    *   **Usage:** Allowed-with-Review, but the guidance notes potential for misuse if \"permissions\" are not checked.\n    *   **Primary/Secondary:** Secondary, as it's a related aspect but not the primary root cause.\n\n## CWEs Considered but Not Used:\n\n*   **CWE-269: Improper Privilege Management:** While related, CWE-266 provides a more specific description of the vulnerability.\n*   **CWE-285: Improper Authorization:** This is more generic than the specific issue of privilege assignment.\n*   **CWE-306: Missing Authentication for Critical Function:** Authentication is not missing, but the authorization based on the assigned privileges is flawed.\n*   **CWE-732: Incorrect Permission Assignment for Critical Resource:** While related to permission issues, it is more accurately described as a privilege assignment issue.\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-863:**\n- 863 (Incorrect Authorization) - ROOT\n\n\n**Chain starting from CWE-732:**\n- 732 (Incorrect Permission Assignment for Critical Resource) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 195.60244229798315
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 192.78945770468223
    },
    {
      "metadata": {
        "doc_id": "285",
        "name": "Improper Authorization",
        "source": "sparse"
      },
      "similarity": 190.9825857594431
    },
    {
      "metadata": {
        "doc_id": "532",
        "name": "Insertion of Sensitive Information into Log File",
        "source": "sparse"
      },
      "similarity": 190.7355348385151
    },
    {
      "metadata": {
        "doc_id": "732",
        "name": "Incorrect Permission Assignment for Critical Resource",
        "source": "sparse"
      },
      "similarity": 188.81169039038835
    },
    {
      "metadata": {
        "doc_id": "923",
        "name": "Improper Restriction of Communication Channel to Intended Endpoints",
        "source": "sparse"
      },
      "similarity": 184.06744918878385
    },
    {
      "metadata": {
        "doc_id": "269",
        "name": "Improper Privilege Management",
        "source": "sparse"
      },
      "similarity": 181.9932078392733
    },
    {
      "metadata": {
        "doc_id": "1390",
        "name": "Weak Authentication",
        "source": "sparse"
      },
      "similarity": 181.76940036924358
    },
    {
      "metadata": {
        "doc_id": "379",
        "name": "Creation of Temporary File in Directory with Insecure Permissions",
        "type": "Base",
        "original_content": "The product creates a temporary file in a directory whose permissions allow unintended actors to determine the file's existence or otherwise access that file.",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.4353501496229854,
            "graph": 1.6380593245005897
          }
        }
      },
      "similarity": 0.4353501496229854
    },
    {
      "doc_id": "385",
      "text": "CWE-385: Covert Timing Channel",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "385",
        "name": "Covert Timing Channel",
        "type": "base",
        "original_content": "CWE-385: Covert Timing Channel",
        "relationships": [
          {
            "source_id": "385",
            "target_id": "208",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "385",
            "target_id": "514",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "514",
            "target_id": "385",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "208",
            "target_id": "385",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "208",
                  "385",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "208"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "208",
                  "385",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_forward",
              "source": "208"
            }
          }
        },
        "position": "after",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-863",
      "CWE-732",
      "CWE-306",
      "CWE-269",
      "CWE-285",
      "CWE-266"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}