{
  "cve_id": "CVE-2024-49357",
  "description": "ZimaOS is a fork of CasaOS, an operating system for Zima devices and x86-64 systems with UEFI. In version 1.2.4 and all prior versions, the API endpoints in ZimaOS, such as `http///v1/users/image?path=/var/lib/casaos/1/app_order.json` and `http///v1/users/image?path=/var/lib/casaos/1/system.json`, expose sensitive data like installed applications and system information without requiring any authentication or authorization. This sensitive data leak can be exploited by attackers to gain detailed knowledge about the system setup, installed applications, and other critical information. As of time of publication, no known patched versions are available.",
  "key_phrases": {
    "rootcause": "",
    "weakness": "no authentication or authorization",
    "impact": [
      "data leak",
      "expose sensitive data"
    ],
    "vector": "",
    "attacker": "attackers",
    "product": "ZimaOS",
    "version": "1.2.4 and all prior versions",
    "component": "API endpoints"
  },
  "reference_content": "Based on the provided content, here's the breakdown of the vulnerability:\n\n**Root Cause:**\nThe root cause is the lack of authentication and authorization checks on API endpoints that expose sensitive system information and installed application data. Specifically, the `/v1/users/image` endpoint allows access to files like `app_order.json` and `system.json` without requiring any form of authentication.\n\n**Weaknesses/Vulnerabilities:**\n- **Insecure Direct Object Reference:** The API directly exposes file paths without access control.\n- **Missing Authentication:** No authentication is required to access the sensitive endpoints.\n- **Missing Authorization:** No authorization checks are performed to limit access based on user roles or permissions.\n- **Information Exposure:** Sensitive files like `app_order.json` and `system.json` are directly accessible to unauthorized users.\n\n**Impact of Exploitation:**\n- **Sensitive Information Disclosure:** Attackers can gain access to detailed information about the system, including installed applications, OS version, hostname, CPU info, and memory.\n- **System Profiling:**  Attackers can use this information to profile the system, understand its configuration, and identify potential vulnerabilities.\n- **Targeted Attacks:** The gathered information enables attackers to craft specific and more effective attacks.\n\n**Attack Vectors:**\n- **Network-based:** The vulnerability is exposed through network accessible API endpoints, namely `http://<Server-IP>/v1/users/image?path=/var/lib/casaos/1/app_order.json` and `http://<Server-IP>/v1/users/image?path=/var/lib/casaos/1/system.json`.\n- **Remote Access:** An attacker can exploit this vulnerability remotely by sending GET requests to the specified endpoints\n\n**Required Attacker Capabilities/Position:**\n- **Network Access:** The attacker needs network access to the server running the vulnerable ZimaOS.\n- **No Authentication Required:** The attacker does not need any credentials to exploit the vulnerability.\n- **Basic HTTP Knowledge:** The attacker needs the ability to send HTTP GET requests.\n\n**Additional Details:**\n- The provided proof-of-concept (PoC) clearly demonstrates how to exploit the vulnerability by sending GET requests to the unauthenticated endpoints.\n- Example responses from the API are included, illustrating the type of sensitive data exposed.\n- The vulnerability is rated as high severity due to the ease of exploitation and the sensitivity of the leaked information.\n- The affected versions include ZimaOS versions up to v1.2.4, with version 1.2.5 addressing the vulnerability.\n- The vulnerability is classified under CWE-200: Information Exposure.",
  "similar_info": {
    "cwe_distribution": {},
    "cwe_consensus": "",
    "similarity_stats": {
      "thresholds": [],
      "total_samples_by_threshold": {},
      "top_cwes_by_threshold": {}
    }
  },
  "similarity_summary": {
    "consensus_cwe": "",
    "top_cwes": [],
    "confidence_levels": {},
    "total_samples": 0
  },
  "analysis": "# Summary\n| CWE ID   | CWE Name                                                              | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :--------------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :-------------------------------- |\n| CWE-306 | Missing Authentication for Critical Function                           | 1.0        | Base                  | Primary                         | Allowed                           |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.7        | Class                  | Secondary                         | Discouraged                           |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is the **missing authentication** which directly leads to **exposure of sensitive information**. CWE-306 (Missing Authentication for Critical Function) is the root cause, allowing unauthorized access. CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) is a consequence of the missing authentication. CWE-306 is a base level CWE, and CWE-200 is a class level CWE. More specific child CWEs of CWE-200 could exist, but the description does not provide enough information to narrow it down further.\n\n```mermaid\ngraph TD\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    \n    cwe200 -->|CANFOLLOW| cwe306\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe306 primary\n    class cwe200 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing authentication (CWE-306)**, which then directly leads to the **exposure of sensitive information (CWE-200)**.\n\n`Missing Authentication` -> `Information Exposure`\n\n## Summary of Analysis\nThe primary issue is the **lack of authentication** on API endpoints, allowing unauthorized access to sensitive information. This is a clear case of **CWE-306 (Missing Authentication for Critical Function)**. The impact of this **weakness** is the **exposure of sensitive information**, which is represented by **CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor)**.\n\nThe vulnerability description clearly states: \"API endpoints in ZimaOS, such as `http///v1/users/image?path=/var/lib/casaos/1/app_order.json` and `http///v1/users/image?path=/var/lib/casaos/1/system.json`, expose sensitive data like installed applications and system information **without requiring any authentication or authorization**.\" This directly supports the selection of CWE-306 as the root cause.\n\nThe \"CVE Reference Links Content Summary\" further confirms this: \"The root cause is the **lack of authentication** and authorization checks on API endpoints that expose sensitive system information and installed application data.\"\n\nThe guidance provided reinforces this decision: \"CWE-306: Missing Authentication for Critical Function \u2013 used when no identity validation is enforced for sensitive functionality\".\n\nI considered other CWEs, such as CWE-284 (Improper Access Control), CWE-862 (Missing Authorization), and CWE-668 (Exposure of Resource to Wrong Sphere). However, CWE-306 is the most accurate because the vulnerability description explicitly mentions the **absence of authentication**. CWE-862 is not applicable because it deals with authorization issues after authentication, which is not the case here. CWE-284 is too general, and CWE-668 is a class-level CWE and less specific than CWE-200.\n\nCWE-200 is a relevant secondary weakness, since there is a direct exposure of sensitive information, and no authentication is required.\nThe selected CWEs are at the optimal level of specificity because they directly address the root cause (**missing authentication**) and the resulting impact (**information exposure**).",
  "analysis_with_relationships": "# Summary\n| CWE ID   | CWE Name                                                              | Confidence | CWE Abstraction Level | CWE Vulnerability Mapping Label | CWE-Vulnerability Mapping Notes |\n| :-------- | :--------------------------------------------------------------------- | :--------- | :-------------------- | :------------------------------ | :-------------------------------- |\n| CWE-306 | Missing Authentication for Critical Function                           | 1.0        | Base                  | Primary                         | Allowed                           |\n| CWE-200 | Exposure of Sensitive Information to an Unauthorized Actor | 0.7        | Class                  | Secondary                         | Discouraged                           |\n\n## Evidence and Confidence\n\n*   **Confidence Score:** 0.9\n*   **Evidence Strength:** HIGH\n\n## Relationship Analysis\nThe primary weakness is the **missing authentication** which directly leads to **exposure of sensitive information**. CWE-306 (Missing Authentication for Critical Function) is the root cause, allowing unauthorized access. CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) is a consequence of the missing authentication. CWE-306 is a base level CWE, and CWE-200 is a class level CWE. More specific child CWEs of CWE-200 could exist, but the description does not provide enough information to narrow it down further.\n\n```mermaid\ngraph TD\n    cwe306[\"CWE-306: Missing Authentication for Critical Function\"]\n    cwe200[\"CWE-200: Exposure of Sensitive Information to an Unauthorized Actor\"]\n    \n    cwe200 -->|CANFOLLOW| cwe306\n    \n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    \n    class cwe306 primary\n    class cwe200 secondary\n```\n\n## Vulnerability Chain\nThe vulnerability chain starts with the **missing authentication (CWE-306)**, which then directly leads to the **exposure of sensitive information (CWE-200)**.\n\n`Missing Authentication` -> `Information Exposure`\n\n## Summary of Analysis\nThe primary issue is the **lack of authentication** on API endpoints, allowing unauthorized access to sensitive information. This is a clear case of **CWE-306 (Missing Authentication for Critical Function)**. The impact of this **weakness** is the **exposure of sensitive information**, which is represented by **CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor)**.\n\nThe vulnerability description clearly states: \"API endpoints in ZimaOS, such as `http///v1/users/image?path=/var/lib/casaos/1/app_order.json` and `http///v1/users/image?path=/var/lib/casaos/1/system.json`, expose sensitive data like installed applications and system information **without requiring any authentication or authorization**.\" This directly supports the selection of CWE-306 as the root cause.\n\nThe \"CVE Reference Links Content Summary\" further confirms this: \"The root cause is the **lack of authentication** and authorization checks on API endpoints that expose sensitive system information and installed application data.\"\n\nThe guidance provided reinforces this decision: \"CWE-306: Missing Authentication for Critical Function \u2013 used when no identity validation is enforced for sensitive functionality\".\n\nI considered other CWEs, such as CWE-284 (Improper Access Control), CWE-862 (Missing Authorization), and CWE-668 (Exposure of Resource to Wrong Sphere). However, CWE-306 is the most accurate because the vulnerability description explicitly mentions the **absence of authentication**. CWE-862 is not applicable because it deals with authorization issues after authentication, which is not the case here. CWE-284 is too general, and CWE-668 is a class-level CWE and less specific than CWE-200.\n\nCWE-200 is a relevant secondary weakness, since there is a direct exposure of sensitive information, and no authentication is required.\nThe selected CWEs are at the optimal level of specificity because they directly address the root cause (**missing authentication**) and the resulting impact (**information exposure**).\n\n\n## CWE Relationship Analysis\n\nCurrent CWEs represent these abstraction levels: .\n\n\n### Vulnerability Chain Analysis\n\n**Chain starting from CWE-862:**\n- 862 (Missing Authorization) - ROOT\n\n\n**Chain starting from CWE-306:**\n- 306 (Missing Authentication for Critical Function) - ROOT\n\n\n\n### CWE Relationship Diagram\n\n```mermaid\ngraph TD\n    classDef primary fill:#f96,stroke:#333,stroke-width:2px\n    classDef secondary fill:#69f,stroke:#333\n    classDef tertiary fill:#9e9,stroke:#333\n```",
  "criticism": "",
  "resolution": "",
  "relevant_cwes": [
    {
      "metadata": {
        "doc_id": "284",
        "name": "Improper Access Control",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Authorization",
        "match_reason": "exact_match_compound_part_1"
      },
      "similarity": 1000.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "639",
        "name": "Authorization Bypass Through User-Controlled Key",
        "source": "alternate_terms",
        "original_matched_text": "AlternateTerms: Broken Object Level Authorization / BOLA",
        "match_reason": "phrase_in_term_compound_part_1"
      },
      "similarity": 700.0,
      "alternate_term_match": true
    },
    {
      "metadata": {
        "doc_id": "306",
        "name": "Missing Authentication for Critical Function",
        "source": "sparse"
      },
      "similarity": 469.10133150958114
    },
    {
      "metadata": {
        "doc_id": "863",
        "name": "Incorrect Authorization",
        "source": "sparse"
      },
      "similarity": 465.6671592136422
    },
    {
      "metadata": {
        "doc_id": "22",
        "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
        "source": "sparse"
      },
      "similarity": 463.579746958431
    },
    {
      "metadata": {
        "doc_id": "201",
        "name": "Insertion of Sensitive Information Into Sent Data",
        "source": "sparse"
      },
      "similarity": 454.3465354229423
    },
    {
      "metadata": {
        "doc_id": "200",
        "name": "Exposure of Sensitive Information to an Unauthorized Actor",
        "source": "sparse"
      },
      "similarity": 454.0870305413942
    },
    {
      "metadata": {
        "doc_id": "668",
        "name": "Exposure of Resource to Wrong Sphere",
        "source": "sparse"
      },
      "similarity": 446.0822378299989
    },
    {
      "metadata": {
        "doc_id": "1249",
        "name": "Application-Level Admin Tool with Inconsistent View of Underlying Operating System",
        "type": "Base",
        "original_content": "The product provides an application for administrators to manage parts of the underlying operating system, but the application does not accurately identify all of the relevant entities or resources that exist in the OS; that is, the application's model of the OS's state is inconsistent with the OS's actual state.",
        "keyphrase_source": "weakness:authorization",
        "source": "dense",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "dense",
            "graph"
          ],
          "retriever_count": 2,
          "normalized_scores": {
            "dense": 0.46030953178074024,
            "graph": 1.4614925863878292
          }
        }
      },
      "similarity": 0.46030953178074024
    },
    {
      "doc_id": "73",
      "text": "CWE-73: External Control of File Name or Path",
      "score": 2.2100000000000004,
      "metadata": {
        "doc_id": "73",
        "name": "External Control of File Name or Path",
        "type": "base",
        "original_content": "CWE-73: External Control of File Name or Path",
        "relationships": [
          {
            "source_id": "73",
            "target_id": "114",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "59",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "434",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "98",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "41",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "22",
            "label": "CANPRECEDE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "20",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "73",
            "target_id": "610",
            "label": "CHILDOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "73",
            "target_id": "642",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "99",
            "target_id": "73",
            "label": "CANALSOBE",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "98",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "642",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          },
          {
            "source_id": "610",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "59",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "434",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "41",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "22",
            "target_id": "73",
            "label": "CANFOLLOW",
            "properties": {
              "view_id": "1000"
            }
          },
          {
            "source_id": "20",
            "target_id": "73",
            "label": "PARENTOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "700"
            }
          },
          {
            "source_id": "114",
            "target_id": "73",
            "label": "CHILDOF",
            "properties": {
              "ordinal": "Primary",
              "view_id": "1000"
            }
          }
        ],
        "score_components": {
          "relationship_chain": 1.0,
          "sequence_path": 1.0
        },
        "abstraction_factor": 1.3,
        "graph_path_info": {
          "path_types": [
            "relationship_chain",
            "vulnerability_sequence_forward",
            "vulnerability_sequence_backward"
          ],
          "best_paths": {
            "relationship_chain": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 1.0,
              "type": "relationship_chain",
              "source": "22"
            },
            "vulnerability_sequence_forward": {
              "path": [
                [
                  "22",
                  "73",
                  "CANFOLLOW"
                ]
              ],
              "score": 0.9,
              "type": "vulnerability_sequence_forward",
              "source": "22"
            },
            "vulnerability_sequence_backward": {
              "path": [
                [
                  "73",
                  "22",
                  "CANPRECEDE"
                ]
              ],
              "score": 1.0,
              "type": "vulnerability_sequence_backward",
              "source": "22"
            }
          }
        },
        "position": "before",
        "sources": [
          "graph"
        ],
        "source": "graph",
        "mapping_notes": {
          "usage": "Allowed",
          "rationale": "This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.",
          "comments": "Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.",
          "reasons": [
            "Acceptable-Use"
          ]
        },
        "score_info": {
          "retrievers": [
            "graph"
          ],
          "retriever_count": 1,
          "normalized_scores": {
            "graph": 2.2100000000000004
          }
        }
      },
      "similarity": 2.2100000000000004
    }
  ],
  "identified_cwes": {
    "analyzer": [
      "CWE-862",
      "CWE-306",
      "CWE-668",
      "CWE-284",
      "CWE-200"
    ],
    "critic_additional": []
  },
  "keyphrase_cwe_mapping": {}
}