## Vulnerability Description
The Video Gallery Best WordPress YouTube Gallery Plugin plugin for WordPress is vulnerable to **time-based SQL Injection** via the orderby parameter in all versions up to, and including, 2.4.2 due to **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**. This makes it possible for authenticated attackers, with Administrator-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

### Vulnerability Description Key Phrases
- **rootcause:** **insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query**
- **weakness:** **time-based SQL Injection**
- **impact:** extract sensitive information from the database and information disclosure
- **attacker:** authenticated attackers with admin access
- **product:** Video Gallery Best WordPress YouTube Gallery Plugin
- **version:** up to and including 2.4.2
- **component:** orderby parameter

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-10247

**Root Cause of Vulnerability:**
- The vulnerability is a time-based SQL Injection due to insufficient escaping of the user-supplied `orderby` parameter and the lack of sufficient preparation on the existing SQL query.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The plugin fails to properly sanitize and escape user-supplied input, specifically the `orderby` parameter, before using it in an SQL query. This allows an attacker to inject arbitrary SQL code.
- **Insufficient Input Validation:** The plugin does not adequately validate or sanitize the `orderby` parameter, allowing malicious SQL code to be introduced.

**Impact of Exploitation:**
- **Sensitive Information Disclosure:** Attackers can extract sensitive information from the database by appending malicious SQL queries into the existing queries.
- **Complete Database Takeover:** In severe cases, an attacker could potentially gain full control of the database, potentially modifying or deleting data, adding rogue admin users, etc.

**Attack Vectors:**
- **HTTP Request:** The attacker injects malicious SQL code through the `orderby` parameter in a crafted HTTP request to the WordPress site.

**Required Attacker Capabilities/Position:**
- **Authentication:** The attacker must be authenticated as an administrator or higher-level user on the WordPress site.
- **Network Access:** The attacker must have network access to the WordPress site.

**Technical Details:**
- The vulnerable code is located in the `tsvg_get_galleries` function within the `class-tsvg-list.php` file of the plugin.
- The `orderby` parameter is not properly sanitized before being concatenated into the SQL query, allowing for SQL injection.
- The `sanitize_sql_orderby()` function, while present, is not used effectively to prevent the injection.
- The vulnerability is present in versions 2.4.2 and earlier.

**Additional Notes:**
- The Wordfence article provides a CVSS score of 7.2 (High) for the vulnerability.
- The vulnerability was publicly published on December 5, 2024.
- The vulnerability was discovered by the researcher `tmrswrr`.
- The vulnerability was patched in version 2.4.3 of the plugin.

**References:**
- [packetstormsecurity.com](https://packetstormsecurity.com/files/179387/WordPress-Video-Gallery-YouTube-Gallery-And-Vimeo-Gallery-2.3.6-SQL-Injection.html)
- [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/gallery-videos/trunk/admin/class-tsvg-list.php#L15)
- [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3200979/gallery-videos/trunk/admin/class-tsvg-list.php)

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.586 |
| 3 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.562 |
| 4 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.524 |
| 5 | 862 | Missing Authorization | Class | Allowed-with-Review | sparse | 0.518 |
| 6 | 90 | Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection') | Base | Allowed | sparse | 0.518 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.517 |
| 8 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.514 |
| 9 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | dense | 0.441 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-116: Improper Encoding or Escaping of Output

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-502: Deserialization of Untrusted Data

CWE-862: Missing Authorization

CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')

CWE-863: Incorrect Authorization

CWE-790: Improper Filtering of Special Elements

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-425: Direct Request ('Forced Browsing')