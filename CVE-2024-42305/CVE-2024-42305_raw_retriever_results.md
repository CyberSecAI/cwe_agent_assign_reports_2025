# Raw Retriever Results for CVE-2024-42305

# Raw Retriever Results for CVE-2024-42305
## Query
In the Linux kernel, the following vulnerability has been resolved ext4 check dot and dotdot of dx_root before making dir indexed Syzbot reports a issue as follows ============================================ BUG unable to handle page fault for address ffffed11022e24fe PGD 23ffee067 P4D 23ffee067 PUD 0 Oops Oops 0000 [#1] PREEMPT SMP KASAN PTI CPU 0 PID 5079 Comm syz-executor306 Not tainted 6.10.0-rc5-g55027e689933 #0 Call Trace make_indexed_dir+0xdaf/0x13c0 fs/ext4/namei.c2341 ext4_add_entry+0x222a/0x25d0 fs/ext4/namei.c2451 ext4_rename fs/ext4/namei.c3936 [inline] ext4_rename2+0x26e5/0x4370 fs/ext4/namei.c4214 [...] ============================================ The immediate cause of this problem is that there is only one valid dentry for the block to be split during do_split, so split==0 results in out of bounds accesses to the map triggering the issue. do_split unsigned split dx_make_map count = 1 split = count/2 = 0 continued = hash2 == map[split - 1].hash ---> map[4294967295] The maximum length of a filename is 255 and the minimum block size is 1024, so it is always guaranteed that the number of entries is greater than or equal to 2 when do_split() is called. But syzbots crafted image has no dot and dotdot in dir, and the dentry distribution in dirblock is as follows bus dentry1 hole dentry2 free |xx--|xx-------------|...............|xx-------------|........

## Keyphrases
No keyphrases provided.

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.4760 | 0.5115 | 0.4909 | 0.4877 | 20 |
| Sparse | 235.8803 | 252.4059 | 242.4790 | 241.7074 | 10 |
| Graph | 1.6848 | 2.8652 | 2.1027 | 2.0499 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 609 | Double-Checked Locking | base | 2.8652 | Allowed |
| 2 | 386 | Symbolic Name not Mapping to Correct Object | base | 2.7950 | Allowed |
| 3 | 1339 | Insufficient Precision or Accuracy of a Real Number | base | 2.3868 | Allowed |
| 4 | 128 | Wrap-around Error | base | 2.3868 | Allowed |
| 5 | 364 | Signal Handler Race Condition | base | 2.3400 | Allowed |
| 6 | 781 | Improper Address Validation in IOCTL with METHOD_NEITHER I/O Control Code | variant | 2.2704 | Allowed |
| 7 | 1322 | Use of Blocking Code in Single-threaded, Non-blocking Context | base | 2.2100 | Allowed |
| 8 | 824 | Access of Uninitialized Pointer | base | 2.2100 | Allowed |
| 9 | 825 | Expired Pointer Dereference | base | 2.2100 | Allowed |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 2.0522 | Allowed |
| 11 | 190 | Integer Overflow or Wraparound | Base | 2.0476 | Allowed |
| 12 | 416 | Use After Free | variant | 2.0400 | Allowed |
| 13 | 1284 | Improper Validation of Specified Quantity in Input | Base | 1.9755 | Allowed |
| 14 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 1.7938 | Allowed |
| 15 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | base | 1.7680 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | Class | 0.5115 | 0.5115 | Allowed-with-Review |
| 2 | 1285 | Improper Validation of Specified Index, Position, or Offset in Input | Base | 0.5095 | 0.5095 | Allowed |
| 3 | 61 | UNIX Symbolic Link (Symlink) Following | Compound | 0.5091 | 0.5091 | Allowed |
| 4 | 667 | Improper Locking | Class | 0.5080 | 0.5080 | Allowed-with-Review |
| 5 | 835 | Loop with Unreachable Exit Condition ('Infinite Loop') | Base | 0.5056 | 0.5056 | Allowed |
| 6 | 62 | UNIX Hard Link | Variant | 0.5019 | 0.5019 | Allowed |
| 7 | 1284 | Improper Validation of Specified Quantity in Input | Base | 0.4960 | 0.4960 | Allowed |
| 8 | 125 | Out-of-bounds Read | Base | 0.4945 | 0.4945 | Allowed |
| 9 | 909 | Missing Initialization of Resource | Class | 0.4934 | 0.4934 | Allowed-with-Review |
| 10 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | Base | 0.4888 | 0.4888 | Allowed |
| 11 | 476 | NULL Pointer Dereference | Base | 0.4866 | 0.4866 | Allowed |
| 12 | 190 | Integer Overflow or Wraparound | Base | 0.4846 | 0.4846 | Allowed |
| 13 | 126 | Buffer Over-read | Variant | 0.4820 | 0.4820 | Allowed |
| 14 | 131 | Incorrect Calculation of Buffer Size | Base | 0.4806 | 0.4806 | Allowed |
| 15 | 193 | Off-by-one Error | Base | 0.4805 | 0.4805 | Allowed |

## Sparse Retriever Results (10)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 1284 | Improper Validation of Specified Quantity in Input | 252.4059 | 252.4059 | Allowed |
| 2 | 191 | Integer Underflow (Wrap or Wraparound) | 251.0941 | 251.0941 | Allowed |
| 3 | 125 | Out-of-bounds Read | 245.8283 | 245.8283 | Allowed |
| 4 | 190 | Integer Overflow or Wraparound | 243.5819 | 243.5819 | Allowed |
| 5 | 367 | Time-of-check Time-of-use (TOCTOU) Race Condition | 243.0890 | 243.0890 | Allowed |
| 6 | 770 | Allocation of Resources Without Limits or Throttling | 240.3257 | 240.3257 | Allowed |
| 7 | 1335 | Incorrect Bitwise Shift of Integer | 238.5640 | 238.5640 | Allowed |
| 8 | 789 | Memory Allocation with Excessive Size Value | 237.3004 | 237.3004 | Allowed |
| 9 | 362 | Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') | 236.7201 | 236.7201 | Allowed-with-Review |
| 10 | 193 | Off-by-one Error | 235.8803 | 235.8803 | Allowed |
