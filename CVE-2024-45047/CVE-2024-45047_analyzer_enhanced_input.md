## Vulnerability Description
svelte performance oriented web framework. A potential **mXSS** vulnerability exists in Svelte for versions up to but not including 4.2.19. Svelte improperly escapes HTML on server-side rendering. The assumption is that attributes will always stay as such, but in some situation the final DOM tree rendered on browsers is different from what Svelte expects on server-side rendering. This may be leveraged to perform XSS attacks, and a type of the XSS is known as **mXSS** (mutation XSS). More specifically, this can occur when injecting malicious content into an attribute within a `noscript` tag. This issue has been addressed in release version 4.2.19. Users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **rootcause:** **improper escaping**
- **weakness:** **mXSS**
- **impact:** cross-site scripting
- **vector:** malicious content injection in noscript tag
- **product:** Svelte
- **version:** up to but not including 4.2.19

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** Improper HTML attribute escaping during server-side rendering. Svelte only escapes `"` to `&quot;` and `&` to `&amp;` in attribute values, and `<` to `&lt;` and `&` to `&amp;` outside of attribute values. This leads to XSS when malicious content is injected into attributes within a `<noscript>` tag, as the browser's DOM tree construction can differ from Svelte's expectation during server-side rendering.
- **Weaknesses/vulnerabilities present:** Insufficient escaping of HTML special characters, specifically within attribute values in `<noscript>` tags, leading to Cross-Site Scripting (XSS).
- **Impact of exploitation:** Execution of arbitrary JavaScript code in the context of the user's browser, potentially leading to data theft, session hijacking, or other malicious actions.
- **Attack vectors:** Network, by crafting a URL with malicious content in a query parameter that will be used as attribute value in a `<noscript>` tag.
- **Required attacker capabilities/position:** The attacker needs to be able to craft a malicious URL with a payload in a query parameter that is then used within an attribute of a `<noscript>` tag. The user needs to visit the crafted URL.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.630 |
| 3 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.617 |
| 4 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.605 |
| 5 | 918 | Server-Side Request Forgery (SSRF) | Base | Allowed | sparse | 0.603 |
| 6 | 113 | Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting') | Variant | Allowed | sparse | 0.574 |
| 7 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.572 |
| 8 | 203 | Observable Discrepancy | Base | Allowed | sparse | 0.563 |
| 9 | 80 | Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS) | Variant | Allowed | dense | 0.550 |
| 10 | 494 | Download of Code Without Integrity Check | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-138: Improper Neutralization of Special Elements

CWE-116: Improper Encoding or Escaping of Output

CWE-918: Server-Side Request Forgery (SSRF)

CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')

CWE-1333: Inefficient Regular Expression Complexity

CWE-203: Observable Discrepancy

CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)

CWE-494: Download of Code Without Integrity Check