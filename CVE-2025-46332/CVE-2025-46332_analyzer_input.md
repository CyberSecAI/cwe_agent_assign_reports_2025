# Vulnerability Information: CVE-2025-46332

## Vulnerability Description
Flags SDK is an open-source feature flags toolkit for Next.js and SvelteKit. Impacted versions include flags from 3.2.0 and prior and @vercel/flags from 3.1.1 and prior as certain circumstances allows a bad actor with detailed knowledge of the vulnerability to list all flags returned by the flags discovery endpoint (.well-known/vercel/flags). This vulnerability allows for information disclosure, where a bad actor could gain access to a list of all feature flags exposed through the flags discovery endpoint, including the flag names, flag descriptions, available options and their labels (e.g. true, false), and default flag values. This issue has been patched in flags@4.0.0, users of flags and @vercel/flags should also migrate to flags@4.0.0.

### Vulnerability Description Key Phrases
- **component:** .well-known/vercel/flags endpoint
- **product:** ['Flags SDK', '@vercel/flags']
- **impact:** Information disclosure, information disclosure
- **attacker:** bad actor
- **version:** ['3.2.0 and prior', '3.1.1 and prior']

## CVE Reference Links Content Summary
```
Root cause of vulnerability:
The vulnerability was due to an information disclosure issue in the Flags SDK. The vulnerability allowed a bad actor to list all flags returned by the flags discovery endpoint (`.well-known/vercel/flags`).

Weaknesses/vulnerabilities present:
The vulnerability allowed for information disclosure, where a bad actor could gain access to a list of all feature flags exposed through the flags discovery endpoint, including the:
* Flag names
* Flag descriptions
* Available options and their labels (e.g. `true`, `false`)
* Default flag values

Impact of exploitation:
Information disclosure of feature flag details. Flags providers were not accessible. No write access nor additional customer data was exposed.

Attack vectors:
The attack vector involves accessing the flags discovery endpoint (`.well-known/vercel/flags`). The vulnerability could be exploited if the attacker had detailed knowledge of the vulnerability.

Required attacker capabilities/position:
A bad actor with detailed knowledge of the vulnerability.

Mitigation or fix:
The `verifyAccess` function was patched within `flags@4.0.0`. Users of `@vercel/flags` should also migrate to `flags@4.0.0`.

Vercel implemented a network-level mitigation to prevent the default flags discovery endpoint at `/.well-known/vercel/flags` being reachable.

If not protected by the Vercel default mitigation, temporarily deny access to the other exposed flags discovery endpoints through a custom WAF rule while you upgrade to the latest version.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | Allowed | sparse | 0.285 |
| 2 | 401 | Missing Release of Memory after Effective Lifetime | Variant | Allowed | sparse | 0.229 |
| 3 | 1004 | Sensitive Cookie Without 'HttpOnly' Flag | Variant | Allowed | sparse | 0.229 |
| 4 | 266 | Incorrect Privilege Assignment | Base | Allowed | sparse | 0.205 |
| 5 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.201 |
| 6 | 201 | Insertion of Sensitive Information Into Sent Data | Base | Allowed | sparse | 0.196 |
| 7 | 863 | Incorrect Authorization | Class | Allowed-with-Review | sparse | 0.193 |
| 8 | 200 | Exposure of Sensitive Information to an Unauthorized Actor | Class | Discouraged | sparse | 0.192 |
| 9 | 347 | Improper Verification of Cryptographic Signature | Base | Allowed | dense | 0.445 |
| 10 | 226 | Sensitive Information in Resource Not Removed Before Reuse | Base | Allowed | graph | 0.002 |

