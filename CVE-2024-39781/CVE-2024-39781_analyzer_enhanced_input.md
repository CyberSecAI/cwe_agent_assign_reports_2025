## Vulnerability Description
Multiple OS **command injection** vulnerabilities exist in the adm.cgi sch_reboot() functionality of Wavlink AC3000 M33A8.V5030.210505. A specially crafted HTTP request can lead to a arbitrary code execution. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.A **command injection** vulnerability exists in the `restart_hour` POST parameter.

### Vulnerability Description Key Phrases
- **weakness:** **command injection**
- **impact:** arbitrary code execution
- **vector:** specially crafted HTTP request
- **product:** Wavlink AC3000
- **version:** M33A8.V5030.210505
- **component:** adm.cgi sch_reboot() functionality

## CVE Reference Links Content Summary
```
- **Vulnerability:** OS command injection vulnerabilities in the `adm.cgi`'s `sch_reboot()` functionality of Wavlink AC3000 M33A8.V5030.210505.
- **Root cause:** The `restart_hour`, `restart_min`, and `restart_week` POST parameters are combined into a buffer and written to the `SCH_Reboot` nvram item. This buffer resembles a crontab item, and by injecting malicious code into these parameters, attackers can achieve command injection.
- **Weaknesses/vulnerabilities present:** CWE-77 - Improper Neutralization of Special Elements used in a Command (‘Command Injection’).
- **Impact of exploitation:** Arbitrary code execution.
- **Attack vectors:** An attacker can make an authenticated HTTP request to trigger these vulnerabilities. The attacker needs to send a specially crafted HTTP request to the adm.cgi's `sch_reboot` functionality, manipulating the `restart_hour`, `restart_min`, and/or `restart_week` parameters to inject malicious commands within the crontab configuration.
- **Required attacker capabilities/position:** An authenticated user on the Wavlink AC3000 device.
- **Mitigation or fix:**  The vendor is working on patches, though the product has been discontinued.
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.358 |
| 4 | 134 | Use of Externally-Controlled Format String | Base | Allowed | sparse | 0.346 |
| 5 | 1287 | Improper Validation of Specified Type of Input | Base | Allowed | sparse | 0.337 |
| 6 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.331 |
| 7 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.314 |
| 8 | 120 | Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') | Base | Allowed-with-Review | sparse | 0.309 |
| 9 | 121 | Stack-based Buffer Overflow | Variant | Allowed | dense | 0.622 |
| 10 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-134: Use of Externally-Controlled Format String

CWE-1287: Improper Validation of Specified Type of Input

CWE-790: Improper Filtering of Special Elements

CWE-138: Improper Neutralization of Special Elements

CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')

CWE-121: Stack-based Buffer Overflow

CWE-184: Incomplete List of Disallowed Inputs