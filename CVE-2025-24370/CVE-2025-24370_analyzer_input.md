# Vulnerability Information: CVE-2025-24370

## Vulnerability Description
Django-Unicorn adds modern reactive component functionality to Django templates. Affected versions of Django-Unicorn are vulnerable to **python class pollution vulnerability**. The vulnerability arises from the core functionality `set_property_value`, which can be remotely triggered by users by crafting appropriate component requests and feeding in values of second and third parameter to the vulnerable function, leading to arbitrary changes to the python runtime status. With this finding at least five ways of vulnerability exploitation have been observed, stably resulting in Cross-Site Scripting (XSS), Denial of Service (DoS), and Authentication Bypass attacks in almost every Django-Unicorn-based application. This issue has been addressed in version 0.62.0 and all users are advised to upgrade. There are no known workarounds for this vulnerability.

### Vulnerability Description Key Phrases
- **component:** set_property_value
- **rootcause:** **python class pollution vulnerability**
- **vector:** crafting appropriate component requests and feeding in values of second and third parameter to the vulnerable function
- **product:** Django-Unicorn
- **impact:** arbitrary changes to the python runtime status, Authentication Bypass, Cross-Site Scripting (XSS), Denial of Service (DoS)
- **attacker:** users

## CVE Reference Links Content Summary
Here's an analysis of the provided content, focusing on CVE-2025-24370:

**github.com_0d89c993_20250624_191048.html**

*   **Relevance:** YES
*   **Extraction:**

    *   **Root cause of vulnerability:** The `set_property_value` function in `django-unicorn/views/action_parsers/utils.py` is vulnerable. It allows modification of a property value of an object based on user-supplied parameters (`property_name` and `property_value`) via component requests. The vulnerability arises because this function fails to adequately prevent attackers from traversing to other objects in the python runtime using "magic attributes" such as `__init__.__globals__`.
    *   **Weaknesses/vulnerabilities present:** Python class pollution vulnerability, categorized as CWE-915.
    *   **Impact of exploitation:**
        *   Cross-Site Scripting (XSS)
        *   Denial of Service (DoS)
        *   Authentication Bypass
        *   Remote Code Execution (RCE)
    *   **Attack vectors:**
        *   Crafting `syncInput` requests to the `/unicorn/message/COMPONENT_NAME` endpoint with a payload that sets the `name` and `value` parameters of the `syncInput` action to exploit the `set_property_value` function. Specifically, the attacker controls the "dotted path" (`property_name`) to modify specific objects and their attributes and the assigned value (`property_value`).
    *   **Required attacker capabilities/position:** Remote user, able to send crafted HTTP POST requests to a Django-Unicorn application.
    *   **Mitigation or fix:** The provided content details a patch. The patch involves adding a check within the `set_property_value` function. The check filters out any property names, that start and end with "__".

    *   **More detail than official CVE description:** YES, the content provides a detailed technical analysis of the vulnerability, including the vulnerable code, exploitation techniques (with Proofs of Concept), and potential impact.
    *   **Proof of Concepts (PoCs):** The content provides multiple PoCs, including:
        *   Reflected XSS by overwriting `bs4.dammit.EntitySubstitution.CHARACTER_TO_XML_ENTITY.<`.
        *   Stored XSS by overwriting `django_unicorn.settings.MORPHER_NAMES`, `django_unicorn.settings.DEFAULT_MORPHER_NAME` and `django.utils.html._json_script_escapes`.
        *   Stored XSS by overwriting `django.views.defaults.ERROR_PAGE_TEMPLATE`.
        *   Authentication bypass by overwriting `django.template.backends.django.settings.SECRET_KEY`.
        *   Denial of Service by overwriting `timed` decorator method.
        *   Remote Code Execution (RCE) by polluting `location_cache` and OS environment variable `BROWSER`.

**github.com_5eaf16a7_20250624_191045.html**

*   **Relevance:** YES
*   **Extraction:**
    *   **Details:** This content is a commit that applies a patch to mitigate the class pollution vulnerability in the `django-unicorn/views/action_parsers/utils.py` file.
    *   **Mitigation:** The patch adds a check in the `set_property_value` function to prevent modification of properties starting and ending with "__". This prevents attackers from using magic attributes.
    *   **More detail than official CVE description:** YES, the content details the specific code changes that fix the vulnerability.

**www.offensiveweb.com_c6597170_20250624_210650.html**

*   **Relevance:** NOINFO

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.655 |
| 2 | 116 | Improper Encoding or Escaping of Output | Class | Allowed-with-Review | sparse | 0.623 |
| 3 | 1321 | Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') | Variant | Allowed | sparse | 0.622 |
| 4 | 1333 | Inefficient Regular Expression Complexity | Base | Allowed | sparse | 0.615 |
| 5 | 502 | Deserialization of Untrusted Data | Base | Allowed | sparse | 0.609 |
| 6 | 288 | Authentication Bypass Using an Alternate Path or Channel | Base | Allowed | sparse | 0.592 |
| 7 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.589 |
| 8 | 94 | Improper Control of Generation of Code ('Code Injection') | Base | Allowed-with-Review | sparse | 0.587 |
| 9 | 915 | Improperly Controlled Modification of Dynamically-Determined Object Attributes | Base | Allowed | dense | 0.480 |
| 10 | 471 | Modification of Assumed-Immutable Data (MAID) | Base | Allowed | graph | 0.002 |


---

## CWE Classification Guidance

The following guidance has been automatically included because relevant keywords were detected in the vulnerability description:

### Authentication vs Authorization vs Access Control Guidance

## ===Guidance===

### Level Set – Authentication vs Authorization vs Access Control

**Authentication**:
Determines *who* the actor is (identity validation). This is typically the *first step* in access control.

* Example phrases: "user must log in", "lack of login check", "bypasses login"
* CWE relevance: authentication is usually mapped to CWE-306 or its children.

  * **CWE-306**: *Missing Authentication for Critical Function* – used when no identity validation is enforced for sensitive functionality (e.g., password reset, user deletion).

**Authorization**:
Determines *what* an authenticated actor is allowed to do. It decides access *after* identity is verified.

* Example phrases: "unauthorized access", "regular user can access admin panel", "role checks are missing"
* CWE relevance: use CWEs like 862, 863, 285 for authorization errors:

  * **CWE-862**: *Missing Authorization* – the application doesn't check whether the user is authorized at all.
  * **CWE-863**: *Incorrect Authorization* – the application checks authorization, but does it incorrectly (e.g., flawed logic).
  * **CWE-285**: *Improper Authorization* – general category for any flawed authorization logic or design.

**Access Control**:
A broader term that includes both authentication and authorization. Governs how resources are protected and who can access them under what conditions.

* CWE relevance:

  * **CWE-284**: *Improper Access Control* – top-level category used when access control failure exists but root cause is unclear.
  * This should be avoided **if** a more specific child CWE like 285, 862, 863, or 306 is appropriate.

---

## Mapping Discussion – Common Misclassification Patterns

### 1. **CWE-306 vs CWE-862**:

* **306** is about lack of **authentication** (e.g., *no login required at all*).
* **862** is about lack of **authorization** *after* authentication (e.g., *admin check missing*).
* ✅ Example CWE-306: *“An unauthenticated attacker can invoke the password reset API.”*
* ✅ Example CWE-862: *“An authenticated user without admin privileges can delete any user account.”*

### 2. **CWE-285 vs CWE-284**:

* **285** is specific to authorization flaws – it's a better choice than 284 **if** the issue involves *improper or missing role checks*.
* **284** should be reserved for general access control issues when it’s unclear whether the issue lies in authn or authz.

---

## Technical Impact vs Root Cause Clarification

**Phrase like "unauthorized access" is not enough.**

* If you **cannot determine whether identity was checked**, assume it’s **authorization** and consider 862 or 863.
* If you **know no login happened**, lean toward **authentication** → CWE-306.
* If the **access control policy is unclear or inconsistently enforced**, but it's not due to missing checks, consider **CWE-284**.

---

## Good Mapping Examples

* ✅ **CWE-306**: “The endpoint `/admin/deleteUser` does not require any authentication.”
* ✅ **CWE-862**: “Any logged-in user can change any other user's email without being an admin.”
* ✅ **CWE-863**: “An admin check exists but incorrectly grants access to non-admin users.”
* ✅ **CWE-285**: “Application uses a static role check that fails when roles change dynamically.”
* ✅ **CWE-284**: “Inconsistent enforcement of access rules across services with unclear policy source.”

---

## Summary – Quick LLM Rules of Thumb

| **Indicator**                                              | **Likely CWE** |
| ---------------------------------------------------------- | -------------- |
| No identity check (no login)                               | CWE-306        |
| No role/privilege check after login                        | CWE-862        |
| Role check is present but flawed                           | CWE-863        |
| General or ambiguous authorization failure                 | CWE-285        |
| High-level access control problem with no clear root cause | CWE-284        |


