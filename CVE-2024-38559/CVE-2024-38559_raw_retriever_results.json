{
  "query": "In the Linux kernel, the following vulnerability has been resolved scsi qedf Ensure the copied buf is NUL terminated Currently, we allocate a count-sized kernel buffer and copy count from userspace to that buffer. Later, we use kstrtouint on this buffer but we dont ensure that the string is terminated inside the buffer, this can lead to OOB read when using kstrtouint. Fix this issue by using memdup_user_nul instead of memdup_user.",
  "keyphrases": {
    "weakness": [
      "OOB read"
    ]
  },
  "timestamp": "2025-07-13T10:43:01.433957",
  "retriever_config": {
    "weights": {
      "dense": 0.35,
      "sparse": 0.4,
      "graph": 0.25
    },
    "use_graph": true,
    "use_rag": true,
    "use_sparse": true
  },
  "raw_results": {
    "graph": [
      {
        "cwe_id": "787",
        "name": "Out-of-bounds Write",
        "abstraction": "base",
        "score": 3.8870000000000005,
        "description": "CWE-787: Out-of-bounds Write...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "base",
        "score": 3.2318000000000002,
        "description": "CWE-125: Out-of-bounds Read...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "base",
        "score": 2.7014000000000005,
        "description": "CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')...",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "123",
        "name": "Write-what-where Condition",
        "abstraction": "base",
        "score": 2.4232000000000005,
        "description": "CWE-123: Write-what-where Condition...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "190",
        "name": "Integer Overflow or Wraparound",
        "abstraction": "Base",
        "score": 2.3906091030334693,
        "description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1339",
        "name": "Insufficient Precision or Accuracy of a Real Number",
        "abstraction": "base",
        "score": 2.3868000000000005,
        "description": "CWE-1339: Insufficient Precision or Accuracy of a Real Number...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "128",
        "name": "Wrap-around Error",
        "abstraction": "base",
        "score": 2.3868000000000005,
        "description": "CWE-128: Wrap-around Error...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "base",
        "score": 2.3295999999999997,
        "description": "CWE-1284: Improper Validation of Specified Quantity in Input...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "170",
        "name": "Improper Null Termination",
        "abstraction": "Base",
        "score": 2.312357625308199,
        "description": "The product does not terminate or incorrectly terminates a string or array with a null character or equivalent terminator....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "824",
        "name": "Access of Uninitialized Pointer",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-824: Access of Uninitialized Pointer...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "825",
        "name": "Expired Pointer Dereference",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-825: Expired Pointer Dereference...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "839",
        "name": "Numeric Range Comparison Without Minimum Check",
        "abstraction": "base",
        "score": 2.2100000000000004,
        "description": "CWE-839: Numeric Range Comparison Without Minimum Check...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "124",
        "name": "Buffer Underwrite ('Buffer Underflow')",
        "abstraction": "Base",
        "score": 2.0994836601490383,
        "description": "The product writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "456",
        "name": "Missing Initialization of a Variable",
        "abstraction": "variant",
        "score": 2.04,
        "description": "CWE-456: Missing Initialization of a Variable...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "126",
        "name": "Buffer Over-read",
        "abstraction": "Variant",
        "score": 1.8088314770435425,
        "description": "The product reads from a buffer using buffer access mechanisms such as indexes or pointers that reference memory locations after the targeted buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "562",
        "name": "Return of Stack Variable Address",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-562: Return of Stack Variable Address...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "617",
        "name": "Reachable Assertion",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-617: Reachable Assertion...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "681",
        "name": "Incorrect Conversion between Numeric Types",
        "abstraction": "base",
        "score": 1.7680000000000005,
        "description": "CWE-681: Incorrect Conversion between Numeric Types...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "786",
        "name": "Access of Memory Location Before Start of Buffer",
        "abstraction": "Base",
        "score": 1.7006467980042732,
        "description": "The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer....",
        "mapping_usage": "Discouraged"
      }
    ],
    "dense": [
      {
        "cwe_id": "805",
        "name": "Buffer Access with Incorrect Length Value",
        "abstraction": "Base",
        "score": 0.5120079135596434,
        "description": "The product uses a sequential operation to read or write a buffer, but it uses an incorrect length value that causes it to access memory that is outside of the bounds of the buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "158",
        "name": "Improper Neutralization of Null Byte or NUL Character",
        "abstraction": "Variant",
        "score": 0.5081042227079596,
        "description": "The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes NUL characters or null bytes when they are sent to a downstream component....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "124",
        "name": "Buffer Underwrite ('Buffer Underflow')",
        "abstraction": "Base",
        "score": 0.5065787831318243,
        "description": "The product writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "786",
        "name": "Access of Memory Location Before Start of Buffer",
        "abstraction": "Base",
        "score": 0.505671962709936,
        "description": "The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer....",
        "mapping_usage": "Discouraged"
      },
      {
        "cwe_id": "170",
        "name": "Improper Null Termination",
        "abstraction": "Base",
        "score": 0.4915763512816822,
        "description": "The product does not terminate or incorrectly terminates a string or array with a null character or equivalent terminator....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "191",
        "name": "Integer Underflow (Wrap or Wraparound)",
        "abstraction": "Base",
        "score": 0.49098710932738565,
        "description": "The product subtracts one value from another, such that the result is less than the minimum allowable integer value, which produces a value that is not equal to the correct result....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "823",
        "name": "Use of Out-of-range Pointer Offset",
        "abstraction": "Base",
        "score": 0.488962713660376,
        "description": "The product performs pointer arithmetic on a valid pointer, but it uses an offset that can point outside of the intended range of valid memory locations for the resulting pointer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "909",
        "name": "Missing Initialization of Resource",
        "abstraction": "Class",
        "score": 0.48621632666076664,
        "description": "The product does not initialize a critical resource....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "127",
        "name": "Buffer Under-read",
        "abstraction": "Variant",
        "score": 0.48507642296648484,
        "description": "The product reads from a buffer using buffer access mechanisms such as indexes or pointers that reference memory locations prior to the targeted buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "626",
        "name": "Null Byte Interaction Error (Poison Null Byte)",
        "abstraction": "Variant",
        "score": 0.484760102304116,
        "description": "The product does not properly handle null bytes or NUL characters when passing data between different representations or components....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "806",
        "name": "Buffer Access Using Size of Source Buffer",
        "abstraction": "Variant",
        "score": 0.46052103880441564,
        "description": "The product uses the size of a source buffer when reading from or writing to a destination buffer, which may cause it to access memory that is outside of the bounds of the buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1260",
        "name": "Improper Handling of Overlap Between Protected Memory Ranges",
        "abstraction": "Base",
        "score": 0.4571597820103886,
        "description": "The product allows address regions to overlap, which can result in the bypassing of intended memory protection....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "394",
        "name": "Unexpected Status Code or Return Value",
        "abstraction": "Base",
        "score": 0.45704668183058295,
        "description": "The product does not properly check when a function or operation returns a value that is legitimate for the function, but is not expected by the product....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "911",
        "name": "Improper Update of Reference Count",
        "abstraction": "Base",
        "score": 0.4562148128027258,
        "description": "The product uses a reference count to manage a resource, but it does not update or incorrectly updates the reference count....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "761",
        "name": "Free of Pointer not at Start of Buffer",
        "abstraction": "Variant",
        "score": 0.4549958717990771,
        "description": "The product calls free() on a pointer to a memory resource that was allocated on the heap, but the pointer is not at the start of the buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "476",
        "name": "NULL Pointer Dereference",
        "abstraction": "Base",
        "score": 0.45485051803685267,
        "description": "The product dereferences a pointer that it expects to be valid but is NULL....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "131",
        "name": "Incorrect Calculation of Buffer Size",
        "abstraction": "Base",
        "score": 0.4495291580969746,
        "description": "The product does not correctly calculate the size to be used when allocating a buffer, which could lead to a buffer overflow....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "190",
        "name": "Integer Overflow or Wraparound",
        "abstraction": "Base",
        "score": 0.4475365322827449,
        "description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "822",
        "name": "Untrusted Pointer Dereference",
        "abstraction": "Base",
        "score": 0.4462481310997576,
        "description": "The product obtains a value from an untrusted source, converts this value to a pointer, and dereferences the resulting pointer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "126",
        "name": "Buffer Over-read",
        "abstraction": "Variant",
        "score": 0.44589112544362697,
        "description": "The product reads from a buffer using buffer access mechanisms such as indexes or pointers that reference memory locations after the targeted buffer....",
        "mapping_usage": "Allowed"
      }
    ],
    "sparse": [
      {
        "cwe_id": "125",
        "name": "Out-of-bounds Read",
        "abstraction": "Base",
        "score": 1000.0,
        "description": "The product reads data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "1284",
        "name": "Improper Validation of Specified Quantity in Input",
        "abstraction": "Base",
        "score": 378.8499601531982,
        "description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "190",
        "name": "Integer Overflow or Wraparound",
        "abstraction": "Base",
        "score": 368.4028681990436,
        "description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "787",
        "name": "Out-of-bounds Write",
        "abstraction": "Base",
        "score": 359.96510802672697,
        "description": "The product writes data past the end, or before the beginning, of the intended buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "457",
        "name": "Use of Uninitialized Variable",
        "abstraction": "Variant",
        "score": 353.11517995781014,
        "description": "The code uses a variable that has not been initialized, leading to unpredictable or unintended results....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "909",
        "name": "Missing Initialization of Resource",
        "abstraction": "Class",
        "score": 350.66970663284656,
        "description": "The product does not initialize a critical resource....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "122",
        "name": "Heap-based Buffer Overflow",
        "abstraction": "Variant",
        "score": 348.68536052054924,
        "description": "A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine suc...",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "126",
        "name": "Buffer Over-read",
        "abstraction": "Variant",
        "score": 340.7489951631904,
        "description": "The product reads from a buffer using buffer access mechanisms such as indexes or pointers that reference memory locations after the targeted buffer....",
        "mapping_usage": "Allowed"
      },
      {
        "cwe_id": "120",
        "name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
        "abstraction": "Base",
        "score": 339.16958251281596,
        "description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow....",
        "mapping_usage": "Allowed-with-Review"
      },
      {
        "cwe_id": "193",
        "name": "Off-by-one Error",
        "abstraction": "Base",
        "score": 338.64483386819745,
        "description": "A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value....",
        "mapping_usage": "Allowed"
      }
    ]
  },
  "score_statistics": {
    "dense": {
      "min": 0.44589112544362697,
      "max": 0.5120079135596434,
      "mean": 0.47449677802586604,
      "median": 0.4726405705542658,
      "count": 20
    },
    "sparse": {
      "min": 338.64483386819745,
      "max": 1000.0,
      "mean": 417.82515950343776,
      "median": 351.89244329532835,
      "count": 10
    },
    "graph": {
      "min": 1.7006467980042732,
      "max": 3.8870000000000005,
      "mean": 2.270026433176926,
      "median": 2.2100000000000004,
      "count": 20
    }
  }
}