# Raw Retriever Results for CVE-2025-43858

# Raw Retriever Results for CVE-2025-43858
## Query
YoutubeDLSharp is a wrapper for the command-line video downloaders youtube-dl and yt-dlp. In versions starting from 1.0.0-beta4 and prior to 1.1.2, an unsafe conversion of arguments allows the injection of a malicious commands when starting `yt-dlp` from a commands prompt running on Windows OS with the `UseWindowsEncodingWorkaround` value defined to true (default behavior). If a user is using built-in methods from the YoutubeDL.cs file, the value is true by default and a user cannot disable it from these methods. This issue has been patched in version 1.1.2.

## Keyphrases
- **rootcause**: 'unsafe conversion of arguments'
- **weakness**: 'command injection'

## Score Statistics
| Retriever | Min | Max | Mean | Median | Count |
|-----------|-----|-----|------|--------|-------|
| Dense | 0.3115 | 0.4004 | 0.3480 | 0.3510 | 20 |
| Sparse | 166.7822 | 1000.0000 | 542.2375 | 520.3144 | 13 |
| Graph | 1.3104 | 4.3056 | 1.8634 | 1.5765 | 20 |

## Graph Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Mapping Usage |
|---|--------|------|-------------|-------|---------------|
| 1 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | base | 4.3056 | Allowed |
| 2 | 94 | Improper Control of Generation of Code ('Code Injection') | base | 3.4866 | Allowed-with-Review |
| 3 | 98 | Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion') | variant | 2.4936 | Allowed |
| 4 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 2.3387 | Allowed |
| 5 | 1333 | Inefficient Regular Expression Complexity | base | 2.1190 | Allowed |
| 6 | 425 | Direct Request ('Forced Browsing') | base | 1.7680 | Allowed |
| 7 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | base | 1.7680 | Allowed |
| 8 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 1.6472 | Allowed |
| 9 | 473 | PHP External Variable Modification | variant | 1.6320 | Allowed |
| 10 | 456 | Missing Initialization of a Variable | variant | 1.6320 | Allowed |
| 11 | 426 | Untrusted Search Path | base | 1.5210 | Allowed |
| 12 | 184 | Incomplete List of Disallowed Inputs | Base | 1.4857 | Allowed |
| 13 | 427 | Uncontrolled Search Path Element | Base | 1.4419 | Allowed |
| 14 | 356 | Product UI does not Warn User of Unsafe Actions | Base | 1.4390 | Allowed |
| 15 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | class | 1.4080 | Allowed-with-Review |

## Dense Retriever Results (20)
| # | CWE ID | Name | Abstraction | Score | Original Score | Mapping Usage |
|---|--------|------|-------------|-------|----------------|---------------|
| 1 | 1427 | Improper Neutralization of Input Used for LLM Prompting | Base | 0.4004 | 0.4004 | Allowed |
| 2 | 64 | Windows Shortcut Following (.LNK) | Variant | 0.3974 | 0.3974 | Allowed |
| 3 | 427 | Uncontrolled Search Path Element | Base | 0.3887 | 0.3887 | Allowed |
| 4 | 65 | Windows Hard Link | Variant | 0.3732 | 0.3732 | Allowed |
| 5 | 356 | Product UI does not Warn User of Unsafe Actions | Base | 0.3709 | 0.3709 | Allowed |
| 6 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | Base | 0.3681 | 0.3681 | Allowed |
| 7 | 494 | Download of Code Without Integrity Check | Base | 0.3667 | 0.3667 | Allowed |
| 8 | 69 | Improper Handling of Windows ::DATA Alternate Data Stream | Variant | 0.3630 | 0.3630 | Allowed |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | 0.3615 | 0.3615 | Allowed |
| 10 | 1386 | Insecure Operation on Windows Junction / Mount Point | Base | 0.3609 | 0.3609 | Allowed |
| 11 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | 0.3411 | 0.3411 | Allowed |
| 12 | 676 | Use of Potentially Dangerous Function | Base | 0.3375 | 0.3375 | Allowed |
| 13 | 422 | Unprotected Windows Messaging Channel ('Shatter') | Variant | 0.3238 | 0.3238 | Allowed |
| 14 | 184 | Incomplete List of Disallowed Inputs | Base | 0.3206 | 0.3206 | Allowed |
| 15 | 1022 | Use of Web Link to Untrusted Target with window.opener Access | Variant | 0.3187 | 0.3187 | Allowed |

## Sparse Retriever Results (13)
| # | CWE ID | Name | Score | Original Score | Mapping Usage |
|---|--------|------|-------|---------------|---------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | 1000.0000 | 1000.0000 | Allowed-with-Review |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | 700.0000 | 700.0000 | Allowed |
| 3 | 88 | Improper Neutralization of Argument Delimiters in a Command ('Argument Injection') | 546.4583 | 546.4583 | Allowed |
| 4 | 94 | Improper Control of Generation of Code ('Code Injection') | 529.0336 | 529.0336 | Allowed-with-Review |
| 5 | 1333 | Inefficient Regular Expression Complexity | 524.6320 | 524.6320 | Allowed |
| 6 | 269 | Improper Privilege Management | 523.2719 | 523.2719 | Discouraged |
| 7 | 863 | Incorrect Authorization | 520.3144 | 520.3144 | Allowed-with-Review |
| 8 | 502 | Deserialization of Untrusted Data | 518.5508 | 518.5508 | Allowed |
| 9 | 306 | Missing Authentication for Critical Function | 517.0474 | 517.0474 | Allowed |
| 10 | 116 | Improper Encoding or Escaping of Output | 514.4468 | 514.4468 | Allowed-with-Review |
| 11 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | 511.5711 | 511.5711 | Allowed |
| 12 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | 476.9793 | 476.9793 | Allowed |
| 13 | 1390 | Weak Authentication | 166.7822 | 166.7822 | Allowed-with-Review |
