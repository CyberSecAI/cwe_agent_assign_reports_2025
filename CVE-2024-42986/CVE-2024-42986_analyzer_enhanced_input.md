## Vulnerability Description
Tenda FH1206 v02.03.01.35 was discovered to contain a **stack overflow** via the PPPOEPassword parameter in the fromAdvSetWan function. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted POST request.

### Vulnerability Description Key Phrases
- **weakness:** **stack overflow**
- **impact:** Denial of Service (DoS)
- **vector:** crafted POST request
- **attacker:** attackers
- **product:** Tenda FH1206
- **version:** v02.03.01.35
- **component:** fromAdvSetWan function

### CWE for similar CVE Descriptions
### Primary CWE Match
CWE-787

#### Top CWEs
- CWE-787 (Count: 147)
- CWE-120 (Count: 4)

## CVE Reference Links Content Summary
- **Root cause of vulnerability:** A stack-based buffer overflow in the `decodePwd` function.
- **Weaknesses/vulnerabilities present:** The `decodePwd` function copies data from a user-controlled input (`PPPOEPassword`) into a fixed-size buffer (`v52`). It does not perform adequate bounds checking, leading to a buffer overflow if the user-supplied password exceeds the buffer's capacity.
- **Impact of exploitation:** A successful exploit can lead to arbitrary code execution on the affected device, potentially giving an attacker full control of the router.
- **Attack vectors:** A malicious actor sends a crafted POST request to the `/goform/AdvSetWan` endpoint. The request includes the `wanmode` parameter set to "2" and an excessively long `PPPOEPassword` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP POST requests to the router. This could be achieved through a network connected to the router, either directly or remotely if the router's web interface is exposed to the internet or if the attacker has already compromised another device on the LAN.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 121 | Stack-based Buffer Overflow | Variant | Allowed | alternate_terms | 1.000 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 674 | Uncontrolled Recursion | Class | Allowed-with-Review | sparse | 0.236 |
| 4 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.211 |
| 5 | 770 | Allocation of Resources Without Limits or Throttling | Base | Allowed | sparse | 0.209 |
| 6 | 130 | Improper Handling of Length Parameter Inconsistency | Base | Allowed | sparse | 0.208 |
| 7 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.204 |
| 8 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.204 |
| 9 | 259 | Use of Hard-coded Password | Variant | Allowed | dense | 0.584 |
| 10 | 789 | Memory Allocation with Excessive Size Value | Variant | Allowed | graph | 0.003 |



# Complete CWE Specifications

CWE-121: Stack-based Buffer Overflow

CWE-190: Integer Overflow or Wraparound

CWE-674: Uncontrolled Recursion

CWE-1284: Improper Validation of Specified Quantity in Input

CWE-770: Allocation of Resources Without Limits or Throttling

CWE-130: Improper Handling of Length Parameter Inconsistency

CWE-122: Heap-based Buffer Overflow

CWE-125: Out-of-bounds Read

CWE-259: Use of Hard-coded Password

CWE-789: Memory Allocation with Excessive Size Value