## Vulnerability Description
A vulnerability was found in Netgear WN604 up to 20240710. It has been rated as problematic. Affected by this issue is some unknown functionality of the file /downloadFile.php of the component Web Interface. The manipulation of the argument file with the input config leads to information disclosure. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The identifier of this vulnerability is VDB-271052. NOTE The vendor was contacted early about this disclosure but did not respond in any way.

### Vulnerability Description Key Phrases
- **impact:** information disclosure
- **vector:** manipulation of argument file with config input
- **product:** Netgear WN604
- **version:** up to 20240710
- **component:** /downloadFile.php

## CVE Reference Links Content Summary
Based on the provided information, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
The vulnerability lies in the `downloadFile.php` script of the NETGEAR Wireless N150 Access Point WN604. Specifically, the script processes the `file` parameter insecurely, allowing for the retrieval of sensitive files through path manipulation.

**Weaknesses/Vulnerabilities Present:**
- **Sensitive Information Disclosure:** The primary vulnerability is the exposure of sensitive information, specifically the configuration file, likely containing usernames and passwords used for accessing the device's web interface.
- **Path Traversal/Manipulation:** The vulnerability can be exploited by providing a specific file path as the value of the `file` parameter in the URL to `downloadFile.php`, without proper sanitization of input.

**Impact of Exploitation:**
- **Unauthorized Access:** By obtaining the configuration file, an attacker can gain access to the device's administrative interface.
- **Device Compromise:**  With administrative access, an attacker can potentially modify device settings, network configurations, and possibly install malicious firmware.
- **Network Exposure:**  Compromised devices can be used as an entry point into the network or used for further attacks.

**Attack Vectors:**
- **HTTP GET Request:** The attacker makes an HTTP GET request to the vulnerable `downloadFile.php` script.
- **URL Parameter Manipulation:**  The attacker manipulates the `file` parameter in the URL, specifically requesting the `config` file, e.g., `/downloadFile.php?file=config`.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to have network access to the vulnerable device. This could be LAN access if they are on the same network, or potentially WAN access if the device is exposed to the internet.
- **Basic HTTP Knowledge:**  The attacker needs a basic understanding of HTTP requests and URL parameters.

**Additional Details:**
- The provided GitHub issue shows the specific URL manipulation to exploit the vulnerability: `/downloadFile.php?file=config`
- The GitHub issue also demonstrates how to use the obtained credentials to log in to the backend web interface, further confirming the impact of the vulnerability.
- Example IP addresses are provided, suggesting the vulnerability was found in the wild.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 79 | Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') | Base | Allowed | sparse | 0.215 |
| 2 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.210 |
| 3 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.174 |
| 4 | 1336 | Improper Neutralization of Special Elements Used in a Template Engine | Base | Allowed | sparse | 0.173 |
| 5 | 125 | Out-of-bounds Read | Base | Allowed | sparse | 0.171 |
| 6 | 252 | Unchecked Return Value | Base | Allowed | sparse | 0.170 |
| 7 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.168 |
| 8 | 352 | Cross-Site Request Forgery (CSRF) | Compound | Allowed | sparse | 0.168 |
| 9 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | dense | 0.607 |
| 10 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | graph | 0.002 |



# Complete CWE Specifications

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

CWE-306: Missing Authentication for Critical Function

CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine

CWE-125: Out-of-bounds Read

CWE-252: Unchecked Return Value

CWE-434: Unrestricted Upload of File with Dangerous Type

CWE-352: Cross-Site Request Forgery (CSRF)

CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

CWE-425: Direct Request ('Forced Browsing')